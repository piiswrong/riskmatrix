2024-12-12 23:54:01,797 - INFO - TRADE_RANK_NUM: 20
2024-12-12 23:54:01,798 - INFO - LINEAR_INPUT_FILE data/predictions.parquet
2024-12-12 23:54:01,814 - INFO - LONG_TRADE_RANK_RATIO: 1.0, SHORT_TRADE_RANK_RATIO: 0.5
2024-12-12 23:54:01,814 - INFO - DYNAMIC_POS_SCALE: 0 === threshold: 3.0
2024-12-12 23:54:02,110 - INFO - start get SinglePnl: shape: (130_575, 99)
┌────────────┬───────────┬──────────┬──────────┬───┬───────────┬───────────┬───────────┬───────────┐
│ symbol     ┆ open_time ┆ open     ┆ high     ┆ … ┆ long_valu ┆ short_val ┆ long_valu ┆ short_val │
│ ---        ┆ ---       ┆ ---      ┆ ---      ┆   ┆ e_scale_9 ┆ ue_scale_ ┆ e_scale_1 ┆ ue_scale_ │
│ str        ┆ datetime[ ┆ f64      ┆ f64      ┆   ┆ day       ┆ 9day      ┆ 0day      ┆ 10day     │
│            ┆ ms]       ┆          ┆          ┆   ┆ ---       ┆ ---       ┆ ---       ┆ ---       │
│            ┆           ┆          ┆          ┆   ┆ f64       ┆ f64       ┆ f64       ┆ f64       │
╞════════════╪═══════════╪══════════╪══════════╪═══╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010656 ┆ 0.010834 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.0       ┆ 1.0       │
│ DT         ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010747 ┆ 0.010872 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010541 ┆ 0.010638 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010346 ┆ 0.010412 ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010074 ┆ 0.010637 ┆ … ┆ 0.8       ┆ 1.2       ┆ 1.0       ┆ 1.0       │
│ DT         ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010172 ┆ 0.010209 ┆ … ┆ 1.0       ┆ 1.0       ┆ 0.8       ┆ 1.2       │
│ DT         ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.009935 ┆ 0.01061  ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010431 ┆ 0.010635 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.0       ┆ 1.0       │
│ DT         ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010362 ┆ 0.012789 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-1 ┆ 0.012146 ┆ 0.013725 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ …          ┆ …         ┆ …        ┆ …        ┆ … ┆ …         ┆ …         ┆ …         ┆ …         │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3196   ┆ 0.3373   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3355   ┆ 0.3415   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3359   ┆ 0.3565   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3553   ┆ 0.3881   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3577   ┆ 0.3581   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3511   ┆ 0.3547   ┆ … ┆ 0.8       ┆ 1.2       ┆ 1.2       ┆ 0.8       │
│            ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3383   ┆ 0.3548   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3417   ┆ 0.3632   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3194   ┆ 0.3243   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.316    ┆ 0.3317   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
└────────────┴───────────┴──────────┴──────────┴───┴───────────┴───────────┴───────────┴───────────┘
2024-12-12 23:54:02,197 - DEBUG - cur time: 2023-01-08T23:59:59.999 == next bar open time: 2023-01-09T00:00:00.000 == close pos time: 2023-01-14T00:00:00.000
2024-12-12 23:54:02,205 - DEBUG - close time 2023-01-08T23:59:59.999 == vol_threshold: 17759737.179999996
2024-12-12 23:54:02,205 - DEBUG - 2023-01-08T23:59:59.999 == all trade symbol 135 == remain 94 after VOL filter
2024-12-12 23:54:02,210 - DEBUG - sorted_long_factors: shape: (94, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT      ┆ -5.169457    ┆ 0    ┆ 93           │
│ XLMUSDT      ┆ -3.816309    ┆ 1    ┆ 92           │
│ DARUSDT      ┆ -3.658264    ┆ 2    ┆ 91           │
│ ZRXUSDT      ┆ -3.626811    ┆ 3    ┆ 90           │
│ NKNUSDT      ┆ -3.374139    ┆ 4    ┆ 89           │
│ SFPUSDT      ┆ -3.072998    ┆ 5    ┆ 88           │
│ BLZUSDT      ┆ -3.003268    ┆ 6    ┆ 87           │
│ 1000SHIBUSDT ┆ -2.990533    ┆ 7    ┆ 86           │
│ HOTUSDT      ┆ -2.920113    ┆ 8    ┆ 85           │
│ ATAUSDT      ┆ -2.891036    ┆ 9    ┆ 84           │
│ …            ┆ …            ┆ …    ┆ …            │
│ DUSKUSDT     ┆ 2.609552     ┆ 84   ┆ 9            │
│ WOOUSDT      ┆ 2.680863     ┆ 85   ┆ 8            │
│ ADAUSDT      ┆ 3.05136      ┆ 86   ┆ 7            │
│ CRVUSDT      ┆ 3.234348     ┆ 87   ┆ 6            │
│ IMXUSDT      ┆ 3.616642     ┆ 88   ┆ 5            │
│ MATICUSDT    ┆ 3.726589     ┆ 89   ┆ 4            │
│ GALAUSDT     ┆ 3.768313     ┆ 90   ┆ 3            │
│ DOTUSDT      ┆ 3.821188     ┆ 91   ┆ 2            │
│ TRXUSDT      ┆ 4.168715     ┆ 92   ┆ 1            │
│ LDOUSDT      ┆ 4.883935     ┆ 93   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,217 - WARNING - 2023-01-08T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,217 - INFO - cur close time: 2023-01-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:02,217 - DEBUG - mean expected ret (mean factor): 0.13869660754148946
2024-12-12 23:54:02,223 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,223 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬─────────┬──────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT  │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---      │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64      │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆         ┆          │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪═════════╪══════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ -10000.0 │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴─────────┴──────────┘
2024-12-12 23:54:02,223 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1585      ┆ null        ┆ … ┆ 0.02177 ┆ null   ┆ null    ┆ 0.166   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,228 - DEBUG - update position: 2023-01-08T23:59:59.999 === diff_trading_value: 200000.0 == cash: 99800.0 
2024-12-12 23:54:02,232 - DEBUG - cur time: 2023-01-09T23:59:59.999 == next bar open time: 2023-01-10T00:00:00.000 == close pos time: 2023-01-15T00:00:00.000
2024-12-12 23:54:02,232 - INFO - pnl: 2023-01-09T23:59:59.999 101318.12939358318 === 1.521%
2024-12-12 23:54:02,236 - DEBUG - cur time: 2023-01-10T23:59:59.999 == next bar open time: 2023-01-11T00:00:00.000 == close pos time: 2023-01-16T00:00:00.000
2024-12-12 23:54:02,236 - INFO - pnl: 2023-01-10T23:59:59.999 101394.81778869082 === 0.076%
2024-12-12 23:54:02,238 - DEBUG - cur time: 2023-01-11T23:59:59.999 == next bar open time: 2023-01-12T00:00:00.000 == close pos time: 2023-01-17T00:00:00.000
2024-12-12 23:54:02,240 - INFO - pnl: 2023-01-11T23:59:59.999 101856.56622461749 === 0.455%
2024-12-12 23:54:02,242 - DEBUG - cur time: 2023-01-12T23:59:59.999 == next bar open time: 2023-01-13T00:00:00.000 == close pos time: 2023-01-18T00:00:00.000
2024-12-12 23:54:02,242 - INFO - pnl: 2023-01-12T23:59:59.999 102720.72414332861 === 0.848%
2024-12-12 23:54:02,242 - DEBUG - cur time: 2023-01-13T23:59:59.999 == next bar open time: 2023-01-14T00:00:00.000 == close pos time: 2023-01-19T00:00:00.000
2024-12-12 23:54:02,251 - DEBUG - close time 2023-01-13T23:59:59.999 == vol_threshold: 25541184.5
2024-12-12 23:54:02,251 - DEBUG - 2023-01-13T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:02,255 - DEBUG - sorted_long_factors: shape: (95, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ DUSKUSDT    ┆ -6.122317    ┆ 0    ┆ 94           │
│ NKNUSDT     ┆ -4.216887    ┆ 1    ┆ 93           │
│ WOOUSDT     ┆ -3.057971    ┆ 2    ┆ 92           │
│ JASMYUSDT   ┆ -2.948467    ┆ 3    ┆ 91           │
│ DGBUSDT     ┆ -2.660308    ┆ 4    ┆ 90           │
│ 1000XECUSDT ┆ -2.558733    ┆ 5    ┆ 89           │
│ LRCUSDT     ┆ -2.464433    ┆ 6    ┆ 88           │
│ GRTUSDT     ┆ -2.245682    ┆ 7    ┆ 87           │
│ STORJUSDT   ┆ -2.231532    ┆ 8    ┆ 86           │
│ XRPUSDT     ┆ -2.109735    ┆ 9    ┆ 85           │
│ …           ┆ …            ┆ …    ┆ …            │
│ OPUSDT      ┆ 2.215205     ┆ 85   ┆ 9            │
│ NEARUSDT    ┆ 2.605794     ┆ 86   ┆ 8            │
│ GALAUSDT    ┆ 3.047583     ┆ 87   ┆ 7            │
│ C98USDT     ┆ 3.08735      ┆ 88   ┆ 6            │
│ STMXUSDT    ┆ 3.254902     ┆ 89   ┆ 5            │
│ XEMUSDT     ┆ 3.907122     ┆ 90   ┆ 4            │
│ VETUSDT     ┆ 4.044063     ┆ 91   ┆ 3            │
│ KLAYUSDT    ┆ 6.766025     ┆ 92   ┆ 2            │
│ ICXUSDT     ┆ 8.040166     ┆ 93   ┆ 1            │
│ TRXUSDT     ┆ 9.058604     ┆ 94   ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,259 - WARNING - 2023-01-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,259 - INFO - cur close time: 2023-01-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:02,259 - DEBUG - mean expected ret (mean factor): 0.06923555914979494
2024-12-12 23:54:02,263 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,263 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,263 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1769      ┆ null        ┆ … ┆ 0.02592 ┆ null   ┆ null    ┆ 0.1913  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,269 - DEBUG - update position: 2023-01-13T23:59:59.999 === diff_trading_value: 321197.98358019686 == cash: 103815.80394354368 
2024-12-12 23:54:02,269 - INFO - pnl: 2023-01-13T23:59:59.999 103815.80394354368 === 1.066%
2024-12-12 23:54:02,273 - DEBUG - cur time: 2023-01-14T23:59:59.999 == next bar open time: 2023-01-15T00:00:00.000 == close pos time: 2023-01-20T00:00:00.000
2024-12-12 23:54:02,274 - INFO - pnl: 2023-01-14T23:59:59.999 105198.01452880907 === 1.331%
2024-12-12 23:54:02,276 - DEBUG - cur time: 2023-01-15T23:59:59.999 == next bar open time: 2023-01-16T00:00:00.000 == close pos time: 2023-01-21T00:00:00.000
2024-12-12 23:54:02,276 - INFO - pnl: 2023-01-15T23:59:59.999 104866.47843611173 === -0.315%
2024-12-12 23:54:02,280 - DEBUG - cur time: 2023-01-16T23:59:59.999 == next bar open time: 2023-01-17T00:00:00.000 == close pos time: 2023-01-22T00:00:00.000
2024-12-12 23:54:02,282 - INFO - pnl: 2023-01-16T23:59:59.999 104839.11462055414 === -0.026%
2024-12-12 23:54:02,285 - DEBUG - cur time: 2023-01-17T23:59:59.999 == next bar open time: 2023-01-18T00:00:00.000 == close pos time: 2023-01-23T00:00:00.000
2024-12-12 23:54:02,286 - INFO - pnl: 2023-01-17T23:59:59.999 106969.1077674854 === 2.032%
2024-12-12 23:54:02,288 - DEBUG - cur time: 2023-01-18T23:59:59.999 == next bar open time: 2023-01-19T00:00:00.000 == close pos time: 2023-01-24T00:00:00.000
2024-12-12 23:54:02,297 - DEBUG - close time 2023-01-18T23:59:59.999 == vol_threshold: 28166395.0
2024-12-12 23:54:02,297 - DEBUG - 2023-01-18T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:02,300 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DARUSDT      ┆ -5.240946    ┆ 0    ┆ 94           │
│ ONTUSDT      ┆ -4.81598     ┆ 1    ┆ 93           │
│ RSRUSDT      ┆ -4.635616    ┆ 2    ┆ 92           │
│ 1000LUNCUSDT ┆ -3.707673    ┆ 3    ┆ 91           │
│ IOTXUSDT     ┆ -3.486965    ┆ 4    ┆ 90           │
│ REEFUSDT     ┆ -3.394174    ┆ 5    ┆ 89           │
│ DGBUSDT      ┆ -3.059826    ┆ 6    ┆ 88           │
│ SKLUSDT      ┆ -3.041765    ┆ 7    ┆ 87           │
│ NKNUSDT      ┆ -2.864455    ┆ 8    ┆ 86           │
│ LUNA2USDT    ┆ -2.668164    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ DENTUSDT     ┆ 2.448663     ┆ 85   ┆ 9            │
│ CELOUSDT     ┆ 2.658327     ┆ 86   ┆ 8            │
│ XEMUSDT      ┆ 2.81218      ┆ 87   ┆ 7            │
│ KNCUSDT      ┆ 3.261381     ┆ 88   ┆ 6            │
│ GALUSDT      ┆ 3.293725     ┆ 89   ┆ 5            │
│ LINAUSDT     ┆ 3.37682      ┆ 90   ┆ 4            │
│ ENJUSDT      ┆ 3.541587     ┆ 91   ┆ 3            │
│ CRVUSDT      ┆ 4.425505     ┆ 92   ┆ 2            │
│ HBARUSDT     ┆ 4.67193      ┆ 93   ┆ 1            │
│ KAVAUSDT     ┆ 4.678345     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,301 - INFO - cur close time: 2023-01-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:02,301 - DEBUG - mean expected ret (mean factor): -0.0031616239334935794
2024-12-12 23:54:02,305 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,309 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,309 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1616      ┆ null        ┆ … ┆ 0.0247  ┆ null   ┆ null    ┆ 0.1972  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,313 - DEBUG - update position: 2023-01-18T23:59:59.999 === diff_trading_value: 304828.7518433435 == cash: 108255.76488643918 
2024-12-12 23:54:02,313 - INFO - pnl: 2023-01-18T23:59:59.999 108255.76488643918 === 1.203%
2024-12-12 23:54:02,318 - DEBUG - cur time: 2023-01-19T23:59:59.999 == next bar open time: 2023-01-20T00:00:00.000 == close pos time: 2023-01-25T00:00:00.000
2024-12-12 23:54:02,319 - INFO - pnl: 2023-01-19T23:59:59.999 109018.46162235172 === 0.705%
2024-12-12 23:54:02,323 - DEBUG - cur time: 2023-01-20T23:59:59.999 == next bar open time: 2023-01-21T00:00:00.000 == close pos time: 2023-01-26T00:00:00.000
2024-12-12 23:54:02,325 - INFO - pnl: 2023-01-20T23:59:59.999 108609.5101891305 === -0.375%
2024-12-12 23:54:02,325 - DEBUG - cur time: 2023-01-21T23:59:59.999 == next bar open time: 2023-01-22T00:00:00.000 == close pos time: 2023-01-27T00:00:00.000
2024-12-12 23:54:02,325 - INFO - pnl: 2023-01-21T23:59:59.999 107595.80981487394 === -0.933%
2024-12-12 23:54:02,330 - DEBUG - cur time: 2023-01-22T23:59:59.999 == next bar open time: 2023-01-23T00:00:00.000 == close pos time: 2023-01-28T00:00:00.000
2024-12-12 23:54:02,330 - INFO - pnl: 2023-01-22T23:59:59.999 107396.25676234005 === -0.185%
2024-12-12 23:54:02,334 - DEBUG - cur time: 2023-01-23T23:59:59.999 == next bar open time: 2023-01-24T00:00:00.000 == close pos time: 2023-01-29T00:00:00.000
2024-12-12 23:54:02,342 - DEBUG - close time 2023-01-23T23:59:59.999 == vol_threshold: 28406128.6
2024-12-12 23:54:02,342 - DEBUG - 2023-01-23T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:02,342 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LUNA2USDT    ┆ -4.480431    ┆ 0    ┆ 94           │
│ DOGEUSDT     ┆ -4.251458    ┆ 1    ┆ 93           │
│ 1000SHIBUSDT ┆ -4.11002     ┆ 2    ┆ 92           │
│ RENUSDT      ┆ -3.504102    ┆ 3    ┆ 91           │
│ REEFUSDT     ┆ -3.003236    ┆ 4    ┆ 90           │
│ 1000LUNCUSDT ┆ -2.86876     ┆ 5    ┆ 89           │
│ FILUSDT      ┆ -2.867665    ┆ 6    ┆ 88           │
│ THETAUSDT    ┆ -2.764241    ┆ 7    ┆ 87           │
│ MATICUSDT    ┆ -2.365462    ┆ 8    ┆ 86           │
│ COTIUSDT     ┆ -2.189668    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ AXSUSDT      ┆ 2.543085     ┆ 85   ┆ 9            │
│ JASMYUSDT    ┆ 2.620664     ┆ 86   ┆ 8            │
│ XEMUSDT      ┆ 3.209379     ┆ 87   ┆ 7            │
│ ALPHAUSDT    ┆ 3.249472     ┆ 88   ┆ 6            │
│ ARPAUSDT     ┆ 3.667704     ┆ 89   ┆ 5            │
│ KNCUSDT      ┆ 4.103732     ┆ 90   ┆ 4            │
│ ZRXUSDT      ┆ 4.642282     ┆ 91   ┆ 3            │
│ TRXUSDT      ┆ 5.017789     ┆ 92   ┆ 2            │
│ SFPUSDT      ┆ 5.436563     ┆ 93   ┆ 1            │
│ STMXUSDT     ┆ 7.6931       ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,350 - WARNING - 2023-01-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,350 - INFO - cur close time: 2023-01-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:02,350 - DEBUG - mean expected ret (mean factor): 0.344125811283479
2024-12-12 23:54:02,354 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,354 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,354 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.179       ┆ null        ┆ … ┆ 0.02866 ┆ null   ┆ null    ┆ 0.2267  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,360 - DEBUG - update position: 2023-01-23T23:59:59.999 === diff_trading_value: 334939.90904878895 == cash: 107899.18022786625 
2024-12-12 23:54:02,360 - INFO - pnl: 2023-01-23T23:59:59.999 107899.18022786625 === 0.468%
2024-12-12 23:54:02,362 - DEBUG - cur time: 2023-01-24T23:59:59.999 == next bar open time: 2023-01-25T00:00:00.000 == close pos time: 2023-01-30T00:00:00.000
2024-12-12 23:54:02,363 - INFO - pnl: 2023-01-24T23:59:59.999 108398.67067583716 === 0.463%
2024-12-12 23:54:02,363 - DEBUG - cur time: 2023-01-25T23:59:59.999 == next bar open time: 2023-01-26T00:00:00.000 == close pos time: 2023-01-31T00:00:00.000
2024-12-12 23:54:02,367 - INFO - pnl: 2023-01-25T23:59:59.999 106207.5054049505 === -2.021%
2024-12-12 23:54:02,369 - DEBUG - cur time: 2023-01-26T23:59:59.999 == next bar open time: 2023-01-27T00:00:00.000 == close pos time: 2023-02-01T00:00:00.000
2024-12-12 23:54:02,369 - INFO - pnl: 2023-01-26T23:59:59.999 103910.56267198724 === -2.163%
2024-12-12 23:54:02,373 - DEBUG - cur time: 2023-01-27T23:59:59.999 == next bar open time: 2023-01-28T00:00:00.000 == close pos time: 2023-02-02T00:00:00.000
2024-12-12 23:54:02,375 - INFO - pnl: 2023-01-27T23:59:59.999 106237.98713278025 === 2.240%
2024-12-12 23:54:02,375 - DEBUG - cur time: 2023-01-28T23:59:59.999 == next bar open time: 2023-01-29T00:00:00.000 == close pos time: 2023-02-03T00:00:00.000
2024-12-12 23:54:02,383 - DEBUG - close time 2023-01-28T23:59:59.999 == vol_threshold: 19004748.4
2024-12-12 23:54:02,383 - DEBUG - 2023-01-28T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:02,387 - DEBUG - sorted_long_factors: shape: (95, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ DENTUSDT  ┆ -4.356289    ┆ 0    ┆ 94           │
│ LDOUSDT   ┆ -4.33025     ┆ 1    ┆ 93           │
│ ATAUSDT   ┆ -3.345872    ┆ 2    ┆ 92           │
│ ARPAUSDT  ┆ -3.180468    ┆ 3    ┆ 91           │
│ VETUSDT   ┆ -3.172974    ┆ 4    ┆ 90           │
│ SUSHIUSDT ┆ -3.109406    ┆ 5    ┆ 89           │
│ JASMYUSDT ┆ -2.963305    ┆ 6    ┆ 88           │
│ TOMOUSDT  ┆ -2.882952    ┆ 7    ┆ 87           │
│ DOTUSDT   ┆ -2.627003    ┆ 8    ┆ 86           │
│ BLZUSDT   ┆ -2.571701    ┆ 9    ┆ 85           │
│ …         ┆ …            ┆ …    ┆ …            │
│ INJUSDT   ┆ 2.274726     ┆ 85   ┆ 9            │
│ ICXUSDT   ┆ 2.849178     ┆ 86   ┆ 8            │
│ IOSTUSDT  ┆ 2.907602     ┆ 87   ┆ 7            │
│ DYDXUSDT  ┆ 3.049322     ┆ 88   ┆ 6            │
│ ENJUSDT   ┆ 3.581785     ┆ 89   ┆ 5            │
│ CTSIUSDT  ┆ 3.833574     ┆ 90   ┆ 4            │
│ DARUSDT   ┆ 4.072133     ┆ 91   ┆ 3            │
│ DGBUSDT   ┆ 4.396628     ┆ 92   ┆ 2            │
│ ZRXUSDT   ┆ 5.234092     ┆ 93   ┆ 1            │
│ XEMUSDT   ┆ 6.396861     ┆ 94   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,391 - INFO - cur close time: 2023-01-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:02,391 - DEBUG - mean expected ret (mean factor): -0.11907070142496771
2024-12-12 23:54:02,395 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,395 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,395 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1734      ┆ null        ┆ … ┆ 0.02915 ┆ null   ┆ null    ┆ 0.23    │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,402 - DEBUG - update position: 2023-01-28T23:59:59.999 === diff_trading_value: 345707.3251672264 == cash: 105050.14063450047 
2024-12-12 23:54:02,403 - INFO - pnl: 2023-01-28T23:59:59.999 105050.14063450047 === -1.118%
2024-12-12 23:54:02,403 - DEBUG - cur time: 2023-01-29T23:59:59.999 == next bar open time: 2023-01-30T00:00:00.000 == close pos time: 2023-02-04T00:00:00.000
2024-12-12 23:54:02,403 - INFO - pnl: 2023-01-29T23:59:59.999 104671.53819942335 === -0.360%
2024-12-12 23:54:02,409 - DEBUG - cur time: 2023-01-30T23:59:59.999 == next bar open time: 2023-01-31T00:00:00.000 == close pos time: 2023-02-05T00:00:00.000
2024-12-12 23:54:02,411 - INFO - pnl: 2023-01-30T23:59:59.999 103947.50499474407 === -0.692%
2024-12-12 23:54:02,411 - DEBUG - cur time: 2023-01-31T23:59:59.999 == next bar open time: 2023-02-01T00:00:00.000 == close pos time: 2023-02-06T00:00:00.000
2024-12-12 23:54:02,415 - INFO - pnl: 2023-01-31T23:59:59.999 106228.69395091113 === 2.195%
2024-12-12 23:54:02,417 - DEBUG - cur time: 2023-02-01T23:59:59.999 == next bar open time: 2023-02-02T00:00:00.000 == close pos time: 2023-02-07T00:00:00.000
2024-12-12 23:54:02,420 - INFO - pnl: 2023-02-01T23:59:59.999 106593.42117116718 === 0.343%
2024-12-12 23:54:02,422 - DEBUG - cur time: 2023-02-02T23:59:59.999 == next bar open time: 2023-02-03T00:00:00.000 == close pos time: 2023-02-08T00:00:00.000
2024-12-12 23:54:02,430 - DEBUG - close time 2023-02-02T23:59:59.999 == vol_threshold: 31305303.35
2024-12-12 23:54:02,430 - DEBUG - 2023-02-02T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:02,432 - DEBUG - sorted_long_factors: shape: (95, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ DOGEUSDT   ┆ -4.192548    ┆ 0    ┆ 94           │
│ BANDUSDT   ┆ -3.123588    ┆ 1    ┆ 93           │
│ PEOPLEUSDT ┆ -2.740255    ┆ 2    ┆ 92           │
│ FILUSDT    ┆ -2.547177    ┆ 3    ┆ 91           │
│ ALPHAUSDT  ┆ -2.132375    ┆ 4    ┆ 90           │
│ BAKEUSDT   ┆ -2.079951    ┆ 5    ┆ 89           │
│ NKNUSDT    ┆ -2.002171    ┆ 6    ┆ 88           │
│ IOTAUSDT   ┆ -1.894396    ┆ 7    ┆ 87           │
│ KAVAUSDT   ┆ -1.885919    ┆ 8    ┆ 86           │
│ SFPUSDT    ┆ -1.860823    ┆ 9    ┆ 85           │
│ …          ┆ …            ┆ …    ┆ …            │
│ LRCUSDT    ┆ 2.475816     ┆ 85   ┆ 9            │
│ BATUSDT    ┆ 2.718871     ┆ 86   ┆ 8            │
│ ROSEUSDT   ┆ 2.798983     ┆ 87   ┆ 7            │
│ SUSHIUSDT  ┆ 2.854321     ┆ 88   ┆ 6            │
│ OPUSDT     ┆ 2.926753     ┆ 89   ┆ 5            │
│ IOSTUSDT   ┆ 3.499564     ┆ 90   ┆ 4            │
│ CHRUSDT    ┆ 4.392785     ┆ 91   ┆ 3            │
│ BLZUSDT    ┆ 4.428601     ┆ 92   ┆ 2            │
│ ONTUSDT    ┆ 8.04996      ┆ 93   ┆ 1            │
│ XEMUSDT    ┆ 10.857376    ┆ 94   ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,436 - WARNING - 2023-02-02T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,436 - INFO - cur close time: 2023-02-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:02,436 - DEBUG - mean expected ret (mean factor): 0.3038213705481507
2024-12-12 23:54:02,440 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,440 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,440 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1694      ┆ null        ┆ … ┆ 0.02826 ┆ null   ┆ null    ┆ 0.2322  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,448 - DEBUG - update position: 2023-02-02T23:59:59.999 === diff_trading_value: 364642.3881648623 == cash: 100526.73481983856 
2024-12-12 23:54:02,448 - INFO - pnl: 2023-02-02T23:59:59.999 100526.73481983856 === -5.691%
2024-12-12 23:54:02,452 - DEBUG - cur time: 2023-02-03T23:59:59.999 == next bar open time: 2023-02-04T00:00:00.000 == close pos time: 2023-02-09T00:00:00.000
2024-12-12 23:54:02,452 - INFO - pnl: 2023-02-03T23:59:59.999 102290.0271099681 === 1.754%
2024-12-12 23:54:02,455 - DEBUG - cur time: 2023-02-04T23:59:59.999 == next bar open time: 2023-02-05T00:00:00.000 == close pos time: 2023-02-10T00:00:00.000
2024-12-12 23:54:02,455 - INFO - pnl: 2023-02-04T23:59:59.999 100277.13790130797 === -1.968%
2024-12-12 23:54:02,455 - DEBUG - cur time: 2023-02-05T23:59:59.999 == next bar open time: 2023-02-06T00:00:00.000 == close pos time: 2023-02-11T00:00:00.000
2024-12-12 23:54:02,459 - INFO - pnl: 2023-02-05T23:59:59.999 103059.26170607437 === 2.774%
2024-12-12 23:54:02,459 - DEBUG - cur time: 2023-02-06T23:59:59.999 == next bar open time: 2023-02-07T00:00:00.000 == close pos time: 2023-02-12T00:00:00.000
2024-12-12 23:54:02,459 - INFO - pnl: 2023-02-06T23:59:59.999 102942.5688287062 === -0.113%
2024-12-12 23:54:02,463 - DEBUG - cur time: 2023-02-07T23:59:59.999 == next bar open time: 2023-02-08T00:00:00.000 == close pos time: 2023-02-13T00:00:00.000
2024-12-12 23:54:02,471 - DEBUG - close time 2023-02-07T23:59:59.999 == vol_threshold: 28203167.1
2024-12-12 23:54:02,471 - DEBUG - 2023-02-07T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:02,471 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DUSKUSDT     ┆ -3.558336    ┆ 0    ┆ 94           │
│ ZILUSDT      ┆ -3.179683    ┆ 1    ┆ 93           │
│ STGUSDT      ┆ -2.817054    ┆ 2    ┆ 92           │
│ 1INCHUSDT    ┆ -2.750443    ┆ 3    ┆ 91           │
│ RENUSDT      ┆ -2.681785    ┆ 4    ┆ 90           │
│ 1000SHIBUSDT ┆ -2.529522    ┆ 5    ┆ 89           │
│ APTUSDT      ┆ -2.409952    ┆ 6    ┆ 88           │
│ ICXUSDT      ┆ -2.379339    ┆ 7    ┆ 87           │
│ NKNUSDT      ┆ -2.23956     ┆ 8    ┆ 86           │
│ RLCUSDT      ┆ -2.216163    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ LITUSDT      ┆ 2.509061     ┆ 85   ┆ 9            │
│ SKLUSDT      ┆ 2.734597     ┆ 86   ┆ 8            │
│ ZRXUSDT      ┆ 2.872466     ┆ 87   ┆ 7            │
│ ROSEUSDT     ┆ 2.910016     ┆ 88   ┆ 6            │
│ VETUSDT      ┆ 2.983835     ┆ 89   ┆ 5            │
│ CHRUSDT      ┆ 3.099184     ┆ 90   ┆ 4            │
│ GRTUSDT      ┆ 3.1495       ┆ 91   ┆ 3            │
│ ADAUSDT      ┆ 3.505482     ┆ 92   ┆ 2            │
│ FLOWUSDT     ┆ 4.335192     ┆ 93   ┆ 1            │
│ EOSUSDT      ┆ 6.184678     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,475 - WARNING - 2023-02-07T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,475 - INFO - cur close time: 2023-02-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:02,475 - DEBUG - mean expected ret (mean factor): 0.11222518096319486
2024-12-12 23:54:02,480 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,480 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,480 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1862      ┆ null        ┆ … ┆ 0.03091 ┆ null   ┆ null    ┆ 0.261   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,488 - DEBUG - update position: 2023-02-07T23:59:59.999 === diff_trading_value: 335988.83610496717 == cash: 104414.29820780316 
2024-12-12 23:54:02,488 - INFO - pnl: 2023-02-07T23:59:59.999 104414.29820780316 === 1.430%
2024-12-12 23:54:02,489 - DEBUG - cur time: 2023-02-08T23:59:59.999 == next bar open time: 2023-02-09T00:00:00.000 == close pos time: 2023-02-14T00:00:00.000
2024-12-12 23:54:02,492 - INFO - pnl: 2023-02-08T23:59:59.999 105203.2940215951 === 0.756%
2024-12-12 23:54:02,492 - DEBUG - cur time: 2023-02-09T23:59:59.999 == next bar open time: 2023-02-10T00:00:00.000 == close pos time: 2023-02-15T00:00:00.000
2024-12-12 23:54:02,496 - INFO - pnl: 2023-02-09T23:59:59.999 106730.74104401779 === 1.452%
2024-12-12 23:54:02,496 - DEBUG - cur time: 2023-02-10T23:59:59.999 == next bar open time: 2023-02-11T00:00:00.000 == close pos time: 2023-02-16T00:00:00.000
2024-12-12 23:54:02,500 - INFO - pnl: 2023-02-10T23:59:59.999 105601.76798548058 === -1.058%
2024-12-12 23:54:02,500 - DEBUG - cur time: 2023-02-11T23:59:59.999 == next bar open time: 2023-02-12T00:00:00.000 == close pos time: 2023-02-17T00:00:00.000
2024-12-12 23:54:02,500 - INFO - pnl: 2023-02-11T23:59:59.999 104217.13073848316 === -1.311%
2024-12-12 23:54:02,505 - DEBUG - cur time: 2023-02-12T23:59:59.999 == next bar open time: 2023-02-13T00:00:00.000 == close pos time: 2023-02-18T00:00:00.000
2024-12-12 23:54:02,510 - DEBUG - close time 2023-02-12T23:59:59.999 == vol_threshold: 13600306.45
2024-12-12 23:54:02,513 - DEBUG - 2023-02-12T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:02,513 - DEBUG - sorted_long_factors: shape: (95, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ARPAUSDT  ┆ -5.756414    ┆ 0    ┆ 94           │
│ XRPUSDT   ┆ -4.518831    ┆ 1    ┆ 93           │
│ SANDUSDT  ┆ -4.091591    ┆ 2    ┆ 92           │
│ JASMYUSDT ┆ -3.353361    ┆ 3    ┆ 91           │
│ FLOWUSDT  ┆ -3.118311    ┆ 4    ┆ 90           │
│ RLCUSDT   ┆ -2.89188     ┆ 5    ┆ 89           │
│ XLMUSDT   ┆ -2.631053    ┆ 6    ┆ 88           │
│ REEFUSDT  ┆ -2.608395    ┆ 7    ┆ 87           │
│ APTUSDT   ┆ -2.356256    ┆ 8    ┆ 86           │
│ WOOUSDT   ┆ -2.333944    ┆ 9    ┆ 85           │
│ …         ┆ …            ┆ …    ┆ …            │
│ DUSKUSDT  ┆ 3.199093     ┆ 85   ┆ 9            │
│ HBARUSDT  ┆ 3.412789     ┆ 86   ┆ 8            │
│ ICXUSDT   ┆ 3.464627     ┆ 87   ┆ 7            │
│ SXPUSDT   ┆ 3.571537     ┆ 88   ┆ 6            │
│ ROSEUSDT  ┆ 3.664116     ┆ 89   ┆ 5            │
│ LINAUSDT  ┆ 3.907538     ┆ 90   ┆ 4            │
│ IOTAUSDT  ┆ 3.999677     ┆ 91   ┆ 3            │
│ KLAYUSDT  ┆ 4.097067     ┆ 92   ┆ 2            │
│ XEMUSDT   ┆ 4.825658     ┆ 93   ┆ 1            │
│ DENTUSDT  ┆ 5.803744     ┆ 94   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,519 - WARNING - 2023-02-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,519 - INFO - cur close time: 2023-02-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:02,519 - DEBUG - mean expected ret (mean factor): 0.12274811589043548
2024-12-12 23:54:02,522 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,522 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,522 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1651      ┆ null        ┆ … ┆ 0.02919 ┆ null   ┆ null    ┆ 0.234   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,531 - DEBUG - update position: 2023-02-12T23:59:59.999 === diff_trading_value: 323714.6776219368 == cash: 102323.04262812619 
2024-12-12 23:54:02,532 - INFO - pnl: 2023-02-12T23:59:59.999 102323.04262812619 === -1.817%
2024-12-12 23:54:02,533 - DEBUG - cur time: 2023-02-13T23:59:59.999 == next bar open time: 2023-02-14T00:00:00.000 == close pos time: 2023-02-19T00:00:00.000
2024-12-12 23:54:02,533 - INFO - pnl: 2023-02-13T23:59:59.999 100295.49589157841 === -1.982%
2024-12-12 23:54:02,537 - DEBUG - cur time: 2023-02-14T23:59:59.999 == next bar open time: 2023-02-15T00:00:00.000 == close pos time: 2023-02-20T00:00:00.000
2024-12-12 23:54:02,539 - INFO - pnl: 2023-02-14T23:59:59.999 100105.59206191104 === -0.189%
2024-12-12 23:54:02,539 - DEBUG - cur time: 2023-02-15T23:59:59.999 == next bar open time: 2023-02-16T00:00:00.000 == close pos time: 2023-02-21T00:00:00.000
2024-12-12 23:54:02,539 - INFO - pnl: 2023-02-15T23:59:59.999 101187.40595193094 === 1.081%
2024-12-12 23:54:02,543 - DEBUG - cur time: 2023-02-16T23:59:59.999 == next bar open time: 2023-02-17T00:00:00.000 == close pos time: 2023-02-22T00:00:00.000
2024-12-12 23:54:02,543 - INFO - pnl: 2023-02-16T23:59:59.999 101773.28156727609 === 0.579%
2024-12-12 23:54:02,546 - DEBUG - cur time: 2023-02-17T23:59:59.999 == next bar open time: 2023-02-18T00:00:00.000 == close pos time: 2023-02-23T00:00:00.000
2024-12-12 23:54:02,555 - DEBUG - close time 2023-02-17T23:59:59.999 == vol_threshold: 23315541.0
2024-12-12 23:54:02,555 - DEBUG - 2023-02-17T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:02,559 - DEBUG - sorted_long_factors: shape: (95, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ARPAUSDT  ┆ -5.448918    ┆ 0    ┆ 94           │
│ 1INCHUSDT ┆ -3.872543    ┆ 1    ┆ 93           │
│ CHZUSDT   ┆ -3.496677    ┆ 2    ┆ 92           │
│ SKLUSDT   ┆ -3.041982    ┆ 3    ┆ 91           │
│ ATAUSDT   ┆ -3.018844    ┆ 4    ┆ 90           │
│ BAKEUSDT  ┆ -2.441503    ┆ 5    ┆ 89           │
│ APTUSDT   ┆ -2.365666    ┆ 6    ┆ 88           │
│ DOGEUSDT  ┆ -2.288318    ┆ 7    ┆ 87           │
│ SXPUSDT   ┆ -1.854347    ┆ 8    ┆ 86           │
│ ENJUSDT   ┆ -1.744179    ┆ 9    ┆ 85           │
│ …         ┆ …            ┆ …    ┆ …            │
│ MATICUSDT ┆ 3.062316     ┆ 85   ┆ 9            │
│ CRVUSDT   ┆ 3.07463      ┆ 86   ┆ 8            │
│ IOSTUSDT  ┆ 3.243258     ┆ 87   ┆ 7            │
│ EOSUSDT   ┆ 3.397047     ┆ 88   ┆ 6            │
│ FLOWUSDT  ┆ 3.642101     ┆ 89   ┆ 5            │
│ VETUSDT   ┆ 3.975683     ┆ 90   ┆ 4            │
│ KLAYUSDT  ┆ 4.200586     ┆ 91   ┆ 3            │
│ APEUSDT   ┆ 4.213289     ┆ 92   ┆ 2            │
│ FILUSDT   ┆ 4.794599     ┆ 93   ┆ 1            │
│ CTSIUSDT  ┆ 5.350708     ┆ 94   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,563 - WARNING - 2023-02-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,563 - INFO - cur close time: 2023-02-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:02,563 - DEBUG - mean expected ret (mean factor): 0.49326114283573413
2024-12-12 23:54:02,567 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,567 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,567 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1701      ┆ null        ┆ … ┆ 0.03193 ┆ null   ┆ null    ┆ 0.2618  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,571 - DEBUG - update position: 2023-02-17T23:59:59.999 === diff_trading_value: 351711.4011978904 == cash: 100740.25333845668 
2024-12-12 23:54:02,575 - INFO - pnl: 2023-02-17T23:59:59.999 100740.25333845668 === -1.015%
2024-12-12 23:54:02,575 - DEBUG - cur time: 2023-02-18T23:59:59.999 == next bar open time: 2023-02-19T00:00:00.000 == close pos time: 2023-02-24T00:00:00.000
2024-12-12 23:54:02,575 - INFO - pnl: 2023-02-18T23:59:59.999 101223.40456902384 === 0.480%
2024-12-12 23:54:02,579 - DEBUG - cur time: 2023-02-19T23:59:59.999 == next bar open time: 2023-02-20T00:00:00.000 == close pos time: 2023-02-25T00:00:00.000
2024-12-12 23:54:02,579 - INFO - pnl: 2023-02-19T23:59:59.999 102816.5899971603 === 1.574%
2024-12-12 23:54:02,583 - DEBUG - cur time: 2023-02-20T23:59:59.999 == next bar open time: 2023-02-21T00:00:00.000 == close pos time: 2023-02-26T00:00:00.000
2024-12-12 23:54:02,583 - INFO - pnl: 2023-02-20T23:59:59.999 103585.09517108892 === 0.747%
2024-12-12 23:54:02,587 - DEBUG - cur time: 2023-02-21T23:59:59.999 == next bar open time: 2023-02-22T00:00:00.000 == close pos time: 2023-02-27T00:00:00.000
2024-12-12 23:54:02,589 - INFO - pnl: 2023-02-21T23:59:59.999 101074.71401600515 === -2.423%
2024-12-12 23:54:02,589 - DEBUG - cur time: 2023-02-22T23:59:59.999 == next bar open time: 2023-02-23T00:00:00.000 == close pos time: 2023-02-28T00:00:00.000
2024-12-12 23:54:02,597 - DEBUG - close time 2023-02-22T23:59:59.999 == vol_threshold: 21296051.34
2024-12-12 23:54:02,597 - DEBUG - 2023-02-22T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:02,601 - DEBUG - sorted_long_factors: shape: (95, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ 1000XECUSDT ┆ -4.861225    ┆ 0    ┆ 94           │
│ SFPUSDT     ┆ -4.088977    ┆ 1    ┆ 93           │
│ DARUSDT     ┆ -3.392346    ┆ 2    ┆ 92           │
│ NKNUSDT     ┆ -3.039356    ┆ 3    ┆ 91           │
│ FLOWUSDT    ┆ -2.916429    ┆ 4    ┆ 90           │
│ IOTXUSDT    ┆ -2.723099    ┆ 5    ┆ 89           │
│ ROSEUSDT    ┆ -2.568813    ┆ 6    ┆ 88           │
│ REEFUSDT    ┆ -2.55856     ┆ 7    ┆ 87           │
│ COTIUSDT    ┆ -2.39889     ┆ 8    ┆ 86           │
│ XLMUSDT     ┆ -2.129308    ┆ 9    ┆ 85           │
│ …           ┆ …            ┆ …    ┆ …            │
│ ZRXUSDT     ┆ 2.786491     ┆ 85   ┆ 9            │
│ EOSUSDT     ┆ 2.836665     ┆ 86   ┆ 8            │
│ LITUSDT     ┆ 3.043004     ┆ 87   ┆ 7            │
│ CRVUSDT     ┆ 3.336422     ┆ 88   ┆ 6            │
│ LRCUSDT     ┆ 3.611323     ┆ 89   ┆ 5            │
│ MTLUSDT     ┆ 3.636276     ┆ 90   ┆ 4            │
│ XTZUSDT     ┆ 3.770499     ┆ 91   ┆ 3            │
│ STMXUSDT    ┆ 4.320116     ┆ 92   ┆ 2            │
│ ANKRUSDT    ┆ 4.543652     ┆ 93   ┆ 1            │
│ LINAUSDT    ┆ 4.789532     ┆ 94   ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,605 - WARNING - 2023-02-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,605 - INFO - cur close time: 2023-02-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:02,605 - DEBUG - mean expected ret (mean factor): 0.3500899990774319
2024-12-12 23:54:02,609 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,610 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,610 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1637      ┆ null        ┆ … ┆ 0.03529 ┆ null   ┆ null    ┆ 0.2628  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,613 - DEBUG - update position: 2023-02-22T23:59:59.999 === diff_trading_value: 335666.22570246353 == cash: 99449.27419910418 
2024-12-12 23:54:02,613 - INFO - pnl: 2023-02-22T23:59:59.999 99449.27419910418 === -1.608%
2024-12-12 23:54:02,618 - DEBUG - cur time: 2023-02-23T23:59:59.999 == next bar open time: 2023-02-24T00:00:00.000 == close pos time: 2023-03-01T00:00:00.000
2024-12-12 23:54:02,620 - INFO - pnl: 2023-02-23T23:59:59.999 99970.45328570092 === 0.524%
2024-12-12 23:54:02,621 - DEBUG - cur time: 2023-02-24T23:59:59.999 == next bar open time: 2023-02-25T00:00:00.000 == close pos time: 2023-03-02T00:00:00.000
2024-12-12 23:54:02,621 - INFO - pnl: 2023-02-24T23:59:59.999 100221.99026504789 === 0.252%
2024-12-12 23:54:02,625 - DEBUG - cur time: 2023-02-25T23:59:59.999 == next bar open time: 2023-02-26T00:00:00.000 == close pos time: 2023-03-03T00:00:00.000
2024-12-12 23:54:02,625 - INFO - pnl: 2023-02-25T23:59:59.999 99007.08181453157 === -1.212%
2024-12-12 23:54:02,625 - DEBUG - cur time: 2023-02-26T23:59:59.999 == next bar open time: 2023-02-27T00:00:00.000 == close pos time: 2023-03-04T00:00:00.000
2024-12-12 23:54:02,630 - INFO - pnl: 2023-02-26T23:59:59.999 99507.65495681825 === 0.506%
2024-12-12 23:54:02,630 - DEBUG - cur time: 2023-02-27T23:59:59.999 == next bar open time: 2023-02-28T00:00:00.000 == close pos time: 2023-03-05T00:00:00.000
2024-12-12 23:54:02,641 - DEBUG - close time 2023-02-27T23:59:59.999 == vol_threshold: 17376414.5
2024-12-12 23:54:02,641 - DEBUG - 2023-02-27T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:02,641 - DEBUG - sorted_long_factors: shape: (95, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ IOTXUSDT   ┆ -4.096687    ┆ 0    ┆ 94           │
│ BAKEUSDT   ┆ -3.943684    ┆ 1    ┆ 93           │
│ BELUSDT    ┆ -3.79137     ┆ 2    ┆ 92           │
│ PEOPLEUSDT ┆ -3.464349    ┆ 3    ┆ 91           │
│ ARPAUSDT   ┆ -2.458674    ┆ 4    ┆ 90           │
│ COTIUSDT   ┆ -2.33518     ┆ 5    ┆ 89           │
│ IOTAUSDT   ┆ -2.27021     ┆ 6    ┆ 88           │
│ DARUSDT    ┆ -2.218109    ┆ 7    ┆ 87           │
│ IMXUSDT    ┆ -2.149562    ┆ 8    ┆ 86           │
│ IOSTUSDT   ┆ -2.070797    ┆ 9    ┆ 85           │
│ …          ┆ …            ┆ …    ┆ …            │
│ FLOWUSDT   ┆ 3.073016     ┆ 85   ┆ 9            │
│ TRXUSDT    ┆ 3.218802     ┆ 86   ┆ 8            │
│ CRVUSDT    ┆ 3.341219     ┆ 87   ┆ 7            │
│ ZRXUSDT    ┆ 3.507198     ┆ 88   ┆ 6            │
│ DGBUSDT    ┆ 3.691318     ┆ 89   ┆ 5            │
│ HOTUSDT    ┆ 3.720876     ┆ 90   ┆ 4            │
│ GTCUSDT    ┆ 4.073595     ┆ 91   ┆ 3            │
│ OMGUSDT    ┆ 4.144014     ┆ 92   ┆ 2            │
│ XEMUSDT    ┆ 5.563181     ┆ 93   ┆ 1            │
│ ICXUSDT    ┆ 6.297183     ┆ 94   ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,645 - WARNING - 2023-02-27T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,645 - INFO - cur close time: 2023-02-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:02,649 - DEBUG - mean expected ret (mean factor): 0.3190296154703033
2024-12-12 23:54:02,653 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,653 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,653 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1614      ┆ null        ┆ … ┆ 0.03241 ┆ null   ┆ null    ┆ 0.2614  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,659 - DEBUG - update position: 2023-02-27T23:59:59.999 === diff_trading_value: 312057.64881666226 == cash: 98612.69360855703 
2024-12-12 23:54:02,659 - INFO - pnl: 2023-02-27T23:59:59.999 98612.69360855703 === -0.899%
2024-12-12 23:54:02,661 - DEBUG - cur time: 2023-02-28T23:59:59.999 == next bar open time: 2023-03-01T00:00:00.000 == close pos time: 2023-03-06T00:00:00.000
2024-12-12 23:54:02,661 - INFO - pnl: 2023-02-28T23:59:59.999 96897.51215584272 === -1.739%
2024-12-12 23:54:02,665 - DEBUG - cur time: 2023-03-01T23:59:59.999 == next bar open time: 2023-03-02T00:00:00.000 == close pos time: 2023-03-07T00:00:00.000
2024-12-12 23:54:02,665 - INFO - pnl: 2023-03-01T23:59:59.999 97937.57354760313 === 1.073%
2024-12-12 23:54:02,669 - DEBUG - cur time: 2023-03-02T23:59:59.999 == next bar open time: 2023-03-03T00:00:00.000 == close pos time: 2023-03-08T00:00:00.000
2024-12-12 23:54:02,669 - INFO - pnl: 2023-03-02T23:59:59.999 97385.6453807417 === -0.564%
2024-12-12 23:54:02,674 - DEBUG - cur time: 2023-03-03T23:59:59.999 == next bar open time: 2023-03-04T00:00:00.000 == close pos time: 2023-03-09T00:00:00.000
2024-12-12 23:54:02,674 - INFO - pnl: 2023-03-03T23:59:59.999 98040.24484346487 === 0.672%
2024-12-12 23:54:02,678 - DEBUG - cur time: 2023-03-04T23:59:59.999 == next bar open time: 2023-03-05T00:00:00.000 == close pos time: 2023-03-10T00:00:00.000
2024-12-12 23:54:02,686 - DEBUG - close time 2023-03-04T23:59:59.999 == vol_threshold: 14366277.7
2024-12-12 23:54:02,686 - DEBUG - 2023-03-04T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:02,688 - DEBUG - sorted_long_factors: shape: (95, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ATAUSDT     ┆ -4.788058    ┆ 0    ┆ 94           │
│ ALPHAUSDT   ┆ -4.185674    ┆ 1    ┆ 93           │
│ SXPUSDT     ┆ -3.685509    ┆ 2    ┆ 92           │
│ BAKEUSDT    ┆ -3.425779    ┆ 3    ┆ 91           │
│ RVNUSDT     ┆ -3.238869    ┆ 4    ┆ 90           │
│ ARPAUSDT    ┆ -3.227185    ┆ 5    ┆ 89           │
│ COTIUSDT    ┆ -2.840826    ┆ 6    ┆ 88           │
│ NKNUSDT     ┆ -2.49882     ┆ 7    ┆ 87           │
│ FILUSDT     ┆ -2.428699    ┆ 8    ┆ 86           │
│ OPUSDT      ┆ -2.273487    ┆ 9    ┆ 85           │
│ …           ┆ …            ┆ …    ┆ …            │
│ DENTUSDT    ┆ 1.882979     ┆ 85   ┆ 9            │
│ KNCUSDT     ┆ 2.057899     ┆ 86   ┆ 8            │
│ FLOWUSDT    ┆ 2.559489     ┆ 87   ┆ 7            │
│ NEOUSDT     ┆ 2.931768     ┆ 88   ┆ 6            │
│ RENUSDT     ┆ 3.326705     ┆ 89   ┆ 5            │
│ XEMUSDT     ┆ 3.625081     ┆ 90   ┆ 4            │
│ REEFUSDT    ┆ 4.294127     ┆ 91   ┆ 3            │
│ DGBUSDT     ┆ 5.370804     ┆ 92   ┆ 2            │
│ SNXUSDT     ┆ 5.49627      ┆ 93   ┆ 1            │
│ 1000XECUSDT ┆ 8.082659     ┆ 94   ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,692 - WARNING - 2023-03-04T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,692 - INFO - cur close time: 2023-03-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:02,692 - DEBUG - mean expected ret (mean factor): -0.06456764798499103
2024-12-12 23:54:02,696 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,696 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,699 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1457      ┆ null        ┆ … ┆ 0.02737 ┆ null   ┆ null    ┆ 0.2402  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,704 - DEBUG - update position: 2023-03-04T23:59:59.999 === diff_trading_value: 261678.22052947676 == cash: 98334.50506243596 
2024-12-12 23:54:02,704 - INFO - pnl: 2023-03-04T23:59:59.999 98334.50506243596 === 0.300%
2024-12-12 23:54:02,708 - DEBUG - cur time: 2023-03-05T23:59:59.999 == next bar open time: 2023-03-06T00:00:00.000 == close pos time: 2023-03-11T00:00:00.000
2024-12-12 23:54:02,710 - INFO - pnl: 2023-03-05T23:59:59.999 97201.49595093196 === -1.152%
2024-12-12 23:54:02,710 - DEBUG - cur time: 2023-03-06T23:59:59.999 == next bar open time: 2023-03-07T00:00:00.000 == close pos time: 2023-03-12T00:00:00.000
2024-12-12 23:54:02,713 - INFO - pnl: 2023-03-06T23:59:59.999 96403.305121929 === -0.821%
2024-12-12 23:54:02,713 - DEBUG - cur time: 2023-03-07T23:59:59.999 == next bar open time: 2023-03-08T00:00:00.000 == close pos time: 2023-03-13T00:00:00.000
2024-12-12 23:54:02,717 - INFO - pnl: 2023-03-07T23:59:59.999 96020.84609966844 === -0.397%
2024-12-12 23:54:02,720 - DEBUG - cur time: 2023-03-08T23:59:59.999 == next bar open time: 2023-03-09T00:00:00.000 == close pos time: 2023-03-14T00:00:00.000
2024-12-12 23:54:02,721 - INFO - pnl: 2023-03-08T23:59:59.999 96291.1926292904 === 0.282%
2024-12-12 23:54:02,721 - DEBUG - cur time: 2023-03-09T23:59:59.999 == next bar open time: 2023-03-10T00:00:00.000 == close pos time: 2023-03-15T00:00:00.000
2024-12-12 23:54:02,730 - DEBUG - close time 2023-03-09T23:59:59.999 == vol_threshold: 22986462.7
2024-12-12 23:54:02,730 - DEBUG - 2023-03-09T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:02,730 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DOGEUSDT     ┆ -4.888176    ┆ 0    ┆ 94           │
│ SPELLUSDT    ┆ -3.882351    ┆ 1    ┆ 93           │
│ NKNUSDT      ┆ -3.872669    ┆ 2    ┆ 92           │
│ ARPAUSDT     ┆ -3.562271    ┆ 3    ┆ 91           │
│ 1000SHIBUSDT ┆ -3.55334     ┆ 4    ┆ 90           │
│ RVNUSDT      ┆ -3.550159    ┆ 5    ┆ 89           │
│ BAKEUSDT     ┆ -3.530843    ┆ 6    ┆ 88           │
│ BATUSDT      ┆ -3.438119    ┆ 7    ┆ 87           │
│ DGBUSDT      ┆ -3.367139    ┆ 8    ┆ 86           │
│ HBARUSDT     ┆ -2.910412    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ OPUSDT       ┆ 2.42479      ┆ 85   ┆ 9            │
│ CELOUSDT     ┆ 2.58917      ┆ 86   ┆ 8            │
│ NEARUSDT     ┆ 2.648703     ┆ 87   ┆ 7            │
│ OGNUSDT      ┆ 2.674154     ┆ 88   ┆ 6            │
│ IMXUSDT      ┆ 3.006888     ┆ 89   ┆ 5            │
│ STGUSDT      ┆ 3.384316     ┆ 90   ┆ 4            │
│ TOMOUSDT     ┆ 4.085459     ┆ 91   ┆ 3            │
│ KLAYUSDT     ┆ 6.063679     ┆ 92   ┆ 2            │
│ CELRUSDT     ┆ 7.179009     ┆ 93   ┆ 1            │
│ KAVAUSDT     ┆ 7.960195     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,734 - WARNING - 2023-03-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,738 - INFO - cur close time: 2023-03-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:02,738 - DEBUG - mean expected ret (mean factor): 0.12032603670788475
2024-12-12 23:54:02,741 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,741 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,741 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.129       ┆ null        ┆ … ┆ 0.02256 ┆ null   ┆ null    ┆ 0.1991  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,749 - DEBUG - update position: 2023-03-09T23:59:59.999 === diff_trading_value: 270411.05086570006 == cash: 96044.10813324193 
2024-12-12 23:54:02,750 - INFO - pnl: 2023-03-09T23:59:59.999 96044.10813324193 === -0.257%
2024-12-12 23:54:02,753 - DEBUG - cur time: 2023-03-10T23:59:59.999 == next bar open time: 2023-03-11T00:00:00.000 == close pos time: 2023-03-16T00:00:00.000
2024-12-12 23:54:02,753 - INFO - pnl: 2023-03-10T23:59:59.999 96362.99449240984 === 0.332%
2024-12-12 23:54:02,757 - DEBUG - cur time: 2023-03-11T23:59:59.999 == next bar open time: 2023-03-12T00:00:00.000 == close pos time: 2023-03-17T00:00:00.000
2024-12-12 23:54:02,757 - INFO - pnl: 2023-03-11T23:59:59.999 94299.19305386745 === -2.142%
2024-12-12 23:54:02,761 - DEBUG - cur time: 2023-03-12T23:59:59.999 == next bar open time: 2023-03-13T00:00:00.000 == close pos time: 2023-03-18T00:00:00.000
2024-12-12 23:54:02,761 - INFO - pnl: 2023-03-12T23:59:59.999 96820.60175340905 === 2.674%
2024-12-12 23:54:02,765 - DEBUG - cur time: 2023-03-13T23:59:59.999 == next bar open time: 2023-03-14T00:00:00.000 == close pos time: 2023-03-19T00:00:00.000
2024-12-12 23:54:02,765 - INFO - pnl: 2023-03-13T23:59:59.999 99782.1947109947 === 3.059%
2024-12-12 23:54:02,770 - DEBUG - cur time: 2023-03-14T23:59:59.999 == next bar open time: 2023-03-15T00:00:00.000 == close pos time: 2023-03-20T00:00:00.000
2024-12-12 23:54:02,779 - DEBUG - close time 2023-03-14T23:59:59.999 == vol_threshold: 32631972.71999998
2024-12-12 23:54:02,780 - DEBUG - 2023-03-14T23:59:59.999 == all trade symbol 135 == remain 94 after VOL filter
2024-12-12 23:54:02,781 - DEBUG - sorted_long_factors: shape: (94, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RSRUSDT      ┆ -3.515657    ┆ 0    ┆ 93           │
│ SKLUSDT      ┆ -3.343781    ┆ 1    ┆ 92           │
│ XRPUSDT      ┆ -2.919141    ┆ 2    ┆ 91           │
│ STORJUSDT    ┆ -2.908034    ┆ 3    ┆ 90           │
│ DARUSDT      ┆ -2.890153    ┆ 4    ┆ 89           │
│ 1000XECUSDT  ┆ -2.86838     ┆ 5    ┆ 88           │
│ FILUSDT      ┆ -2.799962    ┆ 6    ┆ 87           │
│ SPELLUSDT    ┆ -2.66518     ┆ 7    ┆ 86           │
│ 1000SHIBUSDT ┆ -2.324312    ┆ 8    ┆ 85           │
│ DUSKUSDT     ┆ -2.303659    ┆ 9    ┆ 84           │
│ …            ┆ …            ┆ …    ┆ …            │
│ NEARUSDT     ┆ 1.746901     ┆ 84   ┆ 9            │
│ IMXUSDT      ┆ 2.237477     ┆ 85   ┆ 8            │
│ INJUSDT      ┆ 2.595127     ┆ 86   ┆ 7            │
│ COTIUSDT     ┆ 2.844231     ┆ 87   ┆ 6            │
│ SNXUSDT      ┆ 3.197377     ┆ 88   ┆ 5            │
│ XTZUSDT      ┆ 3.290415     ┆ 89   ┆ 4            │
│ TOMOUSDT     ┆ 3.514544     ┆ 90   ┆ 3            │
│ OGNUSDT      ┆ 4.030571     ┆ 91   ┆ 2            │
│ RVNUSDT      ┆ 4.269444     ┆ 92   ┆ 1            │
│ XLMUSDT      ┆ 5.085219     ┆ 93   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,785 - WARNING - 2023-03-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,785 - INFO - cur close time: 2023-03-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:02,785 - DEBUG - mean expected ret (mean factor): -0.1708882448912098
2024-12-12 23:54:02,789 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,789 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,789 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.133       ┆ null        ┆ … ┆ 0.02816 ┆ null   ┆ null    ┆ 0.2357  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,798 - DEBUG - update position: 2023-03-14T23:59:59.999 === diff_trading_value: 318398.36959940416 == cash: 100932.3743335393 
2024-12-12 23:54:02,800 - INFO - pnl: 2023-03-14T23:59:59.999 100932.3743335393 === 1.153%
2024-12-12 23:54:02,802 - DEBUG - cur time: 2023-03-15T23:59:59.999 == next bar open time: 2023-03-16T00:00:00.000 == close pos time: 2023-03-21T00:00:00.000
2024-12-12 23:54:02,802 - INFO - pnl: 2023-03-15T23:59:59.999 101206.12191179195 === 0.271%
2024-12-12 23:54:02,806 - DEBUG - cur time: 2023-03-16T23:59:59.999 == next bar open time: 2023-03-17T00:00:00.000 == close pos time: 2023-03-22T00:00:00.000
2024-12-12 23:54:02,806 - INFO - pnl: 2023-03-16T23:59:59.999 101160.29795768467 === -0.045%
2024-12-12 23:54:02,810 - DEBUG - cur time: 2023-03-17T23:59:59.999 == next bar open time: 2023-03-18T00:00:00.000 == close pos time: 2023-03-23T00:00:00.000
2024-12-12 23:54:02,810 - INFO - pnl: 2023-03-17T23:59:59.999 103482.78507368479 === 2.296%
2024-12-12 23:54:02,814 - DEBUG - cur time: 2023-03-18T23:59:59.999 == next bar open time: 2023-03-19T00:00:00.000 == close pos time: 2023-03-24T00:00:00.000
2024-12-12 23:54:02,814 - INFO - pnl: 2023-03-18T23:59:59.999 103792.28181633356 === 0.299%
2024-12-12 23:54:02,818 - DEBUG - cur time: 2023-03-19T23:59:59.999 == next bar open time: 2023-03-20T00:00:00.000 == close pos time: 2023-03-25T00:00:00.000
2024-12-12 23:54:02,826 - DEBUG - close time 2023-03-19T23:59:59.999 == vol_threshold: 23537810.359999992
2024-12-12 23:54:02,826 - DEBUG - 2023-03-19T23:59:59.999 == all trade symbol 135 == remain 94 after VOL filter
2024-12-12 23:54:02,830 - DEBUG - sorted_long_factors: shape: (94, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -4.678418    ┆ 0    ┆ 93           │
│ IOSTUSDT     ┆ -4.461085    ┆ 1    ┆ 92           │
│ CHRUSDT      ┆ -2.912763    ┆ 2    ┆ 91           │
│ BELUSDT      ┆ -2.694756    ┆ 3    ┆ 90           │
│ FLMUSDT      ┆ -2.619776    ┆ 4    ┆ 89           │
│ STGUSDT      ┆ -2.617051    ┆ 5    ┆ 88           │
│ ENJUSDT      ┆ -2.599999    ┆ 6    ┆ 87           │
│ CHZUSDT      ┆ -2.315509    ┆ 7    ┆ 86           │
│ REEFUSDT     ┆ -2.255223    ┆ 8    ┆ 85           │
│ FILUSDT      ┆ -2.192844    ┆ 9    ┆ 84           │
│ …            ┆ …            ┆ …    ┆ …            │
│ QTUMUSDT     ┆ 2.309984     ┆ 84   ┆ 9            │
│ XTZUSDT      ┆ 2.401313     ┆ 85   ┆ 8            │
│ ZRXUSDT      ┆ 2.717866     ┆ 86   ┆ 7            │
│ NKNUSDT      ┆ 2.919201     ┆ 87   ┆ 6            │
│ API3USDT     ┆ 3.171672     ┆ 88   ┆ 5            │
│ EOSUSDT      ┆ 3.193278     ┆ 89   ┆ 4            │
│ MASKUSDT     ┆ 3.285189     ┆ 90   ┆ 3            │
│ LINAUSDT     ┆ 3.36897      ┆ 91   ┆ 2            │
│ SXPUSDT      ┆ 4.968703     ┆ 92   ┆ 1            │
│ OMGUSDT      ┆ 7.291537     ┆ 93   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,834 - INFO - cur close time: 2023-03-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:02,834 - DEBUG - mean expected ret (mean factor): 0.003748500111338436
2024-12-12 23:54:02,840 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,840 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,840 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1346      ┆ null        ┆ … ┆ 0.02937 ┆ null   ┆ null    ┆ 0.2494  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,847 - DEBUG - update position: 2023-03-19T23:59:59.999 === diff_trading_value: 324798.8686821471 == cash: 102886.18168060304 
2024-12-12 23:54:02,848 - INFO - pnl: 2023-03-19T23:59:59.999 102886.18168060304 === -0.873%
2024-12-12 23:54:02,849 - DEBUG - cur time: 2023-03-20T23:59:59.999 == next bar open time: 2023-03-21T00:00:00.000 == close pos time: 2023-03-26T00:00:00.000
2024-12-12 23:54:02,849 - INFO - pnl: 2023-03-20T23:59:59.999 104256.26977280888 === 1.332%
2024-12-12 23:54:02,855 - DEBUG - cur time: 2023-03-21T23:59:59.999 == next bar open time: 2023-03-22T00:00:00.000 == close pos time: 2023-03-27T00:00:00.000
2024-12-12 23:54:02,855 - INFO - pnl: 2023-03-21T23:59:59.999 102065.31997245044 === -2.102%
2024-12-12 23:54:02,859 - DEBUG - cur time: 2023-03-22T23:59:59.999 == next bar open time: 2023-03-23T00:00:00.000 == close pos time: 2023-03-28T00:00:00.000
2024-12-12 23:54:02,860 - INFO - pnl: 2023-03-22T23:59:59.999 101442.18407872834 === -0.611%
2024-12-12 23:54:02,860 - DEBUG - cur time: 2023-03-23T23:59:59.999 == next bar open time: 2023-03-24T00:00:00.000 == close pos time: 2023-03-29T00:00:00.000
2024-12-12 23:54:02,863 - INFO - pnl: 2023-03-23T23:59:59.999 101665.94990727205 === 0.221%
2024-12-12 23:54:02,867 - DEBUG - cur time: 2023-03-24T23:59:59.999 == next bar open time: 2023-03-25T00:00:00.000 == close pos time: 2023-03-30T00:00:00.000
2024-12-12 23:54:02,876 - DEBUG - close time 2023-03-24T23:59:59.999 == vol_threshold: 20213935.71999999
2024-12-12 23:54:02,876 - DEBUG - 2023-03-24T23:59:59.999 == all trade symbol 135 == remain 94 after VOL filter
2024-12-12 23:54:02,876 - DEBUG - sorted_long_factors: shape: (94, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XLMUSDT      ┆ -3.54299     ┆ 0    ┆ 93           │
│ FILUSDT      ┆ -3.350746    ┆ 1    ┆ 92           │
│ STGUSDT      ┆ -2.513438    ┆ 2    ┆ 91           │
│ SANDUSDT     ┆ -2.417096    ┆ 3    ┆ 90           │
│ APTUSDT      ┆ -2.30249     ┆ 4    ┆ 89           │
│ RSRUSDT      ┆ -2.028745    ┆ 5    ┆ 88           │
│ DOGEUSDT     ┆ -2.008476    ┆ 6    ┆ 87           │
│ 1000SHIBUSDT ┆ -1.941315    ┆ 7    ┆ 86           │
│ ATAUSDT      ┆ -1.851169    ┆ 8    ┆ 85           │
│ CRVUSDT      ┆ -1.646681    ┆ 9    ┆ 84           │
│ …            ┆ …            ┆ …    ┆ …            │
│ LUNA2USDT    ┆ 2.412959     ┆ 84   ┆ 9            │
│ ZILUSDT      ┆ 2.461766     ┆ 85   ┆ 8            │
│ STORJUSDT    ┆ 2.642858     ┆ 86   ┆ 7            │
│ OMGUSDT      ┆ 2.853        ┆ 87   ┆ 6            │
│ TRXUSDT      ┆ 2.854813     ┆ 88   ┆ 5            │
│ KLAYUSDT     ┆ 2.919955     ┆ 89   ┆ 4            │
│ TOMOUSDT     ┆ 3.082934     ┆ 90   ┆ 3            │
│ MASKUSDT     ┆ 3.611322     ┆ 91   ┆ 2            │
│ CELRUSDT     ┆ 3.636379     ┆ 92   ┆ 1            │
│ RLCUSDT      ┆ 5.102024     ┆ 93   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,880 - WARNING - 2023-03-24T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,884 - INFO - cur close time: 2023-03-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:02,884 - DEBUG - mean expected ret (mean factor): -0.04291998533687511
2024-12-12 23:54:02,888 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,888 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,888 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1225      ┆ null        ┆ … ┆ 0.02707 ┆ null   ┆ null    ┆ 0.2291  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,892 - DEBUG - update position: 2023-03-24T23:59:59.999 === diff_trading_value: 302598.83073653915 == cash: 103323.10635672255 
2024-12-12 23:54:02,892 - INFO - pnl: 2023-03-24T23:59:59.999 103323.10635672255 === 1.630%
2024-12-12 23:54:02,896 - DEBUG - cur time: 2023-03-25T23:59:59.999 == next bar open time: 2023-03-26T00:00:00.000 == close pos time: 2023-03-31T00:00:00.000
2024-12-12 23:54:02,896 - INFO - pnl: 2023-03-25T23:59:59.999 101796.87908703822 === -1.477%
2024-12-12 23:54:02,900 - DEBUG - cur time: 2023-03-26T23:59:59.999 == next bar open time: 2023-03-27T00:00:00.000 == close pos time: 2023-04-01T00:00:00.000
2024-12-12 23:54:02,900 - INFO - pnl: 2023-03-26T23:59:59.999 102370.71388143525 === 0.564%
2024-12-12 23:54:02,904 - DEBUG - cur time: 2023-03-27T23:59:59.999 == next bar open time: 2023-03-28T00:00:00.000 == close pos time: 2023-04-02T00:00:00.000
2024-12-12 23:54:02,904 - INFO - pnl: 2023-03-27T23:59:59.999 100589.66983495266 === -1.740%
2024-12-12 23:54:02,908 - DEBUG - cur time: 2023-03-28T23:59:59.999 == next bar open time: 2023-03-29T00:00:00.000 == close pos time: 2023-04-03T00:00:00.000
2024-12-12 23:54:02,909 - INFO - pnl: 2023-03-28T23:59:59.999 101497.0163003753 === 0.902%
2024-12-12 23:54:02,912 - DEBUG - cur time: 2023-03-29T23:59:59.999 == next bar open time: 2023-03-30T00:00:00.000 == close pos time: 2023-04-04T00:00:00.000
2024-12-12 23:54:02,920 - DEBUG - close time 2023-03-29T23:59:59.999 == vol_threshold: 25159443.05
2024-12-12 23:54:02,920 - DEBUG - 2023-03-29T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:02,920 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HOTUSDT      ┆ -5.077197    ┆ 0    ┆ 94           │
│ DGBUSDT      ┆ -4.160337    ┆ 1    ┆ 93           │
│ CHZUSDT      ┆ -3.277006    ┆ 2    ┆ 92           │
│ DUSKUSDT     ┆ -2.995418    ┆ 3    ┆ 91           │
│ FILUSDT      ┆ -2.984792    ┆ 4    ┆ 90           │
│ 1000LUNCUSDT ┆ -2.386235    ┆ 5    ┆ 89           │
│ IMXUSDT      ┆ -2.047015    ┆ 6    ┆ 88           │
│ ARPAUSDT     ┆ -1.993785    ┆ 7    ┆ 87           │
│ ALPHAUSDT    ┆ -1.968256    ┆ 8    ┆ 86           │
│ GTCUSDT      ┆ -1.919925    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ VETUSDT      ┆ 2.872559     ┆ 85   ┆ 9            │
│ C98USDT      ┆ 3.459481     ┆ 86   ┆ 8            │
│ ICXUSDT      ┆ 3.488745     ┆ 87   ┆ 7            │
│ MASKUSDT     ┆ 3.816922     ┆ 88   ┆ 6            │
│ STMXUSDT     ┆ 3.82954      ┆ 89   ┆ 5            │
│ LITUSDT      ┆ 3.952022     ┆ 90   ┆ 4            │
│ TOMOUSDT     ┆ 4.444608     ┆ 91   ┆ 3            │
│ IOTAUSDT     ┆ 5.014071     ┆ 92   ┆ 2            │
│ CELOUSDT     ┆ 5.028404     ┆ 93   ┆ 1            │
│ SXPUSDT      ┆ 5.955153     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,924 - WARNING - 2023-03-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:02,924 - INFO - cur close time: 2023-03-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:02,924 - DEBUG - mean expected ret (mean factor): 0.5788245524866431
2024-12-12 23:54:02,930 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,930 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,932 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1242      ┆ null        ┆ … ┆ 0.02827 ┆ null   ┆ null    ┆ 0.2375  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,936 - DEBUG - update position: 2023-03-29T23:59:59.999 === diff_trading_value: 324804.15811838803 == cash: 101827.86378847806 
2024-12-12 23:54:02,939 - INFO - pnl: 2023-03-29T23:59:59.999 101827.86378847806 === 0.326%
2024-12-12 23:54:02,939 - DEBUG - cur time: 2023-03-30T23:59:59.999 == next bar open time: 2023-03-31T00:00:00.000 == close pos time: 2023-04-05T00:00:00.000
2024-12-12 23:54:02,939 - INFO - pnl: 2023-03-30T23:59:59.999 99421.39857605008 === -2.363%
2024-12-12 23:54:02,943 - DEBUG - cur time: 2023-03-31T23:59:59.999 == next bar open time: 2023-04-01T00:00:00.000 == close pos time: 2023-04-06T00:00:00.000
2024-12-12 23:54:02,943 - INFO - pnl: 2023-03-31T23:59:59.999 102733.55648778856 === 3.331%
2024-12-12 23:54:02,949 - DEBUG - cur time: 2023-04-01T23:59:59.999 == next bar open time: 2023-04-02T00:00:00.000 == close pos time: 2023-04-07T00:00:00.000
2024-12-12 23:54:02,949 - INFO - pnl: 2023-04-01T23:59:59.999 105552.80346030771 === 2.744%
2024-12-12 23:54:02,951 - DEBUG - cur time: 2023-04-02T23:59:59.999 == next bar open time: 2023-04-03T00:00:00.000 == close pos time: 2023-04-08T00:00:00.000
2024-12-12 23:54:02,951 - INFO - pnl: 2023-04-02T23:59:59.999 105412.25764424002 === -0.133%
2024-12-12 23:54:02,957 - DEBUG - cur time: 2023-04-03T23:59:59.999 == next bar open time: 2023-04-04T00:00:00.000 == close pos time: 2023-04-09T00:00:00.000
2024-12-12 23:54:02,966 - DEBUG - close time 2023-04-03T23:59:59.999 == vol_threshold: 22825379.519999996
2024-12-12 23:54:02,966 - DEBUG - 2023-04-03T23:59:59.999 == all trade symbol 137 == remain 96 after VOL filter
2024-12-12 23:54:02,966 - DEBUG - sorted_long_factors: shape: (96, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -4.133541    ┆ 0    ┆ 95           │
│ KAVAUSDT     ┆ -2.989001    ┆ 1    ┆ 94           │
│ XRPUSDT      ┆ -2.916252    ┆ 2    ┆ 93           │
│ LRCUSDT      ┆ -2.701719    ┆ 3    ┆ 92           │
│ KLAYUSDT     ┆ -2.545848    ┆ 4    ┆ 91           │
│ EOSUSDT      ┆ -2.385044    ┆ 5    ┆ 90           │
│ STORJUSDT    ┆ -2.070386    ┆ 6    ┆ 89           │
│ 1000LUNCUSDT ┆ -1.878522    ┆ 7    ┆ 88           │
│ CHZUSDT      ┆ -1.732924    ┆ 8    ┆ 87           │
│ FETUSDT      ┆ -1.729409    ┆ 9    ┆ 86           │
│ …            ┆ …            ┆ …    ┆ …            │
│ APEUSDT      ┆ 2.51905      ┆ 86   ┆ 9            │
│ WOOUSDT      ┆ 2.766567     ┆ 87   ┆ 8            │
│ LINAUSDT     ┆ 3.027432     ┆ 88   ┆ 7            │
│ TOMOUSDT     ┆ 3.056173     ┆ 89   ┆ 6            │
│ ICXUSDT      ┆ 3.138678     ┆ 90   ┆ 5            │
│ SPELLUSDT    ┆ 3.916412     ┆ 91   ┆ 4            │
│ DGBUSDT      ┆ 5.375877     ┆ 92   ┆ 3            │
│ CRVUSDT      ┆ 5.507063     ┆ 93   ┆ 2            │
│ SXPUSDT      ┆ 6.154046     ┆ 94   ┆ 1            │
│ INJUSDT      ┆ 6.777714     ┆ 95   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:02,970 - INFO - cur close time: 2023-04-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:02,970 - DEBUG - mean expected ret (mean factor): 0.32910252961103326
2024-12-12 23:54:02,974 - DEBUG - begin to update pos: =========
2024-12-12 23:54:02,974 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,978 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1216      ┆ null        ┆ … ┆ 0.02952 ┆ null   ┆ null    ┆ 0.2914  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:02,982 - DEBUG - update position: 2023-04-03T23:59:59.999 === diff_trading_value: 287975.5131489322 == cash: 109845.63841188424 
2024-12-12 23:54:02,982 - INFO - pnl: 2023-04-03T23:59:59.999 109845.63841188424 === 4.206%
2024-12-12 23:54:02,986 - DEBUG - cur time: 2023-04-04T23:59:59.999 == next bar open time: 2023-04-05T00:00:00.000 == close pos time: 2023-04-10T00:00:00.000
2024-12-12 23:54:02,989 - INFO - pnl: 2023-04-04T23:59:59.999 112704.45101517881 === 2.603%
2024-12-12 23:54:02,989 - DEBUG - cur time: 2023-04-05T23:59:59.999 == next bar open time: 2023-04-06T00:00:00.000 == close pos time: 2023-04-11T00:00:00.000
2024-12-12 23:54:02,993 - INFO - pnl: 2023-04-05T23:59:59.999 108500.82959316231 === -3.730%
2024-12-12 23:54:02,993 - DEBUG - cur time: 2023-04-06T23:59:59.999 == next bar open time: 2023-04-07T00:00:00.000 == close pos time: 2023-04-12T00:00:00.000
2024-12-12 23:54:02,997 - INFO - pnl: 2023-04-06T23:59:59.999 109247.32275588524 === 0.688%
2024-12-12 23:54:02,999 - DEBUG - cur time: 2023-04-07T23:59:59.999 == next bar open time: 2023-04-08T00:00:00.000 == close pos time: 2023-04-13T00:00:00.000
2024-12-12 23:54:03,001 - INFO - pnl: 2023-04-07T23:59:59.999 107596.9995714339 === -1.511%
2024-12-12 23:54:03,001 - DEBUG - cur time: 2023-04-08T23:59:59.999 == next bar open time: 2023-04-09T00:00:00.000 == close pos time: 2023-04-14T00:00:00.000
2024-12-12 23:54:03,009 - DEBUG - close time 2023-04-08T23:59:59.999 == vol_threshold: 9789734.6
2024-12-12 23:54:03,009 - DEBUG - 2023-04-08T23:59:59.999 == all trade symbol 139 == remain 97 after VOL filter
2024-12-12 23:54:03,014 - DEBUG - sorted_long_factors: shape: (97, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RVNUSDT      ┆ -5.114218    ┆ 0    ┆ 96           │
│ BATUSDT      ┆ -4.167999    ┆ 1    ┆ 95           │
│ FETUSDT      ┆ -3.228406    ┆ 2    ┆ 94           │
│ APTUSDT      ┆ -3.05326     ┆ 3    ┆ 93           │
│ IOTAUSDT     ┆ -3.051829    ┆ 4    ┆ 92           │
│ STORJUSDT    ┆ -2.754493    ┆ 5    ┆ 91           │
│ C98USDT      ┆ -2.667404    ┆ 6    ┆ 90           │
│ HOOKUSDT     ┆ -2.639964    ┆ 7    ┆ 89           │
│ KLAYUSDT     ┆ -2.616774    ┆ 8    ┆ 88           │
│ 1000SHIBUSDT ┆ -2.409466    ┆ 9    ┆ 87           │
│ …            ┆ …            ┆ …    ┆ …            │
│ DENTUSDT     ┆ 3.006895     ┆ 87   ┆ 9            │
│ ANTUSDT      ┆ 3.057397     ┆ 88   ┆ 8            │
│ OGNUSDT      ┆ 3.218702     ┆ 89   ┆ 7            │
│ LITUSDT      ┆ 3.219546     ┆ 90   ┆ 6            │
│ NKNUSDT      ┆ 3.236886     ┆ 91   ┆ 5            │
│ STMXUSDT     ┆ 3.242278     ┆ 92   ┆ 4            │
│ IOSTUSDT     ┆ 4.151658     ┆ 93   ┆ 3            │
│ VETUSDT      ┆ 4.16947      ┆ 94   ┆ 2            │
│ ALPHAUSDT    ┆ 4.43301      ┆ 95   ┆ 1            │
│ DGBUSDT      ┆ 4.449379     ┆ 96   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,018 - WARNING - 2023-04-08T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,019 - INFO - cur close time: 2023-04-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:03,019 - DEBUG - mean expected ret (mean factor): 0.2784412118711707
2024-12-12 23:54:03,022 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,022 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,022 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1267      ┆ null        ┆ … ┆ 0.02911 ┆ null   ┆ null    ┆ 0.2783  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,029 - DEBUG - update position: 2023-04-08T23:59:59.999 === diff_trading_value: 267256.7110698959 == cash: 107448.62955052251 
2024-12-12 23:54:03,029 - INFO - pnl: 2023-04-08T23:59:59.999 107448.62955052251 === -0.138%
2024-12-12 23:54:03,029 - DEBUG - cur time: 2023-04-09T23:59:59.999 == next bar open time: 2023-04-10T00:00:00.000 == close pos time: 2023-04-15T00:00:00.000
2024-12-12 23:54:03,033 - INFO - pnl: 2023-04-09T23:59:59.999 107492.15018239905 === 0.041%
2024-12-12 23:54:03,033 - DEBUG - cur time: 2023-04-10T23:59:59.999 == next bar open time: 2023-04-11T00:00:00.000 == close pos time: 2023-04-16T00:00:00.000
2024-12-12 23:54:03,037 - INFO - pnl: 2023-04-10T23:59:59.999 107686.33196062726 === 0.181%
2024-12-12 23:54:03,039 - DEBUG - cur time: 2023-04-11T23:59:59.999 == next bar open time: 2023-04-12T00:00:00.000 == close pos time: 2023-04-17T00:00:00.000
2024-12-12 23:54:03,041 - INFO - pnl: 2023-04-11T23:59:59.999 106908.85690657119 === -0.722%
2024-12-12 23:54:03,041 - DEBUG - cur time: 2023-04-12T23:59:59.999 == next bar open time: 2023-04-13T00:00:00.000 == close pos time: 2023-04-18T00:00:00.000
2024-12-12 23:54:03,041 - INFO - pnl: 2023-04-12T23:59:59.999 107614.49482110617 === 0.660%
2024-12-12 23:54:03,045 - DEBUG - cur time: 2023-04-13T23:59:59.999 == next bar open time: 2023-04-14T00:00:00.000 == close pos time: 2023-04-19T00:00:00.000
2024-12-12 23:54:03,053 - DEBUG - close time 2023-04-13T23:59:59.999 == vol_threshold: 18147474.65
2024-12-12 23:54:03,053 - DEBUG - 2023-04-13T23:59:59.999 == all trade symbol 140 == remain 98 after VOL filter
2024-12-12 23:54:03,053 - DEBUG - sorted_long_factors: shape: (98, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -4.196512    ┆ 0    ┆ 97           │
│ C98USDT      ┆ -3.549793    ┆ 1    ┆ 96           │
│ STORJUSDT    ┆ -3.345184    ┆ 2    ┆ 95           │
│ FILUSDT      ┆ -3.235353    ┆ 3    ┆ 94           │
│ OCEANUSDT    ┆ -3.199221    ┆ 4    ┆ 93           │
│ XLMUSDT      ┆ -3.191194    ┆ 5    ┆ 92           │
│ HOTUSDT      ┆ -3.129342    ┆ 6    ┆ 91           │
│ SANDUSDT     ┆ -3.001284    ┆ 7    ┆ 90           │
│ BLZUSDT      ┆ -2.761291    ┆ 8    ┆ 89           │
│ ONEUSDT      ┆ -2.334996    ┆ 9    ┆ 88           │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOTAUSDT     ┆ 2.568191     ┆ 88   ┆ 9            │
│ IOTXUSDT     ┆ 2.769642     ┆ 89   ┆ 8            │
│ ARPAUSDT     ┆ 2.865469     ┆ 90   ┆ 7            │
│ INJUSDT      ┆ 3.101453     ┆ 91   ┆ 6            │
│ DGBUSDT      ┆ 3.131761     ┆ 92   ┆ 5            │
│ EOSUSDT      ┆ 3.133839     ┆ 93   ┆ 4            │
│ BAKEUSDT     ┆ 3.272437     ┆ 94   ┆ 3            │
│ OMGUSDT      ┆ 3.415675     ┆ 95   ┆ 2            │
│ 1INCHUSDT    ┆ 4.629478     ┆ 96   ┆ 1            │
│ WOOUSDT      ┆ 4.85795      ┆ 97   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,061 - WARNING - 2023-04-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,061 - INFO - cur close time: 2023-04-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:03,061 - DEBUG - mean expected ret (mean factor): 0.08852569218484087
2024-12-12 23:54:03,066 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,066 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,066 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1268      ┆ null        ┆ … ┆ 0.02984 ┆ null   ┆ null    ┆ 0.2808  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,069 - DEBUG - update position: 2023-04-13T23:59:59.999 === diff_trading_value: 308388.16859791044 == cash: 105761.27114971768 
2024-12-12 23:54:03,069 - INFO - pnl: 2023-04-13T23:59:59.999 105761.27114971768 === -1.722%
2024-12-12 23:54:03,073 - DEBUG - cur time: 2023-04-14T23:59:59.999 == next bar open time: 2023-04-15T00:00:00.000 == close pos time: 2023-04-20T00:00:00.000
2024-12-12 23:54:03,073 - INFO - pnl: 2023-04-14T23:59:59.999 107249.99865274379 === 1.408%
2024-12-12 23:54:03,077 - DEBUG - cur time: 2023-04-15T23:59:59.999 == next bar open time: 2023-04-16T00:00:00.000 == close pos time: 2023-04-21T00:00:00.000
2024-12-12 23:54:03,079 - INFO - pnl: 2023-04-15T23:59:59.999 108109.75750661531 === 0.802%
2024-12-12 23:54:03,081 - DEBUG - cur time: 2023-04-16T23:59:59.999 == next bar open time: 2023-04-17T00:00:00.000 == close pos time: 2023-04-22T00:00:00.000
2024-12-12 23:54:03,081 - INFO - pnl: 2023-04-16T23:59:59.999 108870.14012615845 === 0.703%
2024-12-12 23:54:03,085 - DEBUG - cur time: 2023-04-17T23:59:59.999 == next bar open time: 2023-04-18T00:00:00.000 == close pos time: 2023-04-23T00:00:00.000
2024-12-12 23:54:03,085 - INFO - pnl: 2023-04-17T23:59:59.999 108702.81098848543 === -0.154%
2024-12-12 23:54:03,089 - DEBUG - cur time: 2023-04-18T23:59:59.999 == next bar open time: 2023-04-19T00:00:00.000 == close pos time: 2023-04-24T00:00:00.000
2024-12-12 23:54:03,097 - DEBUG - close time 2023-04-18T23:59:59.999 == vol_threshold: 21305325.0
2024-12-12 23:54:03,097 - DEBUG - 2023-04-18T23:59:59.999 == all trade symbol 141 == remain 98 after VOL filter
2024-12-12 23:54:03,099 - DEBUG - sorted_long_factors: shape: (98, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TUSDT     ┆ -3.635669    ┆ 0    ┆ 97           │
│ RENUSDT   ┆ -3.412882    ┆ 1    ┆ 96           │
│ RVNUSDT   ┆ -3.166865    ┆ 2    ┆ 95           │
│ KLAYUSDT  ┆ -3.161034    ┆ 3    ┆ 94           │
│ LRCUSDT   ┆ -2.938201    ┆ 4    ┆ 93           │
│ REEFUSDT  ┆ -2.855251    ┆ 5    ┆ 92           │
│ HBARUSDT  ┆ -2.704878    ┆ 6    ┆ 91           │
│ STGUSDT   ┆ -2.613911    ┆ 7    ┆ 90           │
│ SFPUSDT   ┆ -2.454778    ┆ 8    ┆ 89           │
│ UNFIUSDT  ┆ -2.390724    ┆ 9    ┆ 88           │
│ …         ┆ …            ┆ …    ┆ …            │
│ SUSHIUSDT ┆ 2.574045     ┆ 88   ┆ 9            │
│ ROSEUSDT  ┆ 2.615328     ┆ 89   ┆ 8            │
│ GALAUSDT  ┆ 2.620983     ┆ 90   ┆ 7            │
│ ALPHAUSDT ┆ 2.67741      ┆ 91   ┆ 6            │
│ XLMUSDT   ┆ 2.844546     ┆ 92   ┆ 5            │
│ ICPUSDT   ┆ 3.041709     ┆ 93   ┆ 4            │
│ THETAUSDT ┆ 3.056212     ┆ 94   ┆ 3            │
│ STMXUSDT  ┆ 3.236882     ┆ 95   ┆ 2            │
│ CRVUSDT   ┆ 3.845875     ┆ 96   ┆ 1            │
│ CTSIUSDT  ┆ 3.949034     ┆ 97   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,101 - WARNING - 2023-04-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,101 - INFO - cur close time: 2023-04-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:03,105 - DEBUG - mean expected ret (mean factor): 0.26910180034898046
2024-12-12 23:54:03,109 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,110 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,110 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.127       ┆ null        ┆ … ┆ 0.0336  ┆ null   ┆ null    ┆ 0.3051  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,115 - DEBUG - update position: 2023-04-18T23:59:59.999 === diff_trading_value: 382434.3731014882 == cash: 107273.575987693 
2024-12-12 23:54:03,116 - INFO - pnl: 2023-04-18T23:59:59.999 107273.575987693 === -1.315%
2024-12-12 23:54:03,119 - DEBUG - cur time: 2023-04-19T23:59:59.999 == next bar open time: 2023-04-20T00:00:00.000 == close pos time: 2023-04-25T00:00:00.000
2024-12-12 23:54:03,121 - INFO - pnl: 2023-04-19T23:59:59.999 108512.70180908927 === 1.155%
2024-12-12 23:54:03,123 - DEBUG - cur time: 2023-04-20T23:59:59.999 == next bar open time: 2023-04-21T00:00:00.000 == close pos time: 2023-04-26T00:00:00.000
2024-12-12 23:54:03,125 - INFO - pnl: 2023-04-20T23:59:59.999 107999.20067978778 === -0.473%
2024-12-12 23:54:03,128 - DEBUG - cur time: 2023-04-21T23:59:59.999 == next bar open time: 2023-04-22T00:00:00.000 == close pos time: 2023-04-27T00:00:00.000
2024-12-12 23:54:03,130 - INFO - pnl: 2023-04-21T23:59:59.999 107225.19044860902 === -0.717%
2024-12-12 23:54:03,135 - DEBUG - cur time: 2023-04-22T23:59:59.999 == next bar open time: 2023-04-23T00:00:00.000 == close pos time: 2023-04-28T00:00:00.000
2024-12-12 23:54:03,136 - INFO - pnl: 2023-04-22T23:59:59.999 107100.6665770614 === -0.116%
2024-12-12 23:54:03,141 - DEBUG - cur time: 2023-04-23T23:59:59.999 == next bar open time: 2023-04-24T00:00:00.000 == close pos time: 2023-04-29T00:00:00.000
2024-12-12 23:54:03,151 - DEBUG - close time 2023-04-23T23:59:59.999 == vol_threshold: 14554929.200000001
2024-12-12 23:54:03,155 - DEBUG - 2023-04-23T23:59:59.999 == all trade symbol 143 == remain 100 after VOL filter
2024-12-12 23:54:03,157 - DEBUG - sorted_long_factors: shape: (100, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DOGEUSDT     ┆ -4.260312    ┆ 0    ┆ 99           │
│ MAGICUSDT    ┆ -3.303672    ┆ 1    ┆ 98           │
│ FILUSDT      ┆ -3.223389    ┆ 2    ┆ 97           │
│ FETUSDT      ┆ -2.997638    ┆ 3    ┆ 96           │
│ CHZUSDT      ┆ -2.249569    ┆ 4    ┆ 95           │
│ RSRUSDT      ┆ -2.249479    ┆ 5    ┆ 94           │
│ GRTUSDT      ┆ -2.205276    ┆ 6    ┆ 93           │
│ STGUSDT      ┆ -2.017963    ┆ 7    ┆ 92           │
│ 1000LUNCUSDT ┆ -1.994488    ┆ 8    ┆ 91           │
│ DYDXUSDT     ┆ -1.961521    ┆ 9    ┆ 90           │
│ …            ┆ …            ┆ …    ┆ …            │
│ DGBUSDT      ┆ 2.62253      ┆ 90   ┆ 9            │
│ ONEUSDT      ┆ 2.698593     ┆ 91   ┆ 8            │
│ ZILUSDT      ┆ 2.816287     ┆ 92   ┆ 7            │
│ IOSTUSDT     ┆ 2.862657     ┆ 93   ┆ 6            │
│ STMXUSDT     ┆ 2.878732     ┆ 94   ┆ 5            │
│ TUSDT        ┆ 2.963611     ┆ 95   ┆ 4            │
│ ALGOUSDT     ┆ 3.011704     ┆ 96   ┆ 3            │
│ DARUSDT      ┆ 4.915572     ┆ 97   ┆ 2            │
│ TRXUSDT      ┆ 5.348486     ┆ 98   ┆ 1            │
│ BAKEUSDT     ┆ 5.483921     ┆ 99   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,162 - WARNING - 2023-04-23T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,162 - INFO - cur close time: 2023-04-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:03,162 - DEBUG - mean expected ret (mean factor): 0.18373418050609294
2024-12-12 23:54:03,167 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,168 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,168 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.11        ┆ null        ┆ … ┆ 0.0322  ┆ null   ┆ null    ┆ 0.261   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,173 - DEBUG - update position: 2023-04-23T23:59:59.999 === diff_trading_value: 317510.0862983577 == cash: 106386.50652388652 
2024-12-12 23:54:03,173 - INFO - pnl: 2023-04-23T23:59:59.999 106386.50652388652 === -0.667%
2024-12-12 23:54:03,177 - DEBUG - cur time: 2023-04-24T23:59:59.999 == next bar open time: 2023-04-25T00:00:00.000 == close pos time: 2023-04-30T00:00:00.000
2024-12-12 23:54:03,180 - INFO - pnl: 2023-04-24T23:59:59.999 105211.97994886318 === -1.104%
2024-12-12 23:54:03,182 - DEBUG - cur time: 2023-04-25T23:59:59.999 == next bar open time: 2023-04-26T00:00:00.000 == close pos time: 2023-05-01T00:00:00.000
2024-12-12 23:54:03,184 - INFO - pnl: 2023-04-25T23:59:59.999 104023.40845529747 === -1.130%
2024-12-12 23:54:03,187 - DEBUG - cur time: 2023-04-26T23:59:59.999 == next bar open time: 2023-04-27T00:00:00.000 == close pos time: 2023-05-02T00:00:00.000
2024-12-12 23:54:03,188 - INFO - pnl: 2023-04-26T23:59:59.999 104034.38112928384 === 0.011%
2024-12-12 23:54:03,190 - DEBUG - cur time: 2023-04-27T23:59:59.999 == next bar open time: 2023-04-28T00:00:00.000 == close pos time: 2023-05-03T00:00:00.000
2024-12-12 23:54:03,192 - INFO - pnl: 2023-04-27T23:59:59.999 103243.94897303745 === -0.760%
2024-12-12 23:54:03,192 - DEBUG - cur time: 2023-04-28T23:59:59.999 == next bar open time: 2023-04-29T00:00:00.000 == close pos time: 2023-05-04T00:00:00.000
2024-12-12 23:54:03,204 - DEBUG - close time 2023-04-28T23:59:59.999 == vol_threshold: 15666619.45
2024-12-12 23:54:03,205 - DEBUG - 2023-04-28T23:59:59.999 == all trade symbol 146 == remain 102 after VOL filter
2024-12-12 23:54:03,206 - DEBUG - sorted_long_factors: shape: (102, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ARPAUSDT     ┆ -4.622064    ┆ 0    ┆ 101          │
│ FETUSDT      ┆ -3.862111    ┆ 1    ┆ 100          │
│ MINAUSDT     ┆ -3.704595    ┆ 2    ┆ 99           │
│ DUSKUSDT     ┆ -3.313984    ┆ 3    ┆ 98           │
│ HIGHUSDT     ┆ -3.22211     ┆ 4    ┆ 97           │
│ LDOUSDT      ┆ -3.058652    ┆ 5    ┆ 96           │
│ SUSHIUSDT    ┆ -2.955653    ┆ 6    ┆ 95           │
│ CRVUSDT      ┆ -2.654832    ┆ 7    ┆ 94           │
│ NEARUSDT     ┆ -2.590119    ┆ 8    ┆ 93           │
│ 1000SHIBUSDT ┆ -2.474286    ┆ 9    ┆ 92           │
│ …            ┆ …            ┆ …    ┆ …            │
│ CHRUSDT      ┆ 3.48502      ┆ 92   ┆ 9            │
│ ALPHAUSDT    ┆ 3.613112     ┆ 93   ┆ 8            │
│ HBARUSDT     ┆ 3.704192     ┆ 94   ┆ 7            │
│ TOMOUSDT     ┆ 3.867457     ┆ 95   ┆ 6            │
│ ICPUSDT      ┆ 3.875517     ┆ 96   ┆ 5            │
│ IOSTUSDT     ┆ 3.92123      ┆ 97   ┆ 4            │
│ XEMUSDT      ┆ 4.246781     ┆ 98   ┆ 3            │
│ ATAUSDT      ┆ 4.46902      ┆ 99   ┆ 2            │
│ STORJUSDT    ┆ 4.628059     ┆ 100  ┆ 1            │
│ TRXUSDT      ┆ 6.337044     ┆ 101  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,209 - WARNING - 2023-04-28T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,209 - INFO - cur close time: 2023-04-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:03,209 - DEBUG - mean expected ret (mean factor): 0.22727942224032752
2024-12-12 23:54:03,216 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,216 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,218 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1117      ┆ null        ┆ … ┆ 0.02884 ┆ null   ┆ null    ┆ 0.2623  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,222 - DEBUG - update position: 2023-04-28T23:59:59.999 === diff_trading_value: 323986.3936162484 == cash: 102589.58215043951 
2024-12-12 23:54:03,222 - INFO - pnl: 2023-04-28T23:59:59.999 102589.58215043951 === -0.634%
2024-12-12 23:54:03,226 - DEBUG - cur time: 2023-04-29T23:59:59.999 == next bar open time: 2023-04-30T00:00:00.000 == close pos time: 2023-05-05T00:00:00.000
2024-12-12 23:54:03,230 - INFO - pnl: 2023-04-29T23:59:59.999 103246.19301028835 === 0.640%
2024-12-12 23:54:03,230 - DEBUG - cur time: 2023-04-30T23:59:59.999 == next bar open time: 2023-05-01T00:00:00.000 == close pos time: 2023-05-06T00:00:00.000
2024-12-12 23:54:03,230 - INFO - pnl: 2023-04-30T23:59:59.999 103068.20983596654 === -0.172%
2024-12-12 23:54:03,234 - DEBUG - cur time: 2023-05-01T23:59:59.999 == next bar open time: 2023-05-02T00:00:00.000 == close pos time: 2023-05-07T00:00:00.000
2024-12-12 23:54:03,238 - INFO - pnl: 2023-05-01T23:59:59.999 103032.94371440614 === -0.034%
2024-12-12 23:54:03,239 - DEBUG - cur time: 2023-05-02T23:59:59.999 == next bar open time: 2023-05-03T00:00:00.000 == close pos time: 2023-05-08T00:00:00.000
2024-12-12 23:54:03,242 - INFO - pnl: 2023-05-02T23:59:59.999 101270.07796412823 === -1.711%
2024-12-12 23:54:03,246 - DEBUG - cur time: 2023-05-03T23:59:59.999 == next bar open time: 2023-05-04T00:00:00.000 == close pos time: 2023-05-09T00:00:00.000
2024-12-12 23:54:03,254 - DEBUG - close time 2023-05-03T23:59:59.999 == vol_threshold: 20054326.479999997
2024-12-12 23:54:03,254 - DEBUG - 2023-05-03T23:59:59.999 == all trade symbol 149 == remain 104 after VOL filter
2024-12-12 23:54:03,254 - DEBUG - sorted_long_factors: shape: (104, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ HOOKUSDT  ┆ -3.599363    ┆ 0    ┆ 103          │
│ MINAUSDT  ┆ -2.748631    ┆ 1    ┆ 102          │
│ SPELLUSDT ┆ -2.673156    ┆ 2    ┆ 101          │
│ ENJUSDT   ┆ -2.571987    ┆ 3    ┆ 100          │
│ CHRUSDT   ┆ -2.544664    ┆ 4    ┆ 99           │
│ MAGICUSDT ┆ -2.453996    ┆ 5    ┆ 98           │
│ XRPUSDT   ┆ -2.393833    ┆ 6    ┆ 97           │
│ XTZUSDT   ┆ -2.373249    ┆ 7    ┆ 96           │
│ FILUSDT   ┆ -2.327298    ┆ 8    ┆ 95           │
│ DUSKUSDT  ┆ -2.273035    ┆ 9    ┆ 94           │
│ …         ┆ …            ┆ …    ┆ …            │
│ DOGEUSDT  ┆ 2.766226     ┆ 94   ┆ 9            │
│ SNXUSDT   ┆ 3.011227     ┆ 95   ┆ 8            │
│ TOMOUSDT  ┆ 3.030005     ┆ 96   ┆ 7            │
│ IMXUSDT   ┆ 3.046919     ┆ 97   ┆ 6            │
│ RLCUSDT   ┆ 3.108814     ┆ 98   ┆ 5            │
│ KAVAUSDT  ┆ 3.196877     ┆ 99   ┆ 4            │
│ MATICUSDT ┆ 3.265494     ┆ 100  ┆ 3            │
│ RNDRUSDT  ┆ 3.754622     ┆ 101  ┆ 2            │
│ STXUSDT   ┆ 4.211239     ┆ 102  ┆ 1            │
│ CRVUSDT   ┆ 4.628643     ┆ 103  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,259 - WARNING - 2023-05-03T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,259 - INFO - cur close time: 2023-05-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:03,259 - DEBUG - mean expected ret (mean factor): 0.14386291935523612
2024-12-12 23:54:03,265 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,266 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,266 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.106       ┆ null        ┆ … ┆ 0.02749 ┆ null   ┆ null    ┆ 0.2513  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,270 - DEBUG - update position: 2023-05-03T23:59:59.999 === diff_trading_value: 309244.9850666602 == cash: 101329.50626014992 
2024-12-12 23:54:03,270 - INFO - pnl: 2023-05-03T23:59:59.999 101329.50626014992 === 0.059%
2024-12-12 23:54:03,274 - DEBUG - cur time: 2023-05-04T23:59:59.999 == next bar open time: 2023-05-05T00:00:00.000 == close pos time: 2023-05-10T00:00:00.000
2024-12-12 23:54:03,278 - INFO - pnl: 2023-05-04T23:59:59.999 101110.21782168876 === -0.216%
2024-12-12 23:54:03,280 - DEBUG - cur time: 2023-05-05T23:59:59.999 == next bar open time: 2023-05-06T00:00:00.000 == close pos time: 2023-05-11T00:00:00.000
2024-12-12 23:54:03,282 - INFO - pnl: 2023-05-05T23:59:59.999 102025.18122973747 === 0.905%
2024-12-12 23:54:03,282 - DEBUG - cur time: 2023-05-06T23:59:59.999 == next bar open time: 2023-05-07T00:00:00.000 == close pos time: 2023-05-12T00:00:00.000
2024-12-12 23:54:03,286 - INFO - pnl: 2023-05-06T23:59:59.999 102959.59305866525 === 0.916%
2024-12-12 23:54:03,286 - DEBUG - cur time: 2023-05-07T23:59:59.999 == next bar open time: 2023-05-08T00:00:00.000 == close pos time: 2023-05-13T00:00:00.000
2024-12-12 23:54:03,286 - INFO - pnl: 2023-05-07T23:59:59.999 103402.60109752721 === 0.430%
2024-12-12 23:54:03,290 - DEBUG - cur time: 2023-05-08T23:59:59.999 == next bar open time: 2023-05-09T00:00:00.000 == close pos time: 2023-05-14T00:00:00.000
2024-12-12 23:54:03,300 - DEBUG - close time 2023-05-08T23:59:59.999 == vol_threshold: 29731278.169999998
2024-12-12 23:54:03,300 - DEBUG - 2023-05-08T23:59:59.999 == all trade symbol 152 == remain 106 after VOL filter
2024-12-12 23:54:03,300 - DEBUG - sorted_long_factors: shape: (106, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ BNXUSDT  ┆ -5.803385    ┆ 0    ┆ 105          │
│ MINAUSDT ┆ -4.116352    ┆ 1    ┆ 104          │
│ DUSKUSDT ┆ -3.472974    ┆ 2    ┆ 103          │
│ DOGEUSDT ┆ -3.3375      ┆ 3    ┆ 102          │
│ HOOKUSDT ┆ -3.211759    ┆ 4    ┆ 101          │
│ ANKRUSDT ┆ -2.704104    ┆ 5    ┆ 100          │
│ APTUSDT  ┆ -2.696362    ┆ 6    ┆ 99           │
│ ASTRUSDT ┆ -2.685162    ┆ 7    ┆ 98           │
│ OMGUSDT  ┆ -2.670812    ┆ 8    ┆ 97           │
│ BLZUSDT  ┆ -2.612787    ┆ 9    ┆ 96           │
│ …        ┆ …            ┆ …    ┆ …            │
│ KAVAUSDT ┆ 2.636019     ┆ 96   ┆ 9            │
│ ADAUSDT  ┆ 2.657198     ┆ 97   ┆ 8            │
│ COTIUSDT ┆ 2.780451     ┆ 98   ┆ 7            │
│ EOSUSDT  ┆ 2.955597     ┆ 99   ┆ 6            │
│ RLCUSDT  ┆ 3.163041     ┆ 100  ┆ 5            │
│ VETUSDT  ┆ 3.425972     ┆ 101  ┆ 4            │
│ TRXUSDT  ┆ 3.890331     ┆ 102  ┆ 3            │
│ ARPAUSDT ┆ 3.89505      ┆ 103  ┆ 2            │
│ STXUSDT  ┆ 3.897265     ┆ 104  ┆ 1            │
│ TOMOUSDT ┆ 5.521077     ┆ 105  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,306 - WARNING - 2023-05-08T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,306 - INFO - cur close time: 2023-05-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:03,307 - DEBUG - mean expected ret (mean factor): -0.2026573138756726
2024-12-12 23:54:03,310 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,310 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,310 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0843      ┆ null        ┆ … ┆ 0.02381 ┆ null   ┆ null    ┆ 0.2149  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,314 - DEBUG - update position: 2023-05-08T23:59:59.999 === diff_trading_value: 268495.5276084 == cash: 104833.01960503065 
2024-12-12 23:54:03,318 - INFO - pnl: 2023-05-08T23:59:59.999 104833.01960503065 === 1.383%
2024-12-12 23:54:03,319 - DEBUG - cur time: 2023-05-09T23:59:59.999 == next bar open time: 2023-05-10T00:00:00.000 == close pos time: 2023-05-15T00:00:00.000
2024-12-12 23:54:03,322 - INFO - pnl: 2023-05-09T23:59:59.999 104573.65393640855 === -0.247%
2024-12-12 23:54:03,322 - DEBUG - cur time: 2023-05-10T23:59:59.999 == next bar open time: 2023-05-11T00:00:00.000 == close pos time: 2023-05-16T00:00:00.000
2024-12-12 23:54:03,326 - INFO - pnl: 2023-05-10T23:59:59.999 103417.8018916005 === -1.105%
2024-12-12 23:54:03,326 - DEBUG - cur time: 2023-05-11T23:59:59.999 == next bar open time: 2023-05-12T00:00:00.000 == close pos time: 2023-05-17T00:00:00.000
2024-12-12 23:54:03,329 - INFO - pnl: 2023-05-11T23:59:59.999 104974.77904406528 === 1.506%
2024-12-12 23:54:03,329 - DEBUG - cur time: 2023-05-12T23:59:59.999 == next bar open time: 2023-05-13T00:00:00.000 == close pos time: 2023-05-18T00:00:00.000
2024-12-12 23:54:03,333 - INFO - pnl: 2023-05-12T23:59:59.999 105764.38607322902 === 0.752%
2024-12-12 23:54:03,333 - DEBUG - cur time: 2023-05-13T23:59:59.999 == next bar open time: 2023-05-14T00:00:00.000 == close pos time: 2023-05-19T00:00:00.000
2024-12-12 23:54:03,346 - DEBUG - close time 2023-05-13T23:59:59.999 == vol_threshold: 12158881.080000002
2024-12-12 23:54:03,346 - DEBUG - 2023-05-13T23:59:59.999 == all trade symbol 153 == remain 107 after VOL filter
2024-12-12 23:54:03,346 - DEBUG - sorted_long_factors: shape: (107, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ 1000XECUSDT ┆ -4.89168     ┆ 0    ┆ 106          │
│ HOTUSDT     ┆ -4.405295    ┆ 1    ┆ 105          │
│ FETUSDT     ┆ -4.028093    ┆ 2    ┆ 104          │
│ APEUSDT     ┆ -3.740593    ┆ 3    ┆ 103          │
│ MAGICUSDT   ┆ -3.577297    ┆ 4    ┆ 102          │
│ ACHUSDT     ┆ -3.240148    ┆ 5    ┆ 101          │
│ BAKEUSDT    ┆ -3.235625    ┆ 6    ┆ 100          │
│ PEOPLEUSDT  ┆ -2.840821    ┆ 7    ┆ 99           │
│ COTIUSDT    ┆ -2.647373    ┆ 8    ┆ 98           │
│ SFPUSDT     ┆ -2.405681    ┆ 9    ┆ 97           │
│ …           ┆ …            ┆ …    ┆ …            │
│ ENJUSDT     ┆ 3.243929     ┆ 97   ┆ 9            │
│ XLMUSDT     ┆ 3.522089     ┆ 98   ┆ 8            │
│ ARPAUSDT    ┆ 3.523818     ┆ 99   ┆ 7            │
│ EOSUSDT     ┆ 3.532074     ┆ 100  ┆ 6            │
│ KAVAUSDT    ┆ 3.854407     ┆ 101  ┆ 5            │
│ DOTUSDT     ┆ 4.212077     ┆ 102  ┆ 4            │
│ SANDUSDT    ┆ 4.28983      ┆ 103  ┆ 3            │
│ STORJUSDT   ┆ 5.092746     ┆ 104  ┆ 2            │
│ LDOUSDT     ┆ 5.132045     ┆ 105  ┆ 1            │
│ TUSDT       ┆ 10.26239     ┆ 106  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,354 - INFO - cur close time: 2023-05-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:03,354 - DEBUG - mean expected ret (mean factor): 0.18150392805829024
2024-12-12 23:54:03,358 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,358 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,358 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0885      ┆ null        ┆ … ┆ 0.02355 ┆ null   ┆ null    ┆ 0.2168  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,362 - DEBUG - update position: 2023-05-13T23:59:59.999 === diff_trading_value: 348997.32214318775 == cash: 105655.43200605764 
2024-12-12 23:54:03,366 - INFO - pnl: 2023-05-13T23:59:59.999 105655.43200605764 === -0.103%
2024-12-12 23:54:03,366 - DEBUG - cur time: 2023-05-14T23:59:59.999 == next bar open time: 2023-05-15T00:00:00.000 == close pos time: 2023-05-20T00:00:00.000
2024-12-12 23:54:03,369 - INFO - pnl: 2023-05-14T23:59:59.999 104735.35401555494 === -0.871%
2024-12-12 23:54:03,373 - DEBUG - cur time: 2023-05-15T23:59:59.999 == next bar open time: 2023-05-16T00:00:00.000 == close pos time: 2023-05-21T00:00:00.000
2024-12-12 23:54:03,374 - INFO - pnl: 2023-05-15T23:59:59.999 104401.21374462152 === -0.319%
2024-12-12 23:54:03,375 - DEBUG - cur time: 2023-05-16T23:59:59.999 == next bar open time: 2023-05-17T00:00:00.000 == close pos time: 2023-05-22T00:00:00.000
2024-12-12 23:54:03,375 - INFO - pnl: 2023-05-16T23:59:59.999 102132.93479973891 === -2.173%
2024-12-12 23:54:03,379 - DEBUG - cur time: 2023-05-17T23:59:59.999 == next bar open time: 2023-05-18T00:00:00.000 == close pos time: 2023-05-23T00:00:00.000
2024-12-12 23:54:03,379 - INFO - pnl: 2023-05-17T23:59:59.999 102718.67386828821 === 0.574%
2024-12-12 23:54:03,383 - DEBUG - cur time: 2023-05-18T23:59:59.999 == next bar open time: 2023-05-19T00:00:00.000 == close pos time: 2023-05-24T00:00:00.000
2024-12-12 23:54:03,391 - DEBUG - close time 2023-05-18T23:59:59.999 == vol_threshold: 23034543.899999995
2024-12-12 23:54:03,391 - DEBUG - 2023-05-18T23:59:59.999 == all trade symbol 155 == remain 108 after VOL filter
2024-12-12 23:54:03,391 - DEBUG - sorted_long_factors: shape: (108, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BNXUSDT   ┆ -3.575512    ┆ 0    ┆ 107          │
│ LRCUSDT   ┆ -3.085465    ┆ 1    ┆ 106          │
│ NKNUSDT   ┆ -2.538517    ┆ 2    ┆ 105          │
│ STGUSDT   ┆ -2.446168    ┆ 3    ┆ 104          │
│ VETUSDT   ┆ -2.043141    ┆ 4    ┆ 103          │
│ ROSEUSDT  ┆ -1.873908    ┆ 5    ┆ 102          │
│ HBARUSDT  ┆ -1.834532    ┆ 6    ┆ 101          │
│ FETUSDT   ┆ -1.759461    ┆ 7    ┆ 100          │
│ SUSHIUSDT ┆ -1.733325    ┆ 8    ┆ 99           │
│ AXSUSDT   ┆ -1.648488    ┆ 9    ┆ 98           │
│ …         ┆ …            ┆ …    ┆ …            │
│ HIGHUSDT  ┆ 2.148391     ┆ 98   ┆ 9            │
│ CELOUSDT  ┆ 2.244337     ┆ 99   ┆ 8            │
│ ATAUSDT   ┆ 2.323885     ┆ 100  ┆ 7            │
│ DENTUSDT  ┆ 2.629429     ┆ 101  ┆ 6            │
│ PHBUSDT   ┆ 2.648526     ┆ 102  ┆ 5            │
│ IOTXUSDT  ┆ 2.946287     ┆ 103  ┆ 4            │
│ MTLUSDT   ┆ 2.966978     ┆ 104  ┆ 3            │
│ RNDRUSDT  ┆ 3.134969     ┆ 105  ┆ 2            │
│ KAVAUSDT  ┆ 4.042478     ┆ 106  ┆ 1            │
│ TOMOUSDT  ┆ 5.154609     ┆ 107  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,400 - WARNING - 2023-05-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,400 - INFO - cur close time: 2023-05-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:03,400 - DEBUG - mean expected ret (mean factor): 0.0436473834471019
2024-12-12 23:54:03,404 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,404 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,404 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0906      ┆ null        ┆ … ┆ 0.02396 ┆ null   ┆ null    ┆ 0.2284  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,410 - DEBUG - update position: 2023-05-18T23:59:59.999 === diff_trading_value: 329058.60011497186 == cash: 102608.01908954371 
2024-12-12 23:54:03,412 - INFO - pnl: 2023-05-18T23:59:59.999 102608.01908954371 === -0.108%
2024-12-12 23:54:03,414 - DEBUG - cur time: 2023-05-19T23:59:59.999 == next bar open time: 2023-05-20T00:00:00.000 == close pos time: 2023-05-25T00:00:00.000
2024-12-12 23:54:03,415 - INFO - pnl: 2023-05-19T23:59:59.999 101405.32819096559 === -1.172%
2024-12-12 23:54:03,418 - DEBUG - cur time: 2023-05-20T23:59:59.999 == next bar open time: 2023-05-21T00:00:00.000 == close pos time: 2023-05-26T00:00:00.000
2024-12-12 23:54:03,420 - INFO - pnl: 2023-05-20T23:59:59.999 102371.91283259122 === 0.953%
2024-12-12 23:54:03,421 - DEBUG - cur time: 2023-05-21T23:59:59.999 == next bar open time: 2023-05-22T00:00:00.000 == close pos time: 2023-05-27T00:00:00.000
2024-12-12 23:54:03,422 - INFO - pnl: 2023-05-21T23:59:59.999 102972.7388830612 === 0.587%
2024-12-12 23:54:03,425 - DEBUG - cur time: 2023-05-22T23:59:59.999 == next bar open time: 2023-05-23T00:00:00.000 == close pos time: 2023-05-28T00:00:00.000
2024-12-12 23:54:03,426 - INFO - pnl: 2023-05-22T23:59:59.999 103571.03575992395 === 0.581%
2024-12-12 23:54:03,428 - DEBUG - cur time: 2023-05-23T23:59:59.999 == next bar open time: 2023-05-24T00:00:00.000 == close pos time: 2023-05-29T00:00:00.000
2024-12-12 23:54:03,437 - DEBUG - close time 2023-05-23T23:59:59.999 == vol_threshold: 15973558.64
2024-12-12 23:54:03,437 - DEBUG - 2023-05-23T23:59:59.999 == all trade symbol 157 == remain 110 after VOL filter
2024-12-12 23:54:03,439 - DEBUG - sorted_long_factors: shape: (110, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ENJUSDT   ┆ -3.589915    ┆ 0    ┆ 109          │
│ ZILUSDT   ┆ -3.478723    ┆ 1    ┆ 108          │
│ ROSEUSDT  ┆ -3.160409    ┆ 2    ┆ 107          │
│ RLCUSDT   ┆ -2.806711    ┆ 3    ┆ 106          │
│ PHBUSDT   ┆ -2.522963    ┆ 4    ┆ 105          │
│ RVNUSDT   ┆ -2.4537      ┆ 5    ┆ 104          │
│ SPELLUSDT ┆ -2.392341    ┆ 6    ┆ 103          │
│ LRCUSDT   ┆ -2.307488    ┆ 7    ┆ 102          │
│ MANAUSDT  ┆ -2.041798    ┆ 8    ┆ 101          │
│ ASTRUSDT  ┆ -1.909865    ┆ 9    ┆ 100          │
│ …         ┆ …            ┆ …    ┆ …            │
│ VETUSDT   ┆ 3.512043     ┆ 100  ┆ 9            │
│ XLMUSDT   ┆ 3.709382     ┆ 101  ┆ 8            │
│ RNDRUSDT  ┆ 3.83829      ┆ 102  ┆ 7            │
│ MAGICUSDT ┆ 3.952129     ┆ 103  ┆ 6            │
│ WAVESUSDT ┆ 4.232151     ┆ 104  ┆ 5            │
│ TRXUSDT   ┆ 4.417414     ┆ 105  ┆ 4            │
│ KAVAUSDT  ┆ 4.722689     ┆ 106  ┆ 3            │
│ HIGHUSDT  ┆ 4.724509     ┆ 107  ┆ 2            │
│ ARPAUSDT  ┆ 5.765525     ┆ 108  ┆ 1            │
│ TOMOUSDT  ┆ 6.504837     ┆ 109  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,444 - WARNING - 2023-05-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,444 - INFO - cur close time: 2023-05-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:03,444 - DEBUG - mean expected ret (mean factor): 0.5361212976562759
2024-12-12 23:54:03,448 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,448 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,450 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0902      ┆ null        ┆ … ┆ 0.02361 ┆ null   ┆ null    ┆ 0.2268  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,452 - DEBUG - update position: 2023-05-23T23:59:59.999 === diff_trading_value: 284842.941775825 == cash: 106291.22482047998 
2024-12-12 23:54:03,456 - INFO - pnl: 2023-05-23T23:59:59.999 106291.22482047998 === 2.626%
2024-12-12 23:54:03,456 - DEBUG - cur time: 2023-05-24T23:59:59.999 == next bar open time: 2023-05-25T00:00:00.000 == close pos time: 2023-05-30T00:00:00.000
2024-12-12 23:54:03,459 - INFO - pnl: 2023-05-24T23:59:59.999 110524.87639661045 === 3.983%
2024-12-12 23:54:03,459 - DEBUG - cur time: 2023-05-25T23:59:59.999 == next bar open time: 2023-05-26T00:00:00.000 == close pos time: 2023-05-31T00:00:00.000
2024-12-12 23:54:03,463 - INFO - pnl: 2023-05-25T23:59:59.999 109222.02163078908 === -1.179%
2024-12-12 23:54:03,467 - DEBUG - cur time: 2023-05-26T23:59:59.999 == next bar open time: 2023-05-27T00:00:00.000 == close pos time: 2023-06-01T00:00:00.000
2024-12-12 23:54:03,467 - INFO - pnl: 2023-05-26T23:59:59.999 109431.18971012806 === 0.192%
2024-12-12 23:54:03,471 - DEBUG - cur time: 2023-05-27T23:59:59.999 == next bar open time: 2023-05-28T00:00:00.000 == close pos time: 2023-06-02T00:00:00.000
2024-12-12 23:54:03,472 - INFO - pnl: 2023-05-27T23:59:59.999 107758.28329708175 === -1.529%
2024-12-12 23:54:03,474 - DEBUG - cur time: 2023-05-28T23:59:59.999 == next bar open time: 2023-05-29T00:00:00.000 == close pos time: 2023-06-03T00:00:00.000
2024-12-12 23:54:03,483 - DEBUG - close time 2023-05-28T23:59:59.999 == vol_threshold: 15200210.543999998
2024-12-12 23:54:03,483 - DEBUG - 2023-05-28T23:59:59.999 == all trade symbol 157 == remain 110 after VOL filter
2024-12-12 23:54:03,483 - DEBUG - sorted_long_factors: shape: (110, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ HOTUSDT   ┆ -3.336933    ┆ 0    ┆ 109          │
│ 1INCHUSDT ┆ -3.165204    ┆ 1    ┆ 108          │
│ APEUSDT   ┆ -2.992877    ┆ 2    ┆ 107          │
│ ICXUSDT   ┆ -2.753608    ┆ 3    ┆ 106          │
│ ENJUSDT   ┆ -2.592545    ┆ 4    ┆ 105          │
│ RLCUSDT   ┆ -2.551967    ┆ 5    ┆ 104          │
│ FLOWUSDT  ┆ -2.534993    ┆ 6    ┆ 103          │
│ IMXUSDT   ┆ -2.397019    ┆ 7    ┆ 102          │
│ ALPHAUSDT ┆ -2.395641    ┆ 8    ┆ 101          │
│ MTLUSDT   ┆ -2.38601     ┆ 9    ┆ 100          │
│ …         ┆ …            ┆ …    ┆ …            │
│ LDOUSDT   ┆ 2.602692     ┆ 100  ┆ 9            │
│ ARPAUSDT  ┆ 2.689472     ┆ 101  ┆ 8            │
│ XRPUSDT   ┆ 2.801371     ┆ 102  ┆ 7            │
│ SANDUSDT  ┆ 2.851056     ┆ 103  ┆ 6            │
│ RNDRUSDT  ┆ 3.052395     ┆ 104  ┆ 5            │
│ RSRUSDT   ┆ 3.749269     ┆ 105  ┆ 4            │
│ ADAUSDT   ┆ 3.965805     ┆ 106  ┆ 3            │
│ TOMOUSDT  ┆ 4.201696     ┆ 107  ┆ 2            │
│ LINAUSDT  ┆ 4.543999     ┆ 108  ┆ 1            │
│ TUSDT     ┆ 4.851082     ┆ 109  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,490 - WARNING - 2023-05-28T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,490 - INFO - cur close time: 2023-05-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:03,491 - DEBUG - mean expected ret (mean factor): -0.00671493941704453
2024-12-12 23:54:03,495 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,495 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,495 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0881      ┆ null        ┆ … ┆ 0.02368 ┆ null   ┆ null    ┆ 0.227   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,500 - DEBUG - update position: 2023-05-28T23:59:59.999 === diff_trading_value: 304946.0588314617 == cash: 108050.18304310273 
2024-12-12 23:54:03,500 - INFO - pnl: 2023-05-28T23:59:59.999 108050.18304310273 === 0.271%
2024-12-12 23:54:03,503 - DEBUG - cur time: 2023-05-29T23:59:59.999 == next bar open time: 2023-05-30T00:00:00.000 == close pos time: 2023-06-04T00:00:00.000
2024-12-12 23:54:03,503 - INFO - pnl: 2023-05-29T23:59:59.999 108599.05436836949 === 0.508%
2024-12-12 23:54:03,507 - DEBUG - cur time: 2023-05-30T23:59:59.999 == next bar open time: 2023-05-31T00:00:00.000 == close pos time: 2023-06-05T00:00:00.000
2024-12-12 23:54:03,510 - INFO - pnl: 2023-05-30T23:59:59.999 110593.51287023231 === 1.837%
2024-12-12 23:54:03,511 - DEBUG - cur time: 2023-05-31T23:59:59.999 == next bar open time: 2023-06-01T00:00:00.000 == close pos time: 2023-06-06T00:00:00.000
2024-12-12 23:54:03,513 - INFO - pnl: 2023-05-31T23:59:59.999 112274.70703587761 === 1.520%
2024-12-12 23:54:03,513 - DEBUG - cur time: 2023-06-01T23:59:59.999 == next bar open time: 2023-06-02T00:00:00.000 == close pos time: 2023-06-07T00:00:00.000
2024-12-12 23:54:03,517 - INFO - pnl: 2023-06-01T23:59:59.999 111924.21790372508 === -0.312%
2024-12-12 23:54:03,520 - DEBUG - cur time: 2023-06-02T23:59:59.999 == next bar open time: 2023-06-03T00:00:00.000 == close pos time: 2023-06-08T00:00:00.000
2024-12-12 23:54:03,525 - DEBUG - close time 2023-06-02T23:59:59.999 == vol_threshold: 14128582.319999998
2024-12-12 23:54:03,525 - DEBUG - 2023-06-02T23:59:59.999 == all trade symbol 159 == remain 111 after VOL filter
2024-12-12 23:54:03,529 - DEBUG - sorted_long_factors: shape: (111, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ MTLUSDT   ┆ -4.959803    ┆ 0    ┆ 110          │
│ REEFUSDT  ┆ -4.509476    ┆ 1    ┆ 109          │
│ CKBUSDT   ┆ -3.705072    ┆ 2    ┆ 108          │
│ BAKEUSDT  ┆ -3.431522    ┆ 3    ┆ 107          │
│ ACHUSDT   ┆ -3.32349     ┆ 4    ┆ 106          │
│ LRCUSDT   ┆ -3.163499    ┆ 5    ┆ 105          │
│ VETUSDT   ┆ -2.848325    ┆ 6    ┆ 104          │
│ IDUSDT    ┆ -2.764404    ┆ 7    ┆ 103          │
│ ALPHAUSDT ┆ -2.608244    ┆ 8    ┆ 102          │
│ ASTRUSDT  ┆ -2.590116    ┆ 9    ┆ 101          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XRPUSDT   ┆ 2.764799     ┆ 101  ┆ 9            │
│ LDOUSDT   ┆ 3.221964     ┆ 102  ┆ 8            │
│ SKLUSDT   ┆ 3.386285     ┆ 103  ┆ 7            │
│ DOGEUSDT  ┆ 3.731227     ┆ 104  ┆ 6            │
│ LINAUSDT  ┆ 3.751546     ┆ 105  ┆ 5            │
│ EOSUSDT   ┆ 4.035788     ┆ 106  ┆ 4            │
│ ADAUSDT   ┆ 4.665198     ┆ 107  ┆ 3            │
│ NEARUSDT  ┆ 4.761782     ┆ 108  ┆ 2            │
│ CRVUSDT   ┆ 5.112689     ┆ 109  ┆ 1            │
│ TRXUSDT   ┆ 5.920762     ┆ 110  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,533 - INFO - cur close time: 2023-06-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:03,533 - DEBUG - mean expected ret (mean factor): 0.141609286605115
2024-12-12 23:54:03,537 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,537 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,539 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.085       ┆ null        ┆ … ┆ 0.02335 ┆ null   ┆ null    ┆ 0.2208  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,541 - DEBUG - update position: 2023-06-02T23:59:59.999 === diff_trading_value: 269830.41912455694 == cash: 110961.91231410303 
2024-12-12 23:54:03,545 - INFO - pnl: 2023-06-02T23:59:59.999 110961.91231410303 === -0.860%
2024-12-12 23:54:03,545 - DEBUG - cur time: 2023-06-03T23:59:59.999 == next bar open time: 2023-06-04T00:00:00.000 == close pos time: 2023-06-09T00:00:00.000
2024-12-12 23:54:03,549 - INFO - pnl: 2023-06-03T23:59:59.999 109827.5945138504 === -1.022%
2024-12-12 23:54:03,549 - DEBUG - cur time: 2023-06-04T23:59:59.999 == next bar open time: 2023-06-05T00:00:00.000 == close pos time: 2023-06-10T00:00:00.000
2024-12-12 23:54:03,554 - INFO - pnl: 2023-06-04T23:59:59.999 109075.94053832232 === -0.684%
2024-12-12 23:54:03,554 - DEBUG - cur time: 2023-06-05T23:59:59.999 == next bar open time: 2023-06-06T00:00:00.000 == close pos time: 2023-06-11T00:00:00.000
2024-12-12 23:54:03,558 - INFO - pnl: 2023-06-05T23:59:59.999 109219.13859677523 === 0.131%
2024-12-12 23:54:03,559 - DEBUG - cur time: 2023-06-06T23:59:59.999 == next bar open time: 2023-06-07T00:00:00.000 == close pos time: 2023-06-12T00:00:00.000
2024-12-12 23:54:03,562 - INFO - pnl: 2023-06-06T23:59:59.999 107973.2896724462 === -1.141%
2024-12-12 23:54:03,562 - DEBUG - cur time: 2023-06-07T23:59:59.999 == next bar open time: 2023-06-08T00:00:00.000 == close pos time: 2023-06-13T00:00:00.000
2024-12-12 23:54:03,574 - DEBUG - close time 2023-06-07T23:59:59.999 == vol_threshold: 20753586.04
2024-12-12 23:54:03,574 - DEBUG - 2023-06-07T23:59:59.999 == all trade symbol 159 == remain 111 after VOL filter
2024-12-12 23:54:03,574 - DEBUG - sorted_long_factors: shape: (111, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ IMXUSDT      ┆ -5.267728    ┆ 0    ┆ 110          │
│ CELRUSDT     ┆ -4.790893    ┆ 1    ┆ 109          │
│ DOGEUSDT     ┆ -4.582933    ┆ 2    ┆ 108          │
│ 1000SHIBUSDT ┆ -4.568897    ┆ 3    ┆ 107          │
│ STGUSDT      ┆ -4.330881    ┆ 4    ┆ 106          │
│ XEMUSDT      ┆ -4.101052    ┆ 5    ┆ 105          │
│ FILUSDT      ┆ -3.605022    ┆ 6    ┆ 104          │
│ APTUSDT      ┆ -3.278934    ┆ 7    ┆ 103          │
│ BNXUSDT      ┆ -3.240587    ┆ 8    ┆ 102          │
│ ASTRUSDT     ┆ -2.921612    ┆ 9    ┆ 101          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SUSHIUSDT    ┆ 2.400436     ┆ 101  ┆ 9            │
│ TRXUSDT      ┆ 2.418014     ┆ 102  ┆ 8            │
│ INJUSDT      ┆ 2.483465     ┆ 103  ┆ 7            │
│ CHZUSDT      ┆ 2.51403      ┆ 104  ┆ 6            │
│ OGNUSDT      ┆ 2.733487     ┆ 105  ┆ 5            │
│ IOSTUSDT     ┆ 2.872637     ┆ 106  ┆ 4            │
│ IOTXUSDT     ┆ 3.15864      ┆ 107  ┆ 3            │
│ CKBUSDT      ┆ 3.240126     ┆ 108  ┆ 2            │
│ LINAUSDT     ┆ 3.836368     ┆ 109  ┆ 1            │
│ MTLUSDT      ┆ 5.166998     ┆ 110  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,579 - WARNING - 2023-06-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,581 - INFO - cur close time: 2023-06-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:03,581 - DEBUG - mean expected ret (mean factor): -0.3531726593385798
2024-12-12 23:54:03,583 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,583 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,583 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09357     ┆ null        ┆ … ┆ 0.02087 ┆ null   ┆ null    ┆ 0.1986  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,591 - DEBUG - update position: 2023-06-07T23:59:59.999 === diff_trading_value: 320476.86052839505 == cash: 108884.32225541193 
2024-12-12 23:54:03,591 - INFO - pnl: 2023-06-07T23:59:59.999 108884.32225541193 === 0.844%
2024-12-12 23:54:03,595 - DEBUG - cur time: 2023-06-08T23:59:59.999 == next bar open time: 2023-06-09T00:00:00.000 == close pos time: 2023-06-14T00:00:00.000
2024-12-12 23:54:03,595 - INFO - pnl: 2023-06-08T23:59:59.999 107419.26783261102 === -1.346%
2024-12-12 23:54:03,595 - DEBUG - cur time: 2023-06-09T23:59:59.999 == next bar open time: 2023-06-10T00:00:00.000 == close pos time: 2023-06-15T00:00:00.000
2024-12-12 23:54:03,599 - INFO - pnl: 2023-06-09T23:59:59.999 107148.54652064557 === -0.252%
2024-12-12 23:54:03,599 - DEBUG - cur time: 2023-06-10T23:59:59.999 == next bar open time: 2023-06-11T00:00:00.000 == close pos time: 2023-06-16T00:00:00.000
2024-12-12 23:54:03,603 - INFO - pnl: 2023-06-10T23:59:59.999 108200.28265671058 === 0.982%
2024-12-12 23:54:03,603 - DEBUG - cur time: 2023-06-11T23:59:59.999 == next bar open time: 2023-06-12T00:00:00.000 == close pos time: 2023-06-17T00:00:00.000
2024-12-12 23:54:03,607 - INFO - pnl: 2023-06-11T23:59:59.999 109696.35803535176 === 1.383%
2024-12-12 23:54:03,609 - DEBUG - cur time: 2023-06-12T23:59:59.999 == next bar open time: 2023-06-13T00:00:00.000 == close pos time: 2023-06-18T00:00:00.000
2024-12-12 23:54:03,618 - DEBUG - close time 2023-06-12T23:59:59.999 == vol_threshold: 30467061.42000001
2024-12-12 23:54:03,618 - DEBUG - 2023-06-12T23:59:59.999 == all trade symbol 163 == remain 114 after VOL filter
2024-12-12 23:54:03,620 - DEBUG - sorted_long_factors: shape: (114, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MINAUSDT     ┆ -7.376795    ┆ 0    ┆ 113          │
│ RUNEUSDT     ┆ -4.544604    ┆ 1    ┆ 112          │
│ 1000SHIBUSDT ┆ -4.036815    ┆ 2    ┆ 111          │
│ HOTUSDT      ┆ -3.948246    ┆ 3    ┆ 110          │
│ BATUSDT      ┆ -3.660374    ┆ 4    ┆ 109          │
│ FLMUSDT      ┆ -3.496457    ┆ 5    ┆ 108          │
│ ONEUSDT      ┆ -3.353245    ┆ 6    ┆ 107          │
│ REEFUSDT     ┆ -3.126932    ┆ 7    ┆ 106          │
│ IDUSDT       ┆ -3.068033    ┆ 8    ┆ 105          │
│ SPELLUSDT    ┆ -2.896658    ┆ 9    ┆ 104          │
│ …            ┆ …            ┆ …    ┆ …            │
│ MAGICUSDT    ┆ 2.655145     ┆ 104  ┆ 9            │
│ ENJUSDT      ┆ 2.941652     ┆ 105  ┆ 8            │
│ TOMOUSDT     ┆ 2.951273     ┆ 106  ┆ 7            │
│ RSRUSDT      ┆ 2.992966     ┆ 107  ┆ 6            │
│ TRXUSDT      ┆ 3.050574     ┆ 108  ┆ 5            │
│ LITUSDT      ┆ 3.134634     ┆ 109  ┆ 4            │
│ THETAUSDT    ┆ 3.266267     ┆ 110  ┆ 3            │
│ SUSHIUSDT    ┆ 4.513645     ┆ 111  ┆ 2            │
│ HOOKUSDT     ┆ 4.594246     ┆ 112  ┆ 1            │
│ LINAUSDT     ┆ 5.779969     ┆ 113  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,624 - WARNING - 2023-06-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,624 - INFO - cur close time: 2023-06-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:03,624 - DEBUG - mean expected ret (mean factor): -0.26983247649589165
2024-12-12 23:54:03,628 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,629 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,629 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08876     ┆ null        ┆ … ┆ 0.01739 ┆ null   ┆ null    ┆ 0.1719  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,635 - DEBUG - update position: 2023-06-12T23:59:59.999 === diff_trading_value: 321039.89297499275 == cash: 110902.27682512866 
2024-12-12 23:54:03,635 - INFO - pnl: 2023-06-12T23:59:59.999 110902.27682512866 === 1.099%
2024-12-12 23:54:03,635 - DEBUG - cur time: 2023-06-13T23:59:59.999 == next bar open time: 2023-06-14T00:00:00.000 == close pos time: 2023-06-19T00:00:00.000
2024-12-12 23:54:03,639 - INFO - pnl: 2023-06-13T23:59:59.999 109797.11591107893 === -0.997%
2024-12-12 23:54:03,640 - DEBUG - cur time: 2023-06-14T23:59:59.999 == next bar open time: 2023-06-15T00:00:00.000 == close pos time: 2023-06-20T00:00:00.000
2024-12-12 23:54:03,643 - INFO - pnl: 2023-06-14T23:59:59.999 111380.08499149203 === 1.442%
2024-12-12 23:54:03,643 - DEBUG - cur time: 2023-06-15T23:59:59.999 == next bar open time: 2023-06-16T00:00:00.000 == close pos time: 2023-06-21T00:00:00.000
2024-12-12 23:54:03,647 - INFO - pnl: 2023-06-15T23:59:59.999 110322.95380055113 === -0.949%
2024-12-12 23:54:03,650 - DEBUG - cur time: 2023-06-16T23:59:59.999 == next bar open time: 2023-06-17T00:00:00.000 == close pos time: 2023-06-22T00:00:00.000
2024-12-12 23:54:03,651 - INFO - pnl: 2023-06-16T23:59:59.999 109962.08036720983 === -0.327%
2024-12-12 23:54:03,651 - DEBUG - cur time: 2023-06-17T23:59:59.999 == next bar open time: 2023-06-18T00:00:00.000 == close pos time: 2023-06-23T00:00:00.000
2024-12-12 23:54:03,659 - DEBUG - close time 2023-06-17T23:59:59.999 == vol_threshold: 18103521.699999996
2024-12-12 23:54:03,663 - DEBUG - 2023-06-17T23:59:59.999 == all trade symbol 165 == remain 115 after VOL filter
2024-12-12 23:54:03,663 - DEBUG - sorted_long_factors: shape: (115, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TOMOUSDT     ┆ -3.592068    ┆ 0    ┆ 114          │
│ ANKRUSDT     ┆ -3.300453    ┆ 1    ┆ 113          │
│ RENUSDT      ┆ -3.300233    ┆ 2    ┆ 112          │
│ 1000LUNCUSDT ┆ -3.248112    ┆ 3    ┆ 111          │
│ XRPUSDT      ┆ -3.170867    ┆ 4    ┆ 110          │
│ SPELLUSDT    ┆ -3.091345    ┆ 5    ┆ 109          │
│ CKBUSDT      ┆ -2.97922     ┆ 6    ┆ 108          │
│ KAVAUSDT     ┆ -2.932229    ┆ 7    ┆ 107          │
│ ZILUSDT      ┆ -2.867299    ┆ 8    ┆ 106          │
│ ALPHAUSDT    ┆ -2.864608    ┆ 9    ┆ 105          │
│ …            ┆ …            ┆ …    ┆ …            │
│ JOEUSDT      ┆ 3.431969     ┆ 105  ┆ 9            │
│ CHZUSDT      ┆ 3.61145      ┆ 106  ┆ 8            │
│ DENTUSDT     ┆ 3.86751      ┆ 107  ┆ 7            │
│ SFPUSDT      ┆ 3.926401     ┆ 108  ┆ 6            │
│ HBARUSDT     ┆ 4.114294     ┆ 109  ┆ 5            │
│ TUSDT        ┆ 4.122942     ┆ 110  ┆ 4            │
│ FXSUSDT      ┆ 4.181867     ┆ 111  ┆ 3            │
│ ANTUSDT      ┆ 5.151713     ┆ 112  ┆ 2            │
│ VETUSDT      ┆ 5.214562     ┆ 113  ┆ 1            │
│ IMXUSDT      ┆ 5.641417     ┆ 114  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,669 - WARNING - 2023-06-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,669 - INFO - cur close time: 2023-06-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:03,669 - DEBUG - mean expected ret (mean factor): 0.2689513453551165
2024-12-12 23:54:03,671 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,671 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,675 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09093     ┆ null        ┆ … ┆ 0.01762 ┆ null   ┆ null    ┆ 0.1779  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,680 - DEBUG - update position: 2023-06-17T23:59:59.999 === diff_trading_value: 365175.9995723505 == cash: 109955.29235047549 
2024-12-12 23:54:03,681 - INFO - pnl: 2023-06-17T23:59:59.999 109955.29235047549 === -0.006%
2024-12-12 23:54:03,683 - DEBUG - cur time: 2023-06-18T23:59:59.999 == next bar open time: 2023-06-19T00:00:00.000 == close pos time: 2023-06-24T00:00:00.000
2024-12-12 23:54:03,683 - INFO - pnl: 2023-06-18T23:59:59.999 109984.20724986434 === 0.026%
2024-12-12 23:54:03,687 - DEBUG - cur time: 2023-06-19T23:59:59.999 == next bar open time: 2023-06-20T00:00:00.000 == close pos time: 2023-06-25T00:00:00.000
2024-12-12 23:54:03,687 - INFO - pnl: 2023-06-19T23:59:59.999 112045.41696404673 === 1.874%
2024-12-12 23:54:03,691 - DEBUG - cur time: 2023-06-20T23:59:59.999 == next bar open time: 2023-06-21T00:00:00.000 == close pos time: 2023-06-26T00:00:00.000
2024-12-12 23:54:03,691 - INFO - pnl: 2023-06-20T23:59:59.999 113439.46676057954 === 1.244%
2024-12-12 23:54:03,691 - DEBUG - cur time: 2023-06-21T23:59:59.999 == next bar open time: 2023-06-22T00:00:00.000 == close pos time: 2023-06-27T00:00:00.000
2024-12-12 23:54:03,695 - INFO - pnl: 2023-06-21T23:59:59.999 113881.75201320351 === 0.390%
2024-12-12 23:54:03,695 - DEBUG - cur time: 2023-06-22T23:59:59.999 == next bar open time: 2023-06-23T00:00:00.000 == close pos time: 2023-06-28T00:00:00.000
2024-12-12 23:54:03,704 - DEBUG - close time 2023-06-22T23:59:59.999 == vol_threshold: 30508692.07999999
2024-12-12 23:54:03,704 - DEBUG - 2023-06-22T23:59:59.999 == all trade symbol 165 == remain 115 after VOL filter
2024-12-12 23:54:03,708 - DEBUG - sorted_long_factors: shape: (115, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ARBUSDT      ┆ -4.187863    ┆ 0    ┆ 114          │
│ IDUSDT       ┆ -4.083       ┆ 1    ┆ 113          │
│ ARPAUSDT     ┆ -3.602091    ┆ 2    ┆ 112          │
│ NKNUSDT      ┆ -3.586224    ┆ 3    ┆ 111          │
│ DUSKUSDT     ┆ -3.393201    ┆ 4    ┆ 110          │
│ STGUSDT      ┆ -3.229425    ┆ 5    ┆ 109          │
│ JOEUSDT      ┆ -2.898043    ┆ 6    ┆ 108          │
│ 1000LUNCUSDT ┆ -2.837024    ┆ 7    ┆ 107          │
│ 1INCHUSDT    ┆ -2.772863    ┆ 8    ┆ 106          │
│ ALPHAUSDT    ┆ -2.732303    ┆ 9    ┆ 105          │
│ …            ┆ …            ┆ …    ┆ …            │
│ THETAUSDT    ┆ 2.753233     ┆ 105  ┆ 9            │
│ CELOUSDT     ┆ 2.803566     ┆ 106  ┆ 8            │
│ VETUSDT      ┆ 2.934963     ┆ 107  ┆ 7            │
│ SKLUSDT      ┆ 3.045765     ┆ 108  ┆ 6            │
│ NEARUSDT     ┆ 3.167535     ┆ 109  ┆ 5            │
│ REEFUSDT     ┆ 3.430431     ┆ 110  ┆ 4            │
│ TUSDT        ┆ 4.037856     ┆ 111  ┆ 3            │
│ XTZUSDT      ┆ 4.464829     ┆ 112  ┆ 2            │
│ IOTXUSDT     ┆ 5.452482     ┆ 113  ┆ 1            │
│ BATUSDT      ┆ 6.234833     ┆ 114  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,714 - WARNING - 2023-06-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,714 - INFO - cur close time: 2023-06-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:03,715 - DEBUG - mean expected ret (mean factor): 0.15209662809884253
2024-12-12 23:54:03,719 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,719 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,719 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09076     ┆ null        ┆ … ┆ 0.01889 ┆ null   ┆ null    ┆ 0.1915  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,726 - DEBUG - update position: 2023-06-22T23:59:59.999 === diff_trading_value: 333133.27630241186 == cash: 113788.64928098013 
2024-12-12 23:54:03,726 - INFO - pnl: 2023-06-22T23:59:59.999 113788.64928098013 === -0.082%
2024-12-12 23:54:03,730 - DEBUG - cur time: 2023-06-23T23:59:59.999 == next bar open time: 2023-06-24T00:00:00.000 == close pos time: 2023-06-29T00:00:00.000
2024-12-12 23:54:03,730 - INFO - pnl: 2023-06-23T23:59:59.999 116248.37081212667 === 2.162%
2024-12-12 23:54:03,734 - DEBUG - cur time: 2023-06-24T23:59:59.999 == next bar open time: 2023-06-25T00:00:00.000 == close pos time: 2023-06-30T00:00:00.000
2024-12-12 23:54:03,734 - INFO - pnl: 2023-06-24T23:59:59.999 117673.57020010002 === 1.226%
2024-12-12 23:54:03,738 - DEBUG - cur time: 2023-06-25T23:59:59.999 == next bar open time: 2023-06-26T00:00:00.000 == close pos time: 2023-07-01T00:00:00.000
2024-12-12 23:54:03,739 - INFO - pnl: 2023-06-25T23:59:59.999 116095.09725869965 === -1.341%
2024-12-12 23:54:03,739 - DEBUG - cur time: 2023-06-26T23:59:59.999 == next bar open time: 2023-06-27T00:00:00.000 == close pos time: 2023-07-02T00:00:00.000
2024-12-12 23:54:03,743 - INFO - pnl: 2023-06-26T23:59:59.999 115908.95801814074 === -0.160%
2024-12-12 23:54:03,745 - DEBUG - cur time: 2023-06-27T23:59:59.999 == next bar open time: 2023-06-28T00:00:00.000 == close pos time: 2023-07-03T00:00:00.000
2024-12-12 23:54:03,753 - DEBUG - close time 2023-06-27T23:59:59.999 == vol_threshold: 19112294.35
2024-12-12 23:54:03,753 - DEBUG - 2023-06-27T23:59:59.999 == all trade symbol 166 == remain 116 after VOL filter
2024-12-12 23:54:03,754 - DEBUG - sorted_long_factors: shape: (116, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -5.388233    ┆ 0    ┆ 115          │
│ HOTUSDT      ┆ -4.808614    ┆ 1    ┆ 114          │
│ LUNA2USDT    ┆ -4.437646    ┆ 2    ┆ 113          │
│ RVNUSDT      ┆ -3.88366     ┆ 3    ┆ 112          │
│ ADAUSDT      ┆ -3.363339    ┆ 4    ┆ 111          │
│ 1000SHIBUSDT ┆ -3.209901    ┆ 5    ┆ 110          │
│ SKLUSDT      ┆ -2.822317    ┆ 6    ┆ 109          │
│ LEVERUSDT    ┆ -2.527178    ┆ 7    ┆ 108          │
│ XRPUSDT      ┆ -2.439153    ┆ 8    ┆ 107          │
│ IOTXUSDT     ┆ -2.278495    ┆ 9    ┆ 106          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TRXUSDT      ┆ 2.469296     ┆ 106  ┆ 9            │
│ DENTUSDT     ┆ 2.660905     ┆ 107  ┆ 8            │
│ WOOUSDT      ┆ 2.796042     ┆ 108  ┆ 7            │
│ OMGUSDT      ┆ 2.904518     ┆ 109  ┆ 6            │
│ THETAUSDT    ┆ 3.356977     ┆ 110  ┆ 5            │
│ XLMUSDT      ┆ 3.402517     ┆ 111  ┆ 4            │
│ JOEUSDT      ┆ 3.424372     ┆ 112  ┆ 3            │
│ VETUSDT      ┆ 3.891091     ┆ 113  ┆ 2            │
│ CTSIUSDT     ┆ 3.99177      ┆ 114  ┆ 1            │
│ ALGOUSDT     ┆ 6.279756     ┆ 115  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,759 - WARNING - 2023-06-27T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,759 - INFO - cur close time: 2023-06-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:03,759 - DEBUG - mean expected ret (mean factor): 0.08992567015611831
2024-12-12 23:54:03,762 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,762 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,762 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09142     ┆ null        ┆ … ┆ 0.02054 ┆ null   ┆ null    ┆ 0.2174  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,769 - DEBUG - update position: 2023-06-27T23:59:59.999 === diff_trading_value: 341819.4021484143 == cash: 116267.07037099604 
2024-12-12 23:54:03,769 - INFO - pnl: 2023-06-27T23:59:59.999 116267.07037099604 === 0.309%
2024-12-12 23:54:03,774 - DEBUG - cur time: 2023-06-28T23:59:59.999 == next bar open time: 2023-06-29T00:00:00.000 == close pos time: 2023-07-04T00:00:00.000
2024-12-12 23:54:03,774 - INFO - pnl: 2023-06-28T23:59:59.999 116731.27595129971 === 0.399%
2024-12-12 23:54:03,778 - DEBUG - cur time: 2023-06-29T23:59:59.999 == next bar open time: 2023-06-30T00:00:00.000 == close pos time: 2023-07-05T00:00:00.000
2024-12-12 23:54:03,778 - INFO - pnl: 2023-06-29T23:59:59.999 116601.15638733418 === -0.111%
2024-12-12 23:54:03,780 - DEBUG - cur time: 2023-06-30T23:59:59.999 == next bar open time: 2023-07-01T00:00:00.000 == close pos time: 2023-07-06T00:00:00.000
2024-12-12 23:54:03,782 - INFO - pnl: 2023-06-30T23:59:59.999 117317.1170837083 === 0.614%
2024-12-12 23:54:03,782 - DEBUG - cur time: 2023-07-01T23:59:59.999 == next bar open time: 2023-07-02T00:00:00.000 == close pos time: 2023-07-07T00:00:00.000
2024-12-12 23:54:03,786 - INFO - pnl: 2023-07-01T23:59:59.999 118995.55347004916 === 1.431%
2024-12-12 23:54:03,786 - DEBUG - cur time: 2023-07-02T23:59:59.999 == next bar open time: 2023-07-03T00:00:00.000 == close pos time: 2023-07-08T00:00:00.000
2024-12-12 23:54:03,795 - DEBUG - close time 2023-07-02T23:59:59.999 == vol_threshold: 21666055.55
2024-12-12 23:54:03,795 - DEBUG - 2023-07-02T23:59:59.999 == all trade symbol 166 == remain 116 after VOL filter
2024-12-12 23:54:03,800 - DEBUG - sorted_long_factors: shape: (116, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -5.36807     ┆ 0    ┆ 115          │
│ LEVERUSDT    ┆ -4.84639     ┆ 1    ┆ 114          │
│ ACHUSDT      ┆ -3.624718    ┆ 2    ┆ 113          │
│ NKNUSDT      ┆ -2.734934    ┆ 3    ┆ 112          │
│ OCEANUSDT    ┆ -2.528797    ┆ 4    ┆ 111          │
│ APEUSDT      ┆ -2.456514    ┆ 5    ┆ 110          │
│ IOTAUSDT     ┆ -2.390805    ┆ 6    ┆ 109          │
│ ARBUSDT      ┆ -2.267885    ┆ 7    ┆ 108          │
│ XRPUSDT      ┆ -2.177402    ┆ 8    ┆ 107          │
│ IDUSDT       ┆ -2.165982    ┆ 9    ┆ 106          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CKBUSDT      ┆ 2.530734     ┆ 106  ┆ 9            │
│ CELOUSDT     ┆ 2.578839     ┆ 107  ┆ 8            │
│ DOTUSDT      ┆ 2.684272     ┆ 108  ┆ 7            │
│ FLOWUSDT     ┆ 2.708697     ┆ 109  ┆ 6            │
│ STORJUSDT    ┆ 3.23884      ┆ 110  ┆ 5            │
│ DENTUSDT     ┆ 3.365635     ┆ 111  ┆ 4            │
│ RENUSDT      ┆ 3.714256     ┆ 112  ┆ 3            │
│ 1000XECUSDT  ┆ 4.409881     ┆ 113  ┆ 2            │
│ DARUSDT      ┆ 4.56631      ┆ 114  ┆ 1            │
│ TUSDT        ┆ 4.858067     ┆ 115  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,803 - WARNING - 2023-07-02T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,803 - INFO - cur close time: 2023-07-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:03,805 - DEBUG - mean expected ret (mean factor): 0.12415245400874814
2024-12-12 23:54:03,808 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,808 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,809 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08679     ┆ null        ┆ … ┆ 0.02149 ┆ null   ┆ null    ┆ 0.2143  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,812 - DEBUG - update position: 2023-07-02T23:59:59.999 === diff_trading_value: 303329.20104445517 == cash: 118422.54921031962 
2024-12-12 23:54:03,816 - INFO - pnl: 2023-07-02T23:59:59.999 118422.54921031962 === -0.482%
2024-12-12 23:54:03,818 - DEBUG - cur time: 2023-07-03T23:59:59.999 == next bar open time: 2023-07-04T00:00:00.000 == close pos time: 2023-07-09T00:00:00.000
2024-12-12 23:54:03,819 - INFO - pnl: 2023-07-03T23:59:59.999 118038.73044729276 === -0.324%
2024-12-12 23:54:03,819 - DEBUG - cur time: 2023-07-04T23:59:59.999 == next bar open time: 2023-07-05T00:00:00.000 == close pos time: 2023-07-10T00:00:00.000
2024-12-12 23:54:03,819 - INFO - pnl: 2023-07-04T23:59:59.999 119405.60521650215 === 1.158%
2024-12-12 23:54:03,823 - DEBUG - cur time: 2023-07-05T23:59:59.999 == next bar open time: 2023-07-06T00:00:00.000 == close pos time: 2023-07-11T00:00:00.000
2024-12-12 23:54:03,823 - INFO - pnl: 2023-07-05T23:59:59.999 117908.15381222982 === -1.254%
2024-12-12 23:54:03,827 - DEBUG - cur time: 2023-07-06T23:59:59.999 == next bar open time: 2023-07-07T00:00:00.000 == close pos time: 2023-07-12T00:00:00.000
2024-12-12 23:54:03,829 - INFO - pnl: 2023-07-06T23:59:59.999 118313.93143254801 === 0.344%
2024-12-12 23:54:03,831 - DEBUG - cur time: 2023-07-07T23:59:59.999 == next bar open time: 2023-07-08T00:00:00.000 == close pos time: 2023-07-13T00:00:00.000
2024-12-12 23:54:03,840 - DEBUG - close time 2023-07-07T23:59:59.999 == vol_threshold: 16870660.35
2024-12-12 23:54:03,840 - DEBUG - 2023-07-07T23:59:59.999 == all trade symbol 166 == remain 116 after VOL filter
2024-12-12 23:54:03,840 - DEBUG - sorted_long_factors: shape: (116, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ IDUSDT       ┆ -4.448528    ┆ 0    ┆ 115          │
│ 1000LUNCUSDT ┆ -4.325003    ┆ 1    ┆ 114          │
│ DOGEUSDT     ┆ -3.783237    ┆ 2    ┆ 113          │
│ DUSKUSDT     ┆ -3.138608    ┆ 3    ┆ 112          │
│ XRPUSDT      ┆ -2.882325    ┆ 4    ┆ 111          │
│ 1000SHIBUSDT ┆ -2.643343    ┆ 5    ┆ 110          │
│ MINAUSDT     ┆ -2.526888    ┆ 6    ┆ 109          │
│ WAVESUSDT    ┆ -2.40952     ┆ 7    ┆ 108          │
│ OGNUSDT      ┆ -2.392508    ┆ 8    ┆ 107          │
│ ALGOUSDT     ┆ -2.299834    ┆ 9    ┆ 106          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ASTRUSDT     ┆ 2.598221     ┆ 106  ┆ 9            │
│ REEFUSDT     ┆ 2.624087     ┆ 107  ┆ 8            │
│ BATUSDT      ┆ 2.774064     ┆ 108  ┆ 7            │
│ TRUUSDT      ┆ 2.959473     ┆ 109  ┆ 6            │
│ ENJUSDT      ┆ 3.221594     ┆ 110  ┆ 5            │
│ EOSUSDT      ┆ 3.498948     ┆ 111  ┆ 4            │
│ JASMYUSDT    ┆ 3.858868     ┆ 112  ┆ 3            │
│ VETUSDT      ┆ 3.972822     ┆ 113  ┆ 2            │
│ TUSDT        ┆ 4.90382      ┆ 114  ┆ 1            │
│ CKBUSDT      ┆ 5.127969     ┆ 115  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,844 - WARNING - 2023-07-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,844 - INFO - cur close time: 2023-07-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:03,844 - DEBUG - mean expected ret (mean factor): 0.09246142277872339
2024-12-12 23:54:03,850 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,850 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,850 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08145     ┆ null        ┆ … ┆ 0.02068 ┆ null   ┆ null    ┆ 0.21    │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,856 - DEBUG - update position: 2023-07-07T23:59:59.999 === diff_trading_value: 298364.03603933624 == cash: 116350.82530797733 
2024-12-12 23:54:03,856 - INFO - pnl: 2023-07-07T23:59:59.999 116350.82530797733 === -1.659%
2024-12-12 23:54:03,860 - DEBUG - cur time: 2023-07-08T23:59:59.999 == next bar open time: 2023-07-09T00:00:00.000 == close pos time: 2023-07-14T00:00:00.000
2024-12-12 23:54:03,860 - INFO - pnl: 2023-07-08T23:59:59.999 113980.87851680089 === -2.037%
2024-12-12 23:54:03,864 - DEBUG - cur time: 2023-07-09T23:59:59.999 == next bar open time: 2023-07-10T00:00:00.000 == close pos time: 2023-07-15T00:00:00.000
2024-12-12 23:54:03,864 - INFO - pnl: 2023-07-09T23:59:59.999 114972.41499313808 === 0.870%
2024-12-12 23:54:03,868 - DEBUG - cur time: 2023-07-10T23:59:59.999 == next bar open time: 2023-07-11T00:00:00.000 == close pos time: 2023-07-16T00:00:00.000
2024-12-12 23:54:03,869 - INFO - pnl: 2023-07-10T23:59:59.999 113372.5933211277 === -1.391%
2024-12-12 23:54:03,871 - DEBUG - cur time: 2023-07-11T23:59:59.999 == next bar open time: 2023-07-12T00:00:00.000 == close pos time: 2023-07-17T00:00:00.000
2024-12-12 23:54:03,871 - INFO - pnl: 2023-07-11T23:59:59.999 115383.37883250823 === 1.774%
2024-12-12 23:54:03,876 - DEBUG - cur time: 2023-07-12T23:59:59.999 == next bar open time: 2023-07-13T00:00:00.000 == close pos time: 2023-07-18T00:00:00.000
2024-12-12 23:54:03,884 - DEBUG - close time 2023-07-12T23:59:59.999 == vol_threshold: 17850964.67
2024-12-12 23:54:03,884 - DEBUG - 2023-07-12T23:59:59.999 == all trade symbol 168 == remain 117 after VOL filter
2024-12-12 23:54:03,884 - DEBUG - sorted_long_factors: shape: (117, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ RDNTUSDT  ┆ -5.048816    ┆ 0    ┆ 116          │
│ DUSKUSDT  ┆ -4.177917    ┆ 1    ┆ 115          │
│ OGNUSDT   ┆ -3.858042    ┆ 2    ┆ 114          │
│ REEFUSDT  ┆ -3.454937    ┆ 3    ┆ 113          │
│ XRPUSDT   ┆ -3.110338    ┆ 4    ┆ 112          │
│ DYDXUSDT  ┆ -3.075825    ┆ 5    ┆ 111          │
│ PHBUSDT   ┆ -2.588148    ┆ 6    ┆ 110          │
│ HBARUSDT  ┆ -2.58633     ┆ 7    ┆ 109          │
│ IDUSDT    ┆ -2.559641    ┆ 8    ┆ 108          │
│ SPELLUSDT ┆ -2.501128    ┆ 9    ┆ 107          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XEMUSDT   ┆ 2.746052     ┆ 107  ┆ 9            │
│ ALGOUSDT  ┆ 2.919051     ┆ 108  ┆ 8            │
│ ROSEUSDT  ┆ 3.105975     ┆ 109  ┆ 7            │
│ SANDUSDT  ┆ 3.243811     ┆ 110  ┆ 6            │
│ MANAUSDT  ┆ 3.297734     ┆ 111  ┆ 5            │
│ VETUSDT   ┆ 3.383101     ┆ 112  ┆ 4            │
│ GMTUSDT   ┆ 3.517914     ┆ 113  ┆ 3            │
│ SFPUSDT   ┆ 4.182111     ┆ 114  ┆ 2            │
│ LQTYUSDT  ┆ 4.577263     ┆ 115  ┆ 1            │
│ TRXUSDT   ┆ 5.032802     ┆ 116  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,891 - WARNING - 2023-07-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,891 - INFO - cur close time: 2023-07-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:03,891 - DEBUG - mean expected ret (mean factor): 0.10792161830249564
2024-12-12 23:54:03,895 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,895 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,895 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08356     ┆ null        ┆ … ┆ 0.02089 ┆ null   ┆ null    ┆ 0.2098  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,903 - DEBUG - update position: 2023-07-12T23:59:59.999 === diff_trading_value: 290877.51058612077 == cash: 116249.53928852793 
2024-12-12 23:54:03,903 - INFO - pnl: 2023-07-12T23:59:59.999 116249.53928852793 === 0.751%
2024-12-12 23:54:03,903 - DEBUG - cur time: 2023-07-13T23:59:59.999 == next bar open time: 2023-07-14T00:00:00.000 == close pos time: 2023-07-19T00:00:00.000
2024-12-12 23:54:03,908 - INFO - pnl: 2023-07-13T23:59:59.999 108011.87124128467 === -7.086%
2024-12-12 23:54:03,910 - DEBUG - cur time: 2023-07-14T23:59:59.999 == next bar open time: 2023-07-15T00:00:00.000 == close pos time: 2023-07-20T00:00:00.000
2024-12-12 23:54:03,912 - INFO - pnl: 2023-07-14T23:59:59.999 107738.2213592423 === -0.253%
2024-12-12 23:54:03,912 - DEBUG - cur time: 2023-07-15T23:59:59.999 == next bar open time: 2023-07-16T00:00:00.000 == close pos time: 2023-07-21T00:00:00.000
2024-12-12 23:54:03,916 - INFO - pnl: 2023-07-15T23:59:59.999 108716.13849840428 === 0.908%
2024-12-12 23:54:03,916 - DEBUG - cur time: 2023-07-16T23:59:59.999 == next bar open time: 2023-07-17T00:00:00.000 == close pos time: 2023-07-22T00:00:00.000
2024-12-12 23:54:03,919 - INFO - pnl: 2023-07-16T23:59:59.999 110796.94959654672 === 1.914%
2024-12-12 23:54:03,920 - DEBUG - cur time: 2023-07-17T23:59:59.999 == next bar open time: 2023-07-18T00:00:00.000 == close pos time: 2023-07-23T00:00:00.000
2024-12-12 23:54:03,930 - DEBUG - close time 2023-07-17T23:59:59.999 == vol_threshold: 27268807.01
2024-12-12 23:54:03,930 - DEBUG - 2023-07-17T23:59:59.999 == all trade symbol 172 == remain 120 after VOL filter
2024-12-12 23:54:03,932 - DEBUG - sorted_long_factors: shape: (120, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ RDNTUSDT  ┆ -4.524983    ┆ 0    ┆ 119          │
│ BLURUSDT  ┆ -4.297842    ┆ 1    ┆ 118          │
│ TLMUSDT   ┆ -3.780334    ┆ 2    ┆ 117          │
│ MINAUSDT  ┆ -3.468794    ┆ 3    ┆ 116          │
│ IDEXUSDT  ┆ -3.35885     ┆ 4    ┆ 115          │
│ PHBUSDT   ┆ -3.076771    ┆ 5    ┆ 114          │
│ XRPUSDT   ┆ -2.741005    ┆ 6    ┆ 113          │
│ EDUUSDT   ┆ -2.737392    ┆ 7    ┆ 112          │
│ IDUSDT    ┆ -2.651736    ┆ 8    ┆ 111          │
│ HFTUSDT   ┆ -2.624954    ┆ 9    ┆ 110          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CTSIUSDT  ┆ 2.45617      ┆ 110  ┆ 9            │
│ XEMUSDT   ┆ 2.810828     ┆ 111  ┆ 8            │
│ AMBUSDT   ┆ 2.914964     ┆ 112  ┆ 7            │
│ IOTXUSDT  ┆ 2.947829     ┆ 113  ┆ 6            │
│ GMTUSDT   ┆ 2.990276     ┆ 114  ┆ 5            │
│ 1INCHUSDT ┆ 3.054584     ┆ 115  ┆ 4            │
│ SKLUSDT   ┆ 4.126875     ┆ 116  ┆ 3            │
│ SPELLUSDT ┆ 5.166084     ┆ 117  ┆ 2            │
│ OGNUSDT   ┆ 9.476538     ┆ 118  ┆ 1            │
│ NKNUSDT   ┆ 9.678061     ┆ 119  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,936 - WARNING - 2023-07-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,936 - INFO - cur close time: 2023-07-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:03,936 - DEBUG - mean expected ret (mean factor): 0.09839949082038653
2024-12-12 23:54:03,940 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,940 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,940 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02449     ┆ 0.0916      ┆ 0.0015748   ┆ … ┆ 0.02236 ┆ null   ┆ null    ┆ 0.2222  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,944 - DEBUG - update position: 2023-07-17T23:59:59.999 === diff_trading_value: 289332.71400603396 == cash: 111382.85443004352 
2024-12-12 23:54:03,944 - INFO - pnl: 2023-07-17T23:59:59.999 111382.85443004352 === 0.529%
2024-12-12 23:54:03,950 - DEBUG - cur time: 2023-07-18T23:59:59.999 == next bar open time: 2023-07-19T00:00:00.000 == close pos time: 2023-07-24T00:00:00.000
2024-12-12 23:54:03,950 - INFO - pnl: 2023-07-18T23:59:59.999 109366.97702551032 === -1.810%
2024-12-12 23:54:03,952 - DEBUG - cur time: 2023-07-19T23:59:59.999 == next bar open time: 2023-07-20T00:00:00.000 == close pos time: 2023-07-25T00:00:00.000
2024-12-12 23:54:03,952 - INFO - pnl: 2023-07-19T23:59:59.999 108755.28800512684 === -0.559%
2024-12-12 23:54:03,956 - DEBUG - cur time: 2023-07-20T23:59:59.999 == next bar open time: 2023-07-21T00:00:00.000 == close pos time: 2023-07-26T00:00:00.000
2024-12-12 23:54:03,956 - INFO - pnl: 2023-07-20T23:59:59.999 108350.52844240873 === -0.372%
2024-12-12 23:54:03,959 - DEBUG - cur time: 2023-07-21T23:59:59.999 == next bar open time: 2023-07-22T00:00:00.000 == close pos time: 2023-07-27T00:00:00.000
2024-12-12 23:54:03,959 - INFO - pnl: 2023-07-21T23:59:59.999 111387.34430922184 === 2.803%
2024-12-12 23:54:03,963 - DEBUG - cur time: 2023-07-22T23:59:59.999 == next bar open time: 2023-07-23T00:00:00.000 == close pos time: 2023-07-28T00:00:00.000
2024-12-12 23:54:03,971 - DEBUG - close time 2023-07-22T23:59:59.999 == vol_threshold: 14350633.989999998
2024-12-12 23:54:03,971 - DEBUG - 2023-07-22T23:59:59.999 == all trade symbol 174 == remain 122 after VOL filter
2024-12-12 23:54:03,971 - DEBUG - sorted_long_factors: shape: (122, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ CHRUSDT   ┆ -4.338037    ┆ 0    ┆ 121          │
│ TLMUSDT   ┆ -4.044853    ┆ 1    ┆ 120          │
│ EDUUSDT   ┆ -3.194955    ┆ 2    ┆ 119          │
│ XRPUSDT   ┆ -3.148738    ┆ 3    ┆ 118          │
│ JASMYUSDT ┆ -3.117053    ┆ 4    ┆ 117          │
│ ACHUSDT   ┆ -3.083778    ┆ 5    ┆ 116          │
│ BLURUSDT  ┆ -3.04488     ┆ 6    ┆ 115          │
│ DUSKUSDT  ┆ -3.02489     ┆ 7    ┆ 114          │
│ HOTUSDT   ┆ -2.879888    ┆ 8    ┆ 113          │
│ MAGICUSDT ┆ -2.877203    ┆ 9    ┆ 112          │
│ …         ┆ …            ┆ …    ┆ …            │
│ IOSTUSDT  ┆ 2.100535     ┆ 112  ┆ 9            │
│ SUIUSDT   ┆ 2.115781     ┆ 113  ┆ 8            │
│ XLMUSDT   ┆ 2.307799     ┆ 114  ┆ 7            │
│ TRXUSDT   ┆ 3.081688     ┆ 115  ┆ 6            │
│ OPUSDT    ┆ 3.153171     ┆ 116  ┆ 5            │
│ CKBUSDT   ┆ 3.185857     ┆ 117  ┆ 4            │
│ XEMUSDT   ┆ 3.33947      ┆ 118  ┆ 3            │
│ DGBUSDT   ┆ 3.426857     ┆ 119  ┆ 2            │
│ STMXUSDT  ┆ 5.074843     ┆ 120  ┆ 1            │
│ COTIUSDT  ┆ 16.165982    ┆ 121  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:03,980 - WARNING - 2023-07-22T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:03,980 - INFO - cur close time: 2023-07-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:03,980 - DEBUG - mean expected ret (mean factor): -0.102822944166792
2024-12-12 23:54:03,983 - DEBUG - begin to update pos: =========
2024-12-12 23:54:03,983 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,983 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02377     ┆ 0.08723     ┆ 0.0014901   ┆ … ┆ 0.02148 ┆ null   ┆ null    ┆ 0.2083  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:03,989 - DEBUG - update position: 2023-07-22T23:59:59.999 === diff_trading_value: 288553.3303623122 == cash: 113908.99821460524 
2024-12-12 23:54:03,991 - INFO - pnl: 2023-07-22T23:59:59.999 113908.99821460524 === 2.264%
2024-12-12 23:54:03,995 - DEBUG - cur time: 2023-07-23T23:59:59.999 == next bar open time: 2023-07-24T00:00:00.000 == close pos time: 2023-07-29T00:00:00.000
2024-12-12 23:54:03,995 - INFO - pnl: 2023-07-23T23:59:59.999 112040.19935753645 === -1.641%
2024-12-12 23:54:04,000 - DEBUG - cur time: 2023-07-24T23:59:59.999 == next bar open time: 2023-07-25T00:00:00.000 == close pos time: 2023-07-30T00:00:00.000
2024-12-12 23:54:04,000 - INFO - pnl: 2023-07-24T23:59:59.999 113508.07357337367 === 1.310%
2024-12-12 23:54:04,000 - DEBUG - cur time: 2023-07-25T23:59:59.999 == next bar open time: 2023-07-26T00:00:00.000 == close pos time: 2023-07-31T00:00:00.000
2024-12-12 23:54:04,004 - INFO - pnl: 2023-07-25T23:59:59.999 112629.392586554 === -0.774%
2024-12-12 23:54:04,004 - DEBUG - cur time: 2023-07-26T23:59:59.999 == next bar open time: 2023-07-27T00:00:00.000 == close pos time: 2023-08-01T00:00:00.000
2024-12-12 23:54:04,008 - INFO - pnl: 2023-07-26T23:59:59.999 112575.62323670741 === -0.048%
2024-12-12 23:54:04,010 - DEBUG - cur time: 2023-07-27T23:59:59.999 == next bar open time: 2023-07-28T00:00:00.000 == close pos time: 2023-08-02T00:00:00.000
2024-12-12 23:54:04,019 - DEBUG - close time 2023-07-27T23:59:59.999 == vol_threshold: 16224827.05
2024-12-12 23:54:04,019 - DEBUG - 2023-07-27T23:59:59.999 == all trade symbol 174 == remain 122 after VOL filter
2024-12-12 23:54:04,019 - DEBUG - sorted_long_factors: shape: (122, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -6.751851    ┆ 0    ┆ 121          │
│ ACHUSDT      ┆ -4.299497    ┆ 1    ┆ 120          │
│ IDEXUSDT     ┆ -4.270928    ┆ 2    ┆ 119          │
│ XRPUSDT      ┆ -3.75348     ┆ 3    ┆ 118          │
│ ROSEUSDT     ┆ -3.559887    ┆ 4    ┆ 117          │
│ BLURUSDT     ┆ -3.497866    ┆ 5    ┆ 116          │
│ DUSKUSDT     ┆ -3.275808    ┆ 6    ┆ 115          │
│ ARBUSDT      ┆ -3.240996    ┆ 7    ┆ 114          │
│ ALGOUSDT     ┆ -2.694509    ┆ 8    ┆ 113          │
│ WAVESUSDT    ┆ -2.688349    ┆ 9    ┆ 112          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CHRUSDT      ┆ 2.229709     ┆ 112  ┆ 9            │
│ OGNUSDT      ┆ 2.438207     ┆ 113  ┆ 8            │
│ TOMOUSDT     ┆ 2.579522     ┆ 114  ┆ 7            │
│ ENJUSDT      ┆ 2.6178       ┆ 115  ┆ 6            │
│ SKLUSDT      ┆ 2.800118     ┆ 116  ┆ 5            │
│ GTCUSDT      ┆ 4.688607     ┆ 117  ┆ 4            │
│ BLZUSDT      ┆ 4.774484     ┆ 118  ┆ 3            │
│ ANKRUSDT     ┆ 5.018417     ┆ 119  ┆ 2            │
│ SFPUSDT      ┆ 5.157455     ┆ 120  ┆ 1            │
│ IOTAUSDT     ┆ 5.501579     ┆ 121  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,023 - WARNING - 2023-07-27T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,023 - INFO - cur close time: 2023-07-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:04,027 - DEBUG - mean expected ret (mean factor): -0.23783525491774088
2024-12-12 23:54:04,029 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,031 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,031 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02231     ┆ 0.08058     ┆ 0.0013428   ┆ … ┆ 0.02073 ┆ null   ┆ null    ┆ 0.2081  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,035 - DEBUG - update position: 2023-07-27T23:59:59.999 === diff_trading_value: 269340.97293333116 == cash: 111568.6276025453 
2024-12-12 23:54:04,035 - INFO - pnl: 2023-07-27T23:59:59.999 111568.6276025453 === -0.895%
2024-12-12 23:54:04,039 - DEBUG - cur time: 2023-07-28T23:59:59.999 == next bar open time: 2023-07-29T00:00:00.000 == close pos time: 2023-08-03T00:00:00.000
2024-12-12 23:54:04,039 - INFO - pnl: 2023-07-28T23:59:59.999 113044.8118817952 === 1.323%
2024-12-12 23:54:04,044 - DEBUG - cur time: 2023-07-29T23:59:59.999 == next bar open time: 2023-07-30T00:00:00.000 == close pos time: 2023-08-04T00:00:00.000
2024-12-12 23:54:04,044 - INFO - pnl: 2023-07-29T23:59:59.999 115010.17013104807 === 1.739%
2024-12-12 23:54:04,048 - DEBUG - cur time: 2023-07-30T23:59:59.999 == next bar open time: 2023-07-31T00:00:00.000 == close pos time: 2023-08-05T00:00:00.000
2024-12-12 23:54:04,048 - INFO - pnl: 2023-07-30T23:59:59.999 114026.168315123 === -0.856%
2024-12-12 23:54:04,050 - DEBUG - cur time: 2023-07-31T23:59:59.999 == next bar open time: 2023-08-01T00:00:00.000 == close pos time: 2023-08-06T00:00:00.000
2024-12-12 23:54:04,052 - INFO - pnl: 2023-07-31T23:59:59.999 113389.28643507426 === -0.559%
2024-12-12 23:54:04,052 - DEBUG - cur time: 2023-08-01T23:59:59.999 == next bar open time: 2023-08-02T00:00:00.000 == close pos time: 2023-08-07T00:00:00.000
2024-12-12 23:54:04,059 - DEBUG - close time 2023-08-01T23:59:59.999 == vol_threshold: 22417298.919999998
2024-12-12 23:54:04,063 - DEBUG - 2023-08-01T23:59:59.999 == all trade symbol 174 == remain 122 after VOL filter
2024-12-12 23:54:04,063 - DEBUG - sorted_long_factors: shape: (122, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ACHUSDT      ┆ -4.943894    ┆ 0    ┆ 121          │
│ TUSDT        ┆ -3.392689    ┆ 1    ┆ 120          │
│ XRPUSDT      ┆ -2.79254     ┆ 2    ┆ 119          │
│ IOSTUSDT     ┆ -2.658033    ┆ 3    ┆ 118          │
│ 1000SHIBUSDT ┆ -2.638567    ┆ 4    ┆ 117          │
│ RVNUSDT      ┆ -2.592936    ┆ 5    ┆ 116          │
│ DUSKUSDT     ┆ -2.507237    ┆ 6    ┆ 115          │
│ RDNTUSDT     ┆ -2.423511    ┆ 7    ┆ 114          │
│ LUNA2USDT    ┆ -2.284335    ┆ 8    ┆ 113          │
│ ARBUSDT      ┆ -2.2306      ┆ 9    ┆ 112          │
│ …            ┆ …            ┆ …    ┆ …            │
│ NEARUSDT     ┆ 1.772583     ┆ 112  ┆ 9            │
│ CKBUSDT      ┆ 1.776177     ┆ 113  ┆ 8            │
│ LRCUSDT      ┆ 1.778543     ┆ 114  ┆ 7            │
│ KNCUSDT      ┆ 1.803948     ┆ 115  ┆ 6            │
│ LDOUSDT      ┆ 1.916121     ┆ 116  ┆ 5            │
│ COTIUSDT     ┆ 2.173398     ┆ 117  ┆ 4            │
│ GRTUSDT      ┆ 2.220158     ┆ 118  ┆ 3            │
│ UNIUSDT      ┆ 2.620778     ┆ 119  ┆ 2            │
│ QTUMUSDT     ┆ 2.854767     ┆ 120  ┆ 1            │
│ CRVUSDT      ┆ 2.960781     ┆ 121  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,069 - WARNING - 2023-08-01T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,069 - INFO - cur close time: 2023-08-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:04,069 - DEBUG - mean expected ret (mean factor): -0.2333480897783782
2024-12-12 23:54:04,071 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,071 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,071 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02278     ┆ 0.08132     ┆ 0.0013021   ┆ … ┆ 0.02105 ┆ null   ┆ null    ┆ 0.2214  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,079 - DEBUG - update position: 2023-08-01T23:59:59.999 === diff_trading_value: 292561.4909103073 == cash: 113360.89552130517 
2024-12-12 23:54:04,079 - INFO - pnl: 2023-08-01T23:59:59.999 113360.89552130517 === -0.025%
2024-12-12 23:54:04,084 - DEBUG - cur time: 2023-08-02T23:59:59.999 == next bar open time: 2023-08-03T00:00:00.000 == close pos time: 2023-08-08T00:00:00.000
2024-12-12 23:54:04,084 - INFO - pnl: 2023-08-02T23:59:59.999 113649.9243101439 === 0.255%
2024-12-12 23:54:04,088 - DEBUG - cur time: 2023-08-03T23:59:59.999 == next bar open time: 2023-08-04T00:00:00.000 == close pos time: 2023-08-09T00:00:00.000
2024-12-12 23:54:04,090 - INFO - pnl: 2023-08-03T23:59:59.999 114196.16137641756 === 0.481%
2024-12-12 23:54:04,092 - DEBUG - cur time: 2023-08-04T23:59:59.999 == next bar open time: 2023-08-05T00:00:00.000 == close pos time: 2023-08-10T00:00:00.000
2024-12-12 23:54:04,092 - INFO - pnl: 2023-08-04T23:59:59.999 114230.32762384646 === 0.030%
2024-12-12 23:54:04,096 - DEBUG - cur time: 2023-08-05T23:59:59.999 == next bar open time: 2023-08-06T00:00:00.000 == close pos time: 2023-08-11T00:00:00.000
2024-12-12 23:54:04,098 - INFO - pnl: 2023-08-05T23:59:59.999 113851.85856102695 === -0.331%
2024-12-12 23:54:04,100 - DEBUG - cur time: 2023-08-06T23:59:59.999 == next bar open time: 2023-08-07T00:00:00.000 == close pos time: 2023-08-12T00:00:00.000
2024-12-12 23:54:04,110 - DEBUG - close time 2023-08-06T23:59:59.999 == vol_threshold: 15546119.019999998
2024-12-12 23:54:04,110 - DEBUG - 2023-08-06T23:59:59.999 == all trade symbol 175 == remain 122 after VOL filter
2024-12-12 23:54:04,112 - DEBUG - sorted_long_factors: shape: (122, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ CKBUSDT   ┆ -7.310676    ┆ 0    ┆ 121          │
│ LDOUSDT   ┆ -4.590888    ┆ 1    ┆ 120          │
│ IOTAUSDT  ┆ -3.887167    ┆ 2    ┆ 119          │
│ HOTUSDT   ┆ -3.015521    ┆ 3    ┆ 118          │
│ ADAUSDT   ┆ -2.99581     ┆ 4    ┆ 117          │
│ XRPUSDT   ┆ -2.987859    ┆ 5    ┆ 116          │
│ ASTRUSDT  ┆ -2.511605    ┆ 6    ┆ 115          │
│ LQTYUSDT  ┆ -2.403247    ┆ 7    ┆ 114          │
│ KEYUSDT   ┆ -2.351465    ┆ 8    ┆ 113          │
│ DYDXUSDT  ┆ -2.328356    ┆ 9    ┆ 112          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CELRUSDT  ┆ 2.538848     ┆ 112  ┆ 9            │
│ DGBUSDT   ┆ 2.61918      ┆ 113  ┆ 8            │
│ FLOWUSDT  ┆ 3.219282     ┆ 114  ┆ 7            │
│ RENUSDT   ┆ 3.259885     ┆ 115  ┆ 6            │
│ ARPAUSDT  ┆ 3.518014     ┆ 116  ┆ 5            │
│ API3USDT  ┆ 3.691323     ┆ 117  ┆ 4            │
│ ONEUSDT   ┆ 3.938412     ┆ 118  ┆ 3            │
│ MINAUSDT  ┆ 4.280974     ┆ 119  ┆ 2            │
│ ATAUSDT   ┆ 5.064188     ┆ 120  ┆ 1            │
│ LEVERUSDT ┆ 6.789132     ┆ 121  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,116 - WARNING - 2023-08-06T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,116 - INFO - cur close time: 2023-08-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:04,116 - DEBUG - mean expected ret (mean factor): -0.12753330352090272
2024-12-12 23:54:04,119 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,119 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,119 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02269     ┆ 0.07887     ┆ 0.0011567   ┆ … ┆ 0.02017 ┆ null   ┆ null    ┆ 0.2191  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,123 - DEBUG - update position: 2023-08-06T23:59:59.999 === diff_trading_value: 348449.7029065004 == cash: 114460.49867736989 
2024-12-12 23:54:04,127 - INFO - pnl: 2023-08-06T23:59:59.999 114460.49867736989 === 0.535%
2024-12-12 23:54:04,129 - DEBUG - cur time: 2023-08-07T23:59:59.999 == next bar open time: 2023-08-08T00:00:00.000 == close pos time: 2023-08-13T00:00:00.000
2024-12-12 23:54:04,131 - INFO - pnl: 2023-08-07T23:59:59.999 113182.02070604652 === -1.117%
2024-12-12 23:54:04,131 - DEBUG - cur time: 2023-08-08T23:59:59.999 == next bar open time: 2023-08-09T00:00:00.000 == close pos time: 2023-08-14T00:00:00.000
2024-12-12 23:54:04,131 - INFO - pnl: 2023-08-08T23:59:59.999 113011.8154156442 === -0.150%
2024-12-12 23:54:04,135 - DEBUG - cur time: 2023-08-09T23:59:59.999 == next bar open time: 2023-08-10T00:00:00.000 == close pos time: 2023-08-15T00:00:00.000
2024-12-12 23:54:04,135 - INFO - pnl: 2023-08-09T23:59:59.999 112041.47115563853 === -0.859%
2024-12-12 23:54:04,139 - DEBUG - cur time: 2023-08-10T23:59:59.999 == next bar open time: 2023-08-11T00:00:00.000 == close pos time: 2023-08-16T00:00:00.000
2024-12-12 23:54:04,139 - INFO - pnl: 2023-08-10T23:59:59.999 111469.67023085806 === -0.510%
2024-12-12 23:54:04,144 - DEBUG - cur time: 2023-08-11T23:59:59.999 == next bar open time: 2023-08-12T00:00:00.000 == close pos time: 2023-08-17T00:00:00.000
2024-12-12 23:54:04,151 - DEBUG - close time 2023-08-11T23:59:59.999 == vol_threshold: 13480523.98
2024-12-12 23:54:04,151 - DEBUG - 2023-08-11T23:59:59.999 == all trade symbol 175 == remain 122 after VOL filter
2024-12-12 23:54:04,155 - DEBUG - sorted_long_factors: shape: (122, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000XECUSDT  ┆ -5.781857    ┆ 0    ┆ 121          │
│ MTLUSDT      ┆ -3.783431    ┆ 1    ┆ 120          │
│ WOOUSDT      ┆ -3.78302     ┆ 2    ┆ 119          │
│ 1000LUNCUSDT ┆ -3.299467    ┆ 3    ┆ 118          │
│ DOGEUSDT     ┆ -3.155555    ┆ 4    ┆ 117          │
│ CKBUSDT      ┆ -3.146359    ┆ 5    ┆ 116          │
│ CFXUSDT      ┆ -3.005494    ┆ 6    ┆ 115          │
│ HOTUSDT      ┆ -2.912802    ┆ 7    ┆ 114          │
│ KLAYUSDT     ┆ -2.577296    ┆ 8    ┆ 113          │
│ SUIUSDT      ┆ -2.501297    ┆ 9    ┆ 112          │
│ …            ┆ …            ┆ …    ┆ …            │
│ LINAUSDT     ┆ 3.038728     ┆ 112  ┆ 9            │
│ LQTYUSDT     ┆ 3.133284     ┆ 113  ┆ 8            │
│ CELOUSDT     ┆ 3.38537      ┆ 114  ┆ 7            │
│ FLOWUSDT     ┆ 3.57744      ┆ 115  ┆ 6            │
│ AMBUSDT      ┆ 3.779389     ┆ 116  ┆ 5            │
│ 1INCHUSDT    ┆ 4.361275     ┆ 117  ┆ 4            │
│ ATAUSDT      ┆ 4.542679     ┆ 118  ┆ 3            │
│ LPTUSDT      ┆ 5.318929     ┆ 119  ┆ 2            │
│ RUNEUSDT     ┆ 5.428638     ┆ 120  ┆ 1            │
│ RVNUSDT      ┆ 5.595368     ┆ 121  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,159 - WARNING - 2023-08-11T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,159 - INFO - cur close time: 2023-08-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:04,159 - DEBUG - mean expected ret (mean factor): 0.22942155417951265
2024-12-12 23:54:04,163 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,163 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,163 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02281     ┆ 0.07779     ┆ 0.0012458   ┆ … ┆ 0.02002 ┆ null   ┆ null    ┆ 0.2134  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,171 - DEBUG - update position: 2023-08-11T23:59:59.999 === diff_trading_value: 313221.42335508275 == cash: 112317.26036012746 
2024-12-12 23:54:04,171 - INFO - pnl: 2023-08-11T23:59:59.999 112317.26036012746 === 0.760%
2024-12-12 23:54:04,175 - DEBUG - cur time: 2023-08-12T23:59:59.999 == next bar open time: 2023-08-13T00:00:00.000 == close pos time: 2023-08-18T00:00:00.000
2024-12-12 23:54:04,175 - INFO - pnl: 2023-08-12T23:59:59.999 113332.78547657284 === 0.904%
2024-12-12 23:54:04,180 - DEBUG - cur time: 2023-08-13T23:59:59.999 == next bar open time: 2023-08-14T00:00:00.000 == close pos time: 2023-08-19T00:00:00.000
2024-12-12 23:54:04,180 - INFO - pnl: 2023-08-13T23:59:59.999 115001.74436870059 === 1.473%
2024-12-12 23:54:04,180 - DEBUG - cur time: 2023-08-14T23:59:59.999 == next bar open time: 2023-08-15T00:00:00.000 == close pos time: 2023-08-20T00:00:00.000
2024-12-12 23:54:04,184 - INFO - pnl: 2023-08-14T23:59:59.999 114635.80536986167 === -0.318%
2024-12-12 23:54:04,184 - DEBUG - cur time: 2023-08-15T23:59:59.999 == next bar open time: 2023-08-16T00:00:00.000 == close pos time: 2023-08-21T00:00:00.000
2024-12-12 23:54:04,188 - INFO - pnl: 2023-08-15T23:59:59.999 115769.81457121107 === 0.989%
2024-12-12 23:54:04,190 - DEBUG - cur time: 2023-08-16T23:59:59.999 == next bar open time: 2023-08-17T00:00:00.000 == close pos time: 2023-08-22T00:00:00.000
2024-12-12 23:54:04,199 - DEBUG - close time 2023-08-16T23:59:59.999 == vol_threshold: 33293232.35
2024-12-12 23:54:04,199 - DEBUG - 2023-08-16T23:59:59.999 == all trade symbol 176 == remain 123 after VOL filter
2024-12-12 23:54:04,199 - DEBUG - sorted_long_factors: shape: (123, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT       ┆ -2.59117     ┆ 0    ┆ 122          │
│ ARBUSDT       ┆ -2.488847    ┆ 1    ┆ 121          │
│ DOGEUSDT      ┆ -2.158665    ┆ 2    ┆ 120          │
│ 1000FLOKIUSDT ┆ -1.557582    ┆ 3    ┆ 119          │
│ ATAUSDT       ┆ -1.155806    ┆ 4    ┆ 118          │
│ ACHUSDT       ┆ -1.120144    ┆ 5    ┆ 117          │
│ MINAUSDT      ┆ -1.098185    ┆ 6    ┆ 116          │
│ APEUSDT       ┆ -1.044484    ┆ 7    ┆ 115          │
│ OGNUSDT       ┆ -1.01373     ┆ 8    ┆ 114          │
│ SUSHIUSDT     ┆ -0.939875    ┆ 9    ┆ 113          │
│ …             ┆ …            ┆ …    ┆ …            │
│ WAVESUSDT     ┆ 0.674885     ┆ 113  ┆ 9            │
│ SANDUSDT      ┆ 0.6768       ┆ 114  ┆ 8            │
│ GMTUSDT       ┆ 0.697415     ┆ 115  ┆ 7            │
│ STMXUSDT      ┆ 0.71824      ┆ 116  ┆ 6            │
│ LEVERUSDT     ┆ 0.80668      ┆ 117  ┆ 5            │
│ ARPAUSDT      ┆ 1.114253     ┆ 118  ┆ 4            │
│ SFPUSDT       ┆ 1.260772     ┆ 119  ┆ 3            │
│ BLZUSDT       ┆ 1.886315     ┆ 120  ┆ 2            │
│ LPTUSDT       ┆ 1.914043     ┆ 121  ┆ 1            │
│ RUNEUSDT      ┆ 2.039691     ┆ 122  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,207 - WARNING - 2023-08-16T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,208 - INFO - cur close time: 2023-08-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:04,208 - DEBUG - mean expected ret (mean factor): -0.13332584952396506
2024-12-12 23:54:04,210 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,212 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,212 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02126     ┆ 0.06588     ┆ 0.0011653   ┆ … ┆ 0.01786 ┆ null   ┆ null    ┆ 0.192   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,216 - DEBUG - update position: 2023-08-16T23:59:59.999 === diff_trading_value: 299059.1279737765 == cash: 115854.89383603766 
2024-12-12 23:54:04,219 - INFO - pnl: 2023-08-16T23:59:59.999 115854.89383603766 === 0.073%
2024-12-12 23:54:04,220 - DEBUG - cur time: 2023-08-17T23:59:59.999 == next bar open time: 2023-08-18T00:00:00.000 == close pos time: 2023-08-23T00:00:00.000
2024-12-12 23:54:04,220 - INFO - pnl: 2023-08-17T23:59:59.999 117501.66770225263 === 1.421%
2024-12-12 23:54:04,224 - DEBUG - cur time: 2023-08-18T23:59:59.999 == next bar open time: 2023-08-19T00:00:00.000 == close pos time: 2023-08-24T00:00:00.000
2024-12-12 23:54:04,224 - INFO - pnl: 2023-08-18T23:59:59.999 119491.06690697918 === 1.693%
2024-12-12 23:54:04,228 - DEBUG - cur time: 2023-08-19T23:59:59.999 == next bar open time: 2023-08-20T00:00:00.000 == close pos time: 2023-08-25T00:00:00.000
2024-12-12 23:54:04,230 - INFO - pnl: 2023-08-19T23:59:59.999 119645.71171543507 === 0.129%
2024-12-12 23:54:04,232 - DEBUG - cur time: 2023-08-20T23:59:59.999 == next bar open time: 2023-08-21T00:00:00.000 == close pos time: 2023-08-26T00:00:00.000
2024-12-12 23:54:04,232 - INFO - pnl: 2023-08-20T23:59:59.999 119457.60789499938 === -0.157%
2024-12-12 23:54:04,236 - DEBUG - cur time: 2023-08-21T23:59:59.999 == next bar open time: 2023-08-22T00:00:00.000 == close pos time: 2023-08-27T00:00:00.000
2024-12-12 23:54:04,244 - DEBUG - close time 2023-08-21T23:59:59.999 == vol_threshold: 18520196.0
2024-12-12 23:54:04,244 - DEBUG - 2023-08-21T23:59:59.999 == all trade symbol 176 == remain 123 after VOL filter
2024-12-12 23:54:04,244 - DEBUG - sorted_long_factors: shape: (123, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ DUSKUSDT  ┆ -6.051394    ┆ 0    ┆ 122          │
│ RDNTUSDT  ┆ -5.299738    ┆ 1    ┆ 121          │
│ IOTXUSDT  ┆ -3.365291    ┆ 2    ┆ 120          │
│ TLMUSDT   ┆ -3.075962    ┆ 3    ┆ 119          │
│ TRUUSDT   ┆ -2.970115    ┆ 4    ┆ 118          │
│ MINAUSDT  ┆ -2.877476    ┆ 5    ┆ 117          │
│ ARBUSDT   ┆ -2.77191     ┆ 6    ┆ 116          │
│ RNDRUSDT  ┆ -2.756006    ┆ 7    ┆ 115          │
│ REEFUSDT  ┆ -2.486983    ┆ 8    ┆ 114          │
│ OMGUSDT   ┆ -2.422511    ┆ 9    ┆ 113          │
│ …         ┆ …            ┆ …    ┆ …            │
│ SFPUSDT   ┆ 2.434243     ┆ 113  ┆ 9            │
│ ALPHAUSDT ┆ 2.560162     ┆ 114  ┆ 8            │
│ ENJUSDT   ┆ 2.577034     ┆ 115  ┆ 7            │
│ KAVAUSDT  ┆ 2.613228     ┆ 116  ┆ 6            │
│ XEMUSDT   ┆ 3.023621     ┆ 117  ┆ 5            │
│ TOMOUSDT  ┆ 3.377584     ┆ 118  ┆ 4            │
│ RUNEUSDT  ┆ 3.518994     ┆ 119  ┆ 3            │
│ IOSTUSDT  ┆ 4.292395     ┆ 120  ┆ 2            │
│ BLZUSDT   ┆ 4.422379     ┆ 121  ┆ 1            │
│ LINAUSDT  ┆ 5.549893     ┆ 122  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,252 - WARNING - 2023-08-21T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,252 - INFO - cur close time: 2023-08-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:04,252 - DEBUG - mean expected ret (mean factor): 0.1296355153423199
2024-12-12 23:54:04,256 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,256 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,256 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01838     ┆ 0.06528     ┆ 0.0010857   ┆ … ┆ 0.01662 ┆ null   ┆ null    ┆ 0.174   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,263 - DEBUG - update position: 2023-08-21T23:59:59.999 === diff_trading_value: 301251.85305583343 == cash: 122035.56611382923 
2024-12-12 23:54:04,263 - INFO - pnl: 2023-08-21T23:59:59.999 122035.56611382923 === 2.158%
2024-12-12 23:54:04,267 - DEBUG - cur time: 2023-08-22T23:59:59.999 == next bar open time: 2023-08-23T00:00:00.000 == close pos time: 2023-08-28T00:00:00.000
2024-12-12 23:54:04,269 - INFO - pnl: 2023-08-22T23:59:59.999 120371.316719049 === -1.364%
2024-12-12 23:54:04,271 - DEBUG - cur time: 2023-08-23T23:59:59.999 == next bar open time: 2023-08-24T00:00:00.000 == close pos time: 2023-08-29T00:00:00.000
2024-12-12 23:54:04,271 - INFO - pnl: 2023-08-23T23:59:59.999 119911.24063182504 === -0.382%
2024-12-12 23:54:04,275 - DEBUG - cur time: 2023-08-24T23:59:59.999 == next bar open time: 2023-08-25T00:00:00.000 == close pos time: 2023-08-30T00:00:00.000
2024-12-12 23:54:04,275 - INFO - pnl: 2023-08-24T23:59:59.999 118924.84357917838 === -0.823%
2024-12-12 23:54:04,280 - DEBUG - cur time: 2023-08-25T23:59:59.999 == next bar open time: 2023-08-26T00:00:00.000 == close pos time: 2023-08-31T00:00:00.000
2024-12-12 23:54:04,280 - INFO - pnl: 2023-08-25T23:59:59.999 118287.5921477841 === -0.536%
2024-12-12 23:54:04,283 - DEBUG - cur time: 2023-08-26T23:59:59.999 == next bar open time: 2023-08-27T00:00:00.000 == close pos time: 2023-09-01T00:00:00.000
2024-12-12 23:54:04,291 - DEBUG - close time 2023-08-26T23:59:59.999 == vol_threshold: 8982274.0
2024-12-12 23:54:04,291 - DEBUG - 2023-08-26T23:59:59.999 == all trade symbol 176 == remain 123 after VOL filter
2024-12-12 23:54:04,291 - DEBUG - sorted_long_factors: shape: (123, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ IDEXUSDT  ┆ -5.216695    ┆ 0    ┆ 122          │
│ DUSKUSDT  ┆ -4.65287     ┆ 1    ┆ 121          │
│ ALPHAUSDT ┆ -4.531355    ┆ 2    ┆ 120          │
│ STXUSDT   ┆ -4.185655    ┆ 3    ┆ 119          │
│ HFTUSDT   ┆ -3.413971    ┆ 4    ┆ 118          │
│ RNDRUSDT  ┆ -3.031787    ┆ 5    ┆ 117          │
│ ICXUSDT   ┆ -2.979738    ┆ 6    ┆ 116          │
│ LQTYUSDT  ┆ -2.686013    ┆ 7    ┆ 115          │
│ EDUUSDT   ┆ -2.684969    ┆ 8    ┆ 114          │
│ COTIUSDT  ┆ -2.209796    ┆ 9    ┆ 113          │
│ …         ┆ …            ┆ …    ┆ …            │
│ BAKEUSDT  ┆ 2.759293     ┆ 113  ┆ 9            │
│ LPTUSDT   ┆ 2.770639     ┆ 114  ┆ 8            │
│ ROSEUSDT  ┆ 2.990712     ┆ 115  ┆ 7            │
│ FLOWUSDT  ┆ 3.113117     ┆ 116  ┆ 6            │
│ BANDUSDT  ┆ 3.27255      ┆ 117  ┆ 5            │
│ IOTAUSDT  ┆ 3.86945      ┆ 118  ┆ 4            │
│ TUSDT     ┆ 3.932081     ┆ 119  ┆ 3            │
│ LDOUSDT   ┆ 4.464186     ┆ 120  ┆ 2            │
│ TRBUSDT   ┆ 4.466685     ┆ 121  ┆ 1            │
│ ZRXUSDT   ┆ 8.51266      ┆ 122  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,295 - WARNING - 2023-08-26T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,295 - INFO - cur close time: 2023-08-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:04,295 - DEBUG - mean expected ret (mean factor): 0.19924646799997622
2024-12-12 23:54:04,300 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,300 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,304 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01759     ┆ 0.0625      ┆ 0.0008668   ┆ … ┆ 0.01664 ┆ null   ┆ null    ┆ 0.1712  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,309 - DEBUG - update position: 2023-08-26T23:59:59.999 === diff_trading_value: 309078.2299659645 == cash: 118222.90388519423 
2024-12-12 23:54:04,309 - INFO - pnl: 2023-08-26T23:59:59.999 118222.90388519423 === -0.055%
2024-12-12 23:54:04,312 - DEBUG - cur time: 2023-08-27T23:59:59.999 == next bar open time: 2023-08-28T00:00:00.000 == close pos time: 2023-09-02T00:00:00.000
2024-12-12 23:54:04,312 - INFO - pnl: 2023-08-27T23:59:59.999 121094.21551315261 === 2.429%
2024-12-12 23:54:04,316 - DEBUG - cur time: 2023-08-28T23:59:59.999 == next bar open time: 2023-08-29T00:00:00.000 == close pos time: 2023-09-03T00:00:00.000
2024-12-12 23:54:04,316 - INFO - pnl: 2023-08-28T23:59:59.999 120152.70807491674 === -0.777%
2024-12-12 23:54:04,320 - DEBUG - cur time: 2023-08-29T23:59:59.999 == next bar open time: 2023-08-30T00:00:00.000 == close pos time: 2023-09-04T00:00:00.000
2024-12-12 23:54:04,320 - INFO - pnl: 2023-08-29T23:59:59.999 119700.60909155058 === -0.376%
2024-12-12 23:54:04,324 - DEBUG - cur time: 2023-08-30T23:59:59.999 == next bar open time: 2023-08-31T00:00:00.000 == close pos time: 2023-09-05T00:00:00.000
2024-12-12 23:54:04,324 - INFO - pnl: 2023-08-30T23:59:59.999 119642.38344064401 === -0.049%
2024-12-12 23:54:04,328 - DEBUG - cur time: 2023-08-31T23:59:59.999 == next bar open time: 2023-09-01T00:00:00.000 == close pos time: 2023-09-06T00:00:00.000
2024-12-12 23:54:04,334 - DEBUG - close time 2023-08-31T23:59:59.999 == vol_threshold: 25139485.0
2024-12-12 23:54:04,334 - DEBUG - 2023-08-31T23:59:59.999 == all trade symbol 176 == remain 123 after VOL filter
2024-12-12 23:54:04,339 - DEBUG - sorted_long_factors: shape: (123, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ FILUSDT   ┆ -4.07143     ┆ 0    ┆ 122          │
│ ENJUSDT   ┆ -2.979718    ┆ 1    ┆ 121          │
│ DOTUSDT   ┆ -2.794389    ┆ 2    ┆ 120          │
│ HBARUSDT  ┆ -2.699458    ┆ 3    ┆ 119          │
│ TRUUSDT   ┆ -2.646144    ┆ 4    ┆ 118          │
│ RVNUSDT   ┆ -2.602269    ┆ 5    ┆ 117          │
│ ARBUSDT   ┆ -2.53273     ┆ 6    ┆ 116          │
│ ATAUSDT   ┆ -2.520844    ┆ 7    ┆ 115          │
│ ROSEUSDT  ┆ -2.240653    ┆ 8    ┆ 114          │
│ XRPUSDT   ┆ -2.224743    ┆ 9    ┆ 113          │
│ …         ┆ …            ┆ …    ┆ …            │
│ DYDXUSDT  ┆ 2.959781     ┆ 113  ┆ 9            │
│ KLAYUSDT  ┆ 3.123315     ┆ 114  ┆ 8            │
│ CELOUSDT  ┆ 3.166281     ┆ 115  ┆ 7            │
│ DENTUSDT  ┆ 3.389576     ┆ 116  ┆ 6            │
│ RUNEUSDT  ┆ 3.400166     ┆ 117  ┆ 5            │
│ JOEUSDT   ┆ 3.542621     ┆ 118  ┆ 4            │
│ IOSTUSDT  ┆ 3.690771     ┆ 119  ┆ 3            │
│ 1INCHUSDT ┆ 3.781687     ┆ 120  ┆ 2            │
│ UNFIUSDT  ┆ 5.085823     ┆ 121  ┆ 1            │
│ ZRXUSDT   ┆ 5.134769     ┆ 122  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,342 - INFO - cur close time: 2023-08-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:04,342 - DEBUG - mean expected ret (mean factor): 0.2605826275159887
2024-12-12 23:54:04,346 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,346 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,346 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01742     ┆ 0.06186     ┆ 0.0008033   ┆ … ┆ 0.01615 ┆ null   ┆ null    ┆ 0.165   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,351 - DEBUG - update position: 2023-08-31T23:59:59.999 === diff_trading_value: 361441.26537164865 == cash: 119020.83222792282 
2024-12-12 23:54:04,355 - INFO - pnl: 2023-08-31T23:59:59.999 119020.83222792282 === -0.520%
2024-12-12 23:54:04,355 - DEBUG - cur time: 2023-09-01T23:59:59.999 == next bar open time: 2023-09-02T00:00:00.000 == close pos time: 2023-09-07T00:00:00.000
2024-12-12 23:54:04,359 - INFO - pnl: 2023-09-01T23:59:59.999 119185.99500610557 === 0.139%
2024-12-12 23:54:04,360 - DEBUG - cur time: 2023-09-02T23:59:59.999 == next bar open time: 2023-09-03T00:00:00.000 == close pos time: 2023-09-08T00:00:00.000
2024-12-12 23:54:04,363 - INFO - pnl: 2023-09-02T23:59:59.999 119031.0088273674 === -0.130%
2024-12-12 23:54:04,363 - DEBUG - cur time: 2023-09-03T23:59:59.999 == next bar open time: 2023-09-04T00:00:00.000 == close pos time: 2023-09-09T00:00:00.000
2024-12-12 23:54:04,363 - INFO - pnl: 2023-09-03T23:59:59.999 121178.21695269206 === 1.804%
2024-12-12 23:54:04,367 - DEBUG - cur time: 2023-09-04T23:59:59.999 == next bar open time: 2023-09-05T00:00:00.000 == close pos time: 2023-09-10T00:00:00.000
2024-12-12 23:54:04,370 - INFO - pnl: 2023-09-04T23:59:59.999 121310.4171053813 === 0.109%
2024-12-12 23:54:04,371 - DEBUG - cur time: 2023-09-05T23:59:59.999 == next bar open time: 2023-09-06T00:00:00.000 == close pos time: 2023-09-11T00:00:00.000
2024-12-12 23:54:04,379 - DEBUG - close time 2023-09-05T23:59:59.999 == vol_threshold: 17499086.4
2024-12-12 23:54:04,379 - DEBUG - 2023-09-05T23:59:59.999 == all trade symbol 177 == remain 124 after VOL filter
2024-12-12 23:54:04,385 - DEBUG - sorted_long_factors: shape: (124, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ EDUUSDT      ┆ -4.941966    ┆ 0    ┆ 123          │
│ FLOWUSDT     ┆ -3.875467    ┆ 1    ┆ 122          │
│ DUSKUSDT     ┆ -3.683256    ┆ 2    ┆ 121          │
│ IMXUSDT      ┆ -3.211415    ┆ 3    ┆ 120          │
│ RSRUSDT      ┆ -3.094713    ┆ 4    ┆ 119          │
│ 1000LUNCUSDT ┆ -2.735813    ┆ 5    ┆ 118          │
│ KEYUSDT      ┆ -2.565462    ┆ 6    ┆ 117          │
│ RENUSDT      ┆ -2.42199     ┆ 7    ┆ 116          │
│ MINAUSDT     ┆ -2.413853    ┆ 8    ┆ 115          │
│ CHZUSDT      ┆ -2.295138    ┆ 9    ┆ 114          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ZILUSDT      ┆ 3.306967     ┆ 114  ┆ 9            │
│ DARUSDT      ┆ 3.394875     ┆ 115  ┆ 8            │
│ SFPUSDT      ┆ 3.405617     ┆ 116  ┆ 7            │
│ SKLUSDT      ┆ 3.530179     ┆ 117  ┆ 6            │
│ XEMUSDT      ┆ 3.530666     ┆ 118  ┆ 5            │
│ TRBUSDT      ┆ 3.745117     ┆ 119  ┆ 4            │
│ RVNUSDT      ┆ 3.758423     ┆ 120  ┆ 3            │
│ RUNEUSDT     ┆ 4.003832     ┆ 121  ┆ 2            │
│ CELRUSDT     ┆ 4.630422     ┆ 122  ┆ 1            │
│ IOTXUSDT     ┆ 11.487617    ┆ 123  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,390 - INFO - cur close time: 2023-09-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:04,390 - DEBUG - mean expected ret (mean factor): 0.1756531562198373
2024-12-12 23:54:04,392 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,392 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,392 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.017       ┆ 0.06047     ┆ 0.0008029   ┆ … ┆ 0.01645 ┆ null   ┆ null    ┆ 0.1774  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,401 - DEBUG - update position: 2023-09-05T23:59:59.999 === diff_trading_value: 373485.58759915177 == cash: 121359.01378559264 
2024-12-12 23:54:04,401 - INFO - pnl: 2023-09-05T23:59:59.999 121359.01378559264 === 0.040%
2024-12-12 23:54:04,405 - DEBUG - cur time: 2023-09-06T23:59:59.999 == next bar open time: 2023-09-07T00:00:00.000 == close pos time: 2023-09-12T00:00:00.000
2024-12-12 23:54:04,405 - INFO - pnl: 2023-09-06T23:59:59.999 121162.30830725443 === -0.162%
2024-12-12 23:54:04,409 - DEBUG - cur time: 2023-09-07T23:59:59.999 == next bar open time: 2023-09-08T00:00:00.000 == close pos time: 2023-09-13T00:00:00.000
2024-12-12 23:54:04,409 - INFO - pnl: 2023-09-07T23:59:59.999 124652.02413832647 === 2.880%
2024-12-12 23:54:04,414 - DEBUG - cur time: 2023-09-08T23:59:59.999 == next bar open time: 2023-09-09T00:00:00.000 == close pos time: 2023-09-14T00:00:00.000
2024-12-12 23:54:04,416 - INFO - pnl: 2023-09-08T23:59:59.999 123232.17583077293 === -1.139%
2024-12-12 23:54:04,416 - DEBUG - cur time: 2023-09-09T23:59:59.999 == next bar open time: 2023-09-10T00:00:00.000 == close pos time: 2023-09-15T00:00:00.000
2024-12-12 23:54:04,420 - INFO - pnl: 2023-09-09T23:59:59.999 120906.03738080786 === -1.888%
2024-12-12 23:54:04,421 - DEBUG - cur time: 2023-09-10T23:59:59.999 == next bar open time: 2023-09-11T00:00:00.000 == close pos time: 2023-09-16T00:00:00.000
2024-12-12 23:54:04,429 - DEBUG - close time 2023-09-10T23:59:59.999 == vol_threshold: 21706986.64
2024-12-12 23:54:04,429 - DEBUG - 2023-09-10T23:59:59.999 == all trade symbol 179 == remain 125 after VOL filter
2024-12-12 23:54:04,432 - DEBUG - sorted_long_factors: shape: (125, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ CKBUSDT       ┆ -5.087431    ┆ 0    ┆ 124          │
│ 1000FLOKIUSDT ┆ -4.758572    ┆ 1    ┆ 123          │
│ DOGEUSDT      ┆ -3.443131    ┆ 2    ┆ 122          │
│ MDTUSDT       ┆ -3.43683     ┆ 3    ┆ 121          │
│ DARUSDT       ┆ -3.20966     ┆ 4    ┆ 120          │
│ EDUUSDT       ┆ -3.121864    ┆ 5    ┆ 119          │
│ HOOKUSDT      ┆ -2.989211    ┆ 6    ┆ 118          │
│ MAVUSDT       ┆ -2.937238    ┆ 7    ┆ 117          │
│ TRUUSDT       ┆ -2.628825    ┆ 8    ┆ 116          │
│ LUNA2USDT     ┆ -2.476706    ┆ 9    ┆ 115          │
│ …             ┆ …            ┆ …    ┆ …            │
│ BLZUSDT       ┆ 3.108373     ┆ 115  ┆ 9            │
│ CHRUSDT       ┆ 3.135697     ┆ 116  ┆ 8            │
│ FLMUSDT       ┆ 3.494395     ┆ 117  ┆ 7            │
│ PERPUSDT      ┆ 3.636618     ┆ 118  ┆ 6            │
│ TRXUSDT       ┆ 3.660671     ┆ 119  ┆ 5            │
│ OMGUSDT       ┆ 3.693481     ┆ 120  ┆ 4            │
│ SUSHIUSDT     ┆ 4.07075      ┆ 121  ┆ 3            │
│ TRBUSDT       ┆ 4.447414     ┆ 122  ┆ 2            │
│ STORJUSDT     ┆ 5.504134     ┆ 123  ┆ 1            │
│ IDEXUSDT      ┆ 14.761414    ┆ 124  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,436 - INFO - cur close time: 2023-09-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:04,436 - DEBUG - mean expected ret (mean factor): 0.2201653869856037
2024-12-12 23:54:04,440 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,440 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,440 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01674     ┆ 0.05935     ┆ 0.0007069   ┆ … ┆ 0.01576 ┆ null   ┆ null    ┆ 0.1672  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,447 - DEBUG - update position: 2023-09-10T23:59:59.999 === diff_trading_value: 303289.20416553394 == cash: 121696.08113999448 
2024-12-12 23:54:04,447 - INFO - pnl: 2023-09-10T23:59:59.999 121696.08113999448 === 0.653%
2024-12-12 23:54:04,451 - DEBUG - cur time: 2023-09-11T23:59:59.999 == next bar open time: 2023-09-12T00:00:00.000 == close pos time: 2023-09-17T00:00:00.000
2024-12-12 23:54:04,451 - INFO - pnl: 2023-09-11T23:59:59.999 122348.59686604669 === 0.536%
2024-12-12 23:54:04,455 - DEBUG - cur time: 2023-09-12T23:59:59.999 == next bar open time: 2023-09-13T00:00:00.000 == close pos time: 2023-09-18T00:00:00.000
2024-12-12 23:54:04,455 - INFO - pnl: 2023-09-12T23:59:59.999 122267.13237826472 === -0.067%
2024-12-12 23:54:04,459 - DEBUG - cur time: 2023-09-13T23:59:59.999 == next bar open time: 2023-09-14T00:00:00.000 == close pos time: 2023-09-19T00:00:00.000
2024-12-12 23:54:04,459 - INFO - pnl: 2023-09-13T23:59:59.999 124180.88749251058 === 1.565%
2024-12-12 23:54:04,463 - DEBUG - cur time: 2023-09-14T23:59:59.999 == next bar open time: 2023-09-15T00:00:00.000 == close pos time: 2023-09-20T00:00:00.000
2024-12-12 23:54:04,463 - INFO - pnl: 2023-09-14T23:59:59.999 126382.66448093508 === 1.773%
2024-12-12 23:54:04,463 - DEBUG - cur time: 2023-09-15T23:59:59.999 == next bar open time: 2023-09-16T00:00:00.000 == close pos time: 2023-09-21T00:00:00.000
2024-12-12 23:54:04,475 - DEBUG - close time 2023-09-15T23:59:59.999 == vol_threshold: 17463569.19999999
2024-12-12 23:54:04,475 - DEBUG - 2023-09-15T23:59:59.999 == all trade symbol 180 == remain 126 after VOL filter
2024-12-12 23:54:04,475 - DEBUG - sorted_long_factors: shape: (126, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ DARUSDT   ┆ -4.312992    ┆ 0    ┆ 125          │
│ EDUUSDT   ┆ -4.210813    ┆ 1    ┆ 124          │
│ ENJUSDT   ┆ -4.111661    ┆ 2    ┆ 123          │
│ LEVERUSDT ┆ -4.074688    ┆ 3    ┆ 122          │
│ ARPAUSDT  ┆ -3.990901    ┆ 4    ┆ 121          │
│ STGUSDT   ┆ -3.708291    ┆ 5    ┆ 120          │
│ LUNA2USDT ┆ -3.58559     ┆ 6    ┆ 119          │
│ BNXUSDT   ┆ -3.579769    ┆ 7    ┆ 118          │
│ BELUSDT   ┆ -3.424746    ┆ 8    ┆ 117          │
│ LITUSDT   ┆ -3.298847    ┆ 9    ┆ 116          │
│ …         ┆ …            ┆ …    ┆ …            │
│ RUNEUSDT  ┆ 2.941884     ┆ 116  ┆ 9            │
│ OGNUSDT   ┆ 3.125929     ┆ 117  ┆ 8            │
│ BATUSDT   ┆ 3.181698     ┆ 118  ┆ 7            │
│ STORJUSDT ┆ 3.24474      ┆ 119  ┆ 6            │
│ FLMUSDT   ┆ 3.561641     ┆ 120  ┆ 5            │
│ NEARUSDT  ┆ 3.67169      ┆ 121  ┆ 4            │
│ XEMUSDT   ┆ 3.735992     ┆ 122  ┆ 3            │
│ ONEUSDT   ┆ 3.926836     ┆ 123  ┆ 2            │
│ DYDXUSDT  ┆ 4.080911     ┆ 124  ┆ 1            │
│ TRBUSDT   ┆ 4.502741     ┆ 125  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,480 - WARNING - 2023-09-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,480 - INFO - cur close time: 2023-09-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:04,480 - DEBUG - mean expected ret (mean factor): -0.18086309087866156
2024-12-12 23:54:04,484 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,484 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,488 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01612     ┆ 0.05954     ┆ 0.0006838   ┆ … ┆ 0.01665 ┆ null   ┆ null    ┆ 0.1896  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,492 - DEBUG - update position: 2023-09-15T23:59:59.999 === diff_trading_value: 293370.3328780711 == cash: 129725.69293501055 
2024-12-12 23:54:04,492 - INFO - pnl: 2023-09-15T23:59:59.999 129725.69293501055 === 2.645%
2024-12-12 23:54:04,496 - DEBUG - cur time: 2023-09-16T23:59:59.999 == next bar open time: 2023-09-17T00:00:00.000 == close pos time: 2023-09-22T00:00:00.000
2024-12-12 23:54:04,496 - INFO - pnl: 2023-09-16T23:59:59.999 128414.07342335064 === -1.011%
2024-12-12 23:54:04,499 - DEBUG - cur time: 2023-09-17T23:59:59.999 == next bar open time: 2023-09-18T00:00:00.000 == close pos time: 2023-09-23T00:00:00.000
2024-12-12 23:54:04,499 - INFO - pnl: 2023-09-17T23:59:59.999 127829.84320355445 === -0.455%
2024-12-12 23:54:04,503 - DEBUG - cur time: 2023-09-18T23:59:59.999 == next bar open time: 2023-09-19T00:00:00.000 == close pos time: 2023-09-24T00:00:00.000
2024-12-12 23:54:04,503 - INFO - pnl: 2023-09-18T23:59:59.999 127235.46838403927 === -0.465%
2024-12-12 23:54:04,509 - DEBUG - cur time: 2023-09-19T23:59:59.999 == next bar open time: 2023-09-20T00:00:00.000 == close pos time: 2023-09-25T00:00:00.000
2024-12-12 23:54:04,511 - INFO - pnl: 2023-09-19T23:59:59.999 128602.0476213813 === 1.074%
2024-12-12 23:54:04,514 - DEBUG - cur time: 2023-09-20T23:59:59.999 == next bar open time: 2023-09-21T00:00:00.000 == close pos time: 2023-09-26T00:00:00.000
2024-12-12 23:54:04,524 - DEBUG - close time 2023-09-20T23:59:59.999 == vol_threshold: 16208469.209999999
2024-12-12 23:54:04,524 - DEBUG - 2023-09-20T23:59:59.999 == all trade symbol 180 == remain 126 after VOL filter
2024-12-12 23:54:04,524 - DEBUG - sorted_long_factors: shape: (126, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ OGNUSDT     ┆ -3.766199    ┆ 0    ┆ 125          │
│ API3USDT    ┆ -2.591756    ┆ 1    ┆ 124          │
│ ICXUSDT     ┆ -2.406991    ┆ 2    ┆ 123          │
│ LEVERUSDT   ┆ -2.15166     ┆ 3    ┆ 122          │
│ 1000XECUSDT ┆ -2.118164    ┆ 4    ┆ 121          │
│ MANAUSDT    ┆ -1.879034    ┆ 5    ┆ 120          │
│ ALGOUSDT    ┆ -1.668669    ┆ 6    ┆ 119          │
│ CKBUSDT     ┆ -1.606766    ┆ 7    ┆ 118          │
│ CHZUSDT     ┆ -1.539929    ┆ 8    ┆ 117          │
│ XEMUSDT     ┆ -1.47355     ┆ 9    ┆ 116          │
│ …           ┆ …            ┆ …    ┆ …            │
│ SUSHIUSDT   ┆ 1.846099     ┆ 116  ┆ 9            │
│ KLAYUSDT    ┆ 2.057395     ┆ 117  ┆ 8            │
│ IDEXUSDT    ┆ 2.126382     ┆ 118  ┆ 7            │
│ RSRUSDT     ┆ 2.241637     ┆ 119  ┆ 6            │
│ ALPHAUSDT   ┆ 2.381197     ┆ 120  ┆ 5            │
│ MAGICUSDT   ┆ 2.390716     ┆ 121  ┆ 4            │
│ PERPUSDT    ┆ 2.606659     ┆ 122  ┆ 3            │
│ HOOKUSDT    ┆ 2.634212     ┆ 123  ┆ 2            │
│ OMGUSDT     ┆ 2.681613     ┆ 124  ┆ 1            │
│ TRUUSDT     ┆ 2.978378     ┆ 125  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,529 - WARNING - 2023-09-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,532 - INFO - cur close time: 2023-09-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:04,532 - DEBUG - mean expected ret (mean factor): 0.08890634875090979
2024-12-12 23:54:04,536 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,536 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,536 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01581     ┆ 0.05775     ┆ 0.0006283   ┆ … ┆ 0.01659 ┆ null   ┆ null    ┆ 0.1839  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,543 - DEBUG - update position: 2023-09-20T23:59:59.999 === diff_trading_value: 362263.59425529727 == cash: 127692.46879633176 
2024-12-12 23:54:04,543 - INFO - pnl: 2023-09-20T23:59:59.999 127692.46879633176 === -0.707%
2024-12-12 23:54:04,547 - DEBUG - cur time: 2023-09-21T23:59:59.999 == next bar open time: 2023-09-22T00:00:00.000 == close pos time: 2023-09-27T00:00:00.000
2024-12-12 23:54:04,547 - INFO - pnl: 2023-09-21T23:59:59.999 127336.34728795191 === -0.279%
2024-12-12 23:54:04,551 - DEBUG - cur time: 2023-09-22T23:59:59.999 == next bar open time: 2023-09-23T00:00:00.000 == close pos time: 2023-09-28T00:00:00.000
2024-12-12 23:54:04,551 - INFO - pnl: 2023-09-22T23:59:59.999 126727.25740172595 === -0.478%
2024-12-12 23:54:04,555 - DEBUG - cur time: 2023-09-23T23:59:59.999 == next bar open time: 2023-09-24T00:00:00.000 == close pos time: 2023-09-29T00:00:00.000
2024-12-12 23:54:04,555 - INFO - pnl: 2023-09-23T23:59:59.999 126003.54363229427 === -0.571%
2024-12-12 23:54:04,560 - DEBUG - cur time: 2023-09-24T23:59:59.999 == next bar open time: 2023-09-25T00:00:00.000 == close pos time: 2023-09-30T00:00:00.000
2024-12-12 23:54:04,561 - INFO - pnl: 2023-09-24T23:59:59.999 124976.95198051474 === -0.815%
2024-12-12 23:54:04,564 - DEBUG - cur time: 2023-09-25T23:59:59.999 == next bar open time: 2023-09-26T00:00:00.000 == close pos time: 2023-10-01T00:00:00.000
2024-12-12 23:54:04,572 - DEBUG - close time 2023-09-25T23:59:59.999 == vol_threshold: 14307865.719999997
2024-12-12 23:54:04,572 - DEBUG - 2023-09-25T23:59:59.999 == all trade symbol 180 == remain 126 after VOL filter
2024-12-12 23:54:04,572 - DEBUG - sorted_long_factors: shape: (126, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MTLUSDT      ┆ -4.009916    ┆ 0    ┆ 125          │
│ HBARUSDT     ┆ -3.663256    ┆ 1    ┆ 124          │
│ ANKRUSDT     ┆ -3.259583    ┆ 2    ┆ 123          │
│ JASMYUSDT    ┆ -2.900111    ┆ 3    ┆ 122          │
│ LUNA2USDT    ┆ -2.873347    ┆ 4    ┆ 121          │
│ IOTAUSDT     ┆ -2.845472    ┆ 5    ┆ 120          │
│ 1000SHIBUSDT ┆ -2.744341    ┆ 6    ┆ 119          │
│ TRUUSDT      ┆ -2.640763    ┆ 7    ┆ 118          │
│ PHBUSDT      ┆ -2.43043     ┆ 8    ┆ 117          │
│ BLURUSDT     ┆ -2.42962     ┆ 9    ┆ 116          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ASTRUSDT     ┆ 2.218278     ┆ 116  ┆ 9            │
│ KNCUSDT      ┆ 2.248771     ┆ 117  ┆ 8            │
│ RDNTUSDT     ┆ 2.310477     ┆ 118  ┆ 7            │
│ LITUSDT      ┆ 2.40837      ┆ 119  ┆ 6            │
│ TRXUSDT      ┆ 2.73301      ┆ 120  ┆ 5            │
│ ONEUSDT      ┆ 2.77164      ┆ 121  ┆ 4            │
│ AMBUSDT      ┆ 2.820356     ┆ 122  ┆ 3            │
│ VETUSDT      ┆ 3.55182      ┆ 123  ┆ 2            │
│ BATUSDT      ┆ 3.637344     ┆ 124  ┆ 1            │
│ DARUSDT      ┆ 3.666653     ┆ 125  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,581 - WARNING - 2023-09-25T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,581 - INFO - cur close time: 2023-09-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:04,581 - DEBUG - mean expected ret (mean factor): -0.15715237885758016
2024-12-12 23:54:04,585 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,585 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,585 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01575     ┆ 0.06027     ┆ 0.0007104   ┆ … ┆ 0.01689 ┆ null   ┆ null    ┆ 0.1831  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,593 - DEBUG - update position: 2023-09-25T23:59:59.999 === diff_trading_value: 377232.6131800965 == cash: 125998.03070766947 
2024-12-12 23:54:04,593 - INFO - pnl: 2023-09-25T23:59:59.999 125998.03070766947 === 0.817%
2024-12-12 23:54:04,600 - DEBUG - cur time: 2023-09-26T23:59:59.999 == next bar open time: 2023-09-27T00:00:00.000 == close pos time: 2023-10-02T00:00:00.000
2024-12-12 23:54:04,600 - INFO - pnl: 2023-09-26T23:59:59.999 128318.67056020553 === 1.842%
2024-12-12 23:54:04,601 - DEBUG - cur time: 2023-09-27T23:59:59.999 == next bar open time: 2023-09-28T00:00:00.000 == close pos time: 2023-10-03T00:00:00.000
2024-12-12 23:54:04,605 - INFO - pnl: 2023-09-27T23:59:59.999 125071.28851142261 === -2.531%
2024-12-12 23:54:04,610 - DEBUG - cur time: 2023-09-28T23:59:59.999 == next bar open time: 2023-09-29T00:00:00.000 == close pos time: 2023-10-04T00:00:00.000
2024-12-12 23:54:04,610 - INFO - pnl: 2023-09-28T23:59:59.999 126919.1783458516 === 1.477%
2024-12-12 23:54:04,613 - DEBUG - cur time: 2023-09-29T23:59:59.999 == next bar open time: 2023-09-30T00:00:00.000 == close pos time: 2023-10-05T00:00:00.000
2024-12-12 23:54:04,617 - INFO - pnl: 2023-09-29T23:59:59.999 128915.16361112094 === 1.573%
2024-12-12 23:54:04,619 - DEBUG - cur time: 2023-09-30T23:59:59.999 == next bar open time: 2023-10-01T00:00:00.000 == close pos time: 2023-10-06T00:00:00.000
2024-12-12 23:54:04,629 - DEBUG - close time 2023-09-30T23:59:59.999 == vol_threshold: 9790157.029999997
2024-12-12 23:54:04,629 - DEBUG - 2023-09-30T23:59:59.999 == all trade symbol 180 == remain 126 after VOL filter
2024-12-12 23:54:04,633 - DEBUG - sorted_long_factors: shape: (126, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ THETAUSDT   ┆ -4.393561    ┆ 0    ┆ 125          │
│ ATAUSDT     ┆ -3.837163    ┆ 1    ┆ 124          │
│ DUSKUSDT    ┆ -3.403728    ┆ 2    ┆ 123          │
│ IDEXUSDT    ┆ -3.30751     ┆ 3    ┆ 122          │
│ KEYUSDT     ┆ -3.196247    ┆ 4    ┆ 121          │
│ KLAYUSDT    ┆ -3.138097    ┆ 5    ┆ 120          │
│ RDNTUSDT    ┆ -3.045109    ┆ 6    ┆ 119          │
│ COTIUSDT    ┆ -3.033582    ┆ 7    ┆ 118          │
│ MTLUSDT     ┆ -2.887258    ┆ 8    ┆ 117          │
│ HOOKUSDT    ┆ -2.850827    ┆ 9    ┆ 116          │
│ …           ┆ …            ┆ …    ┆ …            │
│ DOGEUSDT    ┆ 2.871704     ┆ 116  ┆ 9            │
│ ROSEUSDT    ┆ 3.098957     ┆ 117  ┆ 8            │
│ RVNUSDT     ┆ 3.844689     ┆ 118  ┆ 7            │
│ TRBUSDT     ┆ 3.860699     ┆ 119  ┆ 6            │
│ DGBUSDT     ┆ 3.891009     ┆ 120  ┆ 5            │
│ RSRUSDT     ┆ 3.97555      ┆ 121  ┆ 4            │
│ 1000XECUSDT ┆ 4.009724     ┆ 122  ┆ 3            │
│ LEVERUSDT   ┆ 4.050627     ┆ 123  ┆ 2            │
│ MATICUSDT   ┆ 5.152367     ┆ 124  ┆ 1            │
│ IOTAUSDT    ┆ 5.92637      ┆ 125  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,640 - WARNING - 2023-09-30T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,640 - INFO - cur close time: 2023-09-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:04,640 - DEBUG - mean expected ret (mean factor): 0.1910395419899729
2024-12-12 23:54:04,642 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,642 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,646 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01845     ┆ 0.06275     ┆ 0.0007981   ┆ … ┆ 0.01776 ┆ null   ┆ null    ┆ 0.1907  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,649 - DEBUG - update position: 2023-09-30T23:59:59.999 === diff_trading_value: 370012.3826669881 == cash: 129422.24179953446 
2024-12-12 23:54:04,654 - INFO - pnl: 2023-09-30T23:59:59.999 129422.24179953446 === 0.393%
2024-12-12 23:54:04,660 - DEBUG - cur time: 2023-10-01T23:59:59.999 == next bar open time: 2023-10-02T00:00:00.000 == close pos time: 2023-10-07T00:00:00.000
2024-12-12 23:54:04,660 - INFO - pnl: 2023-10-01T23:59:59.999 129046.38403108393 === -0.290%
2024-12-12 23:54:04,664 - DEBUG - cur time: 2023-10-02T23:59:59.999 == next bar open time: 2023-10-03T00:00:00.000 == close pos time: 2023-10-08T00:00:00.000
2024-12-12 23:54:04,664 - INFO - pnl: 2023-10-02T23:59:59.999 130906.36600726903 === 1.441%
2024-12-12 23:54:04,668 - DEBUG - cur time: 2023-10-03T23:59:59.999 == next bar open time: 2023-10-04T00:00:00.000 == close pos time: 2023-10-09T00:00:00.000
2024-12-12 23:54:04,670 - INFO - pnl: 2023-10-03T23:59:59.999 129792.40307353444 === -0.851%
2024-12-12 23:54:04,672 - DEBUG - cur time: 2023-10-04T23:59:59.999 == next bar open time: 2023-10-05T00:00:00.000 == close pos time: 2023-10-10T00:00:00.000
2024-12-12 23:54:04,672 - INFO - pnl: 2023-10-04T23:59:59.999 127869.63111306813 === -1.481%
2024-12-12 23:54:04,676 - DEBUG - cur time: 2023-10-05T23:59:59.999 == next bar open time: 2023-10-06T00:00:00.000 == close pos time: 2023-10-11T00:00:00.000
2024-12-12 23:54:04,685 - DEBUG - close time 2023-10-05T23:59:59.999 == vol_threshold: 12990021.0
2024-12-12 23:54:04,688 - DEBUG - 2023-10-05T23:59:59.999 == all trade symbol 181 == remain 126 after VOL filter
2024-12-12 23:54:04,688 - DEBUG - sorted_long_factors: shape: (126, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ KLAYUSDT  ┆ -3.493922    ┆ 0    ┆ 125          │
│ MTLUSDT   ┆ -3.452367    ┆ 1    ┆ 124          │
│ ARPAUSDT  ┆ -3.433094    ┆ 2    ┆ 123          │
│ RDNTUSDT  ┆ -3.366773    ┆ 3    ┆ 122          │
│ XRPUSDT   ┆ -3.291029    ┆ 4    ┆ 121          │
│ LDOUSDT   ┆ -3.183483    ┆ 5    ┆ 120          │
│ MDTUSDT   ┆ -3.161128    ┆ 6    ┆ 119          │
│ ASTRUSDT  ┆ -3.011143    ┆ 7    ┆ 118          │
│ KEYUSDT   ┆ -2.748566    ┆ 8    ┆ 117          │
│ IOTXUSDT  ┆ -2.738972    ┆ 9    ┆ 116          │
│ …         ┆ …            ┆ …    ┆ …            │
│ EOSUSDT   ┆ 3.175635     ┆ 116  ┆ 9            │
│ ICXUSDT   ┆ 3.23086      ┆ 117  ┆ 8            │
│ LQTYUSDT  ┆ 3.270574     ┆ 118  ┆ 7            │
│ COTIUSDT  ┆ 3.452056     ┆ 119  ┆ 6            │
│ CHRUSDT   ┆ 3.574612     ┆ 120  ┆ 5            │
│ BLZUSDT   ┆ 3.852715     ┆ 121  ┆ 4            │
│ ZILUSDT   ┆ 3.854016     ┆ 122  ┆ 3            │
│ STORJUSDT ┆ 3.890707     ┆ 123  ┆ 2            │
│ FLOWUSDT  ┆ 4.815611     ┆ 124  ┆ 1            │
│ HBARUSDT  ┆ 5.269469     ┆ 125  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,696 - WARNING - 2023-10-05T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,696 - INFO - cur close time: 2023-10-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:04,696 - DEBUG - mean expected ret (mean factor): 0.07596137645870168
2024-12-12 23:54:04,701 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,701 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,702 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0181      ┆ 0.05762     ┆ 0.000701    ┆ … ┆ 0.01648 ┆ null   ┆ null    ┆ 0.1811  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,708 - DEBUG - update position: 2023-10-05T23:59:59.999 === diff_trading_value: 284316.71806418773 == cash: 128404.67550843902 
2024-12-12 23:54:04,709 - INFO - pnl: 2023-10-05T23:59:59.999 128404.67550843902 === 0.418%
2024-12-12 23:54:04,713 - DEBUG - cur time: 2023-10-06T23:59:59.999 == next bar open time: 2023-10-07T00:00:00.000 == close pos time: 2023-10-12T00:00:00.000
2024-12-12 23:54:04,713 - INFO - pnl: 2023-10-06T23:59:59.999 128704.07515768408 === 0.233%
2024-12-12 23:54:04,717 - DEBUG - cur time: 2023-10-07T23:59:59.999 == next bar open time: 2023-10-08T00:00:00.000 == close pos time: 2023-10-13T00:00:00.000
2024-12-12 23:54:04,717 - INFO - pnl: 2023-10-07T23:59:59.999 129181.24302106444 === 0.371%
2024-12-12 23:54:04,720 - DEBUG - cur time: 2023-10-08T23:59:59.999 == next bar open time: 2023-10-09T00:00:00.000 == close pos time: 2023-10-14T00:00:00.000
2024-12-12 23:54:04,721 - INFO - pnl: 2023-10-08T23:59:59.999 129089.337531742 === -0.071%
2024-12-12 23:54:04,725 - DEBUG - cur time: 2023-10-09T23:59:59.999 == next bar open time: 2023-10-10T00:00:00.000 == close pos time: 2023-10-15T00:00:00.000
2024-12-12 23:54:04,725 - INFO - pnl: 2023-10-09T23:59:59.999 130992.69331530758 === 1.474%
2024-12-12 23:54:04,730 - DEBUG - cur time: 2023-10-10T23:59:59.999 == next bar open time: 2023-10-11T00:00:00.000 == close pos time: 2023-10-16T00:00:00.000
2024-12-12 23:54:04,740 - DEBUG - close time 2023-10-10T23:59:59.999 == vol_threshold: 13887689.04
2024-12-12 23:54:04,740 - DEBUG - 2023-10-10T23:59:59.999 == all trade symbol 184 == remain 129 after VOL filter
2024-12-12 23:54:04,743 - DEBUG - sorted_long_factors: shape: (129, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ MDTUSDT    ┆ -2.805402    ┆ 0    ┆ 128          │
│ XRPUSDT    ┆ -2.492396    ┆ 1    ┆ 127          │
│ AMBUSDT    ┆ -2.481229    ┆ 2    ┆ 126          │
│ PERPUSDT   ┆ -2.402009    ┆ 3    ┆ 125          │
│ DYDXUSDT   ┆ -2.345607    ┆ 4    ┆ 124          │
│ SUIUSDT    ┆ -2.01262     ┆ 5    ┆ 123          │
│ DGBUSDT    ┆ -1.959664    ┆ 6    ┆ 122          │
│ ALPHAUSDT  ┆ -1.651693    ┆ 7    ┆ 121          │
│ CTSIUSDT   ┆ -1.604986    ┆ 8    ┆ 120          │
│ SPELLUSDT  ┆ -1.431733    ┆ 9    ┆ 119          │
│ …          ┆ …            ┆ …    ┆ …            │
│ RDNTUSDT   ┆ 1.363334     ┆ 119  ┆ 9            │
│ RVNUSDT    ┆ 1.383171     ┆ 120  ┆ 8            │
│ 1INCHUSDT  ┆ 1.47453      ┆ 121  ┆ 7            │
│ CELOUSDT   ┆ 1.57336      ┆ 122  ┆ 6            │
│ SFPUSDT    ┆ 1.650665     ┆ 123  ┆ 5            │
│ GMTUSDT    ┆ 2.025014     ┆ 124  ┆ 4            │
│ LQTYUSDT   ┆ 2.036668     ┆ 125  ┆ 3            │
│ DARUSDT    ┆ 2.123339     ┆ 126  ┆ 2            │
│ PEOPLEUSDT ┆ 2.327336     ┆ 127  ┆ 1            │
│ BLZUSDT    ┆ 2.379166     ┆ 128  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,751 - WARNING - 2023-10-10T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,751 - INFO - cur close time: 2023-10-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:04,751 - DEBUG - mean expected ret (mean factor): -0.13645846907532072
2024-12-12 23:54:04,755 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,755 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,755 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01721     ┆ 0.05758     ┆ 0.0006452   ┆ … ┆ 0.01601 ┆ null   ┆ null    ┆ 0.1911  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,760 - DEBUG - update position: 2023-10-10T23:59:59.999 === diff_trading_value: 311033.76233137224 == cash: 129142.1563864715 
2024-12-12 23:54:04,760 - INFO - pnl: 2023-10-10T23:59:59.999 129142.1563864715 === -1.413%
2024-12-12 23:54:04,763 - DEBUG - cur time: 2023-10-11T23:59:59.999 == next bar open time: 2023-10-12T00:00:00.000 == close pos time: 2023-10-17T00:00:00.000
2024-12-12 23:54:04,767 - INFO - pnl: 2023-10-11T23:59:59.999 129898.23786166674 === 0.585%
2024-12-12 23:54:04,770 - DEBUG - cur time: 2023-10-12T23:59:59.999 == next bar open time: 2023-10-13T00:00:00.000 == close pos time: 2023-10-18T00:00:00.000
2024-12-12 23:54:04,771 - INFO - pnl: 2023-10-12T23:59:59.999 129536.12446133749 === -0.279%
2024-12-12 23:54:04,771 - DEBUG - cur time: 2023-10-13T23:59:59.999 == next bar open time: 2023-10-14T00:00:00.000 == close pos time: 2023-10-19T00:00:00.000
2024-12-12 23:54:04,775 - INFO - pnl: 2023-10-13T23:59:59.999 128381.66287719777 === -0.891%
2024-12-12 23:54:04,779 - DEBUG - cur time: 2023-10-14T23:59:59.999 == next bar open time: 2023-10-15T00:00:00.000 == close pos time: 2023-10-20T00:00:00.000
2024-12-12 23:54:04,779 - INFO - pnl: 2023-10-14T23:59:59.999 128737.25493408181 === 0.277%
2024-12-12 23:54:04,783 - DEBUG - cur time: 2023-10-15T23:59:59.999 == next bar open time: 2023-10-16T00:00:00.000 == close pos time: 2023-10-21T00:00:00.000
2024-12-12 23:54:04,792 - DEBUG - close time 2023-10-15T23:59:59.999 == vol_threshold: 13268177.379999999
2024-12-12 23:54:04,792 - DEBUG - 2023-10-15T23:59:59.999 == all trade symbol 185 == remain 129 after VOL filter
2024-12-12 23:54:04,792 - DEBUG - sorted_long_factors: shape: (129, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ HFTUSDT  ┆ -4.902586    ┆ 0    ┆ 128          │
│ ARKMUSDT ┆ -4.717006    ┆ 1    ┆ 127          │
│ RDNTUSDT ┆ -4.565493    ┆ 2    ┆ 126          │
│ JOEUSDT  ┆ -4.129548    ┆ 3    ┆ 125          │
│ MAVUSDT  ┆ -4.124512    ┆ 4    ┆ 124          │
│ IOTXUSDT ┆ -4.114997    ┆ 5    ┆ 123          │
│ EDUUSDT  ┆ -3.66975     ┆ 6    ┆ 122          │
│ COTIUSDT ┆ -3.571659    ┆ 7    ┆ 121          │
│ XTZUSDT  ┆ -3.030287    ┆ 8    ┆ 120          │
│ ACHUSDT  ┆ -2.890587    ┆ 9    ┆ 119          │
│ …        ┆ …            ┆ …    ┆ …            │
│ CRVUSDT  ┆ 2.887935     ┆ 119  ┆ 9            │
│ EOSUSDT  ┆ 2.907763     ┆ 120  ┆ 8            │
│ CHRUSDT  ┆ 3.211027     ┆ 121  ┆ 7            │
│ TRBUSDT  ┆ 3.602653     ┆ 122  ┆ 6            │
│ ZILUSDT  ┆ 3.869215     ┆ 123  ┆ 5            │
│ XEMUSDT  ┆ 4.006602     ┆ 124  ┆ 4            │
│ TOMOUSDT ┆ 4.048429     ┆ 125  ┆ 3            │
│ LQTYUSDT ┆ 5.001448     ┆ 126  ┆ 2            │
│ TRXUSDT  ┆ 5.418281     ┆ 127  ┆ 1            │
│ FLOWUSDT ┆ 5.868156     ┆ 128  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,799 - WARNING - 2023-10-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,799 - INFO - cur close time: 2023-10-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:04,799 - DEBUG - mean expected ret (mean factor): -0.06971215579538825
2024-12-12 23:54:04,804 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,804 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,804 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01807     ┆ 0.05744     ┆ 0.0006655   ┆ … ┆ 0.01653 ┆ null   ┆ null    ┆ 0.2173  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,810 - DEBUG - update position: 2023-10-15T23:59:59.999 === diff_trading_value: 361226.11405898153 == cash: 129630.73511744858 
2024-12-12 23:54:04,810 - INFO - pnl: 2023-10-15T23:59:59.999 129630.73511744858 === 0.694%
2024-12-12 23:54:04,812 - DEBUG - cur time: 2023-10-16T23:59:59.999 == next bar open time: 2023-10-17T00:00:00.000 == close pos time: 2023-10-22T00:00:00.000
2024-12-12 23:54:04,812 - INFO - pnl: 2023-10-16T23:59:59.999 129974.48910451305 === 0.265%
2024-12-12 23:54:04,816 - DEBUG - cur time: 2023-10-17T23:59:59.999 == next bar open time: 2023-10-18T00:00:00.000 == close pos time: 2023-10-23T00:00:00.000
2024-12-12 23:54:04,820 - INFO - pnl: 2023-10-17T23:59:59.999 132451.65587614922 === 1.906%
2024-12-12 23:54:04,822 - DEBUG - cur time: 2023-10-18T23:59:59.999 == next bar open time: 2023-10-19T00:00:00.000 == close pos time: 2023-10-24T00:00:00.000
2024-12-12 23:54:04,822 - INFO - pnl: 2023-10-18T23:59:59.999 135367.13317331974 === 2.201%
2024-12-12 23:54:04,826 - DEBUG - cur time: 2023-10-19T23:59:59.999 == next bar open time: 2023-10-20T00:00:00.000 == close pos time: 2023-10-25T00:00:00.000
2024-12-12 23:54:04,826 - INFO - pnl: 2023-10-19T23:59:59.999 135780.72488386784 === 0.306%
2024-12-12 23:54:04,832 - DEBUG - cur time: 2023-10-20T23:59:59.999 == next bar open time: 2023-10-21T00:00:00.000 == close pos time: 2023-10-26T00:00:00.000
2024-12-12 23:54:04,841 - DEBUG - close time 2023-10-20T23:59:59.999 == vol_threshold: 15000098.48
2024-12-12 23:54:04,841 - DEBUG - 2023-10-20T23:59:59.999 == all trade symbol 187 == remain 131 after VOL filter
2024-12-12 23:54:04,845 - DEBUG - sorted_long_factors: shape: (131, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT   ┆ -2.880369    ┆ 0    ┆ 130          │
│ COTIUSDT  ┆ -2.222582    ┆ 1    ┆ 129          │
│ DODOXUSDT ┆ -2.087226    ┆ 2    ┆ 128          │
│ OCEANUSDT ┆ -1.935316    ┆ 3    ┆ 127          │
│ BNXUSDT   ┆ -1.768021    ┆ 4    ┆ 126          │
│ AMBUSDT   ┆ -1.58744     ┆ 5    ┆ 125          │
│ IOTAUSDT  ┆ -1.427309    ┆ 6    ┆ 124          │
│ ARKMUSDT  ┆ -1.372035    ┆ 7    ┆ 123          │
│ WLDUSDT   ┆ -1.369519    ┆ 8    ┆ 122          │
│ SPELLUSDT ┆ -1.358886    ┆ 9    ┆ 121          │
│ …         ┆ …            ┆ …    ┆ …            │
│ TRXUSDT   ┆ 1.418151     ┆ 121  ┆ 9            │
│ RSRUSDT   ┆ 1.425565     ┆ 122  ┆ 8            │
│ LQTYUSDT  ┆ 1.452132     ┆ 123  ┆ 7            │
│ ONEUSDT   ┆ 1.518552     ┆ 124  ┆ 6            │
│ RNDRUSDT  ┆ 1.543829     ┆ 125  ┆ 5            │
│ FLMUSDT   ┆ 1.648759     ┆ 126  ┆ 4            │
│ BLZUSDT   ┆ 2.167816     ┆ 127  ┆ 3            │
│ HOTUSDT   ┆ 2.34206      ┆ 128  ┆ 2            │
│ ICXUSDT   ┆ 2.381157     ┆ 129  ┆ 1            │
│ IDEXUSDT  ┆ 3.218227     ┆ 130  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,850 - INFO - cur close time: 2023-10-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:04,850 - DEBUG - mean expected ret (mean factor): -0.056223178413520584
2024-12-12 23:54:04,854 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,854 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,854 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02008     ┆ 0.05666     ┆ 0.0006563   ┆ … ┆ 0.017   ┆ null   ┆ null    ┆ 0.2151  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,860 - DEBUG - update position: 2023-10-20T23:59:59.999 === diff_trading_value: 307704.0537337386 == cash: 135886.1442872598 
2024-12-12 23:54:04,860 - INFO - pnl: 2023-10-20T23:59:59.999 135886.1442872598 === 0.078%
2024-12-12 23:54:04,862 - DEBUG - cur time: 2023-10-21T23:59:59.999 == next bar open time: 2023-10-22T00:00:00.000 == close pos time: 2023-10-27T00:00:00.000
2024-12-12 23:54:04,866 - INFO - pnl: 2023-10-21T23:59:59.999 137039.30127189375 === 0.849%
2024-12-12 23:54:04,866 - DEBUG - cur time: 2023-10-22T23:59:59.999 == next bar open time: 2023-10-23T00:00:00.000 == close pos time: 2023-10-28T00:00:00.000
2024-12-12 23:54:04,869 - INFO - pnl: 2023-10-22T23:59:59.999 135637.50504673264 === -1.023%
2024-12-12 23:54:04,870 - DEBUG - cur time: 2023-10-23T23:59:59.999 == next bar open time: 2023-10-24T00:00:00.000 == close pos time: 2023-10-29T00:00:00.000
2024-12-12 23:54:04,874 - INFO - pnl: 2023-10-23T23:59:59.999 138464.9893865532 === 2.085%
2024-12-12 23:54:04,878 - DEBUG - cur time: 2023-10-24T23:59:59.999 == next bar open time: 2023-10-25T00:00:00.000 == close pos time: 2023-10-30T00:00:00.000
2024-12-12 23:54:04,880 - INFO - pnl: 2023-10-24T23:59:59.999 142473.76777432888 === 2.895%
2024-12-12 23:54:04,883 - DEBUG - cur time: 2023-10-25T23:59:59.999 == next bar open time: 2023-10-26T00:00:00.000 == close pos time: 2023-10-31T00:00:00.000
2024-12-12 23:54:04,891 - DEBUG - close time 2023-10-25T23:59:59.999 == vol_threshold: 30676408.980000004
2024-12-12 23:54:04,891 - DEBUG - 2023-10-25T23:59:59.999 == all trade symbol 188 == remain 131 after VOL filter
2024-12-12 23:54:04,891 - DEBUG - sorted_long_factors: shape: (131, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ CKBUSDT       ┆ -4.656317    ┆ 0    ┆ 130          │
│ ASTRUSDT      ┆ -3.756665    ┆ 1    ┆ 129          │
│ XRPUSDT       ┆ -3.534585    ┆ 2    ┆ 128          │
│ SUIUSDT       ┆ -3.143927    ┆ 3    ┆ 127          │
│ RDNTUSDT      ┆ -3.037947    ┆ 4    ┆ 126          │
│ KEYUSDT       ┆ -2.976185    ┆ 5    ┆ 125          │
│ NKNUSDT       ┆ -2.743556    ┆ 6    ┆ 124          │
│ ALPHAUSDT     ┆ -2.562915    ┆ 7    ┆ 123          │
│ ARBUSDT       ┆ -2.300721    ┆ 8    ┆ 122          │
│ COTIUSDT      ┆ -2.273972    ┆ 9    ┆ 121          │
│ …             ┆ …            ┆ …    ┆ …            │
│ APTUSDT       ┆ 1.981513     ┆ 121  ┆ 9            │
│ AGLDUSDT      ┆ 2.057036     ┆ 122  ┆ 8            │
│ XEMUSDT       ┆ 2.142295     ┆ 123  ┆ 7            │
│ BLZUSDT       ┆ 2.685045     ┆ 124  ┆ 6            │
│ 1000FLOKIUSDT ┆ 2.697674     ┆ 125  ┆ 5            │
│ MINAUSDT      ┆ 2.706396     ┆ 126  ┆ 4            │
│ KLAYUSDT      ┆ 2.874068     ┆ 127  ┆ 3            │
│ BATUSDT       ┆ 3.308634     ┆ 128  ┆ 2            │
│ LQTYUSDT      ┆ 5.000278     ┆ 129  ┆ 1            │
│ OXTUSDT       ┆ 5.069592     ┆ 130  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,900 - WARNING - 2023-10-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,900 - INFO - cur close time: 2023-10-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:04,900 - DEBUG - mean expected ret (mean factor): 0.1302083388830746
2024-12-12 23:54:04,904 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,904 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,904 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03033     ┆ 0.06509     ┆ 0.0012077   ┆ … ┆ 0.01872 ┆ null   ┆ null    ┆ 0.2509  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,912 - DEBUG - update position: 2023-10-25T23:59:59.999 === diff_trading_value: 333208.8282252176 == cash: 142583.41414993556 
2024-12-12 23:54:04,913 - INFO - pnl: 2023-10-25T23:59:59.999 142583.41414993556 === 0.077%
2024-12-12 23:54:04,913 - DEBUG - cur time: 2023-10-26T23:59:59.999 == next bar open time: 2023-10-27T00:00:00.000 == close pos time: 2023-11-01T00:00:00.000
2024-12-12 23:54:04,918 - INFO - pnl: 2023-10-26T23:59:59.999 141887.0463601224 === -0.488%
2024-12-12 23:54:04,921 - DEBUG - cur time: 2023-10-27T23:59:59.999 == next bar open time: 2023-10-28T00:00:00.000 == close pos time: 2023-11-02T00:00:00.000
2024-12-12 23:54:04,921 - INFO - pnl: 2023-10-27T23:59:59.999 140982.23621637456 === -0.638%
2024-12-12 23:54:04,922 - DEBUG - cur time: 2023-10-28T23:59:59.999 == next bar open time: 2023-10-29T00:00:00.000 == close pos time: 2023-11-03T00:00:00.000
2024-12-12 23:54:04,926 - INFO - pnl: 2023-10-28T23:59:59.999 140227.23864783722 === -0.536%
2024-12-12 23:54:04,926 - DEBUG - cur time: 2023-10-29T23:59:59.999 == next bar open time: 2023-10-30T00:00:00.000 == close pos time: 2023-11-04T00:00:00.000
2024-12-12 23:54:04,930 - INFO - pnl: 2023-10-29T23:59:59.999 140424.11076300172 === 0.140%
2024-12-12 23:54:04,935 - DEBUG - cur time: 2023-10-30T23:59:59.999 == next bar open time: 2023-10-31T00:00:00.000 == close pos time: 2023-11-05T00:00:00.000
2024-12-12 23:54:04,946 - DEBUG - close time 2023-10-30T23:59:59.999 == vol_threshold: 24003218.38
2024-12-12 23:54:04,946 - DEBUG - 2023-10-30T23:59:59.999 == all trade symbol 189 == remain 132 after VOL filter
2024-12-12 23:54:04,946 - DEBUG - sorted_long_factors: shape: (132, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT      ┆ -2.556695    ┆ 0    ┆ 131          │
│ DOGEUSDT     ┆ -1.845518    ┆ 1    ┆ 130          │
│ ARBUSDT      ┆ -1.392039    ┆ 2    ┆ 129          │
│ MAVUSDT      ┆ -1.29679     ┆ 3    ┆ 128          │
│ SUIUSDT      ┆ -1.226522    ┆ 4    ┆ 127          │
│ EDUUSDT      ┆ -1.149659    ┆ 5    ┆ 126          │
│ BNXUSDT      ┆ -1.04885     ┆ 6    ┆ 125          │
│ BNTUSDT      ┆ -1.032229    ┆ 7    ┆ 124          │
│ ARKMUSDT     ┆ -1.02591     ┆ 8    ┆ 123          │
│ 1000PEPEUSDT ┆ -1.002987    ┆ 9    ┆ 122          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IDEXUSDT     ┆ 0.672096     ┆ 122  ┆ 9            │
│ ONEUSDT      ┆ 0.694022     ┆ 123  ┆ 8            │
│ CELOUSDT     ┆ 0.719754     ┆ 124  ┆ 7            │
│ NEARUSDT     ┆ 0.732272     ┆ 125  ┆ 6            │
│ CTSIUSDT     ┆ 0.764623     ┆ 126  ┆ 5            │
│ XTZUSDT      ┆ 0.794118     ┆ 127  ┆ 4            │
│ EOSUSDT      ┆ 0.799495     ┆ 128  ┆ 3            │
│ ATAUSDT      ┆ 0.806003     ┆ 129  ┆ 2            │
│ BLZUSDT      ┆ 1.161927     ┆ 130  ┆ 1            │
│ RUNEUSDT     ┆ 1.362569     ┆ 131  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:04,960 - WARNING - 2023-10-30T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:04,960 - INFO - cur close time: 2023-10-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:04,960 - DEBUG - mean expected ret (mean factor): -0.22108203251701622
2024-12-12 23:54:04,962 - DEBUG - begin to update pos: =========
2024-12-12 23:54:04,962 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,962 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03597     ┆ 0.06531     ┆ 0.0011725   ┆ … ┆ 0.01934 ┆ null   ┆ null    ┆ 0.2658  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:04,971 - DEBUG - update position: 2023-10-30T23:59:59.999 === diff_trading_value: 317762.8593218965 == cash: 140912.79422819888 
2024-12-12 23:54:04,971 - INFO - pnl: 2023-10-30T23:59:59.999 140912.79422819888 === 0.348%
2024-12-12 23:54:04,976 - DEBUG - cur time: 2023-10-31T23:59:59.999 == next bar open time: 2023-11-01T00:00:00.000 == close pos time: 2023-11-06T00:00:00.000
2024-12-12 23:54:04,976 - INFO - pnl: 2023-10-31T23:59:59.999 142998.6852056994 === 1.480%
2024-12-12 23:54:04,980 - DEBUG - cur time: 2023-11-01T23:59:59.999 == next bar open time: 2023-11-02T00:00:00.000 == close pos time: 2023-11-07T00:00:00.000
2024-12-12 23:54:04,980 - INFO - pnl: 2023-11-01T23:59:59.999 145246.79851064153 === 1.572%
2024-12-12 23:54:04,988 - DEBUG - cur time: 2023-11-02T23:59:59.999 == next bar open time: 2023-11-03T00:00:00.000 == close pos time: 2023-11-08T00:00:00.000
2024-12-12 23:54:04,990 - INFO - pnl: 2023-11-02T23:59:59.999 148130.25796814577 === 1.985%
2024-12-12 23:54:04,992 - DEBUG - cur time: 2023-11-03T23:59:59.999 == next bar open time: 2023-11-04T00:00:00.000 == close pos time: 2023-11-09T00:00:00.000
2024-12-12 23:54:04,992 - INFO - pnl: 2023-11-03T23:59:59.999 148986.6542590378 === 0.578%
2024-12-12 23:54:04,997 - DEBUG - cur time: 2023-11-04T23:59:59.999 == next bar open time: 2023-11-05T00:00:00.000 == close pos time: 2023-11-10T00:00:00.000
2024-12-12 23:54:05,009 - DEBUG - close time 2023-11-04T23:59:59.999 == vol_threshold: 15060777.35
2024-12-12 23:54:05,010 - DEBUG - 2023-11-04T23:59:59.999 == all trade symbol 190 == remain 133 after VOL filter
2024-12-12 23:54:05,010 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ ARPAUSDT ┆ -5.301489    ┆ 0    ┆ 132          │
│ CKBUSDT  ┆ -4.455469    ┆ 1    ┆ 131          │
│ EDUUSDT  ┆ -3.902828    ┆ 2    ┆ 130          │
│ XRPUSDT  ┆ -3.637914    ┆ 3    ┆ 129          │
│ BNXUSDT  ┆ -3.178129    ┆ 4    ┆ 128          │
│ C98USDT  ┆ -3.138332    ┆ 5    ┆ 127          │
│ LRCUSDT  ┆ -3.127851    ┆ 6    ┆ 126          │
│ HFTUSDT  ┆ -3.037107    ┆ 7    ┆ 125          │
│ OXTUSDT  ┆ -2.847979    ┆ 8    ┆ 124          │
│ KEYUSDT  ┆ -2.747742    ┆ 9    ┆ 123          │
│ …        ┆ …            ┆ …    ┆ …            │
│ SXPUSDT  ┆ 2.919574     ┆ 123  ┆ 9            │
│ NEOUSDT  ┆ 2.921137     ┆ 124  ┆ 8            │
│ BATUSDT  ┆ 3.266019     ┆ 125  ┆ 7            │
│ TRXUSDT  ┆ 3.35742      ┆ 126  ┆ 6            │
│ FLOWUSDT ┆ 3.435555     ┆ 127  ┆ 5            │
│ STMXUSDT ┆ 3.443261     ┆ 128  ┆ 4            │
│ ONEUSDT  ┆ 3.482563     ┆ 129  ┆ 3            │
│ XEMUSDT  ┆ 3.721121     ┆ 130  ┆ 2            │
│ ARKMUSDT ┆ 4.396068     ┆ 131  ┆ 1            │
│ DENTUSDT ┆ 4.777064     ┆ 132  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,018 - WARNING - 2023-11-04T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:05,018 - INFO - cur close time: 2023-11-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:05,018 - DEBUG - mean expected ret (mean factor): 0.018497207422580698
2024-12-12 23:54:05,022 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,022 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,022 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03164     ┆ 0.06492     ┆ 0.0011171   ┆ … ┆ 0.02023 ┆ null   ┆ null    ┆ 0.2768  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,027 - DEBUG - update position: 2023-11-04T23:59:59.999 === diff_trading_value: 289935.78595026734 == cash: 148239.85228038396 
2024-12-12 23:54:05,030 - INFO - pnl: 2023-11-04T23:59:59.999 148239.85228038396 === -0.501%
2024-12-12 23:54:05,034 - DEBUG - cur time: 2023-11-05T23:59:59.999 == next bar open time: 2023-11-06T00:00:00.000 == close pos time: 2023-11-11T00:00:00.000
2024-12-12 23:54:05,034 - INFO - pnl: 2023-11-05T23:59:59.999 148489.7534578344 === 0.169%
2024-12-12 23:54:05,038 - DEBUG - cur time: 2023-11-06T23:59:59.999 == next bar open time: 2023-11-07T00:00:00.000 == close pos time: 2023-11-12T00:00:00.000
2024-12-12 23:54:05,040 - INFO - pnl: 2023-11-06T23:59:59.999 145076.77288633853 === -2.298%
2024-12-12 23:54:05,042 - DEBUG - cur time: 2023-11-07T23:59:59.999 == next bar open time: 2023-11-08T00:00:00.000 == close pos time: 2023-11-13T00:00:00.000
2024-12-12 23:54:05,042 - INFO - pnl: 2023-11-07T23:59:59.999 144630.6466607319 === -0.308%
2024-12-12 23:54:05,051 - DEBUG - cur time: 2023-11-08T23:59:59.999 == next bar open time: 2023-11-09T00:00:00.000 == close pos time: 2023-11-14T00:00:00.000
2024-12-12 23:54:05,051 - INFO - pnl: 2023-11-08T23:59:59.999 147297.20817823792 === 1.844%
2024-12-12 23:54:05,056 - DEBUG - cur time: 2023-11-09T23:59:59.999 == next bar open time: 2023-11-10T00:00:00.000 == close pos time: 2023-11-15T00:00:00.000
2024-12-12 23:54:05,070 - DEBUG - close time 2023-11-09T23:59:59.999 == vol_threshold: 42929930.94
2024-12-12 23:54:05,070 - DEBUG - 2023-11-09T23:59:59.999 == all trade symbol 189 == remain 132 after VOL filter
2024-12-12 23:54:05,072 - DEBUG - sorted_long_factors: shape: (132, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ AMBUSDT   ┆ -4.136605    ┆ 0    ┆ 131          │
│ XRPUSDT   ┆ -3.445496    ┆ 1    ┆ 130          │
│ DARUSDT   ┆ -3.265661    ┆ 2    ┆ 129          │
│ RENUSDT   ┆ -3.239328    ┆ 3    ┆ 128          │
│ MDTUSDT   ┆ -3.18138     ┆ 4    ┆ 127          │
│ RNDRUSDT  ┆ -2.565239    ┆ 5    ┆ 126          │
│ BAKEUSDT  ┆ -2.381052    ┆ 6    ┆ 125          │
│ ARKMUSDT  ┆ -2.3732      ┆ 7    ┆ 124          │
│ ARPAUSDT  ┆ -2.123685    ┆ 8    ┆ 123          │
│ LEVERUSDT ┆ -2.099951    ┆ 9    ┆ 122          │
│ …         ┆ …            ┆ …    ┆ …            │
│ GALAUSDT  ┆ 2.879681     ┆ 122  ┆ 9            │
│ BATUSDT   ┆ 2.887426     ┆ 123  ┆ 8            │
│ MATICUSDT ┆ 2.916746     ┆ 124  ┆ 7            │
│ DENTUSDT  ┆ 3.062113     ┆ 125  ┆ 6            │
│ IDEXUSDT  ┆ 3.086425     ┆ 126  ┆ 5            │
│ EOSUSDT   ┆ 3.295006     ┆ 127  ┆ 4            │
│ DGBUSDT   ┆ 3.740876     ┆ 128  ┆ 3            │
│ TRXUSDT   ┆ 3.741286     ┆ 129  ┆ 2            │
│ RUNEUSDT  ┆ 4.827893     ┆ 130  ┆ 1            │
│ STORJUSDT ┆ 6.615031     ┆ 131  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,076 - WARNING - 2023-11-09T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:05,076 - INFO - cur close time: 2023-11-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:05,076 - DEBUG - mean expected ret (mean factor): 0.10394387343339843
2024-12-12 23:54:05,081 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,081 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 5000.0      ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,081 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0303      ┆ 0.06755     ┆ 0.0013341   ┆ … ┆ 0.02074 ┆ null   ┆ null    ┆ 0.2821  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,085 - DEBUG - update position: 2023-11-09T23:59:59.999 === diff_trading_value: 299542.0766594963 == cash: 148917.1757617051 
2024-12-12 23:54:05,089 - INFO - pnl: 2023-11-09T23:59:59.999 148917.1757617051 === 1.100%
2024-12-12 23:54:05,094 - DEBUG - cur time: 2023-11-10T23:59:59.999 == next bar open time: 2023-11-11T00:00:00.000 == close pos time: 2023-11-16T00:00:00.000
2024-12-12 23:54:05,094 - INFO - pnl: 2023-11-10T23:59:59.999 149349.04156244983 === 0.290%
2024-12-12 23:54:05,098 - DEBUG - cur time: 2023-11-11T23:59:59.999 == next bar open time: 2023-11-12T00:00:00.000 == close pos time: 2023-11-17T00:00:00.000
2024-12-12 23:54:05,098 - INFO - pnl: 2023-11-11T23:59:59.999 149495.31858168528 === 0.098%
2024-12-12 23:54:05,102 - DEBUG - cur time: 2023-11-12T23:59:59.999 == next bar open time: 2023-11-13T00:00:00.000 == close pos time: 2023-11-18T00:00:00.000
2024-12-12 23:54:05,102 - INFO - pnl: 2023-11-12T23:59:59.999 153858.86968091552 === 2.919%
2024-12-12 23:54:05,106 - DEBUG - cur time: 2023-11-13T23:59:59.999 == next bar open time: 2023-11-14T00:00:00.000 == close pos time: 2023-11-19T00:00:00.000
2024-12-12 23:54:05,108 - INFO - pnl: 2023-11-13T23:59:59.999 147429.83444173422 === -4.179%
2024-12-12 23:54:05,110 - DEBUG - cur time: 2023-11-14T23:59:59.999 == next bar open time: 2023-11-15T00:00:00.000 == close pos time: 2023-11-20T00:00:00.000
2024-12-12 23:54:05,121 - DEBUG - close time 2023-11-14T23:59:59.999 == vol_threshold: 26495168.0
2024-12-12 23:54:05,122 - DEBUG - 2023-11-14T23:59:59.999 == all trade symbol 189 == remain 132 after VOL filter
2024-12-12 23:54:05,122 - DEBUG - sorted_long_factors: shape: (132, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DOTUSDT      ┆ -8.638889    ┆ 0    ┆ 131          │
│ XRPUSDT      ┆ -7.789837    ┆ 1    ┆ 130          │
│ MDTUSDT      ┆ -6.377332    ┆ 2    ┆ 129          │
│ ALGOUSDT     ┆ -5.862821    ┆ 3    ┆ 128          │
│ EDUUSDT      ┆ -5.358412    ┆ 4    ┆ 127          │
│ IOSTUSDT     ┆ -4.326692    ┆ 5    ┆ 126          │
│ 1000SHIBUSDT ┆ -3.831319    ┆ 6    ┆ 125          │
│ ARBUSDT      ┆ -3.761291    ┆ 7    ┆ 124          │
│ MINAUSDT     ┆ -3.396414    ┆ 8    ┆ 123          │
│ PERPUSDT     ┆ -3.301079    ┆ 9    ┆ 122          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ENJUSDT      ┆ 3.989122     ┆ 122  ┆ 9            │
│ HOOKUSDT     ┆ 4.303726     ┆ 123  ┆ 8            │
│ STORJUSDT    ┆ 4.567001     ┆ 124  ┆ 7            │
│ LRCUSDT      ┆ 4.898736     ┆ 125  ┆ 6            │
│ IMXUSDT      ┆ 5.048446     ┆ 126  ┆ 5            │
│ ATAUSDT      ┆ 5.377026     ┆ 127  ┆ 4            │
│ FLOWUSDT     ┆ 5.429506     ┆ 128  ┆ 3            │
│ ARPAUSDT     ┆ 5.556515     ┆ 129  ┆ 2            │
│ DGBUSDT      ┆ 7.652983     ┆ 130  ┆ 1            │
│ CELOUSDT     ┆ 9.359229     ┆ 131  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,130 - WARNING - 2023-11-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:05,130 - INFO - cur close time: 2023-11-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:05,130 - DEBUG - mean expected ret (mean factor): 0.3394118991339359
2024-12-12 23:54:05,134 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,134 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,134 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03335     ┆ 0.07783     ┆ 0.0011521   ┆ … ┆ 0.02098 ┆ null   ┆ null    ┆ 0.5232  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,140 - DEBUG - update position: 2023-11-14T23:59:59.999 === diff_trading_value: 305399.5755298275 == cash: 147069.57239249034 
2024-12-12 23:54:05,142 - INFO - pnl: 2023-11-14T23:59:59.999 147069.57239249034 === -0.244%
2024-12-12 23:54:05,146 - DEBUG - cur time: 2023-11-15T23:59:59.999 == next bar open time: 2023-11-16T00:00:00.000 == close pos time: 2023-11-21T00:00:00.000
2024-12-12 23:54:05,146 - INFO - pnl: 2023-11-15T23:59:59.999 146246.1422509736 === -0.560%
2024-12-12 23:54:05,152 - DEBUG - cur time: 2023-11-16T23:59:59.999 == next bar open time: 2023-11-17T00:00:00.000 == close pos time: 2023-11-22T00:00:00.000
2024-12-12 23:54:05,152 - INFO - pnl: 2023-11-16T23:59:59.999 145617.7124458327 === -0.430%
2024-12-12 23:54:05,158 - DEBUG - cur time: 2023-11-17T23:59:59.999 == next bar open time: 2023-11-18T00:00:00.000 == close pos time: 2023-11-23T00:00:00.000
2024-12-12 23:54:05,159 - INFO - pnl: 2023-11-17T23:59:59.999 144925.3045319632 === -0.475%
2024-12-12 23:54:05,163 - DEBUG - cur time: 2023-11-18T23:59:59.999 == next bar open time: 2023-11-19T00:00:00.000 == close pos time: 2023-11-24T00:00:00.000
2024-12-12 23:54:05,163 - INFO - pnl: 2023-11-18T23:59:59.999 144258.2073894652 === -0.460%
2024-12-12 23:54:05,170 - DEBUG - cur time: 2023-11-19T23:59:59.999 == next bar open time: 2023-11-20T00:00:00.000 == close pos time: 2023-11-25T00:00:00.000
2024-12-12 23:54:05,180 - DEBUG - close time 2023-11-19T23:59:59.999 == vol_threshold: 14861841.74
2024-12-12 23:54:05,180 - DEBUG - 2023-11-19T23:59:59.999 == all trade symbol 189 == remain 132 after VOL filter
2024-12-12 23:54:05,184 - DEBUG - sorted_long_factors: shape: (132, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ IOSTUSDT     ┆ -5.326254    ┆ 0    ┆ 131          │
│ ALPHAUSDT    ┆ -5.093039    ┆ 1    ┆ 130          │
│ CKBUSDT      ┆ -4.416756    ┆ 2    ┆ 129          │
│ AMBUSDT      ┆ -4.097959    ┆ 3    ┆ 128          │
│ ARBUSDT      ┆ -4.095235    ┆ 4    ┆ 127          │
│ LDOUSDT      ┆ -3.79096     ┆ 5    ┆ 126          │
│ DOGEUSDT     ┆ -3.571567    ┆ 6    ┆ 125          │
│ MDTUSDT      ┆ -3.547696    ┆ 7    ┆ 124          │
│ GMTUSDT      ┆ -2.763405    ┆ 8    ┆ 123          │
│ 1000SHIBUSDT ┆ -2.729625    ┆ 9    ┆ 122          │
│ …            ┆ …            ┆ …    ┆ …            │
│ HFTUSDT      ┆ 3.486317     ┆ 122  ┆ 9            │
│ AGIXUSDT     ┆ 3.555837     ┆ 123  ┆ 8            │
│ IDEXUSDT     ┆ 3.766307     ┆ 124  ┆ 7            │
│ KEYUSDT      ┆ 4.251496     ┆ 125  ┆ 6            │
│ ARUSDT       ┆ 4.278643     ┆ 126  ┆ 5            │
│ IOTXUSDT     ┆ 4.830299     ┆ 127  ┆ 4            │
│ VETUSDT      ┆ 4.845879     ┆ 128  ┆ 3            │
│ TRUUSDT      ┆ 5.102391     ┆ 129  ┆ 2            │
│ JOEUSDT      ┆ 5.533944     ┆ 130  ┆ 1            │
│ RSRUSDT      ┆ 7.953545     ┆ 131  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,189 - WARNING - 2023-11-19T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:05,189 - INFO - cur close time: 2023-11-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:05,192 - DEBUG - mean expected ret (mean factor): 0.12756403544458247
2024-12-12 23:54:05,196 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,197 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,197 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03286     ┆ 0.07784     ┆ 0.0011914   ┆ … ┆ 0.02221 ┆ null   ┆ null    ┆ 0.3997  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,203 - DEBUG - update position: 2023-11-19T23:59:59.999 === diff_trading_value: 296210.6181898438 == cash: 144226.7491167901 
2024-12-12 23:54:05,203 - INFO - pnl: 2023-11-19T23:59:59.999 144226.7491167901 === -0.022%
2024-12-12 23:54:05,206 - DEBUG - cur time: 2023-11-20T23:59:59.999 == next bar open time: 2023-11-21T00:00:00.000 == close pos time: 2023-11-26T00:00:00.000
2024-12-12 23:54:05,210 - INFO - pnl: 2023-11-20T23:59:59.999 144737.55812929245 === 0.354%
2024-12-12 23:54:05,213 - DEBUG - cur time: 2023-11-21T23:59:59.999 == next bar open time: 2023-11-22T00:00:00.000 == close pos time: 2023-11-27T00:00:00.000
2024-12-12 23:54:05,213 - INFO - pnl: 2023-11-21T23:59:59.999 143607.7219322186 === -0.781%
2024-12-12 23:54:05,218 - DEBUG - cur time: 2023-11-22T23:59:59.999 == next bar open time: 2023-11-23T00:00:00.000 == close pos time: 2023-11-28T00:00:00.000
2024-12-12 23:54:05,220 - INFO - pnl: 2023-11-22T23:59:59.999 144007.89173677395 === 0.279%
2024-12-12 23:54:05,222 - DEBUG - cur time: 2023-11-23T23:59:59.999 == next bar open time: 2023-11-24T00:00:00.000 == close pos time: 2023-11-29T00:00:00.000
2024-12-12 23:54:05,226 - INFO - pnl: 2023-11-23T23:59:59.999 145043.13815270195 === 0.719%
2024-12-12 23:54:05,230 - DEBUG - cur time: 2023-11-24T23:59:59.999 == next bar open time: 2023-11-25T00:00:00.000 == close pos time: 2023-11-30T00:00:00.000
2024-12-12 23:54:05,242 - DEBUG - close time 2023-11-24T23:59:59.999 == vol_threshold: 19127230.4
2024-12-12 23:54:05,242 - DEBUG - 2023-11-24T23:59:59.999 == all trade symbol 189 == remain 132 after VOL filter
2024-12-12 23:54:05,242 - DEBUG - sorted_long_factors: shape: (132, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ KEYUSDT   ┆ -4.128001    ┆ 0    ┆ 131          │
│ LUNA2USDT ┆ -4.055791    ┆ 1    ┆ 130          │
│ AGLDUSDT  ┆ -3.447067    ┆ 2    ┆ 129          │
│ XVGUSDT   ┆ -3.077629    ┆ 3    ┆ 128          │
│ PERPUSDT  ┆ -2.918867    ┆ 4    ┆ 127          │
│ STGUSDT   ┆ -2.73173     ┆ 5    ┆ 126          │
│ DODOXUSDT ┆ -2.715553    ┆ 6    ┆ 125          │
│ RDNTUSDT  ┆ -2.659295    ┆ 7    ┆ 124          │
│ OCEANUSDT ┆ -2.628037    ┆ 8    ┆ 123          │
│ IDUSDT    ┆ -2.614812    ┆ 9    ┆ 122          │
│ …         ┆ …            ┆ …    ┆ …            │
│ SEIUSDT   ┆ 2.818631     ┆ 122  ┆ 9            │
│ CHRUSDT   ┆ 3.251648     ┆ 123  ┆ 8            │
│ CTSIUSDT  ┆ 3.291557     ┆ 124  ┆ 7            │
│ ALICEUSDT ┆ 3.418451     ┆ 125  ┆ 6            │
│ XEMUSDT   ┆ 3.418935     ┆ 126  ┆ 5            │
│ MDTUSDT   ┆ 3.436873     ┆ 127  ┆ 4            │
│ RUNEUSDT  ┆ 3.585715     ┆ 128  ┆ 3            │
│ IMXUSDT   ┆ 3.716776     ┆ 129  ┆ 2            │
│ SPELLUSDT ┆ 3.995173     ┆ 130  ┆ 1            │
│ TLMUSDT   ┆ 4.31977      ┆ 131  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,251 - INFO - cur close time: 2023-11-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:05,255 - DEBUG - mean expected ret (mean factor): 0.14524575860257005
2024-12-12 23:54:05,260 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,260 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,260 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0326      ┆ 0.07423     ┆ 0.0011077   ┆ … ┆ 0.02107 ┆ null   ┆ null    ┆ 0.4374  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,267 - DEBUG - update position: 2023-11-24T23:59:59.999 === diff_trading_value: 356454.86834392557 == cash: 143875.52883900751 
2024-12-12 23:54:05,270 - INFO - pnl: 2023-11-24T23:59:59.999 143875.52883900751 === -0.805%
2024-12-12 23:54:05,271 - DEBUG - cur time: 2023-11-25T23:59:59.999 == next bar open time: 2023-11-26T00:00:00.000 == close pos time: 2023-12-01T00:00:00.000
2024-12-12 23:54:05,275 - INFO - pnl: 2023-11-25T23:59:59.999 140742.4625463435 === -2.178%
2024-12-12 23:54:05,276 - DEBUG - cur time: 2023-11-26T23:59:59.999 == next bar open time: 2023-11-27T00:00:00.000 == close pos time: 2023-12-02T00:00:00.000
2024-12-12 23:54:05,280 - INFO - pnl: 2023-11-26T23:59:59.999 139816.65646214498 === -0.658%
2024-12-12 23:54:05,285 - DEBUG - cur time: 2023-11-27T23:59:59.999 == next bar open time: 2023-11-28T00:00:00.000 == close pos time: 2023-12-03T00:00:00.000
2024-12-12 23:54:05,285 - INFO - pnl: 2023-11-27T23:59:59.999 141856.40228183995 === 1.459%
2024-12-12 23:54:05,290 - DEBUG - cur time: 2023-11-28T23:59:59.999 == next bar open time: 2023-11-29T00:00:00.000 == close pos time: 2023-12-04T00:00:00.000
2024-12-12 23:54:05,294 - INFO - pnl: 2023-11-28T23:59:59.999 142655.09713906934 === 0.563%
2024-12-12 23:54:05,294 - DEBUG - cur time: 2023-11-29T23:59:59.999 == next bar open time: 2023-11-30T00:00:00.000 == close pos time: 2023-12-05T00:00:00.000
2024-12-12 23:54:05,310 - DEBUG - close time 2023-11-29T23:59:59.999 == vol_threshold: 16650530.0
2024-12-12 23:54:05,310 - DEBUG - 2023-11-29T23:59:59.999 == all trade symbol 191 == remain 133 after VOL filter
2024-12-12 23:54:05,313 - DEBUG - sorted_long_factors: shape: (133, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ RVNUSDT   ┆ -5.183346    ┆ 0    ┆ 132          │
│ AMBUSDT   ┆ -5.151249    ┆ 1    ┆ 131          │
│ XVGUSDT   ┆ -4.559567    ┆ 2    ┆ 130          │
│ XLMUSDT   ┆ -4.477126    ┆ 3    ┆ 129          │
│ ARPAUSDT  ┆ -4.035957    ┆ 4    ┆ 128          │
│ ALPHAUSDT ┆ -3.955193    ┆ 5    ┆ 127          │
│ TRUUSDT   ┆ -3.731737    ┆ 6    ┆ 126          │
│ YGGUSDT   ┆ -3.653375    ┆ 7    ┆ 125          │
│ DUSKUSDT  ┆ -3.234642    ┆ 8    ┆ 124          │
│ XRPUSDT   ┆ -2.890757    ┆ 9    ┆ 123          │
│ …         ┆ …            ┆ …    ┆ …            │
│ IOTXUSDT  ┆ 2.314176     ┆ 123  ┆ 9            │
│ NKNUSDT   ┆ 2.402802     ┆ 124  ┆ 8            │
│ GTCUSDT   ┆ 2.421229     ┆ 125  ┆ 7            │
│ SPELLUSDT ┆ 2.786708     ┆ 126  ┆ 6            │
│ BATUSDT   ┆ 2.815958     ┆ 127  ┆ 5            │
│ CFXUSDT   ┆ 2.986215     ┆ 128  ┆ 4            │
│ FLOWUSDT  ┆ 3.236091     ┆ 129  ┆ 3            │
│ IOTAUSDT  ┆ 3.838657     ┆ 130  ┆ 2            │
│ DARUSDT   ┆ 4.766293     ┆ 131  ┆ 1            │
│ TRXUSDT   ┆ 5.953543     ┆ 132  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,321 - WARNING - 2023-11-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:05,321 - INFO - cur close time: 2023-11-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:05,321 - DEBUG - mean expected ret (mean factor): -0.010842700189681847
2024-12-12 23:54:05,325 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,325 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,325 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0319      ┆ 0.11634     ┆ 0.0010571   ┆ … ┆ 0.02157 ┆ null   ┆ null    ┆ 0.3965  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,342 - DEBUG - update position: 2023-11-29T23:59:59.999 === diff_trading_value: 304782.95760750875 == cash: 136444.03413159976 
2024-12-12 23:54:05,342 - INFO - pnl: 2023-11-29T23:59:59.999 136444.03413159976 === -4.354%
2024-12-12 23:54:05,351 - DEBUG - cur time: 2023-11-30T23:59:59.999 == next bar open time: 2023-12-01T00:00:00.000 == close pos time: 2023-12-06T00:00:00.000
2024-12-12 23:54:05,351 - INFO - pnl: 2023-11-30T23:59:59.999 134891.76330123816 === -1.138%
2024-12-12 23:54:05,355 - DEBUG - cur time: 2023-12-01T23:59:59.999 == next bar open time: 2023-12-02T00:00:00.000 == close pos time: 2023-12-07T00:00:00.000
2024-12-12 23:54:05,355 - INFO - pnl: 2023-12-01T23:59:59.999 136828.53353898146 === 1.436%
2024-12-12 23:54:05,360 - DEBUG - cur time: 2023-12-02T23:59:59.999 == next bar open time: 2023-12-03T00:00:00.000 == close pos time: 2023-12-08T00:00:00.000
2024-12-12 23:54:05,363 - INFO - pnl: 2023-12-02T23:59:59.999 139673.40152696718 === 2.079%
2024-12-12 23:54:05,370 - DEBUG - cur time: 2023-12-03T23:59:59.999 == next bar open time: 2023-12-04T00:00:00.000 == close pos time: 2023-12-09T00:00:00.000
2024-12-12 23:54:05,370 - INFO - pnl: 2023-12-03T23:59:59.999 142297.7107260097 === 1.879%
2024-12-12 23:54:05,376 - DEBUG - cur time: 2023-12-04T23:59:59.999 == next bar open time: 2023-12-05T00:00:00.000 == close pos time: 2023-12-10T00:00:00.000
2024-12-12 23:54:05,389 - DEBUG - close time 2023-12-04T23:59:59.999 == vol_threshold: 31365993.0
2024-12-12 23:54:05,389 - DEBUG - 2023-12-04T23:59:59.999 == all trade symbol 191 == remain 133 after VOL filter
2024-12-12 23:54:05,389 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MDTUSDT      ┆ -5.076526    ┆ 0    ┆ 132          │
│ HOOKUSDT     ┆ -4.260361    ┆ 1    ┆ 131          │
│ ARPAUSDT     ┆ -4.171585    ┆ 2    ┆ 130          │
│ XRPUSDT      ┆ -4.028951    ┆ 3    ┆ 129          │
│ EDUUSDT      ┆ -3.799092    ┆ 4    ┆ 128          │
│ IDUSDT       ┆ -3.259164    ┆ 5    ┆ 127          │
│ NKNUSDT      ┆ -3.236944    ┆ 6    ┆ 126          │
│ ALPHAUSDT    ┆ -3.186582    ┆ 7    ┆ 125          │
│ LEVERUSDT    ┆ -3.085779    ┆ 8    ┆ 124          │
│ FETUSDT      ┆ -3.078455    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ZRXUSDT      ┆ 2.935288     ┆ 123  ┆ 9            │
│ IMXUSDT      ┆ 3.014619     ┆ 124  ┆ 8            │
│ BATUSDT      ┆ 3.052064     ┆ 125  ┆ 7            │
│ IOTXUSDT     ┆ 3.066304     ┆ 126  ┆ 6            │
│ JOEUSDT      ┆ 3.095177     ┆ 127  ┆ 5            │
│ NEARUSDT     ┆ 3.141803     ┆ 128  ┆ 4            │
│ GALAUSDT     ┆ 3.281859     ┆ 129  ┆ 3            │
│ 1000LUNCUSDT ┆ 3.432017     ┆ 130  ┆ 2            │
│ TRXUSDT      ┆ 3.522596     ┆ 131  ┆ 1            │
│ TUSDT        ┆ 4.223913     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,396 - WARNING - 2023-12-04T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:05,396 - INFO - cur close time: 2023-12-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:05,396 - DEBUG - mean expected ret (mean factor): 0.2263731213913228
2024-12-12 23:54:05,404 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,404 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,404 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0374      ┆ 0.25792     ┆ 0.0013954   ┆ … ┆ 0.02263 ┆ null   ┆ null    ┆ 0.4152  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,414 - DEBUG - update position: 2023-12-04T23:59:59.999 === diff_trading_value: 262416.2401674852 == cash: 149235.63740718938 
2024-12-12 23:54:05,417 - INFO - pnl: 2023-12-04T23:59:59.999 149235.63740718938 === 4.876%
2024-12-12 23:54:05,421 - DEBUG - cur time: 2023-12-05T23:59:59.999 == next bar open time: 2023-12-06T00:00:00.000 == close pos time: 2023-12-11T00:00:00.000
2024-12-12 23:54:05,421 - INFO - pnl: 2023-12-05T23:59:59.999 147991.18003804685 === -0.834%
2024-12-12 23:54:05,426 - DEBUG - cur time: 2023-12-06T23:59:59.999 == next bar open time: 2023-12-07T00:00:00.000 == close pos time: 2023-12-12T00:00:00.000
2024-12-12 23:54:05,430 - INFO - pnl: 2023-12-06T23:59:59.999 147321.62380889652 === -0.452%
2024-12-12 23:54:05,430 - DEBUG - cur time: 2023-12-07T23:59:59.999 == next bar open time: 2023-12-08T00:00:00.000 == close pos time: 2023-12-13T00:00:00.000
2024-12-12 23:54:05,434 - INFO - pnl: 2023-12-07T23:59:59.999 145361.20389923657 === -1.331%
2024-12-12 23:54:05,434 - DEBUG - cur time: 2023-12-08T23:59:59.999 == next bar open time: 2023-12-09T00:00:00.000 == close pos time: 2023-12-14T00:00:00.000
2024-12-12 23:54:05,438 - INFO - pnl: 2023-12-08T23:59:59.999 144400.6107229085 === -0.661%
2024-12-12 23:54:05,440 - DEBUG - cur time: 2023-12-09T23:59:59.999 == next bar open time: 2023-12-10T00:00:00.000 == close pos time: 2023-12-15T00:00:00.000
2024-12-12 23:54:05,451 - DEBUG - close time 2023-12-09T23:59:59.999 == vol_threshold: 24864897.419999994
2024-12-12 23:54:05,455 - DEBUG - 2023-12-09T23:59:59.999 == all trade symbol 193 == remain 135 after VOL filter
2024-12-12 23:54:05,455 - DEBUG - sorted_long_factors: shape: (135, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ALPHAUSDT ┆ -4.957762    ┆ 0    ┆ 134          │
│ STGUSDT   ┆ -3.736249    ┆ 1    ┆ 133          │
│ MAVUSDT   ┆ -3.593836    ┆ 2    ┆ 132          │
│ YGGUSDT   ┆ -3.542286    ┆ 3    ┆ 131          │
│ FETUSDT   ┆ -3.145613    ┆ 4    ┆ 130          │
│ XVGUSDT   ┆ -3.024483    ┆ 5    ┆ 129          │
│ IDEXUSDT  ┆ -2.816137    ┆ 6    ┆ 128          │
│ CHZUSDT   ┆ -2.75575     ┆ 7    ┆ 127          │
│ STORJUSDT ┆ -2.715841    ┆ 8    ┆ 126          │
│ DYDXUSDT  ┆ -2.701191    ┆ 9    ┆ 125          │
│ …         ┆ …            ┆ …    ┆ …            │
│ SXPUSDT   ┆ 2.721109     ┆ 125  ┆ 9            │
│ ALGOUSDT  ┆ 2.744975     ┆ 126  ┆ 8            │
│ CTSIUSDT  ┆ 2.814211     ┆ 127  ┆ 7            │
│ IMXUSDT   ┆ 3.118323     ┆ 128  ┆ 6            │
│ EOSUSDT   ┆ 3.579566     ┆ 129  ┆ 5            │
│ MDTUSDT   ┆ 3.971768     ┆ 130  ┆ 4            │
│ FLOWUSDT  ┆ 4.004687     ┆ 131  ┆ 3            │
│ TRXUSDT   ┆ 4.050793     ┆ 132  ┆ 2            │
│ XEMUSDT   ┆ 4.962454     ┆ 133  ┆ 1            │
│ DODOXUSDT ┆ 7.193655     ┆ 134  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,460 - WARNING - 2023-12-09T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:05,460 - INFO - cur close time: 2023-12-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:05,460 - DEBUG - mean expected ret (mean factor): 0.05568820608701462
2024-12-12 23:54:05,466 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,466 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,466 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.04035     ┆ 0.17947     ┆ 0.0015329   ┆ … ┆ 0.02486 ┆ null   ┆ null    ┆ 0.4312  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,470 - DEBUG - update position: 2023-12-09T23:59:59.999 === diff_trading_value: 317716.0761568895 == cash: 147195.32299204223 
2024-12-12 23:54:05,474 - INFO - pnl: 2023-12-09T23:59:59.999 147195.32299204223 === 1.935%
2024-12-12 23:54:05,482 - DEBUG - cur time: 2023-12-10T23:59:59.999 == next bar open time: 2023-12-11T00:00:00.000 == close pos time: 2023-12-16T00:00:00.000
2024-12-12 23:54:05,482 - INFO - pnl: 2023-12-10T23:59:59.999 146042.98226364725 === -0.783%
2024-12-12 23:54:05,491 - DEBUG - cur time: 2023-12-11T23:59:59.999 == next bar open time: 2023-12-12T00:00:00.000 == close pos time: 2023-12-17T00:00:00.000
2024-12-12 23:54:05,495 - INFO - pnl: 2023-12-11T23:59:59.999 149131.65298029332 === 2.115%
2024-12-12 23:54:05,503 - DEBUG - cur time: 2023-12-12T23:59:59.999 == next bar open time: 2023-12-13T00:00:00.000 == close pos time: 2023-12-18T00:00:00.000
2024-12-12 23:54:05,511 - INFO - pnl: 2023-12-12T23:59:59.999 145750.18266786568 === -2.267%
2024-12-12 23:54:05,525 - DEBUG - cur time: 2023-12-13T23:59:59.999 == next bar open time: 2023-12-14T00:00:00.000 == close pos time: 2023-12-19T00:00:00.000
2024-12-12 23:54:05,530 - INFO - pnl: 2023-12-13T23:59:59.999 144969.20099580803 === -0.536%
2024-12-12 23:54:05,534 - DEBUG - cur time: 2023-12-14T23:59:59.999 == next bar open time: 2023-12-15T00:00:00.000 == close pos time: 2023-12-20T00:00:00.000
2024-12-12 23:54:05,547 - DEBUG - close time 2023-12-14T23:59:59.999 == vol_threshold: 20893356.399999987
2024-12-12 23:54:05,547 - DEBUG - 2023-12-14T23:59:59.999 == all trade symbol 193 == remain 135 after VOL filter
2024-12-12 23:54:05,550 - DEBUG - sorted_long_factors: shape: (135, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ LDOUSDT   ┆ -4.205199    ┆ 0    ┆ 134          │
│ DUSKUSDT  ┆ -3.977968    ┆ 1    ┆ 133          │
│ HOOKUSDT  ┆ -3.649647    ┆ 2    ┆ 132          │
│ BICOUSDT  ┆ -3.63397     ┆ 3    ┆ 131          │
│ IDEXUSDT  ┆ -3.421503    ┆ 4    ┆ 130          │
│ MANAUSDT  ┆ -3.411456    ┆ 5    ┆ 129          │
│ BLZUSDT   ┆ -3.252156    ┆ 6    ┆ 128          │
│ ARBUSDT   ┆ -2.852347    ┆ 7    ┆ 127          │
│ LUNA2USDT ┆ -2.746865    ┆ 8    ┆ 126          │
│ BLURUSDT  ┆ -2.741698    ┆ 9    ┆ 125          │
│ …         ┆ …            ┆ …    ┆ …            │
│ RDNTUSDT  ┆ 2.824855     ┆ 125  ┆ 9            │
│ ASTRUSDT  ┆ 2.860949     ┆ 126  ┆ 8            │
│ ENJUSDT   ┆ 2.971892     ┆ 127  ┆ 7            │
│ STORJUSDT ┆ 3.155975     ┆ 128  ┆ 6            │
│ ROSEUSDT  ┆ 3.335875     ┆ 129  ┆ 5            │
│ KAVAUSDT  ┆ 3.803917     ┆ 130  ┆ 4            │
│ SKLUSDT   ┆ 3.898943     ┆ 131  ┆ 3            │
│ OXTUSDT   ┆ 4.296725     ┆ 132  ┆ 2            │
│ INJUSDT   ┆ 5.033557     ┆ 133  ┆ 1            │
│ DGBUSDT   ┆ 5.988118     ┆ 134  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,555 - INFO - cur close time: 2023-12-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:05,555 - DEBUG - mean expected ret (mean factor): 0.11628879367932114
2024-12-12 23:54:05,560 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,560 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,560 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03986     ┆ 0.18051     ┆ 0.0014855   ┆ … ┆ 0.02454 ┆ null   ┆ null    ┆ 0.3914  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,567 - DEBUG - update position: 2023-12-14T23:59:59.999 === diff_trading_value: 349050.7700686259 == cash: 142098.8142258666 
2024-12-12 23:54:05,569 - INFO - pnl: 2023-12-14T23:59:59.999 142098.8142258666 === -1.980%
2024-12-12 23:54:05,573 - DEBUG - cur time: 2023-12-15T23:59:59.999 == next bar open time: 2023-12-16T00:00:00.000 == close pos time: 2023-12-21T00:00:00.000
2024-12-12 23:54:05,574 - INFO - pnl: 2023-12-15T23:59:59.999 143503.4277586471 === 0.988%
2024-12-12 23:54:05,575 - DEBUG - cur time: 2023-12-16T23:59:59.999 == next bar open time: 2023-12-17T00:00:00.000 == close pos time: 2023-12-22T00:00:00.000
2024-12-12 23:54:05,579 - INFO - pnl: 2023-12-16T23:59:59.999 142635.24730912579 === -0.605%
2024-12-12 23:54:05,579 - DEBUG - cur time: 2023-12-17T23:59:59.999 == next bar open time: 2023-12-18T00:00:00.000 == close pos time: 2023-12-23T00:00:00.000
2024-12-12 23:54:05,584 - INFO - pnl: 2023-12-17T23:59:59.999 141830.83813335843 === -0.564%
2024-12-12 23:54:05,585 - DEBUG - cur time: 2023-12-18T23:59:59.999 == next bar open time: 2023-12-19T00:00:00.000 == close pos time: 2023-12-24T00:00:00.000
2024-12-12 23:54:05,588 - INFO - pnl: 2023-12-18T23:59:59.999 146066.16809914715 === 2.986%
2024-12-12 23:54:05,590 - DEBUG - cur time: 2023-12-19T23:59:59.999 == next bar open time: 2023-12-20T00:00:00.000 == close pos time: 2023-12-25T00:00:00.000
2024-12-12 23:54:05,600 - DEBUG - close time 2023-12-19T23:59:59.999 == vol_threshold: 16147395.896
2024-12-12 23:54:05,600 - DEBUG - 2023-12-19T23:59:59.999 == all trade symbol 193 == remain 135 after VOL filter
2024-12-12 23:54:05,601 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BICOUSDT     ┆ -4.458799    ┆ 0    ┆ 134          │
│ OMGUSDT      ┆ -2.866807    ┆ 1    ┆ 133          │
│ GLMRUSDT     ┆ -2.808776    ┆ 2    ┆ 132          │
│ DYDXUSDT     ┆ -2.780512    ┆ 3    ┆ 131          │
│ LEVERUSDT    ┆ -2.711197    ┆ 4    ┆ 130          │
│ YGGUSDT      ┆ -2.702444    ┆ 5    ┆ 129          │
│ HOOKUSDT     ┆ -2.678085    ┆ 6    ┆ 128          │
│ XVGUSDT      ┆ -2.584806    ┆ 7    ┆ 127          │
│ AMBUSDT      ┆ -2.566395    ┆ 8    ┆ 126          │
│ 1000SHIBUSDT ┆ -2.557324    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ FLMUSDT      ┆ 2.39881      ┆ 125  ┆ 9            │
│ XTZUSDT      ┆ 2.569921     ┆ 126  ┆ 8            │
│ DGBUSDT      ┆ 2.576357     ┆ 127  ┆ 7            │
│ STORJUSDT    ┆ 2.739948     ┆ 128  ┆ 6            │
│ SPELLUSDT    ┆ 2.826777     ┆ 129  ┆ 5            │
│ STMXUSDT     ┆ 2.870429     ┆ 130  ┆ 4            │
│ INJUSDT      ┆ 2.941501     ┆ 131  ┆ 3            │
│ JOEUSDT      ┆ 3.138388     ┆ 132  ┆ 2            │
│ ONTUSDT      ┆ 3.171873     ┆ 133  ┆ 1            │
│ FLOWUSDT     ┆ 4.453975     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,605 - INFO - cur close time: 2023-12-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:05,605 - DEBUG - mean expected ret (mean factor): -0.03646461629893265
2024-12-12 23:54:05,610 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,610 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,610 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03411     ┆ 0.16116     ┆ 0.0012483   ┆ … ┆ 0.02249 ┆ null   ┆ null    ┆ 0.3677  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,615 - DEBUG - update position: 2023-12-19T23:59:59.999 === diff_trading_value: 299647.5134916687 == cash: 143616.00445081355 
2024-12-12 23:54:05,615 - INFO - pnl: 2023-12-19T23:59:59.999 143616.00445081355 === -1.677%
2024-12-12 23:54:05,619 - DEBUG - cur time: 2023-12-20T23:59:59.999 == next bar open time: 2023-12-21T00:00:00.000 == close pos time: 2023-12-26T00:00:00.000
2024-12-12 23:54:05,621 - INFO - pnl: 2023-12-20T23:59:59.999 143336.7382576656 === -0.194%
2024-12-12 23:54:05,621 - DEBUG - cur time: 2023-12-21T23:59:59.999 == next bar open time: 2023-12-22T00:00:00.000 == close pos time: 2023-12-27T00:00:00.000
2024-12-12 23:54:05,621 - INFO - pnl: 2023-12-21T23:59:59.999 145948.94053362746 === 1.822%
2024-12-12 23:54:05,625 - DEBUG - cur time: 2023-12-22T23:59:59.999 == next bar open time: 2023-12-23T00:00:00.000 == close pos time: 2023-12-28T00:00:00.000
2024-12-12 23:54:05,625 - INFO - pnl: 2023-12-22T23:59:59.999 143633.8046974831 === -1.586%
2024-12-12 23:54:05,630 - DEBUG - cur time: 2023-12-23T23:59:59.999 == next bar open time: 2023-12-24T00:00:00.000 == close pos time: 2023-12-29T00:00:00.000
2024-12-12 23:54:05,630 - INFO - pnl: 2023-12-23T23:59:59.999 140604.31752944362 === -2.109%
2024-12-12 23:54:05,634 - DEBUG - cur time: 2023-12-24T23:59:59.999 == next bar open time: 2023-12-25T00:00:00.000 == close pos time: 2023-12-30T00:00:00.000
2024-12-12 23:54:05,642 - DEBUG - close time 2023-12-24T23:59:59.999 == vol_threshold: 26449334.95
2024-12-12 23:54:05,642 - DEBUG - 2023-12-24T23:59:59.999 == all trade symbol 196 == remain 137 after VOL filter
2024-12-12 23:54:05,646 - DEBUG - sorted_long_factors: shape: (137, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MAVUSDT      ┆ -7.175259    ┆ 0    ┆ 136          │
│ AGIXUSDT     ┆ -4.732276    ┆ 1    ┆ 135          │
│ HOOKUSDT     ┆ -4.340192    ┆ 2    ┆ 134          │
│ YGGUSDT      ┆ -3.553326    ┆ 3    ┆ 133          │
│ DYDXUSDT     ┆ -3.308782    ┆ 4    ┆ 132          │
│ 1000SHIBUSDT ┆ -3.23794     ┆ 5    ┆ 131          │
│ AMBUSDT      ┆ -2.958288    ┆ 6    ┆ 130          │
│ IOSTUSDT     ┆ -2.827297    ┆ 7    ┆ 129          │
│ 1000LUNCUSDT ┆ -2.813691    ┆ 8    ┆ 128          │
│ BICOUSDT     ┆ -2.793632    ┆ 9    ┆ 127          │
│ …            ┆ …            ┆ …    ┆ …            │
│ FLOWUSDT     ┆ 3.29404      ┆ 127  ┆ 9            │
│ ROSEUSDT     ┆ 3.813494     ┆ 128  ┆ 8            │
│ EOSUSDT      ┆ 3.878692     ┆ 129  ┆ 7            │
│ SFPUSDT      ┆ 4.007414     ┆ 130  ┆ 6            │
│ GLMRUSDT     ┆ 4.134138     ┆ 131  ┆ 5            │
│ XEMUSDT      ┆ 4.575076     ┆ 132  ┆ 4            │
│ TUSDT        ┆ 4.620611     ┆ 133  ┆ 3            │
│ CRVUSDT      ┆ 4.665793     ┆ 134  ┆ 2            │
│ PHBUSDT      ┆ 4.855914     ┆ 135  ┆ 1            │
│ BAKEUSDT     ┆ 4.923095     ┆ 136  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,649 - WARNING - 2023-12-24T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:05,649 - INFO - cur close time: 2023-12-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:05,649 - DEBUG - mean expected ret (mean factor): 0.16794363930866166
2024-12-12 23:54:05,654 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,654 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,654 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03521     ┆ 0.15627     ┆ 0.0013746   ┆ … ┆ 0.02656 ┆ null   ┆ null    ┆ 0.3575  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,659 - DEBUG - update position: 2023-12-24T23:59:59.999 === diff_trading_value: 270254.52757343027 == cash: 140639.66979421864 
2024-12-12 23:54:05,662 - INFO - pnl: 2023-12-24T23:59:59.999 140639.66979421864 === 0.025%
2024-12-12 23:54:05,662 - DEBUG - cur time: 2023-12-25T23:59:59.999 == next bar open time: 2023-12-26T00:00:00.000 == close pos time: 2023-12-31T00:00:00.000
2024-12-12 23:54:05,666 - INFO - pnl: 2023-12-25T23:59:59.999 138464.03933803833 === -1.547%
2024-12-12 23:54:05,666 - DEBUG - cur time: 2023-12-26T23:59:59.999 == next bar open time: 2023-12-27T00:00:00.000 == close pos time: 2024-01-01T00:00:00.000
2024-12-12 23:54:05,669 - INFO - pnl: 2023-12-26T23:59:59.999 138218.910971767 === -0.177%
2024-12-12 23:54:05,669 - DEBUG - cur time: 2023-12-27T23:59:59.999 == next bar open time: 2023-12-28T00:00:00.000 == close pos time: 2024-01-02T00:00:00.000
2024-12-12 23:54:05,674 - INFO - pnl: 2023-12-27T23:59:59.999 140091.82601579014 === 1.355%
2024-12-12 23:54:05,674 - DEBUG - cur time: 2023-12-28T23:59:59.999 == next bar open time: 2023-12-29T00:00:00.000 == close pos time: 2024-01-03T00:00:00.000
2024-12-12 23:54:05,674 - INFO - pnl: 2023-12-28T23:59:59.999 138778.71996636727 === -0.937%
2024-12-12 23:54:05,680 - DEBUG - cur time: 2023-12-29T23:59:59.999 == next bar open time: 2023-12-30T00:00:00.000 == close pos time: 2024-01-04T00:00:00.000
2024-12-12 23:54:05,690 - DEBUG - close time 2023-12-29T23:59:59.999 == vol_threshold: 17999982.12
2024-12-12 23:54:05,690 - DEBUG - 2023-12-29T23:59:59.999 == all trade symbol 200 == remain 140 after VOL filter
2024-12-12 23:54:05,692 - DEBUG - sorted_long_factors: shape: (140, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BLZUSDT   ┆ -5.494105    ┆ 0    ┆ 139          │
│ STGUSDT   ┆ -4.559912    ┆ 1    ┆ 138          │
│ KEYUSDT   ┆ -3.960229    ┆ 2    ┆ 137          │
│ HFTUSDT   ┆ -3.728403    ┆ 3    ┆ 136          │
│ XVGUSDT   ┆ -3.655106    ┆ 4    ┆ 135          │
│ DODOXUSDT ┆ -3.490184    ┆ 5    ┆ 134          │
│ BLURUSDT  ┆ -3.293487    ┆ 6    ┆ 133          │
│ FILUSDT   ┆ -3.105469    ┆ 7    ┆ 132          │
│ MAVUSDT   ┆ -3.101585    ┆ 8    ┆ 131          │
│ OMGUSDT   ┆ -2.916827    ┆ 9    ┆ 130          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ZILUSDT   ┆ 3.13201      ┆ 130  ┆ 9            │
│ PHBUSDT   ┆ 3.260104     ┆ 131  ┆ 8            │
│ SEIUSDT   ┆ 3.391982     ┆ 132  ┆ 7            │
│ NKNUSDT   ┆ 3.487603     ┆ 133  ┆ 6            │
│ STMXUSDT  ┆ 3.498003     ┆ 134  ┆ 5            │
│ TUSDT     ┆ 3.601553     ┆ 135  ┆ 4            │
│ DENTUSDT  ┆ 3.863825     ┆ 136  ┆ 3            │
│ SKLUSDT   ┆ 4.80061      ┆ 137  ┆ 2            │
│ XEMUSDT   ┆ 4.910832     ┆ 138  ┆ 1            │
│ MDTUSDT   ┆ 8.714027     ┆ 139  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,696 - INFO - cur close time: 2023-12-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:05,696 - DEBUG - mean expected ret (mean factor): -0.01884118240085034
2024-12-12 23:54:05,700 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,700 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,700 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03527     ┆ 0.14071     ┆ 0.001349    ┆ … ┆ 0.02527 ┆ null   ┆ null    ┆ 0.3669  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,704 - DEBUG - update position: 2023-12-29T23:59:59.999 === diff_trading_value: 311296.1624812196 == cash: 139027.3183931748 
2024-12-12 23:54:05,708 - INFO - pnl: 2023-12-29T23:59:59.999 139027.3183931748 === 0.179%
2024-12-12 23:54:05,709 - DEBUG - cur time: 2023-12-30T23:59:59.999 == next bar open time: 2023-12-31T00:00:00.000 == close pos time: 2024-01-05T00:00:00.000
2024-12-12 23:54:05,712 - INFO - pnl: 2023-12-30T23:59:59.999 138799.04685153966 === -0.164%
2024-12-12 23:54:05,713 - DEBUG - cur time: 2023-12-31T23:59:59.999 == next bar open time: 2024-01-01T00:00:00.000 == close pos time: 2024-01-06T00:00:00.000
2024-12-12 23:54:05,716 - INFO - pnl: 2023-12-31T23:59:59.999 136357.83430790415 === -1.759%
2024-12-12 23:54:05,720 - DEBUG - cur time: 2024-01-01T23:59:59.999 == next bar open time: 2024-01-02T00:00:00.000 == close pos time: 2024-01-07T00:00:00.000
2024-12-12 23:54:05,720 - INFO - pnl: 2024-01-01T23:59:59.999 138146.0093377574 === 1.311%
2024-12-12 23:54:05,724 - DEBUG - cur time: 2024-01-02T23:59:59.999 == next bar open time: 2024-01-03T00:00:00.000 == close pos time: 2024-01-08T00:00:00.000
2024-12-12 23:54:05,724 - INFO - pnl: 2024-01-02T23:59:59.999 136806.08263399074 === -0.970%
2024-12-12 23:54:05,728 - DEBUG - cur time: 2024-01-03T23:59:59.999 == next bar open time: 2024-01-04T00:00:00.000 == close pos time: 2024-01-09T00:00:00.000
2024-12-12 23:54:05,736 - DEBUG - close time 2024-01-03T23:59:59.999 == vol_threshold: 39464744.949999996
2024-12-12 23:54:05,736 - DEBUG - 2024-01-03T23:59:59.999 == all trade symbol 202 == remain 141 after VOL filter
2024-12-12 23:54:05,736 - DEBUG - sorted_long_factors: shape: (141, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ KEYUSDT      ┆ -6.324781    ┆ 0    ┆ 140          │
│ HOOKUSDT     ┆ -5.236838    ┆ 1    ┆ 139          │
│ OXTUSDT      ┆ -5.156874    ┆ 2    ┆ 138          │
│ XRPUSDT      ┆ -4.121244    ┆ 3    ┆ 137          │
│ XVGUSDT      ┆ -3.908336    ┆ 4    ┆ 136          │
│ STGUSDT      ┆ -3.82909     ┆ 5    ┆ 135          │
│ DOGEUSDT     ┆ -3.271173    ┆ 6    ┆ 134          │
│ 1000SHIBUSDT ┆ -3.108071    ┆ 7    ┆ 133          │
│ C98USDT      ┆ -2.999306    ┆ 8    ┆ 132          │
│ APEUSDT      ┆ -2.935892    ┆ 9    ┆ 131          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SEIUSDT      ┆ 3.618132     ┆ 131  ┆ 9            │
│ CHRUSDT      ┆ 3.655381     ┆ 132  ┆ 8            │
│ STMXUSDT     ┆ 3.714687     ┆ 133  ┆ 7            │
│ STPTUSDT     ┆ 4.305888     ┆ 134  ┆ 6            │
│ SKLUSDT      ┆ 4.435692     ┆ 135  ┆ 5            │
│ DGBUSDT      ┆ 4.458641     ┆ 136  ┆ 4            │
│ XEMUSDT      ┆ 4.785251     ┆ 137  ┆ 3            │
│ PEOPLEUSDT   ┆ 5.28812      ┆ 138  ┆ 2            │
│ TUSDT        ┆ 5.425085     ┆ 139  ┆ 1            │
│ PERPUSDT     ┆ 6.067421     ┆ 140  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,740 - INFO - cur close time: 2024-01-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:05,744 - DEBUG - mean expected ret (mean factor): 0.2675109564114994
2024-12-12 23:54:05,748 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,748 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,748 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03138     ┆ 0.11627     ┆ 0.0011875   ┆ … ┆ 0.02316 ┆ null   ┆ null    ┆ 0.3316  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,752 - DEBUG - update position: 2024-01-03T23:59:59.999 === diff_trading_value: 258145.03104861922 == cash: 140444.9006252017 
2024-12-12 23:54:05,752 - INFO - pnl: 2024-01-03T23:59:59.999 140444.9006252017 === 2.660%
2024-12-12 23:54:05,756 - DEBUG - cur time: 2024-01-04T23:59:59.999 == next bar open time: 2024-01-05T00:00:00.000 == close pos time: 2024-01-10T00:00:00.000
2024-12-12 23:54:05,756 - INFO - pnl: 2024-01-04T23:59:59.999 139523.4196314668 === -0.656%
2024-12-12 23:54:05,760 - DEBUG - cur time: 2024-01-05T23:59:59.999 == next bar open time: 2024-01-06T00:00:00.000 == close pos time: 2024-01-11T00:00:00.000
2024-12-12 23:54:05,760 - INFO - pnl: 2024-01-05T23:59:59.999 142650.66066396574 === 2.241%
2024-12-12 23:54:05,764 - DEBUG - cur time: 2024-01-06T23:59:59.999 == next bar open time: 2024-01-07T00:00:00.000 == close pos time: 2024-01-12T00:00:00.000
2024-12-12 23:54:05,764 - INFO - pnl: 2024-01-06T23:59:59.999 141383.55001616894 === -0.888%
2024-12-12 23:54:05,768 - DEBUG - cur time: 2024-01-07T23:59:59.999 == next bar open time: 2024-01-08T00:00:00.000 == close pos time: 2024-01-13T00:00:00.000
2024-12-12 23:54:05,769 - INFO - pnl: 2024-01-07T23:59:59.999 141988.17474114927 === 0.428%
2024-12-12 23:54:05,772 - DEBUG - cur time: 2024-01-08T23:59:59.999 == next bar open time: 2024-01-09T00:00:00.000 == close pos time: 2024-01-14T00:00:00.000
2024-12-12 23:54:05,783 - DEBUG - close time 2024-01-08T23:59:59.999 == vol_threshold: 21558049.199999984
2024-12-12 23:54:05,783 - DEBUG - 2024-01-08T23:59:59.999 == all trade symbol 205 == remain 143 after VOL filter
2024-12-12 23:54:05,783 - DEBUG - sorted_long_factors: shape: (143, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ BLZUSDT       ┆ -4.83704     ┆ 0    ┆ 142          │
│ C98USDT       ┆ -4.053318    ┆ 1    ┆ 141          │
│ EDUUSDT       ┆ -3.413217    ┆ 2    ┆ 140          │
│ ARKMUSDT      ┆ -3.202485    ┆ 3    ┆ 139          │
│ AMBUSDT       ┆ -3.132623    ┆ 4    ┆ 138          │
│ DUSKUSDT      ┆ -2.978856    ┆ 5    ┆ 137          │
│ IOSTUSDT      ┆ -2.939628    ┆ 6    ┆ 136          │
│ 1000FLOKIUSDT ┆ -2.929591    ┆ 7    ┆ 135          │
│ MAVUSDT       ┆ -2.834312    ┆ 8    ┆ 134          │
│ STPTUSDT      ┆ -2.681361    ┆ 9    ┆ 133          │
│ …             ┆ …            ┆ …    ┆ …            │
│ DGBUSDT       ┆ 3.366248     ┆ 133  ┆ 9            │
│ TLMUSDT       ┆ 3.518796     ┆ 134  ┆ 8            │
│ EOSUSDT       ┆ 3.884185     ┆ 135  ┆ 7            │
│ CKBUSDT       ┆ 4.078845     ┆ 136  ┆ 6            │
│ DARUSDT       ┆ 4.152086     ┆ 137  ┆ 5            │
│ ONEUSDT       ┆ 4.394889     ┆ 138  ┆ 4            │
│ XEMUSDT       ┆ 4.420481     ┆ 139  ┆ 3            │
│ POLYXUSDT     ┆ 4.560767     ┆ 140  ┆ 2            │
│ ORBSUSDT      ┆ 5.397265     ┆ 141  ┆ 1            │
│ TRXUSDT       ┆ 8.99917      ┆ 142  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,789 - WARNING - 2024-01-08T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:05,791 - INFO - cur close time: 2024-01-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:05,791 - DEBUG - mean expected ret (mean factor): 0.3875303565726046
2024-12-12 23:54:05,795 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,795 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,795 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03049     ┆ 0.12337     ┆ 0.0011943   ┆ … ┆ 0.02205 ┆ null   ┆ null    ┆ 0.3236  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,800 - DEBUG - update position: 2024-01-08T23:59:59.999 === diff_trading_value: 337638.64289085066 == cash: 142147.6805779497 
2024-12-12 23:54:05,800 - INFO - pnl: 2024-01-08T23:59:59.999 142147.6805779497 === 0.112%
2024-12-12 23:54:05,804 - DEBUG - cur time: 2024-01-09T23:59:59.999 == next bar open time: 2024-01-10T00:00:00.000 == close pos time: 2024-01-15T00:00:00.000
2024-12-12 23:54:05,804 - INFO - pnl: 2024-01-09T23:59:59.999 142308.24654117774 === 0.113%
2024-12-12 23:54:05,810 - DEBUG - cur time: 2024-01-10T23:59:59.999 == next bar open time: 2024-01-11T00:00:00.000 == close pos time: 2024-01-16T00:00:00.000
2024-12-12 23:54:05,810 - INFO - pnl: 2024-01-10T23:59:59.999 139996.585278742 === -1.624%
2024-12-12 23:54:05,812 - DEBUG - cur time: 2024-01-11T23:59:59.999 == next bar open time: 2024-01-12T00:00:00.000 == close pos time: 2024-01-17T00:00:00.000
2024-12-12 23:54:05,812 - INFO - pnl: 2024-01-11T23:59:59.999 139021.1495388664 === -0.697%
2024-12-12 23:54:05,816 - DEBUG - cur time: 2024-01-12T23:59:59.999 == next bar open time: 2024-01-13T00:00:00.000 == close pos time: 2024-01-18T00:00:00.000
2024-12-12 23:54:05,816 - INFO - pnl: 2024-01-12T23:59:59.999 138064.49000639888 === -0.688%
2024-12-12 23:54:05,820 - DEBUG - cur time: 2024-01-13T23:59:59.999 == next bar open time: 2024-01-14T00:00:00.000 == close pos time: 2024-01-19T00:00:00.000
2024-12-12 23:54:05,830 - DEBUG - close time 2024-01-13T23:59:59.999 == vol_threshold: 10447273.46
2024-12-12 23:54:05,830 - DEBUG - 2024-01-13T23:59:59.999 == all trade symbol 212 == remain 148 after VOL filter
2024-12-12 23:54:05,832 - DEBUG - sorted_long_factors: shape: (148, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ BLZUSDT     ┆ -7.608666    ┆ 0    ┆ 147          │
│ IMXUSDT     ┆ -4.718959    ┆ 1    ┆ 146          │
│ ARKMUSDT    ┆ -4.196747    ┆ 2    ┆ 145          │
│ ALPHAUSDT   ┆ -3.143063    ┆ 3    ┆ 144          │
│ STPTUSDT    ┆ -2.604266    ┆ 4    ┆ 143          │
│ OCEANUSDT   ┆ -2.565717    ┆ 5    ┆ 142          │
│ LQTYUSDT    ┆ -2.559268    ┆ 6    ┆ 141          │
│ HOTUSDT     ┆ -2.497276    ┆ 7    ┆ 140          │
│ IDUSDT      ┆ -2.438201    ┆ 8    ┆ 139          │
│ THETAUSDT   ┆ -2.404014    ┆ 9    ┆ 138          │
│ …           ┆ …            ┆ …    ┆ …            │
│ 1000XECUSDT ┆ 3.27552      ┆ 138  ┆ 9            │
│ LINAUSDT    ┆ 3.323894     ┆ 139  ┆ 8            │
│ TRXUSDT     ┆ 3.339146     ┆ 140  ┆ 7            │
│ MDTUSDT     ┆ 3.615347     ┆ 141  ┆ 6            │
│ DODOXUSDT   ┆ 3.682623     ┆ 142  ┆ 5            │
│ KLAYUSDT    ┆ 3.841156     ┆ 143  ┆ 4            │
│ HBARUSDT    ┆ 3.966439     ┆ 144  ┆ 3            │
│ RVNUSDT     ┆ 4.049931     ┆ 145  ┆ 2            │
│ PENDLEUSDT  ┆ 5.300547     ┆ 146  ┆ 1            │
│ BNXUSDT     ┆ 5.595796     ┆ 147  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,836 - WARNING - 2024-01-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:05,836 - INFO - cur close time: 2024-01-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:05,836 - DEBUG - mean expected ret (mean factor): 0.1868324270847603
2024-12-12 23:54:05,839 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,839 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,839 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03092     ┆ 0.12497     ┆ 0.0012439   ┆ … ┆ 0.022   ┆ null   ┆ null    ┆ 0.3426  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,843 - DEBUG - update position: 2024-01-13T23:59:59.999 === diff_trading_value: 285534.4583918391 == cash: 137736.13409643306 
2024-12-12 23:54:05,847 - INFO - pnl: 2024-01-13T23:59:59.999 137736.13409643306 === -0.238%
2024-12-12 23:54:05,850 - DEBUG - cur time: 2024-01-14T23:59:59.999 == next bar open time: 2024-01-15T00:00:00.000 == close pos time: 2024-01-20T00:00:00.000
2024-12-12 23:54:05,850 - INFO - pnl: 2024-01-14T23:59:59.999 137634.3506502484 === -0.074%
2024-12-12 23:54:05,852 - DEBUG - cur time: 2024-01-15T23:59:59.999 == next bar open time: 2024-01-16T00:00:00.000 == close pos time: 2024-01-21T00:00:00.000
2024-12-12 23:54:05,852 - INFO - pnl: 2024-01-15T23:59:59.999 137157.6724706186 === -0.346%
2024-12-12 23:54:05,856 - DEBUG - cur time: 2024-01-16T23:59:59.999 == next bar open time: 2024-01-17T00:00:00.000 == close pos time: 2024-01-22T00:00:00.000
2024-12-12 23:54:05,856 - INFO - pnl: 2024-01-16T23:59:59.999 138173.7037734377 === 0.741%
2024-12-12 23:54:05,860 - DEBUG - cur time: 2024-01-17T23:59:59.999 == next bar open time: 2024-01-18T00:00:00.000 == close pos time: 2024-01-23T00:00:00.000
2024-12-12 23:54:05,860 - INFO - pnl: 2024-01-17T23:59:59.999 136725.60821962374 === -1.048%
2024-12-12 23:54:05,863 - DEBUG - cur time: 2024-01-18T23:59:59.999 == next bar open time: 2024-01-19T00:00:00.000 == close pos time: 2024-01-24T00:00:00.000
2024-12-12 23:54:05,872 - DEBUG - close time 2024-01-18T23:59:59.999 == vol_threshold: 16849072.299999997
2024-12-12 23:54:05,872 - DEBUG - 2024-01-18T23:59:59.999 == all trade symbol 214 == remain 150 after VOL filter
2024-12-12 23:54:05,872 - DEBUG - sorted_long_factors: shape: (150, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ BLZUSDT     ┆ -4.70433     ┆ 0    ┆ 149          │
│ 1000XECUSDT ┆ -4.272097    ┆ 1    ┆ 148          │
│ OPUSDT      ┆ -3.541443    ┆ 2    ┆ 147          │
│ CTSIUSDT    ┆ -3.452495    ┆ 3    ┆ 146          │
│ KEYUSDT     ┆ -3.223817    ┆ 4    ┆ 145          │
│ TOKENUSDT   ┆ -3.070832    ┆ 5    ┆ 144          │
│ ENJUSDT     ┆ -3.002106    ┆ 6    ┆ 143          │
│ BIGTIMEUSDT ┆ -2.846339    ┆ 7    ┆ 142          │
│ RIFUSDT     ┆ -2.71846     ┆ 8    ┆ 141          │
│ DOGEUSDT    ┆ -2.395015    ┆ 9    ┆ 140          │
│ …           ┆ …            ┆ …    ┆ …            │
│ BATUSDT     ┆ 2.736301     ┆ 140  ┆ 9            │
│ GASUSDT     ┆ 2.743454     ┆ 141  ┆ 8            │
│ DGBUSDT     ┆ 2.873032     ┆ 142  ┆ 7            │
│ UMAUSDT     ┆ 2.944478     ┆ 143  ┆ 6            │
│ KAVAUSDT    ┆ 3.005336     ┆ 144  ┆ 5            │
│ PENDLEUSDT  ┆ 3.644992     ┆ 145  ┆ 4            │
│ XTZUSDT     ┆ 3.657664     ┆ 146  ┆ 3            │
│ STMXUSDT    ┆ 4.038189     ┆ 147  ┆ 2            │
│ LEVERUSDT   ┆ 4.286979     ┆ 148  ┆ 1            │
│ XEMUSDT     ┆ 4.445333     ┆ 149  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,880 - WARNING - 2024-01-18T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:05,880 - INFO - cur close time: 2024-01-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:05,880 - DEBUG - mean expected ret (mean factor): 0.06572383947099757
2024-12-12 23:54:05,884 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,884 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,884 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02928     ┆ 0.11452     ┆ 0.0011444   ┆ … ┆ 0.0215  ┆ null   ┆ null    ┆ 0.3186  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,890 - DEBUG - update position: 2024-01-18T23:59:59.999 === diff_trading_value: 359660.8381402008 == cash: 137424.78627420406 
2024-12-12 23:54:05,891 - INFO - pnl: 2024-01-18T23:59:59.999 137424.78627420406 === 0.511%
2024-12-12 23:54:05,891 - DEBUG - cur time: 2024-01-19T23:59:59.999 == next bar open time: 2024-01-20T00:00:00.000 == close pos time: 2024-01-25T00:00:00.000
2024-12-12 23:54:05,895 - INFO - pnl: 2024-01-19T23:59:59.999 143024.62827259154 === 4.075%
2024-12-12 23:54:05,899 - DEBUG - cur time: 2024-01-20T23:59:59.999 == next bar open time: 2024-01-21T00:00:00.000 == close pos time: 2024-01-26T00:00:00.000
2024-12-12 23:54:05,899 - INFO - pnl: 2024-01-20T23:59:59.999 141643.1749220136 === -0.966%
2024-12-12 23:54:05,904 - DEBUG - cur time: 2024-01-21T23:59:59.999 == next bar open time: 2024-01-22T00:00:00.000 == close pos time: 2024-01-27T00:00:00.000
2024-12-12 23:54:05,904 - INFO - pnl: 2024-01-21T23:59:59.999 138856.33125342242 === -1.968%
2024-12-12 23:54:05,904 - DEBUG - cur time: 2024-01-22T23:59:59.999 == next bar open time: 2024-01-23T00:00:00.000 == close pos time: 2024-01-28T00:00:00.000
2024-12-12 23:54:05,908 - INFO - pnl: 2024-01-22T23:59:59.999 140683.55338312392 === 1.316%
2024-12-12 23:54:05,910 - DEBUG - cur time: 2024-01-23T23:59:59.999 == next bar open time: 2024-01-24T00:00:00.000 == close pos time: 2024-01-29T00:00:00.000
2024-12-12 23:54:05,919 - DEBUG - close time 2024-01-23T23:59:59.999 == vol_threshold: 21811653.0
2024-12-12 23:54:05,919 - DEBUG - 2024-01-23T23:59:59.999 == all trade symbol 216 == remain 151 after VOL filter
2024-12-12 23:54:05,922 - DEBUG - sorted_long_factors: shape: (151, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ ARPAUSDT   ┆ -4.668846    ┆ 0    ┆ 150          │
│ IDUSDT     ┆ -4.180423    ┆ 1    ┆ 149          │
│ RSRUSDT    ┆ -4.1446      ┆ 2    ┆ 148          │
│ NKNUSDT    ┆ -4.017892    ┆ 3    ┆ 147          │
│ OGNUSDT    ┆ -3.996413    ┆ 4    ┆ 146          │
│ ORDIUSDT   ┆ -3.803084    ┆ 5    ┆ 145          │
│ REEFUSDT   ┆ -3.570879    ┆ 6    ┆ 144          │
│ ALPHAUSDT  ┆ -3.309782    ┆ 7    ┆ 143          │
│ ENJUSDT    ┆ -3.036455    ┆ 8    ┆ 142          │
│ ARKMUSDT   ┆ -2.971056    ┆ 9    ┆ 141          │
│ …          ┆ …            ┆ …    ┆ …            │
│ SNTUSDT    ┆ 3.389212     ┆ 141  ┆ 9            │
│ XVGUSDT    ┆ 3.40678      ┆ 142  ┆ 8            │
│ SKLUSDT    ┆ 3.558725     ┆ 143  ┆ 7            │
│ PHBUSDT    ┆ 3.737774     ┆ 144  ┆ 6            │
│ PENDLEUSDT ┆ 3.895533     ┆ 145  ┆ 5            │
│ STMXUSDT   ┆ 4.021782     ┆ 146  ┆ 4            │
│ UMAUSDT    ┆ 4.536546     ┆ 147  ┆ 3            │
│ KAVAUSDT   ┆ 4.563159     ┆ 148  ┆ 2            │
│ SLPUSDT    ┆ 5.415901     ┆ 149  ┆ 1            │
│ XEMUSDT    ┆ 5.915626     ┆ 150  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,927 - INFO - cur close time: 2024-01-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:05,927 - DEBUG - mean expected ret (mean factor): 0.10078888733384439
2024-12-12 23:54:05,932 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,932 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,932 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02849     ┆ 0.09393     ┆ 0.0010413   ┆ … ┆ 0.01961 ┆ null   ┆ null    ┆ 0.2947  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,936 - DEBUG - update position: 2024-01-23T23:59:59.999 === diff_trading_value: 300978.02529114526 == cash: 142523.26397302153 
2024-12-12 23:54:05,936 - INFO - pnl: 2024-01-23T23:59:59.999 142523.26397302153 === 1.308%
2024-12-12 23:54:05,940 - DEBUG - cur time: 2024-01-24T23:59:59.999 == next bar open time: 2024-01-25T00:00:00.000 == close pos time: 2024-01-30T00:00:00.000
2024-12-12 23:54:05,940 - INFO - pnl: 2024-01-24T23:59:59.999 142993.61388195495 === 0.330%
2024-12-12 23:54:05,944 - DEBUG - cur time: 2024-01-25T23:59:59.999 == next bar open time: 2024-01-26T00:00:00.000 == close pos time: 2024-01-31T00:00:00.000
2024-12-12 23:54:05,944 - INFO - pnl: 2024-01-25T23:59:59.999 141353.51319896162 === -1.147%
2024-12-12 23:54:05,948 - DEBUG - cur time: 2024-01-26T23:59:59.999 == next bar open time: 2024-01-27T00:00:00.000 == close pos time: 2024-02-01T00:00:00.000
2024-12-12 23:54:05,950 - INFO - pnl: 2024-01-26T23:59:59.999 139973.1818090046 === -0.977%
2024-12-12 23:54:05,952 - DEBUG - cur time: 2024-01-27T23:59:59.999 == next bar open time: 2024-01-28T00:00:00.000 == close pos time: 2024-02-02T00:00:00.000
2024-12-12 23:54:05,952 - INFO - pnl: 2024-01-27T23:59:59.999 138860.5527582555 === -0.795%
2024-12-12 23:54:05,956 - DEBUG - cur time: 2024-01-28T23:59:59.999 == next bar open time: 2024-01-29T00:00:00.000 == close pos time: 2024-02-03T00:00:00.000
2024-12-12 23:54:05,963 - DEBUG - close time 2024-01-28T23:59:59.999 == vol_threshold: 10119092.870000001
2024-12-12 23:54:05,963 - DEBUG - 2024-01-28T23:59:59.999 == all trade symbol 220 == remain 154 after VOL filter
2024-12-12 23:54:05,967 - DEBUG - sorted_long_factors: shape: (154, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ XVGUSDT    ┆ -6.270107    ┆ 0    ┆ 153          │
│ DODOXUSDT  ┆ -5.941395    ┆ 1    ┆ 152          │
│ ARKMUSDT   ┆ -5.29375     ┆ 2    ┆ 151          │
│ ANKRUSDT   ┆ -4.865333    ┆ 3    ┆ 150          │
│ LUNA2USDT  ┆ -3.680347    ┆ 4    ┆ 149          │
│ PEOPLEUSDT ┆ -3.489501    ┆ 5    ┆ 148          │
│ ICXUSDT    ┆ -3.474282    ┆ 6    ┆ 147          │
│ OCEANUSDT  ┆ -3.400075    ┆ 7    ┆ 146          │
│ ASTRUSDT   ┆ -3.099775    ┆ 8    ┆ 145          │
│ C98USDT    ┆ -2.927782    ┆ 9    ┆ 144          │
│ …          ┆ …            ┆ …    ┆ …            │
│ KLAYUSDT   ┆ 2.71357      ┆ 144  ┆ 9            │
│ VETUSDT    ┆ 2.828506     ┆ 145  ┆ 8            │
│ KAVAUSDT   ┆ 2.830864     ┆ 146  ┆ 7            │
│ TRXUSDT    ┆ 2.853036     ┆ 147  ┆ 6            │
│ CHRUSDT    ┆ 3.295844     ┆ 148  ┆ 5            │
│ JOEUSDT    ┆ 3.359986     ┆ 149  ┆ 4            │
│ FTMUSDT    ┆ 3.633344     ┆ 150  ┆ 3            │
│ MBLUSDT    ┆ 4.101793     ┆ 151  ┆ 2            │
│ IMXUSDT    ┆ 4.156917     ┆ 152  ┆ 1            │
│ API3USDT   ┆ 4.253434     ┆ 153  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:05,972 - WARNING - 2024-01-28T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:05,972 - INFO - cur close time: 2024-01-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:05,972 - DEBUG - mean expected ret (mean factor): -0.06787861688756208
2024-12-12 23:54:05,976 - DEBUG - begin to update pos: =========
2024-12-12 23:54:05,976 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,976 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0285      ┆ 0.09909     ┆ 0.0010658   ┆ … ┆ 0.02042 ┆ null   ┆ null    ┆ 0.3481  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:05,980 - DEBUG - update position: 2024-01-28T23:59:59.999 === diff_trading_value: 346763.86663301877 == cash: 139788.40689434175 
2024-12-12 23:54:05,984 - INFO - pnl: 2024-01-28T23:59:59.999 139788.40689434175 === 0.668%
2024-12-12 23:54:05,984 - DEBUG - cur time: 2024-01-29T23:59:59.999 == next bar open time: 2024-01-30T00:00:00.000 == close pos time: 2024-02-04T00:00:00.000
2024-12-12 23:54:05,989 - INFO - pnl: 2024-01-29T23:59:59.999 140135.9107255594 === 0.249%
2024-12-12 23:54:05,990 - DEBUG - cur time: 2024-01-30T23:59:59.999 == next bar open time: 2024-01-31T00:00:00.000 == close pos time: 2024-02-05T00:00:00.000
2024-12-12 23:54:05,992 - INFO - pnl: 2024-01-30T23:59:59.999 140375.52086879645 === 0.171%
2024-12-12 23:54:05,996 - DEBUG - cur time: 2024-01-31T23:59:59.999 == next bar open time: 2024-02-01T00:00:00.000 == close pos time: 2024-02-06T00:00:00.000
2024-12-12 23:54:05,997 - INFO - pnl: 2024-01-31T23:59:59.999 140209.98859158083 === -0.118%
2024-12-12 23:54:06,000 - DEBUG - cur time: 2024-02-01T23:59:59.999 == next bar open time: 2024-02-02T00:00:00.000 == close pos time: 2024-02-07T00:00:00.000
2024-12-12 23:54:06,000 - INFO - pnl: 2024-02-01T23:59:59.999 140756.7709247999 === 0.390%
2024-12-12 23:54:06,004 - DEBUG - cur time: 2024-02-02T23:59:59.999 == next bar open time: 2024-02-03T00:00:00.000 == close pos time: 2024-02-08T00:00:00.000
2024-12-12 23:54:06,012 - DEBUG - close time 2024-02-02T23:59:59.999 == vol_threshold: 9246743.78
2024-12-12 23:54:06,012 - DEBUG - 2024-02-02T23:59:59.999 == all trade symbol 222 == remain 155 after VOL filter
2024-12-12 23:54:06,016 - DEBUG - sorted_long_factors: shape: (155, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ KEYUSDT      ┆ -5.235824    ┆ 0    ┆ 154          │
│ IDEXUSDT     ┆ -4.073387    ┆ 1    ┆ 153          │
│ STEEMUSDT    ┆ -3.859363    ┆ 2    ┆ 152          │
│ ACHUSDT      ┆ -3.289936    ┆ 3    ┆ 151          │
│ MBLUSDT      ┆ -3.182144    ┆ 4    ┆ 150          │
│ MDTUSDT      ┆ -2.902491    ┆ 5    ┆ 149          │
│ RLCUSDT      ┆ -2.90088     ┆ 6    ┆ 148          │
│ BIGTIMEUSDT  ┆ -2.67843     ┆ 7    ┆ 147          │
│ ALPHAUSDT    ┆ -2.644967    ┆ 8    ┆ 146          │
│ KASUSDT      ┆ -2.587881    ┆ 9    ┆ 145          │
│ …            ┆ …            ┆ …    ┆ …            │
│ EOSUSDT      ┆ 2.172769     ┆ 145  ┆ 9            │
│ DARUSDT      ┆ 2.423355     ┆ 146  ┆ 8            │
│ IOSTUSDT     ┆ 2.438374     ┆ 147  ┆ 7            │
│ XLMUSDT      ┆ 2.478445     ┆ 148  ┆ 6            │
│ DENTUSDT     ┆ 2.669868     ┆ 149  ┆ 5            │
│ LRCUSDT      ┆ 3.10291      ┆ 150  ┆ 4            │
│ PENDLEUSDT   ┆ 4.305918     ┆ 151  ┆ 3            │
│ 1000SHIBUSDT ┆ 4.547989     ┆ 152  ┆ 2            │
│ WAXPUSDT     ┆ 4.699933     ┆ 153  ┆ 1            │
│ FLOWUSDT     ┆ 5.186691     ┆ 154  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,022 - INFO - cur close time: 2024-02-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:06,022 - DEBUG - mean expected ret (mean factor): 0.127150076436857
2024-12-12 23:54:06,032 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,032 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,032 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.010541    ┆ 0.02806     ┆ 0.09615     ┆ 0.0009294   ┆ … ┆ 0.02036 ┆ null   ┆ null    ┆ 0.3227  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,034 - DEBUG - update position: 2024-02-02T23:59:59.999 === diff_trading_value: 392520.9074495496 == cash: 142849.9801079403 
2024-12-12 23:54:06,038 - INFO - pnl: 2024-02-02T23:59:59.999 142849.9801079403 === 1.487%
2024-12-12 23:54:06,042 - DEBUG - cur time: 2024-02-03T23:59:59.999 == next bar open time: 2024-02-04T00:00:00.000 == close pos time: 2024-02-09T00:00:00.000
2024-12-12 23:54:06,042 - INFO - pnl: 2024-02-03T23:59:59.999 143408.55454742527 === 0.391%
2024-12-12 23:54:06,046 - DEBUG - cur time: 2024-02-04T23:59:59.999 == next bar open time: 2024-02-05T00:00:00.000 == close pos time: 2024-02-10T00:00:00.000
2024-12-12 23:54:06,046 - INFO - pnl: 2024-02-04T23:59:59.999 144312.922526806 === 0.631%
2024-12-12 23:54:06,050 - DEBUG - cur time: 2024-02-05T23:59:59.999 == next bar open time: 2024-02-06T00:00:00.000 == close pos time: 2024-02-11T00:00:00.000
2024-12-12 23:54:06,050 - INFO - pnl: 2024-02-05T23:59:59.999 144181.89100546722 === -0.091%
2024-12-12 23:54:06,056 - DEBUG - cur time: 2024-02-06T23:59:59.999 == next bar open time: 2024-02-07T00:00:00.000 == close pos time: 2024-02-12T00:00:00.000
2024-12-12 23:54:06,056 - INFO - pnl: 2024-02-06T23:59:59.999 144405.54864065064 === 0.155%
2024-12-12 23:54:06,059 - DEBUG - cur time: 2024-02-07T23:59:59.999 == next bar open time: 2024-02-08T00:00:00.000 == close pos time: 2024-02-13T00:00:00.000
2024-12-12 23:54:06,070 - DEBUG - close time 2024-02-07T23:59:59.999 == vol_threshold: 9641298.0
2024-12-12 23:54:06,072 - DEBUG - 2024-02-07T23:59:59.999 == all trade symbol 226 == remain 158 after VOL filter
2024-12-12 23:54:06,072 - DEBUG - sorted_long_factors: shape: (158, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ YGGUSDT       ┆ -7.755559    ┆ 0    ┆ 157          │
│ SNTUSDT       ┆ -5.798655    ┆ 1    ┆ 156          │
│ CHZUSDT       ┆ -4.707785    ┆ 2    ┆ 155          │
│ POLYXUSDT     ┆ -3.605857    ┆ 3    ┆ 154          │
│ 1000FLOKIUSDT ┆ -3.545894    ┆ 4    ┆ 153          │
│ REEFUSDT      ┆ -3.348664    ┆ 5    ┆ 152          │
│ TUSDT         ┆ -3.326198    ┆ 6    ┆ 151          │
│ TLMUSDT       ┆ -3.043707    ┆ 7    ┆ 150          │
│ MBLUSDT       ┆ -3.021086    ┆ 8    ┆ 149          │
│ STPTUSDT      ┆ -2.769996    ┆ 9    ┆ 148          │
│ …             ┆ …            ┆ …    ┆ …            │
│ HOTUSDT       ┆ 3.182409     ┆ 148  ┆ 9            │
│ ENSUSDT       ┆ 3.264167     ┆ 149  ┆ 8            │
│ SANDUSDT      ┆ 3.663012     ┆ 150  ┆ 7            │
│ CHRUSDT       ┆ 4.063407     ┆ 151  ┆ 6            │
│ LINAUSDT      ┆ 4.272157     ┆ 152  ┆ 5            │
│ CKBUSDT       ┆ 4.293453     ┆ 153  ┆ 4            │
│ WAXPUSDT      ┆ 4.313188     ┆ 154  ┆ 3            │
│ TOKENUSDT     ┆ 4.600377     ┆ 155  ┆ 2            │
│ JOEUSDT       ┆ 4.792901     ┆ 156  ┆ 1            │
│ PENDLEUSDT    ┆ 5.089244     ┆ 157  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,076 - WARNING - 2024-02-07T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,076 - INFO - cur close time: 2024-02-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:06,076 - DEBUG - mean expected ret (mean factor): 0.06384694919600664
2024-12-12 23:54:06,080 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,084 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,084 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.010431    ┆ 0.02857     ┆ 0.10866     ┆ 0.0009668   ┆ … ┆ 0.02031 ┆ null   ┆ null    ┆ 0.3199  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,089 - DEBUG - update position: 2024-02-07T23:59:59.999 === diff_trading_value: 341949.5752060552 == cash: 143182.30434888942 
2024-12-12 23:54:06,089 - INFO - pnl: 2024-02-07T23:59:59.999 143182.30434888942 === -0.847%
2024-12-12 23:54:06,092 - DEBUG - cur time: 2024-02-08T23:59:59.999 == next bar open time: 2024-02-09T00:00:00.000 == close pos time: 2024-02-14T00:00:00.000
2024-12-12 23:54:06,092 - INFO - pnl: 2024-02-08T23:59:59.999 143485.99116242336 === 0.212%
2024-12-12 23:54:06,100 - DEBUG - cur time: 2024-02-09T23:59:59.999 == next bar open time: 2024-02-10T00:00:00.000 == close pos time: 2024-02-15T00:00:00.000
2024-12-12 23:54:06,100 - INFO - pnl: 2024-02-09T23:59:59.999 143327.147554537 === -0.111%
2024-12-12 23:54:06,105 - DEBUG - cur time: 2024-02-10T23:59:59.999 == next bar open time: 2024-02-11T00:00:00.000 == close pos time: 2024-02-16T00:00:00.000
2024-12-12 23:54:06,105 - INFO - pnl: 2024-02-10T23:59:59.999 144029.7546172677 === 0.490%
2024-12-12 23:54:06,109 - DEBUG - cur time: 2024-02-11T23:59:59.999 == next bar open time: 2024-02-12T00:00:00.000 == close pos time: 2024-02-17T00:00:00.000
2024-12-12 23:54:06,109 - INFO - pnl: 2024-02-11T23:59:59.999 142275.23686129783 === -1.218%
2024-12-12 23:54:06,113 - DEBUG - cur time: 2024-02-12T23:59:59.999 == next bar open time: 2024-02-13T00:00:00.000 == close pos time: 2024-02-18T00:00:00.000
2024-12-12 23:54:06,125 - DEBUG - close time 2024-02-12T23:59:59.999 == vol_threshold: 12085843.0
2024-12-12 23:54:06,125 - DEBUG - 2024-02-12T23:59:59.999 == all trade symbol 226 == remain 158 after VOL filter
2024-12-12 23:54:06,125 - DEBUG - sorted_long_factors: shape: (158, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ MBLUSDT   ┆ -6.614817    ┆ 0    ┆ 157          │
│ ARKUSDT   ┆ -4.904662    ┆ 1    ┆ 156          │
│ ASTRUSDT  ┆ -4.144108    ┆ 2    ┆ 155          │
│ ARPAUSDT  ┆ -3.598918    ┆ 3    ┆ 154          │
│ ICXUSDT   ┆ -3.570245    ┆ 4    ┆ 153          │
│ STPTUSDT  ┆ -3.559632    ┆ 5    ┆ 152          │
│ AMBUSDT   ┆ -3.182429    ┆ 6    ┆ 151          │
│ SLPUSDT   ┆ -3.170723    ┆ 7    ┆ 150          │
│ ARKMUSDT  ┆ -3.111787    ┆ 8    ┆ 149          │
│ LUNA2USDT ┆ -2.929847    ┆ 9    ┆ 148          │
│ …         ┆ …            ┆ …    ┆ …            │
│ BATUSDT   ┆ 3.182882     ┆ 148  ┆ 9            │
│ XTZUSDT   ┆ 3.228814     ┆ 149  ┆ 8            │
│ IMXUSDT   ┆ 3.350266     ┆ 150  ┆ 7            │
│ CRVUSDT   ┆ 3.433118     ┆ 151  ┆ 6            │
│ KLAYUSDT  ┆ 3.815406     ┆ 152  ┆ 5            │
│ KASUSDT   ┆ 3.823602     ┆ 153  ┆ 4            │
│ CELOUSDT  ┆ 3.872505     ┆ 154  ┆ 3            │
│ FLMUSDT   ┆ 4.364629     ┆ 155  ┆ 2            │
│ KNCUSDT   ┆ 4.677589     ┆ 156  ┆ 1            │
│ IDUSDT    ┆ 5.557977     ┆ 157  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,134 - WARNING - 2024-02-12T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,134 - INFO - cur close time: 2024-02-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:06,134 - DEBUG - mean expected ret (mean factor): 0.04466878523647628
2024-12-12 23:54:06,139 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,139 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,139 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.013185    ┆ 0.03205     ┆ 0.11723     ┆ 0.0010807   ┆ … ┆ 0.02153 ┆ null   ┆ null    ┆ 0.3284  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,147 - DEBUG - update position: 2024-02-12T23:59:59.999 === diff_trading_value: 364874.3057261164 == cash: 143607.8423343523 
2024-12-12 23:54:06,147 - INFO - pnl: 2024-02-12T23:59:59.999 143607.8423343523 === 0.937%
2024-12-12 23:54:06,151 - DEBUG - cur time: 2024-02-13T23:59:59.999 == next bar open time: 2024-02-14T00:00:00.000 == close pos time: 2024-02-19T00:00:00.000
2024-12-12 23:54:06,151 - INFO - pnl: 2024-02-13T23:59:59.999 143294.07315504688 === -0.218%
2024-12-12 23:54:06,155 - DEBUG - cur time: 2024-02-14T23:59:59.999 == next bar open time: 2024-02-15T00:00:00.000 == close pos time: 2024-02-20T00:00:00.000
2024-12-12 23:54:06,155 - INFO - pnl: 2024-02-14T23:59:59.999 145657.02042110884 === 1.649%
2024-12-12 23:54:06,160 - DEBUG - cur time: 2024-02-15T23:59:59.999 == next bar open time: 2024-02-16T00:00:00.000 == close pos time: 2024-02-21T00:00:00.000
2024-12-12 23:54:06,160 - INFO - pnl: 2024-02-15T23:59:59.999 144222.59361410508 === -0.985%
2024-12-12 23:54:06,163 - DEBUG - cur time: 2024-02-16T23:59:59.999 == next bar open time: 2024-02-17T00:00:00.000 == close pos time: 2024-02-22T00:00:00.000
2024-12-12 23:54:06,163 - INFO - pnl: 2024-02-16T23:59:59.999 142104.57811273338 === -1.469%
2024-12-12 23:54:06,167 - DEBUG - cur time: 2024-02-17T23:59:59.999 == next bar open time: 2024-02-18T00:00:00.000 == close pos time: 2024-02-23T00:00:00.000
2024-12-12 23:54:06,176 - DEBUG - close time 2024-02-17T23:59:59.999 == vol_threshold: 13967003.6
2024-12-12 23:54:06,180 - DEBUG - 2024-02-17T23:59:59.999 == all trade symbol 227 == remain 159 after VOL filter
2024-12-12 23:54:06,180 - DEBUG - sorted_long_factors: shape: (159, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ XVGUSDT   ┆ -5.808235    ┆ 0    ┆ 158          │
│ ARPAUSDT  ┆ -5.023204    ┆ 1    ┆ 157          │
│ SNTUSDT   ┆ -4.094013    ┆ 2    ┆ 156          │
│ DUSKUSDT  ┆ -3.618668    ┆ 3    ┆ 155          │
│ KLAYUSDT  ┆ -3.561926    ┆ 4    ┆ 154          │
│ XLMUSDT   ┆ -3.316885    ┆ 5    ┆ 153          │
│ BELUSDT   ┆ -3.231309    ┆ 6    ┆ 152          │
│ TLMUSDT   ┆ -3.07359     ┆ 7    ┆ 151          │
│ MINAUSDT  ┆ -3.068249    ┆ 8    ┆ 150          │
│ ASTRUSDT  ┆ -2.941329    ┆ 9    ┆ 149          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ONEUSDT   ┆ 3.478038     ┆ 149  ┆ 9            │
│ CELRUSDT  ┆ 3.616923     ┆ 150  ┆ 8            │
│ OCEANUSDT ┆ 3.74361      ┆ 151  ┆ 7            │
│ ICXUSDT   ┆ 3.816697     ┆ 152  ┆ 6            │
│ CKBUSDT   ┆ 3.895243     ┆ 153  ┆ 5            │
│ JASMYUSDT ┆ 3.987709     ┆ 154  ┆ 4            │
│ IDUSDT    ┆ 4.618549     ┆ 155  ┆ 3            │
│ LPTUSDT   ┆ 5.016835     ┆ 156  ┆ 2            │
│ DGBUSDT   ┆ 5.056147     ┆ 157  ┆ 1            │
│ OXTUSDT   ┆ 5.641836     ┆ 158  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,184 - WARNING - 2024-02-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,184 - INFO - cur close time: 2024-02-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:06,184 - DEBUG - mean expected ret (mean factor): 0.09967811085054386
2024-12-12 23:54:06,189 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,189 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,192 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.012845    ┆ 0.03339     ┆ 0.1296      ┆ 0.0011883   ┆ … ┆ 0.02286 ┆ null   ┆ null    ┆ 0.3428  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,197 - DEBUG - update position: 2024-02-17T23:59:59.999 === diff_trading_value: 336489.93562165264 == cash: 140472.0964867483 
2024-12-12 23:54:06,197 - INFO - pnl: 2024-02-17T23:59:59.999 140472.0964867483 === -1.149%
2024-12-12 23:54:06,201 - DEBUG - cur time: 2024-02-18T23:59:59.999 == next bar open time: 2024-02-19T00:00:00.000 == close pos time: 2024-02-24T00:00:00.000
2024-12-12 23:54:06,201 - INFO - pnl: 2024-02-18T23:59:59.999 142209.21118313333 === 1.237%
2024-12-12 23:54:06,206 - DEBUG - cur time: 2024-02-19T23:59:59.999 == next bar open time: 2024-02-20T00:00:00.000 == close pos time: 2024-02-25T00:00:00.000
2024-12-12 23:54:06,208 - INFO - pnl: 2024-02-19T23:59:59.999 143728.42910871832 === 1.068%
2024-12-12 23:54:06,210 - DEBUG - cur time: 2024-02-20T23:59:59.999 == next bar open time: 2024-02-21T00:00:00.000 == close pos time: 2024-02-26T00:00:00.000
2024-12-12 23:54:06,212 - INFO - pnl: 2024-02-20T23:59:59.999 146312.9201183123 === 1.798%
2024-12-12 23:54:06,217 - DEBUG - cur time: 2024-02-21T23:59:59.999 == next bar open time: 2024-02-22T00:00:00.000 == close pos time: 2024-02-27T00:00:00.000
2024-12-12 23:54:06,220 - INFO - pnl: 2024-02-21T23:59:59.999 151868.76445624928 === 3.797%
2024-12-12 23:54:06,222 - DEBUG - cur time: 2024-02-22T23:59:59.999 == next bar open time: 2024-02-23T00:00:00.000 == close pos time: 2024-02-28T00:00:00.000
2024-12-12 23:54:06,234 - DEBUG - close time 2024-02-22T23:59:59.999 == vol_threshold: 15852851.92
2024-12-12 23:54:06,234 - DEBUG - 2024-02-22T23:59:59.999 == all trade symbol 228 == remain 159 after VOL filter
2024-12-12 23:54:06,234 - DEBUG - sorted_long_factors: shape: (159, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ONGUSDT   ┆ -4.701771    ┆ 0    ┆ 158          │
│ BATUSDT   ┆ -3.574364    ┆ 1    ┆ 157          │
│ ORBSUSDT  ┆ -2.742951    ┆ 2    ┆ 156          │
│ IOSTUSDT  ┆ -2.733729    ┆ 3    ┆ 155          │
│ THETAUSDT ┆ -2.653032    ┆ 4    ┆ 154          │
│ USTCUSDT  ┆ -2.43039     ┆ 5    ┆ 153          │
│ LUNA2USDT ┆ -2.427705    ┆ 6    ┆ 152          │
│ STGUSDT   ┆ -2.413356    ┆ 7    ┆ 151          │
│ POLYXUSDT ┆ -2.312874    ┆ 8    ┆ 150          │
│ MDTUSDT   ┆ -2.294609    ┆ 9    ┆ 149          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CRVUSDT   ┆ 2.780931     ┆ 149  ┆ 9            │
│ WAXPUSDT  ┆ 3.113547     ┆ 150  ┆ 8            │
│ CTSIUSDT  ┆ 3.252682     ┆ 151  ┆ 7            │
│ DARUSDT   ┆ 3.399574     ┆ 152  ┆ 6            │
│ JASMYUSDT ┆ 3.556174     ┆ 153  ┆ 5            │
│ NTRNUSDT  ┆ 3.822203     ┆ 154  ┆ 4            │
│ HFTUSDT   ┆ 3.962208     ┆ 155  ┆ 3            │
│ CTKUSDT   ┆ 4.241367     ┆ 156  ┆ 2            │
│ ZILUSDT   ┆ 5.446123     ┆ 157  ┆ 1            │
│ FLOWUSDT  ┆ 7.140176     ┆ 158  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,242 - INFO - cur close time: 2024-02-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:06,242 - DEBUG - mean expected ret (mean factor): 0.2867932956464782
2024-12-12 23:54:06,250 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,250 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,250 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.011664    ┆ 0.03365     ┆ 0.12141     ┆ 0.0012105   ┆ … ┆ 0.02339 ┆ null   ┆ null    ┆ 0.3528  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,255 - DEBUG - update position: 2024-02-22T23:59:59.999 === diff_trading_value: 371899.28607117606 == cash: 152671.64665063375 
2024-12-12 23:54:06,255 - INFO - pnl: 2024-02-22T23:59:59.999 152671.64665063375 === 0.529%
2024-12-12 23:54:06,259 - DEBUG - cur time: 2024-02-23T23:59:59.999 == next bar open time: 2024-02-24T00:00:00.000 == close pos time: 2024-02-29T00:00:00.000
2024-12-12 23:54:06,259 - INFO - pnl: 2024-02-23T23:59:59.999 151517.34328066852 === -0.756%
2024-12-12 23:54:06,263 - DEBUG - cur time: 2024-02-24T23:59:59.999 == next bar open time: 2024-02-25T00:00:00.000 == close pos time: 2024-03-01T00:00:00.000
2024-12-12 23:54:06,263 - INFO - pnl: 2024-02-24T23:59:59.999 153453.21364353903 === 1.278%
2024-12-12 23:54:06,269 - DEBUG - cur time: 2024-02-25T23:59:59.999 == next bar open time: 2024-02-26T00:00:00.000 == close pos time: 2024-03-02T00:00:00.000
2024-12-12 23:54:06,271 - INFO - pnl: 2024-02-25T23:59:59.999 151814.42861546174 === -1.068%
2024-12-12 23:54:06,271 - DEBUG - cur time: 2024-02-26T23:59:59.999 == next bar open time: 2024-02-27T00:00:00.000 == close pos time: 2024-03-03T00:00:00.000
2024-12-12 23:54:06,275 - INFO - pnl: 2024-02-26T23:59:59.999 152990.39509297026 === 0.775%
2024-12-12 23:54:06,280 - DEBUG - cur time: 2024-02-27T23:59:59.999 == next bar open time: 2024-02-28T00:00:00.000 == close pos time: 2024-03-04T00:00:00.000
2024-12-12 23:54:06,292 - DEBUG - close time 2024-02-27T23:59:59.999 == vol_threshold: 16033893.5
2024-12-12 23:54:06,292 - DEBUG - 2024-02-27T23:59:59.999 == all trade symbol 231 == remain 161 after VOL filter
2024-12-12 23:54:06,295 - DEBUG - sorted_long_factors: shape: (161, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ STPTUSDT     ┆ -2.919248    ┆ 0    ┆ 160          │
│ FILUSDT      ┆ -2.810054    ┆ 1    ┆ 159          │
│ 1000LUNCUSDT ┆ -2.793381    ┆ 2    ┆ 158          │
│ RSRUSDT      ┆ -2.74299     ┆ 3    ┆ 157          │
│ 1000RATSUSDT ┆ -2.505209    ┆ 4    ┆ 156          │
│ BICOUSDT     ┆ -2.299334    ┆ 5    ┆ 155          │
│ LITUSDT      ┆ -2.249995    ┆ 6    ┆ 154          │
│ OXTUSDT      ┆ -2.240578    ┆ 7    ┆ 153          │
│ SNTUSDT      ┆ -2.185471    ┆ 8    ┆ 152          │
│ LOOMUSDT     ┆ -2.155715    ┆ 9    ┆ 151          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DOGEUSDT     ┆ 2.378958     ┆ 151  ┆ 9            │
│ CKBUSDT      ┆ 2.381577     ┆ 152  ┆ 8            │
│ 1000XECUSDT  ┆ 2.7008       ┆ 153  ┆ 7            │
│ SUPERUSDT    ┆ 3.088028     ┆ 154  ┆ 6            │
│ 1000PEPEUSDT ┆ 3.192463     ┆ 155  ┆ 5            │
│ BNXUSDT      ┆ 3.239724     ┆ 156  ┆ 4            │
│ XVGUSDT      ┆ 3.47833      ┆ 157  ┆ 3            │
│ KLAYUSDT     ┆ 4.175563     ┆ 158  ┆ 2            │
│ TRXUSDT      ┆ 4.507473     ┆ 159  ┆ 1            │
│ BEAMXUSDT    ┆ 4.668701     ┆ 160  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,300 - WARNING - 2024-02-27T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,300 - INFO - cur close time: 2024-02-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:06,300 - DEBUG - mean expected ret (mean factor): 0.19273099657671264
2024-12-12 23:54:06,304 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,304 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 5000.0      ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,304 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.014885    ┆ 0.05097     ┆ 0.13141     ┆ 0.0026636   ┆ … ┆ 0.02624 ┆ null   ┆ null    ┆ 0.3801  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,310 - DEBUG - update position: 2024-02-27T23:59:59.999 === diff_trading_value: 379587.3900686216 == cash: 150334.65480948653 
2024-12-12 23:54:06,315 - INFO - pnl: 2024-02-27T23:59:59.999 150334.65480948653 === -1.736%
2024-12-12 23:54:06,320 - DEBUG - cur time: 2024-02-28T23:59:59.999 == next bar open time: 2024-02-29T00:00:00.000 == close pos time: 2024-03-05T00:00:00.000
2024-12-12 23:54:06,324 - INFO - pnl: 2024-02-28T23:59:59.999 153490.4780755692 === 2.099%
2024-12-12 23:54:06,332 - DEBUG - cur time: 2024-02-29T23:59:59.999 == next bar open time: 2024-03-01T00:00:00.000 == close pos time: 2024-03-06T00:00:00.000
2024-12-12 23:54:06,332 - INFO - pnl: 2024-02-29T23:59:59.999 149201.1584522189 === -2.795%
2024-12-12 23:54:06,341 - DEBUG - cur time: 2024-03-01T23:59:59.999 == next bar open time: 2024-03-02T00:00:00.000 == close pos time: 2024-03-07T00:00:00.000
2024-12-12 23:54:06,341 - INFO - pnl: 2024-03-01T23:59:59.999 149102.21026019714 === -0.066%
2024-12-12 23:54:06,345 - DEBUG - cur time: 2024-03-02T23:59:59.999 == next bar open time: 2024-03-03T00:00:00.000 == close pos time: 2024-03-08T00:00:00.000
2024-12-12 23:54:06,345 - INFO - pnl: 2024-03-02T23:59:59.999 144711.88174307597 === -2.945%
2024-12-12 23:54:06,349 - DEBUG - cur time: 2024-03-03T23:59:59.999 == next bar open time: 2024-03-04T00:00:00.000 == close pos time: 2024-03-09T00:00:00.000
2024-12-12 23:54:06,362 - DEBUG - close time 2024-03-03T23:59:59.999 == vol_threshold: 21626245.0
2024-12-12 23:54:06,362 - DEBUG - 2024-03-03T23:59:59.999 == all trade symbol 231 == remain 161 after VOL filter
2024-12-12 23:54:06,366 - DEBUG - sorted_long_factors: shape: (161, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ YGGUSDT       ┆ -4.41302     ┆ 0    ┆ 160          │
│ BICOUSDT      ┆ -3.995287    ┆ 1    ┆ 159          │
│ CHRUSDT       ┆ -3.959367    ┆ 2    ┆ 158          │
│ STGUSDT       ┆ -3.829964    ┆ 3    ┆ 157          │
│ FLMUSDT       ┆ -3.609478    ┆ 4    ┆ 156          │
│ WAXPUSDT      ┆ -3.602631    ┆ 5    ┆ 155          │
│ XRPUSDT       ┆ -3.28249     ┆ 6    ┆ 154          │
│ APTUSDT       ┆ -3.2109      ┆ 7    ┆ 153          │
│ KEYUSDT       ┆ -3.13931     ┆ 8    ┆ 152          │
│ APEUSDT       ┆ -3.054628    ┆ 9    ┆ 151          │
│ …             ┆ …            ┆ …    ┆ …            │
│ STRAXUSDT     ┆ 3.481315     ┆ 151  ┆ 9            │
│ 1INCHUSDT     ┆ 3.502025     ┆ 152  ┆ 8            │
│ SXPUSDT       ┆ 3.595874     ┆ 153  ┆ 7            │
│ BEAMXUSDT     ┆ 3.685826     ┆ 154  ┆ 6            │
│ XEMUSDT       ┆ 3.717677     ┆ 155  ┆ 5            │
│ SNTUSDT       ┆ 3.795124     ┆ 156  ┆ 4            │
│ SLPUSDT       ┆ 4.225073     ┆ 157  ┆ 3            │
│ OGNUSDT       ┆ 4.438128     ┆ 158  ┆ 2            │
│ FTMUSDT       ┆ 4.544598     ┆ 159  ┆ 1            │
│ 1000FLOKIUSDT ┆ 5.029002     ┆ 160  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,370 - WARNING - 2024-03-03T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,374 - INFO - cur close time: 2024-03-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:06,374 - DEBUG - mean expected ret (mean factor): 0.17345806858983395
2024-12-12 23:54:06,378 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,378 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 5000.0      ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,378 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.027227    ┆ 0.14651     ┆ 0.18078     ┆ 0.0059289   ┆ … ┆ 0.03028 ┆ null   ┆ null    ┆ 0.4202  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,382 - DEBUG - update position: 2024-03-03T23:59:59.999 === diff_trading_value: 368103.98286850494 == cash: 146054.15599342776 
2024-12-12 23:54:06,386 - INFO - pnl: 2024-03-03T23:59:59.999 146054.15599342776 === 0.928%
2024-12-12 23:54:06,390 - DEBUG - cur time: 2024-03-04T23:59:59.999 == next bar open time: 2024-03-05T00:00:00.000 == close pos time: 2024-03-10T00:00:00.000
2024-12-12 23:54:06,390 - INFO - pnl: 2024-03-04T23:59:59.999 146983.96866411538 === 0.637%
2024-12-12 23:54:06,392 - DEBUG - cur time: 2024-03-05T23:59:59.999 == next bar open time: 2024-03-06T00:00:00.000 == close pos time: 2024-03-11T00:00:00.000
2024-12-12 23:54:06,392 - INFO - pnl: 2024-03-05T23:59:59.999 146118.8223314918 === -0.589%
2024-12-12 23:54:06,400 - DEBUG - cur time: 2024-03-06T23:59:59.999 == next bar open time: 2024-03-07T00:00:00.000 == close pos time: 2024-03-12T00:00:00.000
2024-12-12 23:54:06,400 - INFO - pnl: 2024-03-06T23:59:59.999 148384.30366942994 === 1.550%
2024-12-12 23:54:06,409 - DEBUG - cur time: 2024-03-07T23:59:59.999 == next bar open time: 2024-03-08T00:00:00.000 == close pos time: 2024-03-13T00:00:00.000
2024-12-12 23:54:06,410 - INFO - pnl: 2024-03-07T23:59:59.999 149621.87827218423 === 0.834%
2024-12-12 23:54:06,414 - DEBUG - cur time: 2024-03-08T23:59:59.999 == next bar open time: 2024-03-09T00:00:00.000 == close pos time: 2024-03-14T00:00:00.000
2024-12-12 23:54:06,426 - DEBUG - close time 2024-03-08T23:59:59.999 == vol_threshold: 18281207.4
2024-12-12 23:54:06,426 - DEBUG - 2024-03-08T23:59:59.999 == all trade symbol 233 == remain 163 after VOL filter
2024-12-12 23:54:06,429 - DEBUG - sorted_long_factors: shape: (163, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ DODOXUSDT     ┆ -4.852089    ┆ 0    ┆ 162          │
│ KEYUSDT       ┆ -4.73047     ┆ 1    ┆ 161          │
│ SNTUSDT       ┆ -4.16115     ┆ 2    ┆ 160          │
│ CHRUSDT       ┆ -4.142445    ┆ 3    ┆ 159          │
│ NTRNUSDT      ┆ -3.443734    ┆ 4    ┆ 158          │
│ MINAUSDT      ┆ -3.302423    ┆ 5    ┆ 157          │
│ NFPUSDT       ┆ -3.219249    ┆ 6    ┆ 156          │
│ SXPUSDT       ┆ -2.985863    ┆ 7    ┆ 155          │
│ TRUUSDT       ┆ -2.887287    ┆ 8    ┆ 154          │
│ 1000RATSUSDT  ┆ -2.878788    ┆ 9    ┆ 153          │
│ …             ┆ …            ┆ …    ┆ …            │
│ TUSDT         ┆ 2.741467     ┆ 153  ┆ 9            │
│ PHBUSDT       ┆ 3.046373     ┆ 154  ┆ 8            │
│ ARKUSDT       ┆ 3.292838     ┆ 155  ┆ 7            │
│ CRVUSDT       ┆ 3.383174     ┆ 156  ┆ 6            │
│ ALGOUSDT      ┆ 3.478614     ┆ 157  ┆ 5            │
│ STPTUSDT      ┆ 3.658716     ┆ 158  ┆ 4            │
│ 1000FLOKIUSDT ┆ 3.672632     ┆ 159  ┆ 3            │
│ NKNUSDT       ┆ 4.002178     ┆ 160  ┆ 2            │
│ 1INCHUSDT     ┆ 4.087606     ┆ 161  ┆ 1            │
│ KLAYUSDT      ┆ 6.525165     ┆ 162  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,434 - WARNING - 2024-03-08T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,434 - INFO - cur close time: 2024-03-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:06,434 - DEBUG - mean expected ret (mean factor): 0.04173641278472649
2024-12-12 23:54:06,440 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,440 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,440 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.031768    ┆ 0.23232     ┆ 0.19463     ┆ 0.0090253   ┆ … ┆ 0.0349  ┆ null   ┆ null    ┆ 0.5576  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,446 - DEBUG - update position: 2024-03-08T23:59:59.999 === diff_trading_value: 329173.6225702482 == cash: 148864.54711463282 
2024-12-12 23:54:06,446 - INFO - pnl: 2024-03-08T23:59:59.999 148864.54711463282 === -0.506%
2024-12-12 23:54:06,450 - DEBUG - cur time: 2024-03-09T23:59:59.999 == next bar open time: 2024-03-10T00:00:00.000 == close pos time: 2024-03-15T00:00:00.000
2024-12-12 23:54:06,450 - INFO - pnl: 2024-03-09T23:59:59.999 146837.55902992262 === -1.362%
2024-12-12 23:54:06,455 - DEBUG - cur time: 2024-03-10T23:59:59.999 == next bar open time: 2024-03-11T00:00:00.000 == close pos time: 2024-03-16T00:00:00.000
2024-12-12 23:54:06,460 - INFO - pnl: 2024-03-10T23:59:59.999 147412.11741743537 === 0.391%
2024-12-12 23:54:06,463 - DEBUG - cur time: 2024-03-11T23:59:59.999 == next bar open time: 2024-03-12T00:00:00.000 == close pos time: 2024-03-17T00:00:00.000
2024-12-12 23:54:06,463 - INFO - pnl: 2024-03-11T23:59:59.999 148098.59744988897 === 0.466%
2024-12-12 23:54:06,469 - DEBUG - cur time: 2024-03-12T23:59:59.999 == next bar open time: 2024-03-13T00:00:00.000 == close pos time: 2024-03-18T00:00:00.000
2024-12-12 23:54:06,471 - INFO - pnl: 2024-03-12T23:59:59.999 149922.96357644346 === 1.232%
2024-12-12 23:54:06,475 - DEBUG - cur time: 2024-03-13T23:59:59.999 == next bar open time: 2024-03-14T00:00:00.000 == close pos time: 2024-03-19T00:00:00.000
2024-12-12 23:54:06,485 - DEBUG - close time 2024-03-13T23:59:59.999 == vol_threshold: 16507470.765999999
2024-12-12 23:54:06,485 - DEBUG - 2024-03-13T23:59:59.999 == all trade symbol 232 == remain 162 after VOL filter
2024-12-12 23:54:06,488 - DEBUG - sorted_long_factors: shape: (162, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ MBLUSDT   ┆ -5.310829    ┆ 0    ┆ 161          │
│ TLMUSDT   ┆ -4.847756    ┆ 1    ┆ 160          │
│ BELUSDT   ┆ -4.783206    ┆ 2    ┆ 159          │
│ STXUSDT   ┆ -3.743052    ┆ 3    ┆ 158          │
│ SFPUSDT   ┆ -3.676473    ┆ 4    ┆ 157          │
│ TRUUSDT   ┆ -3.60288     ┆ 5    ┆ 156          │
│ STPTUSDT  ┆ -3.438083    ┆ 6    ┆ 155          │
│ NFPUSDT   ┆ -3.431033    ┆ 7    ┆ 154          │
│ LEVERUSDT ┆ -3.362929    ┆ 8    ┆ 153          │
│ ONGUSDT   ┆ -3.200203    ┆ 9    ┆ 152          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XTZUSDT   ┆ 3.716064     ┆ 152  ┆ 9            │
│ CTSIUSDT  ┆ 3.826505     ┆ 153  ┆ 8            │
│ DUSKUSDT  ┆ 3.996236     ┆ 154  ┆ 7            │
│ SEIUSDT   ┆ 4.134988     ┆ 155  ┆ 6            │
│ IMXUSDT   ┆ 4.275525     ┆ 156  ┆ 5            │
│ OGNUSDT   ┆ 4.479127     ┆ 157  ┆ 4            │
│ COTIUSDT  ┆ 4.802273     ┆ 158  ┆ 3            │
│ ZRXUSDT   ┆ 4.94366      ┆ 159  ┆ 2            │
│ IDUSDT    ┆ 5.6157       ┆ 160  ┆ 1            │
│ ONTUSDT   ┆ 6.032609     ┆ 161  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,493 - WARNING - 2024-03-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,493 - INFO - cur close time: 2024-03-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:06,493 - DEBUG - mean expected ret (mean factor): 0.01080119086621006
2024-12-12 23:54:06,497 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,497 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,497 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.03192     ┆ 0.26886     ┆ 0.18291     ┆ 0.0090412   ┆ … ┆ 0.04054 ┆ null   ┆ null    ┆ 1.0997  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,501 - DEBUG - update position: 2024-03-13T23:59:59.999 === diff_trading_value: 343968.7732190321 == cash: 150894.01720471133 
2024-12-12 23:54:06,505 - INFO - pnl: 2024-03-13T23:59:59.999 150894.01720471133 === 0.648%
2024-12-12 23:54:06,505 - DEBUG - cur time: 2024-03-14T23:59:59.999 == next bar open time: 2024-03-15T00:00:00.000 == close pos time: 2024-03-20T00:00:00.000
2024-12-12 23:54:06,510 - INFO - pnl: 2024-03-14T23:59:59.999 153029.4142838608 === 1.415%
2024-12-12 23:54:06,513 - DEBUG - cur time: 2024-03-15T23:59:59.999 == next bar open time: 2024-03-16T00:00:00.000 == close pos time: 2024-03-21T00:00:00.000
2024-12-12 23:54:06,513 - INFO - pnl: 2024-03-15T23:59:59.999 153640.34752748482 === 0.399%
2024-12-12 23:54:06,517 - DEBUG - cur time: 2024-03-16T23:59:59.999 == next bar open time: 2024-03-17T00:00:00.000 == close pos time: 2024-03-22T00:00:00.000
2024-12-12 23:54:06,517 - INFO - pnl: 2024-03-16T23:59:59.999 155151.66010557913 === 0.984%
2024-12-12 23:54:06,522 - DEBUG - cur time: 2024-03-17T23:59:59.999 == next bar open time: 2024-03-18T00:00:00.000 == close pos time: 2024-03-23T00:00:00.000
2024-12-12 23:54:06,522 - INFO - pnl: 2024-03-17T23:59:59.999 155953.86850133335 === 0.517%
2024-12-12 23:54:06,525 - DEBUG - cur time: 2024-03-18T23:59:59.999 == next bar open time: 2024-03-19T00:00:00.000 == close pos time: 2024-03-24T00:00:00.000
2024-12-12 23:54:06,535 - DEBUG - close time 2024-03-18T23:59:59.999 == vol_threshold: 15181868.2
2024-12-12 23:54:06,535 - DEBUG - 2024-03-18T23:59:59.999 == all trade symbol 232 == remain 162 after VOL filter
2024-12-12 23:54:06,539 - DEBUG - sorted_long_factors: shape: (162, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ TOKENUSDT   ┆ -5.401381    ┆ 0    ┆ 161          │
│ NFPUSDT     ┆ -4.04349     ┆ 1    ┆ 160          │
│ LEVERUSDT   ┆ -3.539872    ┆ 2    ┆ 159          │
│ C98USDT     ┆ -2.777498    ┆ 3    ┆ 158          │
│ BEAMXUSDT   ┆ -2.727013    ┆ 4    ┆ 157          │
│ BICOUSDT    ┆ -2.651592    ┆ 5    ┆ 156          │
│ BIGTIMEUSDT ┆ -2.639725    ┆ 6    ┆ 155          │
│ AGIXUSDT    ┆ -2.439269    ┆ 7    ┆ 154          │
│ DOGEUSDT    ┆ -2.438137    ┆ 8    ┆ 153          │
│ ROSEUSDT    ┆ -2.424465    ┆ 9    ┆ 152          │
│ …           ┆ …            ┆ …    ┆ …            │
│ ZRXUSDT     ┆ 3.519792     ┆ 152  ┆ 9            │
│ STPTUSDT    ┆ 3.590537     ┆ 153  ┆ 8            │
│ RENUSDT     ┆ 3.768884     ┆ 154  ┆ 7            │
│ NKNUSDT     ┆ 3.949965     ┆ 155  ┆ 6            │
│ FLOWUSDT    ┆ 4.006476     ┆ 156  ┆ 5            │
│ STMXUSDT    ┆ 4.139365     ┆ 157  ┆ 4            │
│ KEYUSDT     ┆ 4.793444     ┆ 158  ┆ 3            │
│ MBLUSDT     ┆ 4.978271     ┆ 159  ┆ 2            │
│ XTZUSDT     ┆ 5.85728      ┆ 160  ┆ 1            │
│ ONTUSDT     ┆ 6.383219     ┆ 161  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,543 - WARNING - 2024-03-18T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,543 - INFO - cur close time: 2024-03-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:06,543 - DEBUG - mean expected ret (mean factor): 0.34375501306131095
2024-12-12 23:54:06,547 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,547 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,547 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023598    ┆ 0.19294     ┆ 0.14091     ┆ 0.0068171   ┆ … ┆ 0.03181 ┆ null   ┆ null    ┆ 1.1823  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,551 - DEBUG - update position: 2024-03-18T23:59:59.999 === diff_trading_value: 289470.65747252526 == cash: 155721.6571442363 
2024-12-12 23:54:06,555 - INFO - pnl: 2024-03-18T23:59:59.999 155721.6571442363 === -0.149%
2024-12-12 23:54:06,556 - DEBUG - cur time: 2024-03-19T23:59:59.999 == next bar open time: 2024-03-20T00:00:00.000 == close pos time: 2024-03-25T00:00:00.000
2024-12-12 23:54:06,560 - INFO - pnl: 2024-03-19T23:59:59.999 156728.29827345113 === 0.646%
2024-12-12 23:54:06,563 - DEBUG - cur time: 2024-03-20T23:59:59.999 == next bar open time: 2024-03-21T00:00:00.000 == close pos time: 2024-03-26T00:00:00.000
2024-12-12 23:54:06,563 - INFO - pnl: 2024-03-20T23:59:59.999 153762.22961398354 === -1.892%
2024-12-12 23:54:06,567 - DEBUG - cur time: 2024-03-21T23:59:59.999 == next bar open time: 2024-03-22T00:00:00.000 == close pos time: 2024-03-27T00:00:00.000
2024-12-12 23:54:06,567 - INFO - pnl: 2024-03-21T23:59:59.999 151264.99093927283 === -1.624%
2024-12-12 23:54:06,572 - DEBUG - cur time: 2024-03-22T23:59:59.999 == next bar open time: 2024-03-23T00:00:00.000 == close pos time: 2024-03-28T00:00:00.000
2024-12-12 23:54:06,572 - INFO - pnl: 2024-03-22T23:59:59.999 151975.36436772143 === 0.470%
2024-12-12 23:54:06,576 - DEBUG - cur time: 2024-03-23T23:59:59.999 == next bar open time: 2024-03-24T00:00:00.000 == close pos time: 2024-03-29T00:00:00.000
2024-12-12 23:54:06,589 - DEBUG - close time 2024-03-23T23:59:59.999 == vol_threshold: 11389872.36
2024-12-12 23:54:06,589 - DEBUG - 2024-03-23T23:59:59.999 == all trade symbol 232 == remain 162 after VOL filter
2024-12-12 23:54:06,592 - DEBUG - sorted_long_factors: shape: (162, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ OCEANUSDT    ┆ -3.745684    ┆ 0    ┆ 161          │
│ CHZUSDT      ┆ -3.737435    ┆ 1    ┆ 160          │
│ WAVESUSDT    ┆ -3.714354    ┆ 2    ┆ 159          │
│ NFPUSDT      ┆ -3.586563    ┆ 3    ┆ 158          │
│ 1000RATSUSDT ┆ -3.409176    ┆ 4    ┆ 157          │
│ C98USDT      ┆ -3.36189     ┆ 5    ┆ 156          │
│ DOTUSDT      ┆ -3.333223    ┆ 6    ┆ 155          │
│ IOTAUSDT     ┆ -2.939368    ┆ 7    ┆ 154          │
│ ORBSUSDT     ┆ -2.892597    ┆ 8    ┆ 153          │
│ JOEUSDT      ┆ -2.85114     ┆ 9    ┆ 152          │
│ …            ┆ …            ┆ …    ┆ …            │
│ STORJUSDT    ┆ 3.699305     ┆ 152  ┆ 9            │
│ CHRUSDT      ┆ 4.00385      ┆ 153  ┆ 8            │
│ ONEUSDT      ┆ 4.041713     ┆ 154  ┆ 7            │
│ RENUSDT      ┆ 4.495894     ┆ 155  ┆ 6            │
│ BLZUSDT      ┆ 4.782331     ┆ 156  ┆ 5            │
│ XEMUSDT      ┆ 5.245605     ┆ 157  ┆ 4            │
│ RVNUSDT      ┆ 5.58302      ┆ 158  ┆ 3            │
│ OXTUSDT      ┆ 5.724154     ┆ 159  ┆ 2            │
│ DGBUSDT      ┆ 6.207614     ┆ 160  ┆ 1            │
│ STMXUSDT     ┆ 7.96743      ┆ 161  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,600 - WARNING - 2024-03-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,600 - INFO - cur close time: 2024-03-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:06,600 - DEBUG - mean expected ret (mean factor): 0.20593963967472417
2024-12-12 23:54:06,605 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,605 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,605 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022022    ┆ 0.22865     ┆ 0.15329     ┆ 0.0073248   ┆ … ┆ 0.03287 ┆ null   ┆ null    ┆ 0.8537  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,610 - DEBUG - update position: 2024-03-23T23:59:59.999 === diff_trading_value: 335967.5242615277 == cash: 147930.73853897981 
2024-12-12 23:54:06,613 - INFO - pnl: 2024-03-23T23:59:59.999 147930.73853897981 === -2.661%
2024-12-12 23:54:06,617 - DEBUG - cur time: 2024-03-24T23:59:59.999 == next bar open time: 2024-03-25T00:00:00.000 == close pos time: 2024-03-30T00:00:00.000
2024-12-12 23:54:06,619 - INFO - pnl: 2024-03-24T23:59:59.999 147510.11488253478 === -0.284%
2024-12-12 23:54:06,624 - DEBUG - cur time: 2024-03-25T23:59:59.999 == next bar open time: 2024-03-26T00:00:00.000 == close pos time: 2024-03-31T00:00:00.000
2024-12-12 23:54:06,626 - INFO - pnl: 2024-03-25T23:59:59.999 141678.77775814355 === -3.953%
2024-12-12 23:54:06,630 - DEBUG - cur time: 2024-03-26T23:59:59.999 == next bar open time: 2024-03-27T00:00:00.000 == close pos time: 2024-04-01T00:00:00.000
2024-12-12 23:54:06,630 - INFO - pnl: 2024-03-26T23:59:59.999 144632.41283802493 === 2.085%
2024-12-12 23:54:06,634 - DEBUG - cur time: 2024-03-27T23:59:59.999 == next bar open time: 2024-03-28T00:00:00.000 == close pos time: 2024-04-02T00:00:00.000
2024-12-12 23:54:06,634 - INFO - pnl: 2024-03-27T23:59:59.999 142502.34239103954 === -1.473%
2024-12-12 23:54:06,640 - DEBUG - cur time: 2024-03-28T23:59:59.999 == next bar open time: 2024-03-29T00:00:00.000 == close pos time: 2024-04-03T00:00:00.000
2024-12-12 23:54:06,654 - DEBUG - close time 2024-03-28T23:59:59.999 == vol_threshold: 13382447.72
2024-12-12 23:54:06,658 - DEBUG - 2024-03-28T23:59:59.999 == all trade symbol 229 == remain 160 after VOL filter
2024-12-12 23:54:06,659 - DEBUG - sorted_long_factors: shape: (160, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ KEYUSDT   ┆ -6.166124    ┆ 0    ┆ 159          │
│ ARKMUSDT  ┆ -5.977096    ┆ 1    ┆ 158          │
│ EDUUSDT   ┆ -3.912488    ┆ 2    ┆ 157          │
│ NFPUSDT   ┆ -3.783184    ┆ 3    ┆ 156          │
│ WLDUSDT   ┆ -3.739583    ┆ 4    ┆ 155          │
│ MBLUSDT   ┆ -3.328965    ┆ 5    ┆ 154          │
│ ONGUSDT   ┆ -3.158695    ┆ 6    ┆ 153          │
│ ZRXUSDT   ┆ -2.668599    ┆ 7    ┆ 152          │
│ GRTUSDT   ┆ -2.649223    ┆ 8    ┆ 151          │
│ XAIUSDT   ┆ -2.633668    ┆ 9    ┆ 150          │
│ …         ┆ …            ┆ …    ┆ …            │
│ RVNUSDT   ┆ 3.323245     ┆ 150  ┆ 9            │
│ CTSIUSDT  ┆ 3.537575     ┆ 151  ┆ 8            │
│ OXTUSDT   ┆ 3.65549      ┆ 152  ┆ 7            │
│ USTCUSDT  ┆ 3.906374     ┆ 153  ┆ 6            │
│ BATUSDT   ┆ 4.026936     ┆ 154  ┆ 5            │
│ EOSUSDT   ┆ 4.140554     ┆ 155  ┆ 4            │
│ TUSDT     ┆ 4.638823     ┆ 156  ┆ 3            │
│ SPELLUSDT ┆ 5.470699     ┆ 157  ┆ 2            │
│ KASUSDT   ┆ 7.250391     ┆ 158  ┆ 1            │
│ STGUSDT   ┆ 8.908027     ┆ 159  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,666 - WARNING - 2024-03-28T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,666 - INFO - cur close time: 2024-03-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:06,666 - DEBUG - mean expected ret (mean factor): 0.24450263023188593
2024-12-12 23:54:06,670 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,670 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬─────────┬──────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT  │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---      │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64      │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆         ┆          │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪═════════╪══════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ -10000.0 │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴─────────┴──────────┘
2024-12-12 23:54:06,670 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028402    ┆ 0.25239     ┆ 0.16038     ┆ 0.0080362   ┆ … ┆ 0.03733 ┆ null   ┆ null    ┆ 1.0475  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,681 - DEBUG - update position: 2024-03-28T23:59:59.999 === diff_trading_value: 359729.69759713573 == cash: 143232.27967944046 
2024-12-12 23:54:06,682 - INFO - pnl: 2024-03-28T23:59:59.999 143232.27967944046 === 0.512%
2024-12-12 23:54:06,686 - DEBUG - cur time: 2024-03-29T23:59:59.999 == next bar open time: 2024-03-30T00:00:00.000 == close pos time: 2024-04-04T00:00:00.000
2024-12-12 23:54:06,686 - INFO - pnl: 2024-03-29T23:59:59.999 146304.62764681986 === 2.145%
2024-12-12 23:54:06,694 - DEBUG - cur time: 2024-03-30T23:59:59.999 == next bar open time: 2024-03-31T00:00:00.000 == close pos time: 2024-04-05T00:00:00.000
2024-12-12 23:54:06,694 - INFO - pnl: 2024-03-30T23:59:59.999 149799.0916198237 === 2.388%
2024-12-12 23:54:06,700 - DEBUG - cur time: 2024-03-31T23:59:59.999 == next bar open time: 2024-04-01T00:00:00.000 == close pos time: 2024-04-06T00:00:00.000
2024-12-12 23:54:06,703 - INFO - pnl: 2024-03-31T23:59:59.999 150309.9725373957 === 0.341%
2024-12-12 23:54:06,710 - DEBUG - cur time: 2024-04-01T23:59:59.999 == next bar open time: 2024-04-02T00:00:00.000 == close pos time: 2024-04-07T00:00:00.000
2024-12-12 23:54:06,711 - INFO - pnl: 2024-04-01T23:59:59.999 151278.96451932788 === 0.645%
2024-12-12 23:54:06,715 - DEBUG - cur time: 2024-04-02T23:59:59.999 == next bar open time: 2024-04-03T00:00:00.000 == close pos time: 2024-04-08T00:00:00.000
2024-12-12 23:54:06,730 - DEBUG - close time 2024-04-02T23:59:59.999 == vol_threshold: 16617211.669999998
2024-12-12 23:54:06,730 - DEBUG - 2024-04-02T23:59:59.999 == all trade symbol 232 == remain 162 after VOL filter
2024-12-12 23:54:06,730 - DEBUG - sorted_long_factors: shape: (162, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ LDOUSDT     ┆ -5.124446    ┆ 0    ┆ 161          │
│ WLDUSDT     ┆ -4.265055    ┆ 1    ┆ 160          │
│ NFPUSDT     ┆ -3.807348    ┆ 2    ┆ 159          │
│ RIFUSDT     ┆ -3.676971    ┆ 3    ┆ 158          │
│ BIGTIMEUSDT ┆ -3.331346    ┆ 4    ┆ 157          │
│ MDTUSDT     ┆ -3.222107    ┆ 5    ┆ 156          │
│ ONDOUSDT    ┆ -3.142802    ┆ 6    ┆ 155          │
│ GLMRUSDT    ┆ -3.124685    ┆ 7    ┆ 154          │
│ AGIXUSDT    ┆ -3.069946    ┆ 8    ┆ 153          │
│ AIUSDT      ┆ -3.05838     ┆ 9    ┆ 152          │
│ …           ┆ …            ┆ …    ┆ …            │
│ RVNUSDT     ┆ 3.079898     ┆ 152  ┆ 9            │
│ PENDLEUSDT  ┆ 3.134114     ┆ 153  ┆ 8            │
│ STMXUSDT    ┆ 3.146012     ┆ 154  ┆ 7            │
│ TUSDT       ┆ 3.444757     ┆ 155  ┆ 6            │
│ HFTUSDT     ┆ 3.891514     ┆ 156  ┆ 5            │
│ FLOWUSDT    ┆ 3.976069     ┆ 157  ┆ 4            │
│ XTZUSDT     ┆ 4.036885     ┆ 158  ┆ 3            │
│ XEMUSDT     ┆ 4.257225     ┆ 159  ┆ 2            │
│ BNXUSDT     ┆ 4.880902     ┆ 160  ┆ 1            │
│ XVGUSDT     ┆ 7.894894     ┆ 161  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,740 - WARNING - 2024-04-02T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,740 - INFO - cur close time: 2024-04-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:06,740 - DEBUG - mean expected ret (mean factor): 0.13655961793700527
2024-12-12 23:54:06,742 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,742 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,746 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022675    ┆ 0.2095      ┆ 0.13708     ┆ 0.0072585   ┆ … ┆ 0.03259 ┆ null   ┆ null    ┆ 0.6554  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,753 - DEBUG - update position: 2024-04-02T23:59:59.999 === diff_trading_value: 301396.4026662234 == cash: 151099.30438496076 
2024-12-12 23:54:06,754 - INFO - pnl: 2024-04-02T23:59:59.999 151099.30438496076 === -0.119%
2024-12-12 23:54:06,760 - DEBUG - cur time: 2024-04-03T23:59:59.999 == next bar open time: 2024-04-04T00:00:00.000 == close pos time: 2024-04-09T00:00:00.000
2024-12-12 23:54:06,760 - INFO - pnl: 2024-04-03T23:59:59.999 151520.0429170254 === 0.278%
2024-12-12 23:54:06,763 - DEBUG - cur time: 2024-04-04T23:59:59.999 == next bar open time: 2024-04-05T00:00:00.000 == close pos time: 2024-04-10T00:00:00.000
2024-12-12 23:54:06,768 - INFO - pnl: 2024-04-04T23:59:59.999 152112.48634087996 === 0.391%
2024-12-12 23:54:06,772 - DEBUG - cur time: 2024-04-05T23:59:59.999 == next bar open time: 2024-04-06T00:00:00.000 == close pos time: 2024-04-11T00:00:00.000
2024-12-12 23:54:06,772 - INFO - pnl: 2024-04-05T23:59:59.999 153351.7278595908 === 0.815%
2024-12-12 23:54:06,780 - DEBUG - cur time: 2024-04-06T23:59:59.999 == next bar open time: 2024-04-07T00:00:00.000 == close pos time: 2024-04-12T00:00:00.000
2024-12-12 23:54:06,780 - INFO - pnl: 2024-04-06T23:59:59.999 153123.6994469273 === -0.149%
2024-12-12 23:54:06,784 - DEBUG - cur time: 2024-04-07T23:59:59.999 == next bar open time: 2024-04-08T00:00:00.000 == close pos time: 2024-04-13T00:00:00.000
2024-12-12 23:54:06,801 - DEBUG - close time 2024-04-07T23:59:59.999 == vol_threshold: 9469195.629999992
2024-12-12 23:54:06,801 - DEBUG - 2024-04-07T23:59:59.999 == all trade symbol 234 == remain 164 after VOL filter
2024-12-12 23:54:06,801 - DEBUG - sorted_long_factors: shape: (164, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ONGUSDT   ┆ -5.352579    ┆ 0    ┆ 163          │
│ MEMEUSDT  ┆ -3.917794    ┆ 1    ┆ 162          │
│ KLAYUSDT  ┆ -3.499668    ┆ 2    ┆ 161          │
│ NFPUSDT   ┆ -3.372873    ┆ 3    ┆ 160          │
│ SPELLUSDT ┆ -3.073558    ┆ 4    ┆ 159          │
│ THETAUSDT ┆ -2.924999    ┆ 5    ┆ 158          │
│ LQTYUSDT  ┆ -2.740585    ┆ 6    ┆ 157          │
│ GRTUSDT   ┆ -2.607798    ┆ 7    ┆ 156          │
│ CFXUSDT   ┆ -2.486718    ┆ 8    ┆ 155          │
│ BNXUSDT   ┆ -2.418462    ┆ 9    ┆ 154          │
│ …         ┆ …            ┆ …    ┆ …            │
│ STMXUSDT  ┆ 3.353763     ┆ 154  ┆ 9            │
│ LEVERUSDT ┆ 3.92738      ┆ 155  ┆ 8            │
│ ICXUSDT   ┆ 4.279216     ┆ 156  ┆ 7            │
│ BELUSDT   ┆ 4.327793     ┆ 157  ┆ 6            │
│ CKBUSDT   ┆ 4.344658     ┆ 158  ┆ 5            │
│ DENTUSDT  ┆ 4.492152     ┆ 159  ┆ 4            │
│ STGUSDT   ┆ 4.897056     ┆ 160  ┆ 3            │
│ ONTUSDT   ┆ 5.167399     ┆ 161  ┆ 2            │
│ CELRUSDT  ┆ 6.030771     ┆ 162  ┆ 1            │
│ XEMUSDT   ┆ 6.083934     ┆ 163  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,814 - WARNING - 2024-04-07T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,814 - INFO - cur close time: 2024-04-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:06,814 - DEBUG - mean expected ret (mean factor): 0.15473025139718513
2024-12-12 23:54:06,820 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,820 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,820 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023528    ┆ 0.20562     ┆ 0.13404     ┆ 0.0074516   ┆ … ┆ 0.03349 ┆ null   ┆ null    ┆ 0.6931  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,829 - DEBUG - update position: 2024-04-07T23:59:59.999 === diff_trading_value: 349602.5563042864 == cash: 150925.591866753 
2024-12-12 23:54:06,831 - INFO - pnl: 2024-04-07T23:59:59.999 150925.591866753 === -1.436%
2024-12-12 23:54:06,835 - DEBUG - cur time: 2024-04-08T23:59:59.999 == next bar open time: 2024-04-09T00:00:00.000 == close pos time: 2024-04-14T00:00:00.000
2024-12-12 23:54:06,840 - INFO - pnl: 2024-04-08T23:59:59.999 152405.9714016382 === 0.981%
2024-12-12 23:54:06,844 - DEBUG - cur time: 2024-04-09T23:59:59.999 == next bar open time: 2024-04-10T00:00:00.000 == close pos time: 2024-04-15T00:00:00.000
2024-12-12 23:54:06,848 - INFO - pnl: 2024-04-09T23:59:59.999 153370.75918325427 === 0.633%
2024-12-12 23:54:06,852 - DEBUG - cur time: 2024-04-10T23:59:59.999 == next bar open time: 2024-04-11T00:00:00.000 == close pos time: 2024-04-16T00:00:00.000
2024-12-12 23:54:06,852 - INFO - pnl: 2024-04-10T23:59:59.999 150992.5462717705 === -1.551%
2024-12-12 23:54:06,860 - DEBUG - cur time: 2024-04-11T23:59:59.999 == next bar open time: 2024-04-12T00:00:00.000 == close pos time: 2024-04-17T00:00:00.000
2024-12-12 23:54:06,860 - INFO - pnl: 2024-04-11T23:59:59.999 146388.52442908002 === -3.049%
2024-12-12 23:54:06,864 - DEBUG - cur time: 2024-04-12T23:59:59.999 == next bar open time: 2024-04-13T00:00:00.000 == close pos time: 2024-04-18T00:00:00.000
2024-12-12 23:54:06,880 - DEBUG - close time 2024-04-12T23:59:59.999 == vol_threshold: 32317862.28
2024-12-12 23:54:06,880 - DEBUG - 2024-04-12T23:59:59.999 == all trade symbol 235 == remain 164 after VOL filter
2024-12-12 23:54:06,884 - DEBUG - sorted_long_factors: shape: (164, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ MANTAUSDT  ┆ -4.657463    ┆ 0    ┆ 163          │
│ XAIUSDT    ┆ -4.426683    ┆ 1    ┆ 162          │
│ AIUSDT     ┆ -4.298718    ┆ 2    ┆ 161          │
│ GLMRUSDT   ┆ -4.194855    ┆ 3    ┆ 160          │
│ RIFUSDT    ┆ -4.072487    ┆ 4    ┆ 159          │
│ STGUSDT    ┆ -3.210803    ┆ 5    ┆ 158          │
│ KLAYUSDT   ┆ -3.109479    ┆ 6    ┆ 157          │
│ USTCUSDT   ┆ -2.666747    ┆ 7    ┆ 156          │
│ RSRUSDT    ┆ -2.57141     ┆ 8    ┆ 155          │
│ ARBUSDT    ┆ -2.417206    ┆ 9    ┆ 154          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BLZUSDT    ┆ 3.890701     ┆ 154  ┆ 9            │
│ PENDLEUSDT ┆ 4.01237      ┆ 155  ┆ 8            │
│ NEOUSDT    ┆ 4.017168     ┆ 156  ┆ 7            │
│ BELUSDT    ┆ 4.407975     ┆ 157  ┆ 6            │
│ ONTUSDT    ┆ 4.457035     ┆ 158  ┆ 5            │
│ CKBUSDT    ┆ 4.6091       ┆ 159  ┆ 4            │
│ SNTUSDT    ┆ 4.617151     ┆ 160  ┆ 3            │
│ XTZUSDT    ┆ 5.019235     ┆ 161  ┆ 2            │
│ ATAUSDT    ┆ 5.20539      ┆ 162  ┆ 1            │
│ ONGUSDT    ┆ 5.304469     ┆ 163  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,892 - WARNING - 2024-04-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,892 - INFO - cur close time: 2024-04-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:06,892 - DEBUG - mean expected ret (mean factor): 0.14225490795518086
2024-12-12 23:54:06,899 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,899 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,899 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.017343    ┆ 0.15814     ┆ 0.10662     ┆ 0.0059116   ┆ … ┆ 0.02784 ┆ null   ┆ null    ┆ 0.5445  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,907 - DEBUG - update position: 2024-04-12T23:59:59.999 === diff_trading_value: 298624.8642631805 == cash: 147226.5095223773 
2024-12-12 23:54:06,908 - INFO - pnl: 2024-04-12T23:59:59.999 147226.5095223773 === 0.572%
2024-12-12 23:54:06,912 - DEBUG - cur time: 2024-04-13T23:59:59.999 == next bar open time: 2024-04-14T00:00:00.000 == close pos time: 2024-04-19T00:00:00.000
2024-12-12 23:54:06,913 - INFO - pnl: 2024-04-13T23:59:59.999 148239.58365392624 === 0.688%
2024-12-12 23:54:06,917 - DEBUG - cur time: 2024-04-14T23:59:59.999 == next bar open time: 2024-04-15T00:00:00.000 == close pos time: 2024-04-20T00:00:00.000
2024-12-12 23:54:06,920 - INFO - pnl: 2024-04-14T23:59:59.999 144404.82247873984 === -2.587%
2024-12-12 23:54:06,923 - DEBUG - cur time: 2024-04-15T23:59:59.999 == next bar open time: 2024-04-16T00:00:00.000 == close pos time: 2024-04-21T00:00:00.000
2024-12-12 23:54:06,923 - INFO - pnl: 2024-04-15T23:59:59.999 144937.10981185603 === 0.369%
2024-12-12 23:54:06,926 - DEBUG - cur time: 2024-04-16T23:59:59.999 == next bar open time: 2024-04-17T00:00:00.000 == close pos time: 2024-04-22T00:00:00.000
2024-12-12 23:54:06,930 - INFO - pnl: 2024-04-16T23:59:59.999 144455.57740739992 === -0.332%
2024-12-12 23:54:06,934 - DEBUG - cur time: 2024-04-17T23:59:59.999 == next bar open time: 2024-04-18T00:00:00.000 == close pos time: 2024-04-23T00:00:00.000
2024-12-12 23:54:06,942 - DEBUG - close time 2024-04-17T23:59:59.999 == vol_threshold: 20073769.439999998
2024-12-12 23:54:06,947 - DEBUG - 2024-04-17T23:59:59.999 == all trade symbol 237 == remain 166 after VOL filter
2024-12-12 23:54:06,947 - DEBUG - sorted_long_factors: shape: (166, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MDTUSDT      ┆ -6.223807    ┆ 0    ┆ 165          │
│ GLMRUSDT     ┆ -5.066463    ┆ 1    ┆ 164          │
│ ALTUSDT      ┆ -4.624067    ┆ 2    ┆ 163          │
│ XVGUSDT      ┆ -3.602715    ┆ 3    ┆ 162          │
│ BAKEUSDT     ┆ -3.42347     ┆ 4    ┆ 161          │
│ 1000RATSUSDT ┆ -3.41593     ┆ 5    ┆ 160          │
│ AGIXUSDT     ┆ -3.295775    ┆ 6    ┆ 159          │
│ TRXUSDT      ┆ -3.284211    ┆ 7    ┆ 158          │
│ BICOUSDT     ┆ -3.247982    ┆ 8    ┆ 157          │
│ 1000BONKUSDT ┆ -3.210247    ┆ 9    ┆ 156          │
│ …            ┆ …            ┆ …    ┆ …            │
│ KLAYUSDT     ┆ 2.978652     ┆ 156  ┆ 9            │
│ OXTUSDT      ┆ 3.054494     ┆ 157  ┆ 8            │
│ FLMUSDT      ┆ 3.07187      ┆ 158  ┆ 7            │
│ FLOWUSDT     ┆ 3.306365     ┆ 159  ┆ 6            │
│ ARPAUSDT     ┆ 3.568613     ┆ 160  ┆ 5            │
│ RIFUSDT      ┆ 3.955159     ┆ 161  ┆ 4            │
│ BLZUSDT      ┆ 4.216901     ┆ 162  ┆ 3            │
│ HFTUSDT      ┆ 4.219628     ┆ 163  ┆ 2            │
│ KASUSDT      ┆ 5.066151     ┆ 164  ┆ 1            │
│ DODOXUSDT    ┆ 5.175619     ┆ 165  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:06,955 - WARNING - 2024-04-17T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:06,955 - INFO - cur close time: 2024-04-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:06,955 - DEBUG - mean expected ret (mean factor): -0.03282738079468178
2024-12-12 23:54:06,960 - DEBUG - begin to update pos: =========
2024-12-12 23:54:06,960 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ f64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ -10000.0    ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,960 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.01393     ┆ 0.13324     ┆ 0.09816     ┆ 0.0049112   ┆ … ┆ 0.02339 ┆ null   ┆ null    ┆ 0.4871  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:06,968 - DEBUG - update position: 2024-04-17T23:59:59.999 === diff_trading_value: 337927.1558542092 == cash: 144035.6911721625 
2024-12-12 23:54:06,969 - INFO - pnl: 2024-04-17T23:59:59.999 144035.6911721625 === -0.291%
2024-12-12 23:54:06,972 - DEBUG - cur time: 2024-04-18T23:59:59.999 == next bar open time: 2024-04-19T00:00:00.000 == close pos time: 2024-04-24T00:00:00.000
2024-12-12 23:54:06,977 - INFO - pnl: 2024-04-18T23:59:59.999 144300.2415277154 === 0.184%
2024-12-12 23:54:06,983 - DEBUG - cur time: 2024-04-19T23:59:59.999 == next bar open time: 2024-04-20T00:00:00.000 == close pos time: 2024-04-25T00:00:00.000
2024-12-12 23:54:06,983 - INFO - pnl: 2024-04-19T23:59:59.999 144299.43030377064 === -0.001%
2024-12-12 23:54:06,992 - DEBUG - cur time: 2024-04-20T23:59:59.999 == next bar open time: 2024-04-21T00:00:00.000 == close pos time: 2024-04-26T00:00:00.000
2024-12-12 23:54:06,996 - INFO - pnl: 2024-04-20T23:59:59.999 137595.96049124608 === -4.646%
2024-12-12 23:54:07,000 - DEBUG - cur time: 2024-04-21T23:59:59.999 == next bar open time: 2024-04-22T00:00:00.000 == close pos time: 2024-04-27T00:00:00.000
2024-12-12 23:54:07,005 - INFO - pnl: 2024-04-21T23:59:59.999 136129.47039158575 === -1.066%
2024-12-12 23:54:07,012 - DEBUG - cur time: 2024-04-22T23:59:59.999 == next bar open time: 2024-04-23T00:00:00.000 == close pos time: 2024-04-28T00:00:00.000
2024-12-12 23:54:07,031 - DEBUG - close time 2024-04-22T23:59:59.999 == vol_threshold: 13529065.787999999
2024-12-12 23:54:07,032 - DEBUG - 2024-04-22T23:59:59.999 == all trade symbol 238 == remain 166 after VOL filter
2024-12-12 23:54:07,033 - DEBUG - sorted_long_factors: shape: (166, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ AIUSDT     ┆ -5.925878    ┆ 0    ┆ 165          │
│ CHZUSDT    ┆ -5.272768    ┆ 1    ┆ 164          │
│ SFPUSDT    ┆ -4.305801    ┆ 2    ┆ 163          │
│ ALTUSDT    ┆ -4.093349    ┆ 3    ┆ 162          │
│ XAIUSDT    ┆ -3.965962    ┆ 4    ┆ 161          │
│ MANTAUSDT  ┆ -3.903533    ┆ 5    ┆ 160          │
│ RDNTUSDT   ┆ -3.852028    ┆ 6    ┆ 159          │
│ DOGEUSDT   ┆ -3.148069    ┆ 7    ┆ 158          │
│ MEMEUSDT   ┆ -2.921891    ┆ 8    ┆ 157          │
│ WLDUSDT    ┆ -2.87943     ┆ 9    ┆ 156          │
│ …          ┆ …            ┆ …    ┆ …            │
│ ENJUSDT    ┆ 2.749375     ┆ 156  ┆ 9            │
│ PENDLEUSDT ┆ 2.908126     ┆ 157  ┆ 8            │
│ BEAMXUSDT  ┆ 3.296228     ┆ 158  ┆ 7            │
│ ONGUSDT    ┆ 3.742988     ┆ 159  ┆ 6            │
│ GLMRUSDT   ┆ 3.793886     ┆ 160  ┆ 5            │
│ KLAYUSDT   ┆ 4.067282     ┆ 161  ┆ 4            │
│ BATUSDT    ┆ 5.465378     ┆ 162  ┆ 3            │
│ LINAUSDT   ┆ 5.508602     ┆ 163  ┆ 2            │
│ RIFUSDT    ┆ 5.993532     ┆ 164  ┆ 1            │
│ DARUSDT    ┆ 6.16007      ┆ 165  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,040 - WARNING - 2024-04-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,042 - INFO - cur close time: 2024-04-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:07,042 - DEBUG - mean expected ret (mean factor): 0.12107881385460534
2024-12-12 23:54:07,046 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,046 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,046 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.020219    ┆ 0.17626     ┆ 0.11081     ┆ 0.0068702   ┆ … ┆ 0.02659 ┆ null   ┆ null    ┆ 0.5697  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,055 - DEBUG - update position: 2024-04-22T23:59:59.999 === diff_trading_value: 364468.3389765738 == cash: 138802.2360440046 
2024-12-12 23:54:07,059 - INFO - pnl: 2024-04-22T23:59:59.999 138802.2360440046 === 1.963%
2024-12-12 23:54:07,063 - DEBUG - cur time: 2024-04-23T23:59:59.999 == next bar open time: 2024-04-24T00:00:00.000 == close pos time: 2024-04-29T00:00:00.000
2024-12-12 23:54:07,067 - INFO - pnl: 2024-04-23T23:59:59.999 143785.16489046504 === 3.590%
2024-12-12 23:54:07,072 - DEBUG - cur time: 2024-04-24T23:59:59.999 == next bar open time: 2024-04-25T00:00:00.000 == close pos time: 2024-04-30T00:00:00.000
2024-12-12 23:54:07,075 - INFO - pnl: 2024-04-24T23:59:59.999 142035.7169523653 === -1.217%
2024-12-12 23:54:07,084 - DEBUG - cur time: 2024-04-25T23:59:59.999 == next bar open time: 2024-04-26T00:00:00.000 == close pos time: 2024-05-01T00:00:00.000
2024-12-12 23:54:07,088 - INFO - pnl: 2024-04-25T23:59:59.999 140907.06702183996 === -0.795%
2024-12-12 23:54:07,092 - DEBUG - cur time: 2024-04-26T23:59:59.999 == next bar open time: 2024-04-27T00:00:00.000 == close pos time: 2024-05-02T00:00:00.000
2024-12-12 23:54:07,092 - INFO - pnl: 2024-04-26T23:59:59.999 141132.52583752444 === 0.160%
2024-12-12 23:54:07,096 - DEBUG - cur time: 2024-04-27T23:59:59.999 == next bar open time: 2024-04-28T00:00:00.000 == close pos time: 2024-05-03T00:00:00.000
2024-12-12 23:54:07,112 - DEBUG - close time 2024-04-27T23:59:59.999 == vol_threshold: 12827990.799999993
2024-12-12 23:54:07,112 - DEBUG - 2024-04-27T23:59:59.999 == all trade symbol 239 == remain 167 after VOL filter
2024-12-12 23:54:07,117 - DEBUG - sorted_long_factors: shape: (167, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ MANTAUSDT ┆ -4.237932    ┆ 0    ┆ 166          │
│ JTOUSDT   ┆ -4.19486     ┆ 1    ┆ 165          │
│ GLMRUSDT  ┆ -4.030398    ┆ 2    ┆ 164          │
│ COMBOUSDT ┆ -3.995702    ┆ 3    ┆ 163          │
│ DOGEUSDT  ┆ -3.881111    ┆ 4    ┆ 162          │
│ MEMEUSDT  ┆ -3.865067    ┆ 5    ┆ 161          │
│ ONDOUSDT  ┆ -3.787034    ┆ 6    ┆ 160          │
│ LUNA2USDT ┆ -3.67754     ┆ 7    ┆ 159          │
│ ZRXUSDT   ┆ -3.452184    ┆ 8    ┆ 158          │
│ ACHUSDT   ┆ -3.443105    ┆ 9    ┆ 157          │
│ …         ┆ …            ┆ …    ┆ …            │
│ 1INCHUSDT ┆ 3.37868      ┆ 157  ┆ 9            │
│ BNXUSDT   ┆ 3.424759     ┆ 158  ┆ 8            │
│ ARKUSDT   ┆ 3.950689     ┆ 159  ┆ 7            │
│ HIGHUSDT  ┆ 4.459691     ┆ 160  ┆ 6            │
│ XLMUSDT   ┆ 4.582292     ┆ 161  ┆ 5            │
│ LDOUSDT   ┆ 4.586595     ┆ 162  ┆ 4            │
│ MDTUSDT   ┆ 5.744606     ┆ 163  ┆ 3            │
│ ICXUSDT   ┆ 5.844873     ┆ 164  ┆ 2            │
│ STPTUSDT  ┆ 6.163935     ┆ 165  ┆ 1            │
│ STMXUSDT  ┆ 6.706326     ┆ 166  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,126 - WARNING - 2024-04-27T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,126 - INFO - cur close time: 2024-04-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:07,126 - DEBUG - mean expected ret (mean factor): -0.023034235407300076
2024-12-12 23:54:07,131 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,132 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬─────────┬──────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT  │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---      │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64      │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆         ┆          │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪═════════╪══════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ -10000.0 │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴─────────┴──────────┘
2024-12-12 23:54:07,133 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024502    ┆ 0.17292     ┆ 0.10685     ┆ 0.0072025   ┆ … ┆ 0.02511 ┆ null   ┆ null    ┆ 0.5064  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,140 - DEBUG - update position: 2024-04-27T23:59:59.999 === diff_trading_value: 311319.9575388853 == cash: 140669.42826382522 
2024-12-12 23:54:07,144 - INFO - pnl: 2024-04-27T23:59:59.999 140669.42826382522 === -0.328%
2024-12-12 23:54:07,150 - DEBUG - cur time: 2024-04-28T23:59:59.999 == next bar open time: 2024-04-29T00:00:00.000 == close pos time: 2024-05-04T00:00:00.000
2024-12-12 23:54:07,152 - INFO - pnl: 2024-04-28T23:59:59.999 140157.2542589497 === -0.364%
2024-12-12 23:54:07,156 - DEBUG - cur time: 2024-04-29T23:59:59.999 == next bar open time: 2024-04-30T00:00:00.000 == close pos time: 2024-05-05T00:00:00.000
2024-12-12 23:54:07,160 - INFO - pnl: 2024-04-29T23:59:59.999 139928.87469710468 === -0.163%
2024-12-12 23:54:07,164 - DEBUG - cur time: 2024-04-30T23:59:59.999 == next bar open time: 2024-05-01T00:00:00.000 == close pos time: 2024-05-06T00:00:00.000
2024-12-12 23:54:07,170 - INFO - pnl: 2024-04-30T23:59:59.999 140971.72949299592 === 0.745%
2024-12-12 23:54:07,176 - DEBUG - cur time: 2024-05-01T23:59:59.999 == next bar open time: 2024-05-02T00:00:00.000 == close pos time: 2024-05-07T00:00:00.000
2024-12-12 23:54:07,180 - INFO - pnl: 2024-05-01T23:59:59.999 140811.5213146857 === -0.114%
2024-12-12 23:54:07,184 - DEBUG - cur time: 2024-05-02T23:59:59.999 == next bar open time: 2024-05-03T00:00:00.000 == close pos time: 2024-05-08T00:00:00.000
2024-12-12 23:54:07,224 - DEBUG - close time 2024-05-02T23:59:59.999 == vol_threshold: 12428371.059999997
2024-12-12 23:54:07,226 - DEBUG - 2024-05-02T23:59:59.999 == all trade symbol 242 == remain 169 after VOL filter
2024-12-12 23:54:07,231 - DEBUG - sorted_long_factors: shape: (169, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ MAVUSDT   ┆ -4.268956    ┆ 0    ┆ 168          │
│ RDNTUSDT  ┆ -4.116721    ┆ 1    ┆ 167          │
│ MANTAUSDT ┆ -3.748574    ┆ 2    ┆ 166          │
│ XAIUSDT   ┆ -3.687116    ┆ 3    ┆ 165          │
│ PIXELUSDT ┆ -3.389003    ┆ 4    ┆ 164          │
│ TLMUSDT   ┆ -3.16892     ┆ 5    ┆ 163          │
│ NFPUSDT   ┆ -3.096748    ┆ 6    ┆ 162          │
│ ZILUSDT   ┆ -3.073746    ┆ 7    ┆ 161          │
│ BATUSDT   ┆ -2.947834    ┆ 8    ┆ 160          │
│ POLYXUSDT ┆ -2.924784    ┆ 9    ┆ 159          │
│ …         ┆ …            ┆ …    ┆ …            │
│ STMXUSDT  ┆ 3.644291     ┆ 159  ┆ 9            │
│ HIGHUSDT  ┆ 3.708832     ┆ 160  ┆ 8            │
│ SNTUSDT   ┆ 3.887386     ┆ 161  ┆ 7            │
│ KNCUSDT   ┆ 3.901926     ┆ 162  ┆ 6            │
│ CELRUSDT  ┆ 3.951943     ┆ 163  ┆ 5            │
│ SFPUSDT   ┆ 4.378541     ┆ 164  ┆ 4            │
│ MBLUSDT   ┆ 4.912259     ┆ 165  ┆ 3            │
│ KAVAUSDT  ┆ 5.613613     ┆ 166  ┆ 2            │
│ LINAUSDT  ┆ 6.142572     ┆ 167  ┆ 1            │
│ KASUSDT   ┆ 7.338611     ┆ 168  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,244 - WARNING - 2024-05-02T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,247 - INFO - cur close time: 2024-05-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:07,247 - DEBUG - mean expected ret (mean factor): 0.07743568989717874
2024-12-12 23:54:07,262 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,262 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,262 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025304    ┆ 0.16383     ┆ 0.10372     ┆ 0.0075418   ┆ … ┆ 0.0234  ┆ null   ┆ null    ┆ 0.4728  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,273 - DEBUG - update position: 2024-05-02T23:59:59.999 === diff_trading_value: 322225.7958492898 == cash: 140668.00163162997 
2024-12-12 23:54:07,278 - INFO - pnl: 2024-05-02T23:59:59.999 140668.00163162997 === -0.102%
2024-12-12 23:54:07,282 - DEBUG - cur time: 2024-05-03T23:59:59.999 == next bar open time: 2024-05-04T00:00:00.000 == close pos time: 2024-05-09T00:00:00.000
2024-12-12 23:54:07,282 - INFO - pnl: 2024-05-03T23:59:59.999 139884.90294470364 === -0.557%
2024-12-12 23:54:07,290 - DEBUG - cur time: 2024-05-04T23:59:59.999 == next bar open time: 2024-05-05T00:00:00.000 == close pos time: 2024-05-10T00:00:00.000
2024-12-12 23:54:07,291 - INFO - pnl: 2024-05-04T23:59:59.999 139533.62060315686 === -0.251%
2024-12-12 23:54:07,297 - DEBUG - cur time: 2024-05-05T23:59:59.999 == next bar open time: 2024-05-06T00:00:00.000 == close pos time: 2024-05-11T00:00:00.000
2024-12-12 23:54:07,297 - INFO - pnl: 2024-05-05T23:59:59.999 136219.55042942747 === -2.375%
2024-12-12 23:54:07,301 - DEBUG - cur time: 2024-05-06T23:59:59.999 == next bar open time: 2024-05-07T00:00:00.000 == close pos time: 2024-05-12T00:00:00.000
2024-12-12 23:54:07,301 - INFO - pnl: 2024-05-06T23:59:59.999 127310.36959189957 === -6.540%
2024-12-12 23:54:07,305 - DEBUG - cur time: 2024-05-07T23:59:59.999 == next bar open time: 2024-05-08T00:00:00.000 == close pos time: 2024-05-13T00:00:00.000
2024-12-12 23:54:07,321 - DEBUG - close time 2024-05-07T23:59:59.999 == vol_threshold: 10977462.54
2024-12-12 23:54:07,324 - DEBUG - 2024-05-07T23:59:59.999 == all trade symbol 240 == remain 168 after VOL filter
2024-12-12 23:54:07,326 - DEBUG - sorted_long_factors: shape: (168, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ONDOUSDT  ┆ -4.719698    ┆ 0    ┆ 167          │
│ GLMRUSDT  ┆ -4.490834    ┆ 1    ┆ 166          │
│ MDTUSDT   ┆ -3.859387    ┆ 2    ┆ 165          │
│ MEMEUSDT  ┆ -3.797518    ┆ 3    ┆ 164          │
│ NKNUSDT   ┆ -3.292865    ┆ 4    ┆ 163          │
│ BEAMXUSDT ┆ -3.22855     ┆ 5    ┆ 162          │
│ ALTUSDT   ┆ -3.056443    ┆ 6    ┆ 161          │
│ TLMUSDT   ┆ -2.699385    ┆ 7    ┆ 160          │
│ IOTXUSDT  ┆ -2.694834    ┆ 8    ┆ 159          │
│ DOGEUSDT  ┆ -2.66808     ┆ 9    ┆ 158          │
│ …         ┆ …            ┆ …    ┆ …            │
│ IMXUSDT   ┆ 2.838804     ┆ 158  ┆ 9            │
│ CRVUSDT   ┆ 2.949883     ┆ 159  ┆ 8            │
│ HIGHUSDT  ┆ 3.032948     ┆ 160  ┆ 7            │
│ XEMUSDT   ┆ 3.096278     ┆ 161  ┆ 6            │
│ GLMUSDT   ┆ 3.112326     ┆ 162  ┆ 5            │
│ FLOWUSDT  ┆ 3.393436     ┆ 163  ┆ 4            │
│ XTZUSDT   ┆ 3.44687      ┆ 164  ┆ 3            │
│ ICXUSDT   ┆ 3.969913     ┆ 165  ┆ 2            │
│ OGNUSDT   ┆ 4.574305     ┆ 166  ┆ 1            │
│ HFTUSDT   ┆ 4.958067     ┆ 167  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,330 - WARNING - 2024-05-07T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,330 - INFO - cur close time: 2024-05-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:07,330 - DEBUG - mean expected ret (mean factor): 0.00660285673981733
2024-12-12 23:54:07,334 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,338 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,338 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023788    ┆ 0.17124     ┆ 0.10276     ┆ 0.0079028   ┆ … ┆ 0.02359 ┆ null   ┆ null    ┆ 0.4753  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,342 - DEBUG - update position: 2024-05-07T23:59:59.999 === diff_trading_value: 323326.16133977135 == cash: 128966.20286638793 
2024-12-12 23:54:07,342 - INFO - pnl: 2024-05-07T23:59:59.999 128966.20286638793 === 1.301%
2024-12-12 23:54:07,348 - DEBUG - cur time: 2024-05-08T23:59:59.999 == next bar open time: 2024-05-09T00:00:00.000 == close pos time: 2024-05-14T00:00:00.000
2024-12-12 23:54:07,350 - INFO - pnl: 2024-05-08T23:59:59.999 143023.1559551699 === 10.900%
2024-12-12 23:54:07,354 - DEBUG - cur time: 2024-05-09T23:59:59.999 == next bar open time: 2024-05-10T00:00:00.000 == close pos time: 2024-05-15T00:00:00.000
2024-12-12 23:54:07,355 - INFO - pnl: 2024-05-09T23:59:59.999 152540.14449693504 === 6.654%
2024-12-12 23:54:07,358 - DEBUG - cur time: 2024-05-10T23:59:59.999 == next bar open time: 2024-05-11T00:00:00.000 == close pos time: 2024-05-16T00:00:00.000
2024-12-12 23:54:07,359 - INFO - pnl: 2024-05-10T23:59:59.999 152249.8070186132 === -0.190%
2024-12-12 23:54:07,362 - DEBUG - cur time: 2024-05-11T23:59:59.999 == next bar open time: 2024-05-12T00:00:00.000 == close pos time: 2024-05-17T00:00:00.000
2024-12-12 23:54:07,362 - INFO - pnl: 2024-05-11T23:59:59.999 151963.03777705072 === -0.188%
2024-12-12 23:54:07,366 - DEBUG - cur time: 2024-05-12T23:59:59.999 == next bar open time: 2024-05-13T00:00:00.000 == close pos time: 2024-05-18T00:00:00.000
2024-12-12 23:54:07,382 - DEBUG - close time 2024-05-12T23:59:59.999 == vol_threshold: 8023945.06
2024-12-12 23:54:07,382 - DEBUG - 2024-05-12T23:59:59.999 == all trade symbol 237 == remain 166 after VOL filter
2024-12-12 23:54:07,386 - DEBUG - sorted_long_factors: shape: (166, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ KEYUSDT   ┆ -3.484594    ┆ 0    ┆ 165          │
│ STEEMUSDT ┆ -3.120982    ┆ 1    ┆ 164          │
│ YGGUSDT   ┆ -3.110548    ┆ 2    ┆ 163          │
│ BNXUSDT   ┆ -3.064346    ┆ 3    ┆ 162          │
│ AMBUSDT   ┆ -2.656704    ┆ 4    ┆ 161          │
│ OXTUSDT   ┆ -2.641603    ┆ 5    ┆ 160          │
│ ONDOUSDT  ┆ -2.559371    ┆ 6    ┆ 159          │
│ AGIXUSDT  ┆ -2.271588    ┆ 7    ┆ 158          │
│ DOGEUSDT  ┆ -2.259835    ┆ 8    ┆ 157          │
│ XRPUSDT   ┆ -1.93565     ┆ 9    ┆ 156          │
│ …         ┆ …            ┆ …    ┆ …            │
│ TRXUSDT   ┆ 3.07405      ┆ 156  ┆ 9            │
│ LEVERUSDT ┆ 3.11288      ┆ 157  ┆ 8            │
│ TUSDT     ┆ 3.262822     ┆ 158  ┆ 7            │
│ XEMUSDT   ┆ 3.296725     ┆ 159  ┆ 6            │
│ XTZUSDT   ┆ 3.689519     ┆ 160  ┆ 5            │
│ IOSTUSDT  ┆ 3.744673     ┆ 161  ┆ 4            │
│ HIGHUSDT  ┆ 4.361974     ┆ 162  ┆ 3            │
│ NTRNUSDT  ┆ 4.782901     ┆ 163  ┆ 2            │
│ ICXUSDT   ┆ 5.458183     ┆ 164  ┆ 1            │
│ POWRUSDT  ┆ 7.111933     ┆ 165  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,392 - WARNING - 2024-05-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,392 - INFO - cur close time: 2024-05-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:07,392 - DEBUG - mean expected ret (mean factor): 0.09483570335421822
2024-12-12 23:54:07,396 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,396 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,396 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022745    ┆ 0.16922     ┆ 0.10434     ┆ 0.008745    ┆ … ┆ 0.02266 ┆ null   ┆ null    ┆ 0.4515  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,406 - DEBUG - update position: 2024-05-12T23:59:59.999 === diff_trading_value: 298776.7335783772 == cash: 152507.2496661055 
2024-12-12 23:54:07,407 - INFO - pnl: 2024-05-12T23:59:59.999 152507.2496661055 === 0.358%
2024-12-12 23:54:07,411 - DEBUG - cur time: 2024-05-13T23:59:59.999 == next bar open time: 2024-05-14T00:00:00.000 == close pos time: 2024-05-19T00:00:00.000
2024-12-12 23:54:07,411 - INFO - pnl: 2024-05-13T23:59:59.999 152749.6998919873 === 0.159%
2024-12-12 23:54:07,414 - DEBUG - cur time: 2024-05-14T23:59:59.999 == next bar open time: 2024-05-15T00:00:00.000 == close pos time: 2024-05-20T00:00:00.000
2024-12-12 23:54:07,414 - INFO - pnl: 2024-05-14T23:59:59.999 152190.8056306672 === -0.366%
2024-12-12 23:54:07,418 - DEBUG - cur time: 2024-05-15T23:59:59.999 == next bar open time: 2024-05-16T00:00:00.000 == close pos time: 2024-05-21T00:00:00.000
2024-12-12 23:54:07,420 - INFO - pnl: 2024-05-15T23:59:59.999 151334.08309757925 === -0.563%
2024-12-12 23:54:07,423 - DEBUG - cur time: 2024-05-16T23:59:59.999 == next bar open time: 2024-05-17T00:00:00.000 == close pos time: 2024-05-22T00:00:00.000
2024-12-12 23:54:07,424 - INFO - pnl: 2024-05-16T23:59:59.999 152152.5617499534 === 0.541%
2024-12-12 23:54:07,427 - DEBUG - cur time: 2024-05-17T23:59:59.999 == next bar open time: 2024-05-18T00:00:00.000 == close pos time: 2024-05-23T00:00:00.000
2024-12-12 23:54:07,438 - DEBUG - close time 2024-05-17T23:59:59.999 == vol_threshold: 9949317.6
2024-12-12 23:54:07,438 - DEBUG - 2024-05-17T23:59:59.999 == all trade symbol 238 == remain 166 after VOL filter
2024-12-12 23:54:07,440 - DEBUG - sorted_long_factors: shape: (166, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DARUSDT      ┆ -5.647716    ┆ 0    ┆ 165          │
│ ASTRUSDT     ┆ -4.984323    ┆ 1    ┆ 164          │
│ BLZUSDT      ┆ -4.966739    ┆ 2    ┆ 163          │
│ ARPAUSDT     ┆ -4.765026    ┆ 3    ┆ 162          │
│ PORTALUSDT   ┆ -4.120633    ┆ 4    ┆ 161          │
│ NFPUSDT      ┆ -3.646195    ┆ 5    ┆ 160          │
│ EDUUSDT      ┆ -3.569692    ┆ 6    ┆ 159          │
│ LRCUSDT      ┆ -3.286824    ┆ 7    ┆ 158          │
│ 1000RATSUSDT ┆ -3.277239    ┆ 8    ┆ 157          │
│ AIUSDT       ┆ -2.947145    ┆ 9    ┆ 156          │
│ …            ┆ …            ┆ …    ┆ …            │
│ KEYUSDT      ┆ 3.457008     ┆ 156  ┆ 9            │
│ DYDXUSDT     ┆ 3.509837     ┆ 157  ┆ 8            │
│ BNXUSDT      ┆ 3.790511     ┆ 158  ┆ 7            │
│ FLMUSDT      ┆ 3.918551     ┆ 159  ┆ 6            │
│ XLMUSDT      ┆ 3.943452     ┆ 160  ┆ 5            │
│ BEAMXUSDT    ┆ 3.991397     ┆ 161  ┆ 4            │
│ SPELLUSDT    ┆ 4.620356     ┆ 162  ┆ 3            │
│ DENTUSDT     ┆ 4.77328      ┆ 163  ┆ 2            │
│ ICXUSDT      ┆ 6.215873     ┆ 164  ┆ 1            │
│ KAVAUSDT     ┆ 7.584441     ┆ 165  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,446 - WARNING - 2024-05-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,446 - INFO - cur close time: 2024-05-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:07,446 - DEBUG - mean expected ret (mean factor): 0.04392398633266173
2024-12-12 23:54:07,450 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,450 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,450 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024387    ┆ 0.21015     ┆ 0.10877     ┆ 0.0101651   ┆ … ┆ 0.0238  ┆ null   ┆ null    ┆ 0.578   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,458 - DEBUG - update position: 2024-05-17T23:59:59.999 === diff_trading_value: 385420.2996455844 == cash: 150124.5966875507 
2024-12-12 23:54:07,458 - INFO - pnl: 2024-05-17T23:59:59.999 150124.5966875507 === -1.333%
2024-12-12 23:54:07,462 - DEBUG - cur time: 2024-05-18T23:59:59.999 == next bar open time: 2024-05-19T00:00:00.000 == close pos time: 2024-05-24T00:00:00.000
2024-12-12 23:54:07,462 - INFO - pnl: 2024-05-18T23:59:59.999 151259.00401278693 === 0.756%
2024-12-12 23:54:07,466 - DEBUG - cur time: 2024-05-19T23:59:59.999 == next bar open time: 2024-05-20T00:00:00.000 == close pos time: 2024-05-25T00:00:00.000
2024-12-12 23:54:07,467 - INFO - pnl: 2024-05-19T23:59:59.999 152479.28828452658 === 0.807%
2024-12-12 23:54:07,471 - DEBUG - cur time: 2024-05-20T23:59:59.999 == next bar open time: 2024-05-21T00:00:00.000 == close pos time: 2024-05-26T00:00:00.000
2024-12-12 23:54:07,471 - INFO - pnl: 2024-05-20T23:59:59.999 152912.84674970564 === 0.284%
2024-12-12 23:54:07,475 - DEBUG - cur time: 2024-05-21T23:59:59.999 == next bar open time: 2024-05-22T00:00:00.000 == close pos time: 2024-05-27T00:00:00.000
2024-12-12 23:54:07,475 - INFO - pnl: 2024-05-21T23:59:59.999 150124.3668339263 === -1.824%
2024-12-12 23:54:07,479 - DEBUG - cur time: 2024-05-22T23:59:59.999 == next bar open time: 2024-05-23T00:00:00.000 == close pos time: 2024-05-28T00:00:00.000
2024-12-12 23:54:07,491 - DEBUG - close time 2024-05-22T23:59:59.999 == vol_threshold: 12747766.6
2024-12-12 23:54:07,491 - DEBUG - 2024-05-22T23:59:59.999 == all trade symbol 239 == remain 167 after VOL filter
2024-12-12 23:54:07,491 - DEBUG - sorted_long_factors: shape: (167, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ONEUSDT     ┆ -5.255271    ┆ 0    ┆ 166          │
│ WLDUSDT     ┆ -4.567148    ┆ 1    ┆ 165          │
│ MAVUSDT     ┆ -4.149137    ┆ 2    ┆ 164          │
│ ALTUSDT     ┆ -3.981422    ┆ 3    ┆ 163          │
│ PIXELUSDT   ┆ -3.963051    ┆ 4    ┆ 162          │
│ BLZUSDT     ┆ -3.89005     ┆ 5    ┆ 161          │
│ XVGUSDT     ┆ -3.793085    ┆ 6    ┆ 160          │
│ CHZUSDT     ┆ -3.534292    ┆ 7    ┆ 159          │
│ ONDOUSDT    ┆ -3.495718    ┆ 8    ┆ 158          │
│ DUSKUSDT    ┆ -3.337177    ┆ 9    ┆ 157          │
│ …           ┆ …            ┆ …    ┆ …            │
│ RENUSDT     ┆ 3.463977     ┆ 157  ┆ 9            │
│ ENSUSDT     ┆ 3.649008     ┆ 158  ┆ 8            │
│ UNIUSDT     ┆ 3.672338     ┆ 159  ┆ 7            │
│ TLMUSDT     ┆ 4.085527     ┆ 160  ┆ 6            │
│ PEOPLEUSDT  ┆ 5.285036     ┆ 161  ┆ 5            │
│ 1000XECUSDT ┆ 5.286507     ┆ 162  ┆ 4            │
│ XLMUSDT     ┆ 5.395454     ┆ 163  ┆ 3            │
│ NKNUSDT     ┆ 5.481396     ┆ 164  ┆ 2            │
│ EDUUSDT     ┆ 6.063696     ┆ 165  ┆ 1            │
│ CELOUSDT    ┆ 6.209857     ┆ 166  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,500 - INFO - cur close time: 2024-05-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:07,500 - DEBUG - mean expected ret (mean factor): -0.07801172492447399
2024-12-12 23:54:07,504 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,504 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 5000.0      ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,504 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.032401    ┆ 0.22345     ┆ 0.11615     ┆ 0.0133987   ┆ … ┆ 0.02428 ┆ null   ┆ null    ┆ 0.5592  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,510 - DEBUG - update position: 2024-05-22T23:59:59.999 === diff_trading_value: 387533.49940464203 == cash: 147268.67127433096 
2024-12-12 23:54:07,512 - INFO - pnl: 2024-05-22T23:59:59.999 147268.67127433096 === -1.902%
2024-12-12 23:54:07,513 - DEBUG - cur time: 2024-05-23T23:59:59.999 == next bar open time: 2024-05-24T00:00:00.000 == close pos time: 2024-05-29T00:00:00.000
2024-12-12 23:54:07,517 - INFO - pnl: 2024-05-23T23:59:59.999 149330.57746256987 === 1.400%
2024-12-12 23:54:07,522 - DEBUG - cur time: 2024-05-24T23:59:59.999 == next bar open time: 2024-05-25T00:00:00.000 == close pos time: 2024-05-30T00:00:00.000
2024-12-12 23:54:07,522 - INFO - pnl: 2024-05-24T23:59:59.999 149074.346138431 === -0.172%
2024-12-12 23:54:07,526 - DEBUG - cur time: 2024-05-25T23:59:59.999 == next bar open time: 2024-05-26T00:00:00.000 == close pos time: 2024-05-31T00:00:00.000
2024-12-12 23:54:07,526 - INFO - pnl: 2024-05-25T23:59:59.999 144075.25762676008 === -3.353%
2024-12-12 23:54:07,534 - DEBUG - cur time: 2024-05-26T23:59:59.999 == next bar open time: 2024-05-27T00:00:00.000 == close pos time: 2024-06-01T00:00:00.000
2024-12-12 23:54:07,534 - INFO - pnl: 2024-05-26T23:59:59.999 145002.16872601563 === 0.643%
2024-12-12 23:54:07,538 - DEBUG - cur time: 2024-05-27T23:59:59.999 == next bar open time: 2024-05-28T00:00:00.000 == close pos time: 2024-06-02T00:00:00.000
2024-12-12 23:54:07,555 - DEBUG - close time 2024-05-27T23:59:59.999 == vol_threshold: 11078171.679999998
2024-12-12 23:54:07,556 - DEBUG - 2024-05-27T23:59:59.999 == all trade symbol 242 == remain 169 after VOL filter
2024-12-12 23:54:07,558 - DEBUG - sorted_long_factors: shape: (169, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ RIFUSDT    ┆ -5.827589    ┆ 0    ┆ 168          │
│ AXLUSDT    ┆ -4.990221    ┆ 1    ┆ 167          │
│ AIUSDT     ┆ -4.308564    ┆ 2    ┆ 166          │
│ SXPUSDT    ┆ -4.135826    ┆ 3    ┆ 165          │
│ STXUSDT    ┆ -4.115395    ┆ 4    ┆ 164          │
│ ONGUSDT    ┆ -4.018043    ┆ 5    ┆ 163          │
│ RDNTUSDT   ┆ -3.690358    ┆ 6    ┆ 162          │
│ PORTALUSDT ┆ -3.338429    ┆ 7    ┆ 161          │
│ ASTRUSDT   ┆ -3.144255    ┆ 8    ┆ 160          │
│ LUNA2USDT  ┆ -3.048267    ┆ 9    ┆ 159          │
│ …          ┆ …            ┆ …    ┆ …            │
│ DENTUSDT   ┆ 3.358065     ┆ 159  ┆ 9            │
│ WAXPUSDT   ┆ 3.520076     ┆ 160  ┆ 8            │
│ IOSTUSDT   ┆ 3.696634     ┆ 161  ┆ 7            │
│ HIGHUSDT   ┆ 3.915843     ┆ 162  ┆ 6            │
│ RVNUSDT    ┆ 4.337886     ┆ 163  ┆ 5            │
│ ANKRUSDT   ┆ 4.424868     ┆ 164  ┆ 4            │
│ STMXUSDT   ┆ 4.689647     ┆ 165  ┆ 3            │
│ SKLUSDT    ┆ 5.024959     ┆ 166  ┆ 2            │
│ XTZUSDT    ┆ 6.264626     ┆ 167  ┆ 1            │
│ KEYUSDT    ┆ 6.662865     ┆ 168  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,562 - WARNING - 2024-05-27T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,562 - INFO - cur close time: 2024-05-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:07,562 - DEBUG - mean expected ret (mean factor): -0.027070452429475502
2024-12-12 23:54:07,569 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,570 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,570 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.039223    ┆ 0.27812     ┆ 0.11594     ┆ 0.0167246   ┆ … ┆ 0.02505 ┆ null   ┆ null    ┆ 0.5595  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,575 - DEBUG - update position: 2024-05-27T23:59:59.999 === diff_trading_value: 385294.42483788566 == cash: 143819.65442568116 
2024-12-12 23:54:07,575 - INFO - pnl: 2024-05-27T23:59:59.999 143819.65442568116 === -0.816%
2024-12-12 23:54:07,580 - DEBUG - cur time: 2024-05-28T23:59:59.999 == next bar open time: 2024-05-29T00:00:00.000 == close pos time: 2024-06-03T00:00:00.000
2024-12-12 23:54:07,583 - INFO - pnl: 2024-05-28T23:59:59.999 144951.36808307222 === 0.787%
2024-12-12 23:54:07,583 - DEBUG - cur time: 2024-05-29T23:59:59.999 == next bar open time: 2024-05-30T00:00:00.000 == close pos time: 2024-06-04T00:00:00.000
2024-12-12 23:54:07,587 - INFO - pnl: 2024-05-29T23:59:59.999 143826.54499421385 === -0.776%
2024-12-12 23:54:07,590 - DEBUG - cur time: 2024-05-30T23:59:59.999 == next bar open time: 2024-05-31T00:00:00.000 == close pos time: 2024-06-05T00:00:00.000
2024-12-12 23:54:07,591 - INFO - pnl: 2024-05-30T23:59:59.999 140244.08210674953 === -2.491%
2024-12-12 23:54:07,591 - DEBUG - cur time: 2024-05-31T23:59:59.999 == next bar open time: 2024-06-01T00:00:00.000 == close pos time: 2024-06-06T00:00:00.000
2024-12-12 23:54:07,595 - INFO - pnl: 2024-05-31T23:59:59.999 142401.2985882126 === 1.538%
2024-12-12 23:54:07,595 - DEBUG - cur time: 2024-06-01T23:59:59.999 == next bar open time: 2024-06-02T00:00:00.000 == close pos time: 2024-06-07T00:00:00.000
2024-12-12 23:54:07,610 - DEBUG - close time 2024-06-01T23:59:59.999 == vol_threshold: 7100327.8
2024-12-12 23:54:07,610 - DEBUG - 2024-06-01T23:59:59.999 == all trade symbol 243 == remain 170 after VOL filter
2024-12-12 23:54:07,610 - DEBUG - sorted_long_factors: shape: (170, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ BLZUSDT    ┆ -8.555535    ┆ 0    ┆ 169          │
│ RIFUSDT    ┆ -4.763313    ┆ 1    ┆ 168          │
│ STXUSDT    ┆ -4.120983    ┆ 2    ┆ 167          │
│ ORBSUSDT   ┆ -3.992667    ┆ 3    ┆ 166          │
│ WLDUSDT    ┆ -3.694418    ┆ 4    ┆ 165          │
│ TLMUSDT    ┆ -3.512559    ┆ 5    ┆ 164          │
│ JTOUSDT    ┆ -3.416946    ┆ 6    ┆ 163          │
│ OPUSDT     ┆ -3.388945    ┆ 7    ┆ 162          │
│ YGGUSDT    ┆ -3.186792    ┆ 8    ┆ 161          │
│ STEEMUSDT  ┆ -2.875836    ┆ 9    ┆ 160          │
│ …          ┆ …            ┆ …    ┆ …            │
│ MANAUSDT   ┆ 3.329756     ┆ 160  ┆ 9            │
│ IOSTUSDT   ┆ 3.339481     ┆ 161  ┆ 8            │
│ KNCUSDT    ┆ 3.463531     ┆ 162  ┆ 7            │
│ VETUSDT    ┆ 3.581405     ┆ 163  ┆ 6            │
│ PEOPLEUSDT ┆ 3.635876     ┆ 164  ┆ 5            │
│ BATUSDT    ┆ 4.420873     ┆ 165  ┆ 4            │
│ XLMUSDT    ┆ 4.511013     ┆ 166  ┆ 3            │
│ HIGHUSDT   ┆ 4.738437     ┆ 167  ┆ 2            │
│ ONGUSDT    ┆ 5.270375     ┆ 168  ┆ 1            │
│ STMXUSDT   ┆ 6.173574     ┆ 169  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,619 - WARNING - 2024-06-01T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,619 - INFO - cur close time: 2024-06-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:07,619 - DEBUG - mean expected ret (mean factor): 0.024395388134001154
2024-12-12 23:54:07,622 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,622 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,622 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.033153    ┆ 0.25271     ┆ 0.12039     ┆ 0.014871    ┆ … ┆ 0.02363 ┆ null   ┆ null    ┆ 0.5212  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,629 - DEBUG - update position: 2024-06-01T23:59:59.999 === diff_trading_value: 291871.9998727233 == cash: 141027.81835104135 
2024-12-12 23:54:07,629 - INFO - pnl: 2024-06-01T23:59:59.999 141027.81835104135 === -0.965%
2024-12-12 23:54:07,633 - DEBUG - cur time: 2024-06-02T23:59:59.999 == next bar open time: 2024-06-03T00:00:00.000 == close pos time: 2024-06-08T00:00:00.000
2024-12-12 23:54:07,633 - INFO - pnl: 2024-06-02T23:59:59.999 141893.24750791892 === 0.614%
2024-12-12 23:54:07,639 - DEBUG - cur time: 2024-06-03T23:59:59.999 == next bar open time: 2024-06-04T00:00:00.000 == close pos time: 2024-06-09T00:00:00.000
2024-12-12 23:54:07,639 - INFO - pnl: 2024-06-03T23:59:59.999 140548.6817623475 === -0.948%
2024-12-12 23:54:07,642 - DEBUG - cur time: 2024-06-04T23:59:59.999 == next bar open time: 2024-06-05T00:00:00.000 == close pos time: 2024-06-10T00:00:00.000
2024-12-12 23:54:07,642 - INFO - pnl: 2024-06-04T23:59:59.999 139856.52539494075 === -0.492%
2024-12-12 23:54:07,646 - DEBUG - cur time: 2024-06-05T23:59:59.999 == next bar open time: 2024-06-06T00:00:00.000 == close pos time: 2024-06-11T00:00:00.000
2024-12-12 23:54:07,649 - INFO - pnl: 2024-06-05T23:59:59.999 138945.0906335794 === -0.652%
2024-12-12 23:54:07,649 - DEBUG - cur time: 2024-06-06T23:59:59.999 == next bar open time: 2024-06-07T00:00:00.000 == close pos time: 2024-06-12T00:00:00.000
2024-12-12 23:54:07,663 - DEBUG - close time 2024-06-06T23:59:59.999 == vol_threshold: 9831260.629999999
2024-12-12 23:54:07,665 - DEBUG - 2024-06-06T23:59:59.999 == all trade symbol 242 == remain 169 after VOL filter
2024-12-12 23:54:07,667 - DEBUG - sorted_long_factors: shape: (169, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ AXLUSDT     ┆ -5.153051    ┆ 0    ┆ 168          │
│ CHZUSDT     ┆ -4.841811    ┆ 1    ┆ 167          │
│ VANRYUSDT   ┆ -4.361968    ┆ 2    ┆ 166          │
│ DENTUSDT    ┆ -4.082482    ┆ 3    ┆ 165          │
│ JUPUSDT     ┆ -3.98857     ┆ 4    ┆ 164          │
│ WLDUSDT     ┆ -3.81152     ┆ 5    ┆ 163          │
│ RDNTUSDT    ┆ -3.637932    ┆ 6    ┆ 162          │
│ YGGUSDT     ┆ -3.590932    ┆ 7    ┆ 161          │
│ ALTUSDT     ┆ -3.485258    ┆ 8    ┆ 160          │
│ ARPAUSDT    ┆ -3.371593    ┆ 9    ┆ 159          │
│ …           ┆ …            ┆ …    ┆ …            │
│ OMGUSDT     ┆ 3.456833     ┆ 159  ┆ 9            │
│ BNXUSDT     ┆ 3.538364     ┆ 160  ┆ 8            │
│ HIGHUSDT    ┆ 3.629161     ┆ 161  ┆ 7            │
│ ARKMUSDT    ┆ 3.861904     ┆ 162  ┆ 6            │
│ ADAUSDT     ┆ 4.012238     ┆ 163  ┆ 5            │
│ DODOXUSDT   ┆ 4.327302     ┆ 164  ┆ 4            │
│ XLMUSDT     ┆ 4.546992     ┆ 165  ┆ 3            │
│ 1000XECUSDT ┆ 6.20072      ┆ 166  ┆ 2            │
│ ARKUSDT     ┆ 8.824221     ┆ 167  ┆ 1            │
│ FLOWUSDT    ┆ 11.580854    ┆ 168  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,671 - WARNING - 2024-06-06T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,671 - INFO - cur close time: 2024-06-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:07,671 - DEBUG - mean expected ret (mean factor): -0.17624228805725647
2024-12-12 23:54:07,675 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,675 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,675 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.031822    ┆ 0.32081     ┆ 0.12119     ┆ 0.0143597   ┆ … ┆ 0.02379 ┆ null   ┆ null    ┆ 0.5273  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,683 - DEBUG - update position: 2024-06-06T23:59:59.999 === diff_trading_value: 308428.0791908512 == cash: 141072.91559857462 
2024-12-12 23:54:07,683 - INFO - pnl: 2024-06-06T23:59:59.999 141072.91559857462 === 1.531%
2024-12-12 23:54:07,687 - DEBUG - cur time: 2024-06-07T23:59:59.999 == next bar open time: 2024-06-08T00:00:00.000 == close pos time: 2024-06-13T00:00:00.000
2024-12-12 23:54:07,687 - INFO - pnl: 2024-06-07T23:59:59.999 146477.91096537834 === 3.831%
2024-12-12 23:54:07,691 - DEBUG - cur time: 2024-06-08T23:59:59.999 == next bar open time: 2024-06-09T00:00:00.000 == close pos time: 2024-06-14T00:00:00.000
2024-12-12 23:54:07,691 - INFO - pnl: 2024-06-08T23:59:59.999 147766.0703542136 === 0.879%
2024-12-12 23:54:07,695 - DEBUG - cur time: 2024-06-09T23:59:59.999 == next bar open time: 2024-06-10T00:00:00.000 == close pos time: 2024-06-15T00:00:00.000
2024-12-12 23:54:07,695 - INFO - pnl: 2024-06-09T23:59:59.999 147318.54235989336 === -0.303%
2024-12-12 23:54:07,695 - DEBUG - cur time: 2024-06-10T23:59:59.999 == next bar open time: 2024-06-11T00:00:00.000 == close pos time: 2024-06-16T00:00:00.000
2024-12-12 23:54:07,701 - INFO - pnl: 2024-06-10T23:59:59.999 147740.0456024364 === 0.286%
2024-12-12 23:54:07,704 - DEBUG - cur time: 2024-06-11T23:59:59.999 == next bar open time: 2024-06-12T00:00:00.000 == close pos time: 2024-06-17T00:00:00.000
2024-12-12 23:54:07,713 - DEBUG - close time 2024-06-11T23:59:59.999 == vol_threshold: 14546276.27
2024-12-12 23:54:07,713 - DEBUG - 2024-06-11T23:59:59.999 == all trade symbol 242 == remain 169 after VOL filter
2024-12-12 23:54:07,717 - DEBUG - sorted_long_factors: shape: (169, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ RDNTUSDT    ┆ -5.538372    ┆ 0    ┆ 168          │
│ ALTUSDT     ┆ -5.046631    ┆ 1    ┆ 167          │
│ NTRNUSDT    ┆ -4.898394    ┆ 2    ┆ 166          │
│ PORTALUSDT  ┆ -4.348589    ┆ 3    ┆ 165          │
│ DYDXUSDT    ┆ -4.124234    ┆ 4    ┆ 164          │
│ HOOKUSDT    ┆ -3.799888    ┆ 5    ┆ 163          │
│ MAGICUSDT   ┆ -3.786299    ┆ 6    ┆ 162          │
│ DOGEUSDT    ┆ -3.69606     ┆ 7    ┆ 161          │
│ CHRUSDT     ┆ -3.30267     ┆ 8    ┆ 160          │
│ PYTHUSDT    ┆ -3.27856     ┆ 9    ┆ 159          │
│ …           ┆ …            ┆ …    ┆ …            │
│ HIGHUSDT    ┆ 4.057294     ┆ 159  ┆ 9            │
│ POLYXUSDT   ┆ 4.203501     ┆ 160  ┆ 8            │
│ ASTRUSDT    ┆ 4.593299     ┆ 161  ┆ 7            │
│ WAXPUSDT    ┆ 4.660262     ┆ 162  ┆ 6            │
│ OXTUSDT     ┆ 4.763082     ┆ 163  ┆ 5            │
│ ENJUSDT     ┆ 5.101286     ┆ 164  ┆ 4            │
│ 1000XECUSDT ┆ 5.127456     ┆ 165  ┆ 3            │
│ LOOMUSDT    ┆ 5.206118     ┆ 166  ┆ 2            │
│ OMUSDT      ┆ 5.731138     ┆ 167  ┆ 1            │
│ LEVERUSDT   ┆ 8.215286     ┆ 168  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,726 - WARNING - 2024-06-11T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,726 - INFO - cur close time: 2024-06-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:07,726 - DEBUG - mean expected ret (mean factor): 0.03716627435121
2024-12-12 23:54:07,729 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,729 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,729 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.027134    ┆ 0.23658     ┆ 0.10074     ┆ 0.0127355   ┆ … ┆ 0.02011 ┆ null   ┆ null    ┆ 0.4304  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,737 - DEBUG - update position: 2024-06-11T23:59:59.999 === diff_trading_value: 265975.2333569031 == cash: 147557.02697291895 
2024-12-12 23:54:07,740 - INFO - pnl: 2024-06-11T23:59:59.999 147557.02697291895 === -0.124%
2024-12-12 23:54:07,746 - DEBUG - cur time: 2024-06-12T23:59:59.999 == next bar open time: 2024-06-13T00:00:00.000 == close pos time: 2024-06-18T00:00:00.000
2024-12-12 23:54:07,746 - INFO - pnl: 2024-06-12T23:59:59.999 144899.92895026327 === -1.801%
2024-12-12 23:54:07,753 - DEBUG - cur time: 2024-06-13T23:59:59.999 == next bar open time: 2024-06-14T00:00:00.000 == close pos time: 2024-06-19T00:00:00.000
2024-12-12 23:54:07,754 - INFO - pnl: 2024-06-13T23:59:59.999 147364.16166084426 === 1.701%
2024-12-12 23:54:07,758 - DEBUG - cur time: 2024-06-14T23:59:59.999 == next bar open time: 2024-06-15T00:00:00.000 == close pos time: 2024-06-20T00:00:00.000
2024-12-12 23:54:07,760 - INFO - pnl: 2024-06-14T23:59:59.999 146458.47402797168 === -0.615%
2024-12-12 23:54:07,762 - DEBUG - cur time: 2024-06-15T23:59:59.999 == next bar open time: 2024-06-16T00:00:00.000 == close pos time: 2024-06-21T00:00:00.000
2024-12-12 23:54:07,766 - INFO - pnl: 2024-06-15T23:59:59.999 146529.33838546413 === 0.048%
2024-12-12 23:54:07,773 - DEBUG - cur time: 2024-06-16T23:59:59.999 == next bar open time: 2024-06-17T00:00:00.000 == close pos time: 2024-06-22T00:00:00.000
2024-12-12 23:54:07,784 - DEBUG - close time 2024-06-16T23:59:59.999 == vol_threshold: 7759688.709999992
2024-12-12 23:54:07,784 - DEBUG - 2024-06-16T23:59:59.999 == all trade symbol 244 == remain 171 after VOL filter
2024-12-12 23:54:07,788 - DEBUG - sorted_long_factors: shape: (171, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ KAVAUSDT  ┆ -5.040246    ┆ 0    ┆ 170          │
│ IOSTUSDT  ┆ -4.887719    ┆ 1    ┆ 169          │
│ POWRUSDT  ┆ -4.494897    ┆ 2    ┆ 168          │
│ SXPUSDT   ┆ -3.571095    ┆ 3    ┆ 167          │
│ MINAUSDT  ┆ -3.250958    ┆ 4    ┆ 166          │
│ DENTUSDT  ┆ -3.165217    ┆ 5    ┆ 165          │
│ AEVOUSDT  ┆ -3.147299    ┆ 6    ┆ 164          │
│ RIFUSDT   ┆ -3.14168     ┆ 7    ┆ 163          │
│ WAXPUSDT  ┆ -2.891035    ┆ 8    ┆ 162          │
│ XTZUSDT   ┆ -2.858182    ┆ 9    ┆ 161          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ALPHAUSDT ┆ 3.0632       ┆ 161  ┆ 9            │
│ REEFUSDT  ┆ 3.116694     ┆ 162  ┆ 8            │
│ ASTRUSDT  ┆ 3.308047     ┆ 163  ┆ 7            │
│ ZRXUSDT   ┆ 3.922433     ┆ 164  ┆ 6            │
│ HOTUSDT   ┆ 4.144264     ┆ 165  ┆ 5            │
│ IOTAUSDT  ┆ 4.209746     ┆ 166  ┆ 4            │
│ TRXUSDT   ┆ 5.220254     ┆ 167  ┆ 3            │
│ CELOUSDT  ┆ 6.023106     ┆ 168  ┆ 2            │
│ IDUSDT    ┆ 6.974218     ┆ 169  ┆ 1            │
│ CELRUSDT  ┆ 9.586899     ┆ 170  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,792 - WARNING - 2024-06-16T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,792 - INFO - cur close time: 2024-06-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:07,792 - DEBUG - mean expected ret (mean factor): -0.014389559583654942
2024-12-12 23:54:07,800 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,800 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,800 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025232    ┆ 0.20674     ┆ 0.1044      ┆ 0.0123048   ┆ … ┆ 0.01968 ┆ null   ┆ null    ┆ 0.4144  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,805 - DEBUG - update position: 2024-06-16T23:59:59.999 === diff_trading_value: 360759.67162532883 == cash: 145137.8984479228 
2024-12-12 23:54:07,805 - INFO - pnl: 2024-06-16T23:59:59.999 145137.8984479228 === -0.950%
2024-12-12 23:54:07,809 - DEBUG - cur time: 2024-06-17T23:59:59.999 == next bar open time: 2024-06-18T00:00:00.000 == close pos time: 2024-06-23T00:00:00.000
2024-12-12 23:54:07,809 - INFO - pnl: 2024-06-17T23:59:59.999 145632.79926324854 === 0.341%
2024-12-12 23:54:07,813 - DEBUG - cur time: 2024-06-18T23:59:59.999 == next bar open time: 2024-06-19T00:00:00.000 == close pos time: 2024-06-24T00:00:00.000
2024-12-12 23:54:07,817 - INFO - pnl: 2024-06-18T23:59:59.999 144370.92250755464 === -0.866%
2024-12-12 23:54:07,822 - DEBUG - cur time: 2024-06-19T23:59:59.999 == next bar open time: 2024-06-20T00:00:00.000 == close pos time: 2024-06-25T00:00:00.000
2024-12-12 23:54:07,822 - INFO - pnl: 2024-06-19T23:59:59.999 144635.33641070034 === 0.183%
2024-12-12 23:54:07,826 - DEBUG - cur time: 2024-06-20T23:59:59.999 == next bar open time: 2024-06-21T00:00:00.000 == close pos time: 2024-06-26T00:00:00.000
2024-12-12 23:54:07,829 - INFO - pnl: 2024-06-20T23:59:59.999 146218.64229140786 === 1.095%
2024-12-12 23:54:07,833 - DEBUG - cur time: 2024-06-21T23:59:59.999 == next bar open time: 2024-06-22T00:00:00.000 == close pos time: 2024-06-27T00:00:00.000
2024-12-12 23:54:07,846 - DEBUG - close time 2024-06-21T23:59:59.999 == vol_threshold: 13295723.400000002
2024-12-12 23:54:07,846 - DEBUG - 2024-06-21T23:59:59.999 == all trade symbol 245 == remain 171 after VOL filter
2024-12-12 23:54:07,846 - DEBUG - sorted_long_factors: shape: (171, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ CHRUSDT   ┆ -6.29186     ┆ 0    ┆ 170          │
│ BLZUSDT   ┆ -4.576297    ┆ 1    ┆ 169          │
│ KAVAUSDT  ┆ -3.894885    ┆ 2    ┆ 168          │
│ DOGEUSDT  ┆ -3.834396    ┆ 3    ┆ 167          │
│ IOTXUSDT  ┆ -3.820658    ┆ 4    ┆ 166          │
│ VANRYUSDT ┆ -3.794937    ┆ 5    ┆ 165          │
│ RVNUSDT   ┆ -3.754838    ┆ 6    ┆ 164          │
│ HFTUSDT   ┆ -3.636627    ┆ 7    ┆ 163          │
│ DUSKUSDT  ┆ -3.486018    ┆ 8    ┆ 162          │
│ LUNA2USDT ┆ -3.376624    ┆ 9    ┆ 161          │
│ …         ┆ …            ┆ …    ┆ …            │
│ IOTAUSDT  ┆ 2.75809      ┆ 161  ┆ 9            │
│ MANAUSDT  ┆ 2.941035     ┆ 162  ┆ 8            │
│ ONTUSDT   ┆ 2.986173     ┆ 163  ┆ 7            │
│ TRXUSDT   ┆ 3.505569     ┆ 164  ┆ 6            │
│ LOOMUSDT  ┆ 3.620148     ┆ 165  ┆ 5            │
│ FLMUSDT   ┆ 3.98846      ┆ 166  ┆ 4            │
│ BNTUSDT   ┆ 4.008235     ┆ 167  ┆ 3            │
│ ALGOUSDT  ┆ 4.26623      ┆ 168  ┆ 2            │
│ HBARUSDT  ┆ 4.31119      ┆ 169  ┆ 1            │
│ DENTUSDT  ┆ 8.128291     ┆ 170  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,854 - WARNING - 2024-06-21T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,854 - INFO - cur close time: 2024-06-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:07,854 - DEBUG - mean expected ret (mean factor): -0.12228732863045094
2024-12-12 23:54:07,860 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,860 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,860 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.020361    ┆ 0.16987     ┆ 0.09069     ┆ 0.011408    ┆ … ┆ 0.01701 ┆ null   ┆ null    ┆ 0.3594  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,866 - DEBUG - update position: 2024-06-21T23:59:59.999 === diff_trading_value: 303325.3831716114 == cash: 146223.16153246394 
2024-12-12 23:54:07,867 - INFO - pnl: 2024-06-21T23:59:59.999 146223.16153246394 === 0.003%
2024-12-12 23:54:07,873 - DEBUG - cur time: 2024-06-22T23:59:59.999 == next bar open time: 2024-06-23T00:00:00.000 == close pos time: 2024-06-28T00:00:00.000
2024-12-12 23:54:07,874 - INFO - pnl: 2024-06-22T23:59:59.999 147180.03499233176 === 0.654%
2024-12-12 23:54:07,876 - DEBUG - cur time: 2024-06-23T23:59:59.999 == next bar open time: 2024-06-24T00:00:00.000 == close pos time: 2024-06-29T00:00:00.000
2024-12-12 23:54:07,880 - INFO - pnl: 2024-06-23T23:59:59.999 147636.5592584042 === 0.310%
2024-12-12 23:54:07,884 - DEBUG - cur time: 2024-06-24T23:59:59.999 == next bar open time: 2024-06-25T00:00:00.000 == close pos time: 2024-06-30T00:00:00.000
2024-12-12 23:54:07,884 - INFO - pnl: 2024-06-24T23:59:59.999 149803.1063747245 === 1.467%
2024-12-12 23:54:07,890 - DEBUG - cur time: 2024-06-25T23:59:59.999 == next bar open time: 2024-06-26T00:00:00.000 == close pos time: 2024-07-01T00:00:00.000
2024-12-12 23:54:07,890 - INFO - pnl: 2024-06-25T23:59:59.999 147429.66464935534 === -1.584%
2024-12-12 23:54:07,892 - DEBUG - cur time: 2024-06-26T23:59:59.999 == next bar open time: 2024-06-27T00:00:00.000 == close pos time: 2024-07-02T00:00:00.000
2024-12-12 23:54:07,905 - DEBUG - close time 2024-06-26T23:59:59.999 == vol_threshold: 8732410.600000001
2024-12-12 23:54:07,905 - DEBUG - 2024-06-26T23:59:59.999 == all trade symbol 245 == remain 171 after VOL filter
2024-12-12 23:54:07,909 - DEBUG - sorted_long_factors: shape: (171, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ XAIUSDT     ┆ -4.429019    ┆ 0    ┆ 170          │
│ RIFUSDT     ┆ -3.947853    ┆ 1    ┆ 169          │
│ TRUUSDT     ┆ -3.630972    ┆ 2    ┆ 168          │
│ IOTXUSDT    ┆ -3.404277    ┆ 3    ┆ 167          │
│ BAKEUSDT    ┆ -3.222623    ┆ 4    ┆ 166          │
│ WOOUSDT     ┆ -3.168779    ┆ 5    ┆ 165          │
│ CHRUSDT     ┆ -3.136973    ┆ 6    ┆ 164          │
│ BIGTIMEUSDT ┆ -2.986121    ┆ 7    ┆ 163          │
│ GALAUSDT    ┆ -2.915197    ┆ 8    ┆ 162          │
│ RDNTUSDT    ┆ -2.862745    ┆ 9    ┆ 161          │
│ …           ┆ …            ┆ …    ┆ …            │
│ VETUSDT     ┆ 3.553014     ┆ 161  ┆ 9            │
│ HBARUSDT    ┆ 3.560169     ┆ 162  ┆ 8            │
│ GLMUSDT     ┆ 4.004165     ┆ 163  ┆ 7            │
│ TUSDT       ┆ 4.018826     ┆ 164  ┆ 6            │
│ JOEUSDT     ┆ 4.231003     ┆ 165  ┆ 5            │
│ FLOWUSDT    ┆ 4.444229     ┆ 166  ┆ 4            │
│ ASTRUSDT    ┆ 4.782875     ┆ 167  ┆ 3            │
│ BNXUSDT     ┆ 4.831711     ┆ 168  ┆ 2            │
│ LOOMUSDT    ┆ 5.097188     ┆ 169  ┆ 1            │
│ DENTUSDT    ┆ 9.727266     ┆ 170  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,913 - WARNING - 2024-06-26T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,913 - INFO - cur close time: 2024-06-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:07,913 - DEBUG - mean expected ret (mean factor): 0.09058579274330382
2024-12-12 23:54:07,920 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,920 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,920 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.02188     ┆ 0.1679      ┆ 0.08229     ┆ 0.0125375   ┆ … ┆ 0.01769 ┆ null   ┆ null    ┆ 0.3615  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,926 - DEBUG - update position: 2024-06-26T23:59:59.999 === diff_trading_value: 311564.05401258357 == cash: 147435.93025655753 
2024-12-12 23:54:07,926 - INFO - pnl: 2024-06-26T23:59:59.999 147435.93025655753 === 0.004%
2024-12-12 23:54:07,930 - DEBUG - cur time: 2024-06-27T23:59:59.999 == next bar open time: 2024-06-28T00:00:00.000 == close pos time: 2024-07-03T00:00:00.000
2024-12-12 23:54:07,934 - INFO - pnl: 2024-06-27T23:59:59.999 148636.04319842067 === 0.814%
2024-12-12 23:54:07,934 - DEBUG - cur time: 2024-06-28T23:59:59.999 == next bar open time: 2024-06-29T00:00:00.000 == close pos time: 2024-07-04T00:00:00.000
2024-12-12 23:54:07,938 - INFO - pnl: 2024-06-28T23:59:59.999 149781.51590577897 === 0.771%
2024-12-12 23:54:07,942 - DEBUG - cur time: 2024-06-29T23:59:59.999 == next bar open time: 2024-06-30T00:00:00.000 == close pos time: 2024-07-05T00:00:00.000
2024-12-12 23:54:07,942 - INFO - pnl: 2024-06-29T23:59:59.999 149016.97054706106 === -0.510%
2024-12-12 23:54:07,950 - DEBUG - cur time: 2024-06-30T23:59:59.999 == next bar open time: 2024-07-01T00:00:00.000 == close pos time: 2024-07-06T00:00:00.000
2024-12-12 23:54:07,951 - INFO - pnl: 2024-06-30T23:59:59.999 149165.20109497357 === 0.099%
2024-12-12 23:54:07,956 - DEBUG - cur time: 2024-07-01T23:59:59.999 == next bar open time: 2024-07-02T00:00:00.000 == close pos time: 2024-07-07T00:00:00.000
2024-12-12 23:54:07,969 - DEBUG - close time 2024-07-01T23:59:59.999 == vol_threshold: 10742085.75
2024-12-12 23:54:07,969 - DEBUG - 2024-07-01T23:59:59.999 == all trade symbol 246 == remain 172 after VOL filter
2024-12-12 23:54:07,973 - DEBUG - sorted_long_factors: shape: (172, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ USTCUSDT  ┆ -5.056494    ┆ 0    ┆ 171          │
│ ENJUSDT   ┆ -4.80502     ┆ 1    ┆ 170          │
│ RDNTUSDT  ┆ -4.286701    ┆ 2    ┆ 169          │
│ ONDOUSDT  ┆ -3.852487    ┆ 3    ┆ 168          │
│ MANTAUSDT ┆ -3.677923    ┆ 4    ┆ 167          │
│ WOOUSDT   ┆ -3.674334    ┆ 5    ┆ 166          │
│ MYROUSDT  ┆ -3.499104    ┆ 6    ┆ 165          │
│ RSRUSDT   ┆ -3.430703    ┆ 7    ┆ 164          │
│ TNSRUSDT  ┆ -3.417675    ┆ 8    ┆ 163          │
│ SAGAUSDT  ┆ -3.35642     ┆ 9    ┆ 162          │
│ …         ┆ …            ┆ …    ┆ …            │
│ SPELLUSDT ┆ 3.141883     ┆ 162  ┆ 9            │
│ ASTRUSDT  ┆ 3.209571     ┆ 163  ┆ 8            │
│ HBARUSDT  ┆ 3.408468     ┆ 164  ┆ 7            │
│ OXTUSDT   ┆ 3.507306     ┆ 165  ┆ 6            │
│ MANAUSDT  ┆ 3.567814     ┆ 166  ┆ 5            │
│ ANKRUSDT  ┆ 3.735071     ┆ 167  ┆ 4            │
│ 1INCHUSDT ┆ 4.392743     ┆ 168  ┆ 3            │
│ TUSDT     ┆ 4.849751     ┆ 169  ┆ 2            │
│ ALGOUSDT  ┆ 5.130164     ┆ 170  ┆ 1            │
│ BATUSDT   ┆ 10.220061    ┆ 171  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:07,979 - WARNING - 2024-07-01T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:07,979 - INFO - cur close time: 2024-07-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:07,979 - DEBUG - mean expected ret (mean factor): -0.0331704513780307
2024-12-12 23:54:07,980 - DEBUG - begin to update pos: =========
2024-12-12 23:54:07,980 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,980 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025564    ┆ 0.17017     ┆ 0.08077     ┆ 0.0114216   ┆ … ┆ 0.01715 ┆ null   ┆ null    ┆ 0.3567  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:07,990 - DEBUG - update position: 2024-07-01T23:59:59.999 === diff_trading_value: 309001.79458024784 == cash: 149079.79793723254 
2024-12-12 23:54:07,990 - INFO - pnl: 2024-07-01T23:59:59.999 149079.79793723254 === -0.057%
2024-12-12 23:54:07,993 - DEBUG - cur time: 2024-07-02T23:59:59.999 == next bar open time: 2024-07-03T00:00:00.000 == close pos time: 2024-07-08T00:00:00.000
2024-12-12 23:54:07,993 - INFO - pnl: 2024-07-02T23:59:59.999 149686.3821358895 === 0.407%
2024-12-12 23:54:07,997 - DEBUG - cur time: 2024-07-03T23:59:59.999 == next bar open time: 2024-07-04T00:00:00.000 == close pos time: 2024-07-09T00:00:00.000
2024-12-12 23:54:08,000 - INFO - pnl: 2024-07-03T23:59:59.999 151142.76961514368 === 0.973%
2024-12-12 23:54:08,001 - DEBUG - cur time: 2024-07-04T23:59:59.999 == next bar open time: 2024-07-05T00:00:00.000 == close pos time: 2024-07-10T00:00:00.000
2024-12-12 23:54:08,001 - INFO - pnl: 2024-07-04T23:59:59.999 153604.64061913796 === 1.629%
2024-12-12 23:54:08,005 - DEBUG - cur time: 2024-07-05T23:59:59.999 == next bar open time: 2024-07-06T00:00:00.000 == close pos time: 2024-07-11T00:00:00.000
2024-12-12 23:54:08,009 - INFO - pnl: 2024-07-05T23:59:59.999 157955.72442687064 === 2.833%
2024-12-12 23:54:08,009 - DEBUG - cur time: 2024-07-06T23:59:59.999 == next bar open time: 2024-07-07T00:00:00.000 == close pos time: 2024-07-12T00:00:00.000
2024-12-12 23:54:08,021 - DEBUG - close time 2024-07-06T23:59:59.999 == vol_threshold: 14402388.8
2024-12-12 23:54:08,021 - DEBUG - 2024-07-06T23:59:59.999 == all trade symbol 245 == remain 171 after VOL filter
2024-12-12 23:54:08,026 - DEBUG - sorted_long_factors: shape: (171, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ORBSUSDT     ┆ -5.733335    ┆ 0    ┆ 170          │
│ IOSTUSDT     ┆ -5.663609    ┆ 1    ┆ 169          │
│ TUSDT        ┆ -4.651485    ┆ 2    ┆ 168          │
│ ARPAUSDT     ┆ -4.386956    ┆ 3    ┆ 167          │
│ SKLUSDT      ┆ -4.217395    ┆ 4    ┆ 166          │
│ RSRUSDT      ┆ -3.975734    ┆ 5    ┆ 165          │
│ KAVAUSDT     ┆ -3.967531    ┆ 6    ┆ 164          │
│ ARKUSDT      ┆ -3.534298    ┆ 7    ┆ 163          │
│ 1000PEPEUSDT ┆ -3.305211    ┆ 8    ┆ 162          │
│ OXTUSDT      ┆ -3.291487    ┆ 9    ┆ 161          │
│ …            ┆ …            ┆ …    ┆ …            │
│ WOOUSDT      ┆ 3.315325     ┆ 161  ┆ 9            │
│ XTZUSDT      ┆ 3.463349     ┆ 162  ┆ 8            │
│ SFPUSDT      ┆ 3.655301     ┆ 163  ┆ 7            │
│ STORJUSDT    ┆ 3.668736     ┆ 164  ┆ 6            │
│ HIFIUSDT     ┆ 3.714146     ┆ 165  ┆ 5            │
│ C98USDT      ┆ 3.953217     ┆ 166  ┆ 4            │
│ DODOXUSDT    ┆ 4.658794     ┆ 167  ┆ 3            │
│ STGUSDT      ┆ 5.629455     ┆ 168  ┆ 2            │
│ ANKRUSDT     ┆ 6.793416     ┆ 169  ┆ 1            │
│ TRXUSDT      ┆ 8.131846     ┆ 170  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,030 - WARNING - 2024-07-06T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,030 - INFO - cur close time: 2024-07-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:08,030 - DEBUG - mean expected ret (mean factor): -0.10003273660837086
2024-12-12 23:54:08,034 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,034 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,034 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023155    ┆ 0.15197     ┆ 0.07245     ┆ 0.0097271   ┆ … ┆ 0.01565 ┆ null   ┆ null    ┆ 0.3143  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,046 - DEBUG - update position: 2024-07-06T23:59:59.999 === diff_trading_value: 329272.3218476733 == cash: 157174.51138901932 
2024-12-12 23:54:08,050 - INFO - pnl: 2024-07-06T23:59:59.999 157174.51138901932 === -0.495%
2024-12-12 23:54:08,055 - DEBUG - cur time: 2024-07-07T23:59:59.999 == next bar open time: 2024-07-08T00:00:00.000 == close pos time: 2024-07-13T00:00:00.000
2024-12-12 23:54:08,055 - INFO - pnl: 2024-07-07T23:59:59.999 156489.61386036887 === -0.436%
2024-12-12 23:54:08,060 - DEBUG - cur time: 2024-07-08T23:59:59.999 == next bar open time: 2024-07-09T00:00:00.000 == close pos time: 2024-07-14T00:00:00.000
2024-12-12 23:54:08,063 - INFO - pnl: 2024-07-08T23:59:59.999 157445.63326624953 === 0.611%
2024-12-12 23:54:08,068 - DEBUG - cur time: 2024-07-09T23:59:59.999 == next bar open time: 2024-07-10T00:00:00.000 == close pos time: 2024-07-15T00:00:00.000
2024-12-12 23:54:08,070 - INFO - pnl: 2024-07-09T23:59:59.999 159526.00094035213 === 1.321%
2024-12-12 23:54:08,072 - DEBUG - cur time: 2024-07-10T23:59:59.999 == next bar open time: 2024-07-11T00:00:00.000 == close pos time: 2024-07-16T00:00:00.000
2024-12-12 23:54:08,076 - INFO - pnl: 2024-07-10T23:59:59.999 159630.22456162338 === 0.065%
2024-12-12 23:54:08,076 - DEBUG - cur time: 2024-07-11T23:59:59.999 == next bar open time: 2024-07-12T00:00:00.000 == close pos time: 2024-07-17T00:00:00.000
2024-12-12 23:54:08,090 - DEBUG - close time 2024-07-11T23:59:59.999 == vol_threshold: 11646763.000000002
2024-12-12 23:54:08,093 - DEBUG - 2024-07-11T23:59:59.999 == all trade symbol 245 == remain 171 after VOL filter
2024-12-12 23:54:08,093 - DEBUG - sorted_long_factors: shape: (171, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ XVGUSDT   ┆ -5.539051    ┆ 0    ┆ 170          │
│ BLZUSDT   ┆ -5.167818    ┆ 1    ┆ 169          │
│ BOMEUSDT  ┆ -4.993697    ┆ 2    ┆ 168          │
│ ARPAUSDT  ┆ -4.349747    ┆ 3    ┆ 167          │
│ DODOXUSDT ┆ -4.182796    ┆ 4    ┆ 166          │
│ OXTUSDT   ┆ -3.737512    ┆ 5    ┆ 165          │
│ XEMUSDT   ┆ -3.689612    ┆ 6    ┆ 164          │
│ MANTAUSDT ┆ -3.625158    ┆ 7    ┆ 163          │
│ MAVUSDT   ┆ -3.406545    ┆ 8    ┆ 162          │
│ BLURUSDT  ┆ -3.046003    ┆ 9    ┆ 161          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ICXUSDT   ┆ 3.120145     ┆ 161  ┆ 9            │
│ BNXUSDT   ┆ 3.167109     ┆ 162  ┆ 8            │
│ CELOUSDT  ┆ 3.311185     ┆ 163  ┆ 7            │
│ ONTUSDT   ┆ 3.357428     ┆ 164  ┆ 6            │
│ 1INCHUSDT ┆ 3.475949     ┆ 165  ┆ 5            │
│ OMUSDT    ┆ 3.560256     ┆ 166  ┆ 4            │
│ HOTUSDT   ┆ 3.772793     ┆ 167  ┆ 3            │
│ FLOWUSDT  ┆ 4.311508     ┆ 168  ┆ 2            │
│ GLMUSDT   ┆ 4.876974     ┆ 169  ┆ 1            │
│ DARUSDT   ┆ 8.833496     ┆ 170  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,101 - INFO - cur close time: 2024-07-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:08,101 - DEBUG - mean expected ret (mean factor): -0.2410147187649408
2024-12-12 23:54:08,105 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,105 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,105 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023492    ┆ 0.14324     ┆ 0.0697      ┆ 0.0088944   ┆ … ┆ 0.01542 ┆ null   ┆ null    ┆ 0.3134  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,111 - DEBUG - update position: 2024-07-11T23:59:59.999 === diff_trading_value: 319845.8773945725 == cash: 158813.68937341406 
2024-12-12 23:54:08,111 - INFO - pnl: 2024-07-11T23:59:59.999 158813.68937341406 === -0.512%
2024-12-12 23:54:08,114 - DEBUG - cur time: 2024-07-12T23:59:59.999 == next bar open time: 2024-07-13T00:00:00.000 == close pos time: 2024-07-18T00:00:00.000
2024-12-12 23:54:08,114 - INFO - pnl: 2024-07-12T23:59:59.999 157972.29513228656 === -0.530%
2024-12-12 23:54:08,119 - DEBUG - cur time: 2024-07-13T23:59:59.999 == next bar open time: 2024-07-14T00:00:00.000 == close pos time: 2024-07-19T00:00:00.000
2024-12-12 23:54:08,122 - INFO - pnl: 2024-07-13T23:59:59.999 158960.12138743448 === 0.625%
2024-12-12 23:54:08,126 - DEBUG - cur time: 2024-07-14T23:59:59.999 == next bar open time: 2024-07-15T00:00:00.000 == close pos time: 2024-07-20T00:00:00.000
2024-12-12 23:54:08,126 - INFO - pnl: 2024-07-14T23:59:59.999 159278.11779445145 === 0.200%
2024-12-12 23:54:08,130 - DEBUG - cur time: 2024-07-15T23:59:59.999 == next bar open time: 2024-07-16T00:00:00.000 == close pos time: 2024-07-21T00:00:00.000
2024-12-12 23:54:08,130 - INFO - pnl: 2024-07-15T23:59:59.999 158864.08060029257 === -0.260%
2024-12-12 23:54:08,134 - DEBUG - cur time: 2024-07-16T23:59:59.999 == next bar open time: 2024-07-17T00:00:00.000 == close pos time: 2024-07-22T00:00:00.000
2024-12-12 23:54:08,147 - DEBUG - close time 2024-07-16T23:59:59.999 == vol_threshold: 15393008.080000004
2024-12-12 23:54:08,147 - DEBUG - 2024-07-16T23:59:59.999 == all trade symbol 245 == remain 171 after VOL filter
2024-12-12 23:54:08,150 - DEBUG - sorted_long_factors: shape: (171, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ DODOXUSDT ┆ -4.055418    ┆ 0    ┆ 170          │
│ ZETAUSDT  ┆ -3.704707    ┆ 1    ┆ 169          │
│ TLMUSDT   ┆ -3.599023    ┆ 2    ┆ 168          │
│ HFTUSDT   ┆ -3.443532    ┆ 3    ┆ 167          │
│ WAXPUSDT  ┆ -3.44289     ┆ 4    ┆ 166          │
│ BLZUSDT   ┆ -3.318569    ┆ 5    ┆ 165          │
│ LDOUSDT   ┆ -2.989536    ┆ 6    ┆ 164          │
│ OXTUSDT   ┆ -2.86689     ┆ 7    ┆ 163          │
│ TIAUSDT   ┆ -2.823382    ┆ 8    ┆ 162          │
│ UNIUSDT   ┆ -2.812831    ┆ 9    ┆ 161          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CELOUSDT  ┆ 3.607546     ┆ 161  ┆ 9            │
│ DARUSDT   ┆ 3.757666     ┆ 162  ┆ 8            │
│ NTRNUSDT  ┆ 4.073186     ┆ 163  ┆ 7            │
│ REEFUSDT  ┆ 4.131209     ┆ 164  ┆ 6            │
│ USTCUSDT  ┆ 4.358417     ┆ 165  ┆ 5            │
│ ONEUSDT   ┆ 4.839439     ┆ 166  ┆ 4            │
│ XEMUSDT   ┆ 5.422122     ┆ 167  ┆ 3            │
│ MAVIAUSDT ┆ 5.473418     ┆ 168  ┆ 2            │
│ OMUSDT    ┆ 5.593469     ┆ 169  ┆ 1            │
│ BNXUSDT   ┆ 7.075491     ┆ 170  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,155 - WARNING - 2024-07-16T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,155 - INFO - cur close time: 2024-07-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:08,155 - DEBUG - mean expected ret (mean factor): 0.09256699298359111
2024-12-12 23:54:08,159 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,159 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,159 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028587    ┆ 0.18948     ┆ 0.09333     ┆ 0.0123757   ┆ … ┆ 0.01758 ┆ null   ┆ null    ┆ 0.359   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,164 - DEBUG - update position: 2024-07-16T23:59:59.999 === diff_trading_value: 304889.72491802427 == cash: 159898.47679457066 
2024-12-12 23:54:08,168 - INFO - pnl: 2024-07-16T23:59:59.999 159898.47679457066 === 0.651%
2024-12-12 23:54:08,170 - DEBUG - cur time: 2024-07-17T23:59:59.999 == next bar open time: 2024-07-18T00:00:00.000 == close pos time: 2024-07-23T00:00:00.000
2024-12-12 23:54:08,172 - INFO - pnl: 2024-07-17T23:59:59.999 161383.26445324544 === 0.929%
2024-12-12 23:54:08,176 - DEBUG - cur time: 2024-07-18T23:59:59.999 == next bar open time: 2024-07-19T00:00:00.000 == close pos time: 2024-07-24T00:00:00.000
2024-12-12 23:54:08,177 - INFO - pnl: 2024-07-18T23:59:59.999 162883.00494973484 === 0.929%
2024-12-12 23:54:08,180 - DEBUG - cur time: 2024-07-19T23:59:59.999 == next bar open time: 2024-07-20T00:00:00.000 == close pos time: 2024-07-25T00:00:00.000
2024-12-12 23:54:08,181 - INFO - pnl: 2024-07-19T23:59:59.999 161523.4054912227 === -0.835%
2024-12-12 23:54:08,183 - DEBUG - cur time: 2024-07-20T23:59:59.999 == next bar open time: 2024-07-21T00:00:00.000 == close pos time: 2024-07-26T00:00:00.000
2024-12-12 23:54:08,187 - INFO - pnl: 2024-07-20T23:59:59.999 161342.6320294652 === -0.112%
2024-12-12 23:54:08,189 - DEBUG - cur time: 2024-07-21T23:59:59.999 == next bar open time: 2024-07-22T00:00:00.000 == close pos time: 2024-07-27T00:00:00.000
2024-12-12 23:54:08,201 - DEBUG - close time 2024-07-21T23:59:59.999 == vol_threshold: 12012199.4
2024-12-12 23:54:08,201 - DEBUG - 2024-07-21T23:59:59.999 == all trade symbol 245 == remain 171 after VOL filter
2024-12-12 23:54:08,205 - DEBUG - sorted_long_factors: shape: (171, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ OMGUSDT      ┆ -3.236198    ┆ 0    ┆ 170          │
│ XAIUSDT      ┆ -2.960726    ┆ 1    ┆ 169          │
│ LDOUSDT      ┆ -2.926792    ┆ 2    ┆ 168          │
│ ACHUSDT      ┆ -2.840408    ┆ 3    ┆ 167          │
│ STRKUSDT     ┆ -2.546327    ┆ 4    ┆ 166          │
│ 1000LUNCUSDT ┆ -2.218232    ┆ 5    ┆ 165          │
│ ETHFIUSDT    ┆ -2.213081    ┆ 6    ┆ 164          │
│ USTCUSDT     ┆ -2.192614    ┆ 7    ┆ 163          │
│ ARKMUSDT     ┆ -2.161091    ┆ 8    ┆ 162          │
│ KEYUSDT      ┆ -2.145248    ┆ 9    ┆ 161          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TUSDT        ┆ 2.685544     ┆ 161  ┆ 9            │
│ ANKRUSDT     ┆ 2.742345     ┆ 162  ┆ 8            │
│ OMUSDT       ┆ 3.333336     ┆ 163  ┆ 7            │
│ BATUSDT      ┆ 3.575631     ┆ 164  ┆ 6            │
│ ICXUSDT      ┆ 3.759319     ┆ 165  ┆ 5            │
│ KLAYUSDT     ┆ 3.803074     ┆ 166  ┆ 4            │
│ NKNUSDT      ┆ 4.066202     ┆ 167  ┆ 3            │
│ ONEUSDT      ┆ 4.08239      ┆ 168  ┆ 2            │
│ ALGOUSDT     ┆ 4.244794     ┆ 169  ┆ 1            │
│ HFTUSDT      ┆ 5.329075     ┆ 170  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,209 - WARNING - 2024-07-21T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,213 - INFO - cur close time: 2024-07-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:08,213 - DEBUG - mean expected ret (mean factor): 0.005806340734746819
2024-12-12 23:54:08,217 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,217 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,217 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.032466    ┆ 0.20574     ┆ 0.09096     ┆ 0.0124954   ┆ … ┆ 0.0181  ┆ null   ┆ null    ┆ 0.3929  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,225 - DEBUG - update position: 2024-07-21T23:59:59.999 === diff_trading_value: 352945.56396396103 == cash: 159522.20585679257 
2024-12-12 23:54:08,226 - INFO - pnl: 2024-07-21T23:59:59.999 159522.20585679257 === -1.128%
2024-12-12 23:54:08,230 - DEBUG - cur time: 2024-07-22T23:59:59.999 == next bar open time: 2024-07-23T00:00:00.000 == close pos time: 2024-07-28T00:00:00.000
2024-12-12 23:54:08,230 - INFO - pnl: 2024-07-22T23:59:59.999 160406.5303830401 === 0.554%
2024-12-12 23:54:08,233 - DEBUG - cur time: 2024-07-23T23:59:59.999 == next bar open time: 2024-07-24T00:00:00.000 == close pos time: 2024-07-29T00:00:00.000
2024-12-12 23:54:08,233 - INFO - pnl: 2024-07-23T23:59:59.999 160208.27159705677 === -0.124%
2024-12-12 23:54:08,242 - DEBUG - cur time: 2024-07-24T23:59:59.999 == next bar open time: 2024-07-25T00:00:00.000 == close pos time: 2024-07-30T00:00:00.000
2024-12-12 23:54:08,242 - INFO - pnl: 2024-07-24T23:59:59.999 161088.2932833974 === 0.549%
2024-12-12 23:54:08,247 - DEBUG - cur time: 2024-07-25T23:59:59.999 == next bar open time: 2024-07-26T00:00:00.000 == close pos time: 2024-07-31T00:00:00.000
2024-12-12 23:54:08,247 - INFO - pnl: 2024-07-25T23:59:59.999 162038.7555476397 === 0.590%
2024-12-12 23:54:08,251 - DEBUG - cur time: 2024-07-26T23:59:59.999 == next bar open time: 2024-07-27T00:00:00.000 == close pos time: 2024-08-01T00:00:00.000
2024-12-12 23:54:08,260 - DEBUG - close time 2024-07-26T23:59:59.999 == vol_threshold: 11051594.4
2024-12-12 23:54:08,263 - DEBUG - 2024-07-26T23:59:59.999 == all trade symbol 247 == remain 173 after VOL filter
2024-12-12 23:54:08,263 - DEBUG - sorted_long_factors: shape: (173, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT      ┆ -5.293981    ┆ 0    ┆ 172          │
│ ROSEUSDT     ┆ -4.496547    ┆ 1    ┆ 171          │
│ IOTAUSDT     ┆ -3.826799    ┆ 2    ┆ 170          │
│ SAGAUSDT     ┆ -3.798047    ┆ 3    ┆ 169          │
│ BATUSDT      ┆ -3.488408    ┆ 4    ┆ 168          │
│ MEMEUSDT     ┆ -3.260248    ┆ 5    ┆ 167          │
│ KLAYUSDT     ┆ -3.020946    ┆ 6    ┆ 166          │
│ GTCUSDT      ┆ -2.957478    ┆ 7    ┆ 165          │
│ 1000PEPEUSDT ┆ -2.938987    ┆ 8    ┆ 164          │
│ ORBSUSDT     ┆ -2.887799    ┆ 9    ┆ 163          │
│ …            ┆ …            ┆ …    ┆ …            │
│ 1INCHUSDT    ┆ 4.028797     ┆ 163  ┆ 9            │
│ RIFUSDT      ┆ 4.133278     ┆ 164  ┆ 8            │
│ KAVAUSDT     ┆ 4.31677      ┆ 165  ┆ 7            │
│ CTSIUSDT     ┆ 4.32376      ┆ 166  ┆ 6            │
│ XEMUSDT      ┆ 4.867493     ┆ 167  ┆ 5            │
│ YGGUSDT      ┆ 4.915861     ┆ 168  ┆ 4            │
│ KEYUSDT      ┆ 4.923559     ┆ 169  ┆ 3            │
│ VETUSDT      ┆ 5.298826     ┆ 170  ┆ 2            │
│ C98USDT      ┆ 7.248753     ┆ 171  ┆ 1            │
│ BICOUSDT     ┆ 9.305112     ┆ 172  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,270 - WARNING - 2024-07-26T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,270 - INFO - cur close time: 2024-07-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:08,272 - DEBUG - mean expected ret (mean factor): 0.07305589107462786
2024-12-12 23:54:08,280 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,280 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,280 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028607    ┆ 0.18044     ┆ 0.08538     ┆ 0.0120228   ┆ … ┆ 0.01722 ┆ null   ┆ null    ┆ 0.3929  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,291 - DEBUG - update position: 2024-07-26T23:59:59.999 === diff_trading_value: 365890.6493138862 == cash: 160584.9789209245 
2024-12-12 23:54:08,292 - INFO - pnl: 2024-07-26T23:59:59.999 160584.9789209245 === -0.897%
2024-12-12 23:54:08,300 - DEBUG - cur time: 2024-07-27T23:59:59.999 == next bar open time: 2024-07-28T00:00:00.000 == close pos time: 2024-08-02T00:00:00.000
2024-12-12 23:54:08,301 - INFO - pnl: 2024-07-27T23:59:59.999 159555.65674671362 === -0.641%
2024-12-12 23:54:08,306 - DEBUG - cur time: 2024-07-28T23:59:59.999 == next bar open time: 2024-07-29T00:00:00.000 == close pos time: 2024-08-03T00:00:00.000
2024-12-12 23:54:08,306 - INFO - pnl: 2024-07-28T23:59:59.999 160216.43679237243 === 0.414%
2024-12-12 23:54:08,314 - DEBUG - cur time: 2024-07-29T23:59:59.999 == next bar open time: 2024-07-30T00:00:00.000 == close pos time: 2024-08-04T00:00:00.000
2024-12-12 23:54:08,314 - INFO - pnl: 2024-07-29T23:59:59.999 163339.2231541658 === 1.949%
2024-12-12 23:54:08,322 - DEBUG - cur time: 2024-07-30T23:59:59.999 == next bar open time: 2024-07-31T00:00:00.000 == close pos time: 2024-08-05T00:00:00.000
2024-12-12 23:54:08,326 - INFO - pnl: 2024-07-30T23:59:59.999 164543.94154222278 === 0.738%
2024-12-12 23:54:08,330 - DEBUG - cur time: 2024-07-31T23:59:59.999 == next bar open time: 2024-08-01T00:00:00.000 == close pos time: 2024-08-06T00:00:00.000
2024-12-12 23:54:08,343 - DEBUG - close time 2024-07-31T23:59:59.999 == vol_threshold: 10170159.2
2024-12-12 23:54:08,343 - DEBUG - 2024-07-31T23:59:59.999 == all trade symbol 247 == remain 173 after VOL filter
2024-12-12 23:54:08,347 - DEBUG - sorted_long_factors: shape: (173, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BATUSDT   ┆ -6.300338    ┆ 0    ┆ 172          │
│ CTSIUSDT  ┆ -4.504854    ┆ 1    ┆ 171          │
│ MYROUSDT  ┆ -4.305416    ┆ 2    ┆ 170          │
│ C98USDT   ┆ -4.128872    ┆ 3    ┆ 169          │
│ LQTYUSDT  ┆ -3.706324    ┆ 4    ┆ 168          │
│ STRKUSDT  ┆ -3.678043    ┆ 5    ┆ 167          │
│ XVGUSDT   ┆ -3.284893    ┆ 6    ┆ 166          │
│ REEFUSDT  ┆ -3.279136    ┆ 7    ┆ 165          │
│ ONDOUSDT  ┆ -3.248425    ┆ 8    ┆ 164          │
│ CKBUSDT   ┆ -3.222521    ┆ 9    ┆ 163          │
│ …         ┆ …            ┆ …    ┆ …            │
│ VETUSDT   ┆ 3.221852     ┆ 163  ┆ 9            │
│ SXPUSDT   ┆ 3.254896     ┆ 164  ┆ 8            │
│ BONDUSDT  ┆ 3.345806     ┆ 165  ┆ 7            │
│ ICXUSDT   ┆ 3.354715     ┆ 166  ┆ 6            │
│ POWRUSDT  ┆ 3.373217     ┆ 167  ┆ 5            │
│ NFPUSDT   ┆ 3.436        ┆ 168  ┆ 4            │
│ KASUSDT   ┆ 4.223486     ┆ 169  ┆ 3            │
│ PIXELUSDT ┆ 4.38903      ┆ 170  ┆ 2            │
│ IOSTUSDT  ┆ 4.713302     ┆ 171  ┆ 1            │
│ KLAYUSDT  ┆ 8.498176     ┆ 172  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,355 - WARNING - 2024-07-31T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,355 - INFO - cur close time: 2024-07-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:08,355 - DEBUG - mean expected ret (mean factor): -0.15824034801370782
2024-12-12 23:54:08,359 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,359 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,359 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024495    ┆ 0.16124     ┆ 0.07798     ┆ 0.0110435   ┆ … ┆ 0.0163  ┆ null   ┆ null    ┆ 0.3652  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,363 - DEBUG - update position: 2024-07-31T23:59:59.999 === diff_trading_value: 333673.71924243716 == cash: 161532.55953858444 
2024-12-12 23:54:08,363 - INFO - pnl: 2024-07-31T23:59:59.999 161532.55953858444 === -1.830%
2024-12-12 23:54:08,370 - DEBUG - cur time: 2024-08-01T23:59:59.999 == next bar open time: 2024-08-02T00:00:00.000 == close pos time: 2024-08-07T00:00:00.000
2024-12-12 23:54:08,370 - INFO - pnl: 2024-08-01T23:59:59.999 162507.65180337484 === 0.604%
2024-12-12 23:54:08,371 - DEBUG - cur time: 2024-08-02T23:59:59.999 == next bar open time: 2024-08-03T00:00:00.000 == close pos time: 2024-08-08T00:00:00.000
2024-12-12 23:54:08,371 - INFO - pnl: 2024-08-02T23:59:59.999 165025.6133573109 === 1.549%
2024-12-12 23:54:08,376 - DEBUG - cur time: 2024-08-03T23:59:59.999 == next bar open time: 2024-08-04T00:00:00.000 == close pos time: 2024-08-09T00:00:00.000
2024-12-12 23:54:08,380 - INFO - pnl: 2024-08-03T23:59:59.999 165208.10018148413 === 0.111%
2024-12-12 23:54:08,380 - DEBUG - cur time: 2024-08-04T23:59:59.999 == next bar open time: 2024-08-05T00:00:00.000 == close pos time: 2024-08-10T00:00:00.000
2024-12-12 23:54:08,384 - INFO - pnl: 2024-08-04T23:59:59.999 164819.335206773 === -0.235%
2024-12-12 23:54:08,388 - DEBUG - cur time: 2024-08-05T23:59:59.999 == next bar open time: 2024-08-06T00:00:00.000 == close pos time: 2024-08-11T00:00:00.000
2024-12-12 23:54:08,400 - DEBUG - close time 2024-08-05T23:59:59.999 == vol_threshold: 59570037.08
2024-12-12 23:54:08,400 - DEBUG - 2024-08-05T23:59:59.999 == all trade symbol 247 == remain 173 after VOL filter
2024-12-12 23:54:08,400 - DEBUG - sorted_long_factors: shape: (173, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -7.525377    ┆ 0    ┆ 172          │
│ USTCUSDT     ┆ -6.835647    ┆ 1    ┆ 171          │
│ MYROUSDT     ┆ -4.745546    ┆ 2    ┆ 170          │
│ DOGEUSDT     ┆ -4.545702    ┆ 3    ┆ 169          │
│ TONUSDT      ┆ -4.501857    ┆ 4    ┆ 168          │
│ DYDXUSDT     ┆ -4.378805    ┆ 5    ┆ 167          │
│ ALTUSDT      ┆ -4.091814    ┆ 6    ┆ 166          │
│ ACHUSDT      ┆ -3.975215    ┆ 7    ┆ 165          │
│ AXLUSDT      ┆ -3.974468    ┆ 8    ┆ 164          │
│ XRPUSDT      ┆ -3.826544    ┆ 9    ┆ 163          │
│ …            ┆ …            ┆ …    ┆ …            │
│ STEEMUSDT    ┆ 3.342915     ┆ 163  ┆ 9            │
│ LOOMUSDT     ┆ 3.436385     ┆ 164  ┆ 8            │
│ ORBSUSDT     ┆ 3.607083     ┆ 165  ┆ 7            │
│ DARUSDT      ┆ 3.867692     ┆ 166  ┆ 6            │
│ STORJUSDT    ┆ 4.192371     ┆ 167  ┆ 5            │
│ OXTUSDT      ┆ 4.236376     ┆ 168  ┆ 4            │
│ OMUSDT       ┆ 5.026111     ┆ 169  ┆ 3            │
│ XVGUSDT      ┆ 5.383342     ┆ 170  ┆ 2            │
│ TRXUSDT      ┆ 5.691027     ┆ 171  ┆ 1            │
│ BNXUSDT      ┆ 5.816641     ┆ 172  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,412 - WARNING - 2024-08-05T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,412 - INFO - cur close time: 2024-08-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:08,412 - DEBUG - mean expected ret (mean factor): -0.006110067313890185
2024-12-12 23:54:08,418 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,419 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,420 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.017897    ┆ 0.11013     ┆ 0.06385     ┆ 0.007045    ┆ … ┆ 0.01235 ┆ null   ┆ null    ┆ 0.2606  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,425 - DEBUG - update position: 2024-08-05T23:59:59.999 === diff_trading_value: 299396.9802855039 == cash: 164539.54207598773 
2024-12-12 23:54:08,431 - INFO - pnl: 2024-08-05T23:59:59.999 164539.54207598773 === -0.170%
2024-12-12 23:54:08,434 - DEBUG - cur time: 2024-08-06T23:59:59.999 == next bar open time: 2024-08-07T00:00:00.000 == close pos time: 2024-08-12T00:00:00.000
2024-12-12 23:54:08,438 - INFO - pnl: 2024-08-06T23:59:59.999 162718.3036806959 === -1.107%
2024-12-12 23:54:08,442 - DEBUG - cur time: 2024-08-07T23:59:59.999 == next bar open time: 2024-08-08T00:00:00.000 == close pos time: 2024-08-13T00:00:00.000
2024-12-12 23:54:08,442 - INFO - pnl: 2024-08-07T23:59:59.999 159976.5352777257 === -1.685%
2024-12-12 23:54:08,447 - DEBUG - cur time: 2024-08-08T23:59:59.999 == next bar open time: 2024-08-09T00:00:00.000 == close pos time: 2024-08-14T00:00:00.000
2024-12-12 23:54:08,447 - INFO - pnl: 2024-08-08T23:59:59.999 159283.201278732 === -0.433%
2024-12-12 23:54:08,450 - DEBUG - cur time: 2024-08-09T23:59:59.999 == next bar open time: 2024-08-10T00:00:00.000 == close pos time: 2024-08-15T00:00:00.000
2024-12-12 23:54:08,454 - INFO - pnl: 2024-08-09T23:59:59.999 161207.70851490987 === 1.208%
2024-12-12 23:54:08,454 - DEBUG - cur time: 2024-08-10T23:59:59.999 == next bar open time: 2024-08-11T00:00:00.000 == close pos time: 2024-08-16T00:00:00.000
2024-12-12 23:54:08,467 - DEBUG - close time 2024-08-10T23:59:59.999 == vol_threshold: 8173733.399999999
2024-12-12 23:54:08,467 - DEBUG - 2024-08-10T23:59:59.999 == all trade symbol 248 == remain 173 after VOL filter
2024-12-12 23:54:08,470 - DEBUG - sorted_long_factors: shape: (173, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ GLMUSDT     ┆ -4.801542    ┆ 0    ┆ 172          │
│ DODOXUSDT   ┆ -4.145682    ┆ 1    ┆ 171          │
│ MATICUSDT   ┆ -3.96408     ┆ 2    ┆ 170          │
│ XRPUSDT     ┆ -3.881972    ┆ 3    ┆ 169          │
│ RSRUSDT     ┆ -3.772       ┆ 4    ┆ 168          │
│ ONEUSDT     ┆ -3.606786    ┆ 5    ┆ 167          │
│ NKNUSDT     ┆ -3.563244    ┆ 6    ┆ 166          │
│ MYROUSDT    ┆ -3.527504    ┆ 7    ┆ 165          │
│ ADAUSDT     ┆ -3.293047    ┆ 8    ┆ 164          │
│ TURBOUSDT   ┆ -3.255844    ┆ 9    ┆ 163          │
│ …           ┆ …            ┆ …    ┆ …            │
│ BIGTIMEUSDT ┆ 2.698084     ┆ 163  ┆ 9            │
│ RDNTUSDT    ┆ 2.930157     ┆ 164  ┆ 8            │
│ IOTAUSDT    ┆ 2.953023     ┆ 165  ┆ 7            │
│ CELOUSDT    ┆ 3.034409     ┆ 166  ┆ 6            │
│ FILUSDT     ┆ 3.050019     ┆ 167  ┆ 5            │
│ ATAUSDT     ┆ 3.336314     ┆ 168  ┆ 4            │
│ STEEMUSDT   ┆ 3.703368     ┆ 169  ┆ 3            │
│ NTRNUSDT    ┆ 3.727888     ┆ 170  ┆ 2            │
│ BAKEUSDT    ┆ 4.009033     ┆ 171  ┆ 1            │
│ C98USDT     ┆ 4.568357     ┆ 172  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,476 - WARNING - 2024-08-10T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,476 - INFO - cur close time: 2024-08-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:08,476 - DEBUG - mean expected ret (mean factor): -0.12331968751299442
2024-12-12 23:54:08,480 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,480 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,480 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.020429    ┆ 0.12648     ┆ 0.08693     ┆ 0.008428    ┆ … ┆ 0.01421 ┆ null   ┆ null    ┆ 0.3126  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,483 - DEBUG - update position: 2024-08-10T23:59:59.999 === diff_trading_value: 379001.41594341514 == cash: 158606.59874107243 
2024-12-12 23:54:08,487 - INFO - pnl: 2024-08-10T23:59:59.999 158606.59874107243 === -1.614%
2024-12-12 23:54:08,492 - DEBUG - cur time: 2024-08-11T23:59:59.999 == next bar open time: 2024-08-12T00:00:00.000 == close pos time: 2024-08-17T00:00:00.000
2024-12-12 23:54:08,492 - INFO - pnl: 2024-08-11T23:59:59.999 157867.10789818745 === -0.466%
2024-12-12 23:54:08,496 - DEBUG - cur time: 2024-08-12T23:59:59.999 == next bar open time: 2024-08-13T00:00:00.000 == close pos time: 2024-08-18T00:00:00.000
2024-12-12 23:54:08,496 - INFO - pnl: 2024-08-12T23:59:59.999 159167.84963451326 === 0.824%
2024-12-12 23:54:08,500 - DEBUG - cur time: 2024-08-13T23:59:59.999 == next bar open time: 2024-08-14T00:00:00.000 == close pos time: 2024-08-19T00:00:00.000
2024-12-12 23:54:08,503 - INFO - pnl: 2024-08-13T23:59:59.999 158392.0352906847 === -0.487%
2024-12-12 23:54:08,507 - DEBUG - cur time: 2024-08-14T23:59:59.999 == next bar open time: 2024-08-15T00:00:00.000 == close pos time: 2024-08-20T00:00:00.000
2024-12-12 23:54:08,509 - INFO - pnl: 2024-08-14T23:59:59.999 158311.30801393776 === -0.051%
2024-12-12 23:54:08,509 - DEBUG - cur time: 2024-08-15T23:59:59.999 == next bar open time: 2024-08-16T00:00:00.000 == close pos time: 2024-08-21T00:00:00.000
2024-12-12 23:54:08,526 - DEBUG - close time 2024-08-15T23:59:59.999 == vol_threshold: 12790633.352999995
2024-12-12 23:54:08,526 - DEBUG - 2024-08-15T23:59:59.999 == all trade symbol 248 == remain 173 after VOL filter
2024-12-12 23:54:08,530 - DEBUG - sorted_long_factors: shape: (173, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ USTCUSDT     ┆ -5.858802    ┆ 0    ┆ 172          │
│ LUNA2USDT    ┆ -5.771368    ┆ 1    ┆ 171          │
│ OGNUSDT      ┆ -4.093301    ┆ 2    ┆ 170          │
│ 1000PEPEUSDT ┆ -3.651872    ┆ 3    ┆ 169          │
│ IOTAUSDT     ┆ -3.627041    ┆ 4    ┆ 168          │
│ WUSDT        ┆ -3.394551    ┆ 5    ┆ 167          │
│ RENUSDT      ┆ -3.321229    ┆ 6    ┆ 166          │
│ DARUSDT      ┆ -3.073697    ┆ 7    ┆ 165          │
│ VETUSDT      ┆ -3.00639     ┆ 8    ┆ 164          │
│ BIGTIMEUSDT  ┆ -2.813751    ┆ 9    ┆ 163          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DODOXUSDT    ┆ 3.307233     ┆ 163  ┆ 9            │
│ ENJUSDT      ┆ 3.415303     ┆ 164  ┆ 8            │
│ APTUSDT      ┆ 3.818932     ┆ 165  ┆ 7            │
│ TUSDT        ┆ 3.92772      ┆ 166  ┆ 6            │
│ HFTUSDT      ┆ 4.021802     ┆ 167  ┆ 5            │
│ 1000XECUSDT  ┆ 4.174243     ┆ 168  ┆ 4            │
│ IOSTUSDT     ┆ 4.389592     ┆ 169  ┆ 3            │
│ SKLUSDT      ┆ 4.830044     ┆ 170  ┆ 2            │
│ POWRUSDT     ┆ 5.03276      ┆ 171  ┆ 1            │
│ OMGUSDT      ┆ 7.452162     ┆ 172  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,538 - WARNING - 2024-08-15T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,538 - INFO - cur close time: 2024-08-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:08,538 - DEBUG - mean expected ret (mean factor): -0.05818707887209197
2024-12-12 23:54:08,542 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,542 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,542 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.01856     ┆ 0.11578     ┆ 0.07639     ┆ 0.0074418   ┆ … ┆ 0.01327 ┆ null   ┆ null    ┆ 0.2993  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,550 - DEBUG - update position: 2024-08-15T23:59:59.999 === diff_trading_value: 358397.2633902851 == cash: 157683.31344691533 
2024-12-12 23:54:08,554 - INFO - pnl: 2024-08-15T23:59:59.999 157683.31344691533 === -0.397%
2024-12-12 23:54:08,558 - DEBUG - cur time: 2024-08-16T23:59:59.999 == next bar open time: 2024-08-17T00:00:00.000 == close pos time: 2024-08-22T00:00:00.000
2024-12-12 23:54:08,558 - INFO - pnl: 2024-08-16T23:59:59.999 156949.0471875568 === -0.466%
2024-12-12 23:54:08,562 - DEBUG - cur time: 2024-08-17T23:59:59.999 == next bar open time: 2024-08-18T00:00:00.000 == close pos time: 2024-08-23T00:00:00.000
2024-12-12 23:54:08,562 - INFO - pnl: 2024-08-17T23:59:59.999 156672.6544196899 === -0.176%
2024-12-12 23:54:08,571 - DEBUG - cur time: 2024-08-18T23:59:59.999 == next bar open time: 2024-08-19T00:00:00.000 == close pos time: 2024-08-24T00:00:00.000
2024-12-12 23:54:08,571 - INFO - pnl: 2024-08-18T23:59:59.999 152008.41808706024 === -2.977%
2024-12-12 23:54:08,575 - DEBUG - cur time: 2024-08-19T23:59:59.999 == next bar open time: 2024-08-20T00:00:00.000 == close pos time: 2024-08-25T00:00:00.000
2024-12-12 23:54:08,579 - INFO - pnl: 2024-08-19T23:59:59.999 150968.49246672628 === -0.684%
2024-12-12 23:54:08,583 - DEBUG - cur time: 2024-08-20T23:59:59.999 == next bar open time: 2024-08-21T00:00:00.000 == close pos time: 2024-08-26T00:00:00.000
2024-12-12 23:54:08,599 - DEBUG - close time 2024-08-20T23:59:59.999 == vol_threshold: 13093178.999999998
2024-12-12 23:54:08,599 - DEBUG - 2024-08-20T23:59:59.999 == all trade symbol 248 == remain 173 after VOL filter
2024-12-12 23:54:08,603 - DEBUG - sorted_long_factors: shape: (173, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ KEYUSDT   ┆ -5.14231     ┆ 0    ┆ 172          │
│ CTSIUSDT  ┆ -4.860311    ┆ 1    ┆ 171          │
│ KASUSDT   ┆ -4.743398    ┆ 2    ┆ 170          │
│ XVGUSDT   ┆ -4.728923    ┆ 3    ┆ 169          │
│ ASTRUSDT  ┆ -4.437475    ┆ 4    ┆ 168          │
│ ORBSUSDT  ┆ -3.972336    ┆ 5    ┆ 167          │
│ BELUSDT   ┆ -3.962054    ┆ 6    ┆ 166          │
│ ONDOUSDT  ┆ -3.71219     ┆ 7    ┆ 165          │
│ SUSHIUSDT ┆ -3.183848    ┆ 8    ┆ 164          │
│ SXPUSDT   ┆ -2.944585    ┆ 9    ┆ 163          │
│ …         ┆ …            ┆ …    ┆ …            │
│ SUIUSDT   ┆ 3.356418     ┆ 163  ┆ 9            │
│ ALGOUSDT  ┆ 3.379525     ┆ 164  ┆ 8            │
│ KAVAUSDT  ┆ 3.457233     ┆ 165  ┆ 7            │
│ XLMUSDT   ┆ 3.685688     ┆ 166  ┆ 6            │
│ LOOMUSDT  ┆ 4.2747       ┆ 167  ┆ 5            │
│ ICXUSDT   ┆ 4.85765      ┆ 168  ┆ 4            │
│ TRXUSDT   ┆ 5.174842     ┆ 169  ┆ 3            │
│ BNXUSDT   ┆ 5.263296     ┆ 170  ┆ 2            │
│ RENUSDT   ┆ 5.393997     ┆ 171  ┆ 1            │
│ BATUSDT   ┆ 6.434104     ┆ 172  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,610 - WARNING - 2024-08-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,610 - INFO - cur close time: 2024-08-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:08,610 - DEBUG - mean expected ret (mean factor): 0.04129874572341782
2024-12-12 23:54:08,615 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,615 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,615 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.018147    ┆ 0.12477     ┆ 0.07929     ┆ 0.007753    ┆ … ┆ 0.01378 ┆ null   ┆ null    ┆ 0.311   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,621 - DEBUG - update position: 2024-08-20T23:59:59.999 === diff_trading_value: 367274.66734073113 == cash: 149923.0344326963 
2024-12-12 23:54:08,621 - INFO - pnl: 2024-08-20T23:59:59.999 149923.0344326963 === -0.693%
2024-12-12 23:54:08,627 - DEBUG - cur time: 2024-08-21T23:59:59.999 == next bar open time: 2024-08-22T00:00:00.000 == close pos time: 2024-08-27T00:00:00.000
2024-12-12 23:54:08,627 - INFO - pnl: 2024-08-21T23:59:59.999 149789.63212422558 === -0.089%
2024-12-12 23:54:08,630 - DEBUG - cur time: 2024-08-22T23:59:59.999 == next bar open time: 2024-08-23T00:00:00.000 == close pos time: 2024-08-28T00:00:00.000
2024-12-12 23:54:08,634 - INFO - pnl: 2024-08-22T23:59:59.999 149515.1959177388 === -0.183%
2024-12-12 23:54:08,638 - DEBUG - cur time: 2024-08-23T23:59:59.999 == next bar open time: 2024-08-24T00:00:00.000 == close pos time: 2024-08-29T00:00:00.000
2024-12-12 23:54:08,638 - INFO - pnl: 2024-08-23T23:59:59.999 148785.2026073565 === -0.488%
2024-12-12 23:54:08,642 - DEBUG - cur time: 2024-08-24T23:59:59.999 == next bar open time: 2024-08-25T00:00:00.000 == close pos time: 2024-08-30T00:00:00.000
2024-12-12 23:54:08,642 - INFO - pnl: 2024-08-24T23:59:59.999 148313.52511725467 === -0.317%
2024-12-12 23:54:08,646 - DEBUG - cur time: 2024-08-25T23:59:59.999 == next bar open time: 2024-08-26T00:00:00.000 == close pos time: 2024-08-31T00:00:00.000
2024-12-12 23:54:08,660 - DEBUG - close time 2024-08-25T23:59:59.999 == vol_threshold: 11207953.259999996
2024-12-12 23:54:08,660 - DEBUG - 2024-08-25T23:59:59.999 == all trade symbol 249 == remain 174 after VOL filter
2024-12-12 23:54:08,661 - DEBUG - sorted_long_factors: shape: (174, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT      ┆ -5.335143    ┆ 0    ┆ 173          │
│ HIFIUSDT     ┆ -5.165429    ┆ 1    ┆ 172          │
│ OGNUSDT      ┆ -4.125364    ┆ 2    ┆ 171          │
│ ROSEUSDT     ┆ -3.933534    ┆ 3    ┆ 170          │
│ HFTUSDT      ┆ -3.646152    ┆ 4    ┆ 169          │
│ 1000PEPEUSDT ┆ -3.565216    ┆ 5    ┆ 168          │
│ BICOUSDT     ┆ -3.458939    ┆ 6    ┆ 167          │
│ STGUSDT      ┆ -3.387542    ┆ 7    ┆ 166          │
│ DENTUSDT     ┆ -3.295374    ┆ 8    ┆ 165          │
│ 1000XECUSDT  ┆ -2.917697    ┆ 9    ┆ 164          │
│ …            ┆ …            ┆ …    ┆ …            │
│ FILUSDT      ┆ 2.944996     ┆ 164  ┆ 9            │
│ DUSKUSDT     ┆ 3.048401     ┆ 165  ┆ 8            │
│ ICXUSDT      ┆ 3.052998     ┆ 166  ┆ 7            │
│ ATAUSDT      ┆ 3.078329     ┆ 167  ┆ 6            │
│ LQTYUSDT     ┆ 3.242341     ┆ 168  ┆ 5            │
│ STORJUSDT    ┆ 3.428516     ┆ 169  ┆ 4            │
│ STMXUSDT     ┆ 3.619305     ┆ 170  ┆ 3            │
│ IOTAUSDT     ┆ 4.579216     ┆ 171  ┆ 2            │
│ BATUSDT      ┆ 8.513072     ┆ 172  ┆ 1            │
│ TUSDT        ┆ 10.663009    ┆ 173  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,665 - WARNING - 2024-08-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,665 - INFO - cur close time: 2024-08-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:08,665 - DEBUG - mean expected ret (mean factor): 0.06467528849789288
2024-12-12 23:54:08,670 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,670 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,670 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.021019    ┆ 0.15013     ┆ 0.09276     ┆ 0.0091358   ┆ … ┆ 0.01543 ┆ null   ┆ null    ┆ 0.3416  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,678 - DEBUG - update position: 2024-08-25T23:59:59.999 === diff_trading_value: 389816.39642202144 == cash: 147442.64606454028 
2024-12-12 23:54:08,680 - INFO - pnl: 2024-08-25T23:59:59.999 147442.64606454028 === -0.587%
2024-12-12 23:54:08,681 - DEBUG - cur time: 2024-08-26T23:59:59.999 == next bar open time: 2024-08-27T00:00:00.000 == close pos time: 2024-09-01T00:00:00.000
2024-12-12 23:54:08,684 - INFO - pnl: 2024-08-26T23:59:59.999 146608.18448921604 === -0.566%
2024-12-12 23:54:08,688 - DEBUG - cur time: 2024-08-27T23:59:59.999 == next bar open time: 2024-08-28T00:00:00.000 == close pos time: 2024-09-02T00:00:00.000
2024-12-12 23:54:08,690 - INFO - pnl: 2024-08-27T23:59:59.999 145756.20339402524 === -0.581%
2024-12-12 23:54:08,693 - DEBUG - cur time: 2024-08-28T23:59:59.999 == next bar open time: 2024-08-29T00:00:00.000 == close pos time: 2024-09-03T00:00:00.000
2024-12-12 23:54:08,693 - INFO - pnl: 2024-08-28T23:59:59.999 145046.54003005996 === -0.487%
2024-12-12 23:54:08,697 - DEBUG - cur time: 2024-08-29T23:59:59.999 == next bar open time: 2024-08-30T00:00:00.000 == close pos time: 2024-09-04T00:00:00.000
2024-12-12 23:54:08,697 - INFO - pnl: 2024-08-29T23:59:59.999 146250.88899082973 === 0.830%
2024-12-12 23:54:08,701 - DEBUG - cur time: 2024-08-30T23:59:59.999 == next bar open time: 2024-08-31T00:00:00.000 == close pos time: 2024-09-05T00:00:00.000
2024-12-12 23:54:08,710 - DEBUG - close time 2024-08-30T23:59:59.999 == vol_threshold: 12005481.209999999
2024-12-12 23:54:08,710 - DEBUG - 2024-08-30T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:08,714 - DEBUG - sorted_long_factors: shape: (176, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ANKRUSDT  ┆ -6.776364    ┆ 0    ┆ 175          │
│ DODOXUSDT ┆ -5.219962    ┆ 1    ┆ 174          │
│ MYROUSDT  ┆ -4.924793    ┆ 2    ┆ 173          │
│ JUPUSDT   ┆ -3.752423    ┆ 3    ┆ 172          │
│ ALTUSDT   ┆ -3.552976    ┆ 4    ┆ 171          │
│ TRUUSDT   ┆ -3.447999    ┆ 5    ┆ 170          │
│ DENTUSDT  ┆ -3.429646    ┆ 6    ┆ 169          │
│ ATAUSDT   ┆ -3.228826    ┆ 7    ┆ 168          │
│ PIXELUSDT ┆ -3.187898    ┆ 8    ┆ 167          │
│ C98USDT   ┆ -3.147128    ┆ 9    ┆ 166          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ARPAUSDT  ┆ 3.045184     ┆ 166  ┆ 9            │
│ ARBUSDT   ┆ 3.416988     ┆ 167  ┆ 8            │
│ WAXPUSDT  ┆ 3.436804     ┆ 168  ┆ 7            │
│ ZROUSDT   ┆ 3.613646     ┆ 169  ┆ 6            │
│ BEAMXUSDT ┆ 3.660404     ┆ 170  ┆ 5            │
│ MAGICUSDT ┆ 4.52482      ┆ 171  ┆ 4            │
│ ALGOUSDT  ┆ 4.546405     ┆ 172  ┆ 3            │
│ IDUSDT    ┆ 4.694301     ┆ 173  ┆ 2            │
│ BATUSDT   ┆ 4.700262     ┆ 174  ┆ 1            │
│ ICXUSDT   ┆ 8.193076     ┆ 175  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,720 - WARNING - 2024-08-30T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,720 - INFO - cur close time: 2024-08-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:08,720 - DEBUG - mean expected ret (mean factor): -0.2179120608227446
2024-12-12 23:54:08,722 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,722 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ f64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 5000.0  ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,722 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.017711    ┆ 0.12711     ┆ 0.08033     ┆ 0.0077612  ┆ … ┆ 0.01353 ┆ 0.10742 ┆ 4.047   ┆ 0.2938  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:08,729 - DEBUG - update position: 2024-08-30T23:59:59.999 === diff_trading_value: 331563.6744674989 == cash: 145164.76748711246 
2024-12-12 23:54:08,729 - INFO - pnl: 2024-08-30T23:59:59.999 145164.76748711246 === -0.743%
2024-12-12 23:54:08,733 - DEBUG - cur time: 2024-08-31T23:59:59.999 == next bar open time: 2024-09-01T00:00:00.000 == close pos time: 2024-09-06T00:00:00.000
2024-12-12 23:54:08,733 - INFO - pnl: 2024-08-31T23:59:59.999 145533.14081265542 === 0.254%
2024-12-12 23:54:08,742 - DEBUG - cur time: 2024-09-01T23:59:59.999 == next bar open time: 2024-09-02T00:00:00.000 == close pos time: 2024-09-07T00:00:00.000
2024-12-12 23:54:08,742 - INFO - pnl: 2024-09-01T23:59:59.999 145750.77045378808 === 0.150%
2024-12-12 23:54:08,747 - DEBUG - cur time: 2024-09-02T23:59:59.999 == next bar open time: 2024-09-03T00:00:00.000 == close pos time: 2024-09-08T00:00:00.000
2024-12-12 23:54:08,750 - INFO - pnl: 2024-09-02T23:59:59.999 144783.58660096594 === -0.664%
2024-12-12 23:54:08,751 - DEBUG - cur time: 2024-09-03T23:59:59.999 == next bar open time: 2024-09-04T00:00:00.000 == close pos time: 2024-09-09T00:00:00.000
2024-12-12 23:54:08,755 - INFO - pnl: 2024-09-03T23:59:59.999 145929.9240325148 === 0.792%
2024-12-12 23:54:08,760 - DEBUG - cur time: 2024-09-04T23:59:59.999 == next bar open time: 2024-09-05T00:00:00.000 == close pos time: 2024-09-10T00:00:00.000
2024-12-12 23:54:08,770 - DEBUG - close time 2024-09-04T23:59:59.999 == vol_threshold: 13971818.899999999
2024-12-12 23:54:08,772 - DEBUG - 2024-09-04T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:08,772 - DEBUG - sorted_long_factors: shape: (176, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ TONUSDT     ┆ -5.276223    ┆ 0    ┆ 175          │
│ BAKEUSDT    ┆ -5.177165    ┆ 1    ┆ 174          │
│ ACHUSDT     ┆ -4.530638    ┆ 2    ┆ 173          │
│ KEYUSDT     ┆ -4.148203    ┆ 3    ┆ 172          │
│ ARKMUSDT    ┆ -4.070003    ┆ 4    ┆ 171          │
│ SFPUSDT     ┆ -3.696912    ┆ 5    ┆ 170          │
│ WUSDT       ┆ -3.682442    ┆ 6    ┆ 169          │
│ LUNA2USDT   ┆ -3.650401    ┆ 7    ┆ 168          │
│ BELUSDT     ┆ -3.336679    ┆ 8    ┆ 167          │
│ LEVERUSDT   ┆ -3.317444    ┆ 9    ┆ 166          │
│ …           ┆ …            ┆ …    ┆ …            │
│ VETUSDT     ┆ 2.920429     ┆ 166  ┆ 9            │
│ ALGOUSDT    ┆ 2.940835     ┆ 167  ┆ 8            │
│ RSRUSDT     ┆ 3.049241     ┆ 168  ┆ 7            │
│ ZROUSDT     ┆ 3.355544     ┆ 169  ┆ 6            │
│ BIGTIMEUSDT ┆ 3.477289     ┆ 170  ┆ 5            │
│ ONTUSDT     ┆ 3.555222     ┆ 171  ┆ 4            │
│ IDUSDT      ┆ 3.737331     ┆ 172  ┆ 3            │
│ SXPUSDT     ┆ 4.875152     ┆ 173  ┆ 2            │
│ DUSKUSDT    ┆ 4.882993     ┆ 174  ┆ 1            │
│ REEFUSDT    ┆ 5.354423     ┆ 175  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,780 - WARNING - 2024-09-04T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,780 - INFO - cur close time: 2024-09-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:08,780 - DEBUG - mean expected ret (mean factor): -0.12983969908412488
2024-12-12 23:54:08,784 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,784 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ f64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 5000.0  ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,784 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.016833    ┆ 0.12221     ┆ 0.07729     ┆ 0.0073526  ┆ … ┆ 0.01343 ┆ 0.10259 ┆ 3.336   ┆ 0.2846  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:08,792 - DEBUG - update position: 2024-09-04T23:59:59.999 === diff_trading_value: 345482.70097899396 == cash: 143661.652085264 
2024-12-12 23:54:08,792 - INFO - pnl: 2024-09-04T23:59:59.999 143661.652085264 === -1.554%
2024-12-12 23:54:08,796 - DEBUG - cur time: 2024-09-05T23:59:59.999 == next bar open time: 2024-09-06T00:00:00.000 == close pos time: 2024-09-11T00:00:00.000
2024-12-12 23:54:08,799 - INFO - pnl: 2024-09-05T23:59:59.999 143237.73449914376 === -0.295%
2024-12-12 23:54:08,805 - DEBUG - cur time: 2024-09-06T23:59:59.999 == next bar open time: 2024-09-07T00:00:00.000 == close pos time: 2024-09-12T00:00:00.000
2024-12-12 23:54:08,805 - INFO - pnl: 2024-09-06T23:59:59.999 143468.15972878836 === 0.161%
2024-12-12 23:54:08,813 - DEBUG - cur time: 2024-09-07T23:59:59.999 == next bar open time: 2024-09-08T00:00:00.000 == close pos time: 2024-09-13T00:00:00.000
2024-12-12 23:54:08,813 - INFO - pnl: 2024-09-07T23:59:59.999 145304.72962743056 === 1.280%
2024-12-12 23:54:08,818 - DEBUG - cur time: 2024-09-08T23:59:59.999 == next bar open time: 2024-09-09T00:00:00.000 == close pos time: 2024-09-14T00:00:00.000
2024-12-12 23:54:08,819 - INFO - pnl: 2024-09-08T23:59:59.999 145867.2875429457 === 0.387%
2024-12-12 23:54:08,825 - DEBUG - cur time: 2024-09-09T23:59:59.999 == next bar open time: 2024-09-10T00:00:00.000 == close pos time: 2024-09-15T00:00:00.000
2024-12-12 23:54:08,840 - DEBUG - close time 2024-09-09T23:59:59.999 == vol_threshold: 11176330.02
2024-12-12 23:54:08,840 - DEBUG - 2024-09-09T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:08,842 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WAXPUSDT     ┆ -4.678402    ┆ 0    ┆ 175          │
│ ACHUSDT      ┆ -3.893636    ┆ 1    ┆ 174          │
│ GTCUSDT      ┆ -3.827061    ┆ 2    ┆ 173          │
│ BELUSDT      ┆ -3.642538    ┆ 3    ┆ 172          │
│ 1000PEPEUSDT ┆ -3.106411    ┆ 4    ┆ 171          │
│ IOTXUSDT     ┆ -3.060891    ┆ 5    ┆ 170          │
│ ENJUSDT      ┆ -2.97097     ┆ 6    ┆ 169          │
│ MANTAUSDT    ┆ -2.939852    ┆ 7    ┆ 168          │
│ DODOXUSDT    ┆ -2.694502    ┆ 8    ┆ 167          │
│ 1000RATSUSDT ┆ -2.526719    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ C98USDT      ┆ 3.584046     ┆ 166  ┆ 9            │
│ MANAUSDT     ┆ 4.492103     ┆ 167  ┆ 8            │
│ MINAUSDT     ┆ 4.804222     ┆ 168  ┆ 7            │
│ KAVAUSDT     ┆ 5.169871     ┆ 169  ┆ 6            │
│ AXLUSDT      ┆ 5.529122     ┆ 170  ┆ 5            │
│ SXPUSDT      ┆ 5.75439      ┆ 171  ┆ 4            │
│ GLMUSDT      ┆ 5.886352     ┆ 172  ┆ 3            │
│ OXTUSDT      ┆ 5.977684     ┆ 173  ┆ 2            │
│ CELRUSDT     ┆ 6.074368     ┆ 174  ┆ 1            │
│ BNXUSDT      ┆ 6.642691     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,851 - WARNING - 2024-09-09T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,851 - INFO - cur close time: 2024-09-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:08,851 - DEBUG - mean expected ret (mean factor): 0.07988598126305503
2024-12-12 23:54:08,855 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,855 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,855 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.017192    ┆ 0.12845     ┆ 0.08126     ┆ 0.0073889  ┆ … ┆ 0.01328 ┆ 0.11199 ┆ 3.573   ┆ 0.2836  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:08,860 - DEBUG - update position: 2024-09-09T23:59:59.999 === diff_trading_value: 328478.5824368341 == cash: 145233.2409608872 
2024-12-12 23:54:08,864 - INFO - pnl: 2024-09-09T23:59:59.999 145233.2409608872 === -0.435%
2024-12-12 23:54:08,869 - DEBUG - cur time: 2024-09-10T23:59:59.999 == next bar open time: 2024-09-11T00:00:00.000 == close pos time: 2024-09-16T00:00:00.000
2024-12-12 23:54:08,870 - INFO - pnl: 2024-09-10T23:59:59.999 145086.46236601615 === -0.101%
2024-12-12 23:54:08,873 - DEBUG - cur time: 2024-09-11T23:59:59.999 == next bar open time: 2024-09-12T00:00:00.000 == close pos time: 2024-09-17T00:00:00.000
2024-12-12 23:54:08,873 - INFO - pnl: 2024-09-11T23:59:59.999 143560.5995557353 === -1.052%
2024-12-12 23:54:08,877 - DEBUG - cur time: 2024-09-12T23:59:59.999 == next bar open time: 2024-09-13T00:00:00.000 == close pos time: 2024-09-18T00:00:00.000
2024-12-12 23:54:08,877 - INFO - pnl: 2024-09-12T23:59:59.999 144770.6378410818 === 0.843%
2024-12-12 23:54:08,880 - DEBUG - cur time: 2024-09-13T23:59:59.999 == next bar open time: 2024-09-14T00:00:00.000 == close pos time: 2024-09-19T00:00:00.000
2024-12-12 23:54:08,880 - INFO - pnl: 2024-09-13T23:59:59.999 145449.6944031027 === 0.469%
2024-12-12 23:54:08,885 - DEBUG - cur time: 2024-09-14T23:59:59.999 == next bar open time: 2024-09-15T00:00:00.000 == close pos time: 2024-09-20T00:00:00.000
2024-12-12 23:54:08,897 - DEBUG - close time 2024-09-14T23:59:59.999 == vol_threshold: 8484576.7
2024-12-12 23:54:08,897 - DEBUG - 2024-09-14T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:08,901 - DEBUG - sorted_long_factors: shape: (176, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ SPELLUSDT ┆ -5.231617    ┆ 0    ┆ 175          │
│ IOTXUSDT  ┆ -5.122365    ┆ 1    ┆ 174          │
│ IDUSDT    ┆ -4.631999    ┆ 2    ┆ 173          │
│ DODOXUSDT ┆ -4.298116    ┆ 3    ┆ 172          │
│ ANKRUSDT  ┆ -4.149618    ┆ 4    ┆ 171          │
│ LOOMUSDT  ┆ -4.141443    ┆ 5    ┆ 170          │
│ LEVERUSDT ┆ -3.99148     ┆ 6    ┆ 169          │
│ MYROUSDT  ┆ -3.313849    ┆ 7    ┆ 168          │
│ RENUSDT   ┆ -3.176405    ┆ 8    ┆ 167          │
│ JUPUSDT   ┆ -2.930287    ┆ 9    ┆ 166          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CKBUSDT   ┆ 3.054134     ┆ 166  ┆ 9            │
│ ZILUSDT   ┆ 3.396351     ┆ 167  ┆ 8            │
│ PIXELUSDT ┆ 3.404343     ┆ 168  ┆ 7            │
│ OMUSDT    ┆ 3.450538     ┆ 169  ┆ 6            │
│ IOTAUSDT  ┆ 3.567193     ┆ 170  ┆ 5            │
│ XLMUSDT   ┆ 3.714072     ┆ 171  ┆ 4            │
│ JOEUSDT   ┆ 3.883943     ┆ 172  ┆ 3            │
│ HOTUSDT   ┆ 4.680666     ┆ 173  ┆ 2            │
│ SANDUSDT  ┆ 4.861027     ┆ 174  ┆ 1            │
│ AEVOUSDT  ┆ 5.336704     ┆ 175  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,905 - WARNING - 2024-09-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,905 - INFO - cur close time: 2024-09-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:08,905 - DEBUG - mean expected ret (mean factor): 0.010809943108199362
2024-12-12 23:54:08,913 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,913 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,913 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.017145    ┆ 0.12535     ┆ 0.08927     ┆ 0.0077545  ┆ … ┆ 0.01372 ┆ 0.11579 ┆ 3.871   ┆ 0.2932  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:08,921 - DEBUG - update position: 2024-09-14T23:59:59.999 === diff_trading_value: 349723.346266142 == cash: 145436.15875447777 
2024-12-12 23:54:08,921 - INFO - pnl: 2024-09-14T23:59:59.999 145436.15875447777 === -0.009%
2024-12-12 23:54:08,926 - DEBUG - cur time: 2024-09-15T23:59:59.999 == next bar open time: 2024-09-16T00:00:00.000 == close pos time: 2024-09-21T00:00:00.000
2024-12-12 23:54:08,930 - INFO - pnl: 2024-09-15T23:59:59.999 147441.55076134938 === 1.379%
2024-12-12 23:54:08,934 - DEBUG - cur time: 2024-09-16T23:59:59.999 == next bar open time: 2024-09-17T00:00:00.000 == close pos time: 2024-09-22T00:00:00.000
2024-12-12 23:54:08,934 - INFO - pnl: 2024-09-16T23:59:59.999 147001.89626863512 === -0.298%
2024-12-12 23:54:08,940 - DEBUG - cur time: 2024-09-17T23:59:59.999 == next bar open time: 2024-09-18T00:00:00.000 == close pos time: 2024-09-23T00:00:00.000
2024-12-12 23:54:08,940 - INFO - pnl: 2024-09-17T23:59:59.999 146788.70014624365 === -0.145%
2024-12-12 23:54:08,942 - DEBUG - cur time: 2024-09-18T23:59:59.999 == next bar open time: 2024-09-19T00:00:00.000 == close pos time: 2024-09-24T00:00:00.000
2024-12-12 23:54:08,942 - INFO - pnl: 2024-09-18T23:59:59.999 146512.06226861273 === -0.188%
2024-12-12 23:54:08,947 - DEBUG - cur time: 2024-09-19T23:59:59.999 == next bar open time: 2024-09-20T00:00:00.000 == close pos time: 2024-09-25T00:00:00.000
2024-12-12 23:54:08,960 - DEBUG - close time 2024-09-19T23:59:59.999 == vol_threshold: 16544386.1
2024-12-12 23:54:08,960 - DEBUG - 2024-09-19T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:08,963 - DEBUG - sorted_long_factors: shape: (176, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ALPHAUSDT ┆ -4.338115    ┆ 0    ┆ 175          │
│ TRUUSDT   ┆ -3.836734    ┆ 1    ┆ 174          │
│ STGUSDT   ┆ -3.512171    ┆ 2    ┆ 173          │
│ MAGICUSDT ┆ -3.477055    ┆ 3    ┆ 172          │
│ WOOUSDT   ┆ -3.464181    ┆ 4    ┆ 171          │
│ ENJUSDT   ┆ -3.204747    ┆ 5    ┆ 170          │
│ RIFUSDT   ┆ -3.190334    ┆ 6    ┆ 169          │
│ ARKMUSDT  ┆ -2.809156    ┆ 7    ┆ 168          │
│ RDNTUSDT  ┆ -2.777211    ┆ 8    ┆ 167          │
│ ACHUSDT   ┆ -2.757582    ┆ 9    ┆ 166          │
│ …         ┆ …            ┆ …    ┆ …            │
│ REEFUSDT  ┆ 3.307151     ┆ 166  ┆ 9            │
│ FLOWUSDT  ┆ 3.310584     ┆ 167  ┆ 8            │
│ ONTUSDT   ┆ 3.469426     ┆ 168  ┆ 7            │
│ ZILUSDT   ┆ 3.701996     ┆ 169  ┆ 6            │
│ ANKRUSDT  ┆ 3.726531     ┆ 170  ┆ 5            │
│ TRXUSDT   ┆ 4.083618     ┆ 171  ┆ 4            │
│ BATUSDT   ┆ 4.462267     ┆ 172  ┆ 3            │
│ XLMUSDT   ┆ 5.017422     ┆ 173  ┆ 2            │
│ MANAUSDT  ┆ 5.802568     ┆ 174  ┆ 1            │
│ ALGOUSDT  ┆ 6.519138     ┆ 175  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:08,972 - WARNING - 2024-09-19T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:08,972 - INFO - cur close time: 2024-09-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:08,972 - DEBUG - mean expected ret (mean factor): -0.04327590472252889
2024-12-12 23:54:08,976 - DEBUG - begin to update pos: =========
2024-12-12 23:54:08,976 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:08,976 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.017623    ┆ 0.13112     ┆ 0.08604     ┆ 0.0079502  ┆ … ┆ 0.01424 ┆ 0.12261 ┆ 4.269   ┆ 0.3147  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:08,984 - DEBUG - update position: 2024-09-19T23:59:59.999 === diff_trading_value: 383125.46773657855 == cash: 143245.3070264884 
2024-12-12 23:54:08,984 - INFO - pnl: 2024-09-19T23:59:59.999 143245.3070264884 === -2.230%
2024-12-12 23:54:08,990 - DEBUG - cur time: 2024-09-20T23:59:59.999 == next bar open time: 2024-09-21T00:00:00.000 == close pos time: 2024-09-26T00:00:00.000
2024-12-12 23:54:08,992 - INFO - pnl: 2024-09-20T23:59:59.999 143063.72585832136 === -0.127%
2024-12-12 23:54:08,996 - DEBUG - cur time: 2024-09-21T23:59:59.999 == next bar open time: 2024-09-22T00:00:00.000 == close pos time: 2024-09-27T00:00:00.000
2024-12-12 23:54:09,000 - INFO - pnl: 2024-09-21T23:59:59.999 144351.76681809602 === 0.900%
2024-12-12 23:54:09,004 - DEBUG - cur time: 2024-09-22T23:59:59.999 == next bar open time: 2024-09-23T00:00:00.000 == close pos time: 2024-09-28T00:00:00.000
2024-12-12 23:54:09,004 - INFO - pnl: 2024-09-22T23:59:59.999 144962.1838336991 === 0.423%
2024-12-12 23:54:09,009 - DEBUG - cur time: 2024-09-23T23:59:59.999 == next bar open time: 2024-09-24T00:00:00.000 == close pos time: 2024-09-29T00:00:00.000
2024-12-12 23:54:09,009 - INFO - pnl: 2024-09-23T23:59:59.999 142929.10888616423 === -1.402%
2024-12-12 23:54:09,013 - DEBUG - cur time: 2024-09-24T23:59:59.999 == next bar open time: 2024-09-25T00:00:00.000 == close pos time: 2024-09-30T00:00:00.000
2024-12-12 23:54:09,026 - DEBUG - close time 2024-09-24T23:59:59.999 == vol_threshold: 16079385.399999999
2024-12-12 23:54:09,026 - DEBUG - 2024-09-24T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:09,030 - DEBUG - sorted_long_factors: shape: (176, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BAKEUSDT  ┆ -7.747297    ┆ 0    ┆ 175          │
│ CELRUSDT  ┆ -4.741263    ┆ 1    ┆ 174          │
│ BNXUSDT   ┆ -4.5649      ┆ 2    ┆ 173          │
│ BELUSDT   ┆ -4.061834    ┆ 3    ┆ 172          │
│ LISTAUSDT ┆ -3.95142     ┆ 4    ┆ 171          │
│ NFPUSDT   ┆ -3.844074    ┆ 5    ┆ 170          │
│ RVNUSDT   ┆ -3.294495    ┆ 6    ┆ 169          │
│ KEYUSDT   ┆ -3.10618     ┆ 7    ┆ 168          │
│ ETHFIUSDT ┆ -3.102189    ┆ 8    ┆ 167          │
│ SUSHIUSDT ┆ -3.086       ┆ 9    ┆ 166          │
│ …         ┆ …            ┆ …    ┆ …            │
│ STXUSDT   ┆ 2.821491     ┆ 166  ┆ 9            │
│ RSRUSDT   ┆ 3.001737     ┆ 167  ┆ 8            │
│ SUIUSDT   ┆ 3.348271     ┆ 168  ┆ 7            │
│ JUPUSDT   ┆ 3.414089     ┆ 169  ┆ 6            │
│ ICXUSDT   ┆ 3.876143     ┆ 170  ┆ 5            │
│ BEAMXUSDT ┆ 4.238574     ┆ 171  ┆ 4            │
│ ALGOUSDT  ┆ 4.576944     ┆ 172  ┆ 3            │
│ DENTUSDT  ┆ 4.772407     ┆ 173  ┆ 2            │
│ XVGUSDT   ┆ 5.247162     ┆ 174  ┆ 1            │
│ IOTAUSDT  ┆ 10.133946    ┆ 175  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,033 - WARNING - 2024-09-24T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:09,033 - INFO - cur close time: 2024-09-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:09,033 - DEBUG - mean expected ret (mean factor): 0.06793237059571004
2024-12-12 23:54:09,040 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,040 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,040 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.01852     ┆ 0.1414      ┆ 0.08757     ┆ 0.0085898  ┆ … ┆ 0.01587 ┆ 0.13396 ┆ 4.2989  ┆ 0.3397  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:09,046 - DEBUG - update position: 2024-09-24T23:59:59.999 === diff_trading_value: 354340.91791990795 == cash: 141118.99059171852 
2024-12-12 23:54:09,046 - INFO - pnl: 2024-09-24T23:59:59.999 141118.99059171852 === -1.266%
2024-12-12 23:54:09,050 - DEBUG - cur time: 2024-09-25T23:59:59.999 == next bar open time: 2024-09-26T00:00:00.000 == close pos time: 2024-10-01T00:00:00.000
2024-12-12 23:54:09,054 - INFO - pnl: 2024-09-25T23:59:59.999 141736.91432312693 === 0.438%
2024-12-12 23:54:09,055 - DEBUG - cur time: 2024-09-26T23:59:59.999 == next bar open time: 2024-09-27T00:00:00.000 == close pos time: 2024-10-02T00:00:00.000
2024-12-12 23:54:09,058 - INFO - pnl: 2024-09-26T23:59:59.999 140775.9663950075 === -0.678%
2024-12-12 23:54:09,062 - DEBUG - cur time: 2024-09-27T23:59:59.999 == next bar open time: 2024-09-28T00:00:00.000 == close pos time: 2024-10-03T00:00:00.000
2024-12-12 23:54:09,062 - INFO - pnl: 2024-09-27T23:59:59.999 140252.7491080468 === -0.372%
2024-12-12 23:54:09,066 - DEBUG - cur time: 2024-09-28T23:59:59.999 == next bar open time: 2024-09-29T00:00:00.000 == close pos time: 2024-10-04T00:00:00.000
2024-12-12 23:54:09,066 - INFO - pnl: 2024-09-28T23:59:59.999 140242.8191267123 === -0.007%
2024-12-12 23:54:09,070 - DEBUG - cur time: 2024-09-29T23:59:59.999 == next bar open time: 2024-09-30T00:00:00.000 == close pos time: 2024-10-05T00:00:00.000
2024-12-12 23:54:09,080 - DEBUG - close time 2024-09-29T23:59:59.999 == vol_threshold: 12811644.370000001
2024-12-12 23:54:09,084 - DEBUG - 2024-09-29T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:09,084 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DODOXUSDT    ┆ -5.467694    ┆ 0    ┆ 175          │
│ AIUSDT       ┆ -4.748943    ┆ 1    ┆ 174          │
│ KASUSDT      ┆ -4.350526    ┆ 2    ┆ 173          │
│ BNXUSDT      ┆ -4.122107    ┆ 3    ┆ 172          │
│ 1000SATSUSDT ┆ -3.323244    ┆ 4    ┆ 171          │
│ REZUSDT      ┆ -3.267971    ┆ 5    ┆ 170          │
│ OMGUSDT      ┆ -3.265708    ┆ 6    ┆ 169          │
│ TONUSDT      ┆ -3.142942    ┆ 7    ┆ 168          │
│ OXTUSDT      ┆ -2.930799    ┆ 8    ┆ 167          │
│ TUSDT        ┆ -2.774187    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ STGUSDT      ┆ 3.968743     ┆ 166  ┆ 9            │
│ SUSHIUSDT    ┆ 4.07738      ┆ 167  ┆ 8            │
│ XRPUSDT      ┆ 4.212088     ┆ 168  ┆ 7            │
│ IOSTUSDT     ┆ 4.652496     ┆ 169  ┆ 6            │
│ ZRXUSDT      ┆ 4.716388     ┆ 170  ┆ 5            │
│ ICXUSDT      ┆ 5.128732     ┆ 171  ┆ 4            │
│ ETHWUSDT     ┆ 5.135267     ┆ 172  ┆ 3            │
│ ATAUSDT      ┆ 6.302249     ┆ 173  ┆ 2            │
│ IOTAUSDT     ┆ 6.421402     ┆ 174  ┆ 1            │
│ ANKRUSDT     ┆ 10.024317    ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,092 - WARNING - 2024-09-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:09,092 - INFO - cur close time: 2024-09-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:09,092 - DEBUG - mean expected ret (mean factor): 0.21170761806418162
2024-12-12 23:54:09,097 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,097 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,097 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.022926    ┆ 0.16206     ┆ 0.0991      ┆ 0.0112784  ┆ … ┆ 0.01602 ┆ 0.14636 ┆ 5.0065  ┆ 0.3605  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:09,104 - DEBUG - update position: 2024-09-29T23:59:59.999 === diff_trading_value: 327365.9981817299 == cash: 140811.3617419212 
2024-12-12 23:54:09,104 - INFO - pnl: 2024-09-29T23:59:59.999 140811.3617419212 === 0.405%
2024-12-12 23:54:09,109 - DEBUG - cur time: 2024-09-30T23:59:59.999 == next bar open time: 2024-10-01T00:00:00.000 == close pos time: 2024-10-06T00:00:00.000
2024-12-12 23:54:09,113 - INFO - pnl: 2024-09-30T23:59:59.999 139990.8830415289 === -0.583%
2024-12-12 23:54:09,113 - DEBUG - cur time: 2024-10-01T23:59:59.999 == next bar open time: 2024-10-02T00:00:00.000 == close pos time: 2024-10-07T00:00:00.000
2024-12-12 23:54:09,117 - INFO - pnl: 2024-10-01T23:59:59.999 142648.94729539065 === 1.899%
2024-12-12 23:54:09,121 - DEBUG - cur time: 2024-10-02T23:59:59.999 == next bar open time: 2024-10-03T00:00:00.000 == close pos time: 2024-10-08T00:00:00.000
2024-12-12 23:54:09,121 - INFO - pnl: 2024-10-02T23:59:59.999 143735.92387049858 === 0.762%
2024-12-12 23:54:09,127 - DEBUG - cur time: 2024-10-03T23:59:59.999 == next bar open time: 2024-10-04T00:00:00.000 == close pos time: 2024-10-09T00:00:00.000
2024-12-12 23:54:09,127 - INFO - pnl: 2024-10-03T23:59:59.999 140902.39603729738 === -1.971%
2024-12-12 23:54:09,130 - DEBUG - cur time: 2024-10-04T23:59:59.999 == next bar open time: 2024-10-05T00:00:00.000 == close pos time: 2024-10-10T00:00:00.000
2024-12-12 23:54:09,146 - DEBUG - close time 2024-10-04T23:59:59.999 == vol_threshold: 12370424.74
2024-12-12 23:54:09,146 - DEBUG - 2024-10-04T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:09,146 - DEBUG - sorted_long_factors: shape: (176, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ACHUSDT     ┆ -4.507549    ┆ 0    ┆ 175          │
│ BNXUSDT     ┆ -4.500078    ┆ 1    ┆ 174          │
│ 1000XECUSDT ┆ -4.258774    ┆ 2    ┆ 173          │
│ TONUSDT     ┆ -3.777807    ┆ 3    ┆ 172          │
│ XRPUSDT     ┆ -3.760638    ┆ 4    ┆ 171          │
│ GMTUSDT     ┆ -3.435916    ┆ 5    ┆ 170          │
│ GLMUSDT     ┆ -3.365679    ┆ 6    ┆ 169          │
│ FETUSDT     ┆ -3.215097    ┆ 7    ┆ 168          │
│ HOTUSDT     ┆ -3.199795    ┆ 8    ┆ 167          │
│ DOGEUSDT    ┆ -3.123066    ┆ 9    ┆ 166          │
│ …           ┆ …            ┆ …    ┆ …            │
│ CKBUSDT     ┆ 3.443787     ┆ 166  ┆ 9            │
│ RSRUSDT     ┆ 3.49097      ┆ 167  ┆ 8            │
│ ONEUSDT     ┆ 3.513393     ┆ 168  ┆ 7            │
│ CHZUSDT     ┆ 3.721825     ┆ 169  ┆ 6            │
│ POWRUSDT    ┆ 4.224518     ┆ 170  ┆ 5            │
│ CHRUSDT     ┆ 4.614231     ┆ 171  ┆ 4            │
│ FLOWUSDT    ┆ 4.661113     ┆ 172  ┆ 3            │
│ HFTUSDT     ┆ 4.911464     ┆ 173  ┆ 2            │
│ ALGOUSDT    ┆ 7.075645     ┆ 174  ┆ 1            │
│ IOTXUSDT    ┆ 8.118545     ┆ 175  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,155 - WARNING - 2024-10-04T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:09,155 - INFO - cur close time: 2024-10-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:09,155 - DEBUG - mean expected ret (mean factor): -0.09145033532361174
2024-12-12 23:54:09,160 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,160 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,160 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.021492    ┆ 0.13615     ┆ 0.0874      ┆ 0.0093879  ┆ … ┆ 0.01414 ┆ 0.12725 ┆ 4.1893  ┆ 0.314   │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:09,168 - DEBUG - update position: 2024-10-04T23:59:59.999 === diff_trading_value: 302047.90511071036 == cash: 142300.8233973847 
2024-12-12 23:54:09,170 - INFO - pnl: 2024-10-04T23:59:59.999 142300.8233973847 === 0.992%
2024-12-12 23:54:09,172 - DEBUG - cur time: 2024-10-05T23:59:59.999 == next bar open time: 2024-10-06T00:00:00.000 == close pos time: 2024-10-11T00:00:00.000
2024-12-12 23:54:09,176 - INFO - pnl: 2024-10-05T23:59:59.999 143887.67722485744 === 1.115%
2024-12-12 23:54:09,179 - DEBUG - cur time: 2024-10-06T23:59:59.999 == next bar open time: 2024-10-07T00:00:00.000 == close pos time: 2024-10-12T00:00:00.000
2024-12-12 23:54:09,180 - INFO - pnl: 2024-10-06T23:59:59.999 144999.4043608551 === 0.773%
2024-12-12 23:54:09,184 - DEBUG - cur time: 2024-10-07T23:59:59.999 == next bar open time: 2024-10-08T00:00:00.000 == close pos time: 2024-10-13T00:00:00.000
2024-12-12 23:54:09,184 - INFO - pnl: 2024-10-07T23:59:59.999 146133.63750026413 === 0.782%
2024-12-12 23:54:09,190 - DEBUG - cur time: 2024-10-08T23:59:59.999 == next bar open time: 2024-10-09T00:00:00.000 == close pos time: 2024-10-14T00:00:00.000
2024-12-12 23:54:09,190 - INFO - pnl: 2024-10-08T23:59:59.999 144242.4033612059 === -1.294%
2024-12-12 23:54:09,192 - DEBUG - cur time: 2024-10-09T23:59:59.999 == next bar open time: 2024-10-10T00:00:00.000 == close pos time: 2024-10-15T00:00:00.000
2024-12-12 23:54:09,204 - DEBUG - close time 2024-10-09T23:59:59.999 == vol_threshold: 12175817.0
2024-12-12 23:54:09,204 - DEBUG - 2024-10-09T23:59:59.999 == all trade symbol 253 == remain 177 after VOL filter
2024-12-12 23:54:09,208 - DEBUG - sorted_long_factors: shape: (177, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TONUSDT   ┆ -3.875555    ┆ 0    ┆ 176          │
│ XVGUSDT   ┆ -3.225465    ┆ 1    ┆ 175          │
│ LUNA2USDT ┆ -2.78448     ┆ 2    ┆ 174          │
│ ACHUSDT   ┆ -2.762887    ┆ 3    ┆ 173          │
│ FETUSDT   ┆ -2.694653    ┆ 4    ┆ 172          │
│ EDUUSDT   ┆ -2.66673     ┆ 5    ┆ 171          │
│ MINAUSDT  ┆ -2.179117    ┆ 6    ┆ 170          │
│ ARPAUSDT  ┆ -2.14652     ┆ 7    ┆ 169          │
│ TIAUSDT   ┆ -2.117438    ┆ 8    ┆ 168          │
│ STRKUSDT  ┆ -2.03045     ┆ 9    ┆ 167          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XLMUSDT   ┆ 2.376713     ┆ 167  ┆ 9            │
│ LRCUSDT   ┆ 2.420555     ┆ 168  ┆ 8            │
│ KLAYUSDT  ┆ 2.709629     ┆ 169  ┆ 7            │
│ MANAUSDT  ┆ 2.843081     ┆ 170  ┆ 6            │
│ BATUSDT   ┆ 3.02856      ┆ 171  ┆ 5            │
│ ANKRUSDT  ┆ 3.931008     ┆ 172  ┆ 4            │
│ ZILUSDT   ┆ 3.941548     ┆ 173  ┆ 3            │
│ ICXUSDT   ┆ 4.492384     ┆ 174  ┆ 2            │
│ HFTUSDT   ┆ 5.073951     ┆ 175  ┆ 1            │
│ XEMUSDT   ┆ 5.553431     ┆ 176  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,212 - WARNING - 2024-10-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:09,212 - INFO - cur close time: 2024-10-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:09,216 - DEBUG - mean expected ret (mean factor): -0.04333063246466671
2024-12-12 23:54:09,220 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,220 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,220 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.01985     ┆ 0.12948     ┆ 0.0832      ┆ 0.0091089  ┆ … ┆ 0.01398 ┆ 0.12018 ┆ 3.9165  ┆ 0.3076  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:09,224 - DEBUG - update position: 2024-10-09T23:59:59.999 === diff_trading_value: 306960.4651276757 == cash: 144351.2765157241 
2024-12-12 23:54:09,227 - INFO - pnl: 2024-10-09T23:59:59.999 144351.2765157241 === 0.075%
2024-12-12 23:54:09,232 - DEBUG - cur time: 2024-10-10T23:59:59.999 == next bar open time: 2024-10-11T00:00:00.000 == close pos time: 2024-10-16T00:00:00.000
2024-12-12 23:54:09,232 - INFO - pnl: 2024-10-10T23:59:59.999 144047.47008925112 === -0.210%
2024-12-12 23:54:09,236 - DEBUG - cur time: 2024-10-11T23:59:59.999 == next bar open time: 2024-10-12T00:00:00.000 == close pos time: 2024-10-17T00:00:00.000
2024-12-12 23:54:09,236 - INFO - pnl: 2024-10-11T23:59:59.999 143666.8173240958 === -0.264%
2024-12-12 23:54:09,242 - DEBUG - cur time: 2024-10-12T23:59:59.999 == next bar open time: 2024-10-13T00:00:00.000 == close pos time: 2024-10-18T00:00:00.000
2024-12-12 23:54:09,242 - INFO - pnl: 2024-10-12T23:59:59.999 143660.15713109472 === -0.005%
2024-12-12 23:54:09,247 - DEBUG - cur time: 2024-10-13T23:59:59.999 == next bar open time: 2024-10-14T00:00:00.000 == close pos time: 2024-10-19T00:00:00.000
2024-12-12 23:54:09,247 - INFO - pnl: 2024-10-13T23:59:59.999 142431.19647957094 === -0.855%
2024-12-12 23:54:09,251 - DEBUG - cur time: 2024-10-14T23:59:59.999 == next bar open time: 2024-10-15T00:00:00.000 == close pos time: 2024-10-20T00:00:00.000
2024-12-12 23:54:09,263 - DEBUG - close time 2024-10-14T23:59:59.999 == vol_threshold: 15075457.239999998
2024-12-12 23:54:09,263 - DEBUG - 2024-10-14T23:59:59.999 == all trade symbol 253 == remain 177 after VOL filter
2024-12-12 23:54:09,263 - DEBUG - sorted_long_factors: shape: (177, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ LOOMUSDT  ┆ -5.94659     ┆ 0    ┆ 176          │
│ EDUUSDT   ┆ -5.723194    ┆ 1    ┆ 175          │
│ HFTUSDT   ┆ -4.797618    ┆ 2    ┆ 174          │
│ ACHUSDT   ┆ -4.451458    ┆ 3    ┆ 173          │
│ BLURUSDT  ┆ -3.400149    ┆ 4    ┆ 172          │
│ AIUSDT    ┆ -3.299776    ┆ 5    ┆ 171          │
│ BNXUSDT   ┆ -3.179882    ┆ 6    ┆ 170          │
│ DUSKUSDT  ┆ -2.990213    ┆ 7    ┆ 169          │
│ NKNUSDT   ┆ -2.853332    ┆ 8    ┆ 168          │
│ VANRYUSDT ┆ -2.637288    ┆ 9    ┆ 167          │
│ …         ┆ …            ┆ …    ┆ …            │
│ TUSDT     ┆ 4.039584     ┆ 167  ┆ 9            │
│ ICXUSDT   ┆ 4.052424     ┆ 168  ┆ 8            │
│ C98USDT   ┆ 4.064647     ┆ 169  ┆ 7            │
│ REEFUSDT  ┆ 4.246051     ┆ 170  ┆ 6            │
│ ARPAUSDT  ┆ 4.498152     ┆ 171  ┆ 5            │
│ MANAUSDT  ┆ 4.713194     ┆ 172  ┆ 4            │
│ RVNUSDT   ┆ 4.737659     ┆ 173  ┆ 3            │
│ ZRXUSDT   ┆ 4.819186     ┆ 174  ┆ 2            │
│ FLMUSDT   ┆ 5.286903     ┆ 175  ┆ 1            │
│ VETUSDT   ┆ 5.396921     ┆ 176  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,272 - WARNING - 2024-10-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:09,272 - INFO - cur close time: 2024-10-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:09,272 - DEBUG - mean expected ret (mean factor): -0.04449841501206187
2024-12-12 23:54:09,276 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,279 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,279 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.023239    ┆ 0.15276     ┆ 0.09196     ┆ 0.0109079  ┆ … ┆ 0.01545 ┆ 0.13844 ┆ 4.2352  ┆ 0.3354  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:09,285 - DEBUG - update position: 2024-10-14T23:59:59.999 === diff_trading_value: 335078.3242453134 == cash: 141737.11545556367 
2024-12-12 23:54:09,285 - INFO - pnl: 2024-10-14T23:59:59.999 141737.11545556367 === -0.487%
2024-12-12 23:54:09,289 - DEBUG - cur time: 2024-10-15T23:59:59.999 == next bar open time: 2024-10-16T00:00:00.000 == close pos time: 2024-10-21T00:00:00.000
2024-12-12 23:54:09,289 - INFO - pnl: 2024-10-15T23:59:59.999 140004.1032126566 === -1.223%
2024-12-12 23:54:09,292 - DEBUG - cur time: 2024-10-16T23:59:59.999 == next bar open time: 2024-10-17T00:00:00.000 == close pos time: 2024-10-22T00:00:00.000
2024-12-12 23:54:09,296 - INFO - pnl: 2024-10-16T23:59:59.999 140821.0863696939 === 0.584%
2024-12-12 23:54:09,300 - DEBUG - cur time: 2024-10-17T23:59:59.999 == next bar open time: 2024-10-18T00:00:00.000 == close pos time: 2024-10-23T00:00:00.000
2024-12-12 23:54:09,304 - INFO - pnl: 2024-10-17T23:59:59.999 138880.90468332276 === -1.378%
2024-12-12 23:54:09,309 - DEBUG - cur time: 2024-10-18T23:59:59.999 == next bar open time: 2024-10-19T00:00:00.000 == close pos time: 2024-10-24T00:00:00.000
2024-12-12 23:54:09,310 - INFO - pnl: 2024-10-18T23:59:59.999 140203.36105086724 === 0.952%
2024-12-12 23:54:09,313 - DEBUG - cur time: 2024-10-19T23:59:59.999 == next bar open time: 2024-10-20T00:00:00.000 == close pos time: 2024-10-25T00:00:00.000
2024-12-12 23:54:09,333 - DEBUG - close time 2024-10-19T23:59:59.999 == vol_threshold: 8446740.179999996
2024-12-12 23:54:09,333 - DEBUG - 2024-10-19T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:09,337 - DEBUG - sorted_long_factors: shape: (176, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ EDUUSDT   ┆ -3.231491    ┆ 0    ┆ 175          │
│ VETUSDT   ┆ -3.098256    ┆ 1    ┆ 174          │
│ VANRYUSDT ┆ -3.002211    ┆ 2    ┆ 173          │
│ ACHUSDT   ┆ -2.8923      ┆ 3    ┆ 172          │
│ IOUSDT    ┆ -2.66846     ┆ 4    ┆ 171          │
│ CELRUSDT  ┆ -2.599827    ┆ 5    ┆ 170          │
│ STRKUSDT  ┆ -2.594783    ┆ 6    ┆ 169          │
│ C98USDT   ┆ -2.339662    ┆ 7    ┆ 168          │
│ ARPAUSDT  ┆ -2.287243    ┆ 8    ┆ 167          │
│ HOTUSDT   ┆ -2.266914    ┆ 9    ┆ 166          │
│ …         ┆ …            ┆ …    ┆ …            │
│ LRCUSDT   ┆ 2.051886     ┆ 166  ┆ 9            │
│ DENTUSDT  ┆ 2.181118     ┆ 167  ┆ 8            │
│ MANAUSDT  ┆ 2.447211     ┆ 168  ┆ 7            │
│ CELOUSDT  ┆ 2.482043     ┆ 169  ┆ 6            │
│ FLOWUSDT  ┆ 2.778993     ┆ 170  ┆ 5            │
│ ZILUSDT   ┆ 3.07355      ┆ 171  ┆ 4            │
│ ONEUSDT   ┆ 3.134479     ┆ 172  ┆ 3            │
│ ORBSUSDT  ┆ 3.922347     ┆ 173  ┆ 2            │
│ ALPHAUSDT ┆ 4.962272     ┆ 174  ┆ 1            │
│ RVNUSDT   ┆ 8.226959     ┆ 175  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,346 - WARNING - 2024-10-19T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:09,346 - INFO - cur close time: 2024-10-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:09,346 - DEBUG - mean expected ret (mean factor): -0.17652961093866376
2024-12-12 23:54:09,350 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,350 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,350 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.023502    ┆ 0.15803     ┆ 0.09102     ┆ 0.0104889  ┆ … ┆ 0.01541 ┆ 0.14287 ┆ 3.8384  ┆ 0.3359  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:09,355 - DEBUG - update position: 2024-10-19T23:59:59.999 === diff_trading_value: 313093.4267951999 == cash: 140440.9144759237 
2024-12-12 23:54:09,360 - INFO - pnl: 2024-10-19T23:59:59.999 140440.9144759237 === 0.169%
2024-12-12 23:54:09,360 - DEBUG - cur time: 2024-10-20T23:59:59.999 == next bar open time: 2024-10-21T00:00:00.000 == close pos time: 2024-10-26T00:00:00.000
2024-12-12 23:54:09,364 - INFO - pnl: 2024-10-20T23:59:59.999 136398.6508642873 === -2.878%
2024-12-12 23:54:09,368 - DEBUG - cur time: 2024-10-21T23:59:59.999 == next bar open time: 2024-10-22T00:00:00.000 == close pos time: 2024-10-27T00:00:00.000
2024-12-12 23:54:09,368 - INFO - pnl: 2024-10-21T23:59:59.999 140175.63724260658 === 2.769%
2024-12-12 23:54:09,372 - DEBUG - cur time: 2024-10-22T23:59:59.999 == next bar open time: 2024-10-23T00:00:00.000 == close pos time: 2024-10-28T00:00:00.000
2024-12-12 23:54:09,372 - INFO - pnl: 2024-10-22T23:59:59.999 141505.2172874523 === 0.949%
2024-12-12 23:54:09,376 - DEBUG - cur time: 2024-10-23T23:59:59.999 == next bar open time: 2024-10-24T00:00:00.000 == close pos time: 2024-10-29T00:00:00.000
2024-12-12 23:54:09,380 - INFO - pnl: 2024-10-23T23:59:59.999 139894.3393835094 === -1.138%
2024-12-12 23:54:09,384 - DEBUG - cur time: 2024-10-24T23:59:59.999 == next bar open time: 2024-10-25T00:00:00.000 == close pos time: 2024-10-30T00:00:00.000
2024-12-12 23:54:09,396 - DEBUG - close time 2024-10-24T23:59:59.999 == vol_threshold: 11278823.3
2024-12-12 23:54:09,397 - DEBUG - 2024-10-24T23:59:59.999 == all trade symbol 251 == remain 175 after VOL filter
2024-12-12 23:54:09,397 - DEBUG - sorted_long_factors: shape: (175, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ EDUUSDT    ┆ -6.912693    ┆ 0    ┆ 174          │
│ LUNA2USDT  ┆ -3.915913    ┆ 1    ┆ 173          │
│ KEYUSDT    ┆ -3.779096    ┆ 2    ┆ 172          │
│ ACHUSDT    ┆ -3.777767    ┆ 3    ┆ 171          │
│ AMBUSDT    ┆ -3.662047    ┆ 4    ┆ 170          │
│ USTCUSDT   ┆ -3.249673    ┆ 5    ┆ 169          │
│ ZKUSDT     ┆ -3.114241    ┆ 6    ┆ 168          │
│ FTMUSDT    ┆ -2.995647    ┆ 7    ┆ 167          │
│ PEOPLEUSDT ┆ -2.865898    ┆ 8    ┆ 166          │
│ SUIUSDT    ┆ -2.802079    ┆ 9    ┆ 165          │
│ …          ┆ …            ┆ …    ┆ …            │
│ ALGOUSDT   ┆ 3.071415     ┆ 165  ┆ 9            │
│ IOSTUSDT   ┆ 3.273194     ┆ 166  ┆ 8            │
│ CELRUSDT   ┆ 3.60105      ┆ 167  ┆ 7            │
│ XLMUSDT    ┆ 3.836629     ┆ 168  ┆ 6            │
│ DOTUSDT    ┆ 4.099342     ┆ 169  ┆ 5            │
│ GLMUSDT    ┆ 4.157789     ┆ 170  ┆ 4            │
│ CKBUSDT    ┆ 4.357858     ┆ 171  ┆ 3            │
│ C98USDT    ┆ 4.893642     ┆ 172  ┆ 2            │
│ LRCUSDT    ┆ 6.167442     ┆ 173  ┆ 1            │
│ TRXUSDT    ┆ 7.82205      ┆ 174  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,405 - INFO - cur close time: 2024-10-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:09,405 - DEBUG - mean expected ret (mean factor): -0.024156559367479288
2024-12-12 23:54:09,405 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,410 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬────────────┬────────────┬───┬─────────┬──────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUS ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT   ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ DT         ┆ DT         ┆   ┆ ---     ┆ ---      ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---        ┆ ---        ┆   ┆ i64     ┆ f64      ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64        ┆ i64        ┆   ┆         ┆          ┆         ┆         │
╞═════════════╪═════════════╪════════════╪════════════╪═══╪═════════╪══════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0          ┆ 0          ┆ … ┆ 0       ┆ -10000.0 ┆ 0       ┆ 0       │
└─────────────┴─────────────┴────────────┴────────────┴───┴─────────┴──────────┴─────────┴─────────┘
2024-12-12 23:54:09,410 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.022932    ┆ 0.14704     ┆ 0.09085     ┆ 0.0099932  ┆ … ┆ 0.01519 ┆ 0.13687 ┆ 3.691   ┆ 0.3417  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:09,418 - DEBUG - update position: 2024-10-24T23:59:59.999 === diff_trading_value: 332834.02322183276 == cash: 140296.03890564718 
2024-12-12 23:54:09,420 - INFO - pnl: 2024-10-24T23:59:59.999 140296.03890564718 === 0.287%
2024-12-12 23:54:09,423 - DEBUG - cur time: 2024-10-25T23:59:59.999 == next bar open time: 2024-10-26T00:00:00.000 == close pos time: 2024-10-31T00:00:00.000
2024-12-12 23:54:09,426 - INFO - pnl: 2024-10-25T23:59:59.999 139906.22132885637 === -0.278%
2024-12-12 23:54:09,430 - DEBUG - cur time: 2024-10-26T23:59:59.999 == next bar open time: 2024-10-27T00:00:00.000 == close pos time: 2024-11-01T00:00:00.000
2024-12-12 23:54:09,430 - INFO - pnl: 2024-10-26T23:59:59.999 140340.46740346297 === 0.310%
2024-12-12 23:54:09,455 - INFO - start get SinglePnl: shape: (130_440, 99)
┌────────────┬───────────┬──────────┬──────────┬───┬───────────┬───────────┬───────────┬───────────┐
│ symbol     ┆ open_time ┆ open     ┆ high     ┆ … ┆ long_valu ┆ short_val ┆ long_valu ┆ short_val │
│ ---        ┆ ---       ┆ ---      ┆ ---      ┆   ┆ e_scale_9 ┆ ue_scale_ ┆ e_scale_1 ┆ ue_scale_ │
│ str        ┆ datetime[ ┆ f64      ┆ f64      ┆   ┆ day       ┆ 9day      ┆ 0day      ┆ 10day     │
│            ┆ ms]       ┆          ┆          ┆   ┆ ---       ┆ ---       ┆ ---       ┆ ---       │
│            ┆           ┆          ┆          ┆   ┆ f64       ┆ f64       ┆ f64       ┆ f64       │
╞════════════╪═══════════╪══════════╪══════════╪═══╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010656 ┆ 0.010834 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.0       ┆ 1.0       │
│ DT         ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010747 ┆ 0.010872 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010541 ┆ 0.010638 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010346 ┆ 0.010412 ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010074 ┆ 0.010637 ┆ … ┆ 0.8       ┆ 1.2       ┆ 1.0       ┆ 1.0       │
│ DT         ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010172 ┆ 0.010209 ┆ … ┆ 1.0       ┆ 1.0       ┆ 0.8       ┆ 1.2       │
│ DT         ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.009935 ┆ 0.01061  ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010431 ┆ 0.010635 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.0       ┆ 1.0       │
│ DT         ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010362 ┆ 0.012789 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-1 ┆ 0.012146 ┆ 0.013725 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ …          ┆ …         ┆ …        ┆ …        ┆ … ┆ …         ┆ …         ┆ …         ┆ …         │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3196   ┆ 0.3373   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3355   ┆ 0.3415   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3359   ┆ 0.3565   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3553   ┆ 0.3881   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3577   ┆ 0.3581   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3511   ┆ 0.3547   ┆ … ┆ 0.8       ┆ 1.2       ┆ 1.2       ┆ 0.8       │
│            ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3383   ┆ 0.3548   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3417   ┆ 0.3632   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3194   ┆ 0.3243   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.316    ┆ 0.3317   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
└────────────┴───────────┴──────────┴──────────┴───┴───────────┴───────────┴───────────┴───────────┘
2024-12-12 23:54:09,587 - DEBUG - cur time: 2023-01-09T23:59:59.999 == next bar open time: 2023-01-10T00:00:00.000 == close pos time: 2023-01-15T00:00:00.000
2024-12-12 23:54:09,595 - DEBUG - close time 2023-01-09T23:59:59.999 == vol_threshold: 30853740.759999998
2024-12-12 23:54:09,595 - DEBUG - 2023-01-09T23:59:59.999 == all trade symbol 135 == remain 94 after VOL filter
2024-12-12 23:54:09,595 - DEBUG - sorted_long_factors: shape: (94, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XLMUSDT      ┆ -5.282392    ┆ 0    ┆ 93           │
│ STGUSDT      ┆ -4.458379    ┆ 1    ┆ 92           │
│ NKNUSDT      ┆ -4.163475    ┆ 2    ┆ 91           │
│ THETAUSDT    ┆ -3.499374    ┆ 3    ┆ 90           │
│ 1000SHIBUSDT ┆ -2.9213      ┆ 4    ┆ 89           │
│ XRPUSDT      ┆ -2.83619     ┆ 5    ┆ 88           │
│ COTIUSDT     ┆ -2.791543    ┆ 6    ┆ 87           │
│ C98USDT      ┆ -2.648109    ┆ 7    ┆ 86           │
│ LRCUSDT      ┆ -2.459794    ┆ 8    ┆ 85           │
│ DOGEUSDT     ┆ -2.440385    ┆ 9    ┆ 84           │
│ …            ┆ …            ┆ …    ┆ …            │
│ CRVUSDT      ┆ 2.268797     ┆ 84   ┆ 9            │
│ APEUSDT      ┆ 2.338319     ┆ 85   ┆ 8            │
│ ONTUSDT      ┆ 2.549874     ┆ 86   ┆ 7            │
│ ADAUSDT      ┆ 2.826441     ┆ 87   ┆ 6            │
│ DUSKUSDT     ┆ 3.018008     ┆ 88   ┆ 5            │
│ GALAUSDT     ┆ 3.680502     ┆ 89   ┆ 4            │
│ TRXUSDT      ┆ 3.723091     ┆ 90   ┆ 3            │
│ DGBUSDT      ┆ 4.174032     ┆ 91   ┆ 2            │
│ KLAYUSDT     ┆ 4.471699     ┆ 92   ┆ 1            │
│ IOTAUSDT     ┆ 5.498566     ┆ 93   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,599 - WARNING - 2023-01-09T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:09,599 - INFO - cur close time: 2023-01-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:09,603 - DEBUG - mean expected ret (mean factor): -0.10294758577263849
2024-12-12 23:54:09,603 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,607 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,607 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1694      ┆ null        ┆ … ┆ 0.0235  ┆ null   ┆ null    ┆ 0.1689  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,611 - DEBUG - update position: 2023-01-09T23:59:59.999 === diff_trading_value: 200000.0 == cash: 99800.0 
2024-12-12 23:54:09,616 - DEBUG - cur time: 2023-01-10T23:59:59.999 == next bar open time: 2023-01-11T00:00:00.000 == close pos time: 2023-01-16T00:00:00.000
2024-12-12 23:54:09,616 - INFO - pnl: 2023-01-10T23:59:59.999 99799.93266761684 === -0.000%
2024-12-12 23:54:09,619 - DEBUG - cur time: 2023-01-11T23:59:59.999 == next bar open time: 2023-01-12T00:00:00.000 == close pos time: 2023-01-17T00:00:00.000
2024-12-12 23:54:09,623 - INFO - pnl: 2023-01-11T23:59:59.999 98575.7456258093 === -1.227%
2024-12-12 23:54:09,627 - DEBUG - cur time: 2023-01-12T23:59:59.999 == next bar open time: 2023-01-13T00:00:00.000 == close pos time: 2023-01-18T00:00:00.000
2024-12-12 23:54:09,628 - INFO - pnl: 2023-01-12T23:59:59.999 99680.91119075188 === 1.121%
2024-12-12 23:54:09,632 - DEBUG - cur time: 2023-01-13T23:59:59.999 == next bar open time: 2023-01-14T00:00:00.000 == close pos time: 2023-01-19T00:00:00.000
2024-12-12 23:54:09,632 - INFO - pnl: 2023-01-13T23:59:59.999 100540.21652932343 === 0.862%
2024-12-12 23:54:09,636 - DEBUG - cur time: 2023-01-14T23:59:59.999 == next bar open time: 2023-01-15T00:00:00.000 == close pos time: 2023-01-20T00:00:00.000
2024-12-12 23:54:09,648 - DEBUG - close time 2023-01-14T23:59:59.999 == vol_threshold: 49569117.0
2024-12-12 23:54:09,650 - DEBUG - 2023-01-14T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:09,650 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DARUSDT      ┆ -5.053036    ┆ 0    ┆ 94           │
│ 1000SHIBUSDT ┆ -4.648229    ┆ 1    ┆ 93           │
│ SPELLUSDT    ┆ -3.863568    ┆ 2    ┆ 92           │
│ DOGEUSDT     ┆ -3.640756    ┆ 3    ┆ 91           │
│ KLAYUSDT     ┆ -3.300605    ┆ 4    ┆ 90           │
│ LUNA2USDT    ┆ -3.003817    ┆ 5    ┆ 89           │
│ SFPUSDT      ┆ -2.804805    ┆ 6    ┆ 88           │
│ OGNUSDT      ┆ -2.527984    ┆ 7    ┆ 87           │
│ ADAUSDT      ┆ -2.497345    ┆ 8    ┆ 86           │
│ ANKRUSDT     ┆ -2.489525    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ MANAUSDT     ┆ 2.749736     ┆ 85   ┆ 9            │
│ LINAUSDT     ┆ 2.988629     ┆ 86   ┆ 8            │
│ STMXUSDT     ┆ 3.214535     ┆ 87   ┆ 7            │
│ APTUSDT      ┆ 3.579416     ┆ 88   ┆ 6            │
│ ONEUSDT      ┆ 3.641468     ┆ 89   ┆ 5            │
│ GALAUSDT     ┆ 3.709015     ┆ 90   ┆ 4            │
│ DENTUSDT     ┆ 4.08607      ┆ 91   ┆ 3            │
│ NKNUSDT      ┆ 4.194777     ┆ 92   ┆ 2            │
│ KAVAUSDT     ┆ 4.225135     ┆ 93   ┆ 1            │
│ TRXUSDT      ┆ 7.441549     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,656 - WARNING - 2023-01-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:09,656 - INFO - cur close time: 2023-01-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:09,656 - DEBUG - mean expected ret (mean factor): 0.023498312470275864
2024-12-12 23:54:09,660 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,660 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,660 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1767      ┆ null        ┆ … ┆ 0.02658 ┆ null   ┆ null    ┆ 0.2054  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,668 - DEBUG - update position: 2023-01-14T23:59:59.999 === diff_trading_value: 313617.0397980643 == cash: 100711.63995411254 
2024-12-12 23:54:09,669 - INFO - pnl: 2023-01-14T23:59:59.999 100711.63995411254 === 0.171%
2024-12-12 23:54:09,675 - DEBUG - cur time: 2023-01-15T23:59:59.999 == next bar open time: 2023-01-16T00:00:00.000 == close pos time: 2023-01-21T00:00:00.000
2024-12-12 23:54:09,676 - INFO - pnl: 2023-01-15T23:59:59.999 100948.05988155886 === 0.235%
2024-12-12 23:54:09,680 - DEBUG - cur time: 2023-01-16T23:59:59.999 == next bar open time: 2023-01-17T00:00:00.000 == close pos time: 2023-01-22T00:00:00.000
2024-12-12 23:54:09,681 - INFO - pnl: 2023-01-16T23:59:59.999 101577.93920188838 === 0.624%
2024-12-12 23:54:09,685 - DEBUG - cur time: 2023-01-17T23:59:59.999 == next bar open time: 2023-01-18T00:00:00.000 == close pos time: 2023-01-23T00:00:00.000
2024-12-12 23:54:09,687 - INFO - pnl: 2023-01-17T23:59:59.999 101837.43610075508 === 0.255%
2024-12-12 23:54:09,690 - DEBUG - cur time: 2023-01-18T23:59:59.999 == next bar open time: 2023-01-19T00:00:00.000 == close pos time: 2023-01-24T00:00:00.000
2024-12-12 23:54:09,690 - INFO - pnl: 2023-01-18T23:59:59.999 101565.42682198602 === -0.267%
2024-12-12 23:54:09,698 - DEBUG - cur time: 2023-01-19T23:59:59.999 == next bar open time: 2023-01-20T00:00:00.000 == close pos time: 2023-01-25T00:00:00.000
2024-12-12 23:54:09,708 - DEBUG - close time 2023-01-19T23:59:59.999 == vol_threshold: 18430261.0
2024-12-12 23:54:09,708 - DEBUG - 2023-01-19T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:09,710 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ROSEUSDT     ┆ -5.57417     ┆ 0    ┆ 94           │
│ IOTAUSDT     ┆ -3.615072    ┆ 1    ┆ 93           │
│ NKNUSDT      ┆ -3.178376    ┆ 2    ┆ 92           │
│ THETAUSDT    ┆ -2.923533    ┆ 3    ┆ 91           │
│ 1000SHIBUSDT ┆ -2.914829    ┆ 4    ┆ 90           │
│ SUSHIUSDT    ┆ -2.82513     ┆ 5    ┆ 89           │
│ HOTUSDT      ┆ -2.739405    ┆ 6    ┆ 88           │
│ LDOUSDT      ┆ -2.696988    ┆ 7    ┆ 87           │
│ DGBUSDT      ┆ -2.658682    ┆ 8    ┆ 86           │
│ DENTUSDT     ┆ -2.436027    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ WAVESUSDT    ┆ 2.599864     ┆ 85   ┆ 9            │
│ HBARUSDT     ┆ 2.728567     ┆ 86   ┆ 8            │
│ NEARUSDT     ┆ 2.745627     ┆ 87   ┆ 7            │
│ CELOUSDT     ┆ 2.973662     ┆ 88   ┆ 6            │
│ ADAUSDT      ┆ 3.258271     ┆ 89   ┆ 5            │
│ STMXUSDT     ┆ 3.576638     ┆ 90   ┆ 4            │
│ RVNUSDT      ┆ 3.611348     ┆ 91   ┆ 3            │
│ ONTUSDT      ┆ 3.88341      ┆ 92   ┆ 2            │
│ TRXUSDT      ┆ 5.784886     ┆ 93   ┆ 1            │
│ FLOWUSDT     ┆ 8.470159     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,717 - INFO - cur close time: 2023-01-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:09,717 - DEBUG - mean expected ret (mean factor): 0.23845285846949726
2024-12-12 23:54:09,721 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,722 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,722 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1738      ┆ null        ┆ … ┆ 0.02544 ┆ null   ┆ null    ┆ 0.2038  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,728 - DEBUG - update position: 2023-01-19T23:59:59.999 === diff_trading_value: 335927.8737222523 == cash: 100357.78126184392 
2024-12-12 23:54:09,730 - INFO - pnl: 2023-01-19T23:59:59.999 100357.78126184392 === -1.189%
2024-12-12 23:54:09,734 - DEBUG - cur time: 2023-01-20T23:59:59.999 == next bar open time: 2023-01-21T00:00:00.000 == close pos time: 2023-01-26T00:00:00.000
2024-12-12 23:54:09,735 - INFO - pnl: 2023-01-20T23:59:59.999 100214.72702193333 === -0.143%
2024-12-12 23:54:09,738 - DEBUG - cur time: 2023-01-21T23:59:59.999 == next bar open time: 2023-01-22T00:00:00.000 == close pos time: 2023-01-27T00:00:00.000
2024-12-12 23:54:09,740 - INFO - pnl: 2023-01-21T23:59:59.999 99299.92640901107 === -0.913%
2024-12-12 23:54:09,743 - DEBUG - cur time: 2023-01-22T23:59:59.999 == next bar open time: 2023-01-23T00:00:00.000 == close pos time: 2023-01-28T00:00:00.000
2024-12-12 23:54:09,743 - INFO - pnl: 2023-01-22T23:59:59.999 98936.37643842964 === -0.366%
2024-12-12 23:54:09,748 - DEBUG - cur time: 2023-01-23T23:59:59.999 == next bar open time: 2023-01-24T00:00:00.000 == close pos time: 2023-01-29T00:00:00.000
2024-12-12 23:54:09,750 - INFO - pnl: 2023-01-23T23:59:59.999 98208.78416434024 === -0.735%
2024-12-12 23:54:09,750 - DEBUG - cur time: 2023-01-24T23:59:59.999 == next bar open time: 2023-01-25T00:00:00.000 == close pos time: 2023-01-30T00:00:00.000
2024-12-12 23:54:09,764 - DEBUG - close time 2023-01-24T23:59:59.999 == vol_threshold: 29321026.55
2024-12-12 23:54:09,764 - DEBUG - 2023-01-24T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:09,764 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000SHIBUSDT ┆ -4.709916    ┆ 0    ┆ 94           │
│ PEOPLEUSDT   ┆ -4.081614    ┆ 1    ┆ 93           │
│ LUNA2USDT    ┆ -3.539694    ┆ 2    ┆ 92           │
│ TRXUSDT      ┆ -3.340307    ┆ 3    ┆ 91           │
│ NKNUSDT      ┆ -3.293547    ┆ 4    ┆ 90           │
│ XRPUSDT      ┆ -3.214404    ┆ 5    ┆ 89           │
│ DYDXUSDT     ┆ -3.178016    ┆ 6    ┆ 88           │
│ FILUSDT      ┆ -3.154667    ┆ 7    ┆ 87           │
│ DOGEUSDT     ┆ -3.128005    ┆ 8    ┆ 86           │
│ JASMYUSDT    ┆ -3.123432    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ XEMUSDT      ┆ 2.231967     ┆ 85   ┆ 9            │
│ COTIUSDT     ┆ 2.286429     ┆ 86   ┆ 8            │
│ DGBUSDT      ┆ 2.309608     ┆ 87   ┆ 7            │
│ STMXUSDT     ┆ 2.46528      ┆ 88   ┆ 6            │
│ ARPAUSDT     ┆ 2.486189     ┆ 89   ┆ 5            │
│ LITUSDT      ┆ 2.639352     ┆ 90   ┆ 4            │
│ SUSHIUSDT    ┆ 2.692292     ┆ 91   ┆ 3            │
│ ICXUSDT      ┆ 3.498191     ┆ 92   ┆ 2            │
│ ALPHAUSDT    ┆ 4.198914     ┆ 93   ┆ 1            │
│ DENTUSDT     ┆ 4.556468     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,772 - WARNING - 2023-01-24T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:09,772 - INFO - cur close time: 2023-01-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:09,772 - DEBUG - mean expected ret (mean factor): -0.1158732409485981
2024-12-12 23:54:09,780 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,780 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,780 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.17        ┆ null        ┆ … ┆ 0.027   ┆ null   ┆ null    ┆ 0.2174  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,792 - DEBUG - update position: 2023-01-24T23:59:59.999 === diff_trading_value: 316788.1283409875 == cash: 99833.71024335825 
2024-12-12 23:54:09,792 - INFO - pnl: 2023-01-24T23:59:59.999 99833.71024335825 === 1.655%
2024-12-12 23:54:09,801 - DEBUG - cur time: 2023-01-25T23:59:59.999 == next bar open time: 2023-01-26T00:00:00.000 == close pos time: 2023-01-31T00:00:00.000
2024-12-12 23:54:09,801 - INFO - pnl: 2023-01-25T23:59:59.999 96552.877465934 === -3.286%
2024-12-12 23:54:09,810 - DEBUG - cur time: 2023-01-26T23:59:59.999 == next bar open time: 2023-01-27T00:00:00.000 == close pos time: 2023-02-01T00:00:00.000
2024-12-12 23:54:09,811 - INFO - pnl: 2023-01-26T23:59:59.999 94983.45257654082 === -1.625%
2024-12-12 23:54:09,820 - DEBUG - cur time: 2023-01-27T23:59:59.999 == next bar open time: 2023-01-28T00:00:00.000 == close pos time: 2023-02-02T00:00:00.000
2024-12-12 23:54:09,820 - INFO - pnl: 2023-01-27T23:59:59.999 96926.94292906152 === 2.046%
2024-12-12 23:54:09,827 - DEBUG - cur time: 2023-01-28T23:59:59.999 == next bar open time: 2023-01-29T00:00:00.000 == close pos time: 2023-02-03T00:00:00.000
2024-12-12 23:54:09,828 - INFO - pnl: 2023-01-28T23:59:59.999 97461.70223227184 === 0.552%
2024-12-12 23:54:09,831 - DEBUG - cur time: 2023-01-29T23:59:59.999 == next bar open time: 2023-01-30T00:00:00.000 == close pos time: 2023-02-04T00:00:00.000
2024-12-12 23:54:09,843 - DEBUG - close time 2023-01-29T23:59:59.999 == vol_threshold: 17664567.5
2024-12-12 23:54:09,843 - DEBUG - 2023-01-29T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:09,847 - DEBUG - sorted_long_factors: shape: (95, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ CTSIUSDT  ┆ -4.066314    ┆ 0    ┆ 94           │
│ IOTXUSDT  ┆ -3.408304    ┆ 1    ┆ 93           │
│ BLZUSDT   ┆ -3.306383    ┆ 2    ┆ 92           │
│ STORJUSDT ┆ -3.043231    ┆ 3    ┆ 91           │
│ STGUSDT   ┆ -2.954689    ┆ 4    ┆ 90           │
│ KAVAUSDT  ┆ -2.804582    ┆ 5    ┆ 89           │
│ LRCUSDT   ┆ -2.68229     ┆ 6    ┆ 88           │
│ ZILUSDT   ┆ -2.626523    ┆ 7    ┆ 87           │
│ HOTUSDT   ┆ -2.617014    ┆ 8    ┆ 86           │
│ JASMYUSDT ┆ -2.390592    ┆ 9    ┆ 85           │
│ …         ┆ …            ┆ …    ┆ …            │
│ TRXUSDT   ┆ 2.222171     ┆ 85   ┆ 9            │
│ EOSUSDT   ┆ 2.718837     ┆ 86   ┆ 8            │
│ XTZUSDT   ┆ 2.78707      ┆ 87   ┆ 7            │
│ ONTUSDT   ┆ 3.065257     ┆ 88   ┆ 6            │
│ ONEUSDT   ┆ 3.450095     ┆ 89   ┆ 5            │
│ LINAUSDT  ┆ 3.463601     ┆ 90   ┆ 4            │
│ IOSTUSDT  ┆ 4.506289     ┆ 91   ┆ 3            │
│ IOTAUSDT  ┆ 4.644525     ┆ 92   ┆ 2            │
│ STMXUSDT  ┆ 5.626978     ┆ 93   ┆ 1            │
│ ADAUSDT   ┆ 5.994953     ┆ 94   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,851 - WARNING - 2023-01-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:09,851 - INFO - cur close time: 2023-01-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:09,851 - DEBUG - mean expected ret (mean factor): -0.15517167638964224
2024-12-12 23:54:09,855 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,855 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,855 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1762      ┆ null        ┆ … ┆ 0.02958 ┆ null   ┆ null    ┆ 0.2355  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,860 - DEBUG - update position: 2023-01-29T23:59:59.999 === diff_trading_value: 371327.0879823563 == cash: 97232.36358439218 
2024-12-12 23:54:09,864 - INFO - pnl: 2023-01-29T23:59:59.999 97232.36358439218 === -0.235%
2024-12-12 23:54:09,864 - DEBUG - cur time: 2023-01-30T23:59:59.999 == next bar open time: 2023-01-31T00:00:00.000 == close pos time: 2023-02-05T00:00:00.000
2024-12-12 23:54:09,868 - INFO - pnl: 2023-01-30T23:59:59.999 98231.70635934075 === 1.028%
2024-12-12 23:54:09,870 - DEBUG - cur time: 2023-01-31T23:59:59.999 == next bar open time: 2023-02-01T00:00:00.000 == close pos time: 2023-02-06T00:00:00.000
2024-12-12 23:54:09,872 - INFO - pnl: 2023-01-31T23:59:59.999 96544.02145521647 === -1.718%
2024-12-12 23:54:09,872 - DEBUG - cur time: 2023-02-01T23:59:59.999 == next bar open time: 2023-02-02T00:00:00.000 == close pos time: 2023-02-07T00:00:00.000
2024-12-12 23:54:09,876 - INFO - pnl: 2023-02-01T23:59:59.999 92951.66919246833 === -3.721%
2024-12-12 23:54:09,876 - DEBUG - cur time: 2023-02-02T23:59:59.999 == next bar open time: 2023-02-03T00:00:00.000 == close pos time: 2023-02-08T00:00:00.000
2024-12-12 23:54:09,879 - INFO - pnl: 2023-02-02T23:59:59.999 91039.18845238374 === -2.058%
2024-12-12 23:54:09,879 - DEBUG - cur time: 2023-02-03T23:59:59.999 == next bar open time: 2023-02-04T00:00:00.000 == close pos time: 2023-02-09T00:00:00.000
2024-12-12 23:54:09,889 - DEBUG - close time 2023-02-03T23:59:59.999 == vol_threshold: 22038686.05
2024-12-12 23:54:09,891 - DEBUG - 2023-02-03T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:09,891 - DEBUG - sorted_long_factors: shape: (95, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ATAUSDT     ┆ -3.941432    ┆ 0    ┆ 94           │
│ ARPAUSDT    ┆ -3.594391    ┆ 1    ┆ 93           │
│ REEFUSDT    ┆ -3.557066    ┆ 2    ┆ 92           │
│ NKNUSDT     ┆ -3.300846    ┆ 3    ┆ 91           │
│ LUNA2USDT   ┆ -2.89285     ┆ 4    ┆ 90           │
│ SANDUSDT    ┆ -2.351439    ┆ 5    ┆ 89           │
│ XRPUSDT     ┆ -2.291444    ┆ 6    ┆ 88           │
│ SKLUSDT     ┆ -1.934653    ┆ 7    ┆ 87           │
│ 1000XECUSDT ┆ -1.843522    ┆ 8    ┆ 86           │
│ THETAUSDT   ┆ -1.840516    ┆ 9    ┆ 85           │
│ …           ┆ …            ┆ …    ┆ …            │
│ RVNUSDT     ┆ 3.03533      ┆ 85   ┆ 9            │
│ IMXUSDT     ┆ 3.296117     ┆ 86   ┆ 8            │
│ XTZUSDT     ┆ 3.377622     ┆ 87   ┆ 7            │
│ ONEUSDT     ┆ 3.551647     ┆ 88   ┆ 6            │
│ ICXUSDT     ┆ 3.625256     ┆ 89   ┆ 5            │
│ WAVESUSDT   ┆ 3.704951     ┆ 90   ┆ 4            │
│ RENUSDT     ┆ 4.309514     ┆ 91   ┆ 3            │
│ STMXUSDT    ┆ 4.740694     ┆ 92   ┆ 2            │
│ FLMUSDT     ┆ 4.793305     ┆ 93   ┆ 1            │
│ OGNUSDT     ┆ 8.528294     ┆ 94   ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,895 - WARNING - 2023-02-03T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:09,895 - INFO - cur close time: 2023-02-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:09,895 - DEBUG - mean expected ret (mean factor): 0.2872404661273569
2024-12-12 23:54:09,900 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,900 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,900 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.2023      ┆ null        ┆ … ┆ 0.02982 ┆ null   ┆ null    ┆ 0.2561  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,908 - DEBUG - update position: 2023-02-03T23:59:59.999 === diff_trading_value: 344837.0108987363 == cash: 92943.51886256576 
2024-12-12 23:54:09,908 - INFO - pnl: 2023-02-03T23:59:59.999 92943.51886256576 === 2.092%
2024-12-12 23:54:09,912 - DEBUG - cur time: 2023-02-04T23:59:59.999 == next bar open time: 2023-02-05T00:00:00.000 == close pos time: 2023-02-10T00:00:00.000
2024-12-12 23:54:09,912 - INFO - pnl: 2023-02-04T23:59:59.999 92193.87455756591 === -0.807%
2024-12-12 23:54:09,912 - DEBUG - cur time: 2023-02-05T23:59:59.999 == next bar open time: 2023-02-06T00:00:00.000 == close pos time: 2023-02-11T00:00:00.000
2024-12-12 23:54:09,916 - INFO - pnl: 2023-02-05T23:59:59.999 93558.76449468629 === 1.480%
2024-12-12 23:54:09,916 - DEBUG - cur time: 2023-02-06T23:59:59.999 == next bar open time: 2023-02-07T00:00:00.000 == close pos time: 2023-02-12T00:00:00.000
2024-12-12 23:54:09,919 - INFO - pnl: 2023-02-06T23:59:59.999 92641.53697937833 === -0.980%
2024-12-12 23:54:09,919 - DEBUG - cur time: 2023-02-07T23:59:59.999 == next bar open time: 2023-02-08T00:00:00.000 == close pos time: 2023-02-13T00:00:00.000
2024-12-12 23:54:09,923 - INFO - pnl: 2023-02-07T23:59:59.999 87814.00782174019 === -5.211%
2024-12-12 23:54:09,923 - DEBUG - cur time: 2023-02-08T23:59:59.999 == next bar open time: 2023-02-09T00:00:00.000 == close pos time: 2023-02-14T00:00:00.000
2024-12-12 23:54:09,932 - DEBUG - close time 2023-02-08T23:59:59.999 == vol_threshold: 26802632.549999997
2024-12-12 23:54:09,932 - DEBUG - 2023-02-08T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:09,932 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ATAUSDT      ┆ -3.495594    ┆ 0    ┆ 94           │
│ SFPUSDT      ┆ -3.282849    ┆ 1    ┆ 93           │
│ SKLUSDT      ┆ -2.96304     ┆ 2    ┆ 92           │
│ RLCUSDT      ┆ -2.672729    ┆ 3    ┆ 91           │
│ DOGEUSDT     ┆ -2.646992    ┆ 4    ┆ 90           │
│ OGNUSDT      ┆ -2.433907    ┆ 5    ┆ 89           │
│ 1000SHIBUSDT ┆ -2.353746    ┆ 6    ┆ 88           │
│ IOTXUSDT     ┆ -2.300214    ┆ 7    ┆ 87           │
│ GALAUSDT     ┆ -2.264634    ┆ 8    ┆ 86           │
│ 1000LUNCUSDT ┆ -2.058362    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ DENTUSDT     ┆ 2.59376      ┆ 85   ┆ 9            │
│ TRXUSDT      ┆ 2.616761     ┆ 86   ┆ 8            │
│ ICXUSDT      ┆ 2.648027     ┆ 87   ┆ 7            │
│ STMXUSDT     ┆ 2.67832      ┆ 88   ┆ 6            │
│ CRVUSDT      ┆ 3.239822     ┆ 89   ┆ 5            │
│ ROSEUSDT     ┆ 3.46288      ┆ 90   ┆ 4            │
│ CHRUSDT      ┆ 3.531945     ┆ 91   ┆ 3            │
│ MATICUSDT    ┆ 3.545968     ┆ 92   ┆ 2            │
│ KLAYUSDT     ┆ 4.044387     ┆ 93   ┆ 1            │
│ DGBUSDT      ┆ 6.563808     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,940 - WARNING - 2023-02-08T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:09,940 - INFO - cur close time: 2023-02-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:09,940 - DEBUG - mean expected ret (mean factor): 0.40875012550457024
2024-12-12 23:54:09,944 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,944 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,944 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1809      ┆ null        ┆ … ┆ 0.03077 ┆ null   ┆ null    ┆ 0.2555  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,948 - DEBUG - update position: 2023-02-08T23:59:59.999 === diff_trading_value: 304860.2124759209 == cash: 90904.01666932907 
2024-12-12 23:54:09,950 - INFO - pnl: 2023-02-08T23:59:59.999 90904.01666932907 === 3.519%
2024-12-12 23:54:09,952 - DEBUG - cur time: 2023-02-09T23:59:59.999 == next bar open time: 2023-02-10T00:00:00.000 == close pos time: 2023-02-15T00:00:00.000
2024-12-12 23:54:09,952 - INFO - pnl: 2023-02-09T23:59:59.999 92201.80874400702 === 1.428%
2024-12-12 23:54:09,956 - DEBUG - cur time: 2023-02-10T23:59:59.999 == next bar open time: 2023-02-11T00:00:00.000 == close pos time: 2023-02-16T00:00:00.000
2024-12-12 23:54:09,956 - INFO - pnl: 2023-02-10T23:59:59.999 86052.4740867615 === -6.669%
2024-12-12 23:54:09,960 - DEBUG - cur time: 2023-02-11T23:59:59.999 == next bar open time: 2023-02-12T00:00:00.000 == close pos time: 2023-02-17T00:00:00.000
2024-12-12 23:54:09,960 - INFO - pnl: 2023-02-11T23:59:59.999 85350.10671213295 === -0.816%
2024-12-12 23:54:09,964 - DEBUG - cur time: 2023-02-12T23:59:59.999 == next bar open time: 2023-02-13T00:00:00.000 == close pos time: 2023-02-18T00:00:00.000
2024-12-12 23:54:09,964 - INFO - pnl: 2023-02-12T23:59:59.999 85152.60696570195 === -0.231%
2024-12-12 23:54:09,964 - DEBUG - cur time: 2023-02-13T23:59:59.999 == next bar open time: 2023-02-14T00:00:00.000 == close pos time: 2023-02-19T00:00:00.000
2024-12-12 23:54:09,972 - DEBUG - close time 2023-02-13T23:59:59.999 == vol_threshold: 19371326.5
2024-12-12 23:54:09,972 - DEBUG - 2023-02-13T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:09,977 - DEBUG - sorted_long_factors: shape: (95, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ XLMUSDT    ┆ -4.371735    ┆ 0    ┆ 94           │
│ PEOPLEUSDT ┆ -4.284633    ┆ 1    ┆ 93           │
│ NKNUSDT    ┆ -3.2469      ┆ 2    ┆ 92           │
│ MTLUSDT    ┆ -2.899568    ┆ 3    ┆ 91           │
│ DENTUSDT   ┆ -2.712321    ┆ 4    ┆ 90           │
│ REEFUSDT   ┆ -2.690894    ┆ 5    ┆ 89           │
│ IOSTUSDT   ┆ -2.625009    ┆ 6    ┆ 88           │
│ SFPUSDT    ┆ -2.510949    ┆ 7    ┆ 87           │
│ ANKRUSDT   ┆ -2.346352    ┆ 8    ┆ 86           │
│ LDOUSDT    ┆ -2.329893    ┆ 9    ┆ 85           │
│ …          ┆ …            ┆ …    ┆ …            │
│ FTMUSDT    ┆ 2.572216     ┆ 85   ┆ 9            │
│ SUSHIUSDT  ┆ 2.933616     ┆ 86   ┆ 8            │
│ CELRUSDT   ┆ 3.127901     ┆ 87   ┆ 7            │
│ HBARUSDT   ┆ 3.234735     ┆ 88   ┆ 6            │
│ TRXUSDT    ┆ 3.271698     ┆ 89   ┆ 5            │
│ SKLUSDT    ┆ 3.344196     ┆ 90   ┆ 4            │
│ DUSKUSDT   ┆ 3.501735     ┆ 91   ┆ 3            │
│ SXPUSDT    ┆ 3.774335     ┆ 92   ┆ 2            │
│ CTSIUSDT   ┆ 4.16392      ┆ 93   ┆ 1            │
│ CRVUSDT    ┆ 4.286886     ┆ 94   ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:09,980 - WARNING - 2023-02-13T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:09,980 - INFO - cur close time: 2023-02-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:09,980 - DEBUG - mean expected ret (mean factor): 0.12749778041840618
2024-12-12 23:54:09,984 - DEBUG - begin to update pos: =========
2024-12-12 23:54:09,984 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,984 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1697      ┆ null        ┆ … ┆ 0.02913 ┆ null   ┆ null    ┆ 0.2244  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:09,990 - DEBUG - update position: 2023-02-13T23:59:59.999 === diff_trading_value: 319067.7001683775 == cash: 87569.03736539088 
2024-12-12 23:54:09,992 - INFO - pnl: 2023-02-13T23:59:59.999 87569.03736539088 === 2.838%
2024-12-12 23:54:09,992 - DEBUG - cur time: 2023-02-14T23:59:59.999 == next bar open time: 2023-02-15T00:00:00.000 == close pos time: 2023-02-20T00:00:00.000
2024-12-12 23:54:09,992 - INFO - pnl: 2023-02-14T23:59:59.999 88604.69685065688 === 1.183%
2024-12-12 23:54:09,997 - DEBUG - cur time: 2023-02-15T23:59:59.999 == next bar open time: 2023-02-16T00:00:00.000 == close pos time: 2023-02-21T00:00:00.000
2024-12-12 23:54:09,999 - INFO - pnl: 2023-02-15T23:59:59.999 89357.38003367219 === 0.849%
2024-12-12 23:54:09,999 - DEBUG - cur time: 2023-02-16T23:59:59.999 == next bar open time: 2023-02-17T00:00:00.000 == close pos time: 2023-02-22T00:00:00.000
2024-12-12 23:54:09,999 - INFO - pnl: 2023-02-16T23:59:59.999 86264.09647751975 === -3.462%
2024-12-12 23:54:10,005 - DEBUG - cur time: 2023-02-17T23:59:59.999 == next bar open time: 2023-02-18T00:00:00.000 == close pos time: 2023-02-23T00:00:00.000
2024-12-12 23:54:10,006 - INFO - pnl: 2023-02-17T23:59:59.999 85156.770151562 === -1.284%
2024-12-12 23:54:10,008 - DEBUG - cur time: 2023-02-18T23:59:59.999 == next bar open time: 2023-02-19T00:00:00.000 == close pos time: 2023-02-24T00:00:00.000
2024-12-12 23:54:10,016 - DEBUG - close time 2023-02-18T23:59:59.999 == vol_threshold: 18561809.25
2024-12-12 23:54:10,016 - DEBUG - 2023-02-18T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:10,020 - DEBUG - sorted_long_factors: shape: (95, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ATAUSDT   ┆ -3.117259    ┆ 0    ┆ 94           │
│ KAVAUSDT  ┆ -2.502771    ┆ 1    ┆ 93           │
│ BATUSDT   ┆ -2.491774    ┆ 2    ┆ 92           │
│ ONTUSDT   ┆ -2.452351    ┆ 3    ┆ 91           │
│ THETAUSDT ┆ -2.446223    ┆ 4    ┆ 90           │
│ CHRUSDT   ┆ -2.263215    ┆ 5    ┆ 89           │
│ NKNUSDT   ┆ -2.252379    ┆ 6    ┆ 88           │
│ VETUSDT   ┆ -2.09799     ┆ 7    ┆ 87           │
│ BAKEUSDT  ┆ -1.996196    ┆ 8    ┆ 86           │
│ DOGEUSDT  ┆ -1.929128    ┆ 9    ┆ 85           │
│ …         ┆ …            ┆ …    ┆ …            │
│ STMXUSDT  ┆ 2.299759     ┆ 85   ┆ 9            │
│ ADAUSDT   ┆ 2.307401     ┆ 86   ┆ 8            │
│ BANDUSDT  ┆ 2.40625      ┆ 87   ┆ 7            │
│ WOOUSDT   ┆ 2.613591     ┆ 88   ┆ 6            │
│ SKLUSDT   ┆ 2.918001     ┆ 89   ┆ 5            │
│ LINAUSDT  ┆ 3.017736     ┆ 90   ┆ 4            │
│ GALUSDT   ┆ 3.580024     ┆ 91   ┆ 3            │
│ KLAYUSDT  ┆ 4.308325     ┆ 92   ┆ 2            │
│ IOTAUSDT  ┆ 4.371172     ┆ 93   ┆ 1            │
│ CTKUSDT   ┆ 5.103405     ┆ 94   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,024 - WARNING - 2023-02-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,024 - INFO - cur close time: 2023-02-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:10,024 - DEBUG - mean expected ret (mean factor): 0.18971251789036153
2024-12-12 23:54:10,028 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,028 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,028 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1721      ┆ null        ┆ … ┆ 0.03266 ┆ null   ┆ null    ┆ 0.2592  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,032 - DEBUG - update position: 2023-02-18T23:59:59.999 === diff_trading_value: 371634.44470512564 == cash: 83959.33828914865 
2024-12-12 23:54:10,036 - INFO - pnl: 2023-02-18T23:59:59.999 83959.33828914865 === -1.406%
2024-12-12 23:54:10,036 - DEBUG - cur time: 2023-02-19T23:59:59.999 == next bar open time: 2023-02-20T00:00:00.000 == close pos time: 2023-02-25T00:00:00.000
2024-12-12 23:54:10,039 - INFO - pnl: 2023-02-19T23:59:59.999 84865.7011749373 === 1.080%
2024-12-12 23:54:10,039 - DEBUG - cur time: 2023-02-20T23:59:59.999 == next bar open time: 2023-02-21T00:00:00.000 == close pos time: 2023-02-26T00:00:00.000
2024-12-12 23:54:10,039 - INFO - pnl: 2023-02-20T23:59:59.999 80755.4208984004 === -4.843%
2024-12-12 23:54:10,043 - DEBUG - cur time: 2023-02-21T23:59:59.999 == next bar open time: 2023-02-22T00:00:00.000 == close pos time: 2023-02-27T00:00:00.000
2024-12-12 23:54:10,043 - INFO - pnl: 2023-02-21T23:59:59.999 82396.00050984634 === 2.032%
2024-12-12 23:54:10,047 - DEBUG - cur time: 2023-02-22T23:59:59.999 == next bar open time: 2023-02-23T00:00:00.000 == close pos time: 2023-02-28T00:00:00.000
2024-12-12 23:54:10,049 - INFO - pnl: 2023-02-22T23:59:59.999 81690.34310903023 === -0.856%
2024-12-12 23:54:10,052 - DEBUG - cur time: 2023-02-23T23:59:59.999 == next bar open time: 2023-02-24T00:00:00.000 == close pos time: 2023-03-01T00:00:00.000
2024-12-12 23:54:10,060 - DEBUG - close time 2023-02-23T23:59:59.999 == vol_threshold: 16716903.0
2024-12-12 23:54:10,060 - DEBUG - 2023-02-23T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:10,060 - DEBUG - sorted_long_factors: shape: (95, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ARPAUSDT  ┆ -5.246243    ┆ 0    ┆ 94           │
│ DUSKUSDT  ┆ -3.14275     ┆ 1    ┆ 93           │
│ XLMUSDT   ┆ -2.95802     ┆ 2    ┆ 92           │
│ LITUSDT   ┆ -2.898048    ┆ 3    ┆ 91           │
│ REEFUSDT  ┆ -2.32855     ┆ 4    ┆ 90           │
│ XRPUSDT   ┆ -2.18736     ┆ 5    ┆ 89           │
│ APTUSDT   ┆ -2.185418    ┆ 6    ┆ 88           │
│ BLZUSDT   ┆ -2.16253     ┆ 7    ┆ 87           │
│ SFPUSDT   ┆ -2.158794    ┆ 8    ┆ 86           │
│ JASMYUSDT ┆ -2.156425    ┆ 9    ┆ 85           │
│ …         ┆ …            ┆ …    ┆ …            │
│ TRXUSDT   ┆ 2.924168     ┆ 85   ┆ 9            │
│ ALPHAUSDT ┆ 3.455567     ┆ 86   ┆ 8            │
│ ICXUSDT   ┆ 3.609453     ┆ 87   ┆ 7            │
│ KNCUSDT   ┆ 3.709505     ┆ 88   ┆ 6            │
│ SXPUSDT   ┆ 3.722354     ┆ 89   ┆ 5            │
│ SNXUSDT   ┆ 4.166554     ┆ 90   ┆ 4            │
│ ENJUSDT   ┆ 4.200619     ┆ 91   ┆ 3            │
│ STMXUSDT  ┆ 4.363583     ┆ 92   ┆ 2            │
│ XEMUSDT   ┆ 4.565217     ┆ 93   ┆ 1            │
│ SUSHIUSDT ┆ 5.890024     ┆ 94   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,064 - WARNING - 2023-02-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,064 - INFO - cur close time: 2023-02-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:10,064 - DEBUG - mean expected ret (mean factor): 0.2965003611861974
2024-12-12 23:54:10,070 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,070 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,070 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.163       ┆ null        ┆ … ┆ 0.03538 ┆ null   ┆ null    ┆ 0.2776  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,076 - DEBUG - update position: 2023-02-23T23:59:59.999 === diff_trading_value: 374514.75303832255 == cash: 79792.7346800206 
2024-12-12 23:54:10,076 - INFO - pnl: 2023-02-23T23:59:59.999 79792.7346800206 === -2.323%
2024-12-12 23:54:10,079 - DEBUG - cur time: 2023-02-24T23:59:59.999 == next bar open time: 2023-02-25T00:00:00.000 == close pos time: 2023-03-02T00:00:00.000
2024-12-12 23:54:10,079 - INFO - pnl: 2023-02-24T23:59:59.999 81732.86699917263 === 2.431%
2024-12-12 23:54:10,083 - DEBUG - cur time: 2023-02-25T23:59:59.999 == next bar open time: 2023-02-26T00:00:00.000 == close pos time: 2023-03-03T00:00:00.000
2024-12-12 23:54:10,083 - INFO - pnl: 2023-02-25T23:59:59.999 80231.43018089067 === -1.837%
2024-12-12 23:54:10,087 - DEBUG - cur time: 2023-02-26T23:59:59.999 == next bar open time: 2023-02-27T00:00:00.000 == close pos time: 2023-03-04T00:00:00.000
2024-12-12 23:54:10,087 - INFO - pnl: 2023-02-26T23:59:59.999 80973.99990802546 === 0.926%
2024-12-12 23:54:10,092 - DEBUG - cur time: 2023-02-27T23:59:59.999 == next bar open time: 2023-02-28T00:00:00.000 == close pos time: 2023-03-05T00:00:00.000
2024-12-12 23:54:10,092 - INFO - pnl: 2023-02-27T23:59:59.999 82756.74471460629 === 2.202%
2024-12-12 23:54:10,092 - DEBUG - cur time: 2023-02-28T23:59:59.999 == next bar open time: 2023-03-01T00:00:00.000 == close pos time: 2023-03-06T00:00:00.000
2024-12-12 23:54:10,104 - DEBUG - close time 2023-02-28T23:59:59.999 == vol_threshold: 12408667.15
2024-12-12 23:54:10,104 - DEBUG - 2023-02-28T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:10,104 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ PEOPLEUSDT   ┆ -3.829352    ┆ 0    ┆ 94           │
│ 1000SHIBUSDT ┆ -3.18387     ┆ 1    ┆ 93           │
│ LITUSDT      ┆ -2.654202    ┆ 2    ┆ 92           │
│ 1000XECUSDT  ┆ -2.545979    ┆ 3    ┆ 91           │
│ JASMYUSDT    ┆ -2.452004    ┆ 4    ┆ 90           │
│ SANDUSDT     ┆ -2.268516    ┆ 5    ┆ 89           │
│ THETAUSDT    ┆ -2.182448    ┆ 6    ┆ 88           │
│ LUNA2USDT    ┆ -2.066727    ┆ 7    ┆ 87           │
│ FILUSDT      ┆ -2.038081    ┆ 8    ┆ 86           │
│ FLOWUSDT     ┆ -1.977278    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ DYDXUSDT     ┆ 2.755659     ┆ 85   ┆ 9            │
│ XEMUSDT      ┆ 2.779603     ┆ 86   ┆ 8            │
│ ONTUSDT      ┆ 2.842805     ┆ 87   ┆ 7            │
│ SKLUSDT      ┆ 3.059489     ┆ 88   ┆ 6            │
│ CHRUSDT      ┆ 3.096624     ┆ 89   ┆ 5            │
│ STMXUSDT     ┆ 3.144549     ┆ 90   ┆ 4            │
│ TRXUSDT      ┆ 3.415656     ┆ 91   ┆ 3            │
│ SNXUSDT      ┆ 3.589408     ┆ 92   ┆ 2            │
│ RENUSDT      ┆ 3.995052     ┆ 93   ┆ 1            │
│ IMXUSDT      ┆ 4.211635     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,112 - WARNING - 2023-02-28T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,112 - INFO - cur close time: 2023-02-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:10,112 - DEBUG - mean expected ret (mean factor): 0.24436527154406862
2024-12-12 23:54:10,116 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,116 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,116 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1638      ┆ null        ┆ … ┆ 0.03117 ┆ null   ┆ null    ┆ 0.2545  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,121 - DEBUG - update position: 2023-02-28T23:59:59.999 === diff_trading_value: 273925.21395097265 == cash: 80667.2286585558 
2024-12-12 23:54:10,121 - INFO - pnl: 2023-02-28T23:59:59.999 80667.2286585558 === -2.525%
2024-12-12 23:54:10,128 - DEBUG - cur time: 2023-03-01T23:59:59.999 == next bar open time: 2023-03-02T00:00:00.000 == close pos time: 2023-03-07T00:00:00.000
2024-12-12 23:54:10,130 - INFO - pnl: 2023-03-01T23:59:59.999 81874.8954730475 === 1.497%
2024-12-12 23:54:10,133 - DEBUG - cur time: 2023-03-02T23:59:59.999 == next bar open time: 2023-03-03T00:00:00.000 == close pos time: 2023-03-08T00:00:00.000
2024-12-12 23:54:10,133 - INFO - pnl: 2023-03-02T23:59:59.999 80473.08915010198 === -1.712%
2024-12-12 23:54:10,137 - DEBUG - cur time: 2023-03-03T23:59:59.999 == next bar open time: 2023-03-04T00:00:00.000 == close pos time: 2023-03-09T00:00:00.000
2024-12-12 23:54:10,139 - INFO - pnl: 2023-03-03T23:59:59.999 82787.14595153551 === 2.876%
2024-12-12 23:54:10,141 - DEBUG - cur time: 2023-03-04T23:59:59.999 == next bar open time: 2023-03-05T00:00:00.000 == close pos time: 2023-03-10T00:00:00.000
2024-12-12 23:54:10,141 - INFO - pnl: 2023-03-04T23:59:59.999 81536.86670003577 === -1.510%
2024-12-12 23:54:10,146 - DEBUG - cur time: 2023-03-05T23:59:59.999 == next bar open time: 2023-03-06T00:00:00.000 == close pos time: 2023-03-11T00:00:00.000
2024-12-12 23:54:10,154 - DEBUG - close time 2023-03-05T23:59:59.999 == vol_threshold: 11710348.555
2024-12-12 23:54:10,154 - DEBUG - 2023-03-05T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:10,154 - DEBUG - sorted_long_factors: shape: (95, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ 1000XECUSDT ┆ -4.919777    ┆ 0    ┆ 94           │
│ XRPUSDT     ┆ -4.804591    ┆ 1    ┆ 93           │
│ DGBUSDT     ┆ -4.058651    ┆ 2    ┆ 92           │
│ STORJUSDT   ┆ -3.988361    ┆ 3    ┆ 91           │
│ COTIUSDT    ┆ -3.682061    ┆ 4    ┆ 90           │
│ ALGOUSDT    ┆ -3.382086    ┆ 5    ┆ 89           │
│ VETUSDT     ┆ -3.36615     ┆ 6    ┆ 88           │
│ DUSKUSDT    ┆ -3.087331    ┆ 7    ┆ 87           │
│ IOTAUSDT    ┆ -2.87264     ┆ 8    ┆ 86           │
│ KLAYUSDT    ┆ -2.613559    ┆ 9    ┆ 85           │
│ …           ┆ …            ┆ …    ┆ …            │
│ ANKRUSDT    ┆ 2.933658     ┆ 85   ┆ 9            │
│ KNCUSDT     ┆ 3.273012     ┆ 86   ┆ 8            │
│ INJUSDT     ┆ 3.436913     ┆ 87   ┆ 7            │
│ IMXUSDT     ┆ 3.639812     ┆ 88   ┆ 6            │
│ TRXUSDT     ┆ 3.645961     ┆ 89   ┆ 5            │
│ CELRUSDT    ┆ 4.193458     ┆ 90   ┆ 4            │
│ IOTXUSDT    ┆ 4.230884     ┆ 91   ┆ 3            │
│ ONEUSDT     ┆ 4.252188     ┆ 92   ┆ 2            │
│ DARUSDT     ┆ 5.511311     ┆ 93   ┆ 1            │
│ SNXUSDT     ┆ 5.813748     ┆ 94   ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,162 - WARNING - 2023-03-05T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,162 - INFO - cur close time: 2023-03-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:10,162 - DEBUG - mean expected ret (mean factor): 0.10343288248210185
2024-12-12 23:54:10,166 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,166 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,166 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1445      ┆ null        ┆ … ┆ 0.02755 ┆ null   ┆ null    ┆ 0.2377  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,170 - DEBUG - update position: 2023-03-05T23:59:59.999 === diff_trading_value: 335023.86229022406 == cash: 82071.16045350209 
2024-12-12 23:54:10,170 - INFO - pnl: 2023-03-05T23:59:59.999 82071.16045350209 === 0.655%
2024-12-12 23:54:10,175 - DEBUG - cur time: 2023-03-06T23:59:59.999 == next bar open time: 2023-03-07T00:00:00.000 == close pos time: 2023-03-12T00:00:00.000
2024-12-12 23:54:10,180 - INFO - pnl: 2023-03-06T23:59:59.999 82034.70404677716 === -0.044%
2024-12-12 23:54:10,184 - DEBUG - cur time: 2023-03-07T23:59:59.999 == next bar open time: 2023-03-08T00:00:00.000 == close pos time: 2023-03-13T00:00:00.000
2024-12-12 23:54:10,184 - INFO - pnl: 2023-03-07T23:59:59.999 81700.13096463289 === -0.408%
2024-12-12 23:54:10,188 - DEBUG - cur time: 2023-03-08T23:59:59.999 == next bar open time: 2023-03-09T00:00:00.000 == close pos time: 2023-03-14T00:00:00.000
2024-12-12 23:54:10,190 - INFO - pnl: 2023-03-08T23:59:59.999 79252.47722500397 === -2.996%
2024-12-12 23:54:10,192 - DEBUG - cur time: 2023-03-09T23:59:59.999 == next bar open time: 2023-03-10T00:00:00.000 == close pos time: 2023-03-15T00:00:00.000
2024-12-12 23:54:10,192 - INFO - pnl: 2023-03-09T23:59:59.999 78353.0113388045 === -1.135%
2024-12-12 23:54:10,197 - DEBUG - cur time: 2023-03-10T23:59:59.999 == next bar open time: 2023-03-11T00:00:00.000 == close pos time: 2023-03-16T00:00:00.000
2024-12-12 23:54:10,205 - DEBUG - close time 2023-03-10T23:59:59.999 == vol_threshold: 32720714.9
2024-12-12 23:54:10,205 - DEBUG - 2023-03-10T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:10,210 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HOTUSDT      ┆ -6.244487    ┆ 0    ┆ 94           │
│ SPELLUSDT    ┆ -4.0635      ┆ 1    ┆ 93           │
│ CHRUSDT      ┆ -3.889565    ┆ 2    ┆ 92           │
│ 1000LUNCUSDT ┆ -3.601628    ┆ 3    ┆ 91           │
│ PEOPLEUSDT   ┆ -3.045227    ┆ 4    ┆ 90           │
│ BLZUSDT      ┆ -2.943537    ┆ 5    ┆ 89           │
│ BAKEUSDT     ┆ -2.872594    ┆ 6    ┆ 88           │
│ ARPAUSDT     ┆ -2.792969    ┆ 7    ┆ 87           │
│ 1000SHIBUSDT ┆ -2.655347    ┆ 8    ┆ 86           │
│ REEFUSDT     ┆ -2.527401    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ WOOUSDT      ┆ 2.385345     ┆ 85   ┆ 9            │
│ SNXUSDT      ┆ 2.479783     ┆ 86   ┆ 8            │
│ ALGOUSDT     ┆ 2.523042     ┆ 87   ┆ 7            │
│ TRXUSDT      ┆ 2.611384     ┆ 88   ┆ 6            │
│ MASKUSDT     ┆ 3.116629     ┆ 89   ┆ 5            │
│ ONTUSDT      ┆ 3.397053     ┆ 90   ┆ 4            │
│ DARUSDT      ┆ 4.269014     ┆ 91   ┆ 3            │
│ KLAYUSDT     ┆ 4.933304     ┆ 92   ┆ 2            │
│ INJUSDT      ┆ 5.164907     ┆ 93   ┆ 1            │
│ KAVAUSDT     ┆ 7.251618     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,217 - WARNING - 2023-03-10T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,217 - INFO - cur close time: 2023-03-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:10,217 - DEBUG - mean expected ret (mean factor): 0.19016595716295692
2024-12-12 23:54:10,221 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,221 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,221 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1244      ┆ null        ┆ … ┆ 0.02299 ┆ null   ┆ null    ┆ 0.201   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,228 - DEBUG - update position: 2023-03-10T23:59:59.999 === diff_trading_value: 296069.181679394 == cash: 79742.27488503249 
2024-12-12 23:54:10,229 - INFO - pnl: 2023-03-10T23:59:59.999 79742.27488503249 === 1.773%
2024-12-12 23:54:10,229 - DEBUG - cur time: 2023-03-11T23:59:59.999 == next bar open time: 2023-03-12T00:00:00.000 == close pos time: 2023-03-17T00:00:00.000
2024-12-12 23:54:10,233 - INFO - pnl: 2023-03-11T23:59:59.999 80401.49699054571 === 0.827%
2024-12-12 23:54:10,237 - DEBUG - cur time: 2023-03-12T23:59:59.999 == next bar open time: 2023-03-13T00:00:00.000 == close pos time: 2023-03-18T00:00:00.000
2024-12-12 23:54:10,239 - INFO - pnl: 2023-03-12T23:59:59.999 82458.9127977133 === 2.559%
2024-12-12 23:54:10,242 - DEBUG - cur time: 2023-03-13T23:59:59.999 == next bar open time: 2023-03-14T00:00:00.000 == close pos time: 2023-03-19T00:00:00.000
2024-12-12 23:54:10,242 - INFO - pnl: 2023-03-13T23:59:59.999 84611.21322839113 === 2.610%
2024-12-12 23:54:10,246 - DEBUG - cur time: 2023-03-14T23:59:59.999 == next bar open time: 2023-03-15T00:00:00.000 == close pos time: 2023-03-20T00:00:00.000
2024-12-12 23:54:10,246 - INFO - pnl: 2023-03-14T23:59:59.999 86322.16133157996 === 2.022%
2024-12-12 23:54:10,250 - DEBUG - cur time: 2023-03-15T23:59:59.999 == next bar open time: 2023-03-16T00:00:00.000 == close pos time: 2023-03-21T00:00:00.000
2024-12-12 23:54:10,260 - DEBUG - close time 2023-03-15T23:59:59.999 == vol_threshold: 27834190.909999996
2024-12-12 23:54:10,260 - DEBUG - 2023-03-15T23:59:59.999 == all trade symbol 135 == remain 94 after VOL filter
2024-12-12 23:54:10,262 - DEBUG - sorted_long_factors: shape: (94, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT      ┆ -2.642627    ┆ 0    ┆ 93           │
│ 1000SHIBUSDT ┆ -2.463362    ┆ 1    ┆ 92           │
│ RVNUSDT      ┆ -2.218244    ┆ 2    ┆ 91           │
│ FILUSDT      ┆ -1.966702    ┆ 3    ┆ 90           │
│ APTUSDT      ┆ -1.857143    ┆ 4    ┆ 89           │
│ DOGEUSDT     ┆ -1.66455     ┆ 5    ┆ 88           │
│ HOTUSDT      ┆ -1.655066    ┆ 6    ┆ 87           │
│ ATOMUSDT     ┆ -1.636771    ┆ 7    ┆ 86           │
│ KLAYUSDT     ┆ -1.365292    ┆ 8    ┆ 85           │
│ FTMUSDT      ┆ -1.341814    ┆ 9    ┆ 84           │
│ …            ┆ …            ┆ …    ┆ …            │
│ XLMUSDT      ┆ 1.066073     ┆ 84   ┆ 9            │
│ ZILUSDT      ┆ 1.066653     ┆ 85   ┆ 8            │
│ ONTUSDT      ┆ 1.406463     ┆ 86   ┆ 7            │
│ ARPAUSDT     ┆ 1.563348     ┆ 87   ┆ 6            │
│ CTSIUSDT     ┆ 1.699442     ┆ 88   ┆ 5            │
│ SNXUSDT      ┆ 1.782672     ┆ 89   ┆ 4            │
│ STMXUSDT     ┆ 1.841607     ┆ 90   ┆ 3            │
│ IOTAUSDT     ┆ 1.976192     ┆ 91   ┆ 2            │
│ TOMOUSDT     ┆ 2.751019     ┆ 92   ┆ 1            │
│ 1000XECUSDT  ┆ 4.171862     ┆ 93   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,266 - WARNING - 2023-03-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,266 - INFO - cur close time: 2023-03-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:10,266 - DEBUG - mean expected ret (mean factor): -0.1096845050550538
2024-12-12 23:54:10,272 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,272 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,272 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1237      ┆ null        ┆ … ┆ 0.02678 ┆ null   ┆ null    ┆ 0.2166  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,276 - DEBUG - update position: 2023-03-15T23:59:59.999 === diff_trading_value: 319823.9847171898 == cash: 87425.48019804312 
2024-12-12 23:54:10,276 - INFO - pnl: 2023-03-15T23:59:59.999 87425.48019804312 === 1.278%
2024-12-12 23:54:10,280 - DEBUG - cur time: 2023-03-16T23:59:59.999 == next bar open time: 2023-03-17T00:00:00.000 == close pos time: 2023-03-22T00:00:00.000
2024-12-12 23:54:10,284 - INFO - pnl: 2023-03-16T23:59:59.999 88016.36965775506 === 0.676%
2024-12-12 23:54:10,288 - DEBUG - cur time: 2023-03-17T23:59:59.999 == next bar open time: 2023-03-18T00:00:00.000 == close pos time: 2023-03-23T00:00:00.000
2024-12-12 23:54:10,289 - INFO - pnl: 2023-03-17T23:59:59.999 91384.69770636159 === 3.827%
2024-12-12 23:54:10,293 - DEBUG - cur time: 2023-03-18T23:59:59.999 == next bar open time: 2023-03-19T00:00:00.000 == close pos time: 2023-03-24T00:00:00.000
2024-12-12 23:54:10,293 - INFO - pnl: 2023-03-18T23:59:59.999 94104.38335954459 === 2.976%
2024-12-12 23:54:10,297 - DEBUG - cur time: 2023-03-19T23:59:59.999 == next bar open time: 2023-03-20T00:00:00.000 == close pos time: 2023-03-25T00:00:00.000
2024-12-12 23:54:10,299 - INFO - pnl: 2023-03-19T23:59:59.999 94020.52576653038 === -0.089%
2024-12-12 23:54:10,301 - DEBUG - cur time: 2023-03-20T23:59:59.999 == next bar open time: 2023-03-21T00:00:00.000 == close pos time: 2023-03-26T00:00:00.000
2024-12-12 23:54:10,324 - DEBUG - close time 2023-03-20T23:59:59.999 == vol_threshold: 28811900.679999996
2024-12-12 23:54:10,328 - DEBUG - 2023-03-20T23:59:59.999 == all trade symbol 135 == remain 94 after VOL filter
2024-12-12 23:54:10,331 - DEBUG - sorted_long_factors: shape: (94, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ NKNUSDT     ┆ -4.308899    ┆ 0    ┆ 93           │
│ DOGEUSDT    ┆ -3.91196     ┆ 1    ┆ 92           │
│ FILUSDT     ┆ -3.289839    ┆ 2    ┆ 91           │
│ BAKEUSDT    ┆ -3.004088    ┆ 3    ┆ 90           │
│ REEFUSDT    ┆ -2.85791     ┆ 4    ┆ 89           │
│ DOTUSDT     ┆ -2.717604    ┆ 5    ┆ 88           │
│ LDOUSDT     ┆ -2.49411     ┆ 6    ┆ 87           │
│ STGUSDT     ┆ -2.438798    ┆ 7    ┆ 86           │
│ APTUSDT     ┆ -2.413782    ┆ 8    ┆ 85           │
│ ROSEUSDT    ┆ -2.353219    ┆ 9    ┆ 84           │
│ …           ┆ …            ┆ …    ┆ …            │
│ DGBUSDT     ┆ 2.943122     ┆ 84   ┆ 9            │
│ STMXUSDT    ┆ 3.487065     ┆ 85   ┆ 8            │
│ LINAUSDT    ┆ 3.533272     ┆ 86   ┆ 7            │
│ BATUSDT     ┆ 3.713494     ┆ 87   ┆ 6            │
│ MASKUSDT    ┆ 3.76601      ┆ 88   ┆ 5            │
│ 1000XECUSDT ┆ 3.819531     ┆ 89   ┆ 4            │
│ OMGUSDT     ┆ 3.864198     ┆ 90   ┆ 3            │
│ TOMOUSDT    ┆ 4.13577      ┆ 91   ┆ 2            │
│ FLOWUSDT    ┆ 4.924258     ┆ 92   ┆ 1            │
│ IOTAUSDT    ┆ 6.441745     ┆ 93   ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,350 - WARNING - 2023-03-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,350 - INFO - cur close time: 2023-03-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:10,350 - DEBUG - mean expected ret (mean factor): 0.10420685883279615
2024-12-12 23:54:10,352 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,352 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,352 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1265      ┆ null        ┆ … ┆ 0.02762 ┆ null   ┆ null    ┆ 0.2338  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,364 - DEBUG - update position: 2023-03-20T23:59:59.999 === diff_trading_value: 281832.59926487156 == cash: 94350.09713341038 
2024-12-12 23:54:10,364 - INFO - pnl: 2023-03-20T23:59:59.999 94350.09713341038 === 0.351%
2024-12-12 23:54:10,369 - DEBUG - cur time: 2023-03-21T23:59:59.999 == next bar open time: 2023-03-22T00:00:00.000 == close pos time: 2023-03-27T00:00:00.000
2024-12-12 23:54:10,369 - INFO - pnl: 2023-03-21T23:59:59.999 91306.75600774666 === -3.226%
2024-12-12 23:54:10,372 - DEBUG - cur time: 2023-03-22T23:59:59.999 == next bar open time: 2023-03-23T00:00:00.000 == close pos time: 2023-03-28T00:00:00.000
2024-12-12 23:54:10,376 - INFO - pnl: 2023-03-22T23:59:59.999 89786.07855245321 === -1.665%
2024-12-12 23:54:10,380 - DEBUG - cur time: 2023-03-23T23:59:59.999 == next bar open time: 2023-03-24T00:00:00.000 == close pos time: 2023-03-29T00:00:00.000
2024-12-12 23:54:10,380 - INFO - pnl: 2023-03-23T23:59:59.999 91625.257773513 === 2.048%
2024-12-12 23:54:10,384 - DEBUG - cur time: 2023-03-24T23:59:59.999 == next bar open time: 2023-03-25T00:00:00.000 == close pos time: 2023-03-30T00:00:00.000
2024-12-12 23:54:10,384 - INFO - pnl: 2023-03-24T23:59:59.999 93507.13511418595 === 2.054%
2024-12-12 23:54:10,388 - DEBUG - cur time: 2023-03-25T23:59:59.999 == next bar open time: 2023-03-26T00:00:00.000 == close pos time: 2023-03-31T00:00:00.000
2024-12-12 23:54:10,396 - DEBUG - close time 2023-03-25T23:59:59.999 == vol_threshold: 16279137.619999997
2024-12-12 23:54:10,396 - DEBUG - 2023-03-25T23:59:59.999 == all trade symbol 135 == remain 94 after VOL filter
2024-12-12 23:54:10,400 - DEBUG - sorted_long_factors: shape: (94, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ADAUSDT      ┆ -2.86534     ┆ 0    ┆ 93           │
│ FILUSDT      ┆ -2.819307    ┆ 1    ┆ 92           │
│ 1000SHIBUSDT ┆ -2.564303    ┆ 2    ┆ 91           │
│ DOGEUSDT     ┆ -2.368602    ┆ 3    ┆ 90           │
│ STORJUSDT    ┆ -2.364988    ┆ 4    ┆ 89           │
│ APTUSDT      ┆ -2.134859    ┆ 5    ┆ 88           │
│ LDOUSDT      ┆ -2.047665    ┆ 6    ┆ 87           │
│ HBARUSDT     ┆ -1.821183    ┆ 7    ┆ 86           │
│ GRTUSDT      ┆ -1.796741    ┆ 8    ┆ 85           │
│ SNXUSDT      ┆ -1.763837    ┆ 9    ┆ 84           │
│ …            ┆ …            ┆ …    ┆ …            │
│ CELOUSDT     ┆ 2.413556     ┆ 84   ┆ 9            │
│ IOTXUSDT     ┆ 2.418329     ┆ 85   ┆ 8            │
│ FLMUSDT      ┆ 2.576946     ┆ 86   ┆ 7            │
│ CELRUSDT     ┆ 3.070001     ┆ 87   ┆ 6            │
│ COTIUSDT     ┆ 3.141568     ┆ 88   ┆ 5            │
│ TOMOUSDT     ┆ 3.311673     ┆ 89   ┆ 4            │
│ BATUSDT      ┆ 3.46206      ┆ 90   ┆ 3            │
│ CTSIUSDT     ┆ 3.541967     ┆ 91   ┆ 2            │
│ IOSTUSDT     ┆ 3.548369     ┆ 92   ┆ 1            │
│ GTCUSDT      ┆ 3.741178     ┆ 93   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,404 - WARNING - 2023-03-25T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,404 - INFO - cur close time: 2023-03-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:10,404 - DEBUG - mean expected ret (mean factor): 0.13655058511365506
2024-12-12 23:54:10,409 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,409 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,409 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1254      ┆ null        ┆ … ┆ 0.02678 ┆ null   ┆ null    ┆ 0.2249  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,422 - DEBUG - update position: 2023-03-25T23:59:59.999 === diff_trading_value: 215788.6199694739 == cash: 93393.09469053127 
2024-12-12 23:54:10,422 - INFO - pnl: 2023-03-25T23:59:59.999 93393.09469053127 === -0.122%
2024-12-12 23:54:10,430 - DEBUG - cur time: 2023-03-26T23:59:59.999 == next bar open time: 2023-03-27T00:00:00.000 == close pos time: 2023-04-01T00:00:00.000
2024-12-12 23:54:10,432 - INFO - pnl: 2023-03-26T23:59:59.999 93215.35237032374 === -0.190%
2024-12-12 23:54:10,434 - DEBUG - cur time: 2023-03-27T23:59:59.999 == next bar open time: 2023-03-28T00:00:00.000 == close pos time: 2023-04-02T00:00:00.000
2024-12-12 23:54:10,434 - INFO - pnl: 2023-03-27T23:59:59.999 91763.75304600863 === -1.557%
2024-12-12 23:54:10,440 - DEBUG - cur time: 2023-03-28T23:59:59.999 == next bar open time: 2023-03-29T00:00:00.000 == close pos time: 2023-04-03T00:00:00.000
2024-12-12 23:54:10,442 - INFO - pnl: 2023-03-28T23:59:59.999 91268.76434581753 === -0.539%
2024-12-12 23:54:10,447 - DEBUG - cur time: 2023-03-29T23:59:59.999 == next bar open time: 2023-03-30T00:00:00.000 == close pos time: 2023-04-04T00:00:00.000
2024-12-12 23:54:10,449 - INFO - pnl: 2023-03-29T23:59:59.999 95162.11566378323 === 4.266%
2024-12-12 23:54:10,450 - DEBUG - cur time: 2023-03-30T23:59:59.999 == next bar open time: 2023-03-31T00:00:00.000 == close pos time: 2023-04-05T00:00:00.000
2024-12-12 23:54:10,463 - DEBUG - close time 2023-03-30T23:59:59.999 == vol_threshold: 21068551.6
2024-12-12 23:54:10,463 - DEBUG - 2023-03-30T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:10,463 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ FETUSDT      ┆ -4.374007    ┆ 0    ┆ 94           │
│ FILUSDT      ┆ -4.14584     ┆ 1    ┆ 93           │
│ DOGEUSDT     ┆ -3.752534    ┆ 2    ┆ 92           │
│ STGUSDT      ┆ -3.188489    ┆ 3    ┆ 91           │
│ SFPUSDT      ┆ -3.007879    ┆ 4    ┆ 90           │
│ 1000SHIBUSDT ┆ -2.268421    ┆ 5    ┆ 89           │
│ IOSTUSDT     ┆ -2.203491    ┆ 6    ┆ 88           │
│ APTUSDT      ┆ -2.117943    ┆ 7    ┆ 87           │
│ BAKEUSDT     ┆ -2.09924     ┆ 8    ┆ 86           │
│ DOTUSDT      ┆ -1.853564    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ C98USDT      ┆ 3.10162      ┆ 85   ┆ 9            │
│ EOSUSDT      ┆ 3.110304     ┆ 86   ┆ 8            │
│ ZILUSDT      ┆ 3.113798     ┆ 87   ┆ 7            │
│ XEMUSDT      ┆ 3.358842     ┆ 88   ┆ 6            │
│ GMTUSDT      ┆ 3.549682     ┆ 89   ┆ 5            │
│ DENTUSDT     ┆ 3.792405     ┆ 90   ┆ 4            │
│ 1INCHUSDT    ┆ 4.318        ┆ 91   ┆ 3            │
│ HOTUSDT      ┆ 5.548954     ┆ 92   ┆ 2            │
│ SXPUSDT      ┆ 5.900963     ┆ 93   ┆ 1            │
│ INJUSDT      ┆ 5.933896     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,471 - WARNING - 2023-03-30T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,471 - INFO - cur close time: 2023-03-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:10,471 - DEBUG - mean expected ret (mean factor): 0.3820533351054399
2024-12-12 23:54:10,475 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,475 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,475 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1221      ┆ null        ┆ … ┆ 0.02784 ┆ null   ┆ null    ┆ 0.2309  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,480 - DEBUG - update position: 2023-03-30T23:59:59.999 === diff_trading_value: 260422.67381504382 == cash: 94260.11174813019 
2024-12-12 23:54:10,480 - INFO - pnl: 2023-03-30T23:59:59.999 94260.11174813019 === -0.948%
2024-12-12 23:54:10,483 - DEBUG - cur time: 2023-03-31T23:59:59.999 == next bar open time: 2023-04-01T00:00:00.000 == close pos time: 2023-04-06T00:00:00.000
2024-12-12 23:54:10,483 - INFO - pnl: 2023-03-31T23:59:59.999 95851.91084339842 === 1.689%
2024-12-12 23:54:10,489 - DEBUG - cur time: 2023-04-01T23:59:59.999 == next bar open time: 2023-04-02T00:00:00.000 == close pos time: 2023-04-07T00:00:00.000
2024-12-12 23:54:10,489 - INFO - pnl: 2023-04-01T23:59:59.999 95866.60241738684 === 0.015%
2024-12-12 23:54:10,493 - DEBUG - cur time: 2023-04-02T23:59:59.999 == next bar open time: 2023-04-03T00:00:00.000 == close pos time: 2023-04-08T00:00:00.000
2024-12-12 23:54:10,493 - INFO - pnl: 2023-04-02T23:59:59.999 95111.31338176082 === -0.788%
2024-12-12 23:54:10,497 - DEBUG - cur time: 2023-04-03T23:59:59.999 == next bar open time: 2023-04-04T00:00:00.000 == close pos time: 2023-04-09T00:00:00.000
2024-12-12 23:54:10,500 - INFO - pnl: 2023-04-03T23:59:59.999 95921.31133561235 === 0.852%
2024-12-12 23:54:10,501 - DEBUG - cur time: 2023-04-04T23:59:59.999 == next bar open time: 2023-04-05T00:00:00.000 == close pos time: 2023-04-10T00:00:00.000
2024-12-12 23:54:10,509 - DEBUG - close time 2023-04-04T23:59:59.999 == vol_threshold: 16922174.490000002
2024-12-12 23:54:10,509 - DEBUG - 2023-04-04T23:59:59.999 == all trade symbol 138 == remain 96 after VOL filter
2024-12-12 23:54:10,513 - DEBUG - sorted_long_factors: shape: (96, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ZILUSDT   ┆ -3.984254    ┆ 0    ┆ 95           │
│ BELUSDT   ┆ -3.93078     ┆ 1    ┆ 94           │
│ MASKUSDT  ┆ -3.259727    ┆ 2    ┆ 93           │
│ DGBUSDT   ┆ -3.033782    ┆ 3    ┆ 92           │
│ CHZUSDT   ┆ -2.983273    ┆ 4    ┆ 91           │
│ LRCUSDT   ┆ -2.910036    ┆ 5    ┆ 90           │
│ APTUSDT   ┆ -2.745921    ┆ 6    ┆ 89           │
│ MANAUSDT  ┆ -2.296994    ┆ 7    ┆ 88           │
│ FILUSDT   ┆ -2.255758    ┆ 8    ┆ 87           │
│ FLMUSDT   ┆ -2.213439    ┆ 9    ┆ 86           │
│ …         ┆ …            ┆ …    ┆ …            │
│ KNCUSDT   ┆ 3.279361     ┆ 86   ┆ 9            │
│ NEARUSDT  ┆ 3.308012     ┆ 87   ┆ 8            │
│ STORJUSDT ┆ 3.314427     ┆ 88   ┆ 7            │
│ GRTUSDT   ┆ 3.520429     ┆ 89   ┆ 6            │
│ ICXUSDT   ┆ 3.96137      ┆ 90   ┆ 5            │
│ DENTUSDT  ┆ 3.979533     ┆ 91   ┆ 4            │
│ LINAUSDT  ┆ 4.428462     ┆ 92   ┆ 3            │
│ RUNEUSDT  ┆ 4.568047     ┆ 93   ┆ 2            │
│ MATICUSDT ┆ 4.822235     ┆ 94   ┆ 1            │
│ OCEANUSDT ┆ 5.621844     ┆ 95   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,517 - WARNING - 2023-04-04T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,517 - INFO - cur close time: 2023-04-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:10,517 - DEBUG - mean expected ret (mean factor): 0.24736728287637755
2024-12-12 23:54:10,522 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,522 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,522 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1235      ┆ null        ┆ … ┆ 0.02972 ┆ null   ┆ null    ┆ 0.3319  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,528 - DEBUG - update position: 2023-04-04T23:59:59.999 === diff_trading_value: 335786.3815982429 == cash: 94265.28133809473 
2024-12-12 23:54:10,530 - INFO - pnl: 2023-04-04T23:59:59.999 94265.28133809473 === -1.726%
2024-12-12 23:54:10,533 - DEBUG - cur time: 2023-04-05T23:59:59.999 == next bar open time: 2023-04-06T00:00:00.000 == close pos time: 2023-04-11T00:00:00.000
2024-12-12 23:54:10,533 - INFO - pnl: 2023-04-05T23:59:59.999 94317.84021970897 === 0.056%
2024-12-12 23:54:10,537 - DEBUG - cur time: 2023-04-06T23:59:59.999 == next bar open time: 2023-04-07T00:00:00.000 == close pos time: 2023-04-12T00:00:00.000
2024-12-12 23:54:10,537 - INFO - pnl: 2023-04-06T23:59:59.999 94467.95465116065 === 0.159%
2024-12-12 23:54:10,541 - DEBUG - cur time: 2023-04-07T23:59:59.999 == next bar open time: 2023-04-08T00:00:00.000 == close pos time: 2023-04-13T00:00:00.000
2024-12-12 23:54:10,541 - INFO - pnl: 2023-04-07T23:59:59.999 94694.13302684535 === 0.239%
2024-12-12 23:54:10,545 - DEBUG - cur time: 2023-04-08T23:59:59.999 == next bar open time: 2023-04-09T00:00:00.000 == close pos time: 2023-04-14T00:00:00.000
2024-12-12 23:54:10,545 - INFO - pnl: 2023-04-08T23:59:59.999 93393.37663791038 === -1.374%
2024-12-12 23:54:10,550 - DEBUG - cur time: 2023-04-09T23:59:59.999 == next bar open time: 2023-04-10T00:00:00.000 == close pos time: 2023-04-15T00:00:00.000
2024-12-12 23:54:10,560 - DEBUG - close time 2023-04-09T23:59:59.999 == vol_threshold: 12768623.38
2024-12-12 23:54:10,560 - DEBUG - 2023-04-09T23:59:59.999 == all trade symbol 139 == remain 97 after VOL filter
2024-12-12 23:54:10,562 - DEBUG - sorted_long_factors: shape: (97, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ IOSTUSDT     ┆ -4.90182     ┆ 0    ┆ 96           │
│ SFPUSDT      ┆ -3.725285    ┆ 1    ┆ 95           │
│ MANAUSDT     ┆ -3.566092    ┆ 2    ┆ 94           │
│ FLMUSDT      ┆ -3.444203    ┆ 3    ┆ 93           │
│ OMGUSDT      ┆ -3.371805    ┆ 4    ┆ 92           │
│ 1000SHIBUSDT ┆ -3.202922    ┆ 5    ┆ 91           │
│ 1000LUNCUSDT ┆ -3.063087    ┆ 6    ┆ 90           │
│ HBARUSDT     ┆ -2.887002    ┆ 7    ┆ 89           │
│ IOTAUSDT     ┆ -2.649969    ┆ 8    ┆ 88           │
│ MTLUSDT      ┆ -2.61696     ┆ 9    ┆ 87           │
│ …            ┆ …            ┆ …    ┆ …            │
│ DENTUSDT     ┆ 2.34638      ┆ 87   ┆ 9            │
│ UNFIUSDT     ┆ 2.498726     ┆ 88   ┆ 8            │
│ BELUSDT      ┆ 2.583214     ┆ 89   ┆ 7            │
│ JASMYUSDT    ┆ 2.61237      ┆ 90   ┆ 6            │
│ SXPUSDT      ┆ 2.811798     ┆ 91   ┆ 5            │
│ EOSUSDT      ┆ 3.221327     ┆ 92   ┆ 4            │
│ DARUSDT      ┆ 3.882435     ┆ 93   ┆ 3            │
│ TRXUSDT      ┆ 4.235808     ┆ 94   ┆ 2            │
│ INJUSDT      ┆ 4.327946     ┆ 95   ┆ 1            │
│ OPUSDT       ┆ 5.033217     ┆ 96   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,567 - INFO - cur close time: 2023-04-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:10,567 - DEBUG - mean expected ret (mean factor): 0.08165330378268854
2024-12-12 23:54:10,570 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,570 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,570 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1249      ┆ null        ┆ … ┆ 0.02922 ┆ null   ┆ null    ┆ 0.2874  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,579 - DEBUG - update position: 2023-04-09T23:59:59.999 === diff_trading_value: 292174.2166499938 == cash: 90562.23528279821 
2024-12-12 23:54:10,579 - INFO - pnl: 2023-04-09T23:59:59.999 90562.23528279821 === -3.031%
2024-12-12 23:54:10,583 - DEBUG - cur time: 2023-04-10T23:59:59.999 == next bar open time: 2023-04-11T00:00:00.000 == close pos time: 2023-04-16T00:00:00.000
2024-12-12 23:54:10,583 - INFO - pnl: 2023-04-10T23:59:59.999 91465.07815888031 === 0.997%
2024-12-12 23:54:10,586 - DEBUG - cur time: 2023-04-11T23:59:59.999 == next bar open time: 2023-04-12T00:00:00.000 == close pos time: 2023-04-17T00:00:00.000
2024-12-12 23:54:10,590 - INFO - pnl: 2023-04-11T23:59:59.999 90350.44409822291 === -1.219%
2024-12-12 23:54:10,594 - DEBUG - cur time: 2023-04-12T23:59:59.999 == next bar open time: 2023-04-13T00:00:00.000 == close pos time: 2023-04-18T00:00:00.000
2024-12-12 23:54:10,594 - INFO - pnl: 2023-04-12T23:59:59.999 91231.05426736336 === 0.975%
2024-12-12 23:54:10,598 - DEBUG - cur time: 2023-04-13T23:59:59.999 == next bar open time: 2023-04-14T00:00:00.000 == close pos time: 2023-04-19T00:00:00.000
2024-12-12 23:54:10,599 - INFO - pnl: 2023-04-13T23:59:59.999 91759.75556521048 === 0.580%
2024-12-12 23:54:10,602 - DEBUG - cur time: 2023-04-14T23:59:59.999 == next bar open time: 2023-04-15T00:00:00.000 == close pos time: 2023-04-20T00:00:00.000
2024-12-12 23:54:10,610 - DEBUG - close time 2023-04-14T23:59:59.999 == vol_threshold: 23738726.36
2024-12-12 23:54:10,610 - DEBUG - 2023-04-14T23:59:59.999 == all trade symbol 140 == remain 98 after VOL filter
2024-12-12 23:54:10,614 - DEBUG - sorted_long_factors: shape: (98, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ LRCUSDT   ┆ -2.060153    ┆ 0    ┆ 97           │
│ KNCUSDT   ┆ -2.033494    ┆ 1    ┆ 96           │
│ ANKRUSDT  ┆ -2.006969    ┆ 2    ┆ 95           │
│ MANAUSDT  ┆ -1.999509    ┆ 3    ┆ 94           │
│ IOSTUSDT  ┆ -1.895879    ┆ 4    ┆ 93           │
│ CHRUSDT   ┆ -1.86596     ┆ 5    ┆ 92           │
│ NKNUSDT   ┆ -1.749376    ┆ 6    ┆ 91           │
│ APTUSDT   ┆ -1.724757    ┆ 7    ┆ 90           │
│ XTZUSDT   ┆ -1.626856    ┆ 8    ┆ 89           │
│ SFPUSDT   ┆ -1.476371    ┆ 9    ┆ 88           │
│ …         ┆ …            ┆ …    ┆ …            │
│ SUSHIUSDT ┆ 1.345858     ┆ 88   ┆ 9            │
│ STMXUSDT  ┆ 1.377839     ┆ 89   ┆ 8            │
│ ROSEUSDT  ┆ 1.615061     ┆ 90   ┆ 7            │
│ LDOUSDT   ┆ 1.729883     ┆ 91   ┆ 6            │
│ TOMOUSDT  ┆ 1.867862     ┆ 92   ┆ 5            │
│ ICXUSDT   ┆ 1.976026     ┆ 93   ┆ 4            │
│ GMTUSDT   ┆ 2.047367     ┆ 94   ┆ 3            │
│ INJUSDT   ┆ 3.400706     ┆ 95   ┆ 2            │
│ TRXUSDT   ┆ 3.630988     ┆ 96   ┆ 1            │
│ WOOUSDT   ┆ 3.946943     ┆ 97   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,620 - WARNING - 2023-04-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,620 - INFO - cur close time: 2023-04-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:10,622 - DEBUG - mean expected ret (mean factor): -0.01561491000285898
2024-12-12 23:54:10,626 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,626 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,626 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1283      ┆ null        ┆ … ┆ 0.03064 ┆ null   ┆ null    ┆ 0.2995  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,630 - DEBUG - update position: 2023-04-14T23:59:59.999 === diff_trading_value: 291063.98601563845 == cash: 93860.25459859759 
2024-12-12 23:54:10,630 - INFO - pnl: 2023-04-14T23:59:59.999 93860.25459859759 === 2.289%
2024-12-12 23:54:10,634 - DEBUG - cur time: 2023-04-15T23:59:59.999 == next bar open time: 2023-04-16T00:00:00.000 == close pos time: 2023-04-21T00:00:00.000
2024-12-12 23:54:10,634 - INFO - pnl: 2023-04-15T23:59:59.999 93953.44747132814 === 0.099%
2024-12-12 23:54:10,641 - DEBUG - cur time: 2023-04-16T23:59:59.999 == next bar open time: 2023-04-17T00:00:00.000 == close pos time: 2023-04-22T00:00:00.000
2024-12-12 23:54:10,642 - INFO - pnl: 2023-04-16T23:59:59.999 94581.46171374133 === 0.668%
2024-12-12 23:54:10,642 - DEBUG - cur time: 2023-04-17T23:59:59.999 == next bar open time: 2023-04-18T00:00:00.000 == close pos time: 2023-04-23T00:00:00.000
2024-12-12 23:54:10,646 - INFO - pnl: 2023-04-17T23:59:59.999 92610.34428956226 === -2.084%
2024-12-12 23:54:10,651 - DEBUG - cur time: 2023-04-18T23:59:59.999 == next bar open time: 2023-04-19T00:00:00.000 == close pos time: 2023-04-24T00:00:00.000
2024-12-12 23:54:10,652 - INFO - pnl: 2023-04-18T23:59:59.999 91768.80248376633 === -0.909%
2024-12-12 23:54:10,654 - DEBUG - cur time: 2023-04-19T23:59:59.999 == next bar open time: 2023-04-20T00:00:00.000 == close pos time: 2023-04-25T00:00:00.000
2024-12-12 23:54:10,663 - DEBUG - close time 2023-04-19T23:59:59.999 == vol_threshold: 31229071.96
2024-12-12 23:54:10,663 - DEBUG - 2023-04-19T23:59:59.999 == all trade symbol 143 == remain 100 after VOL filter
2024-12-12 23:54:10,667 - DEBUG - sorted_long_factors: shape: (100, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LUNA2USDT    ┆ -4.090655    ┆ 0    ┆ 99           │
│ MINAUSDT     ┆ -3.62098     ┆ 1    ┆ 98           │
│ 1000SHIBUSDT ┆ -3.565824    ┆ 2    ┆ 97           │
│ MAGICUSDT    ┆ -2.699489    ┆ 3    ┆ 96           │
│ XRPUSDT      ┆ -2.694067    ┆ 4    ┆ 95           │
│ GRTUSDT      ┆ -2.572073    ┆ 5    ┆ 94           │
│ ATAUSDT      ┆ -2.547069    ┆ 6    ┆ 93           │
│ HOOKUSDT     ┆ -2.455902    ┆ 7    ┆ 92           │
│ LINAUSDT     ┆ -2.357195    ┆ 8    ┆ 91           │
│ APEUSDT      ┆ -2.346869    ┆ 9    ┆ 90           │
│ …            ┆ …            ┆ …    ┆ …            │
│ ZILUSDT      ┆ 2.855128     ┆ 90   ┆ 9            │
│ REEFUSDT     ┆ 3.374361     ┆ 91   ┆ 8            │
│ WOOUSDT      ┆ 3.54226      ┆ 92   ┆ 7            │
│ INJUSDT      ┆ 3.582198     ┆ 93   ┆ 6            │
│ DGBUSDT      ┆ 3.769685     ┆ 94   ┆ 5            │
│ STMXUSDT     ┆ 3.810901     ┆ 95   ┆ 4            │
│ HOTUSDT      ┆ 4.037747     ┆ 96   ┆ 3            │
│ TOMOUSDT     ┆ 4.319683     ┆ 97   ┆ 2            │
│ TRXUSDT      ┆ 5.434309     ┆ 98   ┆ 1            │
│ CTSIUSDT     ┆ 6.126162     ┆ 99   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,671 - WARNING - 2023-04-19T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,671 - INFO - cur close time: 2023-04-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:10,671 - DEBUG - mean expected ret (mean factor): 0.2484582027570829
2024-12-12 23:54:10,676 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,676 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,676 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1163      ┆ null        ┆ … ┆ 0.03186 ┆ null   ┆ null    ┆ 0.2769  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,684 - DEBUG - update position: 2023-04-19T23:59:59.999 === diff_trading_value: 319324.0500135865 == cash: 92943.14121911547 
2024-12-12 23:54:10,684 - INFO - pnl: 2023-04-19T23:59:59.999 92943.14121911547 === 1.280%
2024-12-12 23:54:10,690 - DEBUG - cur time: 2023-04-20T23:59:59.999 == next bar open time: 2023-04-21T00:00:00.000 == close pos time: 2023-04-26T00:00:00.000
2024-12-12 23:54:10,690 - INFO - pnl: 2023-04-20T23:59:59.999 93095.41816529444 === 0.164%
2024-12-12 23:54:10,693 - DEBUG - cur time: 2023-04-21T23:59:59.999 == next bar open time: 2023-04-22T00:00:00.000 == close pos time: 2023-04-27T00:00:00.000
2024-12-12 23:54:10,696 - INFO - pnl: 2023-04-21T23:59:59.999 93199.44181722507 === 0.112%
2024-12-12 23:54:10,700 - DEBUG - cur time: 2023-04-22T23:59:59.999 == next bar open time: 2023-04-23T00:00:00.000 == close pos time: 2023-04-28T00:00:00.000
2024-12-12 23:54:10,700 - INFO - pnl: 2023-04-22T23:59:59.999 94045.22315901543 === 0.907%
2024-12-12 23:54:10,708 - DEBUG - cur time: 2023-04-23T23:59:59.999 == next bar open time: 2023-04-24T00:00:00.000 == close pos time: 2023-04-29T00:00:00.000
2024-12-12 23:54:10,710 - INFO - pnl: 2023-04-23T23:59:59.999 91830.73392416244 === -2.355%
2024-12-12 23:54:10,713 - DEBUG - cur time: 2023-04-24T23:59:59.999 == next bar open time: 2023-04-25T00:00:00.000 == close pos time: 2023-04-30T00:00:00.000
2024-12-12 23:54:10,722 - DEBUG - close time 2023-04-24T23:59:59.999 == vol_threshold: 17809906.860000003
2024-12-12 23:54:10,722 - DEBUG - 2023-04-24T23:59:59.999 == all trade symbol 143 == remain 100 after VOL filter
2024-12-12 23:54:10,726 - DEBUG - sorted_long_factors: shape: (100, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ STGUSDT      ┆ -5.278888    ┆ 0    ┆ 99           │
│ ALGOUSDT     ┆ -3.451018    ┆ 1    ┆ 98           │
│ STORJUSDT    ┆ -3.22015     ┆ 2    ┆ 97           │
│ CELRUSDT     ┆ -3.011476    ┆ 3    ┆ 96           │
│ FILUSDT      ┆ -2.840906    ┆ 4    ┆ 95           │
│ NEARUSDT     ┆ -2.666027    ┆ 5    ┆ 94           │
│ 1000SHIBUSDT ┆ -2.546542    ┆ 6    ┆ 93           │
│ RSRUSDT      ┆ -2.540933    ┆ 7    ┆ 92           │
│ ANKRUSDT     ┆ -2.43866     ┆ 8    ┆ 91           │
│ DUSKUSDT     ┆ -2.254504    ┆ 9    ┆ 90           │
│ …            ┆ …            ┆ …    ┆ …            │
│ BELUSDT      ┆ 2.469131     ┆ 90   ┆ 9            │
│ ZRXUSDT      ┆ 2.638313     ┆ 91   ┆ 8            │
│ OMGUSDT      ┆ 2.677057     ┆ 92   ┆ 7            │
│ ICXUSDT      ┆ 2.893607     ┆ 93   ┆ 6            │
│ TRXUSDT      ┆ 3.00386      ┆ 94   ┆ 5            │
│ ONEUSDT      ┆ 3.315397     ┆ 95   ┆ 4            │
│ TOMOUSDT     ┆ 3.500055     ┆ 96   ┆ 3            │
│ BLZUSDT      ┆ 4.358061     ┆ 97   ┆ 2            │
│ DGBUSDT      ┆ 6.773376     ┆ 98   ┆ 1            │
│ RVNUSDT      ┆ 8.822979     ┆ 99   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,730 - WARNING - 2023-04-24T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,730 - INFO - cur close time: 2023-04-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:10,730 - DEBUG - mean expected ret (mean factor): 0.12417382090045076
2024-12-12 23:54:10,735 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,735 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,735 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1106      ┆ null        ┆ … ┆ 0.03106 ┆ null   ┆ null    ┆ 0.2576  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,742 - DEBUG - update position: 2023-04-24T23:59:59.999 === diff_trading_value: 282607.5469315661 == cash: 92139.04003651287 
2024-12-12 23:54:10,742 - INFO - pnl: 2023-04-24T23:59:59.999 92139.04003651287 === 0.336%
2024-12-12 23:54:10,747 - DEBUG - cur time: 2023-04-25T23:59:59.999 == next bar open time: 2023-04-26T00:00:00.000 == close pos time: 2023-05-01T00:00:00.000
2024-12-12 23:54:10,749 - INFO - pnl: 2023-04-25T23:59:59.999 93237.66950233509 === 1.192%
2024-12-12 23:54:10,750 - DEBUG - cur time: 2023-04-26T23:59:59.999 == next bar open time: 2023-04-27T00:00:00.000 == close pos time: 2023-05-02T00:00:00.000
2024-12-12 23:54:10,750 - INFO - pnl: 2023-04-26T23:59:59.999 93196.88537638499 === -0.044%
2024-12-12 23:54:10,758 - DEBUG - cur time: 2023-04-27T23:59:59.999 == next bar open time: 2023-04-28T00:00:00.000 == close pos time: 2023-05-03T00:00:00.000
2024-12-12 23:54:10,760 - INFO - pnl: 2023-04-27T23:59:59.999 94004.06055076176 === 0.866%
2024-12-12 23:54:10,763 - DEBUG - cur time: 2023-04-28T23:59:59.999 == next bar open time: 2023-04-29T00:00:00.000 == close pos time: 2023-05-04T00:00:00.000
2024-12-12 23:54:10,767 - INFO - pnl: 2023-04-28T23:59:59.999 93770.01858133537 === -0.249%
2024-12-12 23:54:10,772 - DEBUG - cur time: 2023-04-29T23:59:59.999 == next bar open time: 2023-04-30T00:00:00.000 == close pos time: 2023-05-05T00:00:00.000
2024-12-12 23:54:10,783 - DEBUG - close time 2023-04-29T23:59:59.999 == vol_threshold: 13725806.119999997
2024-12-12 23:54:10,783 - DEBUG - 2023-04-29T23:59:59.999 == all trade symbol 147 == remain 103 after VOL filter
2024-12-12 23:54:10,790 - DEBUG - sorted_long_factors: shape: (103, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HOOKUSDT     ┆ -3.658456    ┆ 0    ┆ 102          │
│ 1000LUNCUSDT ┆ -3.322105    ┆ 1    ┆ 101          │
│ LUNA2USDT    ┆ -2.960815    ┆ 2    ┆ 100          │
│ BATUSDT      ┆ -2.956785    ┆ 3    ┆ 99           │
│ MANAUSDT     ┆ -2.913474    ┆ 4    ┆ 98           │
│ TUSDT        ┆ -2.80034     ┆ 5    ┆ 97           │
│ IOTAUSDT     ┆ -2.711494    ┆ 6    ┆ 96           │
│ MINAUSDT     ┆ -2.679701    ┆ 7    ┆ 95           │
│ THETAUSDT    ┆ -2.353835    ┆ 8    ┆ 94           │
│ MAGICUSDT    ┆ -2.303255    ┆ 9    ┆ 93           │
│ …            ┆ …            ┆ …    ┆ …            │
│ BELUSDT      ┆ 3.378237     ┆ 93   ┆ 9            │
│ RLCUSDT      ┆ 3.383675     ┆ 94   ┆ 8            │
│ ONEUSDT      ┆ 3.551089     ┆ 95   ┆ 7            │
│ ICPUSDT      ┆ 4.409868     ┆ 96   ┆ 6            │
│ SUSHIUSDT    ┆ 4.583895     ┆ 97   ┆ 5            │
│ IOTXUSDT     ┆ 4.704918     ┆ 98   ┆ 4            │
│ TRXUSDT      ┆ 4.860785     ┆ 99   ┆ 3            │
│ CRVUSDT      ┆ 5.151281     ┆ 100  ┆ 2            │
│ DENTUSDT     ┆ 6.213287     ┆ 101  ┆ 1            │
│ PEOPLEUSDT   ┆ 6.790802     ┆ 102  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,799 - WARNING - 2023-04-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,799 - INFO - cur close time: 2023-04-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:10,799 - DEBUG - mean expected ret (mean factor): 0.4407133992414816
2024-12-12 23:54:10,803 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,803 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,803 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1117      ┆ null        ┆ … ┆ 0.02883 ┆ null   ┆ null    ┆ 0.2622  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,812 - DEBUG - update position: 2023-04-29T23:59:59.999 === diff_trading_value: 348394.05007598526 == cash: 92846.93147864692 
2024-12-12 23:54:10,816 - INFO - pnl: 2023-04-29T23:59:59.999 92846.93147864692 === -0.984%
2024-12-12 23:54:10,821 - DEBUG - cur time: 2023-04-30T23:59:59.999 == next bar open time: 2023-05-01T00:00:00.000 == close pos time: 2023-05-06T00:00:00.000
2024-12-12 23:54:10,821 - INFO - pnl: 2023-04-30T23:59:59.999 91903.23267255958 === -1.016%
2024-12-12 23:54:10,828 - DEBUG - cur time: 2023-05-01T23:59:59.999 == next bar open time: 2023-05-02T00:00:00.000 == close pos time: 2023-05-07T00:00:00.000
2024-12-12 23:54:10,830 - INFO - pnl: 2023-05-01T23:59:59.999 92608.51951086015 === 0.767%
2024-12-12 23:54:10,835 - DEBUG - cur time: 2023-05-02T23:59:59.999 == next bar open time: 2023-05-03T00:00:00.000 == close pos time: 2023-05-08T00:00:00.000
2024-12-12 23:54:10,835 - INFO - pnl: 2023-05-02T23:59:59.999 91742.756014306 === -0.935%
2024-12-12 23:54:10,840 - DEBUG - cur time: 2023-05-03T23:59:59.999 == next bar open time: 2023-05-04T00:00:00.000 == close pos time: 2023-05-09T00:00:00.000
2024-12-12 23:54:10,843 - INFO - pnl: 2023-05-03T23:59:59.999 93002.04702629584 === 1.373%
2024-12-12 23:54:10,847 - DEBUG - cur time: 2023-05-04T23:59:59.999 == next bar open time: 2023-05-05T00:00:00.000 == close pos time: 2023-05-10T00:00:00.000
2024-12-12 23:54:10,859 - DEBUG - close time 2023-05-04T23:59:59.999 == vol_threshold: 12041723.7
2024-12-12 23:54:10,859 - DEBUG - 2023-05-04T23:59:59.999 == all trade symbol 151 == remain 105 after VOL filter
2024-12-12 23:54:10,859 - DEBUG - sorted_long_factors: shape: (105, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ LRCUSDT   ┆ -5.07025     ┆ 0    ┆ 104          │
│ MINAUSDT  ┆ -4.71383     ┆ 1    ┆ 103          │
│ C98USDT   ┆ -3.994259    ┆ 2    ┆ 102          │
│ LDOUSDT   ┆ -3.629048    ┆ 3    ┆ 101          │
│ STGUSDT   ┆ -3.387514    ┆ 4    ┆ 100          │
│ ROSEUSDT  ┆ -3.051997    ┆ 5    ┆ 99           │
│ ACHUSDT   ┆ -2.977585    ┆ 6    ┆ 98           │
│ REEFUSDT  ┆ -2.894148    ┆ 7    ┆ 97           │
│ ANKRUSDT  ┆ -2.731842    ┆ 8    ┆ 96           │
│ FETUSDT   ┆ -2.690023    ┆ 9    ┆ 95           │
│ …         ┆ …            ┆ …    ┆ …            │
│ COTIUSDT  ┆ 3.173674     ┆ 95   ┆ 9            │
│ DGBUSDT   ┆ 3.199761     ┆ 96   ┆ 8            │
│ ADAUSDT   ┆ 3.26093      ┆ 97   ┆ 7            │
│ STORJUSDT ┆ 3.284524     ┆ 98   ┆ 6            │
│ LINAUSDT  ┆ 3.646379     ┆ 99   ┆ 5            │
│ CFXUSDT   ┆ 3.67954      ┆ 100  ┆ 4            │
│ WOOUSDT   ┆ 4.088991     ┆ 101  ┆ 3            │
│ RVNUSDT   ┆ 4.254288     ┆ 102  ┆ 2            │
│ ZRXUSDT   ┆ 5.128869     ┆ 103  ┆ 1            │
│ KLAYUSDT  ┆ 5.177469     ┆ 104  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,867 - WARNING - 2023-05-04T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,867 - INFO - cur close time: 2023-05-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:10,867 - DEBUG - mean expected ret (mean factor): 0.14144021479785393
2024-12-12 23:54:10,872 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,872 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,872 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1035      ┆ null        ┆ … ┆ 0.02702 ┆ null   ┆ null    ┆ 0.2457  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,876 - DEBUG - update position: 2023-05-04T23:59:59.999 === diff_trading_value: 342549.9560565052 == cash: 92560.8152044078 
2024-12-12 23:54:10,880 - INFO - pnl: 2023-05-04T23:59:59.999 92560.8152044078 === -0.474%
2024-12-12 23:54:10,885 - DEBUG - cur time: 2023-05-05T23:59:59.999 == next bar open time: 2023-05-06T00:00:00.000 == close pos time: 2023-05-11T00:00:00.000
2024-12-12 23:54:10,885 - INFO - pnl: 2023-05-05T23:59:59.999 93070.8599341027 === 0.551%
2024-12-12 23:54:10,890 - DEBUG - cur time: 2023-05-06T23:59:59.999 == next bar open time: 2023-05-07T00:00:00.000 == close pos time: 2023-05-12T00:00:00.000
2024-12-12 23:54:10,893 - INFO - pnl: 2023-05-06T23:59:59.999 93826.88796000951 === 0.812%
2024-12-12 23:54:10,893 - DEBUG - cur time: 2023-05-07T23:59:59.999 == next bar open time: 2023-05-08T00:00:00.000 == close pos time: 2023-05-13T00:00:00.000
2024-12-12 23:54:10,898 - INFO - pnl: 2023-05-07T23:59:59.999 95033.74851484579 === 1.286%
2024-12-12 23:54:10,901 - DEBUG - cur time: 2023-05-08T23:59:59.999 == next bar open time: 2023-05-09T00:00:00.000 == close pos time: 2023-05-14T00:00:00.000
2024-12-12 23:54:10,901 - INFO - pnl: 2023-05-08T23:59:59.999 95616.9361817689 === 0.614%
2024-12-12 23:54:10,905 - DEBUG - cur time: 2023-05-09T23:59:59.999 == next bar open time: 2023-05-10T00:00:00.000 == close pos time: 2023-05-15T00:00:00.000
2024-12-12 23:54:10,919 - DEBUG - close time 2023-05-09T23:59:59.999 == vol_threshold: 14203770.799999997
2024-12-12 23:54:10,919 - DEBUG - 2023-05-09T23:59:59.999 == all trade symbol 152 == remain 106 after VOL filter
2024-12-12 23:54:10,922 - DEBUG - sorted_long_factors: shape: (106, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ KLAYUSDT     ┆ -4.159421    ┆ 0    ┆ 105          │
│ VETUSDT      ┆ -3.622349    ┆ 1    ┆ 104          │
│ MANAUSDT     ┆ -2.908407    ┆ 2    ┆ 103          │
│ HOTUSDT      ┆ -2.898155    ┆ 3    ┆ 102          │
│ THETAUSDT    ┆ -2.757648    ┆ 4    ┆ 101          │
│ BNXUSDT      ┆ -2.501262    ┆ 5    ┆ 100          │
│ NEARUSDT     ┆ -2.438098    ┆ 6    ┆ 99           │
│ DGBUSDT      ┆ -2.424758    ┆ 7    ┆ 98           │
│ 1000SHIBUSDT ┆ -2.246154    ┆ 8    ┆ 97           │
│ HBARUSDT     ┆ -2.089531    ┆ 9    ┆ 96           │
│ …            ┆ …            ┆ …    ┆ …            │
│ FLMUSDT      ┆ 2.398241     ┆ 96   ┆ 9            │
│ TRXUSDT      ┆ 2.752842     ┆ 97   ┆ 8            │
│ SPELLUSDT    ┆ 2.774526     ┆ 98   ┆ 7            │
│ LRCUSDT      ┆ 2.848134     ┆ 99   ┆ 6            │
│ CELRUSDT     ┆ 2.920471     ┆ 100  ┆ 5            │
│ BAKEUSDT     ┆ 3.451109     ┆ 101  ┆ 4            │
│ CHRUSDT      ┆ 3.61625      ┆ 102  ┆ 3            │
│ KAVAUSDT     ┆ 3.769954     ┆ 103  ┆ 2            │
│ STGUSDT      ┆ 5.107632     ┆ 104  ┆ 1            │
│ IOTXUSDT     ┆ 10.576215    ┆ 105  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:10,929 - WARNING - 2023-05-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:10,929 - INFO - cur close time: 2023-05-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:10,929 - DEBUG - mean expected ret (mean factor): 0.14241278338957958
2024-12-12 23:54:10,930 - DEBUG - begin to update pos: =========
2024-12-12 23:54:10,934 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,934 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0891      ┆ null        ┆ … ┆ 0.02394 ┆ null   ┆ null    ┆ 0.2192  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:10,942 - DEBUG - update position: 2023-05-09T23:59:59.999 === diff_trading_value: 347991.2030500384 == cash: 93916.04625108361 
2024-12-12 23:54:10,943 - INFO - pnl: 2023-05-09T23:59:59.999 93916.04625108361 === -1.779%
2024-12-12 23:54:10,950 - DEBUG - cur time: 2023-05-10T23:59:59.999 == next bar open time: 2023-05-11T00:00:00.000 == close pos time: 2023-05-16T00:00:00.000
2024-12-12 23:54:10,951 - INFO - pnl: 2023-05-10T23:59:59.999 96680.85729970972 === 2.944%
2024-12-12 23:54:10,956 - DEBUG - cur time: 2023-05-11T23:59:59.999 == next bar open time: 2023-05-12T00:00:00.000 == close pos time: 2023-05-17T00:00:00.000
2024-12-12 23:54:10,959 - INFO - pnl: 2023-05-11T23:59:59.999 95590.9830015213 === -1.127%
2024-12-12 23:54:10,963 - DEBUG - cur time: 2023-05-12T23:59:59.999 == next bar open time: 2023-05-13T00:00:00.000 == close pos time: 2023-05-18T00:00:00.000
2024-12-12 23:54:10,963 - INFO - pnl: 2023-05-12T23:59:59.999 95055.28458568147 === -0.560%
2024-12-12 23:54:10,970 - DEBUG - cur time: 2023-05-13T23:59:59.999 == next bar open time: 2023-05-14T00:00:00.000 == close pos time: 2023-05-19T00:00:00.000
2024-12-12 23:54:10,970 - INFO - pnl: 2023-05-13T23:59:59.999 94619.33618912884 === -0.459%
2024-12-12 23:54:10,972 - DEBUG - cur time: 2023-05-14T23:59:59.999 == next bar open time: 2023-05-15T00:00:00.000 == close pos time: 2023-05-20T00:00:00.000
2024-12-12 23:54:10,993 - DEBUG - close time 2023-05-14T23:59:59.999 == vol_threshold: 11816903.700000001
2024-12-12 23:54:10,993 - DEBUG - 2023-05-14T23:59:59.999 == all trade symbol 153 == remain 107 after VOL filter
2024-12-12 23:54:10,997 - DEBUG - sorted_long_factors: shape: (107, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ KLAYUSDT   ┆ -6.97445     ┆ 0    ┆ 106          │
│ C98USDT    ┆ -4.10025     ┆ 1    ┆ 105          │
│ MTLUSDT    ┆ -4.087908    ┆ 2    ┆ 104          │
│ ALPHAUSDT  ┆ -3.571273    ┆ 3    ┆ 103          │
│ XLMUSDT    ┆ -3.453685    ┆ 4    ┆ 102          │
│ PEOPLEUSDT ┆ -3.45175     ┆ 5    ┆ 101          │
│ CTSIUSDT   ┆ -3.364375    ┆ 6    ┆ 100          │
│ BLZUSDT    ┆ -3.019129    ┆ 7    ┆ 99           │
│ IMXUSDT    ┆ -2.872988    ┆ 8    ┆ 98           │
│ FETUSDT    ┆ -2.757181    ┆ 9    ┆ 97           │
│ …          ┆ …            ┆ …    ┆ …            │
│ LDOUSDT    ┆ 2.707574     ┆ 97   ┆ 9            │
│ OMGUSDT    ┆ 2.833465     ┆ 98   ┆ 8            │
│ IOSTUSDT   ┆ 2.944836     ┆ 99   ┆ 7            │
│ DENTUSDT   ┆ 3.11787      ┆ 100  ┆ 6            │
│ BATUSDT    ┆ 3.181832     ┆ 101  ┆ 5            │
│ ARPAUSDT   ┆ 3.38774      ┆ 102  ┆ 4            │
│ FLOWUSDT   ┆ 4.159875     ┆ 103  ┆ 3            │
│ RVNUSDT    ┆ 4.215061     ┆ 104  ┆ 2            │
│ KAVAUSDT   ┆ 4.657053     ┆ 105  ┆ 1            │
│ IOTXUSDT   ┆ 5.408123     ┆ 106  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,011 - INFO - cur close time: 2023-05-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:11,011 - DEBUG - mean expected ret (mean factor): 0.11110809596083844
2024-12-12 23:54:11,022 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,024 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,024 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0902      ┆ null        ┆ … ┆ 0.02381 ┆ null   ┆ null    ┆ 0.2218  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,030 - DEBUG - update position: 2023-05-14T23:59:59.999 === diff_trading_value: 322412.5410113984 == cash: 95663.11001181163 
2024-12-12 23:54:11,034 - INFO - pnl: 2023-05-14T23:59:59.999 95663.11001181163 === 1.103%
2024-12-12 23:54:11,034 - DEBUG - cur time: 2023-05-15T23:59:59.999 == next bar open time: 2023-05-16T00:00:00.000 == close pos time: 2023-05-21T00:00:00.000
2024-12-12 23:54:11,038 - INFO - pnl: 2023-05-15T23:59:59.999 95979.2025562003 === 0.330%
2024-12-12 23:54:11,039 - DEBUG - cur time: 2023-05-16T23:59:59.999 == next bar open time: 2023-05-17T00:00:00.000 == close pos time: 2023-05-22T00:00:00.000
2024-12-12 23:54:11,042 - INFO - pnl: 2023-05-16T23:59:59.999 95902.24063162213 === -0.080%
2024-12-12 23:54:11,042 - DEBUG - cur time: 2023-05-17T23:59:59.999 == next bar open time: 2023-05-18T00:00:00.000 == close pos time: 2023-05-23T00:00:00.000
2024-12-12 23:54:11,046 - INFO - pnl: 2023-05-17T23:59:59.999 92904.14717514723 === -3.126%
2024-12-12 23:54:11,050 - DEBUG - cur time: 2023-05-18T23:59:59.999 == next bar open time: 2023-05-19T00:00:00.000 == close pos time: 2023-05-24T00:00:00.000
2024-12-12 23:54:11,050 - INFO - pnl: 2023-05-18T23:59:59.999 93147.43914261884 === 0.262%
2024-12-12 23:54:11,056 - DEBUG - cur time: 2023-05-19T23:59:59.999 == next bar open time: 2023-05-20T00:00:00.000 == close pos time: 2023-05-25T00:00:00.000
2024-12-12 23:54:11,063 - DEBUG - close time 2023-05-19T23:59:59.999 == vol_threshold: 15353150.959999999
2024-12-12 23:54:11,063 - DEBUG - 2023-05-19T23:59:59.999 == all trade symbol 155 == remain 108 after VOL filter
2024-12-12 23:54:11,067 - DEBUG - sorted_long_factors: shape: (108, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ADAUSDT      ┆ -3.312335    ┆ 0    ┆ 107          │
│ ONEUSDT      ┆ -2.779454    ┆ 1    ┆ 106          │
│ TUSDT        ┆ -2.669268    ┆ 2    ┆ 105          │
│ OPUSDT       ┆ -2.389266    ┆ 3    ┆ 104          │
│ IMXUSDT      ┆ -2.373384    ┆ 4    ┆ 103          │
│ RUNEUSDT     ┆ -2.358746    ┆ 5    ┆ 102          │
│ 1000XECUSDT  ┆ -2.224825    ┆ 6    ┆ 101          │
│ ZRXUSDT      ┆ -2.185947    ┆ 7    ┆ 100          │
│ 1000SHIBUSDT ┆ -2.172629    ┆ 8    ┆ 99           │
│ BLZUSDT      ┆ -2.00639     ┆ 9    ┆ 98           │
│ …            ┆ …            ┆ …    ┆ …            │
│ KLAYUSDT     ┆ 2.255496     ┆ 98   ┆ 9            │
│ BNXUSDT      ┆ 2.343541     ┆ 99   ┆ 8            │
│ RNDRUSDT     ┆ 2.383846     ┆ 100  ┆ 7            │
│ THETAUSDT    ┆ 2.569567     ┆ 101  ┆ 6            │
│ SUSHIUSDT    ┆ 2.832438     ┆ 102  ┆ 5            │
│ ROSEUSDT     ┆ 3.077719     ┆ 103  ┆ 4            │
│ CHRUSDT      ┆ 3.112234     ┆ 104  ┆ 3            │
│ TOMOUSDT     ┆ 4.358302     ┆ 105  ┆ 2            │
│ KAVAUSDT     ┆ 5.737789     ┆ 106  ┆ 1            │
│ IOTAUSDT     ┆ 9.098896     ┆ 107  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,071 - WARNING - 2023-05-19T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:11,071 - INFO - cur close time: 2023-05-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:11,071 - DEBUG - mean expected ret (mean factor): 0.19826469802836452
2024-12-12 23:54:11,076 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,076 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬─────────┬──────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT  │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---      │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64      │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆         ┆          │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪═════════╪══════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ -10000.0 │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴─────────┴──────────┘
2024-12-12 23:54:11,076 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09        ┆ null        ┆ … ┆ 0.02425 ┆ null   ┆ null    ┆ 0.2287  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,084 - DEBUG - update position: 2023-05-19T23:59:59.999 === diff_trading_value: 327326.53050365346 == cash: 92627.05698953186 
2024-12-12 23:54:11,084 - INFO - pnl: 2023-05-19T23:59:59.999 92627.05698953186 === -0.559%
2024-12-12 23:54:11,089 - DEBUG - cur time: 2023-05-20T23:59:59.999 == next bar open time: 2023-05-21T00:00:00.000 == close pos time: 2023-05-26T00:00:00.000
2024-12-12 23:54:11,092 - INFO - pnl: 2023-05-20T23:59:59.999 92713.22483656346 === 0.093%
2024-12-12 23:54:11,092 - DEBUG - cur time: 2023-05-21T23:59:59.999 == next bar open time: 2023-05-22T00:00:00.000 == close pos time: 2023-05-27T00:00:00.000
2024-12-12 23:54:11,096 - INFO - pnl: 2023-05-21T23:59:59.999 94012.32759194466 === 1.401%
2024-12-12 23:54:11,101 - DEBUG - cur time: 2023-05-22T23:59:59.999 == next bar open time: 2023-05-23T00:00:00.000 == close pos time: 2023-05-28T00:00:00.000
2024-12-12 23:54:11,101 - INFO - pnl: 2023-05-22T23:59:59.999 94994.87718406417 === 1.045%
2024-12-12 23:54:11,105 - DEBUG - cur time: 2023-05-23T23:59:59.999 == next bar open time: 2023-05-24T00:00:00.000 == close pos time: 2023-05-29T00:00:00.000
2024-12-12 23:54:11,105 - INFO - pnl: 2023-05-23T23:59:59.999 96169.15730523244 === 1.236%
2024-12-12 23:54:11,110 - DEBUG - cur time: 2023-05-24T23:59:59.999 == next bar open time: 2023-05-25T00:00:00.000 == close pos time: 2023-05-30T00:00:00.000
2024-12-12 23:54:11,120 - DEBUG - close time 2023-05-24T23:59:59.999 == vol_threshold: 19511574.499999996
2024-12-12 23:54:11,120 - DEBUG - 2023-05-24T23:59:59.999 == all trade symbol 157 == remain 110 after VOL filter
2024-12-12 23:54:11,122 - DEBUG - sorted_long_factors: shape: (110, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DOGEUSDT     ┆ -5.709389    ┆ 0    ┆ 109          │
│ 1000SHIBUSDT ┆ -4.893139    ┆ 1    ┆ 108          │
│ 1000XECUSDT  ┆ -4.107389    ┆ 2    ┆ 107          │
│ GRTUSDT      ┆ -3.463771    ┆ 3    ┆ 106          │
│ DOTUSDT      ┆ -3.336365    ┆ 4    ┆ 105          │
│ SUSHIUSDT    ┆ -3.28095     ┆ 5    ┆ 104          │
│ ANKRUSDT     ┆ -3.167408    ┆ 6    ┆ 103          │
│ RENUSDT      ┆ -3.15799     ┆ 7    ┆ 102          │
│ NEARUSDT     ┆ -2.847536    ┆ 8    ┆ 101          │
│ SXPUSDT      ┆ -2.820697    ┆ 9    ┆ 100          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOSTUSDT     ┆ 3.221456     ┆ 100  ┆ 9            │
│ KLAYUSDT     ┆ 3.536859     ┆ 101  ┆ 8            │
│ KAVAUSDT     ┆ 3.71045      ┆ 102  ┆ 7            │
│ TRXUSDT      ┆ 4.058815     ┆ 103  ┆ 6            │
│ ADAUSDT      ┆ 4.624176     ┆ 104  ┆ 5            │
│ TOMOUSDT     ┆ 5.029728     ┆ 105  ┆ 4            │
│ WAVESUSDT    ┆ 5.378742     ┆ 106  ┆ 3            │
│ HIGHUSDT     ┆ 6.027497     ┆ 107  ┆ 2            │
│ ARPAUSDT     ┆ 6.259943     ┆ 108  ┆ 1            │
│ STGUSDT      ┆ 6.749665     ┆ 109  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,130 - WARNING - 2023-05-24T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:11,130 - INFO - cur close time: 2023-05-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:11,130 - DEBUG - mean expected ret (mean factor): 0.2689944077732248
2024-12-12 23:54:11,135 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,135 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,135 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0857      ┆ null        ┆ … ┆ 0.0228  ┆ null   ┆ null    ┆ 0.2207  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,140 - DEBUG - update position: 2023-05-24T23:59:59.999 === diff_trading_value: 297070.3702340056 == cash: 96956.2275853029 
2024-12-12 23:54:11,142 - INFO - pnl: 2023-05-24T23:59:59.999 96956.2275853029 === 0.818%
2024-12-12 23:54:11,142 - DEBUG - cur time: 2023-05-25T23:59:59.999 == next bar open time: 2023-05-26T00:00:00.000 == close pos time: 2023-05-31T00:00:00.000
2024-12-12 23:54:11,146 - INFO - pnl: 2023-05-25T23:59:59.999 96258.82244421696 === -0.719%
2024-12-12 23:54:11,150 - DEBUG - cur time: 2023-05-26T23:59:59.999 == next bar open time: 2023-05-27T00:00:00.000 == close pos time: 2023-06-01T00:00:00.000
2024-12-12 23:54:11,150 - INFO - pnl: 2023-05-26T23:59:59.999 96929.72289874872 === 0.697%
2024-12-12 23:54:11,154 - DEBUG - cur time: 2023-05-27T23:59:59.999 == next bar open time: 2023-05-28T00:00:00.000 == close pos time: 2023-06-02T00:00:00.000
2024-12-12 23:54:11,155 - INFO - pnl: 2023-05-27T23:59:59.999 95625.60712060746 === -1.345%
2024-12-12 23:54:11,158 - DEBUG - cur time: 2023-05-28T23:59:59.999 == next bar open time: 2023-05-29T00:00:00.000 == close pos time: 2023-06-03T00:00:00.000
2024-12-12 23:54:11,159 - INFO - pnl: 2023-05-28T23:59:59.999 96010.35301290093 === 0.402%
2024-12-12 23:54:11,162 - DEBUG - cur time: 2023-05-29T23:59:59.999 == next bar open time: 2023-05-30T00:00:00.000 == close pos time: 2023-06-04T00:00:00.000
2024-12-12 23:54:11,170 - DEBUG - close time 2023-05-29T23:59:59.999 == vol_threshold: 16423799.819999997
2024-12-12 23:54:11,170 - DEBUG - 2023-05-29T23:59:59.999 == all trade symbol 157 == remain 110 after VOL filter
2024-12-12 23:54:11,174 - DEBUG - sorted_long_factors: shape: (110, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ HOOKUSDT ┆ -3.231244    ┆ 0    ┆ 109          │
│ FETUSDT  ┆ -3.211697    ┆ 1    ┆ 108          │
│ OPUSDT   ┆ -3.210763    ┆ 2    ┆ 107          │
│ DUSKUSDT ┆ -2.689169    ┆ 3    ┆ 106          │
│ MINAUSDT ┆ -2.517718    ┆ 4    ┆ 105          │
│ LQTYUSDT ┆ -2.469634    ┆ 5    ┆ 104          │
│ BAKEUSDT ┆ -2.450319    ┆ 6    ┆ 103          │
│ KNCUSDT  ┆ -2.382885    ┆ 7    ┆ 102          │
│ SKLUSDT  ┆ -2.334845    ┆ 8    ┆ 101          │
│ APEUSDT  ┆ -2.320452    ┆ 9    ┆ 100          │
│ …        ┆ …            ┆ …    ┆ …            │
│ ATAUSDT  ┆ 2.445415     ┆ 100  ┆ 9            │
│ XEMUSDT  ┆ 2.472011     ┆ 101  ┆ 8            │
│ BLZUSDT  ┆ 2.655641     ┆ 102  ┆ 7            │
│ HOTUSDT  ┆ 3.019771     ┆ 103  ┆ 6            │
│ TOMOUSDT ┆ 3.125593     ┆ 104  ┆ 5            │
│ ASTRUSDT ┆ 3.28313      ┆ 105  ┆ 4            │
│ LDOUSDT  ┆ 3.497012     ┆ 106  ┆ 3            │
│ LINAUSDT ┆ 4.223739     ┆ 107  ┆ 2            │
│ TUSDT    ┆ 4.748549     ┆ 108  ┆ 1            │
│ ADAUSDT  ┆ 5.688601     ┆ 109  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,179 - WARNING - 2023-05-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:11,179 - INFO - cur close time: 2023-05-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:11,179 - DEBUG - mean expected ret (mean factor): 0.10370718938051886
2024-12-12 23:54:11,186 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,186 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,186 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0869      ┆ null        ┆ … ┆ 0.02358 ┆ null   ┆ null    ┆ 0.2256  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,192 - DEBUG - update position: 2023-05-29T23:59:59.999 === diff_trading_value: 309059.0004226145 == cash: 94535.07165580662 
2024-12-12 23:54:11,192 - INFO - pnl: 2023-05-29T23:59:59.999 94535.07165580662 === -1.537%
2024-12-12 23:54:11,196 - DEBUG - cur time: 2023-05-30T23:59:59.999 == next bar open time: 2023-05-31T00:00:00.000 == close pos time: 2023-06-05T00:00:00.000
2024-12-12 23:54:11,199 - INFO - pnl: 2023-05-30T23:59:59.999 95680.51305258079 === 1.212%
2024-12-12 23:54:11,200 - DEBUG - cur time: 2023-05-31T23:59:59.999 == next bar open time: 2023-06-01T00:00:00.000 == close pos time: 2023-06-06T00:00:00.000
2024-12-12 23:54:11,200 - INFO - pnl: 2023-05-31T23:59:59.999 97305.40506467942 === 1.698%
2024-12-12 23:54:11,204 - DEBUG - cur time: 2023-06-01T23:59:59.999 == next bar open time: 2023-06-02T00:00:00.000 == close pos time: 2023-06-07T00:00:00.000
2024-12-12 23:54:11,204 - INFO - pnl: 2023-06-01T23:59:59.999 97104.57311111272 === -0.206%
2024-12-12 23:54:11,209 - DEBUG - cur time: 2023-06-02T23:59:59.999 == next bar open time: 2023-06-03T00:00:00.000 == close pos time: 2023-06-08T00:00:00.000
2024-12-12 23:54:11,209 - INFO - pnl: 2023-06-02T23:59:59.999 96311.11719507382 === -0.817%
2024-12-12 23:54:11,212 - DEBUG - cur time: 2023-06-03T23:59:59.999 == next bar open time: 2023-06-04T00:00:00.000 == close pos time: 2023-06-09T00:00:00.000
2024-12-12 23:54:11,225 - DEBUG - close time 2023-06-03T23:59:59.999 == vol_threshold: 10223253.02
2024-12-12 23:54:11,225 - DEBUG - 2023-06-03T23:59:59.999 == all trade symbol 159 == remain 111 after VOL filter
2024-12-12 23:54:11,225 - DEBUG - sorted_long_factors: shape: (111, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ IDUSDT   ┆ -4.772719    ┆ 0    ┆ 110          │
│ HOOKUSDT ┆ -4.533494    ┆ 1    ┆ 109          │
│ REEFUSDT ┆ -3.328381    ┆ 2    ┆ 108          │
│ IMXUSDT  ┆ -3.28203     ┆ 3    ┆ 107          │
│ AGIXUSDT ┆ -3.273932    ┆ 4    ┆ 106          │
│ ATAUSDT  ┆ -3.22299     ┆ 5    ┆ 105          │
│ CFXUSDT  ┆ -3.091362    ┆ 6    ┆ 104          │
│ ASTRUSDT ┆ -2.900221    ┆ 7    ┆ 103          │
│ C98USDT  ┆ -2.779973    ┆ 8    ┆ 102          │
│ DARUSDT  ┆ -2.598501    ┆ 9    ┆ 101          │
│ …        ┆ …            ┆ …    ┆ …            │
│ OGNUSDT  ┆ 3.016087     ┆ 101  ┆ 9            │
│ ONEUSDT  ┆ 3.080633     ┆ 102  ┆ 8            │
│ RNDRUSDT ┆ 3.143608     ┆ 103  ┆ 7            │
│ BATUSDT  ┆ 3.499981     ┆ 104  ┆ 6            │
│ LRCUSDT  ┆ 3.704855     ┆ 105  ┆ 5            │
│ LINAUSDT ┆ 3.831913     ┆ 106  ┆ 4            │
│ EOSUSDT  ┆ 4.035955     ┆ 107  ┆ 3            │
│ TRXUSDT  ┆ 4.850041     ┆ 108  ┆ 2            │
│ MINAUSDT ┆ 4.879786     ┆ 109  ┆ 1            │
│ NEARUSDT ┆ 6.482145     ┆ 110  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,234 - WARNING - 2023-06-03T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:11,234 - INFO - cur close time: 2023-06-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:11,234 - DEBUG - mean expected ret (mean factor): 0.2257521994221166
2024-12-12 23:54:11,242 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,242 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,242 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0844      ┆ null        ┆ … ┆ 0.02351 ┆ null   ┆ null    ┆ 0.2201  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,250 - DEBUG - update position: 2023-06-03T23:59:59.999 === diff_trading_value: 318522.27039069403 == cash: 94986.76243284722 
2024-12-12 23:54:11,255 - INFO - pnl: 2023-06-03T23:59:59.999 94986.76243284722 === -1.375%
2024-12-12 23:54:11,259 - DEBUG - cur time: 2023-06-04T23:59:59.999 == next bar open time: 2023-06-05T00:00:00.000 == close pos time: 2023-06-10T00:00:00.000
2024-12-12 23:54:11,261 - INFO - pnl: 2023-06-04T23:59:59.999 94322.67203145228 === -0.699%
2024-12-12 23:54:11,265 - DEBUG - cur time: 2023-06-05T23:59:59.999 == next bar open time: 2023-06-06T00:00:00.000 == close pos time: 2023-06-11T00:00:00.000
2024-12-12 23:54:11,265 - INFO - pnl: 2023-06-05T23:59:59.999 99616.4693289979 === 5.612%
2024-12-12 23:54:11,269 - DEBUG - cur time: 2023-06-06T23:59:59.999 == next bar open time: 2023-06-07T00:00:00.000 == close pos time: 2023-06-12T00:00:00.000
2024-12-12 23:54:11,269 - INFO - pnl: 2023-06-06T23:59:59.999 99642.3845900734 === 0.026%
2024-12-12 23:54:11,273 - DEBUG - cur time: 2023-06-07T23:59:59.999 == next bar open time: 2023-06-08T00:00:00.000 == close pos time: 2023-06-13T00:00:00.000
2024-12-12 23:54:11,276 - INFO - pnl: 2023-06-07T23:59:59.999 100858.4992989283 === 1.220%
2024-12-12 23:54:11,279 - DEBUG - cur time: 2023-06-08T23:59:59.999 == next bar open time: 2023-06-09T00:00:00.000 == close pos time: 2023-06-14T00:00:00.000
2024-12-12 23:54:11,290 - DEBUG - close time 2023-06-08T23:59:59.999 == vol_threshold: 15632759.159999998
2024-12-12 23:54:11,290 - DEBUG - 2023-06-08T23:59:59.999 == all trade symbol 160 == remain 112 after VOL filter
2024-12-12 23:54:11,290 - DEBUG - sorted_long_factors: shape: (112, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ 1000XECUSDT ┆ -5.685643    ┆ 0    ┆ 111          │
│ DUSKUSDT    ┆ -5.04328     ┆ 1    ┆ 110          │
│ PHBUSDT     ┆ -4.295483    ┆ 2    ┆ 109          │
│ GMTUSDT     ┆ -3.915652    ┆ 3    ┆ 108          │
│ XLMUSDT     ┆ -3.762158    ┆ 4    ┆ 107          │
│ NKNUSDT     ┆ -3.732814    ┆ 5    ┆ 106          │
│ SPELLUSDT   ┆ -3.705809    ┆ 6    ┆ 105          │
│ ANKRUSDT    ┆ -2.667597    ┆ 7    ┆ 104          │
│ BLZUSDT     ┆ -2.601511    ┆ 8    ┆ 103          │
│ LUNA2USDT   ┆ -2.575436    ┆ 9    ┆ 102          │
│ …           ┆ …            ┆ …    ┆ …            │
│ OGNUSDT     ┆ 3.320083     ┆ 102  ┆ 9            │
│ XEMUSDT     ┆ 3.384391     ┆ 103  ┆ 8            │
│ LINAUSDT    ┆ 3.408845     ┆ 104  ┆ 7            │
│ ALGOUSDT    ┆ 3.417304     ┆ 105  ┆ 6            │
│ JOEUSDT     ┆ 3.425562     ┆ 106  ┆ 5            │
│ EOSUSDT     ┆ 3.69317      ┆ 107  ┆ 4            │
│ RVNUSDT     ┆ 3.752447     ┆ 108  ┆ 3            │
│ ENJUSDT     ┆ 3.958309     ┆ 109  ┆ 2            │
│ CTSIUSDT    ┆ 3.996967     ┆ 110  ┆ 1            │
│ RSRUSDT     ┆ 4.634291     ┆ 111  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,300 - WARNING - 2023-06-08T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:11,300 - INFO - cur close time: 2023-06-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:11,300 - DEBUG - mean expected ret (mean factor): 0.19627059305223593
2024-12-12 23:54:11,306 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,306 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,306 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09996     ┆ null        ┆ … ┆ 0.02122 ┆ null   ┆ null    ┆ 0.2002  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,313 - DEBUG - update position: 2023-06-08T23:59:59.999 === diff_trading_value: 287143.42626558954 == cash: 100115.29219366338 
2024-12-12 23:54:11,317 - INFO - pnl: 2023-06-08T23:59:59.999 100115.29219366338 === -0.737%
2024-12-12 23:54:11,326 - DEBUG - cur time: 2023-06-09T23:59:59.999 == next bar open time: 2023-06-10T00:00:00.000 == close pos time: 2023-06-15T00:00:00.000
2024-12-12 23:54:11,329 - INFO - pnl: 2023-06-09T23:59:59.999 100557.98577469915 === 0.442%
2024-12-12 23:54:11,337 - DEBUG - cur time: 2023-06-10T23:59:59.999 == next bar open time: 2023-06-11T00:00:00.000 == close pos time: 2023-06-16T00:00:00.000
2024-12-12 23:54:11,339 - INFO - pnl: 2023-06-10T23:59:59.999 100532.2865954436 === -0.026%
2024-12-12 23:54:11,347 - DEBUG - cur time: 2023-06-11T23:59:59.999 == next bar open time: 2023-06-12T00:00:00.000 == close pos time: 2023-06-17T00:00:00.000
2024-12-12 23:54:11,349 - INFO - pnl: 2023-06-11T23:59:59.999 100359.25702327098 === -0.172%
2024-12-12 23:54:11,355 - DEBUG - cur time: 2023-06-12T23:59:59.999 == next bar open time: 2023-06-13T00:00:00.000 == close pos time: 2023-06-18T00:00:00.000
2024-12-12 23:54:11,358 - INFO - pnl: 2023-06-12T23:59:59.999 102323.04976122049 === 1.957%
2024-12-12 23:54:11,359 - DEBUG - cur time: 2023-06-13T23:59:59.999 == next bar open time: 2023-06-14T00:00:00.000 == close pos time: 2023-06-19T00:00:00.000
2024-12-12 23:54:11,371 - DEBUG - close time 2023-06-13T23:59:59.999 == vol_threshold: 28845070.98
2024-12-12 23:54:11,375 - DEBUG - 2023-06-13T23:59:59.999 == all trade symbol 163 == remain 114 after VOL filter
2024-12-12 23:54:11,375 - DEBUG - sorted_long_factors: shape: (114, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ LEVERUSDT   ┆ -5.648076    ┆ 0    ┆ 113          │
│ CHRUSDT     ┆ -4.400507    ┆ 1    ┆ 112          │
│ TRUUSDT     ┆ -4.204116    ┆ 2    ┆ 111          │
│ LITUSDT     ┆ -3.59143     ┆ 3    ┆ 110          │
│ LUNA2USDT   ┆ -3.422265    ┆ 4    ┆ 109          │
│ CKBUSDT     ┆ -3.401875    ┆ 5    ┆ 108          │
│ JOEUSDT     ┆ -3.191681    ┆ 6    ┆ 107          │
│ ARPAUSDT    ┆ -3.036992    ┆ 7    ┆ 106          │
│ IDUSDT      ┆ -3.018322    ┆ 8    ┆ 105          │
│ DYDXUSDT    ┆ -2.991459    ┆ 9    ┆ 104          │
│ …           ┆ …            ┆ …    ┆ …            │
│ GALUSDT     ┆ 3.550979     ┆ 104  ┆ 9            │
│ VETUSDT     ┆ 3.817444     ┆ 105  ┆ 8            │
│ JASMYUSDT   ┆ 3.903615     ┆ 106  ┆ 7            │
│ ZRXUSDT     ┆ 3.99641      ┆ 107  ┆ 6            │
│ TRXUSDT     ┆ 4.280977     ┆ 108  ┆ 5            │
│ IOSTUSDT    ┆ 4.383854     ┆ 109  ┆ 4            │
│ MINAUSDT    ┆ 4.624775     ┆ 110  ┆ 3            │
│ ALGOUSDT    ┆ 5.256709     ┆ 111  ┆ 2            │
│ 1000XECUSDT ┆ 5.83614      ┆ 112  ┆ 1            │
│ HBARUSDT    ┆ 6.604395     ┆ 113  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,383 - WARNING - 2023-06-13T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:11,383 - INFO - cur close time: 2023-06-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:11,383 - DEBUG - mean expected ret (mean factor): 0.048035786733700264
2024-12-12 23:54:11,390 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,390 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,390 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09459     ┆ null        ┆ … ┆ 0.0175  ┆ null   ┆ null    ┆ 0.1744  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,396 - DEBUG - update position: 2023-06-13T23:59:59.999 === diff_trading_value: 311283.5045092525 == cash: 100832.94983511434 
2024-12-12 23:54:11,396 - INFO - pnl: 2023-06-13T23:59:59.999 100832.94983511434 === -1.456%
2024-12-12 23:54:11,400 - DEBUG - cur time: 2023-06-14T23:59:59.999 == next bar open time: 2023-06-15T00:00:00.000 == close pos time: 2023-06-20T00:00:00.000
2024-12-12 23:54:11,404 - INFO - pnl: 2023-06-14T23:59:59.999 102493.83850640553 === 1.647%
2024-12-12 23:54:11,405 - DEBUG - cur time: 2023-06-15T23:59:59.999 == next bar open time: 2023-06-16T00:00:00.000 == close pos time: 2023-06-21T00:00:00.000
2024-12-12 23:54:11,410 - INFO - pnl: 2023-06-15T23:59:59.999 99664.30787208118 === -2.761%
2024-12-12 23:54:11,413 - DEBUG - cur time: 2023-06-16T23:59:59.999 == next bar open time: 2023-06-17T00:00:00.000 == close pos time: 2023-06-22T00:00:00.000
2024-12-12 23:54:11,417 - INFO - pnl: 2023-06-16T23:59:59.999 100207.74280638866 === 0.545%
2024-12-12 23:54:11,421 - DEBUG - cur time: 2023-06-17T23:59:59.999 == next bar open time: 2023-06-18T00:00:00.000 == close pos time: 2023-06-23T00:00:00.000
2024-12-12 23:54:11,425 - INFO - pnl: 2023-06-17T23:59:59.999 100233.9659879794 === 0.026%
2024-12-12 23:54:11,430 - DEBUG - cur time: 2023-06-18T23:59:59.999 == next bar open time: 2023-06-19T00:00:00.000 == close pos time: 2023-06-24T00:00:00.000
2024-12-12 23:54:11,446 - DEBUG - close time 2023-06-18T23:59:59.999 == vol_threshold: 20314515.419999994
2024-12-12 23:54:11,446 - DEBUG - 2023-06-18T23:59:59.999 == all trade symbol 165 == remain 115 after VOL filter
2024-12-12 23:54:11,449 - DEBUG - sorted_long_factors: shape: (115, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DUSKUSDT     ┆ -5.350121    ┆ 0    ┆ 114          │
│ RDNTUSDT     ┆ -4.98313     ┆ 1    ┆ 113          │
│ 1000LUNCUSDT ┆ -3.796282    ┆ 2    ┆ 112          │
│ LEVERUSDT    ┆ -3.658694    ┆ 3    ┆ 111          │
│ SKLUSDT      ┆ -3.58058     ┆ 4    ┆ 110          │
│ HOTUSDT      ┆ -3.461149    ┆ 5    ┆ 109          │
│ FETUSDT      ┆ -3.284628    ┆ 6    ┆ 108          │
│ STORJUSDT    ┆ -3.088007    ┆ 7    ┆ 107          │
│ OPUSDT       ┆ -2.918169    ┆ 8    ┆ 106          │
│ 1000XECUSDT  ┆ -2.242865    ┆ 9    ┆ 105          │
│ …            ┆ …            ┆ …    ┆ …            │
│ XLMUSDT      ┆ 2.954747     ┆ 105  ┆ 9            │
│ MTLUSDT      ┆ 3.017537     ┆ 106  ┆ 8            │
│ ONEUSDT      ┆ 3.133795     ┆ 107  ┆ 7            │
│ IOTAUSDT     ┆ 3.549958     ┆ 108  ┆ 6            │
│ ONTUSDT      ┆ 3.642581     ┆ 109  ┆ 5            │
│ THETAUSDT    ┆ 3.658648     ┆ 110  ┆ 4            │
│ SUSHIUSDT    ┆ 3.842642     ┆ 111  ┆ 3            │
│ ICXUSDT      ┆ 5.365399     ┆ 112  ┆ 2            │
│ SFPUSDT      ┆ 6.31267      ┆ 113  ┆ 1            │
│ BATUSDT      ┆ 6.534368     ┆ 114  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,462 - WARNING - 2023-06-18T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:11,462 - INFO - cur close time: 2023-06-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:11,462 - DEBUG - mean expected ret (mean factor): 0.23696576750880008
2024-12-12 23:54:11,466 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,466 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,466 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08878     ┆ null        ┆ … ┆ 0.01724 ┆ null   ┆ null    ┆ 0.1748  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,474 - DEBUG - update position: 2023-06-18T23:59:59.999 === diff_trading_value: 328821.09277851845 == cash: 100439.15915806193 
2024-12-12 23:54:11,478 - INFO - pnl: 2023-06-18T23:59:59.999 100439.15915806193 === 0.205%
2024-12-12 23:54:11,484 - DEBUG - cur time: 2023-06-19T23:59:59.999 == next bar open time: 2023-06-20T00:00:00.000 == close pos time: 2023-06-25T00:00:00.000
2024-12-12 23:54:11,488 - INFO - pnl: 2023-06-19T23:59:59.999 100506.4056969722 === 0.067%
2024-12-12 23:54:11,492 - DEBUG - cur time: 2023-06-20T23:59:59.999 == next bar open time: 2023-06-21T00:00:00.000 == close pos time: 2023-06-26T00:00:00.000
2024-12-12 23:54:11,497 - INFO - pnl: 2023-06-20T23:59:59.999 98986.90273034683 === -1.512%
2024-12-12 23:54:11,501 - DEBUG - cur time: 2023-06-21T23:59:59.999 == next bar open time: 2023-06-22T00:00:00.000 == close pos time: 2023-06-27T00:00:00.000
2024-12-12 23:54:11,505 - INFO - pnl: 2023-06-21T23:59:59.999 97722.30369485384 === -1.278%
2024-12-12 23:54:11,510 - DEBUG - cur time: 2023-06-22T23:59:59.999 == next bar open time: 2023-06-23T00:00:00.000 == close pos time: 2023-06-28T00:00:00.000
2024-12-12 23:54:11,513 - INFO - pnl: 2023-06-22T23:59:59.999 98485.75086809279 === 0.781%
2024-12-12 23:54:11,519 - DEBUG - cur time: 2023-06-23T23:59:59.999 == next bar open time: 2023-06-24T00:00:00.000 == close pos time: 2023-06-29T00:00:00.000
2024-12-12 23:54:11,529 - DEBUG - close time 2023-06-23T23:59:59.999 == vol_threshold: 26406106.55
2024-12-12 23:54:11,533 - DEBUG - 2023-06-23T23:59:59.999 == all trade symbol 166 == remain 116 after VOL filter
2024-12-12 23:54:11,533 - DEBUG - sorted_long_factors: shape: (116, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BAKEUSDT     ┆ -3.945276    ┆ 0    ┆ 115          │
│ XRPUSDT      ┆ -3.884235    ┆ 1    ┆ 114          │
│ 1000LUNCUSDT ┆ -3.723684    ┆ 2    ┆ 113          │
│ STGUSDT      ┆ -3.612853    ┆ 3    ┆ 112          │
│ 1000SHIBUSDT ┆ -3.148612    ┆ 4    ┆ 111          │
│ DUSKUSDT     ┆ -3.017714    ┆ 5    ┆ 110          │
│ MASKUSDT     ┆ -2.675234    ┆ 6    ┆ 109          │
│ BELUSDT      ┆ -2.551205    ┆ 7    ┆ 108          │
│ XLMUSDT      ┆ -2.449184    ┆ 8    ┆ 107          │
│ LEVERUSDT    ┆ -2.424888    ┆ 9    ┆ 106          │
│ …            ┆ …            ┆ …    ┆ …            │
│ OGNUSDT      ┆ 2.313017     ┆ 106  ┆ 9            │
│ ATAUSDT      ┆ 2.316681     ┆ 107  ┆ 8            │
│ CTSIUSDT     ┆ 2.433539     ┆ 108  ┆ 7            │
│ JASMYUSDT    ┆ 2.450271     ┆ 109  ┆ 6            │
│ IOTAUSDT     ┆ 3.036572     ┆ 110  ┆ 5            │
│ XTZUSDT      ┆ 3.047322     ┆ 111  ┆ 4            │
│ XEMUSDT      ┆ 3.225478     ┆ 112  ┆ 3            │
│ ALGOUSDT     ┆ 3.265885     ┆ 113  ┆ 2            │
│ SUSHIUSDT    ┆ 3.799187     ┆ 114  ┆ 1            │
│ BATUSDT      ┆ 4.039653     ┆ 115  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,546 - WARNING - 2023-06-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:11,546 - INFO - cur close time: 2023-06-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:11,546 - DEBUG - mean expected ret (mean factor): -0.05578198225486337
2024-12-12 23:54:11,550 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,550 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,554 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09233     ┆ null        ┆ … ┆ 0.02051 ┆ null   ┆ null    ┆ 0.2017  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,562 - DEBUG - update position: 2023-06-23T23:59:59.999 === diff_trading_value: 281760.913136353 == cash: 97943.26222281349 
2024-12-12 23:54:11,563 - INFO - pnl: 2023-06-23T23:59:59.999 97943.26222281349 === -0.551%
2024-12-12 23:54:11,570 - DEBUG - cur time: 2023-06-24T23:59:59.999 == next bar open time: 2023-06-25T00:00:00.000 == close pos time: 2023-06-30T00:00:00.000
2024-12-12 23:54:11,570 - INFO - pnl: 2023-06-24T23:59:59.999 98872.06298745866 === 0.948%
2024-12-12 23:54:11,574 - DEBUG - cur time: 2023-06-25T23:59:59.999 == next bar open time: 2023-06-26T00:00:00.000 == close pos time: 2023-07-01T00:00:00.000
2024-12-12 23:54:11,578 - INFO - pnl: 2023-06-25T23:59:59.999 98712.84715165196 === -0.161%
2024-12-12 23:54:11,582 - DEBUG - cur time: 2023-06-26T23:59:59.999 == next bar open time: 2023-06-27T00:00:00.000 == close pos time: 2023-07-02T00:00:00.000
2024-12-12 23:54:11,586 - INFO - pnl: 2023-06-26T23:59:59.999 97802.42268583321 === -0.922%
2024-12-12 23:54:11,593 - DEBUG - cur time: 2023-06-27T23:59:59.999 == next bar open time: 2023-06-28T00:00:00.000 == close pos time: 2023-07-03T00:00:00.000
2024-12-12 23:54:11,593 - INFO - pnl: 2023-06-27T23:59:59.999 98465.83888397118 === 0.678%
2024-12-12 23:54:11,601 - DEBUG - cur time: 2023-06-28T23:59:59.999 == next bar open time: 2023-06-29T00:00:00.000 == close pos time: 2023-07-04T00:00:00.000
2024-12-12 23:54:11,614 - DEBUG - close time 2023-06-28T23:59:59.999 == vol_threshold: 28786255.25
2024-12-12 23:54:11,614 - DEBUG - 2023-06-28T23:59:59.999 == all trade symbol 166 == remain 116 after VOL filter
2024-12-12 23:54:11,618 - DEBUG - sorted_long_factors: shape: (116, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MINAUSDT     ┆ -5.967983    ┆ 0    ┆ 115          │
│ 1000LUNCUSDT ┆ -5.691693    ┆ 1    ┆ 114          │
│ XRPUSDT      ┆ -5.223564    ┆ 2    ┆ 113          │
│ STGUSDT      ┆ -3.825169    ┆ 3    ┆ 112          │
│ DOGEUSDT     ┆ -3.821273    ┆ 4    ┆ 111          │
│ RDNTUSDT     ┆ -3.107899    ┆ 5    ┆ 110          │
│ ARBUSDT      ┆ -2.866914    ┆ 6    ┆ 109          │
│ JOEUSDT      ┆ -2.837232    ┆ 7    ┆ 108          │
│ IOSTUSDT     ┆ -2.639527    ┆ 8    ┆ 107          │
│ IDUSDT       ┆ -2.596203    ┆ 9    ┆ 106          │
│ …            ┆ …            ┆ …    ┆ …            │
│ 1INCHUSDT    ┆ 2.684887     ┆ 106  ┆ 9            │
│ INJUSDT      ┆ 2.767389     ┆ 107  ┆ 8            │
│ REEFUSDT     ┆ 2.787207     ┆ 108  ┆ 7            │
│ DGBUSDT      ┆ 2.939909     ┆ 109  ┆ 6            │
│ SFPUSDT      ┆ 3.166361     ┆ 110  ┆ 5            │
│ STORJUSDT    ┆ 3.817609     ┆ 111  ┆ 4            │
│ ALGOUSDT     ┆ 3.996708     ┆ 112  ┆ 3            │
│ CKBUSDT      ┆ 4.206922     ┆ 113  ┆ 2            │
│ CELOUSDT     ┆ 4.408207     ┆ 114  ┆ 1            │
│ XLMUSDT      ┆ 4.870699     ┆ 115  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,622 - WARNING - 2023-06-28T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:11,622 - INFO - cur close time: 2023-06-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:11,626 - DEBUG - mean expected ret (mean factor): 0.006922092321559894
2024-12-12 23:54:11,629 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,629 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,629 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08463     ┆ null        ┆ … ┆ 0.01909 ┆ null   ┆ null    ┆ 0.1967  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,639 - DEBUG - update position: 2023-06-28T23:59:59.999 === diff_trading_value: 276590.1478554529 == cash: 98158.6924954604 
2024-12-12 23:54:11,643 - INFO - pnl: 2023-06-28T23:59:59.999 98158.6924954604 === -0.312%
2024-12-12 23:54:11,650 - DEBUG - cur time: 2023-06-29T23:59:59.999 == next bar open time: 2023-06-30T00:00:00.000 == close pos time: 2023-07-05T00:00:00.000
2024-12-12 23:54:11,651 - INFO - pnl: 2023-06-29T23:59:59.999 98041.54899399099 === -0.119%
2024-12-12 23:54:11,655 - DEBUG - cur time: 2023-06-30T23:59:59.999 == next bar open time: 2023-07-01T00:00:00.000 == close pos time: 2023-07-06T00:00:00.000
2024-12-12 23:54:11,659 - INFO - pnl: 2023-06-30T23:59:59.999 103685.97516574751 === 5.757%
2024-12-12 23:54:11,660 - DEBUG - cur time: 2023-07-01T23:59:59.999 == next bar open time: 2023-07-02T00:00:00.000 == close pos time: 2023-07-07T00:00:00.000
2024-12-12 23:54:11,664 - INFO - pnl: 2023-07-01T23:59:59.999 105148.28643420283 === 1.410%
2024-12-12 23:54:11,669 - DEBUG - cur time: 2023-07-02T23:59:59.999 == next bar open time: 2023-07-03T00:00:00.000 == close pos time: 2023-07-08T00:00:00.000
2024-12-12 23:54:11,673 - INFO - pnl: 2023-07-02T23:59:59.999 104712.26261282593 === -0.415%
2024-12-12 23:54:11,678 - DEBUG - cur time: 2023-07-03T23:59:59.999 == next bar open time: 2023-07-04T00:00:00.000 == close pos time: 2023-07-09T00:00:00.000
2024-12-12 23:54:11,690 - DEBUG - close time 2023-07-03T23:59:59.999 == vol_threshold: 26981718.2
2024-12-12 23:54:11,690 - DEBUG - 2023-07-03T23:59:59.999 == all trade symbol 166 == remain 116 after VOL filter
2024-12-12 23:54:11,693 - DEBUG - sorted_long_factors: shape: (116, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -5.888105    ┆ 0    ┆ 115          │
│ PHBUSDT      ┆ -5.677833    ┆ 1    ┆ 114          │
│ XRPUSDT      ┆ -3.847207    ┆ 2    ┆ 113          │
│ RDNTUSDT     ┆ -3.107762    ┆ 3    ┆ 112          │
│ TOMOUSDT     ┆ -3.043667    ┆ 4    ┆ 111          │
│ SNXUSDT      ┆ -2.924091    ┆ 5    ┆ 110          │
│ SUSHIUSDT    ┆ -2.815701    ┆ 6    ┆ 109          │
│ APEUSDT      ┆ -2.747643    ┆ 7    ┆ 108          │
│ CKBUSDT      ┆ -2.679871    ┆ 8    ┆ 107          │
│ VETUSDT      ┆ -2.618303    ┆ 9    ┆ 106          │
│ …            ┆ …            ┆ …    ┆ …            │
│ LITUSDT      ┆ 3.095543     ┆ 106  ┆ 9            │
│ CELOUSDT     ┆ 3.125537     ┆ 107  ┆ 8            │
│ CELRUSDT     ┆ 3.145571     ┆ 108  ┆ 7            │
│ ALGOUSDT     ┆ 3.206555     ┆ 109  ┆ 6            │
│ TRXUSDT      ┆ 3.617946     ┆ 110  ┆ 5            │
│ BATUSDT      ┆ 3.641373     ┆ 111  ┆ 4            │
│ IOTXUSDT     ┆ 3.702517     ┆ 112  ┆ 3            │
│ SKLUSDT      ┆ 4.164793     ┆ 113  ┆ 2            │
│ ZRXUSDT      ┆ 5.261194     ┆ 114  ┆ 1            │
│ SFPUSDT      ┆ 5.409961     ┆ 115  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,702 - WARNING - 2023-07-03T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:11,702 - INFO - cur close time: 2023-07-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:11,702 - DEBUG - mean expected ret (mean factor): 0.09882020555054392
2024-12-12 23:54:11,708 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,708 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,708 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08793     ┆ null        ┆ … ┆ 0.02214 ┆ null   ┆ null    ┆ 0.2183  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,713 - DEBUG - update position: 2023-07-03T23:59:59.999 === diff_trading_value: 304575.02885911975 == cash: 105124.26538543166 
2024-12-12 23:54:11,713 - INFO - pnl: 2023-07-03T23:59:59.999 105124.26538543166 === 0.393%
2024-12-12 23:54:11,719 - DEBUG - cur time: 2023-07-04T23:59:59.999 == next bar open time: 2023-07-05T00:00:00.000 == close pos time: 2023-07-10T00:00:00.000
2024-12-12 23:54:11,719 - INFO - pnl: 2023-07-04T23:59:59.999 107822.9501018858 === 2.567%
2024-12-12 23:54:11,726 - DEBUG - cur time: 2023-07-05T23:59:59.999 == next bar open time: 2023-07-06T00:00:00.000 == close pos time: 2023-07-11T00:00:00.000
2024-12-12 23:54:11,726 - INFO - pnl: 2023-07-05T23:59:59.999 107164.5537261787 === -0.611%
2024-12-12 23:54:11,729 - DEBUG - cur time: 2023-07-06T23:59:59.999 == next bar open time: 2023-07-07T00:00:00.000 == close pos time: 2023-07-12T00:00:00.000
2024-12-12 23:54:11,734 - INFO - pnl: 2023-07-06T23:59:59.999 105806.05244273854 === -1.268%
2024-12-12 23:54:11,740 - DEBUG - cur time: 2023-07-07T23:59:59.999 == next bar open time: 2023-07-08T00:00:00.000 == close pos time: 2023-07-13T00:00:00.000
2024-12-12 23:54:11,742 - INFO - pnl: 2023-07-07T23:59:59.999 104852.5698683589 === -0.901%
2024-12-12 23:54:11,746 - DEBUG - cur time: 2023-07-08T23:59:59.999 == next bar open time: 2023-07-09T00:00:00.000 == close pos time: 2023-07-14T00:00:00.000
2024-12-12 23:54:11,760 - DEBUG - close time 2023-07-08T23:59:59.999 == vol_threshold: 12765623.36
2024-12-12 23:54:11,760 - DEBUG - 2023-07-08T23:59:59.999 == all trade symbol 167 == remain 117 after VOL filter
2024-12-12 23:54:11,763 - DEBUG - sorted_long_factors: shape: (117, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ KLAYUSDT     ┆ -5.363874    ┆ 0    ┆ 116          │
│ SANDUSDT     ┆ -4.489768    ┆ 1    ┆ 115          │
│ ENJUSDT      ┆ -3.855297    ┆ 2    ┆ 114          │
│ FILUSDT      ┆ -3.500927    ┆ 3    ┆ 113          │
│ LEVERUSDT    ┆ -3.397813    ┆ 4    ┆ 112          │
│ CHRUSDT      ┆ -3.388853    ┆ 5    ┆ 111          │
│ APTUSDT      ┆ -3.244391    ┆ 6    ┆ 110          │
│ BLZUSDT      ┆ -2.935437    ┆ 7    ┆ 109          │
│ C98USDT      ┆ -2.879022    ┆ 8    ┆ 108          │
│ HBARUSDT     ┆ -2.786473    ┆ 9    ┆ 107          │
│ …            ┆ …            ┆ …    ┆ …            │
│ WAVESUSDT    ┆ 2.486936     ┆ 107  ┆ 9            │
│ MATICUSDT    ┆ 3.019078     ┆ 108  ┆ 8            │
│ TUSDT        ┆ 3.359309     ┆ 109  ┆ 7            │
│ XTZUSDT      ┆ 3.416837     ┆ 110  ┆ 6            │
│ BATUSDT      ┆ 3.45149      ┆ 111  ┆ 5            │
│ OGNUSDT      ┆ 3.893123     ┆ 112  ┆ 4            │
│ CKBUSDT      ┆ 4.132016     ┆ 113  ┆ 3            │
│ 1000LUNCUSDT ┆ 4.144728     ┆ 114  ┆ 2            │
│ OCEANUSDT    ┆ 4.493895     ┆ 115  ┆ 1            │
│ TRXUSDT      ┆ 5.280516     ┆ 116  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,771 - WARNING - 2023-07-08T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:11,771 - INFO - cur close time: 2023-07-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:11,771 - DEBUG - mean expected ret (mean factor): 0.12946462756543042
2024-12-12 23:54:11,775 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,775 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,775 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08335     ┆ null        ┆ … ┆ 0.02052 ┆ null   ┆ null    ┆ 0.2031  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,784 - DEBUG - update position: 2023-07-08T23:59:59.999 === diff_trading_value: 345568.8358612498 == cash: 103584.67999995005 
2024-12-12 23:54:11,784 - INFO - pnl: 2023-07-08T23:59:59.999 103584.67999995005 === -1.209%
2024-12-12 23:54:11,789 - DEBUG - cur time: 2023-07-09T23:59:59.999 == next bar open time: 2023-07-10T00:00:00.000 == close pos time: 2023-07-15T00:00:00.000
2024-12-12 23:54:11,789 - INFO - pnl: 2023-07-09T23:59:59.999 103231.45136662532 === -0.341%
2024-12-12 23:54:11,792 - DEBUG - cur time: 2023-07-10T23:59:59.999 == next bar open time: 2023-07-11T00:00:00.000 == close pos time: 2023-07-16T00:00:00.000
2024-12-12 23:54:11,792 - INFO - pnl: 2023-07-10T23:59:59.999 105130.20617074516 === 1.839%
2024-12-12 23:54:11,800 - DEBUG - cur time: 2023-07-11T23:59:59.999 == next bar open time: 2023-07-12T00:00:00.000 == close pos time: 2023-07-17T00:00:00.000
2024-12-12 23:54:11,800 - INFO - pnl: 2023-07-11T23:59:59.999 104723.04409129414 === -0.387%
2024-12-12 23:54:11,805 - DEBUG - cur time: 2023-07-12T23:59:59.999 == next bar open time: 2023-07-13T00:00:00.000 == close pos time: 2023-07-18T00:00:00.000
2024-12-12 23:54:11,805 - INFO - pnl: 2023-07-12T23:59:59.999 105375.12379632756 === 0.623%
2024-12-12 23:54:11,810 - DEBUG - cur time: 2023-07-13T23:59:59.999 == next bar open time: 2023-07-14T00:00:00.000 == close pos time: 2023-07-19T00:00:00.000
2024-12-12 23:54:11,825 - DEBUG - close time 2023-07-13T23:59:59.999 == vol_threshold: 32148331.49999999
2024-12-12 23:54:11,825 - DEBUG - 2023-07-13T23:59:59.999 == all trade symbol 170 == remain 119 after VOL filter
2024-12-12 23:54:11,829 - DEBUG - sorted_long_factors: shape: (119, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ IDEXUSDT     ┆ -5.481279    ┆ 0    ┆ 118          │
│ LUNA2USDT    ┆ -5.375516    ┆ 1    ┆ 117          │
│ ASTRUSDT     ┆ -3.896254    ┆ 2    ┆ 116          │
│ RVNUSDT      ┆ -3.289696    ┆ 3    ┆ 115          │
│ CKBUSDT      ┆ -3.125961    ┆ 4    ┆ 114          │
│ 1000LUNCUSDT ┆ -3.025696    ┆ 5    ┆ 113          │
│ ZILUSDT      ┆ -2.741865    ┆ 6    ┆ 112          │
│ LRCUSDT      ┆ -2.732492    ┆ 7    ┆ 111          │
│ IOTXUSDT     ┆ -2.458998    ┆ 8    ┆ 110          │
│ KAVAUSDT     ┆ -2.257697    ┆ 9    ┆ 109          │
│ …            ┆ …            ┆ …    ┆ …            │
│ EOSUSDT      ┆ 2.541794     ┆ 109  ┆ 9            │
│ DOGEUSDT     ┆ 2.692607     ┆ 110  ┆ 8            │
│ PHBUSDT      ┆ 3.055931     ┆ 111  ┆ 7            │
│ CRVUSDT      ┆ 3.092864     ┆ 112  ┆ 6            │
│ NEARUSDT     ┆ 3.192005     ┆ 113  ┆ 5            │
│ THETAUSDT    ┆ 3.22242      ┆ 114  ┆ 4            │
│ SFPUSDT      ┆ 3.37052      ┆ 115  ┆ 3            │
│ BNXUSDT      ┆ 3.388007     ┆ 116  ┆ 2            │
│ TRXUSDT      ┆ 4.409447     ┆ 117  ┆ 1            │
│ LQTYUSDT     ┆ 5.074619     ┆ 118  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,834 - WARNING - 2023-07-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:11,834 - INFO - cur close time: 2023-07-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:11,834 - DEBUG - mean expected ret (mean factor): 0.0798641121311854
2024-12-12 23:54:11,842 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,842 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,842 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08672     ┆ null        ┆ … ┆ 0.02219 ┆ null   ┆ null    ┆ 0.2257  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,846 - DEBUG - update position: 2023-07-13T23:59:59.999 === diff_trading_value: 374711.7203546394 == cash: 102064.01985762977 
2024-12-12 23:54:11,850 - INFO - pnl: 2023-07-13T23:59:59.999 102064.01985762977 === -3.142%
2024-12-12 23:54:11,854 - DEBUG - cur time: 2023-07-14T23:59:59.999 == next bar open time: 2023-07-15T00:00:00.000 == close pos time: 2023-07-20T00:00:00.000
2024-12-12 23:54:11,854 - INFO - pnl: 2023-07-14T23:59:59.999 100117.00889371466 === -1.908%
2024-12-12 23:54:11,858 - DEBUG - cur time: 2023-07-15T23:59:59.999 == next bar open time: 2023-07-16T00:00:00.000 == close pos time: 2023-07-21T00:00:00.000
2024-12-12 23:54:11,860 - INFO - pnl: 2023-07-15T23:59:59.999 97835.49034015102 === -2.279%
2024-12-12 23:54:11,865 - DEBUG - cur time: 2023-07-16T23:59:59.999 == next bar open time: 2023-07-17T00:00:00.000 == close pos time: 2023-07-22T00:00:00.000
2024-12-12 23:54:11,867 - INFO - pnl: 2023-07-16T23:59:59.999 98186.04797935065 === 0.358%
2024-12-12 23:54:11,871 - DEBUG - cur time: 2023-07-17T23:59:59.999 == next bar open time: 2023-07-18T00:00:00.000 == close pos time: 2023-07-23T00:00:00.000
2024-12-12 23:54:11,871 - INFO - pnl: 2023-07-17T23:59:59.999 97807.72043627987 === -0.385%
2024-12-12 23:54:11,875 - DEBUG - cur time: 2023-07-18T23:59:59.999 == next bar open time: 2023-07-19T00:00:00.000 == close pos time: 2023-07-24T00:00:00.000
2024-12-12 23:54:11,884 - DEBUG - close time 2023-07-18T23:59:59.999 == vol_threshold: 20884452.849999994
2024-12-12 23:54:11,884 - DEBUG - 2023-07-18T23:59:59.999 == all trade symbol 172 == remain 120 after VOL filter
2024-12-12 23:54:11,888 - DEBUG - sorted_long_factors: shape: (120, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MTLUSDT      ┆ -4.010747    ┆ 0    ┆ 119          │
│ BLURUSDT     ┆ -3.54186     ┆ 1    ┆ 118          │
│ MAGICUSDT    ┆ -3.228469    ┆ 2    ┆ 117          │
│ 1000LUNCUSDT ┆ -2.713544    ┆ 3    ┆ 116          │
│ EDUUSDT      ┆ -2.614761    ┆ 4    ┆ 115          │
│ ARBUSDT      ┆ -2.604698    ┆ 5    ┆ 114          │
│ LUNA2USDT    ┆ -2.311612    ┆ 6    ┆ 113          │
│ DOGEUSDT     ┆ -2.152881    ┆ 7    ┆ 112          │
│ C98USDT      ┆ -2.11368     ┆ 8    ┆ 111          │
│ RNDRUSDT     ┆ -2.085554    ┆ 9    ┆ 110          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SPELLUSDT    ┆ 1.768527     ┆ 110  ┆ 9            │
│ SNXUSDT      ┆ 1.832879     ┆ 111  ┆ 8            │
│ TRXUSDT      ┆ 2.00256      ┆ 112  ┆ 7            │
│ LEVERUSDT    ┆ 2.215747     ┆ 113  ┆ 6            │
│ FLMUSDT      ┆ 2.758161     ┆ 114  ┆ 5            │
│ ASTRUSDT     ┆ 3.254394     ┆ 115  ┆ 4            │
│ IOTXUSDT     ┆ 3.330523     ┆ 116  ┆ 3            │
│ DGBUSDT      ┆ 3.436445     ┆ 117  ┆ 2            │
│ KLAYUSDT     ┆ 3.608138     ┆ 118  ┆ 1            │
│ COTIUSDT     ┆ 3.872934     ┆ 119  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,891 - WARNING - 2023-07-18T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:11,891 - INFO - cur close time: 2023-07-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:11,891 - DEBUG - mean expected ret (mean factor): -0.1291715329784583
2024-12-12 23:54:11,895 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,895 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,895 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02391     ┆ 0.08844     ┆ 0.0015149   ┆ … ┆ 0.0216  ┆ null   ┆ null    ┆ 0.2117  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,904 - DEBUG - update position: 2023-07-18T23:59:59.999 === diff_trading_value: 311691.19755137136 == cash: 98333.70257361859 
2024-12-12 23:54:11,904 - INFO - pnl: 2023-07-18T23:59:59.999 98333.70257361859 === 0.538%
2024-12-12 23:54:11,908 - DEBUG - cur time: 2023-07-19T23:59:59.999 == next bar open time: 2023-07-20T00:00:00.000 == close pos time: 2023-07-25T00:00:00.000
2024-12-12 23:54:11,910 - INFO - pnl: 2023-07-19T23:59:59.999 98289.73893528277 === -0.045%
2024-12-12 23:54:11,912 - DEBUG - cur time: 2023-07-20T23:59:59.999 == next bar open time: 2023-07-21T00:00:00.000 == close pos time: 2023-07-26T00:00:00.000
2024-12-12 23:54:11,912 - INFO - pnl: 2023-07-20T23:59:59.999 98611.7601750512 === 0.328%
2024-12-12 23:54:11,916 - DEBUG - cur time: 2023-07-21T23:59:59.999 == next bar open time: 2023-07-22T00:00:00.000 == close pos time: 2023-07-27T00:00:00.000
2024-12-12 23:54:11,916 - INFO - pnl: 2023-07-21T23:59:59.999 99729.79443343276 === 1.134%
2024-12-12 23:54:11,921 - DEBUG - cur time: 2023-07-22T23:59:59.999 == next bar open time: 2023-07-23T00:00:00.000 == close pos time: 2023-07-28T00:00:00.000
2024-12-12 23:54:11,921 - INFO - pnl: 2023-07-22T23:59:59.999 102389.64120819606 === 2.667%
2024-12-12 23:54:11,927 - DEBUG - cur time: 2023-07-23T23:59:59.999 == next bar open time: 2023-07-24T00:00:00.000 == close pos time: 2023-07-29T00:00:00.000
2024-12-12 23:54:11,940 - DEBUG - close time 2023-07-23T23:59:59.999 == vol_threshold: 14055141.83
2024-12-12 23:54:11,940 - DEBUG - 2023-07-23T23:59:59.999 == all trade symbol 174 == remain 122 after VOL filter
2024-12-12 23:54:11,944 - DEBUG - sorted_long_factors: shape: (122, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ RVNUSDT       ┆ -5.45195     ┆ 0    ┆ 121          │
│ IOTXUSDT      ┆ -4.260077    ┆ 1    ┆ 120          │
│ EDUUSDT       ┆ -4.094173    ┆ 2    ┆ 119          │
│ 1000LUNCUSDT  ┆ -4.014603    ┆ 3    ┆ 118          │
│ CKBUSDT       ┆ -3.785216    ┆ 4    ┆ 117          │
│ XRPUSDT       ┆ -3.327384    ┆ 5    ┆ 116          │
│ 1000FLOKIUSDT ┆ -2.99274     ┆ 6    ┆ 115          │
│ KNCUSDT       ┆ -2.815623    ┆ 7    ┆ 114          │
│ LUNA2USDT     ┆ -2.796145    ┆ 8    ┆ 113          │
│ ASTRUSDT      ┆ -2.78792     ┆ 9    ┆ 112          │
│ …             ┆ …            ┆ …    ┆ …            │
│ OGNUSDT       ┆ 2.875865     ┆ 112  ┆ 9            │
│ VETUSDT       ┆ 2.963893     ┆ 113  ┆ 8            │
│ KLAYUSDT      ┆ 2.994441     ┆ 114  ┆ 7            │
│ ACHUSDT       ┆ 3.26713      ┆ 115  ┆ 6            │
│ RDNTUSDT      ┆ 3.350861     ┆ 116  ┆ 5            │
│ CTSIUSDT      ┆ 3.36184      ┆ 117  ┆ 4            │
│ JASMYUSDT     ┆ 4.437627     ┆ 118  ┆ 3            │
│ SPELLUSDT     ┆ 4.86094      ┆ 119  ┆ 2            │
│ STMXUSDT      ┆ 5.893842     ┆ 120  ┆ 1            │
│ FLMUSDT       ┆ 6.035492     ┆ 121  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:11,950 - INFO - cur close time: 2023-07-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:11,950 - DEBUG - mean expected ret (mean factor): -0.09117495536233179
2024-12-12 23:54:11,952 - DEBUG - begin to update pos: =========
2024-12-12 23:54:11,956 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,956 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02393     ┆ 0.08619     ┆ 0.0015038   ┆ … ┆ 0.0222  ┆ null   ┆ null    ┆ 0.2154  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:11,964 - DEBUG - update position: 2023-07-23T23:59:59.999 === diff_trading_value: 305625.66510338965 == cash: 101737.45986281232 
2024-12-12 23:54:11,964 - INFO - pnl: 2023-07-23T23:59:59.999 101737.45986281232 === -0.637%
2024-12-12 23:54:11,969 - DEBUG - cur time: 2023-07-24T23:59:59.999 == next bar open time: 2023-07-25T00:00:00.000 == close pos time: 2023-07-30T00:00:00.000
2024-12-12 23:54:11,971 - INFO - pnl: 2023-07-24T23:59:59.999 99603.07632719785 === -2.098%
2024-12-12 23:54:11,976 - DEBUG - cur time: 2023-07-25T23:59:59.999 == next bar open time: 2023-07-26T00:00:00.000 == close pos time: 2023-07-31T00:00:00.000
2024-12-12 23:54:11,980 - INFO - pnl: 2023-07-25T23:59:59.999 97808.34653294683 === -1.802%
2024-12-12 23:54:11,980 - DEBUG - cur time: 2023-07-26T23:59:59.999 == next bar open time: 2023-07-27T00:00:00.000 == close pos time: 2023-08-01T00:00:00.000
2024-12-12 23:54:11,984 - INFO - pnl: 2023-07-26T23:59:59.999 97219.62175561077 === -0.602%
2024-12-12 23:54:11,989 - DEBUG - cur time: 2023-07-27T23:59:59.999 == next bar open time: 2023-07-28T00:00:00.000 == close pos time: 2023-08-02T00:00:00.000
2024-12-12 23:54:11,989 - INFO - pnl: 2023-07-27T23:59:59.999 97434.7105761628 === 0.221%
2024-12-12 23:54:11,992 - DEBUG - cur time: 2023-07-28T23:59:59.999 == next bar open time: 2023-07-29T00:00:00.000 == close pos time: 2023-08-03T00:00:00.000
2024-12-12 23:54:12,010 - DEBUG - close time 2023-07-28T23:59:59.999 == vol_threshold: 13309613.559999999
2024-12-12 23:54:12,010 - DEBUG - 2023-07-28T23:59:59.999 == all trade symbol 174 == remain 122 after VOL filter
2024-12-12 23:54:12,013 - DEBUG - sorted_long_factors: shape: (122, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ IDEXUSDT  ┆ -4.44935     ┆ 0    ┆ 121          │
│ ALPHAUSDT ┆ -4.334427    ┆ 1    ┆ 120          │
│ RDNTUSDT  ┆ -4.197541    ┆ 2    ┆ 119          │
│ BLURUSDT  ┆ -4.041176    ┆ 3    ┆ 118          │
│ IOTAUSDT  ┆ -3.965595    ┆ 4    ┆ 117          │
│ EDUUSDT   ┆ -3.645706    ┆ 5    ┆ 116          │
│ XRPUSDT   ┆ -3.52278     ┆ 6    ┆ 115          │
│ DARUSDT   ┆ -3.511673    ┆ 7    ┆ 114          │
│ WOOUSDT   ┆ -3.445597    ┆ 8    ┆ 113          │
│ STORJUSDT ┆ -3.383013    ┆ 9    ┆ 112          │
│ …         ┆ …            ┆ …    ┆ …            │
│ BNXUSDT   ┆ 2.78884      ┆ 112  ┆ 9            │
│ VETUSDT   ┆ 3.064211     ┆ 113  ┆ 8            │
│ TRUUSDT   ┆ 3.091945     ┆ 114  ┆ 7            │
│ ONTUSDT   ┆ 3.128144     ┆ 115  ┆ 6            │
│ BATUSDT   ┆ 3.219848     ┆ 116  ┆ 5            │
│ JASMYUSDT ┆ 3.318417     ┆ 117  ┆ 4            │
│ KNCUSDT   ┆ 3.328264     ┆ 118  ┆ 3            │
│ SPELLUSDT ┆ 4.529777     ┆ 119  ┆ 2            │
│ TRXUSDT   ┆ 5.576212     ┆ 120  ┆ 1            │
│ ANKRUSDT  ┆ 5.810162     ┆ 121  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,020 - WARNING - 2023-07-28T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,021 - INFO - cur close time: 2023-07-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:12,021 - DEBUG - mean expected ret (mean factor): -0.08166419301076325
2024-12-12 23:54:12,026 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,026 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,026 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02235     ┆ 0.08199     ┆ 0.0013357   ┆ … ┆ 0.02099 ┆ null   ┆ null    ┆ 0.2139  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,034 - DEBUG - update position: 2023-07-28T23:59:59.999 === diff_trading_value: 319271.7177426811 == cash: 96119.52067664084 
2024-12-12 23:54:12,034 - INFO - pnl: 2023-07-28T23:59:59.999 96119.52067664084 === -1.350%
2024-12-12 23:54:12,042 - DEBUG - cur time: 2023-07-29T23:59:59.999 == next bar open time: 2023-07-30T00:00:00.000 == close pos time: 2023-08-04T00:00:00.000
2024-12-12 23:54:12,042 - INFO - pnl: 2023-07-29T23:59:59.999 95629.92705659808 === -0.509%
2024-12-12 23:54:12,046 - DEBUG - cur time: 2023-07-30T23:59:59.999 == next bar open time: 2023-07-31T00:00:00.000 == close pos time: 2023-08-05T00:00:00.000
2024-12-12 23:54:12,050 - INFO - pnl: 2023-07-30T23:59:59.999 95822.4068510928 === 0.201%
2024-12-12 23:54:12,052 - DEBUG - cur time: 2023-07-31T23:59:59.999 == next bar open time: 2023-08-01T00:00:00.000 == close pos time: 2023-08-06T00:00:00.000
2024-12-12 23:54:12,054 - INFO - pnl: 2023-07-31T23:59:59.999 96127.46505523068 === 0.318%
2024-12-12 23:54:12,059 - DEBUG - cur time: 2023-08-01T23:59:59.999 == next bar open time: 2023-08-02T00:00:00.000 == close pos time: 2023-08-07T00:00:00.000
2024-12-12 23:54:12,059 - INFO - pnl: 2023-08-01T23:59:59.999 95701.48236433949 === -0.443%
2024-12-12 23:54:12,063 - DEBUG - cur time: 2023-08-02T23:59:59.999 == next bar open time: 2023-08-03T00:00:00.000 == close pos time: 2023-08-08T00:00:00.000
2024-12-12 23:54:12,075 - DEBUG - close time 2023-08-02T23:59:59.999 == vol_threshold: 17572146.15
2024-12-12 23:54:12,075 - DEBUG - 2023-08-02T23:59:59.999 == all trade symbol 174 == remain 122 after VOL filter
2024-12-12 23:54:12,075 - DEBUG - sorted_long_factors: shape: (122, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT       ┆ -3.799396    ┆ 0    ┆ 121          │
│ BATUSDT       ┆ -3.443228    ┆ 1    ┆ 120          │
│ TRUUSDT       ┆ -3.419809    ┆ 2    ┆ 119          │
│ EDUUSDT       ┆ -2.780936    ┆ 3    ┆ 118          │
│ 1000FLOKIUSDT ┆ -2.712498    ┆ 4    ┆ 117          │
│ IDEXUSDT      ┆ -2.675934    ┆ 5    ┆ 116          │
│ ROSEUSDT      ┆ -2.531517    ┆ 6    ┆ 115          │
│ BLURUSDT      ┆ -2.403782    ┆ 7    ┆ 114          │
│ DOGEUSDT      ┆ -2.346744    ┆ 8    ┆ 113          │
│ REEFUSDT      ┆ -2.117914    ┆ 9    ┆ 112          │
│ …             ┆ …            ┆ …    ┆ …            │
│ CHRUSDT       ┆ 1.844867     ┆ 112  ┆ 9            │
│ SUSHIUSDT     ┆ 1.876264     ┆ 113  ┆ 8            │
│ KAVAUSDT      ┆ 2.028341     ┆ 114  ┆ 7            │
│ MTLUSDT       ┆ 2.050015     ┆ 115  ┆ 6            │
│ HOTUSDT       ┆ 2.20945      ┆ 116  ┆ 5            │
│ CRVUSDT       ┆ 2.443052     ┆ 117  ┆ 4            │
│ QTUMUSDT      ┆ 2.779555     ┆ 118  ┆ 3            │
│ KNCUSDT       ┆ 2.783386     ┆ 119  ┆ 2            │
│ IOSTUSDT      ┆ 3.097426     ┆ 120  ┆ 1            │
│ SPELLUSDT     ┆ 3.283038     ┆ 121  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,084 - WARNING - 2023-08-02T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,084 - INFO - cur close time: 2023-08-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:12,084 - DEBUG - mean expected ret (mean factor): -0.13221029382806881
2024-12-12 23:54:12,088 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,088 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,090 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0222      ┆ 0.08021     ┆ 0.0012184   ┆ … ┆ 0.0206  ┆ null   ┆ null    ┆ 0.2205  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,093 - DEBUG - update position: 2023-08-02T23:59:59.999 === diff_trading_value: 277824.0616407834 == cash: 95776.72036127295 
2024-12-12 23:54:12,096 - INFO - pnl: 2023-08-02T23:59:59.999 95776.72036127295 === 0.079%
2024-12-12 23:54:12,101 - DEBUG - cur time: 2023-08-03T23:59:59.999 == next bar open time: 2023-08-04T00:00:00.000 == close pos time: 2023-08-09T00:00:00.000
2024-12-12 23:54:12,101 - INFO - pnl: 2023-08-03T23:59:59.999 96022.61242890786 === 0.257%
2024-12-12 23:54:12,105 - DEBUG - cur time: 2023-08-04T23:59:59.999 == next bar open time: 2023-08-05T00:00:00.000 == close pos time: 2023-08-10T00:00:00.000
2024-12-12 23:54:12,105 - INFO - pnl: 2023-08-04T23:59:59.999 96189.15113142485 === 0.173%
2024-12-12 23:54:12,110 - DEBUG - cur time: 2023-08-05T23:59:59.999 == next bar open time: 2023-08-06T00:00:00.000 == close pos time: 2023-08-11T00:00:00.000
2024-12-12 23:54:12,110 - INFO - pnl: 2023-08-05T23:59:59.999 95807.77039774838 === -0.396%
2024-12-12 23:54:12,113 - DEBUG - cur time: 2023-08-06T23:59:59.999 == next bar open time: 2023-08-07T00:00:00.000 == close pos time: 2023-08-12T00:00:00.000
2024-12-12 23:54:12,113 - INFO - pnl: 2023-08-06T23:59:59.999 94763.75106441297 === -1.090%
2024-12-12 23:54:12,120 - DEBUG - cur time: 2023-08-07T23:59:59.999 == next bar open time: 2023-08-08T00:00:00.000 == close pos time: 2023-08-13T00:00:00.000
2024-12-12 23:54:12,130 - DEBUG - close time 2023-08-07T23:59:59.999 == vol_threshold: 23280480.599999998
2024-12-12 23:54:12,130 - DEBUG - 2023-08-07T23:59:59.999 == all trade symbol 175 == remain 122 after VOL filter
2024-12-12 23:54:12,130 - DEBUG - sorted_long_factors: shape: (122, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ IDEXUSDT     ┆ -3.680108    ┆ 0    ┆ 121          │
│ LUNA2USDT    ┆ -2.769422    ┆ 1    ┆ 120          │
│ XRPUSDT      ┆ -2.520942    ┆ 2    ┆ 119          │
│ BLURUSDT     ┆ -2.436334    ┆ 3    ┆ 118          │
│ 1000LUNCUSDT ┆ -2.189849    ┆ 4    ┆ 117          │
│ RDNTUSDT     ┆ -2.10894     ┆ 5    ┆ 116          │
│ DOGEUSDT     ┆ -2.033596    ┆ 6    ┆ 115          │
│ ARBUSDT      ┆ -1.956173    ┆ 7    ┆ 114          │
│ IDUSDT       ┆ -1.944965    ┆ 8    ┆ 113          │
│ CTSIUSDT     ┆ -1.799737    ┆ 9    ┆ 112          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SKLUSDT      ┆ 1.543898     ┆ 112  ┆ 9            │
│ CRVUSDT      ┆ 1.567403     ┆ 113  ┆ 8            │
│ SNXUSDT      ┆ 1.750894     ┆ 114  ┆ 7            │
│ 1000XECUSDT  ┆ 1.788812     ┆ 115  ┆ 6            │
│ API3USDT     ┆ 1.881107     ┆ 116  ┆ 5            │
│ STORJUSDT    ┆ 1.90077      ┆ 117  ┆ 4            │
│ ATAUSDT      ┆ 1.938728     ┆ 118  ┆ 3            │
│ TOMOUSDT     ┆ 2.197894     ┆ 119  ┆ 2            │
│ LPTUSDT      ┆ 2.918702     ┆ 120  ┆ 1            │
│ OPUSDT       ┆ 2.9646       ┆ 121  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,140 - WARNING - 2023-08-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,140 - INFO - cur close time: 2023-08-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:12,140 - DEBUG - mean expected ret (mean factor): -0.17177773952322828
2024-12-12 23:54:12,143 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,143 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,143 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02211     ┆ 0.07753     ┆ 0.001116    ┆ … ┆ 0.02001 ┆ null   ┆ null    ┆ 0.2168  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,151 - DEBUG - update position: 2023-08-07T23:59:59.999 === diff_trading_value: 262934.04508303053 == cash: 95581.08711528704 
2024-12-12 23:54:12,151 - INFO - pnl: 2023-08-07T23:59:59.999 95581.08711528704 === 0.862%
2024-12-12 23:54:12,155 - DEBUG - cur time: 2023-08-08T23:59:59.999 == next bar open time: 2023-08-09T00:00:00.000 == close pos time: 2023-08-14T00:00:00.000
2024-12-12 23:54:12,155 - INFO - pnl: 2023-08-08T23:59:59.999 91614.22045978873 === -4.150%
2024-12-12 23:54:12,160 - DEBUG - cur time: 2023-08-09T23:59:59.999 == next bar open time: 2023-08-10T00:00:00.000 == close pos time: 2023-08-15T00:00:00.000
2024-12-12 23:54:12,164 - INFO - pnl: 2023-08-09T23:59:59.999 91664.82991883384 === 0.055%
2024-12-12 23:54:12,168 - DEBUG - cur time: 2023-08-10T23:59:59.999 == next bar open time: 2023-08-11T00:00:00.000 == close pos time: 2023-08-16T00:00:00.000
2024-12-12 23:54:12,170 - INFO - pnl: 2023-08-10T23:59:59.999 91638.99425380991 === -0.028%
2024-12-12 23:54:12,176 - DEBUG - cur time: 2023-08-11T23:59:59.999 == next bar open time: 2023-08-12T00:00:00.000 == close pos time: 2023-08-17T00:00:00.000
2024-12-12 23:54:12,176 - INFO - pnl: 2023-08-11T23:59:59.999 94273.37243573135 === 2.875%
2024-12-12 23:54:12,181 - DEBUG - cur time: 2023-08-12T23:59:59.999 == next bar open time: 2023-08-13T00:00:00.000 == close pos time: 2023-08-18T00:00:00.000
2024-12-12 23:54:12,192 - DEBUG - close time 2023-08-12T23:59:59.999 == vol_threshold: 10279967.5
2024-12-12 23:54:12,192 - DEBUG - 2023-08-12T23:59:59.999 == all trade symbol 176 == remain 123 after VOL filter
2024-12-12 23:54:12,196 - DEBUG - sorted_long_factors: shape: (123, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ BNXUSDT     ┆ -3.438307    ┆ 0    ┆ 122          │
│ LQTYUSDT    ┆ -3.370779    ┆ 1    ┆ 121          │
│ ROSEUSDT    ┆ -2.712397    ┆ 2    ┆ 120          │
│ COMBOUSDT   ┆ -2.627149    ┆ 3    ┆ 119          │
│ XRPUSDT     ┆ -2.580909    ┆ 4    ┆ 118          │
│ IDEXUSDT    ┆ -2.308682    ┆ 5    ┆ 117          │
│ ARBUSDT     ┆ -2.261389    ┆ 6    ┆ 116          │
│ JOEUSDT     ┆ -2.107885    ┆ 7    ┆ 115          │
│ COTIUSDT    ┆ -2.052209    ┆ 8    ┆ 114          │
│ MAGICUSDT   ┆ -1.871559    ┆ 9    ┆ 113          │
│ …           ┆ …            ┆ …    ┆ …            │
│ RDNTUSDT    ┆ 2.010167     ┆ 113  ┆ 9            │
│ ONEUSDT     ┆ 2.538892     ┆ 114  ┆ 8            │
│ DYDXUSDT    ┆ 2.558163     ┆ 115  ┆ 7            │
│ CTSIUSDT    ┆ 2.569822     ┆ 116  ┆ 6            │
│ CKBUSDT     ┆ 2.918061     ┆ 117  ┆ 5            │
│ BLZUSDT     ┆ 3.061591     ┆ 118  ┆ 4            │
│ TRXUSDT     ┆ 3.398474     ┆ 119  ┆ 3            │
│ RUNEUSDT    ┆ 3.511837     ┆ 120  ┆ 2            │
│ LPTUSDT     ┆ 4.585884     ┆ 121  ┆ 1            │
│ 1000XECUSDT ┆ 4.732468     ┆ 122  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,201 - WARNING - 2023-08-12T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,201 - INFO - cur close time: 2023-08-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:12,201 - DEBUG - mean expected ret (mean factor): -0.019889707925398462
2024-12-12 23:54:12,205 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,205 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,205 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02326     ┆ 0.0782      ┆ 0.0013521   ┆ … ┆ 0.02008 ┆ null   ┆ null    ┆ 0.2179  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,213 - DEBUG - update position: 2023-08-12T23:59:59.999 === diff_trading_value: 302555.4340062125 == cash: 95361.94876693652 
2024-12-12 23:54:12,213 - INFO - pnl: 2023-08-12T23:59:59.999 95361.94876693652 === 1.155%
2024-12-12 23:54:12,220 - DEBUG - cur time: 2023-08-13T23:59:59.999 == next bar open time: 2023-08-14T00:00:00.000 == close pos time: 2023-08-19T00:00:00.000
2024-12-12 23:54:12,220 - INFO - pnl: 2023-08-13T23:59:59.999 98246.894716331 === 3.025%
2024-12-12 23:54:12,223 - DEBUG - cur time: 2023-08-14T23:59:59.999 == next bar open time: 2023-08-15T00:00:00.000 == close pos time: 2023-08-20T00:00:00.000
2024-12-12 23:54:12,226 - INFO - pnl: 2023-08-14T23:59:59.999 99541.75642012345 === 1.318%
2024-12-12 23:54:12,230 - DEBUG - cur time: 2023-08-15T23:59:59.999 == next bar open time: 2023-08-16T00:00:00.000 == close pos time: 2023-08-21T00:00:00.000
2024-12-12 23:54:12,230 - INFO - pnl: 2023-08-15T23:59:59.999 99513.39625490886 === -0.028%
2024-12-12 23:54:12,234 - DEBUG - cur time: 2023-08-16T23:59:59.999 == next bar open time: 2023-08-17T00:00:00.000 == close pos time: 2023-08-22T00:00:00.000
2024-12-12 23:54:12,234 - INFO - pnl: 2023-08-16T23:59:59.999 103074.74472599711 === 3.579%
2024-12-12 23:54:12,240 - DEBUG - cur time: 2023-08-17T23:59:59.999 == next bar open time: 2023-08-18T00:00:00.000 == close pos time: 2023-08-23T00:00:00.000
2024-12-12 23:54:12,251 - DEBUG - close time 2023-08-17T23:59:59.999 == vol_threshold: 46024551.75
2024-12-12 23:54:12,251 - DEBUG - 2023-08-17T23:59:59.999 == all trade symbol 176 == remain 123 after VOL filter
2024-12-12 23:54:12,251 - DEBUG - sorted_long_factors: shape: (123, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ATAUSDT   ┆ -4.624866    ┆ 0    ┆ 122          │
│ IDUSDT    ┆ -4.17314     ┆ 1    ┆ 121          │
│ ACHUSDT   ┆ -3.892379    ┆ 2    ┆ 120          │
│ IDEXUSDT  ┆ -3.454451    ┆ 3    ┆ 119          │
│ TLMUSDT   ┆ -3.344014    ┆ 4    ┆ 118          │
│ KEYUSDT   ┆ -3.187922    ┆ 5    ┆ 117          │
│ FTMUSDT   ┆ -3.049765    ┆ 6    ┆ 116          │
│ MINAUSDT  ┆ -3.045447    ┆ 7    ┆ 115          │
│ XRPUSDT   ┆ -3.045419    ┆ 8    ┆ 114          │
│ ARPAUSDT  ┆ -2.965157    ┆ 9    ┆ 113          │
│ …         ┆ …            ┆ …    ┆ …            │
│ THETAUSDT ┆ 2.668208     ┆ 113  ┆ 9            │
│ ASTRUSDT  ┆ 2.673821     ┆ 114  ┆ 8            │
│ IOTAUSDT  ┆ 3.059885     ┆ 115  ┆ 7            │
│ SFPUSDT   ┆ 3.11557      ┆ 116  ┆ 6            │
│ BLZUSDT   ┆ 3.341959     ┆ 117  ┆ 5            │
│ CELOUSDT  ┆ 3.487836     ┆ 118  ┆ 4            │
│ ICXUSDT   ┆ 3.622633     ┆ 119  ┆ 3            │
│ TOMOUSDT  ┆ 4.256319     ┆ 120  ┆ 2            │
│ LPTUSDT   ┆ 4.288982     ┆ 121  ┆ 1            │
│ RUNEUSDT  ┆ 6.384019     ┆ 122  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,260 - WARNING - 2023-08-17T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,260 - INFO - cur close time: 2023-08-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:12,260 - DEBUG - mean expected ret (mean factor): 0.11153645024301499
2024-12-12 23:54:12,263 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,263 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,263 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01807     ┆ 0.06175     ┆ 0.0010795   ┆ … ┆ 0.01627 ┆ null   ┆ null    ┆ 0.172   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,272 - DEBUG - update position: 2023-08-17T23:59:59.999 === diff_trading_value: 290797.4954908596 == cash: 104089.19397399148 
2024-12-12 23:54:12,272 - INFO - pnl: 2023-08-17T23:59:59.999 104089.19397399148 === 0.984%
2024-12-12 23:54:12,276 - DEBUG - cur time: 2023-08-18T23:59:59.999 == next bar open time: 2023-08-19T00:00:00.000 == close pos time: 2023-08-24T00:00:00.000
2024-12-12 23:54:12,280 - INFO - pnl: 2023-08-18T23:59:59.999 104947.98363674933 === 0.825%
2024-12-12 23:54:12,284 - DEBUG - cur time: 2023-08-19T23:59:59.999 == next bar open time: 2023-08-20T00:00:00.000 == close pos time: 2023-08-25T00:00:00.000
2024-12-12 23:54:12,284 - INFO - pnl: 2023-08-19T23:59:59.999 104521.54130046282 === -0.406%
2024-12-12 23:54:12,290 - DEBUG - cur time: 2023-08-20T23:59:59.999 == next bar open time: 2023-08-21T00:00:00.000 == close pos time: 2023-08-26T00:00:00.000
2024-12-12 23:54:12,290 - INFO - pnl: 2023-08-20T23:59:59.999 104047.58627378575 === -0.453%
2024-12-12 23:54:12,292 - DEBUG - cur time: 2023-08-21T23:59:59.999 == next bar open time: 2023-08-22T00:00:00.000 == close pos time: 2023-08-27T00:00:00.000
2024-12-12 23:54:12,296 - INFO - pnl: 2023-08-21T23:59:59.999 106708.0235329823 === 2.557%
2024-12-12 23:54:12,301 - DEBUG - cur time: 2023-08-22T23:59:59.999 == next bar open time: 2023-08-23T00:00:00.000 == close pos time: 2023-08-28T00:00:00.000
2024-12-12 23:54:12,313 - DEBUG - close time 2023-08-22T23:59:59.999 == vol_threshold: 22370793.35
2024-12-12 23:54:12,313 - DEBUG - 2023-08-22T23:59:59.999 == all trade symbol 176 == remain 123 after VOL filter
2024-12-12 23:54:12,313 - DEBUG - sorted_long_factors: shape: (123, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ DUSKUSDT  ┆ -4.255187    ┆ 0    ┆ 122          │
│ MINAUSDT  ┆ -3.642596    ┆ 1    ┆ 121          │
│ RDNTUSDT  ┆ -3.578056    ┆ 2    ┆ 120          │
│ KEYUSDT   ┆ -3.490461    ┆ 3    ┆ 119          │
│ AGIXUSDT  ┆ -2.841706    ┆ 4    ┆ 118          │
│ CKBUSDT   ┆ -2.720473    ┆ 5    ┆ 117          │
│ BAKEUSDT  ┆ -2.708371    ┆ 6    ┆ 116          │
│ FILUSDT   ┆ -2.64447     ┆ 7    ┆ 115          │
│ NKNUSDT   ┆ -2.308991    ┆ 8    ┆ 114          │
│ ARBUSDT   ┆ -2.281578    ┆ 9    ┆ 113          │
│ …         ┆ …            ┆ …    ┆ …            │
│ IOTXUSDT  ┆ 2.716545     ┆ 113  ┆ 9            │
│ SXPUSDT   ┆ 3.109721     ┆ 114  ┆ 8            │
│ RUNEUSDT  ┆ 3.14499      ┆ 115  ┆ 7            │
│ GMTUSDT   ┆ 3.222659     ┆ 116  ┆ 6            │
│ TOMOUSDT  ┆ 3.311972     ┆ 117  ┆ 5            │
│ MANAUSDT  ┆ 3.675228     ┆ 118  ┆ 4            │
│ XTZUSDT   ┆ 3.783935     ┆ 119  ┆ 3            │
│ UNFIUSDT  ┆ 3.873654     ┆ 120  ┆ 2            │
│ SPELLUSDT ┆ 4.011381     ┆ 121  ┆ 1            │
│ SFPUSDT   ┆ 4.227701     ┆ 122  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,321 - WARNING - 2023-08-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,321 - INFO - cur close time: 2023-08-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:12,321 - DEBUG - mean expected ret (mean factor): 0.31641016939557554
2024-12-12 23:54:12,326 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,326 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,326 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01805     ┆ 0.06441     ┆ 0.0010722   ┆ … ┆ 0.01667 ┆ null   ┆ null    ┆ 0.1733  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,334 - DEBUG - update position: 2023-08-22T23:59:59.999 === diff_trading_value: 318171.86204901617 == cash: 105500.3788278569 
2024-12-12 23:54:12,338 - INFO - pnl: 2023-08-22T23:59:59.999 105500.3788278569 === -1.132%
2024-12-12 23:54:12,342 - DEBUG - cur time: 2023-08-23T23:59:59.999 == next bar open time: 2023-08-24T00:00:00.000 == close pos time: 2023-08-29T00:00:00.000
2024-12-12 23:54:12,342 - INFO - pnl: 2023-08-23T23:59:59.999 106217.25895498061 === 0.680%
2024-12-12 23:54:12,346 - DEBUG - cur time: 2023-08-24T23:59:59.999 == next bar open time: 2023-08-25T00:00:00.000 == close pos time: 2023-08-30T00:00:00.000
2024-12-12 23:54:12,350 - INFO - pnl: 2023-08-24T23:59:59.999 104639.03339335084 === -1.486%
2024-12-12 23:54:12,354 - DEBUG - cur time: 2023-08-25T23:59:59.999 == next bar open time: 2023-08-26T00:00:00.000 == close pos time: 2023-08-31T00:00:00.000
2024-12-12 23:54:12,354 - INFO - pnl: 2023-08-25T23:59:59.999 102559.59945850316 === -1.987%
2024-12-12 23:54:12,363 - DEBUG - cur time: 2023-08-26T23:59:59.999 == next bar open time: 2023-08-27T00:00:00.000 == close pos time: 2023-09-01T00:00:00.000
2024-12-12 23:54:12,363 - INFO - pnl: 2023-08-26T23:59:59.999 102939.03152415175 === 0.370%
2024-12-12 23:54:12,367 - DEBUG - cur time: 2023-08-27T23:59:59.999 == next bar open time: 2023-08-28T00:00:00.000 == close pos time: 2023-09-02T00:00:00.000
2024-12-12 23:54:12,380 - DEBUG - close time 2023-08-27T23:59:59.999 == vol_threshold: 9852699.05
2024-12-12 23:54:12,380 - DEBUG - 2023-08-27T23:59:59.999 == all trade symbol 176 == remain 123 after VOL filter
2024-12-12 23:54:12,384 - DEBUG - sorted_long_factors: shape: (123, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ KEYUSDT   ┆ -2.591411    ┆ 0    ┆ 122          │
│ JOEUSDT   ┆ -2.441808    ┆ 1    ┆ 121          │
│ XRPUSDT   ┆ -2.310176    ┆ 2    ┆ 120          │
│ ALPHAUSDT ┆ -2.157809    ┆ 3    ┆ 119          │
│ ICXUSDT   ┆ -1.969797    ┆ 4    ┆ 118          │
│ IDEXUSDT  ┆ -1.924985    ┆ 5    ┆ 117          │
│ IMXUSDT   ┆ -1.924009    ┆ 6    ┆ 116          │
│ HBARUSDT  ┆ -1.87163     ┆ 7    ┆ 115          │
│ BAKEUSDT  ┆ -1.711332    ┆ 8    ┆ 114          │
│ MANAUSDT  ┆ -1.609928    ┆ 9    ┆ 113          │
│ …         ┆ …            ┆ …    ┆ …            │
│ DGBUSDT   ┆ 1.624202     ┆ 113  ┆ 9            │
│ IOTXUSDT  ┆ 1.642647     ┆ 114  ┆ 8            │
│ PHBUSDT   ┆ 1.683817     ┆ 115  ┆ 7            │
│ DYDXUSDT  ┆ 1.786494     ┆ 116  ┆ 6            │
│ FLMUSDT   ┆ 1.823469     ┆ 117  ┆ 5            │
│ TRBUSDT   ┆ 2.167709     ┆ 118  ┆ 4            │
│ BATUSDT   ┆ 2.559562     ┆ 119  ┆ 3            │
│ REEFUSDT  ┆ 2.720693     ┆ 120  ┆ 2            │
│ TRXUSDT   ┆ 2.991097     ┆ 121  ┆ 1            │
│ HOOKUSDT  ┆ 3.214118     ┆ 122  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,391 - WARNING - 2023-08-27T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,391 - INFO - cur close time: 2023-08-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:12,392 - DEBUG - mean expected ret (mean factor): 0.041891415103506156
2024-12-12 23:54:12,397 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,397 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,397 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01763     ┆ 0.06232     ┆ 0.0008956   ┆ … ┆ 0.0167  ┆ null   ┆ null    ┆ 0.172   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,401 - DEBUG - update position: 2023-08-27T23:59:59.999 === diff_trading_value: 328681.61093640525 == cash: 102776.74618479698 
2024-12-12 23:54:12,401 - INFO - pnl: 2023-08-27T23:59:59.999 102776.74618479698 === -0.158%
2024-12-12 23:54:12,405 - DEBUG - cur time: 2023-08-28T23:59:59.999 == next bar open time: 2023-08-29T00:00:00.000 == close pos time: 2023-09-03T00:00:00.000
2024-12-12 23:54:12,405 - INFO - pnl: 2023-08-28T23:59:59.999 102375.98945856266 === -0.390%
2024-12-12 23:54:12,410 - DEBUG - cur time: 2023-08-29T23:59:59.999 == next bar open time: 2023-08-30T00:00:00.000 == close pos time: 2023-09-04T00:00:00.000
2024-12-12 23:54:12,413 - INFO - pnl: 2023-08-29T23:59:59.999 103287.71615104342 === 0.891%
2024-12-12 23:54:12,419 - DEBUG - cur time: 2023-08-30T23:59:59.999 == next bar open time: 2023-08-31T00:00:00.000 == close pos time: 2023-09-05T00:00:00.000
2024-12-12 23:54:12,419 - INFO - pnl: 2023-08-30T23:59:59.999 103968.89444959696 === 0.659%
2024-12-12 23:54:12,425 - DEBUG - cur time: 2023-08-31T23:59:59.999 == next bar open time: 2023-09-01T00:00:00.000 == close pos time: 2023-09-06T00:00:00.000
2024-12-12 23:54:12,427 - INFO - pnl: 2023-08-31T23:59:59.999 99457.28164562424 === -4.339%
2024-12-12 23:54:12,431 - DEBUG - cur time: 2023-09-01T23:59:59.999 == next bar open time: 2023-09-02T00:00:00.000 == close pos time: 2023-09-07T00:00:00.000
2024-12-12 23:54:12,439 - DEBUG - close time 2023-09-01T23:59:59.999 == vol_threshold: 19089698.28
2024-12-12 23:54:12,439 - DEBUG - 2023-09-01T23:59:59.999 == all trade symbol 177 == remain 124 after VOL filter
2024-12-12 23:54:12,442 - DEBUG - sorted_long_factors: shape: (124, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ARBUSDT      ┆ -4.742747    ┆ 0    ┆ 123          │
│ TLMUSDT      ┆ -3.740614    ┆ 1    ┆ 122          │
│ KEYUSDT      ┆ -3.642982    ┆ 2    ┆ 121          │
│ ACHUSDT      ┆ -3.616918    ┆ 3    ┆ 120          │
│ LRCUSDT      ┆ -3.116808    ┆ 4    ┆ 119          │
│ FTMUSDT      ┆ -2.79665     ┆ 5    ┆ 118          │
│ 1000LUNCUSDT ┆ -2.780728    ┆ 6    ┆ 117          │
│ BNXUSDT      ┆ -2.768632    ┆ 7    ┆ 116          │
│ VETUSDT      ┆ -2.524331    ┆ 8    ┆ 115          │
│ DUSKUSDT     ┆ -2.284919    ┆ 9    ┆ 114          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ENJUSDT      ┆ 2.847009     ┆ 114  ┆ 9            │
│ KAVAUSDT     ┆ 2.87294      ┆ 115  ┆ 8            │
│ UNFIUSDT     ┆ 2.924958     ┆ 116  ┆ 7            │
│ RUNEUSDT     ┆ 3.554119     ┆ 117  ┆ 6            │
│ STXUSDT      ┆ 3.644638     ┆ 118  ┆ 5            │
│ BLZUSDT      ┆ 3.702747     ┆ 119  ┆ 4            │
│ BLURUSDT     ┆ 4.42838      ┆ 120  ┆ 3            │
│ FLOWUSDT     ┆ 5.027511     ┆ 121  ┆ 2            │
│ NEARUSDT     ┆ 5.146074     ┆ 122  ┆ 1            │
│ KLAYUSDT     ┆ 5.989496     ┆ 123  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,450 - INFO - cur close time: 2023-09-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:12,450 - DEBUG - mean expected ret (mean factor): 0.21516503830865422
2024-12-12 23:54:12,455 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,455 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,455 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01701     ┆ 0.06049     ┆ 0.0007747   ┆ … ┆ 0.01589 ┆ null   ┆ null    ┆ 0.1621  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,460 - DEBUG - update position: 2023-09-01T23:59:59.999 === diff_trading_value: 337301.89207379665 == cash: 100958.80236066494 
2024-12-12 23:54:12,460 - INFO - pnl: 2023-09-01T23:59:59.999 100958.80236066494 === 1.510%
2024-12-12 23:54:12,463 - DEBUG - cur time: 2023-09-02T23:59:59.999 == next bar open time: 2023-09-03T00:00:00.000 == close pos time: 2023-09-08T00:00:00.000
2024-12-12 23:54:12,467 - INFO - pnl: 2023-09-02T23:59:59.999 99863.85333608453 === -1.085%
2024-12-12 23:54:12,470 - DEBUG - cur time: 2023-09-03T23:59:59.999 == next bar open time: 2023-09-04T00:00:00.000 == close pos time: 2023-09-09T00:00:00.000
2024-12-12 23:54:12,471 - INFO - pnl: 2023-09-03T23:59:59.999 101146.26676107016 === 1.284%
2024-12-12 23:54:12,475 - DEBUG - cur time: 2023-09-04T23:59:59.999 == next bar open time: 2023-09-05T00:00:00.000 == close pos time: 2023-09-10T00:00:00.000
2024-12-12 23:54:12,475 - INFO - pnl: 2023-09-04T23:59:59.999 101243.63279342659 === 0.096%
2024-12-12 23:54:12,480 - DEBUG - cur time: 2023-09-05T23:59:59.999 == next bar open time: 2023-09-06T00:00:00.000 == close pos time: 2023-09-11T00:00:00.000
2024-12-12 23:54:12,480 - INFO - pnl: 2023-09-05T23:59:59.999 103589.71220301205 === 2.317%
2024-12-12 23:54:12,485 - DEBUG - cur time: 2023-09-06T23:59:59.999 == next bar open time: 2023-09-07T00:00:00.000 == close pos time: 2023-09-12T00:00:00.000
2024-12-12 23:54:12,491 - DEBUG - close time 2023-09-06T23:59:59.999 == vol_threshold: 20310119.139999997
2024-12-12 23:54:12,495 - DEBUG - 2023-09-06T23:59:59.999 == all trade symbol 177 == remain 124 after VOL filter
2024-12-12 23:54:12,495 - DEBUG - sorted_long_factors: shape: (124, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RDNTUSDT     ┆ -5.187812    ┆ 0    ┆ 123          │
│ ALPHAUSDT    ┆ -4.085511    ┆ 1    ┆ 122          │
│ HFTUSDT      ┆ -3.929404    ┆ 2    ┆ 121          │
│ LQTYUSDT     ┆ -3.186036    ┆ 3    ┆ 120          │
│ LUNA2USDT    ┆ -3.144966    ┆ 4    ┆ 119          │
│ NKNUSDT      ┆ -3.098748    ┆ 5    ┆ 118          │
│ STXUSDT      ┆ -2.970335    ┆ 6    ┆ 117          │
│ JASMYUSDT    ┆ -2.662759    ┆ 7    ┆ 116          │
│ AMBUSDT      ┆ -2.453621    ┆ 8    ┆ 115          │
│ KNCUSDT      ┆ -2.421174    ┆ 9    ┆ 114          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RUNEUSDT     ┆ 2.951292     ┆ 114  ┆ 9            │
│ NEARUSDT     ┆ 3.073399     ┆ 115  ┆ 8            │
│ 1000SHIBUSDT ┆ 3.289217     ┆ 116  ┆ 7            │
│ IOTAUSDT     ┆ 3.368309     ┆ 117  ┆ 6            │
│ ALGOUSDT     ┆ 3.475188     ┆ 118  ┆ 5            │
│ BATUSDT      ┆ 3.637856     ┆ 119  ┆ 4            │
│ PERPUSDT     ┆ 4.559609     ┆ 120  ┆ 3            │
│ IOTXUSDT     ┆ 4.809317     ┆ 121  ┆ 2            │
│ UNFIUSDT     ┆ 5.265974     ┆ 122  ┆ 1            │
│ SFPUSDT      ┆ 5.944599     ┆ 123  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,500 - WARNING - 2023-09-06T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,500 - INFO - cur close time: 2023-09-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:12,500 - DEBUG - mean expected ret (mean factor): 0.0556428505375948
2024-12-12 23:54:12,504 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,504 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,504 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01686     ┆ 0.06134     ┆ 0.0007959   ┆ … ┆ 0.01636 ┆ null   ┆ null    ┆ 0.1749  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,512 - DEBUG - update position: 2023-09-06T23:59:59.999 === diff_trading_value: 322313.8568404035 == cash: 102580.32865462445 
2024-12-12 23:54:12,512 - INFO - pnl: 2023-09-06T23:59:59.999 102580.32865462445 === -0.974%
2024-12-12 23:54:12,516 - DEBUG - cur time: 2023-09-07T23:59:59.999 == next bar open time: 2023-09-08T00:00:00.000 == close pos time: 2023-09-13T00:00:00.000
2024-12-12 23:54:12,519 - INFO - pnl: 2023-09-07T23:59:59.999 103339.95503612258 === 0.741%
2024-12-12 23:54:12,519 - DEBUG - cur time: 2023-09-08T23:59:59.999 == next bar open time: 2023-09-09T00:00:00.000 == close pos time: 2023-09-14T00:00:00.000
2024-12-12 23:54:12,523 - INFO - pnl: 2023-09-08T23:59:59.999 102417.2175624079 === -0.893%
2024-12-12 23:54:12,523 - DEBUG - cur time: 2023-09-09T23:59:59.999 == next bar open time: 2023-09-10T00:00:00.000 == close pos time: 2023-09-15T00:00:00.000
2024-12-12 23:54:12,528 - INFO - pnl: 2023-09-09T23:59:59.999 102244.47019828246 === -0.169%
2024-12-12 23:54:12,532 - DEBUG - cur time: 2023-09-10T23:59:59.999 == next bar open time: 2023-09-11T00:00:00.000 == close pos time: 2023-09-16T00:00:00.000
2024-12-12 23:54:12,532 - INFO - pnl: 2023-09-10T23:59:59.999 104868.29267857634 === 2.566%
2024-12-12 23:54:12,536 - DEBUG - cur time: 2023-09-11T23:59:59.999 == next bar open time: 2023-09-12T00:00:00.000 == close pos time: 2023-09-17T00:00:00.000
2024-12-12 23:54:12,545 - DEBUG - close time 2023-09-11T23:59:59.999 == vol_threshold: 28312494.279999997
2024-12-12 23:54:12,545 - DEBUG - 2023-09-11T23:59:59.999 == all trade symbol 179 == remain 125 after VOL filter
2024-12-12 23:54:12,548 - DEBUG - sorted_long_factors: shape: (125, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ IDEXUSDT   ┆ -6.277602    ┆ 0    ┆ 124          │
│ GRTUSDT    ┆ -4.514408    ┆ 1    ┆ 123          │
│ TUSDT      ┆ -4.315185    ┆ 2    ┆ 122          │
│ LUNA2USDT  ┆ -4.206865    ┆ 3    ┆ 121          │
│ KEYUSDT    ┆ -3.760966    ┆ 4    ┆ 120          │
│ DUSKUSDT   ┆ -3.568203    ┆ 5    ┆ 119          │
│ ARBUSDT    ┆ -3.178843    ┆ 6    ┆ 118          │
│ SUIUSDT    ┆ -3.05838     ┆ 7    ┆ 117          │
│ BNXUSDT    ┆ -2.960782    ┆ 8    ┆ 116          │
│ CTSIUSDT   ┆ -2.941033    ┆ 9    ┆ 115          │
│ …          ┆ …            ┆ …    ┆ …            │
│ SFPUSDT    ┆ 2.85167      ┆ 115  ┆ 9            │
│ RUNEUSDT   ┆ 2.947822     ┆ 116  ┆ 8            │
│ BLZUSDT    ┆ 3.216994     ┆ 117  ┆ 7            │
│ FLMUSDT    ┆ 3.500783     ┆ 118  ┆ 6            │
│ IOTXUSDT   ┆ 3.573406     ┆ 119  ┆ 5            │
│ OGNUSDT    ┆ 3.639709     ┆ 120  ┆ 4            │
│ PERPUSDT   ┆ 4.112551     ┆ 121  ┆ 3            │
│ CKBUSDT    ┆ 4.341449     ┆ 122  ┆ 2            │
│ STORJUSDT  ┆ 4.553413     ┆ 123  ┆ 1            │
│ PEOPLEUSDT ┆ 5.074514     ┆ 124  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,553 - WARNING - 2023-09-11T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,553 - INFO - cur close time: 2023-09-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:12,553 - DEBUG - mean expected ret (mean factor): -0.17827724531200162
2024-12-12 23:54:12,559 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,559 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,559 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01554     ┆ 0.05689     ┆ 0.0006688   ┆ … ┆ 0.01504 ┆ null   ┆ null    ┆ 0.1581  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,565 - DEBUG - update position: 2023-09-11T23:59:59.999 === diff_trading_value: 261535.8032582332 == cash: 105949.02559313456 
2024-12-12 23:54:12,565 - INFO - pnl: 2023-09-11T23:59:59.999 105949.02559313456 === 1.031%
2024-12-12 23:54:12,570 - DEBUG - cur time: 2023-09-12T23:59:59.999 == next bar open time: 2023-09-13T00:00:00.000 == close pos time: 2023-09-18T00:00:00.000
2024-12-12 23:54:12,570 - INFO - pnl: 2023-09-12T23:59:59.999 104684.02387203122 === -1.194%
2024-12-12 23:54:12,574 - DEBUG - cur time: 2023-09-13T23:59:59.999 == next bar open time: 2023-09-14T00:00:00.000 == close pos time: 2023-09-19T00:00:00.000
2024-12-12 23:54:12,574 - INFO - pnl: 2023-09-13T23:59:59.999 103252.39413032944 === -1.368%
2024-12-12 23:54:12,580 - DEBUG - cur time: 2023-09-14T23:59:59.999 == next bar open time: 2023-09-15T00:00:00.000 == close pos time: 2023-09-20T00:00:00.000
2024-12-12 23:54:12,582 - INFO - pnl: 2023-09-14T23:59:59.999 103328.48909821986 === 0.074%
2024-12-12 23:54:12,583 - DEBUG - cur time: 2023-09-15T23:59:59.999 == next bar open time: 2023-09-16T00:00:00.000 == close pos time: 2023-09-21T00:00:00.000
2024-12-12 23:54:12,587 - INFO - pnl: 2023-09-15T23:59:59.999 103811.05843682133 === 0.467%
2024-12-12 23:54:12,591 - DEBUG - cur time: 2023-09-16T23:59:59.999 == next bar open time: 2023-09-17T00:00:00.000 == close pos time: 2023-09-22T00:00:00.000
2024-12-12 23:54:12,600 - DEBUG - close time 2023-09-16T23:59:59.999 == vol_threshold: 15819227.039999995
2024-12-12 23:54:12,600 - DEBUG - 2023-09-16T23:59:59.999 == all trade symbol 180 == remain 126 after VOL filter
2024-12-12 23:54:12,605 - DEBUG - sorted_long_factors: shape: (126, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DUSKUSDT     ┆ -5.307239    ┆ 0    ┆ 125          │
│ MTLUSDT      ┆ -5.153763    ┆ 1    ┆ 124          │
│ IDEXUSDT     ┆ -4.496418    ┆ 2    ┆ 123          │
│ PHBUSDT      ┆ -4.392799    ┆ 3    ┆ 122          │
│ LUNA2USDT    ┆ -3.894089    ┆ 4    ┆ 121          │
│ 1000LUNCUSDT ┆ -3.663133    ┆ 5    ┆ 120          │
│ JOEUSDT      ┆ -3.527567    ┆ 6    ┆ 119          │
│ CHZUSDT      ┆ -3.263979    ┆ 7    ┆ 118          │
│ EDUUSDT      ┆ -3.240222    ┆ 8    ┆ 117          │
│ RSRUSDT      ┆ -3.119653    ┆ 9    ┆ 116          │
│ …            ┆ …            ┆ …    ┆ …            │
│ XEMUSDT      ┆ 3.096702     ┆ 116  ┆ 9            │
│ SFPUSDT      ┆ 3.280047     ┆ 117  ┆ 8            │
│ CELOUSDT     ┆ 3.32638      ┆ 118  ┆ 7            │
│ ICXUSDT      ┆ 3.44464      ┆ 119  ┆ 6            │
│ WOOUSDT      ┆ 3.473431     ┆ 120  ┆ 5            │
│ BAKEUSDT     ┆ 3.552468     ┆ 121  ┆ 4            │
│ RDNTUSDT     ┆ 3.617521     ┆ 122  ┆ 3            │
│ FLMUSDT      ┆ 4.127329     ┆ 123  ┆ 2            │
│ VETUSDT      ┆ 4.478041     ┆ 124  ┆ 1            │
│ DENTUSDT     ┆ 4.777551     ┆ 125  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,610 - WARNING - 2023-09-16T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,610 - INFO - cur close time: 2023-09-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:12,610 - DEBUG - mean expected ret (mean factor): -0.029680113667519065
2024-12-12 23:54:12,613 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,613 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,613 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01617     ┆ 0.05867     ┆ 0.0006756   ┆ … ┆ 0.01662 ┆ null   ┆ null    ┆ 0.1896  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,621 - DEBUG - update position: 2023-09-16T23:59:59.999 === diff_trading_value: 338733.4295712176 == cash: 101542.06424570247 
2024-12-12 23:54:12,621 - INFO - pnl: 2023-09-16T23:59:59.999 101542.06424570247 === -2.186%
2024-12-12 23:54:12,625 - DEBUG - cur time: 2023-09-17T23:59:59.999 == next bar open time: 2023-09-18T00:00:00.000 == close pos time: 2023-09-23T00:00:00.000
2024-12-12 23:54:12,629 - INFO - pnl: 2023-09-17T23:59:59.999 101172.65912318125 === -0.364%
2024-12-12 23:54:12,634 - DEBUG - cur time: 2023-09-18T23:59:59.999 == next bar open time: 2023-09-19T00:00:00.000 == close pos time: 2023-09-24T00:00:00.000
2024-12-12 23:54:12,634 - INFO - pnl: 2023-09-18T23:59:59.999 101961.96359357313 === 0.780%
2024-12-12 23:54:12,638 - DEBUG - cur time: 2023-09-19T23:59:59.999 == next bar open time: 2023-09-20T00:00:00.000 == close pos time: 2023-09-25T00:00:00.000
2024-12-12 23:54:12,640 - INFO - pnl: 2023-09-19T23:59:59.999 104847.3033874887 === 2.830%
2024-12-12 23:54:12,642 - DEBUG - cur time: 2023-09-20T23:59:59.999 == next bar open time: 2023-09-21T00:00:00.000 == close pos time: 2023-09-26T00:00:00.000
2024-12-12 23:54:12,647 - INFO - pnl: 2023-09-20T23:59:59.999 104055.26708607785 === -0.755%
2024-12-12 23:54:12,650 - DEBUG - cur time: 2023-09-21T23:59:59.999 == next bar open time: 2023-09-22T00:00:00.000 == close pos time: 2023-09-27T00:00:00.000
2024-12-12 23:54:12,662 - DEBUG - close time 2023-09-21T23:59:59.999 == vol_threshold: 18054329.18
2024-12-12 23:54:12,663 - DEBUG - 2023-09-21T23:59:59.999 == all trade symbol 180 == remain 126 after VOL filter
2024-12-12 23:54:12,663 - DEBUG - sorted_long_factors: shape: (126, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TUSDT     ┆ -5.524948    ┆ 0    ┆ 125          │
│ XVGUSDT   ┆ -4.212346    ┆ 1    ┆ 124          │
│ EDUUSDT   ┆ -4.137264    ┆ 2    ┆ 123          │
│ HOOKUSDT  ┆ -3.673297    ┆ 3    ┆ 122          │
│ MAVUSDT   ┆ -3.660871    ┆ 4    ┆ 121          │
│ IDUSDT    ┆ -3.294068    ┆ 5    ┆ 120          │
│ KLAYUSDT  ┆ -3.026189    ┆ 6    ┆ 119          │
│ MDTUSDT   ┆ -2.871336    ┆ 7    ┆ 118          │
│ BNXUSDT   ┆ -2.838691    ┆ 8    ┆ 117          │
│ RVNUSDT   ┆ -2.770198    ┆ 9    ┆ 116          │
│ …         ┆ …            ┆ …    ┆ …            │
│ IOTXUSDT  ┆ 2.409082     ┆ 116  ┆ 9            │
│ ALGOUSDT  ┆ 2.511089     ┆ 117  ┆ 8            │
│ STORJUSDT ┆ 2.899652     ┆ 118  ┆ 7            │
│ BLZUSDT   ┆ 3.506401     ┆ 119  ┆ 6            │
│ TRBUSDT   ┆ 3.652866     ┆ 120  ┆ 5            │
│ STXUSDT   ┆ 3.661034     ┆ 121  ┆ 4            │
│ STMXUSDT  ┆ 3.673149     ┆ 122  ┆ 3            │
│ IMXUSDT   ┆ 3.720385     ┆ 123  ┆ 2            │
│ LEVERUSDT ┆ 4.724645     ┆ 124  ┆ 1            │
│ FLMUSDT   ┆ 7.578343     ┆ 125  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,672 - WARNING - 2023-09-21T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,672 - INFO - cur close time: 2023-09-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:12,672 - DEBUG - mean expected ret (mean factor): -0.02661741923227526
2024-12-12 23:54:12,676 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,676 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,676 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01543     ┆ 0.05983     ┆ 0.0006114   ┆ … ┆ 0.0169  ┆ null   ┆ null    ┆ 0.1839  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,684 - DEBUG - update position: 2023-09-21T23:59:59.999 === diff_trading_value: 309525.8222068627 == cash: 101816.8348188414 
2024-12-12 23:54:12,684 - INFO - pnl: 2023-09-21T23:59:59.999 101816.8348188414 === -2.151%
2024-12-12 23:54:12,690 - DEBUG - cur time: 2023-09-22T23:59:59.999 == next bar open time: 2023-09-23T00:00:00.000 == close pos time: 2023-09-28T00:00:00.000
2024-12-12 23:54:12,690 - INFO - pnl: 2023-09-22T23:59:59.999 104098.61310797532 === 2.241%
2024-12-12 23:54:12,696 - DEBUG - cur time: 2023-09-23T23:59:59.999 == next bar open time: 2023-09-24T00:00:00.000 == close pos time: 2023-09-29T00:00:00.000
2024-12-12 23:54:12,698 - INFO - pnl: 2023-09-23T23:59:59.999 102586.99466982234 === -1.452%
2024-12-12 23:54:12,701 - DEBUG - cur time: 2023-09-24T23:59:59.999 == next bar open time: 2023-09-25T00:00:00.000 == close pos time: 2023-09-30T00:00:00.000
2024-12-12 23:54:12,701 - INFO - pnl: 2023-09-24T23:59:59.999 102970.16916479601 === 0.374%
2024-12-12 23:54:12,705 - DEBUG - cur time: 2023-09-25T23:59:59.999 == next bar open time: 2023-09-26T00:00:00.000 == close pos time: 2023-10-01T00:00:00.000
2024-12-12 23:54:12,705 - INFO - pnl: 2023-09-25T23:59:59.999 102564.19783714459 === -0.394%
2024-12-12 23:54:12,709 - DEBUG - cur time: 2023-09-26T23:59:59.999 == next bar open time: 2023-09-27T00:00:00.000 == close pos time: 2023-10-02T00:00:00.000
2024-12-12 23:54:12,722 - DEBUG - close time 2023-09-26T23:59:59.999 == vol_threshold: 13099364.84
2024-12-12 23:54:12,722 - DEBUG - 2023-09-26T23:59:59.999 == all trade symbol 180 == remain 126 after VOL filter
2024-12-12 23:54:12,725 - DEBUG - sorted_long_factors: shape: (126, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TUSDT     ┆ -4.472345    ┆ 0    ┆ 125          │
│ TLMUSDT   ┆ -4.108718    ┆ 1    ┆ 124          │
│ MTLUSDT   ┆ -3.395983    ┆ 2    ┆ 123          │
│ MASKUSDT  ┆ -2.984878    ┆ 3    ┆ 122          │
│ LINAUSDT  ┆ -2.897614    ┆ 4    ┆ 121          │
│ IDEXUSDT  ┆ -2.78598     ┆ 5    ┆ 120          │
│ HOOKUSDT  ┆ -2.381312    ┆ 6    ┆ 119          │
│ SUIUSDT   ┆ -2.356486    ┆ 7    ┆ 118          │
│ STXUSDT   ┆ -2.223759    ┆ 8    ┆ 117          │
│ FILUSDT   ┆ -2.156514    ┆ 9    ┆ 116          │
│ …         ┆ …            ┆ …    ┆ …            │
│ KNCUSDT   ┆ 2.224437     ┆ 116  ┆ 9            │
│ OMGUSDT   ┆ 2.422677     ┆ 117  ┆ 8            │
│ CKBUSDT   ┆ 2.447444     ┆ 118  ┆ 7            │
│ RVNUSDT   ┆ 2.561543     ┆ 119  ┆ 6            │
│ DENTUSDT  ┆ 2.580105     ┆ 120  ┆ 5            │
│ ROSEUSDT  ┆ 2.97413      ┆ 121  ┆ 4            │
│ AMBUSDT   ┆ 3.630105     ┆ 122  ┆ 3            │
│ LEVERUSDT ┆ 3.849807     ┆ 123  ┆ 2            │
│ STORJUSDT ┆ 4.378486     ┆ 124  ┆ 1            │
│ TRBUSDT   ┆ 6.914795     ┆ 125  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,730 - WARNING - 2023-09-26T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,730 - INFO - cur close time: 2023-09-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:12,730 - DEBUG - mean expected ret (mean factor): -0.16298271861844532
2024-12-12 23:54:12,734 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,734 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,734 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01555     ┆ 0.0619      ┆ 0.0006949   ┆ … ┆ 0.01703 ┆ null   ┆ null    ┆ 0.1826  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,740 - DEBUG - update position: 2023-09-26T23:59:59.999 === diff_trading_value: 295102.61445309815 == cash: 103950.08436672737 
2024-12-12 23:54:12,742 - INFO - pnl: 2023-09-26T23:59:59.999 103950.08436672737 === 1.351%
2024-12-12 23:54:12,747 - DEBUG - cur time: 2023-09-27T23:59:59.999 == next bar open time: 2023-09-28T00:00:00.000 == close pos time: 2023-10-03T00:00:00.000
2024-12-12 23:54:12,747 - INFO - pnl: 2023-09-27T23:59:59.999 105649.45741262284 === 1.635%
2024-12-12 23:54:12,751 - DEBUG - cur time: 2023-09-28T23:59:59.999 == next bar open time: 2023-09-29T00:00:00.000 == close pos time: 2023-10-04T00:00:00.000
2024-12-12 23:54:12,751 - INFO - pnl: 2023-09-28T23:59:59.999 104551.30111411888 === -1.039%
2024-12-12 23:54:12,754 - DEBUG - cur time: 2023-09-29T23:59:59.999 == next bar open time: 2023-09-30T00:00:00.000 == close pos time: 2023-10-05T00:00:00.000
2024-12-12 23:54:12,754 - INFO - pnl: 2023-09-29T23:59:59.999 104624.47415534953 === 0.070%
2024-12-12 23:54:12,759 - DEBUG - cur time: 2023-09-30T23:59:59.999 == next bar open time: 2023-10-01T00:00:00.000 == close pos time: 2023-10-06T00:00:00.000
2024-12-12 23:54:12,759 - INFO - pnl: 2023-09-30T23:59:59.999 105022.23692910642 === 0.380%
2024-12-12 23:54:12,762 - DEBUG - cur time: 2023-10-01T23:59:59.999 == next bar open time: 2023-10-02T00:00:00.000 == close pos time: 2023-10-07T00:00:00.000
2024-12-12 23:54:12,775 - DEBUG - close time 2023-10-01T23:59:59.999 == vol_threshold: 20886130.309999995
2024-12-12 23:54:12,775 - DEBUG - 2023-10-01T23:59:59.999 == all trade symbol 180 == remain 126 after VOL filter
2024-12-12 23:54:12,780 - DEBUG - sorted_long_factors: shape: (126, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ IOSTUSDT  ┆ -4.57659     ┆ 0    ┆ 125          │
│ SFPUSDT   ┆ -3.848084    ┆ 1    ┆ 124          │
│ MDTUSDT   ┆ -3.536296    ┆ 2    ┆ 123          │
│ ALPHAUSDT ┆ -3.505008    ┆ 3    ┆ 122          │
│ BELUSDT   ┆ -3.491529    ┆ 4    ┆ 121          │
│ ARPAUSDT  ┆ -3.140398    ┆ 5    ┆ 120          │
│ MINAUSDT  ┆ -3.102994    ┆ 6    ┆ 119          │
│ EDUUSDT   ┆ -3.082981    ┆ 7    ┆ 118          │
│ ACHUSDT   ┆ -2.851126    ┆ 8    ┆ 117          │
│ HOOKUSDT  ┆ -2.406103    ┆ 9    ┆ 116          │
│ …         ┆ …            ┆ …    ┆ …            │
│ DGBUSDT   ┆ 2.339968     ┆ 116  ┆ 9            │
│ STORJUSDT ┆ 2.438351     ┆ 117  ┆ 8            │
│ EOSUSDT   ┆ 2.577097     ┆ 118  ┆ 7            │
│ IOTXUSDT  ┆ 2.658081     ┆ 119  ┆ 6            │
│ RUNEUSDT  ┆ 2.72145      ┆ 120  ┆ 5            │
│ LEVERUSDT ┆ 3.661831     ┆ 121  ┆ 4            │
│ BAKEUSDT  ┆ 3.722203     ┆ 122  ┆ 3            │
│ XEMUSDT   ┆ 3.826128     ┆ 123  ┆ 2            │
│ VETUSDT   ┆ 3.958162     ┆ 124  ┆ 1            │
│ TRXUSDT   ┆ 6.737977     ┆ 125  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,788 - WARNING - 2023-10-01T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,788 - INFO - cur close time: 2023-10-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:12,788 - DEBUG - mean expected ret (mean factor): -0.10780867840827972
2024-12-12 23:54:12,793 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,793 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,793 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01938     ┆ 0.06441     ┆ 0.0008143   ┆ … ┆ 0.01796 ┆ null   ┆ null    ┆ 0.197   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,801 - DEBUG - update position: 2023-10-01T23:59:59.999 === diff_trading_value: 328854.66880422377 == cash: 106353.51097169651 
2024-12-12 23:54:12,805 - INFO - pnl: 2023-10-01T23:59:59.999 106353.51097169651 === 1.268%
2024-12-12 23:54:12,810 - DEBUG - cur time: 2023-10-02T23:59:59.999 == next bar open time: 2023-10-03T00:00:00.000 == close pos time: 2023-10-08T00:00:00.000
2024-12-12 23:54:12,810 - INFO - pnl: 2023-10-02T23:59:59.999 108864.54358335954 === 2.361%
2024-12-12 23:54:12,813 - DEBUG - cur time: 2023-10-03T23:59:59.999 == next bar open time: 2023-10-04T00:00:00.000 == close pos time: 2023-10-09T00:00:00.000
2024-12-12 23:54:12,817 - INFO - pnl: 2023-10-03T23:59:59.999 107238.3897962125 === -1.494%
2024-12-12 23:54:12,822 - DEBUG - cur time: 2023-10-04T23:59:59.999 == next bar open time: 2023-10-05T00:00:00.000 == close pos time: 2023-10-10T00:00:00.000
2024-12-12 23:54:12,822 - INFO - pnl: 2023-10-04T23:59:59.999 105416.05556070856 === -1.699%
2024-12-12 23:54:12,826 - DEBUG - cur time: 2023-10-05T23:59:59.999 == next bar open time: 2023-10-06T00:00:00.000 == close pos time: 2023-10-11T00:00:00.000
2024-12-12 23:54:12,830 - INFO - pnl: 2023-10-05T23:59:59.999 107073.80032029242 === 1.573%
2024-12-12 23:54:12,834 - DEBUG - cur time: 2023-10-06T23:59:59.999 == next bar open time: 2023-10-07T00:00:00.000 == close pos time: 2023-10-12T00:00:00.000
2024-12-12 23:54:12,844 - DEBUG - close time 2023-10-06T23:59:59.999 == vol_threshold: 12183444.0
2024-12-12 23:54:12,847 - DEBUG - 2023-10-06T23:59:59.999 == all trade symbol 181 == remain 126 after VOL filter
2024-12-12 23:54:12,847 - DEBUG - sorted_long_factors: shape: (126, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ IOSTUSDT ┆ -6.110071    ┆ 0    ┆ 125          │
│ KEYUSDT  ┆ -5.476583    ┆ 1    ┆ 124          │
│ IOTAUSDT ┆ -3.969058    ┆ 2    ┆ 123          │
│ MINAUSDT ┆ -3.747293    ┆ 3    ┆ 122          │
│ IDUSDT   ┆ -3.247121    ┆ 4    ┆ 121          │
│ LRCUSDT  ┆ -2.747996    ┆ 5    ┆ 120          │
│ FTMUSDT  ┆ -2.734836    ┆ 6    ┆ 119          │
│ KLAYUSDT ┆ -2.657799    ┆ 7    ┆ 118          │
│ DUSKUSDT ┆ -2.629071    ┆ 8    ┆ 117          │
│ PHBUSDT  ┆ -2.590733    ┆ 9    ┆ 116          │
│ …        ┆ …            ┆ …    ┆ …            │
│ DGBUSDT  ┆ 3.034558     ┆ 116  ┆ 9            │
│ RDNTUSDT ┆ 3.241772     ┆ 117  ┆ 8            │
│ ZRXUSDT  ┆ 3.330675     ┆ 118  ┆ 7            │
│ RNDRUSDT ┆ 3.445516     ┆ 119  ┆ 6            │
│ RVNUSDT  ┆ 3.461931     ┆ 120  ┆ 5            │
│ BAKEUSDT ┆ 3.56928      ┆ 121  ┆ 4            │
│ ARPAUSDT ┆ 4.378886     ┆ 122  ┆ 3            │
│ ONTUSDT  ┆ 4.574952     ┆ 123  ┆ 2            │
│ TRBUSDT  ┆ 4.674865     ┆ 124  ┆ 1            │
│ BATUSDT  ┆ 9.361405     ┆ 125  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,855 - WARNING - 2023-10-06T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,855 - INFO - cur close time: 2023-10-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:12,855 - DEBUG - mean expected ret (mean factor): -0.01645783257087018
2024-12-12 23:54:12,855 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,860 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,860 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01833     ┆ 0.05849     ┆ 0.0007242   ┆ … ┆ 0.01697 ┆ null   ┆ null    ┆ 0.1853  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,864 - DEBUG - update position: 2023-10-06T23:59:59.999 === diff_trading_value: 308719.8753838094 == cash: 106251.60055105285 
2024-12-12 23:54:12,868 - INFO - pnl: 2023-10-06T23:59:59.999 106251.60055105285 === -0.768%
2024-12-12 23:54:12,870 - DEBUG - cur time: 2023-10-07T23:59:59.999 == next bar open time: 2023-10-08T00:00:00.000 == close pos time: 2023-10-13T00:00:00.000
2024-12-12 23:54:12,872 - INFO - pnl: 2023-10-07T23:59:59.999 105460.65292568502 === -0.744%
2024-12-12 23:54:12,876 - DEBUG - cur time: 2023-10-08T23:59:59.999 == next bar open time: 2023-10-09T00:00:00.000 == close pos time: 2023-10-14T00:00:00.000
2024-12-12 23:54:12,876 - INFO - pnl: 2023-10-08T23:59:59.999 106885.95089061037 === 1.351%
2024-12-12 23:54:12,881 - DEBUG - cur time: 2023-10-09T23:59:59.999 == next bar open time: 2023-10-10T00:00:00.000 == close pos time: 2023-10-15T00:00:00.000
2024-12-12 23:54:12,881 - INFO - pnl: 2023-10-09T23:59:59.999 108263.0728714042 === 1.288%
2024-12-12 23:54:12,885 - DEBUG - cur time: 2023-10-10T23:59:59.999 == next bar open time: 2023-10-11T00:00:00.000 == close pos time: 2023-10-16T00:00:00.000
2024-12-12 23:54:12,885 - INFO - pnl: 2023-10-10T23:59:59.999 108447.06653389629 === 0.170%
2024-12-12 23:54:12,890 - DEBUG - cur time: 2023-10-11T23:59:59.999 == next bar open time: 2023-10-12T00:00:00.000 == close pos time: 2023-10-17T00:00:00.000
2024-12-12 23:54:12,901 - DEBUG - close time 2023-10-11T23:59:59.999 == vol_threshold: 15704016.1
2024-12-12 23:54:12,901 - DEBUG - 2023-10-11T23:59:59.999 == all trade symbol 184 == remain 129 after VOL filter
2024-12-12 23:54:12,901 - DEBUG - sorted_long_factors: shape: (129, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ KEYUSDT      ┆ -4.961355    ┆ 0    ┆ 128          │
│ MDTUSDT      ┆ -4.587529    ┆ 1    ┆ 127          │
│ ICXUSDT      ┆ -4.074576    ┆ 2    ┆ 126          │
│ XVGUSDT      ┆ -3.58433     ┆ 3    ┆ 125          │
│ 1000SHIBUSDT ┆ -3.424893    ┆ 4    ┆ 124          │
│ JASMYUSDT    ┆ -3.250615    ┆ 5    ┆ 123          │
│ ACHUSDT      ┆ -3.243823    ┆ 6    ┆ 122          │
│ FETUSDT      ┆ -3.129508    ┆ 7    ┆ 121          │
│ IOTXUSDT     ┆ -3.069198    ┆ 8    ┆ 120          │
│ 1000LUNCUSDT ┆ -2.955183    ┆ 9    ┆ 119          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOTAUSDT     ┆ 3.101593     ┆ 119  ┆ 9            │
│ BAKEUSDT     ┆ 3.213168     ┆ 120  ┆ 8            │
│ TLMUSDT      ┆ 3.242499     ┆ 121  ┆ 7            │
│ IDEXUSDT     ┆ 3.480415     ┆ 122  ┆ 6            │
│ STORJUSDT    ┆ 3.52086      ┆ 123  ┆ 5            │
│ SFPUSDT      ┆ 3.669503     ┆ 124  ┆ 4            │
│ GRTUSDT      ┆ 3.861453     ┆ 125  ┆ 3            │
│ RNDRUSDT     ┆ 3.992927     ┆ 126  ┆ 2            │
│ CKBUSDT      ┆ 4.323943     ┆ 127  ┆ 1            │
│ LQTYUSDT     ┆ 5.820881     ┆ 128  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,912 - WARNING - 2023-10-11T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,912 - INFO - cur close time: 2023-10-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:12,912 - DEBUG - mean expected ret (mean factor): -0.08764799033448169
2024-12-12 23:54:12,917 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,917 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,920 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01678     ┆ 0.05651     ┆ 0.0006355   ┆ … ┆ 0.01586 ┆ null   ┆ null    ┆ 0.1931  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,926 - DEBUG - update position: 2023-10-11T23:59:59.999 === diff_trading_value: 304722.0967183997 == cash: 109279.77288618824 
2024-12-12 23:54:12,926 - INFO - pnl: 2023-10-11T23:59:59.999 109279.77288618824 === 0.768%
2024-12-12 23:54:12,934 - DEBUG - cur time: 2023-10-12T23:59:59.999 == next bar open time: 2023-10-13T00:00:00.000 == close pos time: 2023-10-18T00:00:00.000
2024-12-12 23:54:12,935 - INFO - pnl: 2023-10-12T23:59:59.999 108110.10561275658 === -1.070%
2024-12-12 23:54:12,942 - DEBUG - cur time: 2023-10-13T23:59:59.999 == next bar open time: 2023-10-14T00:00:00.000 == close pos time: 2023-10-19T00:00:00.000
2024-12-12 23:54:12,942 - INFO - pnl: 2023-10-13T23:59:59.999 107333.83507655964 === -0.718%
2024-12-12 23:54:12,947 - DEBUG - cur time: 2023-10-14T23:59:59.999 == next bar open time: 2023-10-15T00:00:00.000 == close pos time: 2023-10-20T00:00:00.000
2024-12-12 23:54:12,947 - INFO - pnl: 2023-10-14T23:59:59.999 106591.70692603731 === -0.691%
2024-12-12 23:54:12,951 - DEBUG - cur time: 2023-10-15T23:59:59.999 == next bar open time: 2023-10-16T00:00:00.000 == close pos time: 2023-10-21T00:00:00.000
2024-12-12 23:54:12,951 - INFO - pnl: 2023-10-15T23:59:59.999 107033.56132916964 === 0.415%
2024-12-12 23:54:12,955 - DEBUG - cur time: 2023-10-16T23:59:59.999 == next bar open time: 2023-10-17T00:00:00.000 == close pos time: 2023-10-22T00:00:00.000
2024-12-12 23:54:12,964 - DEBUG - close time 2023-10-16T23:59:59.999 == vol_threshold: 25630280.84
2024-12-12 23:54:12,964 - DEBUG - 2023-10-16T23:59:59.999 == all trade symbol 185 == remain 129 after VOL filter
2024-12-12 23:54:12,968 - DEBUG - sorted_long_factors: shape: (129, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ MTLUSDT  ┆ -4.34918     ┆ 0    ┆ 128          │
│ HFTUSDT  ┆ -4.171701    ┆ 1    ┆ 127          │
│ EDUUSDT  ┆ -4.05365     ┆ 2    ┆ 126          │
│ MAVUSDT  ┆ -3.955553    ┆ 3    ┆ 125          │
│ ARKMUSDT ┆ -3.799307    ┆ 4    ┆ 124          │
│ MINAUSDT ┆ -3.688222    ┆ 5    ┆ 123          │
│ NKNUSDT  ┆ -3.359093    ┆ 6    ┆ 122          │
│ RDNTUSDT ┆ -3.310182    ┆ 7    ┆ 121          │
│ COTIUSDT ┆ -3.215153    ┆ 8    ┆ 120          │
│ SUIUSDT  ┆ -2.603403    ┆ 9    ┆ 119          │
│ …        ┆ …            ┆ …    ┆ …            │
│ CKBUSDT  ┆ 2.940354     ┆ 119  ┆ 9            │
│ RNDRUSDT ┆ 3.039711     ┆ 120  ┆ 8            │
│ KEYUSDT  ┆ 3.056613     ┆ 121  ┆ 7            │
│ RSRUSDT  ┆ 3.156774     ┆ 122  ┆ 6            │
│ ONEUSDT  ┆ 3.317072     ┆ 123  ┆ 5            │
│ BANDUSDT ┆ 3.392726     ┆ 124  ┆ 4            │
│ IOTAUSDT ┆ 4.172136     ┆ 125  ┆ 3            │
│ DGBUSDT  ┆ 4.272919     ┆ 126  ┆ 2            │
│ LDOUSDT  ┆ 4.878676     ┆ 127  ┆ 1            │
│ TRXUSDT  ┆ 6.944048     ┆ 128  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:12,976 - WARNING - 2023-10-16T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:12,976 - INFO - cur close time: 2023-10-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:12,976 - DEBUG - mean expected ret (mean factor): 0.1710105483732959
2024-12-12 23:54:12,980 - DEBUG - begin to update pos: =========
2024-12-12 23:54:12,980 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,980 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01835     ┆ 0.05785     ┆ 0.0006733   ┆ … ┆ 0.01672 ┆ null   ┆ null    ┆ 0.2385  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:12,989 - DEBUG - update position: 2023-10-16T23:59:59.999 === diff_trading_value: 358338.58600077085 == cash: 108581.29614797082 
2024-12-12 23:54:12,989 - INFO - pnl: 2023-10-16T23:59:59.999 108581.29614797082 === 1.446%
2024-12-12 23:54:12,993 - DEBUG - cur time: 2023-10-17T23:59:59.999 == next bar open time: 2023-10-18T00:00:00.000 == close pos time: 2023-10-23T00:00:00.000
2024-12-12 23:54:12,993 - INFO - pnl: 2023-10-17T23:59:59.999 111383.60372553837 === 2.581%
2024-12-12 23:54:13,000 - DEBUG - cur time: 2023-10-18T23:59:59.999 == next bar open time: 2023-10-19T00:00:00.000 == close pos time: 2023-10-24T00:00:00.000
2024-12-12 23:54:13,001 - INFO - pnl: 2023-10-18T23:59:59.999 116076.7436788315 === 4.213%
2024-12-12 23:54:13,005 - DEBUG - cur time: 2023-10-19T23:59:59.999 == next bar open time: 2023-10-20T00:00:00.000 == close pos time: 2023-10-25T00:00:00.000
2024-12-12 23:54:13,005 - INFO - pnl: 2023-10-19T23:59:59.999 114899.71974109134 === -1.014%
2024-12-12 23:54:13,009 - DEBUG - cur time: 2023-10-20T23:59:59.999 == next bar open time: 2023-10-21T00:00:00.000 == close pos time: 2023-10-26T00:00:00.000
2024-12-12 23:54:13,010 - INFO - pnl: 2023-10-20T23:59:59.999 115066.19288012339 === 0.145%
2024-12-12 23:54:13,013 - DEBUG - cur time: 2023-10-21T23:59:59.999 == next bar open time: 2023-10-22T00:00:00.000 == close pos time: 2023-10-27T00:00:00.000
2024-12-12 23:54:13,025 - DEBUG - close time 2023-10-21T23:59:59.999 == vol_threshold: 14561160.200000005
2024-12-12 23:54:13,025 - DEBUG - 2023-10-21T23:59:59.999 == all trade symbol 188 == remain 131 after VOL filter
2024-12-12 23:54:13,025 - DEBUG - sorted_long_factors: shape: (131, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ COTIUSDT  ┆ -5.867503    ┆ 0    ┆ 130          │
│ DUSKUSDT  ┆ -5.477491    ┆ 1    ┆ 129          │
│ MDTUSDT   ┆ -5.235035    ┆ 2    ┆ 128          │
│ ALPHAUSDT ┆ -5.131417    ┆ 3    ┆ 127          │
│ OXTUSDT   ┆ -4.557284    ┆ 4    ┆ 126          │
│ ACHUSDT   ┆ -4.361308    ┆ 5    ┆ 125          │
│ TRUUSDT   ┆ -3.754454    ┆ 6    ┆ 124          │
│ IOSTUSDT  ┆ -3.729043    ┆ 7    ┆ 123          │
│ IDEXUSDT  ┆ -3.718109    ┆ 8    ┆ 122          │
│ DODOXUSDT ┆ -3.573427    ┆ 9    ┆ 121          │
│ …         ┆ …            ┆ …    ┆ …            │
│ AGLDUSDT  ┆ 2.6426       ┆ 121  ┆ 9            │
│ XTZUSDT   ┆ 2.692983     ┆ 122  ┆ 8            │
│ XEMUSDT   ┆ 2.732776     ┆ 123  ┆ 7            │
│ BATUSDT   ┆ 2.738911     ┆ 124  ┆ 6            │
│ XLMUSDT   ┆ 2.788139     ┆ 125  ┆ 5            │
│ FILUSDT   ┆ 3.203225     ┆ 126  ┆ 4            │
│ RNDRUSDT  ┆ 3.414937     ┆ 127  ┆ 3            │
│ ARPAUSDT  ┆ 5.203033     ┆ 128  ┆ 2            │
│ BLZUSDT   ┆ 5.414668     ┆ 129  ┆ 1            │
│ TLMUSDT   ┆ 7.606084     ┆ 130  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,034 - INFO - cur close time: 2023-10-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:13,034 - DEBUG - mean expected ret (mean factor): 0.00260996250902779
2024-12-12 23:54:13,040 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,040 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,040 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0239      ┆ 0.05801     ┆ 0.0006981   ┆ … ┆ 0.01738 ┆ null   ┆ null    ┆ 0.2253  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,047 - DEBUG - update position: 2023-10-21T23:59:59.999 === diff_trading_value: 339796.8009046456 == cash: 113502.29414755246 
2024-12-12 23:54:13,050 - INFO - pnl: 2023-10-21T23:59:59.999 113502.29414755246 === -1.359%
2024-12-12 23:54:13,051 - DEBUG - cur time: 2023-10-22T23:59:59.999 == next bar open time: 2023-10-23T00:00:00.000 == close pos time: 2023-10-28T00:00:00.000
2024-12-12 23:54:13,055 - INFO - pnl: 2023-10-22T23:59:59.999 114827.38732536577 === 1.167%
2024-12-12 23:54:13,059 - DEBUG - cur time: 2023-10-23T23:59:59.999 == next bar open time: 2023-10-24T00:00:00.000 == close pos time: 2023-10-29T00:00:00.000
2024-12-12 23:54:13,059 - INFO - pnl: 2023-10-23T23:59:59.999 118261.15851259248 === 2.990%
2024-12-12 23:54:13,063 - DEBUG - cur time: 2023-10-24T23:59:59.999 == next bar open time: 2023-10-25T00:00:00.000 == close pos time: 2023-10-30T00:00:00.000
2024-12-12 23:54:13,063 - INFO - pnl: 2023-10-24T23:59:59.999 115007.91149399715 === -2.751%
2024-12-12 23:54:13,070 - DEBUG - cur time: 2023-10-25T23:59:59.999 == next bar open time: 2023-10-26T00:00:00.000 == close pos time: 2023-10-31T00:00:00.000
2024-12-12 23:54:13,070 - INFO - pnl: 2023-10-25T23:59:59.999 114281.63313121672 === -0.632%
2024-12-12 23:54:13,071 - DEBUG - cur time: 2023-10-26T23:59:59.999 == next bar open time: 2023-10-27T00:00:00.000 == close pos time: 2023-11-01T00:00:00.000
2024-12-12 23:54:13,080 - DEBUG - close time 2023-10-26T23:59:59.999 == vol_threshold: 36814804.52
2024-12-12 23:54:13,084 - DEBUG - 2023-10-26T23:59:59.999 == all trade symbol 188 == remain 131 after VOL filter
2024-12-12 23:54:13,084 - DEBUG - sorted_long_factors: shape: (131, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ MAVUSDT       ┆ -4.32565     ┆ 0    ┆ 130          │
│ DODOXUSDT     ┆ -3.499281    ┆ 1    ┆ 129          │
│ OXTUSDT       ┆ -3.041293    ┆ 2    ┆ 128          │
│ KLAYUSDT      ┆ -3.040339    ┆ 3    ┆ 127          │
│ XRPUSDT       ┆ -2.612773    ┆ 4    ┆ 126          │
│ SUIUSDT       ┆ -2.594928    ┆ 5    ┆ 125          │
│ XVGUSDT       ┆ -2.32092     ┆ 6    ┆ 124          │
│ AMBUSDT       ┆ -2.304107    ┆ 7    ┆ 123          │
│ 1000LUNCUSDT  ┆ -2.253704    ┆ 8    ┆ 122          │
│ ANKRUSDT      ┆ -2.234734    ┆ 9    ┆ 121          │
│ …             ┆ …            ┆ …    ┆ …            │
│ FLMUSDT       ┆ 1.883431     ┆ 121  ┆ 9            │
│ CELOUSDT      ┆ 1.922386     ┆ 122  ┆ 8            │
│ ENJUSDT       ┆ 1.966475     ┆ 123  ┆ 7            │
│ MINAUSDT      ┆ 2.122495     ┆ 124  ┆ 6            │
│ BLZUSDT       ┆ 2.242611     ┆ 125  ┆ 5            │
│ AGLDUSDT      ┆ 2.31211      ┆ 126  ┆ 4            │
│ DUSKUSDT      ┆ 2.621968     ┆ 127  ┆ 3            │
│ LQTYUSDT      ┆ 2.738203     ┆ 128  ┆ 2            │
│ JOEUSDT       ┆ 3.177029     ┆ 129  ┆ 1            │
│ 1000FLOKIUSDT ┆ 3.79098      ┆ 130  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,092 - WARNING - 2023-10-26T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,092 - INFO - cur close time: 2023-10-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:13,092 - DEBUG - mean expected ret (mean factor): -0.10113953366653146
2024-12-12 23:54:13,096 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,096 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,096 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03851     ┆ 0.06317     ┆ 0.0012849   ┆ … ┆ 0.01863 ┆ null   ┆ null    ┆ 0.2366  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,101 - DEBUG - update position: 2023-10-26T23:59:59.999 === diff_trading_value: 353829.0491007868 == cash: 114753.5941608062 
2024-12-12 23:54:13,101 - INFO - pnl: 2023-10-26T23:59:59.999 114753.5941608062 === 0.413%
2024-12-12 23:54:13,105 - DEBUG - cur time: 2023-10-27T23:59:59.999 == next bar open time: 2023-10-28T00:00:00.000 == close pos time: 2023-11-02T00:00:00.000
2024-12-12 23:54:13,109 - INFO - pnl: 2023-10-27T23:59:59.999 113608.51777485551 === -0.998%
2024-12-12 23:54:13,109 - DEBUG - cur time: 2023-10-28T23:59:59.999 == next bar open time: 2023-10-29T00:00:00.000 == close pos time: 2023-11-03T00:00:00.000
2024-12-12 23:54:13,114 - INFO - pnl: 2023-10-28T23:59:59.999 112989.50288184622 === -0.545%
2024-12-12 23:54:13,120 - DEBUG - cur time: 2023-10-29T23:59:59.999 == next bar open time: 2023-10-30T00:00:00.000 == close pos time: 2023-11-04T00:00:00.000
2024-12-12 23:54:13,121 - INFO - pnl: 2023-10-29T23:59:59.999 114651.04473589058 === 1.471%
2024-12-12 23:54:13,126 - DEBUG - cur time: 2023-10-30T23:59:59.999 == next bar open time: 2023-10-31T00:00:00.000 == close pos time: 2023-11-05T00:00:00.000
2024-12-12 23:54:13,126 - INFO - pnl: 2023-10-30T23:59:59.999 115444.58479535756 === 0.692%
2024-12-12 23:54:13,130 - DEBUG - cur time: 2023-10-31T23:59:59.999 == next bar open time: 2023-11-01T00:00:00.000 == close pos time: 2023-11-06T00:00:00.000
2024-12-12 23:54:13,143 - DEBUG - close time 2023-10-31T23:59:59.999 == vol_threshold: 28857855.799999997
2024-12-12 23:54:13,143 - DEBUG - 2023-10-31T23:59:59.999 == all trade symbol 190 == remain 133 after VOL filter
2024-12-12 23:54:13,145 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DODOXUSDT    ┆ -4.91265     ┆ 0    ┆ 132          │
│ RVNUSDT      ┆ -4.150544    ┆ 1    ┆ 131          │
│ AMBUSDT      ┆ -3.887566    ┆ 2    ┆ 130          │
│ ALPHAUSDT    ┆ -3.865671    ┆ 3    ┆ 129          │
│ LUNA2USDT    ┆ -3.70878     ┆ 4    ┆ 128          │
│ KEYUSDT      ┆ -3.369999    ┆ 5    ┆ 127          │
│ 1000LUNCUSDT ┆ -3.295888    ┆ 6    ┆ 126          │
│ MAVUSDT      ┆ -3.288525    ┆ 7    ┆ 125          │
│ BELUSDT      ┆ -3.072995    ┆ 8    ┆ 124          │
│ 1000SHIBUSDT ┆ -3.016965    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ONTUSDT      ┆ 3.075275     ┆ 123  ┆ 9            │
│ CRVUSDT      ┆ 3.136926     ┆ 124  ┆ 8            │
│ CHRUSDT      ┆ 3.209759     ┆ 125  ┆ 7            │
│ VETUSDT      ┆ 3.547077     ┆ 126  ┆ 6            │
│ XEMUSDT      ┆ 3.762207     ┆ 127  ┆ 5            │
│ RUNEUSDT     ┆ 4.152134     ┆ 128  ┆ 4            │
│ WLDUSDT      ┆ 4.202268     ┆ 129  ┆ 3            │
│ TRXUSDT      ┆ 4.242514     ┆ 130  ┆ 2            │
│ BLZUSDT      ┆ 4.981905     ┆ 131  ┆ 1            │
│ SUSHIUSDT    ┆ 5.021762     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,150 - WARNING - 2023-10-31T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,150 - INFO - cur close time: 2023-10-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:13,150 - DEBUG - mean expected ret (mean factor): 0.07144620474919948
2024-12-12 23:54:13,155 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,155 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,155 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03258     ┆ 0.06379     ┆ 0.0011465   ┆ … ┆ 0.01897 ┆ null   ┆ null    ┆ 0.2807  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,159 - DEBUG - update position: 2023-10-31T23:59:59.999 === diff_trading_value: 253861.09523215884 == cash: 115722.03503875801 
2024-12-12 23:54:13,163 - INFO - pnl: 2023-10-31T23:59:59.999 115722.03503875801 === 0.240%
2024-12-12 23:54:13,167 - DEBUG - cur time: 2023-11-01T23:59:59.999 == next bar open time: 2023-11-02T00:00:00.000 == close pos time: 2023-11-07T00:00:00.000
2024-12-12 23:54:13,170 - INFO - pnl: 2023-11-01T23:59:59.999 118516.40370013767 === 2.415%
2024-12-12 23:54:13,171 - DEBUG - cur time: 2023-11-02T23:59:59.999 == next bar open time: 2023-11-03T00:00:00.000 == close pos time: 2023-11-08T00:00:00.000
2024-12-12 23:54:13,176 - INFO - pnl: 2023-11-02T23:59:59.999 116626.0753706187 === -1.595%
2024-12-12 23:54:13,180 - DEBUG - cur time: 2023-11-03T23:59:59.999 == next bar open time: 2023-11-04T00:00:00.000 == close pos time: 2023-11-09T00:00:00.000
2024-12-12 23:54:13,180 - INFO - pnl: 2023-11-03T23:59:59.999 118390.82110821009 === 1.513%
2024-12-12 23:54:13,185 - DEBUG - cur time: 2023-11-04T23:59:59.999 == next bar open time: 2023-11-05T00:00:00.000 == close pos time: 2023-11-10T00:00:00.000
2024-12-12 23:54:13,185 - INFO - pnl: 2023-11-04T23:59:59.999 117881.78122925079 === -0.430%
2024-12-12 23:54:13,189 - DEBUG - cur time: 2023-11-05T23:59:59.999 == next bar open time: 2023-11-06T00:00:00.000 == close pos time: 2023-11-11T00:00:00.000
2024-12-12 23:54:13,201 - DEBUG - close time 2023-11-05T23:59:59.999 == vol_threshold: 25904017.619999997
2024-12-12 23:54:13,201 - DEBUG - 2023-11-05T23:59:59.999 == all trade symbol 190 == remain 133 after VOL filter
2024-12-12 23:54:13,201 - DEBUG - sorted_long_factors: shape: (133, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ HFTUSDT     ┆ -5.57727     ┆ 0    ┆ 132          │
│ MDTUSDT     ┆ -5.031233    ┆ 1    ┆ 131          │
│ IDUSDT      ┆ -4.279628    ┆ 2    ┆ 130          │
│ C98USDT     ┆ -4.118627    ┆ 3    ┆ 129          │
│ EDUUSDT     ┆ -3.655857    ┆ 4    ┆ 128          │
│ MAVUSDT     ┆ -3.443951    ┆ 5    ┆ 127          │
│ LUNA2USDT   ┆ -3.216679    ┆ 6    ┆ 126          │
│ IOSTUSDT    ┆ -2.903174    ┆ 7    ┆ 125          │
│ ARKMUSDT    ┆ -2.87283     ┆ 8    ┆ 124          │
│ AMBUSDT     ┆ -2.699501    ┆ 9    ┆ 123          │
│ …           ┆ …            ┆ …    ┆ …            │
│ SPELLUSDT   ┆ 3.293261     ┆ 123  ┆ 9            │
│ EOSUSDT     ┆ 3.360472     ┆ 124  ┆ 8            │
│ 1000XECUSDT ┆ 3.444356     ┆ 125  ┆ 7            │
│ FLOWUSDT    ┆ 3.517532     ┆ 126  ┆ 6            │
│ TRXUSDT     ┆ 3.564272     ┆ 127  ┆ 5            │
│ NEARUSDT    ┆ 3.755562     ┆ 128  ┆ 4            │
│ XEMUSDT     ┆ 3.763737     ┆ 129  ┆ 3            │
│ KLAYUSDT    ┆ 4.444278     ┆ 130  ┆ 2            │
│ BATUSDT     ┆ 4.678779     ┆ 131  ┆ 1            │
│ XTZUSDT     ┆ 5.378694     ┆ 132  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,209 - WARNING - 2023-11-05T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,209 - INFO - cur close time: 2023-11-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:13,209 - DEBUG - mean expected ret (mean factor): 0.14673130379812255
2024-12-12 23:54:13,213 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,213 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,213 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03104     ┆ 0.06495     ┆ 0.0011226   ┆ … ┆ 0.02043 ┆ null   ┆ null    ┆ 0.2668  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,226 - DEBUG - update position: 2023-11-05T23:59:59.999 === diff_trading_value: 291645.57882953365 == cash: 117121.54661812742 
2024-12-12 23:54:13,227 - INFO - pnl: 2023-11-05T23:59:59.999 117121.54661812742 === -0.645%
2024-12-12 23:54:13,233 - DEBUG - cur time: 2023-11-06T23:59:59.999 == next bar open time: 2023-11-07T00:00:00.000 == close pos time: 2023-11-12T00:00:00.000
2024-12-12 23:54:13,233 - INFO - pnl: 2023-11-06T23:59:59.999 113202.22336828883 === -3.346%
2024-12-12 23:54:13,240 - DEBUG - cur time: 2023-11-07T23:59:59.999 == next bar open time: 2023-11-08T00:00:00.000 == close pos time: 2023-11-13T00:00:00.000
2024-12-12 23:54:13,242 - INFO - pnl: 2023-11-07T23:59:59.999 113794.7735243288 === 0.523%
2024-12-12 23:54:13,246 - DEBUG - cur time: 2023-11-08T23:59:59.999 == next bar open time: 2023-11-09T00:00:00.000 == close pos time: 2023-11-14T00:00:00.000
2024-12-12 23:54:13,246 - INFO - pnl: 2023-11-08T23:59:59.999 115624.6528917799 === 1.608%
2024-12-12 23:54:13,250 - DEBUG - cur time: 2023-11-09T23:59:59.999 == next bar open time: 2023-11-10T00:00:00.000 == close pos time: 2023-11-15T00:00:00.000
2024-12-12 23:54:13,250 - INFO - pnl: 2023-11-09T23:59:59.999 117043.19279072809 === 1.227%
2024-12-12 23:54:13,256 - DEBUG - cur time: 2023-11-10T23:59:59.999 == next bar open time: 2023-11-11T00:00:00.000 == close pos time: 2023-11-16T00:00:00.000
2024-12-12 23:54:13,269 - DEBUG - close time 2023-11-10T23:59:59.999 == vol_threshold: 26843505.36
2024-12-12 23:54:13,270 - DEBUG - 2023-11-10T23:59:59.999 == all trade symbol 189 == remain 132 after VOL filter
2024-12-12 23:54:13,272 - DEBUG - sorted_long_factors: shape: (132, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ WAVESUSDT ┆ -10.697505   ┆ 0    ┆ 131          │
│ COTIUSDT  ┆ -6.027698    ┆ 1    ┆ 130          │
│ EDUUSDT   ┆ -5.635732    ┆ 2    ┆ 129          │
│ MDTUSDT   ┆ -5.064082    ┆ 3    ┆ 128          │
│ RDNTUSDT  ┆ -4.738081    ┆ 4    ┆ 127          │
│ LQTYUSDT  ┆ -4.006249    ┆ 5    ┆ 126          │
│ ALPHAUSDT ┆ -3.731043    ┆ 6    ┆ 125          │
│ ACHUSDT   ┆ -3.471404    ┆ 7    ┆ 124          │
│ PERPUSDT  ┆ -3.451845    ┆ 8    ┆ 123          │
│ KEYUSDT   ┆ -3.277818    ┆ 9    ┆ 122          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CHZUSDT   ┆ 4.28005      ┆ 122  ┆ 9            │
│ RUNEUSDT  ┆ 4.397844     ┆ 123  ┆ 8            │
│ SEIUSDT   ┆ 4.51024      ┆ 124  ┆ 7            │
│ STMXUSDT  ┆ 4.553827     ┆ 125  ┆ 6            │
│ RSRUSDT   ┆ 4.589579     ┆ 126  ┆ 5            │
│ EOSUSDT   ┆ 4.99688      ┆ 127  ┆ 4            │
│ XEMUSDT   ┆ 6.03128      ┆ 128  ┆ 3            │
│ ENJUSDT   ┆ 6.153428     ┆ 129  ┆ 2            │
│ ONEUSDT   ┆ 9.574793     ┆ 130  ┆ 1            │
│ DARUSDT   ┆ 14.132025    ┆ 131  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,276 - WARNING - 2023-11-10T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,276 - INFO - cur close time: 2023-11-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:13,276 - DEBUG - mean expected ret (mean factor): 0.6287830752555275
2024-12-12 23:54:13,284 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,284 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,285 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03109     ┆ 0.09132     ┆ 0.0013436   ┆ … ┆ 0.02149 ┆ null   ┆ null    ┆ 0.2881  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,292 - DEBUG - update position: 2023-11-10T23:59:59.999 === diff_trading_value: 314893.15581440844 == cash: 109802.21310873092 
2024-12-12 23:54:13,293 - INFO - pnl: 2023-11-10T23:59:59.999 109802.21310873092 === -6.187%
2024-12-12 23:54:13,298 - DEBUG - cur time: 2023-11-11T23:59:59.999 == next bar open time: 2023-11-12T00:00:00.000 == close pos time: 2023-11-17T00:00:00.000
2024-12-12 23:54:13,299 - INFO - pnl: 2023-11-11T23:59:59.999 112848.64304717466 === 2.774%
2024-12-12 23:54:13,302 - DEBUG - cur time: 2023-11-12T23:59:59.999 == next bar open time: 2023-11-13T00:00:00.000 == close pos time: 2023-11-18T00:00:00.000
2024-12-12 23:54:13,305 - INFO - pnl: 2023-11-12T23:59:59.999 113860.77516600938 === 0.897%
2024-12-12 23:54:13,311 - DEBUG - cur time: 2023-11-13T23:59:59.999 == next bar open time: 2023-11-14T00:00:00.000 == close pos time: 2023-11-19T00:00:00.000
2024-12-12 23:54:13,313 - INFO - pnl: 2023-11-13T23:59:59.999 113751.2834405081 === -0.096%
2024-12-12 23:54:13,317 - DEBUG - cur time: 2023-11-14T23:59:59.999 == next bar open time: 2023-11-15T00:00:00.000 == close pos time: 2023-11-20T00:00:00.000
2024-12-12 23:54:13,318 - INFO - pnl: 2023-11-14T23:59:59.999 112826.88101640865 === -0.813%
2024-12-12 23:54:13,326 - DEBUG - cur time: 2023-11-15T23:59:59.999 == next bar open time: 2023-11-16T00:00:00.000 == close pos time: 2023-11-21T00:00:00.000
2024-12-12 23:54:13,351 - DEBUG - close time 2023-11-15T23:59:59.999 == vol_threshold: 21206984.14
2024-12-12 23:54:13,352 - DEBUG - 2023-11-15T23:59:59.999 == all trade symbol 189 == remain 132 after VOL filter
2024-12-12 23:54:13,355 - DEBUG - sorted_long_factors: shape: (132, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ASTRUSDT    ┆ -6.465009    ┆ 0    ┆ 131          │
│ HFTUSDT     ┆ -5.268155    ┆ 1    ┆ 130          │
│ DUSKUSDT    ┆ -4.593641    ┆ 2    ┆ 129          │
│ ALPHAUSDT   ┆ -4.076098    ┆ 3    ┆ 128          │
│ ROSEUSDT    ┆ -3.531686    ┆ 4    ┆ 127          │
│ MDTUSDT     ┆ -3.504612    ┆ 5    ┆ 126          │
│ LUNA2USDT   ┆ -3.418439    ┆ 6    ┆ 125          │
│ REEFUSDT    ┆ -3.418087    ┆ 7    ┆ 124          │
│ HOOKUSDT    ┆ -3.33826     ┆ 8    ┆ 123          │
│ XRPUSDT     ┆ -3.230297    ┆ 9    ┆ 122          │
│ …           ┆ …            ┆ …    ┆ …            │
│ DODOXUSDT   ┆ 3.0582       ┆ 122  ┆ 9            │
│ ENJUSDT     ┆ 3.098642     ┆ 123  ┆ 8            │
│ 1000XECUSDT ┆ 3.18546      ┆ 124  ┆ 7            │
│ APTUSDT     ┆ 3.243633     ┆ 125  ┆ 6            │
│ XEMUSDT     ┆ 3.265229     ┆ 126  ┆ 5            │
│ TUSDT       ┆ 3.715198     ┆ 127  ┆ 4            │
│ STORJUSDT   ┆ 3.730416     ┆ 128  ┆ 3            │
│ TRXUSDT     ┆ 3.806255     ┆ 129  ┆ 2            │
│ FLMUSDT     ┆ 4.087634     ┆ 130  ┆ 1            │
│ RUNEUSDT    ┆ 4.820165     ┆ 131  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,370 - WARNING - 2023-11-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,370 - INFO - cur close time: 2023-11-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:13,370 - DEBUG - mean expected ret (mean factor): 0.12774692645878571
2024-12-12 23:54:13,380 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,380 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,380 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03618     ┆ 0.08212     ┆ 0.0012561   ┆ … ┆ 0.02206 ┆ null   ┆ null    ┆ 0.5257  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,390 - DEBUG - update position: 2023-11-15T23:59:59.999 === diff_trading_value: 284882.92911365593 == cash: 113060.72024781368 
2024-12-12 23:54:13,393 - INFO - pnl: 2023-11-15T23:59:59.999 113060.72024781368 === 0.207%
2024-12-12 23:54:13,398 - DEBUG - cur time: 2023-11-16T23:59:59.999 == next bar open time: 2023-11-17T00:00:00.000 == close pos time: 2023-11-22T00:00:00.000
2024-12-12 23:54:13,400 - INFO - pnl: 2023-11-16T23:59:59.999 115848.53503790848 === 2.466%
2024-12-12 23:54:13,405 - DEBUG - cur time: 2023-11-17T23:59:59.999 == next bar open time: 2023-11-18T00:00:00.000 == close pos time: 2023-11-23T00:00:00.000
2024-12-12 23:54:13,405 - INFO - pnl: 2023-11-17T23:59:59.999 116470.02915266027 === 0.536%
2024-12-12 23:54:13,409 - DEBUG - cur time: 2023-11-18T23:59:59.999 == next bar open time: 2023-11-19T00:00:00.000 == close pos time: 2023-11-24T00:00:00.000
2024-12-12 23:54:13,411 - INFO - pnl: 2023-11-18T23:59:59.999 116416.05203807523 === -0.046%
2024-12-12 23:54:13,414 - DEBUG - cur time: 2023-11-19T23:59:59.999 == next bar open time: 2023-11-20T00:00:00.000 == close pos time: 2023-11-25T00:00:00.000
2024-12-12 23:54:13,417 - INFO - pnl: 2023-11-19T23:59:59.999 114013.53630435944 === -2.064%
2024-12-12 23:54:13,422 - DEBUG - cur time: 2023-11-20T23:59:59.999 == next bar open time: 2023-11-21T00:00:00.000 == close pos time: 2023-11-26T00:00:00.000
2024-12-12 23:54:13,438 - DEBUG - close time 2023-11-20T23:59:59.999 == vol_threshold: 20147902.08
2024-12-12 23:54:13,439 - DEBUG - 2023-11-20T23:59:59.999 == all trade symbol 189 == remain 132 after VOL filter
2024-12-12 23:54:13,440 - DEBUG - sorted_long_factors: shape: (132, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ DUSKUSDT      ┆ -7.310708    ┆ 0    ┆ 131          │
│ CELRUSDT      ┆ -4.692151    ┆ 1    ┆ 130          │
│ 1000FLOKIUSDT ┆ -4.23577     ┆ 2    ┆ 129          │
│ ARKMUSDT      ┆ -3.988143    ┆ 3    ┆ 128          │
│ FILUSDT       ┆ -3.808824    ┆ 4    ┆ 127          │
│ XRPUSDT       ┆ -3.492321    ┆ 5    ┆ 126          │
│ 1000SHIBUSDT  ┆ -3.489674    ┆ 6    ┆ 125          │
│ STGUSDT       ┆ -3.173141    ┆ 7    ┆ 124          │
│ BELUSDT       ┆ -2.841847    ┆ 8    ┆ 123          │
│ MDTUSDT       ┆ -2.787346    ┆ 9    ┆ 122          │
│ …             ┆ …            ┆ …    ┆ …            │
│ LRCUSDT       ┆ 3.466836     ┆ 122  ┆ 9            │
│ EOSUSDT       ┆ 3.570549     ┆ 123  ┆ 8            │
│ 1000XECUSDT   ┆ 3.733669     ┆ 124  ┆ 7            │
│ IMXUSDT       ┆ 4.102651     ┆ 125  ┆ 6            │
│ RVNUSDT       ┆ 4.26687      ┆ 126  ┆ 5            │
│ TRUUSDT       ┆ 4.435127     ┆ 127  ┆ 4            │
│ ONEUSDT       ┆ 4.574127     ┆ 128  ┆ 3            │
│ STMXUSDT      ┆ 5.088715     ┆ 129  ┆ 2            │
│ ATAUSDT       ┆ 5.26882      ┆ 130  ┆ 1            │
│ SKLUSDT       ┆ 6.100646     ┆ 131  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,452 - WARNING - 2023-11-20T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,452 - INFO - cur close time: 2023-11-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:13,453 - DEBUG - mean expected ret (mean factor): 0.24893120611916633
2024-12-12 23:54:13,456 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,456 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,456 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03097     ┆ 0.07556     ┆ 0.0011312   ┆ … ┆ 0.0221  ┆ null   ┆ null    ┆ 0.3963  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,464 - DEBUG - update position: 2023-11-20T23:59:59.999 === diff_trading_value: 304566.6842015571 == cash: 114484.37300505702 
2024-12-12 23:54:13,465 - INFO - pnl: 2023-11-20T23:59:59.999 114484.37300505702 === 0.413%
2024-12-12 23:54:13,469 - DEBUG - cur time: 2023-11-21T23:59:59.999 == next bar open time: 2023-11-22T00:00:00.000 == close pos time: 2023-11-27T00:00:00.000
2024-12-12 23:54:13,470 - INFO - pnl: 2023-11-21T23:59:59.999 113651.57350167574 === -0.727%
2024-12-12 23:54:13,472 - DEBUG - cur time: 2023-11-22T23:59:59.999 == next bar open time: 2023-11-23T00:00:00.000 == close pos time: 2023-11-28T00:00:00.000
2024-12-12 23:54:13,472 - INFO - pnl: 2023-11-22T23:59:59.999 113500.63305338149 === -0.133%
2024-12-12 23:54:13,475 - DEBUG - cur time: 2023-11-23T23:59:59.999 == next bar open time: 2023-11-24T00:00:00.000 == close pos time: 2023-11-29T00:00:00.000
2024-12-12 23:54:13,475 - INFO - pnl: 2023-11-23T23:59:59.999 113212.97803353403 === -0.253%
2024-12-12 23:54:13,480 - DEBUG - cur time: 2023-11-24T23:59:59.999 == next bar open time: 2023-11-25T00:00:00.000 == close pos time: 2023-11-30T00:00:00.000
2024-12-12 23:54:13,480 - INFO - pnl: 2023-11-24T23:59:59.999 109079.90647210857 === -3.651%
2024-12-12 23:54:13,484 - DEBUG - cur time: 2023-11-25T23:59:59.999 == next bar open time: 2023-11-26T00:00:00.000 == close pos time: 2023-12-01T00:00:00.000
2024-12-12 23:54:13,495 - DEBUG - close time 2023-11-25T23:59:59.999 == vol_threshold: 14298322.06
2024-12-12 23:54:13,495 - DEBUG - 2023-11-25T23:59:59.999 == all trade symbol 189 == remain 132 after VOL filter
2024-12-12 23:54:13,497 - DEBUG - sorted_long_factors: shape: (132, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ RDNTUSDT  ┆ -3.21861     ┆ 0    ┆ 131          │
│ BATUSDT   ┆ -3.191444    ┆ 1    ┆ 130          │
│ CELRUSDT  ┆ -3.035059    ┆ 2    ┆ 129          │
│ WOOUSDT   ┆ -2.990423    ┆ 3    ┆ 128          │
│ NKNUSDT   ┆ -2.789334    ┆ 4    ┆ 127          │
│ ICXUSDT   ┆ -2.529805    ┆ 5    ┆ 126          │
│ DUSKUSDT  ┆ -2.422811    ┆ 6    ┆ 125          │
│ LINAUSDT  ┆ -2.250997    ┆ 7    ┆ 124          │
│ FLMUSDT   ┆ -2.179128    ┆ 8    ┆ 123          │
│ KAVAUSDT  ┆ -2.00422     ┆ 9    ┆ 122          │
│ …         ┆ …            ┆ …    ┆ …            │
│ GMTUSDT   ┆ 1.86715      ┆ 122  ┆ 9            │
│ EOSUSDT   ┆ 1.905095     ┆ 123  ┆ 8            │
│ FLOWUSDT  ┆ 1.985245     ┆ 124  ┆ 7            │
│ WLDUSDT   ┆ 2.332026     ┆ 125  ┆ 6            │
│ ANKRUSDT  ┆ 2.532184     ┆ 126  ┆ 5            │
│ SPELLUSDT ┆ 2.671626     ┆ 127  ┆ 4            │
│ TUSDT     ┆ 2.72227      ┆ 128  ┆ 3            │
│ RNDRUSDT  ┆ 2.773823     ┆ 129  ┆ 2            │
│ TRXUSDT   ┆ 3.312368     ┆ 130  ┆ 1            │
│ DGBUSDT   ┆ 3.965802     ┆ 131  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,501 - WARNING - 2023-11-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,501 - INFO - cur close time: 2023-11-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:13,501 - DEBUG - mean expected ret (mean factor): -0.001802048383592998
2024-12-12 23:54:13,507 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,507 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,507 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03379     ┆ 0.07788     ┆ 0.0011796   ┆ … ┆ 0.02145 ┆ null   ┆ null    ┆ 0.4295  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,513 - DEBUG - update position: 2023-11-25T23:59:59.999 === diff_trading_value: 331321.34992509446 == cash: 110503.46759309563 
2024-12-12 23:54:13,514 - INFO - pnl: 2023-11-25T23:59:59.999 110503.46759309563 === 1.305%
2024-12-12 23:54:13,519 - DEBUG - cur time: 2023-11-26T23:59:59.999 == next bar open time: 2023-11-27T00:00:00.000 == close pos time: 2023-12-02T00:00:00.000
2024-12-12 23:54:13,521 - INFO - pnl: 2023-11-26T23:59:59.999 110161.6883060625 === -0.309%
2024-12-12 23:54:13,521 - DEBUG - cur time: 2023-11-27T23:59:59.999 == next bar open time: 2023-11-28T00:00:00.000 == close pos time: 2023-12-03T00:00:00.000
2024-12-12 23:54:13,525 - INFO - pnl: 2023-11-27T23:59:59.999 109658.58120387941 === -0.457%
2024-12-12 23:54:13,525 - DEBUG - cur time: 2023-11-28T23:59:59.999 == next bar open time: 2023-11-29T00:00:00.000 == close pos time: 2023-12-04T00:00:00.000
2024-12-12 23:54:13,525 - INFO - pnl: 2023-11-28T23:59:59.999 112468.13770913618 === 2.562%
2024-12-12 23:54:13,531 - DEBUG - cur time: 2023-11-29T23:59:59.999 == next bar open time: 2023-11-30T00:00:00.000 == close pos time: 2023-12-05T00:00:00.000
2024-12-12 23:54:13,532 - INFO - pnl: 2023-11-29T23:59:59.999 107633.6750175557 === -4.299%
2024-12-12 23:54:13,535 - DEBUG - cur time: 2023-11-30T23:59:59.999 == next bar open time: 2023-12-01T00:00:00.000 == close pos time: 2023-12-06T00:00:00.000
2024-12-12 23:54:13,548 - DEBUG - close time 2023-11-30T23:59:59.999 == vol_threshold: 14315939.0
2024-12-12 23:54:13,548 - DEBUG - 2023-11-30T23:59:59.999 == all trade symbol 191 == remain 133 after VOL filter
2024-12-12 23:54:13,550 - DEBUG - sorted_long_factors: shape: (133, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ MAGICUSDT     ┆ -7.861581    ┆ 0    ┆ 132          │
│ ONTUSDT       ┆ -7.421944    ┆ 1    ┆ 131          │
│ IDEXUSDT      ┆ -7.131265    ┆ 2    ┆ 130          │
│ DYDXUSDT      ┆ -6.911014    ┆ 3    ┆ 129          │
│ HIFIUSDT      ┆ -5.620619    ┆ 4    ┆ 128          │
│ DUSKUSDT      ┆ -5.532544    ┆ 5    ┆ 127          │
│ IOSTUSDT      ┆ -4.951936    ┆ 6    ┆ 126          │
│ RVNUSDT       ┆ -4.85858     ┆ 7    ┆ 125          │
│ MANAUSDT      ┆ -4.827831    ┆ 8    ┆ 124          │
│ 1000XECUSDT   ┆ -4.63048     ┆ 9    ┆ 123          │
│ …             ┆ …            ┆ …    ┆ …            │
│ INJUSDT       ┆ 5.342967     ┆ 123  ┆ 9            │
│ RUNEUSDT      ┆ 5.581849     ┆ 124  ┆ 8            │
│ DOGEUSDT      ┆ 6.417171     ┆ 125  ┆ 7            │
│ CTSIUSDT      ┆ 6.494117     ┆ 126  ┆ 6            │
│ XVGUSDT       ┆ 6.520156     ┆ 127  ┆ 5            │
│ 1000LUNCUSDT  ┆ 6.731337     ┆ 128  ┆ 4            │
│ JOEUSDT       ┆ 7.068827     ┆ 129  ┆ 3            │
│ ROSEUSDT      ┆ 9.631601     ┆ 130  ┆ 2            │
│ 1000FLOKIUSDT ┆ 10.17902     ┆ 131  ┆ 1            │
│ TRXUSDT       ┆ 20.615712    ┆ 132  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,555 - WARNING - 2023-11-30T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,555 - INFO - cur close time: 2023-11-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:13,555 - DEBUG - mean expected ret (mean factor): 0.5090511924487136
2024-12-12 23:54:13,559 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,559 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 5000.0      ┆ 5000.0      ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,559 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03212     ┆ 0.11749     ┆ 0.0010868   ┆ … ┆ 0.02189 ┆ null   ┆ null    ┆ 0.383   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,570 - DEBUG - update position: 2023-11-30T23:59:59.999 === diff_trading_value: 343853.5953199576 == cash: 107210.31000358635 
2024-12-12 23:54:13,571 - INFO - pnl: 2023-11-30T23:59:59.999 107210.31000358635 === -0.393%
2024-12-12 23:54:13,576 - DEBUG - cur time: 2023-12-01T23:59:59.999 == next bar open time: 2023-12-02T00:00:00.000 == close pos time: 2023-12-07T00:00:00.000
2024-12-12 23:54:13,576 - INFO - pnl: 2023-12-01T23:59:59.999 107853.22359904327 === 0.600%
2024-12-12 23:54:13,581 - DEBUG - cur time: 2023-12-02T23:59:59.999 == next bar open time: 2023-12-03T00:00:00.000 == close pos time: 2023-12-08T00:00:00.000
2024-12-12 23:54:13,586 - INFO - pnl: 2023-12-02T23:59:59.999 108719.24064567404 === 0.803%
2024-12-12 23:54:13,591 - DEBUG - cur time: 2023-12-03T23:59:59.999 == next bar open time: 2023-12-04T00:00:00.000 == close pos time: 2023-12-09T00:00:00.000
2024-12-12 23:54:13,592 - INFO - pnl: 2023-12-03T23:59:59.999 111628.87488588247 === 2.676%
2024-12-12 23:54:13,597 - DEBUG - cur time: 2023-12-04T23:59:59.999 == next bar open time: 2023-12-05T00:00:00.000 == close pos time: 2023-12-10T00:00:00.000
2024-12-12 23:54:13,597 - INFO - pnl: 2023-12-04T23:59:59.999 117028.07832254686 === 4.837%
2024-12-12 23:54:13,601 - DEBUG - cur time: 2023-12-05T23:59:59.999 == next bar open time: 2023-12-06T00:00:00.000 == close pos time: 2023-12-11T00:00:00.000
2024-12-12 23:54:13,614 - DEBUG - close time 2023-12-05T23:59:59.999 == vol_threshold: 27653309.6
2024-12-12 23:54:13,615 - DEBUG - 2023-12-05T23:59:59.999 == all trade symbol 191 == remain 133 after VOL filter
2024-12-12 23:54:13,617 - DEBUG - sorted_long_factors: shape: (133, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ARKUSDT   ┆ -5.452845    ┆ 0    ┆ 132          │
│ ALPHAUSDT ┆ -4.783398    ┆ 1    ┆ 131          │
│ CHZUSDT   ┆ -3.694217    ┆ 2    ┆ 130          │
│ BELUSDT   ┆ -3.02892     ┆ 3    ┆ 129          │
│ ICXUSDT   ┆ -2.947366    ┆ 4    ┆ 128          │
│ CHRUSDT   ┆ -2.65328     ┆ 5    ┆ 127          │
│ WOOUSDT   ┆ -2.588994    ┆ 6    ┆ 126          │
│ KEYUSDT   ┆ -2.452833    ┆ 7    ┆ 125          │
│ ARBUSDT   ┆ -2.326165    ┆ 8    ┆ 124          │
│ DARUSDT   ┆ -2.206059    ┆ 9    ┆ 123          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XLMUSDT   ┆ 2.493184     ┆ 123  ┆ 9            │
│ EOSUSDT   ┆ 2.759475     ┆ 124  ┆ 8            │
│ ZILUSDT   ┆ 2.991841     ┆ 125  ┆ 7            │
│ DENTUSDT  ┆ 3.028565     ┆ 126  ┆ 6            │
│ BLZUSDT   ┆ 3.501425     ┆ 127  ┆ 5            │
│ XEMUSDT   ┆ 3.505401     ┆ 128  ┆ 4            │
│ VETUSDT   ┆ 3.866525     ┆ 129  ┆ 3            │
│ CRVUSDT   ┆ 3.930783     ┆ 130  ┆ 2            │
│ ASTRUSDT  ┆ 4.24824      ┆ 131  ┆ 1            │
│ BAKEUSDT  ┆ 4.461764     ┆ 132  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,621 - WARNING - 2023-12-05T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,621 - INFO - cur close time: 2023-12-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:13,621 - DEBUG - mean expected ret (mean factor): 0.129246445243605
2024-12-12 23:54:13,625 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,625 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,625 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.04247     ┆ 0.22541     ┆ 0.0016203   ┆ … ┆ 0.0234  ┆ null   ┆ null    ┆ 0.4182  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,634 - DEBUG - update position: 2023-12-05T23:59:59.999 === diff_trading_value: 413718.3068870298 == cash: 115180.9577592071 
2024-12-12 23:54:13,635 - INFO - pnl: 2023-12-05T23:59:59.999 115180.9577592071 === -1.578%
2024-12-12 23:54:13,637 - DEBUG - cur time: 2023-12-06T23:59:59.999 == next bar open time: 2023-12-07T00:00:00.000 == close pos time: 2023-12-12T00:00:00.000
2024-12-12 23:54:13,639 - INFO - pnl: 2023-12-06T23:59:59.999 114072.80304317916 === -0.962%
2024-12-12 23:54:13,642 - DEBUG - cur time: 2023-12-07T23:59:59.999 == next bar open time: 2023-12-08T00:00:00.000 == close pos time: 2023-12-13T00:00:00.000
2024-12-12 23:54:13,642 - INFO - pnl: 2023-12-07T23:59:59.999 110560.87384254197 === -3.079%
2024-12-12 23:54:13,648 - DEBUG - cur time: 2023-12-08T23:59:59.999 == next bar open time: 2023-12-09T00:00:00.000 == close pos time: 2023-12-14T00:00:00.000
2024-12-12 23:54:13,648 - INFO - pnl: 2023-12-08T23:59:59.999 111547.40139433897 === 0.892%
2024-12-12 23:54:13,651 - DEBUG - cur time: 2023-12-09T23:59:59.999 == next bar open time: 2023-12-10T00:00:00.000 == close pos time: 2023-12-15T00:00:00.000
2024-12-12 23:54:13,652 - INFO - pnl: 2023-12-09T23:59:59.999 113267.31699236722 === 1.542%
2024-12-12 23:54:13,657 - DEBUG - cur time: 2023-12-10T23:59:59.999 == next bar open time: 2023-12-11T00:00:00.000 == close pos time: 2023-12-16T00:00:00.000
2024-12-12 23:54:13,668 - DEBUG - close time 2023-12-10T23:59:59.999 == vol_threshold: 16672174.319999997
2024-12-12 23:54:13,669 - DEBUG - 2023-12-10T23:59:59.999 == all trade symbol 193 == remain 135 after VOL filter
2024-12-12 23:54:13,671 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ ROSEUSDT ┆ -3.601693    ┆ 0    ┆ 134          │
│ KEYUSDT  ┆ -3.52935     ┆ 1    ┆ 133          │
│ RDNTUSDT ┆ -3.218866    ┆ 2    ┆ 132          │
│ SXPUSDT  ┆ -3.042198    ┆ 3    ┆ 131          │
│ HOOKUSDT ┆ -2.955094    ┆ 4    ┆ 130          │
│ STGUSDT  ┆ -2.855084    ┆ 5    ┆ 129          │
│ EDUUSDT  ┆ -2.824942    ┆ 6    ┆ 128          │
│ IDUSDT   ┆ -2.674836    ┆ 7    ┆ 127          │
│ YGGUSDT  ┆ -2.660571    ┆ 8    ┆ 126          │
│ ZILUSDT  ┆ -2.464303    ┆ 9    ┆ 125          │
│ …        ┆ …            ┆ …    ┆ …            │
│ DOTUSDT  ┆ 2.775499     ┆ 125  ┆ 9            │
│ BNXUSDT  ┆ 2.811764     ┆ 126  ┆ 8            │
│ ONEUSDT  ┆ 2.928056     ┆ 127  ┆ 7            │
│ CRVUSDT  ┆ 3.192911     ┆ 128  ┆ 6            │
│ DENTUSDT ┆ 3.19531      ┆ 129  ┆ 5            │
│ CKBUSDT  ┆ 3.844656     ┆ 130  ┆ 4            │
│ RSRUSDT  ┆ 3.98821      ┆ 131  ┆ 3            │
│ ATAUSDT  ┆ 4.093172     ┆ 132  ┆ 2            │
│ BLZUSDT  ┆ 4.229944     ┆ 133  ┆ 1            │
│ DGBUSDT  ┆ 5.246525     ┆ 134  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,680 - WARNING - 2023-12-10T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,680 - INFO - cur close time: 2023-12-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:13,680 - DEBUG - mean expected ret (mean factor): 0.16377703877428282
2024-12-12 23:54:13,684 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,684 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,684 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0407      ┆ 0.20079     ┆ 0.0016055   ┆ … ┆ 0.02452 ┆ null   ┆ null    ┆ 0.4213  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,691 - DEBUG - update position: 2023-12-10T23:59:59.999 === diff_trading_value: 330636.63230011926 == cash: 112952.55207934872 
2024-12-12 23:54:13,692 - INFO - pnl: 2023-12-10T23:59:59.999 112952.55207934872 === -0.278%
2024-12-12 23:54:13,696 - DEBUG - cur time: 2023-12-11T23:59:59.999 == next bar open time: 2023-12-12T00:00:00.000 == close pos time: 2023-12-17T00:00:00.000
2024-12-12 23:54:13,697 - INFO - pnl: 2023-12-11T23:59:59.999 112711.91322182151 === -0.213%
2024-12-12 23:54:13,701 - DEBUG - cur time: 2023-12-12T23:59:59.999 == next bar open time: 2023-12-13T00:00:00.000 == close pos time: 2023-12-18T00:00:00.000
2024-12-12 23:54:13,701 - INFO - pnl: 2023-12-12T23:59:59.999 111456.98778987653 === -1.113%
2024-12-12 23:54:13,707 - DEBUG - cur time: 2023-12-13T23:59:59.999 == next bar open time: 2023-12-14T00:00:00.000 == close pos time: 2023-12-19T00:00:00.000
2024-12-12 23:54:13,708 - INFO - pnl: 2023-12-13T23:59:59.999 112489.81377895136 === 0.927%
2024-12-12 23:54:13,711 - DEBUG - cur time: 2023-12-14T23:59:59.999 == next bar open time: 2023-12-15T00:00:00.000 == close pos time: 2023-12-20T00:00:00.000
2024-12-12 23:54:13,712 - INFO - pnl: 2023-12-14T23:59:59.999 110295.5174489172 === -1.951%
2024-12-12 23:54:13,716 - DEBUG - cur time: 2023-12-15T23:59:59.999 == next bar open time: 2023-12-16T00:00:00.000 == close pos time: 2023-12-21T00:00:00.000
2024-12-12 23:54:13,726 - DEBUG - close time 2023-12-15T23:59:59.999 == vol_threshold: 18430389.7
2024-12-12 23:54:13,726 - DEBUG - 2023-12-15T23:59:59.999 == all trade symbol 193 == remain 135 after VOL filter
2024-12-12 23:54:13,730 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MAVUSDT      ┆ -3.986336    ┆ 0    ┆ 134          │
│ EDUUSDT      ┆ -3.705003    ┆ 1    ┆ 133          │
│ RDNTUSDT     ┆ -3.246099    ┆ 2    ┆ 132          │
│ CHRUSDT      ┆ -2.831751    ┆ 3    ┆ 131          │
│ HOOKUSDT     ┆ -2.827023    ┆ 4    ┆ 130          │
│ SEIUSDT      ┆ -2.76413     ┆ 5    ┆ 129          │
│ MANAUSDT     ┆ -2.66052     ┆ 6    ┆ 128          │
│ 1000SHIBUSDT ┆ -2.556144    ┆ 7    ┆ 127          │
│ ENJUSDT      ┆ -2.555262    ┆ 8    ┆ 126          │
│ GLMRUSDT     ┆ -2.493298    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ XTZUSDT      ┆ 2.621538     ┆ 125  ┆ 9            │
│ HOTUSDT      ┆ 2.694044     ┆ 126  ┆ 8            │
│ WOOUSDT      ┆ 2.718669     ┆ 127  ┆ 7            │
│ ICPUSDT      ┆ 2.808097     ┆ 128  ┆ 6            │
│ TLMUSDT      ┆ 2.848457     ┆ 129  ┆ 5            │
│ ONTUSDT      ┆ 3.011794     ┆ 130  ┆ 4            │
│ XEMUSDT      ┆ 3.083384     ┆ 131  ┆ 3            │
│ FLOWUSDT     ┆ 3.2546       ┆ 132  ┆ 2            │
│ CTSIUSDT     ┆ 3.255358     ┆ 133  ┆ 1            │
│ ATAUSDT      ┆ 3.482145     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,736 - WARNING - 2023-12-15T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,736 - INFO - cur close time: 2023-12-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:13,736 - DEBUG - mean expected ret (mean factor): -0.07997105624879598
2024-12-12 23:54:13,740 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,740 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,740 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03644     ┆ 0.1662      ┆ 0.0013295   ┆ … ┆ 0.02321 ┆ null   ┆ null    ┆ 0.3731  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,748 - DEBUG - update position: 2023-12-15T23:59:59.999 === diff_trading_value: 302713.0134736324 == cash: 112605.47435267526 
2024-12-12 23:54:13,748 - INFO - pnl: 2023-12-15T23:59:59.999 112605.47435267526 === 2.094%
2024-12-12 23:54:13,754 - DEBUG - cur time: 2023-12-16T23:59:59.999 == next bar open time: 2023-12-17T00:00:00.000 == close pos time: 2023-12-22T00:00:00.000
2024-12-12 23:54:13,755 - INFO - pnl: 2023-12-16T23:59:59.999 109981.72532697234 === -2.330%
2024-12-12 23:54:13,760 - DEBUG - cur time: 2023-12-17T23:59:59.999 == next bar open time: 2023-12-18T00:00:00.000 == close pos time: 2023-12-23T00:00:00.000
2024-12-12 23:54:13,760 - INFO - pnl: 2023-12-17T23:59:59.999 112216.46963167466 === 2.032%
2024-12-12 23:54:13,764 - DEBUG - cur time: 2023-12-18T23:59:59.999 == next bar open time: 2023-12-19T00:00:00.000 == close pos time: 2023-12-24T00:00:00.000
2024-12-12 23:54:13,766 - INFO - pnl: 2023-12-18T23:59:59.999 110595.80217627123 === -1.444%
2024-12-12 23:54:13,770 - DEBUG - cur time: 2023-12-19T23:59:59.999 == next bar open time: 2023-12-20T00:00:00.000 == close pos time: 2023-12-25T00:00:00.000
2024-12-12 23:54:13,772 - INFO - pnl: 2023-12-19T23:59:59.999 107609.89123992852 === -2.700%
2024-12-12 23:54:13,776 - DEBUG - cur time: 2023-12-20T23:59:59.999 == next bar open time: 2023-12-21T00:00:00.000 == close pos time: 2023-12-26T00:00:00.000
2024-12-12 23:54:13,785 - DEBUG - close time 2023-12-20T23:59:59.999 == vol_threshold: 19219231.119999997
2024-12-12 23:54:13,788 - DEBUG - 2023-12-20T23:59:59.999 == all trade symbol 193 == remain 135 after VOL filter
2024-12-12 23:54:13,790 - DEBUG - sorted_long_factors: shape: (135, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ HOOKUSDT  ┆ -4.019892    ┆ 0    ┆ 134          │
│ DUSKUSDT  ┆ -3.655193    ┆ 1    ┆ 133          │
│ RSRUSDT   ┆ -3.370248    ┆ 2    ┆ 132          │
│ EDUUSDT   ┆ -3.347852    ┆ 3    ┆ 131          │
│ DYDXUSDT  ┆ -3.341537    ┆ 4    ┆ 130          │
│ ATAUSDT   ┆ -2.969696    ┆ 5    ┆ 129          │
│ RDNTUSDT  ┆ -2.861939    ┆ 6    ┆ 128          │
│ OCEANUSDT ┆ -2.839406    ┆ 7    ┆ 127          │
│ ICXUSDT   ┆ -2.688829    ┆ 8    ┆ 126          │
│ RVNUSDT   ┆ -2.659195    ┆ 9    ┆ 125          │
│ …         ┆ …            ┆ …    ┆ …            │
│ STORJUSDT ┆ 3.761693     ┆ 125  ┆ 9            │
│ AGLDUSDT  ┆ 4.123779     ┆ 126  ┆ 8            │
│ IMXUSDT   ┆ 4.216579     ┆ 127  ┆ 7            │
│ INJUSDT   ┆ 4.739245     ┆ 128  ┆ 6            │
│ MDTUSDT   ┆ 4.762517     ┆ 129  ┆ 5            │
│ LEVERUSDT ┆ 4.836833     ┆ 130  ┆ 4            │
│ TRUUSDT   ┆ 4.85605      ┆ 131  ┆ 3            │
│ FLMUSDT   ┆ 5.957843     ┆ 132  ┆ 2            │
│ XEMUSDT   ┆ 6.6804       ┆ 133  ┆ 1            │
│ ARPAUSDT  ┆ 8.581651     ┆ 134  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,796 - WARNING - 2023-12-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,796 - INFO - cur close time: 2023-12-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:13,796 - DEBUG - mean expected ret (mean factor): 0.3769466617112041
2024-12-12 23:54:13,800 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,800 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,800 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03453     ┆ 0.15645     ┆ 0.0012704   ┆ … ┆ 0.02327 ┆ null   ┆ null    ┆ 0.3811  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,805 - DEBUG - update position: 2023-12-20T23:59:59.999 === diff_trading_value: 300121.3269603477 == cash: 105713.73841325873 
2024-12-12 23:54:13,806 - INFO - pnl: 2023-12-20T23:59:59.999 105713.73841325873 === -1.762%
2024-12-12 23:54:13,810 - DEBUG - cur time: 2023-12-21T23:59:59.999 == next bar open time: 2023-12-22T00:00:00.000 == close pos time: 2023-12-27T00:00:00.000
2024-12-12 23:54:13,811 - INFO - pnl: 2023-12-21T23:59:59.999 104292.54636691237 === -1.344%
2024-12-12 23:54:13,815 - DEBUG - cur time: 2023-12-22T23:59:59.999 == next bar open time: 2023-12-23T00:00:00.000 == close pos time: 2023-12-28T00:00:00.000
2024-12-12 23:54:13,816 - INFO - pnl: 2023-12-22T23:59:59.999 100411.85885340458 === -3.721%
2024-12-12 23:54:13,819 - DEBUG - cur time: 2023-12-23T23:59:59.999 == next bar open time: 2023-12-24T00:00:00.000 == close pos time: 2023-12-29T00:00:00.000
2024-12-12 23:54:13,820 - INFO - pnl: 2023-12-23T23:59:59.999 101575.70379593206 === 1.159%
2024-12-12 23:54:13,821 - DEBUG - cur time: 2023-12-24T23:59:59.999 == next bar open time: 2023-12-25T00:00:00.000 == close pos time: 2023-12-30T00:00:00.000
2024-12-12 23:54:13,821 - INFO - pnl: 2023-12-24T23:59:59.999 106438.98724029498 === 4.788%
2024-12-12 23:54:13,825 - DEBUG - cur time: 2023-12-25T23:59:59.999 == next bar open time: 2023-12-26T00:00:00.000 == close pos time: 2023-12-31T00:00:00.000
2024-12-12 23:54:13,837 - DEBUG - close time 2023-12-25T23:59:59.999 == vol_threshold: 20287188.2
2024-12-12 23:54:13,837 - DEBUG - 2023-12-25T23:59:59.999 == all trade symbol 197 == remain 138 after VOL filter
2024-12-12 23:54:13,838 - DEBUG - sorted_long_factors: shape: (138, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ IOSTUSDT     ┆ -3.949233    ┆ 0    ┆ 137          │
│ BICOUSDT     ┆ -3.809954    ┆ 1    ┆ 136          │
│ KEYUSDT      ┆ -3.605915    ┆ 2    ┆ 135          │
│ XVGUSDT      ┆ -3.259586    ┆ 3    ┆ 134          │
│ ALPHAUSDT    ┆ -3.033041    ┆ 4    ┆ 133          │
│ SUSHIUSDT    ┆ -2.971341    ┆ 5    ┆ 132          │
│ ATAUSDT      ┆ -2.809472    ┆ 6    ┆ 131          │
│ STORJUSDT    ┆ -2.745791    ┆ 7    ┆ 130          │
│ 1000LUNCUSDT ┆ -2.736719    ┆ 8    ┆ 129          │
│ DYDXUSDT     ┆ -2.733507    ┆ 9    ┆ 128          │
│ …            ┆ …            ┆ …    ┆ …            │
│ NEARUSDT     ┆ 3.018732     ┆ 128  ┆ 9            │
│ SEIUSDT      ┆ 3.071671     ┆ 129  ┆ 8            │
│ THETAUSDT    ┆ 3.28707      ┆ 130  ┆ 7            │
│ JOEUSDT      ┆ 3.430413     ┆ 131  ┆ 6            │
│ BNXUSDT      ┆ 3.704681     ┆ 132  ┆ 5            │
│ XTZUSDT      ┆ 3.762449     ┆ 133  ┆ 4            │
│ EOSUSDT      ┆ 4.15341      ┆ 134  ┆ 3            │
│ OGNUSDT      ┆ 4.447983     ┆ 135  ┆ 2            │
│ STGUSDT      ┆ 5.29307      ┆ 136  ┆ 1            │
│ AGLDUSDT     ┆ 5.316716     ┆ 137  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,842 - WARNING - 2023-12-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,842 - INFO - cur close time: 2023-12-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:13,842 - DEBUG - mean expected ret (mean factor): 0.30627981541054805
2024-12-12 23:54:13,849 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,849 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,849 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03741     ┆ 0.15954     ┆ 0.0014078   ┆ … ┆ 0.02671 ┆ null   ┆ null    ┆ 0.368   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,853 - DEBUG - update position: 2023-12-25T23:59:59.999 === diff_trading_value: 340808.85270966956 == cash: 106895.97293620717 
2024-12-12 23:54:13,855 - INFO - pnl: 2023-12-25T23:59:59.999 106895.97293620717 === 0.429%
2024-12-12 23:54:13,860 - DEBUG - cur time: 2023-12-26T23:59:59.999 == next bar open time: 2023-12-27T00:00:00.000 == close pos time: 2024-01-01T00:00:00.000
2024-12-12 23:54:13,861 - INFO - pnl: 2023-12-26T23:59:59.999 107866.06672131212 === 0.908%
2024-12-12 23:54:13,864 - DEBUG - cur time: 2023-12-27T23:59:59.999 == next bar open time: 2023-12-28T00:00:00.000 == close pos time: 2024-01-02T00:00:00.000
2024-12-12 23:54:13,865 - INFO - pnl: 2023-12-27T23:59:59.999 108484.82231175934 === 0.574%
2024-12-12 23:54:13,870 - DEBUG - cur time: 2023-12-28T23:59:59.999 == next bar open time: 2023-12-29T00:00:00.000 == close pos time: 2024-01-03T00:00:00.000
2024-12-12 23:54:13,871 - INFO - pnl: 2023-12-28T23:59:59.999 106012.05652737943 === -2.279%
2024-12-12 23:54:13,876 - DEBUG - cur time: 2023-12-29T23:59:59.999 == next bar open time: 2023-12-30T00:00:00.000 == close pos time: 2024-01-04T00:00:00.000
2024-12-12 23:54:13,876 - INFO - pnl: 2023-12-29T23:59:59.999 107449.33564283629 === 1.356%
2024-12-12 23:54:13,881 - DEBUG - cur time: 2023-12-30T23:59:59.999 == next bar open time: 2023-12-31T00:00:00.000 == close pos time: 2024-01-05T00:00:00.000
2024-12-12 23:54:13,897 - DEBUG - close time 2023-12-30T23:59:59.999 == vol_threshold: 11091636.4
2024-12-12 23:54:13,899 - DEBUG - 2023-12-30T23:59:59.999 == all trade symbol 201 == remain 140 after VOL filter
2024-12-12 23:54:13,901 - DEBUG - sorted_long_factors: shape: (140, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ KEYUSDT      ┆ -4.78157     ┆ 0    ┆ 139          │
│ BICOUSDT     ┆ -4.567594    ┆ 1    ┆ 138          │
│ FETUSDT      ┆ -4.417311    ┆ 2    ┆ 137          │
│ CHZUSDT      ┆ -4.231299    ┆ 3    ┆ 136          │
│ KAVAUSDT     ┆ -3.437543    ┆ 4    ┆ 135          │
│ ZRXUSDT      ┆ -3.402136    ┆ 5    ┆ 134          │
│ DODOXUSDT    ┆ -3.352237    ┆ 6    ┆ 133          │
│ GLMRUSDT     ┆ -3.127448    ┆ 7    ┆ 132          │
│ 1000SHIBUSDT ┆ -2.869422    ┆ 8    ┆ 131          │
│ BNXUSDT      ┆ -2.836609    ┆ 9    ┆ 130          │
│ …            ┆ …            ┆ …    ┆ …            │
│ STMXUSDT     ┆ 3.21539      ┆ 130  ┆ 9            │
│ ONTUSDT      ┆ 3.353197     ┆ 131  ┆ 8            │
│ KLAYUSDT     ┆ 3.563102     ┆ 132  ┆ 7            │
│ LOOMUSDT     ┆ 4.1371       ┆ 133  ┆ 6            │
│ LINAUSDT     ┆ 4.168244     ┆ 134  ┆ 5            │
│ STPTUSDT     ┆ 4.214441     ┆ 135  ┆ 4            │
│ CTSIUSDT     ┆ 4.262616     ┆ 136  ┆ 3            │
│ WAXPUSDT     ┆ 4.562226     ┆ 137  ┆ 2            │
│ ANKRUSDT     ┆ 6.51348      ┆ 138  ┆ 1            │
│ TLMUSDT      ┆ 8.535505     ┆ 139  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,911 - WARNING - 2023-12-30T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:13,911 - INFO - cur close time: 2023-12-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:13,911 - DEBUG - mean expected ret (mean factor): 0.17970067494140934
2024-12-12 23:54:13,916 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,917 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬─────────┬──────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT  │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---      │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64      │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆         ┆          │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪═════════╪══════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ -10000.0 │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴─────────┴──────────┘
2024-12-12 23:54:13,917 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03515     ┆ 0.14342     ┆ 0.0013091   ┆ … ┆ 0.02501 ┆ null   ┆ null    ┆ 0.3659  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,925 - DEBUG - update position: 2023-12-30T23:59:59.999 === diff_trading_value: 335098.44159128924 == cash: 106345.2392164736 
2024-12-12 23:54:13,928 - INFO - pnl: 2023-12-30T23:59:59.999 106345.2392164736 === -1.028%
2024-12-12 23:54:13,933 - DEBUG - cur time: 2023-12-31T23:59:59.999 == next bar open time: 2024-01-01T00:00:00.000 == close pos time: 2024-01-06T00:00:00.000
2024-12-12 23:54:13,934 - INFO - pnl: 2023-12-31T23:59:59.999 108688.21156069047 === 2.203%
2024-12-12 23:54:13,940 - DEBUG - cur time: 2024-01-01T23:59:59.999 == next bar open time: 2024-01-02T00:00:00.000 == close pos time: 2024-01-07T00:00:00.000
2024-12-12 23:54:13,940 - INFO - pnl: 2024-01-01T23:59:59.999 109714.22988638277 === 0.944%
2024-12-12 23:54:13,942 - DEBUG - cur time: 2024-01-02T23:59:59.999 == next bar open time: 2024-01-03T00:00:00.000 == close pos time: 2024-01-08T00:00:00.000
2024-12-12 23:54:13,947 - INFO - pnl: 2024-01-02T23:59:59.999 109824.61477802428 === 0.101%
2024-12-12 23:54:13,951 - DEBUG - cur time: 2024-01-03T23:59:59.999 == next bar open time: 2024-01-04T00:00:00.000 == close pos time: 2024-01-09T00:00:00.000
2024-12-12 23:54:13,952 - INFO - pnl: 2024-01-03T23:59:59.999 111565.79415424465 === 1.585%
2024-12-12 23:54:13,956 - DEBUG - cur time: 2024-01-04T23:59:59.999 == next bar open time: 2024-01-05T00:00:00.000 == close pos time: 2024-01-10T00:00:00.000
2024-12-12 23:54:13,967 - DEBUG - close time 2024-01-04T23:59:59.999 == vol_threshold: 18117116.959999997
2024-12-12 23:54:13,967 - DEBUG - 2024-01-04T23:59:59.999 == all trade symbol 204 == remain 143 after VOL filter
2024-12-12 23:54:13,970 - DEBUG - sorted_long_factors: shape: (143, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ BLZUSDT  ┆ -7.440855    ┆ 0    ┆ 142          │
│ BATUSDT  ┆ -5.082595    ┆ 1    ┆ 141          │
│ KEYUSDT  ┆ -4.717193    ┆ 2    ┆ 140          │
│ ICXUSDT  ┆ -4.604617    ┆ 3    ┆ 139          │
│ ARKMUSDT ┆ -3.569868    ┆ 4    ┆ 138          │
│ RSRUSDT  ┆ -3.452861    ┆ 5    ┆ 137          │
│ BNXUSDT  ┆ -3.314606    ┆ 6    ┆ 136          │
│ TRUUSDT  ┆ -3.299626    ┆ 7    ┆ 135          │
│ BNTUSDT  ┆ -3.133541    ┆ 8    ┆ 134          │
│ AGIXUSDT ┆ -3.116952    ┆ 9    ┆ 133          │
│ …        ┆ …            ┆ …    ┆ …            │
│ OGNUSDT  ┆ 2.713958     ┆ 133  ┆ 9            │
│ APEUSDT  ┆ 3.126809     ┆ 134  ┆ 8            │
│ TUSDT    ┆ 3.582844     ┆ 135  ┆ 7            │
│ XEMUSDT  ┆ 3.645255     ┆ 136  ┆ 6            │
│ CRVUSDT  ┆ 3.946035     ┆ 137  ┆ 5            │
│ ZILUSDT  ┆ 4.591493     ┆ 138  ┆ 4            │
│ FLOWUSDT ┆ 5.033476     ┆ 139  ┆ 3            │
│ MDTUSDT  ┆ 5.750377     ┆ 140  ┆ 2            │
│ FLMUSDT  ┆ 5.758544     ┆ 141  ┆ 1            │
│ KLAYUSDT ┆ 6.640579     ┆ 142  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:13,976 - INFO - cur close time: 2024-01-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:13,976 - DEBUG - mean expected ret (mean factor): 0.1647758177048517
2024-12-12 23:54:13,981 - DEBUG - begin to update pos: =========
2024-12-12 23:54:13,981 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,981 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03245     ┆ 0.13711     ┆ 0.0012558   ┆ … ┆ 0.02375 ┆ null   ┆ null    ┆ 0.3535  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:13,990 - DEBUG - update position: 2024-01-04T23:59:59.999 === diff_trading_value: 321423.3282149221 == cash: 109470.90087527024 
2024-12-12 23:54:13,992 - INFO - pnl: 2024-01-04T23:59:59.999 109470.90087527024 === -1.878%
2024-12-12 23:54:13,995 - DEBUG - cur time: 2024-01-05T23:59:59.999 == next bar open time: 2024-01-06T00:00:00.000 == close pos time: 2024-01-11T00:00:00.000
2024-12-12 23:54:13,996 - INFO - pnl: 2024-01-05T23:59:59.999 108143.64905719152 === -1.212%
2024-12-12 23:54:13,997 - DEBUG - cur time: 2024-01-06T23:59:59.999 == next bar open time: 2024-01-07T00:00:00.000 == close pos time: 2024-01-12T00:00:00.000
2024-12-12 23:54:14,001 - INFO - pnl: 2024-01-06T23:59:59.999 107434.92659562627 === -0.655%
2024-12-12 23:54:14,001 - DEBUG - cur time: 2024-01-07T23:59:59.999 == next bar open time: 2024-01-08T00:00:00.000 == close pos time: 2024-01-13T00:00:00.000
2024-12-12 23:54:14,005 - INFO - pnl: 2024-01-07T23:59:59.999 107252.23617438872 === -0.170%
2024-12-12 23:54:14,008 - DEBUG - cur time: 2024-01-08T23:59:59.999 == next bar open time: 2024-01-09T00:00:00.000 == close pos time: 2024-01-14T00:00:00.000
2024-12-12 23:54:14,008 - INFO - pnl: 2024-01-08T23:59:59.999 111049.79759493048 === 3.541%
2024-12-12 23:54:14,012 - DEBUG - cur time: 2024-01-09T23:59:59.999 == next bar open time: 2024-01-10T00:00:00.000 == close pos time: 2024-01-15T00:00:00.000
2024-12-12 23:54:14,021 - DEBUG - close time 2024-01-09T23:59:59.999 == vol_threshold: 20721808.859999996
2024-12-12 23:54:14,021 - DEBUG - 2024-01-09T23:59:59.999 == all trade symbol 205 == remain 143 after VOL filter
2024-12-12 23:54:14,021 - DEBUG - sorted_long_factors: shape: (143, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ FILUSDT      ┆ -2.233762    ┆ 0    ┆ 142          │
│ CFXUSDT      ┆ -1.99569     ┆ 1    ┆ 141          │
│ ARBUSDT      ┆ -1.961943    ┆ 2    ┆ 140          │
│ OXTUSDT      ┆ -1.839872    ┆ 3    ┆ 139          │
│ XVGUSDT      ┆ -1.76478     ┆ 4    ┆ 138          │
│ BLZUSDT      ┆ -1.69559     ┆ 5    ┆ 137          │
│ BAKEUSDT     ┆ -1.686635    ┆ 6    ┆ 136          │
│ MDTUSDT      ┆ -1.566779    ┆ 7    ┆ 135          │
│ XRPUSDT      ┆ -1.377895    ┆ 8    ┆ 134          │
│ 1000SHIBUSDT ┆ -1.25757     ┆ 9    ┆ 133          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DENTUSDT     ┆ 0.934502     ┆ 133  ┆ 9            │
│ TRXUSDT      ┆ 0.951782     ┆ 134  ┆ 8            │
│ EDUUSDT      ┆ 0.965144     ┆ 135  ┆ 7            │
│ DUSKUSDT     ┆ 0.982704     ┆ 136  ┆ 6            │
│ KAVAUSDT     ┆ 1.032656     ┆ 137  ┆ 5            │
│ MANAUSDT     ┆ 1.223581     ┆ 138  ┆ 4            │
│ CRVUSDT      ┆ 1.482863     ┆ 139  ┆ 3            │
│ CELOUSDT     ┆ 1.827868     ┆ 140  ┆ 2            │
│ XTZUSDT      ┆ 1.861444     ┆ 141  ┆ 1            │
│ RIFUSDT      ┆ 2.273292     ┆ 142  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,030 - WARNING - 2024-01-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,030 - INFO - cur close time: 2024-01-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:14,030 - DEBUG - mean expected ret (mean factor): -0.08090105355668982
2024-12-12 23:54:14,034 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,034 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,034 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02909     ┆ 0.11731     ┆ 0.0011966   ┆ … ┆ 0.02085 ┆ null   ┆ null    ┆ 0.3241  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,040 - DEBUG - update position: 2024-01-09T23:59:59.999 === diff_trading_value: 294797.6175711029 == cash: 108484.22695139407 
2024-12-12 23:54:14,040 - INFO - pnl: 2024-01-09T23:59:59.999 108484.22695139407 === -2.310%
2024-12-12 23:54:14,043 - DEBUG - cur time: 2024-01-10T23:59:59.999 == next bar open time: 2024-01-11T00:00:00.000 == close pos time: 2024-01-16T00:00:00.000
2024-12-12 23:54:14,046 - INFO - pnl: 2024-01-10T23:59:59.999 107309.90486472928 === -1.082%
2024-12-12 23:54:14,049 - DEBUG - cur time: 2024-01-11T23:59:59.999 == next bar open time: 2024-01-12T00:00:00.000 == close pos time: 2024-01-17T00:00:00.000
2024-12-12 23:54:14,050 - INFO - pnl: 2024-01-11T23:59:59.999 106412.70506311838 === -0.836%
2024-12-12 23:54:14,053 - DEBUG - cur time: 2024-01-12T23:59:59.999 == next bar open time: 2024-01-13T00:00:00.000 == close pos time: 2024-01-18T00:00:00.000
2024-12-12 23:54:14,054 - INFO - pnl: 2024-01-12T23:59:59.999 107560.17648795668 === 1.078%
2024-12-12 23:54:14,055 - DEBUG - cur time: 2024-01-13T23:59:59.999 == next bar open time: 2024-01-14T00:00:00.000 == close pos time: 2024-01-19T00:00:00.000
2024-12-12 23:54:14,055 - INFO - pnl: 2024-01-13T23:59:59.999 108384.26748935458 === 0.766%
2024-12-12 23:54:14,059 - DEBUG - cur time: 2024-01-14T23:59:59.999 == next bar open time: 2024-01-15T00:00:00.000 == close pos time: 2024-01-20T00:00:00.000
2024-12-12 23:54:14,070 - DEBUG - close time 2024-01-14T23:59:59.999 == vol_threshold: 11557362.86
2024-12-12 23:54:14,071 - DEBUG - 2024-01-14T23:59:59.999 == all trade symbol 212 == remain 148 after VOL filter
2024-12-12 23:54:14,073 - DEBUG - sorted_long_factors: shape: (148, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT      ┆ -1.576501    ┆ 0    ┆ 147          │
│ WLDUSDT      ┆ -1.558899    ┆ 1    ┆ 146          │
│ FETUSDT      ┆ -1.414465    ┆ 2    ┆ 145          │
│ OPUSDT       ┆ -1.407073    ┆ 3    ┆ 144          │
│ 1000LUNCUSDT ┆ -1.405711    ┆ 4    ┆ 143          │
│ MASKUSDT     ┆ -1.396306    ┆ 5    ┆ 142          │
│ APTUSDT      ┆ -1.394629    ┆ 6    ┆ 141          │
│ WOOUSDT      ┆ -1.303983    ┆ 7    ┆ 140          │
│ FILUSDT      ┆ -1.302244    ┆ 8    ┆ 139          │
│ ARKMUSDT     ┆ -1.207859    ┆ 9    ┆ 138          │
│ …            ┆ …            ┆ …    ┆ …            │
│ LINAUSDT     ┆ 1.05062      ┆ 138  ┆ 9            │
│ CRVUSDT      ┆ 1.077127     ┆ 139  ┆ 8            │
│ CKBUSDT      ┆ 1.099274     ┆ 140  ┆ 7            │
│ IDEXUSDT     ┆ 1.105529     ┆ 141  ┆ 6            │
│ BATUSDT      ┆ 1.19799      ┆ 142  ┆ 5            │
│ FLOWUSDT     ┆ 1.221961     ┆ 143  ┆ 4            │
│ DENTUSDT     ┆ 1.241387     ┆ 144  ┆ 3            │
│ STMXUSDT     ┆ 1.254414     ┆ 145  ┆ 2            │
│ XEMUSDT      ┆ 1.26648      ┆ 146  ┆ 1            │
│ SPELLUSDT    ┆ 1.432965     ┆ 147  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,080 - WARNING - 2024-01-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,080 - INFO - cur close time: 2024-01-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:14,080 - DEBUG - mean expected ret (mean factor): -0.11076320815702836
2024-12-12 23:54:14,085 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,085 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,085 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03001     ┆ 0.11872     ┆ 0.001194    ┆ … ┆ 0.02128 ┆ null   ┆ null    ┆ 0.331   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,091 - DEBUG - update position: 2024-01-14T23:59:59.999 === diff_trading_value: 321911.3063380078 == cash: 108335.95358843853 
2024-12-12 23:54:14,093 - INFO - pnl: 2024-01-14T23:59:59.999 108335.95358843853 === -0.045%
2024-12-12 23:54:14,097 - DEBUG - cur time: 2024-01-15T23:59:59.999 == next bar open time: 2024-01-16T00:00:00.000 == close pos time: 2024-01-21T00:00:00.000
2024-12-12 23:54:14,099 - INFO - pnl: 2024-01-15T23:59:59.999 108713.90019389224 === 0.349%
2024-12-12 23:54:14,100 - DEBUG - cur time: 2024-01-16T23:59:59.999 == next bar open time: 2024-01-17T00:00:00.000 == close pos time: 2024-01-22T00:00:00.000
2024-12-12 23:54:14,105 - INFO - pnl: 2024-01-16T23:59:59.999 110021.20031923606 === 1.203%
2024-12-12 23:54:14,108 - DEBUG - cur time: 2024-01-17T23:59:59.999 == next bar open time: 2024-01-18T00:00:00.000 == close pos time: 2024-01-23T00:00:00.000
2024-12-12 23:54:14,109 - INFO - pnl: 2024-01-17T23:59:59.999 110472.07273651345 === 0.410%
2024-12-12 23:54:14,112 - DEBUG - cur time: 2024-01-18T23:59:59.999 == next bar open time: 2024-01-19T00:00:00.000 == close pos time: 2024-01-24T00:00:00.000
2024-12-12 23:54:14,114 - INFO - pnl: 2024-01-18T23:59:59.999 112070.8107617907 === 1.447%
2024-12-12 23:54:14,117 - DEBUG - cur time: 2024-01-19T23:59:59.999 == next bar open time: 2024-01-20T00:00:00.000 == close pos time: 2024-01-25T00:00:00.000
2024-12-12 23:54:14,131 - DEBUG - close time 2024-01-19T23:59:59.999 == vol_threshold: 18564059.64
2024-12-12 23:54:14,131 - DEBUG - 2024-01-19T23:59:59.999 == all trade symbol 215 == remain 150 after VOL filter
2024-12-12 23:54:14,133 - DEBUG - sorted_long_factors: shape: (150, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ BLZUSDT    ┆ -5.686537    ┆ 0    ┆ 149          │
│ SNTUSDT    ┆ -4.418296    ┆ 1    ┆ 148          │
│ STRAXUSDT  ┆ -4.023609    ┆ 2    ┆ 147          │
│ FILUSDT    ┆ -3.29505     ┆ 3    ┆ 146          │
│ WOOUSDT    ┆ -3.235346    ┆ 4    ┆ 145          │
│ CFXUSDT    ┆ -3.122656    ┆ 5    ┆ 144          │
│ LDOUSDT    ┆ -3.010477    ┆ 6    ┆ 143          │
│ BNXUSDT    ┆ -2.734621    ┆ 7    ┆ 142          │
│ ORBSUSDT   ┆ -2.704377    ┆ 8    ┆ 141          │
│ IOTXUSDT   ┆ -2.689329    ┆ 9    ┆ 140          │
│ …          ┆ …            ┆ …    ┆ …            │
│ LRCUSDT    ┆ 3.058334     ┆ 140  ┆ 9            │
│ MDTUSDT    ┆ 3.331621     ┆ 141  ┆ 8            │
│ OMGUSDT    ┆ 3.896034     ┆ 142  ┆ 7            │
│ STMXUSDT   ┆ 4.176969     ┆ 143  ┆ 6            │
│ STEEMUSDT  ┆ 4.285749     ┆ 144  ┆ 5            │
│ DGBUSDT    ┆ 4.357055     ┆ 145  ┆ 4            │
│ UMAUSDT    ┆ 4.710346     ┆ 146  ┆ 3            │
│ PENDLEUSDT ┆ 5.184486     ┆ 147  ┆ 2            │
│ TRXUSDT    ┆ 5.862653     ┆ 148  ┆ 1            │
│ BATUSDT    ┆ 8.205711     ┆ 149  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,140 - INFO - cur close time: 2024-01-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:14,140 - DEBUG - mean expected ret (mean factor): 0.1471669193816907
2024-12-12 23:54:14,142 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,142 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,142 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02925     ┆ 0.11057     ┆ 0.0011373   ┆ … ┆ 0.02125 ┆ null   ┆ null    ┆ 0.3178  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,150 - DEBUG - update position: 2024-01-19T23:59:59.999 === diff_trading_value: 316167.21150036243 == cash: 113347.19653719898 
2024-12-12 23:54:14,151 - INFO - pnl: 2024-01-19T23:59:59.999 113347.19653719898 === 1.139%
2024-12-12 23:54:14,155 - DEBUG - cur time: 2024-01-20T23:59:59.999 == next bar open time: 2024-01-21T00:00:00.000 == close pos time: 2024-01-26T00:00:00.000
2024-12-12 23:54:14,155 - INFO - pnl: 2024-01-20T23:59:59.999 114774.9024228229 === 1.260%
2024-12-12 23:54:14,159 - DEBUG - cur time: 2024-01-21T23:59:59.999 == next bar open time: 2024-01-22T00:00:00.000 == close pos time: 2024-01-27T00:00:00.000
2024-12-12 23:54:14,160 - INFO - pnl: 2024-01-21T23:59:59.999 116820.17988977989 === 1.782%
2024-12-12 23:54:14,163 - DEBUG - cur time: 2024-01-22T23:59:59.999 == next bar open time: 2024-01-23T00:00:00.000 == close pos time: 2024-01-28T00:00:00.000
2024-12-12 23:54:14,165 - INFO - pnl: 2024-01-22T23:59:59.999 117548.59070752157 === 0.624%
2024-12-12 23:54:14,167 - DEBUG - cur time: 2024-01-23T23:59:59.999 == next bar open time: 2024-01-24T00:00:00.000 == close pos time: 2024-01-29T00:00:00.000
2024-12-12 23:54:14,168 - INFO - pnl: 2024-01-23T23:59:59.999 117931.06501159322 === 0.325%
2024-12-12 23:54:14,172 - DEBUG - cur time: 2024-01-24T23:59:59.999 == next bar open time: 2024-01-25T00:00:00.000 == close pos time: 2024-01-30T00:00:00.000
2024-12-12 23:54:14,180 - DEBUG - close time 2024-01-24T23:59:59.999 == vol_threshold: 12297215.7
2024-12-12 23:54:14,184 - DEBUG - 2024-01-24T23:59:59.999 == all trade symbol 218 == remain 152 after VOL filter
2024-12-12 23:54:14,185 - DEBUG - sorted_long_factors: shape: (152, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ ACHUSDT  ┆ -5.124559    ┆ 0    ┆ 151          │
│ ORDIUSDT ┆ -4.87362     ┆ 1    ┆ 150          │
│ OMGUSDT  ┆ -4.285973    ┆ 2    ┆ 149          │
│ OXTUSDT  ┆ -4.076619    ┆ 3    ┆ 148          │
│ WAXPUSDT ┆ -3.657167    ┆ 4    ┆ 147          │
│ ORBSUSDT ┆ -3.519839    ┆ 5    ┆ 146          │
│ BLZUSDT  ┆ -3.270456    ┆ 6    ┆ 145          │
│ SNTUSDT  ┆ -3.086074    ┆ 7    ┆ 144          │
│ KAVAUSDT ┆ -2.972883    ┆ 8    ┆ 143          │
│ SLPUSDT  ┆ -2.93841     ┆ 9    ┆ 142          │
│ …        ┆ …            ┆ …    ┆ …            │
│ ANKRUSDT ┆ 3.390361     ┆ 142  ┆ 9            │
│ LINAUSDT ┆ 3.492444     ┆ 143  ┆ 8            │
│ ZRXUSDT  ┆ 3.662485     ┆ 144  ┆ 7            │
│ ONTUSDT  ┆ 3.680057     ┆ 145  ┆ 6            │
│ RSRUSDT  ┆ 3.757841     ┆ 146  ┆ 5            │
│ LOOMUSDT ┆ 4.109981     ┆ 147  ┆ 4            │
│ FLOWUSDT ┆ 4.641323     ┆ 148  ┆ 3            │
│ TRXUSDT  ┆ 5.205944     ┆ 149  ┆ 2            │
│ STGUSDT  ┆ 6.104365     ┆ 150  ┆ 1            │
│ BNXUSDT  ┆ 11.470248    ┆ 151  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,193 - WARNING - 2024-01-24T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,193 - INFO - cur close time: 2024-01-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:14,193 - DEBUG - mean expected ret (mean factor): 0.1255049072666697
2024-12-12 23:54:14,197 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,197 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,197 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02879     ┆ 0.09576     ┆ 0.0010432   ┆ … ┆ 0.02005 ┆ null   ┆ null    ┆ 0.3033  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,205 - DEBUG - update position: 2024-01-24T23:59:59.999 === diff_trading_value: 288589.7444331263 == cash: 118519.7161056606 
2024-12-12 23:54:14,206 - INFO - pnl: 2024-01-24T23:59:59.999 118519.7161056606 === 0.499%
2024-12-12 23:54:14,210 - DEBUG - cur time: 2024-01-25T23:59:59.999 == next bar open time: 2024-01-26T00:00:00.000 == close pos time: 2024-01-31T00:00:00.000
2024-12-12 23:54:14,212 - INFO - pnl: 2024-01-25T23:59:59.999 118368.95556617736 === -0.127%
2024-12-12 23:54:14,215 - DEBUG - cur time: 2024-01-26T23:59:59.999 == next bar open time: 2024-01-27T00:00:00.000 == close pos time: 2024-02-01T00:00:00.000
2024-12-12 23:54:14,216 - INFO - pnl: 2024-01-26T23:59:59.999 117534.67402658607 === -0.705%
2024-12-12 23:54:14,221 - DEBUG - cur time: 2024-01-27T23:59:59.999 == next bar open time: 2024-01-28T00:00:00.000 == close pos time: 2024-02-02T00:00:00.000
2024-12-12 23:54:14,221 - INFO - pnl: 2024-01-27T23:59:59.999 118840.3626506326 === 1.111%
2024-12-12 23:54:14,225 - DEBUG - cur time: 2024-01-28T23:59:59.999 == next bar open time: 2024-01-29T00:00:00.000 == close pos time: 2024-02-03T00:00:00.000
2024-12-12 23:54:14,225 - INFO - pnl: 2024-01-28T23:59:59.999 117694.01625116302 === -0.965%
2024-12-12 23:54:14,230 - DEBUG - cur time: 2024-01-29T23:59:59.999 == next bar open time: 2024-01-30T00:00:00.000 == close pos time: 2024-02-04T00:00:00.000
2024-12-12 23:54:14,242 - DEBUG - close time 2024-01-29T23:59:59.999 == vol_threshold: 10915112.640000002
2024-12-12 23:54:14,242 - DEBUG - 2024-01-29T23:59:59.999 == all trade symbol 220 == remain 154 after VOL filter
2024-12-12 23:54:14,242 - DEBUG - sorted_long_factors: shape: (154, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ALPHAUSDT    ┆ -6.456574    ┆ 0    ┆ 153          │
│ HFTUSDT      ┆ -6.257464    ┆ 1    ┆ 152          │
│ 1000XECUSDT  ┆ -4.245491    ┆ 2    ┆ 151          │
│ 1000LUNCUSDT ┆ -3.747674    ┆ 3    ┆ 150          │
│ XVGUSDT      ┆ -3.611257    ┆ 4    ┆ 149          │
│ ARKMUSDT     ┆ -3.34083     ┆ 5    ┆ 148          │
│ LUNA2USDT    ┆ -2.810706    ┆ 6    ┆ 147          │
│ 1INCHUSDT    ┆ -2.696167    ┆ 7    ┆ 146          │
│ WLDUSDT      ┆ -2.681695    ┆ 8    ┆ 145          │
│ ENJUSDT      ┆ -2.609848    ┆ 9    ┆ 144          │
│ …            ┆ …            ┆ …    ┆ …            │
│ MANAUSDT     ┆ 3.385409     ┆ 144  ┆ 9            │
│ TIAUSDT      ┆ 3.418249     ┆ 145  ┆ 8            │
│ KASUSDT      ┆ 3.449887     ┆ 146  ┆ 7            │
│ CKBUSDT      ┆ 3.521224     ┆ 147  ┆ 6            │
│ FLMUSDT      ┆ 3.649884     ┆ 148  ┆ 5            │
│ DODOXUSDT    ┆ 3.921871     ┆ 149  ┆ 4            │
│ YGGUSDT      ┆ 3.931274     ┆ 150  ┆ 3            │
│ PENDLEUSDT   ┆ 5.056956     ┆ 151  ┆ 2            │
│ DARUSDT      ┆ 7.269152     ┆ 152  ┆ 1            │
│ SNTUSDT      ┆ 9.238633     ┆ 153  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,251 - WARNING - 2024-01-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,251 - INFO - cur close time: 2024-01-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:14,251 - DEBUG - mean expected ret (mean factor): 0.11211395801175483
2024-12-12 23:54:14,255 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,255 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,255 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02917     ┆ 0.10114     ┆ 0.0010647   ┆ … ┆ 0.02086 ┆ null   ┆ null    ┆ 0.3465  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,259 - DEBUG - update position: 2024-01-29T23:59:59.999 === diff_trading_value: 381002.4520353902 == cash: 116992.51930437343 
2024-12-12 23:54:14,263 - INFO - pnl: 2024-01-29T23:59:59.999 116992.51930437343 === -0.596%
2024-12-12 23:54:14,268 - DEBUG - cur time: 2024-01-30T23:59:59.999 == next bar open time: 2024-01-31T00:00:00.000 == close pos time: 2024-02-05T00:00:00.000
2024-12-12 23:54:14,269 - INFO - pnl: 2024-01-30T23:59:59.999 117218.21929072098 === 0.193%
2024-12-12 23:54:14,272 - DEBUG - cur time: 2024-01-31T23:59:59.999 == next bar open time: 2024-02-01T00:00:00.000 == close pos time: 2024-02-06T00:00:00.000
2024-12-12 23:54:14,276 - INFO - pnl: 2024-01-31T23:59:59.999 118095.62231762506 === 0.749%
2024-12-12 23:54:14,280 - DEBUG - cur time: 2024-02-01T23:59:59.999 == next bar open time: 2024-02-02T00:00:00.000 == close pos time: 2024-02-07T00:00:00.000
2024-12-12 23:54:14,282 - INFO - pnl: 2024-02-01T23:59:59.999 118429.48281730356 === 0.283%
2024-12-12 23:54:14,284 - DEBUG - cur time: 2024-02-02T23:59:59.999 == next bar open time: 2024-02-03T00:00:00.000 == close pos time: 2024-02-08T00:00:00.000
2024-12-12 23:54:14,284 - INFO - pnl: 2024-02-02T23:59:59.999 118599.00134408768 === 0.143%
2024-12-12 23:54:14,290 - DEBUG - cur time: 2024-02-03T23:59:59.999 == next bar open time: 2024-02-04T00:00:00.000 == close pos time: 2024-02-09T00:00:00.000
2024-12-12 23:54:14,301 - DEBUG - close time 2024-02-03T23:59:59.999 == vol_threshold: 5967279.8
2024-12-12 23:54:14,301 - DEBUG - 2024-02-03T23:59:59.999 == all trade symbol 222 == remain 155 after VOL filter
2024-12-12 23:54:14,305 - DEBUG - sorted_long_factors: shape: (155, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ RLCUSDT     ┆ -3.626244    ┆ 0    ┆ 154          │
│ DYDXUSDT    ┆ -3.56183     ┆ 1    ┆ 153          │
│ ICXUSDT     ┆ -3.494047    ┆ 2    ┆ 152          │
│ SNTUSDT     ┆ -3.258909    ┆ 3    ┆ 151          │
│ WLDUSDT     ┆ -3.223637    ┆ 4    ┆ 150          │
│ PHBUSDT     ┆ -3.218583    ┆ 5    ┆ 149          │
│ BANDUSDT    ┆ -3.120681    ┆ 6    ┆ 148          │
│ ARKMUSDT    ┆ -2.968208    ┆ 7    ┆ 147          │
│ KASUSDT     ┆ -2.872871    ┆ 8    ┆ 146          │
│ BIGTIMEUSDT ┆ -2.73968     ┆ 9    ┆ 145          │
│ …           ┆ …            ┆ …    ┆ …            │
│ GALUSDT     ┆ 3.04674      ┆ 145  ┆ 9            │
│ ALGOUSDT    ┆ 3.194545     ┆ 146  ┆ 8            │
│ IOSTUSDT    ┆ 3.535333     ┆ 147  ┆ 7            │
│ API3USDT    ┆ 3.942057     ┆ 148  ┆ 6            │
│ SLPUSDT     ┆ 4.418909     ┆ 149  ┆ 5            │
│ TRXUSDT     ┆ 4.708705     ┆ 150  ┆ 4            │
│ XVGUSDT     ┆ 5.929142     ┆ 151  ┆ 3            │
│ PENDLEUSDT  ┆ 5.952415     ┆ 152  ┆ 2            │
│ BATUSDT     ┆ 9.448974     ┆ 153  ┆ 1            │
│ BLZUSDT     ┆ 9.709742     ┆ 154  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,309 - WARNING - 2024-02-03T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,310 - INFO - cur close time: 2024-02-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:14,310 - DEBUG - mean expected ret (mean factor): 0.2604991681584394
2024-12-12 23:54:14,314 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,314 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,314 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.010346    ┆ 0.02806     ┆ 0.11369     ┆ 0.0009241   ┆ … ┆ 0.02022 ┆ null   ┆ null    ┆ 0.3179  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,321 - DEBUG - update position: 2024-02-03T23:59:59.999 === diff_trading_value: 309216.9021955216 == cash: 116535.21243412915 
2024-12-12 23:54:14,322 - INFO - pnl: 2024-02-03T23:59:59.999 116535.21243412915 === -1.740%
2024-12-12 23:54:14,325 - DEBUG - cur time: 2024-02-04T23:59:59.999 == next bar open time: 2024-02-05T00:00:00.000 == close pos time: 2024-02-10T00:00:00.000
2024-12-12 23:54:14,325 - INFO - pnl: 2024-02-04T23:59:59.999 117239.84851542203 === 0.605%
2024-12-12 23:54:14,333 - DEBUG - cur time: 2024-02-05T23:59:59.999 == next bar open time: 2024-02-06T00:00:00.000 == close pos time: 2024-02-11T00:00:00.000
2024-12-12 23:54:14,334 - INFO - pnl: 2024-02-05T23:59:59.999 117260.8035812137 === 0.018%
2024-12-12 23:54:14,337 - DEBUG - cur time: 2024-02-06T23:59:59.999 == next bar open time: 2024-02-07T00:00:00.000 == close pos time: 2024-02-12T00:00:00.000
2024-12-12 23:54:14,338 - INFO - pnl: 2024-02-06T23:59:59.999 117165.89912664448 === -0.081%
2024-12-12 23:54:14,339 - DEBUG - cur time: 2024-02-07T23:59:59.999 == next bar open time: 2024-02-08T00:00:00.000 == close pos time: 2024-02-13T00:00:00.000
2024-12-12 23:54:14,343 - INFO - pnl: 2024-02-07T23:59:59.999 114777.94304786104 === -2.038%
2024-12-12 23:54:14,343 - DEBUG - cur time: 2024-02-08T23:59:59.999 == next bar open time: 2024-02-09T00:00:00.000 == close pos time: 2024-02-14T00:00:00.000
2024-12-12 23:54:14,355 - DEBUG - close time 2024-02-08T23:59:59.999 == vol_threshold: 8989519.95
2024-12-12 23:54:14,359 - DEBUG - 2024-02-08T23:59:59.999 == all trade symbol 226 == remain 158 after VOL filter
2024-12-12 23:54:14,360 - DEBUG - sorted_long_factors: shape: (158, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ STORJUSDT ┆ -4.833511    ┆ 0    ┆ 157          │
│ JASMYUSDT ┆ -4.48502     ┆ 1    ┆ 156          │
│ MDTUSDT   ┆ -4.131478    ┆ 2    ┆ 155          │
│ KLAYUSDT  ┆ -4.065215    ┆ 3    ┆ 154          │
│ ARPAUSDT  ┆ -3.646079    ┆ 4    ┆ 153          │
│ APEUSDT   ┆ -3.246904    ┆ 5    ┆ 152          │
│ DODOXUSDT ┆ -3.132991    ┆ 6    ┆ 151          │
│ FETUSDT   ┆ -3.090532    ┆ 7    ┆ 150          │
│ GTCUSDT   ┆ -3.084999    ┆ 8    ┆ 149          │
│ XRPUSDT   ┆ -2.91506     ┆ 9    ┆ 148          │
│ …         ┆ …            ┆ …    ┆ …            │
│ KASUSDT   ┆ 2.918297     ┆ 148  ┆ 9            │
│ TUSDT     ┆ 3.018891     ┆ 149  ┆ 8            │
│ IDEXUSDT  ┆ 3.091374     ┆ 150  ┆ 7            │
│ STPTUSDT  ┆ 3.45551      ┆ 151  ┆ 6            │
│ STMXUSDT  ┆ 3.901259     ┆ 152  ┆ 5            │
│ BEAMXUSDT ┆ 4.021089     ┆ 153  ┆ 4            │
│ OCEANUSDT ┆ 4.056766     ┆ 154  ┆ 3            │
│ BATUSDT   ┆ 4.773306     ┆ 155  ┆ 2            │
│ BLZUSDT   ┆ 4.903488     ┆ 156  ┆ 1            │
│ CKBUSDT   ┆ 5.3697       ┆ 157  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,368 - WARNING - 2024-02-08T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,368 - INFO - cur close time: 2024-02-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:14,369 - DEBUG - mean expected ret (mean factor): 0.09178358793350709
2024-12-12 23:54:14,372 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,372 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,372 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.010362    ┆ 0.0288      ┆ 0.10738     ┆ 0.0009554   ┆ … ┆ 0.0204  ┆ null   ┆ null    ┆ 0.3163  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,380 - DEBUG - update position: 2024-02-08T23:59:59.999 === diff_trading_value: 357319.5489432574 == cash: 113859.44325753674 
2024-12-12 23:54:14,380 - INFO - pnl: 2024-02-08T23:59:59.999 113859.44325753674 === -0.800%
2024-12-12 23:54:14,384 - DEBUG - cur time: 2024-02-09T23:59:59.999 == next bar open time: 2024-02-10T00:00:00.000 == close pos time: 2024-02-15T00:00:00.000
2024-12-12 23:54:14,388 - INFO - pnl: 2024-02-09T23:59:59.999 114091.9181439701 === 0.204%
2024-12-12 23:54:14,394 - DEBUG - cur time: 2024-02-10T23:59:59.999 == next bar open time: 2024-02-11T00:00:00.000 == close pos time: 2024-02-16T00:00:00.000
2024-12-12 23:54:14,396 - INFO - pnl: 2024-02-10T23:59:59.999 114669.67069267825 === 0.506%
2024-12-12 23:54:14,400 - DEBUG - cur time: 2024-02-11T23:59:59.999 == next bar open time: 2024-02-12T00:00:00.000 == close pos time: 2024-02-17T00:00:00.000
2024-12-12 23:54:14,401 - INFO - pnl: 2024-02-11T23:59:59.999 115607.81960558039 === 0.818%
2024-12-12 23:54:14,405 - DEBUG - cur time: 2024-02-12T23:59:59.999 == next bar open time: 2024-02-13T00:00:00.000 == close pos time: 2024-02-18T00:00:00.000
2024-12-12 23:54:14,407 - INFO - pnl: 2024-02-12T23:59:59.999 116396.16148792523 === 0.682%
2024-12-12 23:54:14,413 - DEBUG - cur time: 2024-02-13T23:59:59.999 == next bar open time: 2024-02-14T00:00:00.000 == close pos time: 2024-02-19T00:00:00.000
2024-12-12 23:54:14,425 - DEBUG - close time 2024-02-13T23:59:59.999 == vol_threshold: 12397616.0
2024-12-12 23:54:14,425 - DEBUG - 2024-02-13T23:59:59.999 == all trade symbol 226 == remain 158 after VOL filter
2024-12-12 23:54:14,430 - DEBUG - sorted_long_factors: shape: (158, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ SNTUSDT   ┆ -5.470589    ┆ 0    ┆ 157          │
│ REEFUSDT  ┆ -3.998821    ┆ 1    ┆ 156          │
│ KNCUSDT   ┆ -3.969565    ┆ 2    ┆ 155          │
│ POLYXUSDT ┆ -3.283036    ┆ 3    ┆ 154          │
│ FILUSDT   ┆ -3.216447    ┆ 4    ┆ 153          │
│ RDNTUSDT  ┆ -2.983972    ┆ 5    ┆ 152          │
│ STGUSDT   ┆ -2.902146    ┆ 6    ┆ 151          │
│ ACHUSDT   ┆ -2.892258    ┆ 7    ┆ 150          │
│ DGBUSDT   ┆ -2.773226    ┆ 8    ┆ 149          │
│ THETAUSDT ┆ -2.727442    ┆ 9    ┆ 148          │
│ …         ┆ …            ┆ …    ┆ …            │
│ MANAUSDT  ┆ 2.196362     ┆ 148  ┆ 9            │
│ DENTUSDT  ┆ 2.263085     ┆ 149  ┆ 8            │
│ TRXUSDT   ┆ 2.307957     ┆ 150  ┆ 7            │
│ DUSKUSDT  ┆ 2.393286     ┆ 151  ┆ 6            │
│ STEEMUSDT ┆ 2.415519     ┆ 152  ┆ 5            │
│ BEAMXUSDT ┆ 3.288991     ┆ 153  ┆ 4            │
│ API3USDT  ┆ 3.391334     ┆ 154  ┆ 3            │
│ IDUSDT    ┆ 3.81533      ┆ 155  ┆ 2            │
│ CKBUSDT   ┆ 4.951        ┆ 156  ┆ 1            │
│ STORJUSDT ┆ 6.391806     ┆ 157  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,435 - WARNING - 2024-02-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,435 - INFO - cur close time: 2024-02-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:14,435 - DEBUG - mean expected ret (mean factor): -0.05526678314861265
2024-12-12 23:54:14,440 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,440 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,440 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.012539    ┆ 0.03216     ┆ 0.1137      ┆ 0.0010838   ┆ … ┆ 0.02125 ┆ null   ┆ null    ┆ 0.3255  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,442 - DEBUG - update position: 2024-02-13T23:59:59.999 === diff_trading_value: 341719.5343225261 == cash: 118114.2977383678 
2024-12-12 23:54:14,446 - INFO - pnl: 2024-02-13T23:59:59.999 118114.2977383678 === 1.476%
2024-12-12 23:54:14,449 - DEBUG - cur time: 2024-02-14T23:59:59.999 == next bar open time: 2024-02-15T00:00:00.000 == close pos time: 2024-02-20T00:00:00.000
2024-12-12 23:54:14,450 - INFO - pnl: 2024-02-14T23:59:59.999 120956.07603745087 === 2.406%
2024-12-12 23:54:14,454 - DEBUG - cur time: 2024-02-15T23:59:59.999 == next bar open time: 2024-02-16T00:00:00.000 == close pos time: 2024-02-21T00:00:00.000
2024-12-12 23:54:14,455 - INFO - pnl: 2024-02-15T23:59:59.999 119919.47999173668 === -0.857%
2024-12-12 23:54:14,460 - DEBUG - cur time: 2024-02-16T23:59:59.999 == next bar open time: 2024-02-17T00:00:00.000 == close pos time: 2024-02-22T00:00:00.000
2024-12-12 23:54:14,460 - INFO - pnl: 2024-02-16T23:59:59.999 117511.12074534252 === -2.008%
2024-12-12 23:54:14,464 - DEBUG - cur time: 2024-02-17T23:59:59.999 == next bar open time: 2024-02-18T00:00:00.000 == close pos time: 2024-02-23T00:00:00.000
2024-12-12 23:54:14,466 - INFO - pnl: 2024-02-17T23:59:59.999 116542.6902295216 === -0.824%
2024-12-12 23:54:14,468 - DEBUG - cur time: 2024-02-18T23:59:59.999 == next bar open time: 2024-02-19T00:00:00.000 == close pos time: 2024-02-24T00:00:00.000
2024-12-12 23:54:14,480 - DEBUG - close time 2024-02-18T23:59:59.999 == vol_threshold: 12896437.4
2024-12-12 23:54:14,480 - DEBUG - 2024-02-18T23:59:59.999 == all trade symbol 227 == remain 159 after VOL filter
2024-12-12 23:54:14,484 - DEBUG - sorted_long_factors: shape: (159, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ LUNA2USDT ┆ -4.637164    ┆ 0    ┆ 158          │
│ MBLUSDT   ┆ -4.201166    ┆ 1    ┆ 157          │
│ XVGUSDT   ┆ -4.13869     ┆ 2    ┆ 156          │
│ DENTUSDT  ┆ -3.966791    ┆ 3    ┆ 155          │
│ BELUSDT   ┆ -3.738135    ┆ 4    ┆ 154          │
│ TRUUSDT   ┆ -3.514019    ┆ 5    ┆ 153          │
│ YGGUSDT   ┆ -3.376721    ┆ 6    ┆ 152          │
│ STEEMUSDT ┆ -3.295128    ┆ 7    ┆ 151          │
│ POLYXUSDT ┆ -3.213153    ┆ 8    ┆ 150          │
│ SANDUSDT  ┆ -2.663286    ┆ 9    ┆ 149          │
│ …         ┆ …            ┆ …    ┆ …            │
│ KEYUSDT   ┆ 2.686628     ┆ 149  ┆ 9            │
│ WLDUSDT   ┆ 2.704084     ┆ 150  ┆ 8            │
│ GALUSDT   ┆ 2.739446     ┆ 151  ┆ 7            │
│ CRVUSDT   ┆ 2.845683     ┆ 152  ┆ 6            │
│ ALGOUSDT  ┆ 2.954051     ┆ 153  ┆ 5            │
│ LEVERUSDT ┆ 2.970474     ┆ 154  ┆ 4            │
│ SUSHIUSDT ┆ 3.331783     ┆ 155  ┆ 3            │
│ GALAUSDT  ┆ 4.216394     ┆ 156  ┆ 2            │
│ DGBUSDT   ┆ 4.923883     ┆ 157  ┆ 1            │
│ CTSIUSDT  ┆ 5.285782     ┆ 158  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,491 - WARNING - 2024-02-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,491 - INFO - cur close time: 2024-02-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:14,491 - DEBUG - mean expected ret (mean factor): 0.07429610298117745
2024-12-12 23:54:14,495 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,495 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,496 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.013057    ┆ 0.03398     ┆ 0.12999     ┆ 0.0012256   ┆ … ┆ 0.02371 ┆ null   ┆ null    ┆ 0.3557  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,501 - DEBUG - update position: 2024-02-18T23:59:59.999 === diff_trading_value: 353748.65922640613 == cash: 117878.06641320996 
2024-12-12 23:54:14,505 - INFO - pnl: 2024-02-18T23:59:59.999 117878.06641320996 === 1.146%
2024-12-12 23:54:14,508 - DEBUG - cur time: 2024-02-19T23:59:59.999 == next bar open time: 2024-02-20T00:00:00.000 == close pos time: 2024-02-25T00:00:00.000
2024-12-12 23:54:14,509 - INFO - pnl: 2024-02-19T23:59:59.999 118575.10937607921 === 0.591%
2024-12-12 23:54:14,512 - DEBUG - cur time: 2024-02-20T23:59:59.999 == next bar open time: 2024-02-21T00:00:00.000 == close pos time: 2024-02-26T00:00:00.000
2024-12-12 23:54:14,514 - INFO - pnl: 2024-02-20T23:59:59.999 117645.49684790855 === -0.784%
2024-12-12 23:54:14,518 - DEBUG - cur time: 2024-02-21T23:59:59.999 == next bar open time: 2024-02-22T00:00:00.000 == close pos time: 2024-02-27T00:00:00.000
2024-12-12 23:54:14,519 - INFO - pnl: 2024-02-21T23:59:59.999 118307.77986804572 === 0.563%
2024-12-12 23:54:14,521 - DEBUG - cur time: 2024-02-22T23:59:59.999 == next bar open time: 2024-02-23T00:00:00.000 == close pos time: 2024-02-28T00:00:00.000
2024-12-12 23:54:14,521 - INFO - pnl: 2024-02-22T23:59:59.999 118715.84291089041 === 0.345%
2024-12-12 23:54:14,526 - DEBUG - cur time: 2024-02-23T23:59:59.999 == next bar open time: 2024-02-24T00:00:00.000 == close pos time: 2024-02-29T00:00:00.000
2024-12-12 23:54:14,540 - DEBUG - close time 2024-02-23T23:59:59.999 == vol_threshold: 17217574.199999996
2024-12-12 23:54:14,540 - DEBUG - 2024-02-23T23:59:59.999 == all trade symbol 228 == remain 159 after VOL filter
2024-12-12 23:54:14,542 - DEBUG - sorted_long_factors: shape: (159, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ LOOMUSDT  ┆ -4.654327    ┆ 0    ┆ 158          │
│ NKNUSDT   ┆ -4.551627    ┆ 1    ┆ 157          │
│ CHRUSDT   ┆ -3.773588    ┆ 2    ┆ 156          │
│ TRUUSDT   ┆ -3.737455    ┆ 3    ┆ 155          │
│ TOKENUSDT ┆ -3.340446    ┆ 4    ┆ 154          │
│ BLURUSDT  ┆ -3.148883    ┆ 5    ┆ 153          │
│ XRPUSDT   ┆ -3.046375    ┆ 6    ┆ 152          │
│ KEYUSDT   ┆ -3.017725    ┆ 7    ┆ 151          │
│ RDNTUSDT  ┆ -2.928693    ┆ 8    ┆ 150          │
│ APEUSDT   ┆ -2.406999    ┆ 9    ┆ 149          │
│ …         ┆ …            ┆ …    ┆ …            │
│ FLOWUSDT  ┆ 3.54666      ┆ 149  ┆ 9            │
│ XEMUSDT   ┆ 3.896309     ┆ 150  ┆ 8            │
│ CELRUSDT  ┆ 4.020691     ┆ 151  ┆ 7            │
│ XTZUSDT   ┆ 4.053623     ┆ 152  ┆ 6            │
│ COTIUSDT  ┆ 4.135562     ┆ 153  ┆ 5            │
│ STEEMUSDT ┆ 4.140456     ┆ 154  ┆ 4            │
│ AMBUSDT   ┆ 4.224818     ┆ 155  ┆ 3            │
│ UNIUSDT   ┆ 4.369308     ┆ 156  ┆ 2            │
│ JASMYUSDT ┆ 4.719241     ┆ 157  ┆ 1            │
│ XVGUSDT   ┆ 5.287839     ┆ 158  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,548 - INFO - cur close time: 2024-02-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:14,548 - DEBUG - mean expected ret (mean factor): 0.3822728463525294
2024-12-12 23:54:14,553 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,553 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,553 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.011334    ┆ 0.0343      ┆ 0.12094     ┆ 0.0011969   ┆ … ┆ 0.02308 ┆ null   ┆ null    ┆ 0.3519  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,559 - DEBUG - update position: 2024-02-23T23:59:59.999 === diff_trading_value: 354347.8044509138 == cash: 117551.81903711283 
2024-12-12 23:54:14,560 - INFO - pnl: 2024-02-23T23:59:59.999 117551.81903711283 === -0.981%
2024-12-12 23:54:14,563 - DEBUG - cur time: 2024-02-24T23:59:59.999 == next bar open time: 2024-02-25T00:00:00.000 == close pos time: 2024-03-01T00:00:00.000
2024-12-12 23:54:14,564 - INFO - pnl: 2024-02-24T23:59:59.999 117888.64392283959 === 0.287%
2024-12-12 23:54:14,568 - DEBUG - cur time: 2024-02-25T23:59:59.999 == next bar open time: 2024-02-26T00:00:00.000 == close pos time: 2024-03-02T00:00:00.000
2024-12-12 23:54:14,570 - INFO - pnl: 2024-02-25T23:59:59.999 121738.3319490122 === 3.266%
2024-12-12 23:54:14,572 - DEBUG - cur time: 2024-02-26T23:59:59.999 == next bar open time: 2024-02-27T00:00:00.000 == close pos time: 2024-03-03T00:00:00.000
2024-12-12 23:54:14,572 - INFO - pnl: 2024-02-26T23:59:59.999 127350.72761902654 === 4.610%
2024-12-12 23:54:14,575 - DEBUG - cur time: 2024-02-27T23:59:59.999 == next bar open time: 2024-02-28T00:00:00.000 == close pos time: 2024-03-04T00:00:00.000
2024-12-12 23:54:14,575 - INFO - pnl: 2024-02-27T23:59:59.999 122322.61552243981 === -3.948%
2024-12-12 23:54:14,580 - DEBUG - cur time: 2024-02-28T23:59:59.999 == next bar open time: 2024-02-29T00:00:00.000 == close pos time: 2024-03-05T00:00:00.000
2024-12-12 23:54:14,592 - DEBUG - close time 2024-02-28T23:59:59.999 == vol_threshold: 30992225.4
2024-12-12 23:54:14,593 - DEBUG - 2024-02-28T23:59:59.999 == all trade symbol 231 == remain 161 after VOL filter
2024-12-12 23:54:14,594 - DEBUG - sorted_long_factors: shape: (161, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SNTUSDT      ┆ -4.29162     ┆ 0    ┆ 160          │
│ BLZUSDT      ┆ -3.648625    ┆ 1    ┆ 159          │
│ CHZUSDT      ┆ -3.100641    ┆ 2    ┆ 158          │
│ APEUSDT      ┆ -2.774925    ┆ 3    ┆ 157          │
│ LEVERUSDT    ┆ -2.746544    ┆ 4    ┆ 156          │
│ REEFUSDT     ┆ -2.631575    ┆ 5    ┆ 155          │
│ JTOUSDT      ┆ -2.588574    ┆ 6    ┆ 154          │
│ JOEUSDT      ┆ -2.584881    ┆ 7    ┆ 153          │
│ MDTUSDT      ┆ -2.51954     ┆ 8    ┆ 152          │
│ IDEXUSDT     ┆ -2.511906    ┆ 9    ┆ 151          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DOGEUSDT     ┆ 3.439906     ┆ 151  ┆ 9            │
│ XEMUSDT      ┆ 3.455098     ┆ 152  ┆ 8            │
│ JASMYUSDT    ┆ 3.544094     ┆ 153  ┆ 7            │
│ ONTUSDT      ┆ 3.697682     ┆ 154  ┆ 6            │
│ SKLUSDT      ┆ 3.735501     ┆ 155  ┆ 5            │
│ ARUSDT       ┆ 3.811611     ┆ 156  ┆ 4            │
│ STGUSDT      ┆ 3.934393     ┆ 157  ┆ 3            │
│ XVGUSDT      ┆ 3.991761     ┆ 158  ┆ 2            │
│ 1000PEPEUSDT ┆ 4.692014     ┆ 159  ┆ 1            │
│ COTIUSDT     ┆ 4.740714     ┆ 160  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,601 - WARNING - 2024-02-28T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,601 - INFO - cur close time: 2024-02-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:14,601 - DEBUG - mean expected ret (mean factor): 0.23386210862758464
2024-12-12 23:54:14,605 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,605 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 5000.0      ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,606 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.01921     ┆ 0.05641     ┆ 0.13846     ┆ 0.0031814   ┆ … ┆ 0.02736 ┆ null   ┆ null    ┆ 0.3691  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,610 - DEBUG - update position: 2024-02-28T23:59:59.999 === diff_trading_value: 334739.1418166751 == cash: 126459.25089094843 
2024-12-12 23:54:14,613 - INFO - pnl: 2024-02-28T23:59:59.999 126459.25089094843 === 3.382%
2024-12-12 23:54:14,617 - DEBUG - cur time: 2024-02-29T23:59:59.999 == next bar open time: 2024-03-01T00:00:00.000 == close pos time: 2024-03-06T00:00:00.000
2024-12-12 23:54:14,618 - INFO - pnl: 2024-02-29T23:59:59.999 121406.17106581457 === -3.996%
2024-12-12 23:54:14,621 - DEBUG - cur time: 2024-03-01T23:59:59.999 == next bar open time: 2024-03-02T00:00:00.000 == close pos time: 2024-03-07T00:00:00.000
2024-12-12 23:54:14,622 - INFO - pnl: 2024-03-01T23:59:59.999 120978.07371325666 === -0.353%
2024-12-12 23:54:14,626 - DEBUG - cur time: 2024-03-02T23:59:59.999 == next bar open time: 2024-03-03T00:00:00.000 == close pos time: 2024-03-08T00:00:00.000
2024-12-12 23:54:14,626 - INFO - pnl: 2024-03-02T23:59:59.999 120176.6951163366 === -0.662%
2024-12-12 23:54:14,631 - DEBUG - cur time: 2024-03-03T23:59:59.999 == next bar open time: 2024-03-04T00:00:00.000 == close pos time: 2024-03-09T00:00:00.000
2024-12-12 23:54:14,632 - INFO - pnl: 2024-03-03T23:59:59.999 124740.89997132061 === 3.798%
2024-12-12 23:54:14,636 - DEBUG - cur time: 2024-03-04T23:59:59.999 == next bar open time: 2024-03-05T00:00:00.000 == close pos time: 2024-03-10T00:00:00.000
2024-12-12 23:54:14,648 - DEBUG - close time 2024-03-04T23:59:59.999 == vol_threshold: 23155322.0
2024-12-12 23:54:14,650 - DEBUG - 2024-03-04T23:59:59.999 == all trade symbol 231 == remain 161 after VOL filter
2024-12-12 23:54:14,651 - DEBUG - sorted_long_factors: shape: (161, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BICOUSDT  ┆ -3.922552    ┆ 0    ┆ 160          │
│ RDNTUSDT  ┆ -3.549351    ┆ 1    ┆ 159          │
│ USTCUSDT  ┆ -2.991215    ┆ 2    ┆ 158          │
│ STGUSDT   ┆ -2.931922    ┆ 3    ┆ 157          │
│ ORBSUSDT  ┆ -2.928871    ┆ 4    ┆ 156          │
│ MAGICUSDT ┆ -2.912549    ┆ 5    ┆ 155          │
│ ARBUSDT   ┆ -2.907398    ┆ 6    ┆ 154          │
│ NTRNUSDT  ┆ -2.801919    ┆ 7    ┆ 153          │
│ RSRUSDT   ┆ -2.673989    ┆ 8    ┆ 152          │
│ CHRUSDT   ┆ -2.629675    ┆ 9    ┆ 151          │
│ …         ┆ …            ┆ …    ┆ …            │
│ FLOWUSDT  ┆ 2.832734     ┆ 151  ┆ 9            │
│ DARUSDT   ┆ 2.991749     ┆ 152  ┆ 8            │
│ EOSUSDT   ┆ 3.422953     ┆ 153  ┆ 7            │
│ STMXUSDT  ┆ 3.459304     ┆ 154  ┆ 6            │
│ TUSDT     ┆ 3.527766     ┆ 155  ┆ 5            │
│ TRXUSDT   ┆ 4.968696     ┆ 156  ┆ 4            │
│ KLAYUSDT  ┆ 4.995443     ┆ 157  ┆ 3            │
│ CELOUSDT  ┆ 4.996273     ┆ 158  ┆ 2            │
│ DUSKUSDT  ┆ 6.443114     ┆ 159  ┆ 1            │
│ BLZUSDT   ┆ 13.47459     ┆ 160  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,660 - WARNING - 2024-03-04T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,660 - INFO - cur close time: 2024-03-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:14,660 - DEBUG - mean expected ret (mean factor): 0.24840715475680347
2024-12-12 23:54:14,664 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,664 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 5000.0      ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,664 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.03773     ┆ 0.14442     ┆ 0.18382     ┆ 0.0070293   ┆ … ┆ 0.03231 ┆ null   ┆ null    ┆ 0.4431  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,670 - DEBUG - update position: 2024-03-04T23:59:59.999 === diff_trading_value: 399962.8424815815 == cash: 127210.84927752356 
2024-12-12 23:54:14,672 - INFO - pnl: 2024-03-04T23:59:59.999 127210.84927752356 === 1.980%
2024-12-12 23:54:14,675 - DEBUG - cur time: 2024-03-05T23:59:59.999 == next bar open time: 2024-03-06T00:00:00.000 == close pos time: 2024-03-11T00:00:00.000
2024-12-12 23:54:14,675 - INFO - pnl: 2024-03-05T23:59:59.999 120248.67045491507 === -5.473%
2024-12-12 23:54:14,680 - DEBUG - cur time: 2024-03-06T23:59:59.999 == next bar open time: 2024-03-07T00:00:00.000 == close pos time: 2024-03-12T00:00:00.000
2024-12-12 23:54:14,680 - INFO - pnl: 2024-03-06T23:59:59.999 118843.90561679937 === -1.168%
2024-12-12 23:54:14,683 - DEBUG - cur time: 2024-03-07T23:59:59.999 == next bar open time: 2024-03-08T00:00:00.000 == close pos time: 2024-03-13T00:00:00.000
2024-12-12 23:54:14,683 - INFO - pnl: 2024-03-07T23:59:59.999 121230.47044499544 === 2.008%
2024-12-12 23:54:14,690 - DEBUG - cur time: 2024-03-08T23:59:59.999 == next bar open time: 2024-03-09T00:00:00.000 == close pos time: 2024-03-14T00:00:00.000
2024-12-12 23:54:14,692 - INFO - pnl: 2024-03-08T23:59:59.999 124688.45624583717 === 2.852%
2024-12-12 23:54:14,697 - DEBUG - cur time: 2024-03-09T23:59:59.999 == next bar open time: 2024-03-10T00:00:00.000 == close pos time: 2024-03-15T00:00:00.000
2024-12-12 23:54:14,710 - DEBUG - close time 2024-03-09T23:59:59.999 == vol_threshold: 16489131.9
2024-12-12 23:54:14,710 - DEBUG - 2024-03-09T23:59:59.999 == all trade symbol 232 == remain 162 after VOL filter
2024-12-12 23:54:14,713 - DEBUG - sorted_long_factors: shape: (162, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TRUUSDT      ┆ -4.41983     ┆ 0    ┆ 161          │
│ SNTUSDT      ┆ -4.326594    ┆ 1    ┆ 160          │
│ USTCUSDT     ┆ -3.791989    ┆ 2    ┆ 159          │
│ 1000RATSUSDT ┆ -3.5379      ┆ 3    ┆ 158          │
│ CHZUSDT      ┆ -3.214838    ┆ 4    ┆ 157          │
│ MAVUSDT      ┆ -3.21301     ┆ 5    ┆ 156          │
│ OXTUSDT      ┆ -3.157166    ┆ 6    ┆ 155          │
│ CFXUSDT      ┆ -3.015234    ┆ 7    ┆ 154          │
│ THETAUSDT    ┆ -2.959595    ┆ 8    ┆ 153          │
│ IOSTUSDT     ┆ -2.784471    ┆ 9    ┆ 152          │
│ …            ┆ …            ┆ …    ┆ …            │
│ XVGUSDT      ┆ 3.494399     ┆ 152  ┆ 9            │
│ XEMUSDT      ┆ 3.527611     ┆ 153  ┆ 8            │
│ EOSUSDT      ┆ 3.76761      ┆ 154  ┆ 7            │
│ STMXUSDT     ┆ 3.920018     ┆ 155  ┆ 6            │
│ BLZUSDT      ┆ 4.012691     ┆ 156  ┆ 5            │
│ SUPERUSDT    ┆ 4.130204     ┆ 157  ┆ 4            │
│ ATAUSDT      ┆ 4.799154     ┆ 158  ┆ 3            │
│ VETUSDT      ┆ 5.104936     ┆ 159  ┆ 2            │
│ CELOUSDT     ┆ 5.376353     ┆ 160  ┆ 1            │
│ KLAYUSDT     ┆ 6.149131     ┆ 161  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,722 - WARNING - 2024-03-09T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,722 - INFO - cur close time: 2024-03-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:14,722 - DEBUG - mean expected ret (mean factor): 0.2847928552272129
2024-12-12 23:54:14,725 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,725 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,725 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.0339      ┆ 0.23886     ┆ 0.1965      ┆ 0.008774    ┆ … ┆ 0.03521 ┆ null   ┆ null    ┆ 0.5785  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,734 - DEBUG - update position: 2024-03-09T23:59:59.999 === diff_trading_value: 315726.17302246316 == cash: 124067.04091788553 
2024-12-12 23:54:14,735 - INFO - pnl: 2024-03-09T23:59:59.999 124067.04091788553 === -0.498%
2024-12-12 23:54:14,739 - DEBUG - cur time: 2024-03-10T23:59:59.999 == next bar open time: 2024-03-11T00:00:00.000 == close pos time: 2024-03-16T00:00:00.000
2024-12-12 23:54:14,740 - INFO - pnl: 2024-03-10T23:59:59.999 123625.62400561922 === -0.356%
2024-12-12 23:54:14,742 - DEBUG - cur time: 2024-03-11T23:59:59.999 == next bar open time: 2024-03-12T00:00:00.000 == close pos time: 2024-03-17T00:00:00.000
2024-12-12 23:54:14,742 - INFO - pnl: 2024-03-11T23:59:59.999 126429.55792440305 === 2.268%
2024-12-12 23:54:14,748 - DEBUG - cur time: 2024-03-12T23:59:59.999 == next bar open time: 2024-03-13T00:00:00.000 == close pos time: 2024-03-18T00:00:00.000
2024-12-12 23:54:14,749 - INFO - pnl: 2024-03-12T23:59:59.999 128275.4868943503 === 1.460%
2024-12-12 23:54:14,752 - DEBUG - cur time: 2024-03-13T23:59:59.999 == next bar open time: 2024-03-14T00:00:00.000 == close pos time: 2024-03-19T00:00:00.000
2024-12-12 23:54:14,754 - INFO - pnl: 2024-03-13T23:59:59.999 128102.30950435702 === -0.135%
2024-12-12 23:54:14,755 - DEBUG - cur time: 2024-03-14T23:59:59.999 == next bar open time: 2024-03-15T00:00:00.000 == close pos time: 2024-03-20T00:00:00.000
2024-12-12 23:54:14,767 - DEBUG - close time 2024-03-14T23:59:59.999 == vol_threshold: 20209592.429999996
2024-12-12 23:54:14,768 - DEBUG - 2024-03-14T23:59:59.999 == all trade symbol 232 == remain 162 after VOL filter
2024-12-12 23:54:14,770 - DEBUG - sorted_long_factors: shape: (162, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XVGUSDT      ┆ -4.176797    ┆ 0    ┆ 161          │
│ KASUSDT      ┆ -3.900356    ┆ 1    ┆ 160          │
│ DUSKUSDT     ┆ -3.681851    ┆ 2    ┆ 159          │
│ 1000RATSUSDT ┆ -3.662337    ┆ 3    ┆ 158          │
│ ONGUSDT      ┆ -3.522912    ┆ 4    ┆ 157          │
│ SNTUSDT      ┆ -3.328577    ┆ 5    ┆ 156          │
│ MINAUSDT     ┆ -3.265978    ┆ 6    ┆ 155          │
│ CTSIUSDT     ┆ -3.200095    ┆ 7    ┆ 154          │
│ 1000SATSUSDT ┆ -2.886235    ┆ 8    ┆ 153          │
│ CHZUSDT      ┆ -2.754088    ┆ 9    ┆ 152          │
│ …            ┆ …            ┆ …    ┆ …            │
│ STEEMUSDT    ┆ 2.915474     ┆ 152  ┆ 9            │
│ ATAUSDT      ┆ 2.976464     ┆ 153  ┆ 8            │
│ COTIUSDT     ┆ 3.025145     ┆ 154  ┆ 7            │
│ BNXUSDT      ┆ 3.776022     ┆ 155  ┆ 6            │
│ ONEUSDT      ┆ 3.806168     ┆ 156  ┆ 5            │
│ HIFIUSDT     ┆ 4.404157     ┆ 157  ┆ 4            │
│ OGNUSDT      ┆ 4.48385      ┆ 158  ┆ 3            │
│ TRXUSDT      ┆ 4.539368     ┆ 159  ┆ 2            │
│ ZRXUSDT      ┆ 4.932479     ┆ 160  ┆ 1            │
│ MDTUSDT      ┆ 6.739512     ┆ 161  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,775 - WARNING - 2024-03-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,775 - INFO - cur close time: 2024-03-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:14,775 - DEBUG - mean expected ret (mean factor): 0.06173198809453876
2024-12-12 23:54:14,780 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,784 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,784 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.034127    ┆ 0.27812     ┆ 0.17538     ┆ 0.0099683   ┆ … ┆ 0.03943 ┆ null   ┆ null    ┆ 1.3411  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,789 - DEBUG - update position: 2024-03-14T23:59:59.999 === diff_trading_value: 311896.17391339684 == cash: 127201.78496642392 
2024-12-12 23:54:14,791 - INFO - pnl: 2024-03-14T23:59:59.999 127201.78496642392 === -0.703%
2024-12-12 23:54:14,794 - DEBUG - cur time: 2024-03-15T23:59:59.999 == next bar open time: 2024-03-16T00:00:00.000 == close pos time: 2024-03-21T00:00:00.000
2024-12-12 23:54:14,796 - INFO - pnl: 2024-03-15T23:59:59.999 129509.35399814727 === 1.814%
2024-12-12 23:54:14,800 - DEBUG - cur time: 2024-03-16T23:59:59.999 == next bar open time: 2024-03-17T00:00:00.000 == close pos time: 2024-03-22T00:00:00.000
2024-12-12 23:54:14,800 - INFO - pnl: 2024-03-16T23:59:59.999 130560.38301162317 === 0.812%
2024-12-12 23:54:14,800 - DEBUG - cur time: 2024-03-17T23:59:59.999 == next bar open time: 2024-03-18T00:00:00.000 == close pos time: 2024-03-23T00:00:00.000
2024-12-12 23:54:14,806 - INFO - pnl: 2024-03-17T23:59:59.999 131251.8624349305 === 0.530%
2024-12-12 23:54:14,809 - DEBUG - cur time: 2024-03-18T23:59:59.999 == next bar open time: 2024-03-19T00:00:00.000 == close pos time: 2024-03-24T00:00:00.000
2024-12-12 23:54:14,809 - INFO - pnl: 2024-03-18T23:59:59.999 131242.7696470701 === -0.007%
2024-12-12 23:54:14,813 - DEBUG - cur time: 2024-03-19T23:59:59.999 == next bar open time: 2024-03-20T00:00:00.000 == close pos time: 2024-03-25T00:00:00.000
2024-12-12 23:54:14,822 - DEBUG - close time 2024-03-19T23:59:59.999 == vol_threshold: 29386845.999999996
2024-12-12 23:54:14,822 - DEBUG - 2024-03-19T23:59:59.999 == all trade symbol 233 == remain 163 after VOL filter
2024-12-12 23:54:14,826 - DEBUG - sorted_long_factors: shape: (163, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000RATSUSDT ┆ -4.903113    ┆ 0    ┆ 162          │
│ PYTHUSDT     ┆ -4.681712    ┆ 1    ┆ 161          │
│ NFPUSDT      ┆ -3.862018    ┆ 2    ┆ 160          │
│ DYDXUSDT     ┆ -3.087893    ┆ 3    ┆ 159          │
│ WLDUSDT      ┆ -3.084921    ┆ 4    ┆ 158          │
│ BIGTIMEUSDT  ┆ -2.969453    ┆ 5    ┆ 157          │
│ XRPUSDT      ┆ -2.966861    ┆ 6    ┆ 156          │
│ DENTUSDT     ┆ -2.885548    ┆ 7    ┆ 155          │
│ ARKMUSDT     ┆ -2.799831    ┆ 8    ┆ 154          │
│ GLMRUSDT     ┆ -2.721236    ┆ 9    ┆ 153          │
│ …            ┆ …            ┆ …    ┆ …            │
│ MBLUSDT      ┆ 3.357284     ┆ 153  ┆ 9            │
│ STPTUSDT     ┆ 3.433238     ┆ 154  ┆ 8            │
│ STEEMUSDT    ┆ 3.968115     ┆ 155  ┆ 7            │
│ IDUSDT       ┆ 3.985297     ┆ 156  ┆ 6            │
│ SNTUSDT      ┆ 4.117624     ┆ 157  ┆ 5            │
│ XTZUSDT      ┆ 4.134651     ┆ 158  ┆ 4            │
│ ZRXUSDT      ┆ 4.508505     ┆ 159  ┆ 3            │
│ FLOWUSDT     ┆ 4.836698     ┆ 160  ┆ 2            │
│ NKNUSDT      ┆ 4.950934     ┆ 161  ┆ 1            │
│ DODOXUSDT    ┆ 8.29319      ┆ 162  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,832 - WARNING - 2024-03-19T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,832 - INFO - cur close time: 2024-03-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:14,832 - DEBUG - mean expected ret (mean factor): 0.12074082822555252
2024-12-12 23:54:14,836 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,836 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,836 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.021598    ┆ 0.1772      ┆ 0.12732     ┆ 0.0066026   ┆ … ┆ 0.03084 ┆ null   ┆ null    ┆ 1.1389  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,839 - DEBUG - update position: 2024-03-19T23:59:59.999 === diff_trading_value: 276091.7100356899 == cash: 130493.58265519976 
2024-12-12 23:54:14,842 - INFO - pnl: 2024-03-19T23:59:59.999 130493.58265519976 === -0.571%
2024-12-12 23:54:14,846 - DEBUG - cur time: 2024-03-20T23:59:59.999 == next bar open time: 2024-03-21T00:00:00.000 == close pos time: 2024-03-26T00:00:00.000
2024-12-12 23:54:14,847 - INFO - pnl: 2024-03-20T23:59:59.999 129700.62485549078 === -0.608%
2024-12-12 23:54:14,850 - DEBUG - cur time: 2024-03-21T23:59:59.999 == next bar open time: 2024-03-22T00:00:00.000 == close pos time: 2024-03-27T00:00:00.000
2024-12-12 23:54:14,851 - INFO - pnl: 2024-03-21T23:59:59.999 129121.17474232506 === -0.447%
2024-12-12 23:54:14,854 - DEBUG - cur time: 2024-03-22T23:59:59.999 == next bar open time: 2024-03-23T00:00:00.000 == close pos time: 2024-03-28T00:00:00.000
2024-12-12 23:54:14,855 - INFO - pnl: 2024-03-22T23:59:59.999 129428.59545615216 === 0.238%
2024-12-12 23:54:14,860 - DEBUG - cur time: 2024-03-23T23:59:59.999 == next bar open time: 2024-03-24T00:00:00.000 == close pos time: 2024-03-29T00:00:00.000
2024-12-12 23:54:14,860 - INFO - pnl: 2024-03-23T23:59:59.999 130163.69796793105 === 0.568%
2024-12-12 23:54:14,864 - DEBUG - cur time: 2024-03-24T23:59:59.999 == next bar open time: 2024-03-25T00:00:00.000 == close pos time: 2024-03-30T00:00:00.000
2024-12-12 23:54:14,876 - DEBUG - close time 2024-03-24T23:59:59.999 == vol_threshold: 10985589.599999996
2024-12-12 23:54:14,876 - DEBUG - 2024-03-24T23:59:59.999 == all trade symbol 232 == remain 162 after VOL filter
2024-12-12 23:54:14,876 - DEBUG - sorted_long_factors: shape: (162, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AIUSDT       ┆ -4.139843    ┆ 0    ┆ 161          │
│ BLZUSDT      ┆ -4.102663    ┆ 1    ┆ 160          │
│ BIGTIMEUSDT  ┆ -3.800146    ┆ 2    ┆ 159          │
│ 1000SATSUSDT ┆ -3.524079    ┆ 3    ┆ 158          │
│ CHZUSDT      ┆ -3.342212    ┆ 4    ┆ 157          │
│ NFPUSDT      ┆ -3.143707    ┆ 5    ┆ 156          │
│ WLDUSDT      ┆ -3.078332    ┆ 6    ┆ 155          │
│ JASMYUSDT    ┆ -2.696888    ┆ 7    ┆ 154          │
│ 1000RATSUSDT ┆ -2.665207    ┆ 8    ┆ 153          │
│ XRPUSDT      ┆ -2.661005    ┆ 9    ┆ 152          │
│ …            ┆ …            ┆ …    ┆ …            │
│ NKNUSDT      ┆ 2.881686     ┆ 152  ┆ 9            │
│ OGNUSDT      ┆ 3.307359     ┆ 153  ┆ 8            │
│ CRVUSDT      ┆ 3.396781     ┆ 154  ┆ 7            │
│ KASUSDT      ┆ 3.441321     ┆ 155  ┆ 6            │
│ LINAUSDT     ┆ 3.509584     ┆ 156  ┆ 5            │
│ SPELLUSDT    ┆ 3.711891     ┆ 157  ┆ 4            │
│ ALPHAUSDT    ┆ 4.313362     ┆ 158  ┆ 3            │
│ TWTUSDT      ┆ 4.612982     ┆ 159  ┆ 2            │
│ BNXUSDT      ┆ 7.988819     ┆ 160  ┆ 1            │
│ OXTUSDT      ┆ 12.161509    ┆ 161  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,884 - WARNING - 2024-03-24T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,884 - INFO - cur close time: 2024-03-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:14,884 - DEBUG - mean expected ret (mean factor): 0.0414848282590669
2024-12-12 23:54:14,890 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,891 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,891 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024122    ┆ 0.2401      ┆ 0.16102     ┆ 0.0078187   ┆ … ┆ 0.03398 ┆ null   ┆ null    ┆ 0.9208  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,897 - DEBUG - update position: 2024-03-24T23:59:59.999 === diff_trading_value: 296286.77646360535 == cash: 130158.01329223375 
2024-12-12 23:54:14,897 - INFO - pnl: 2024-03-24T23:59:59.999 130158.01329223375 === -0.004%
2024-12-12 23:54:14,900 - DEBUG - cur time: 2024-03-25T23:59:59.999 == next bar open time: 2024-03-26T00:00:00.000 == close pos time: 2024-03-31T00:00:00.000
2024-12-12 23:54:14,905 - INFO - pnl: 2024-03-25T23:59:59.999 130014.52515983974 === -0.110%
2024-12-12 23:54:14,909 - DEBUG - cur time: 2024-03-26T23:59:59.999 == next bar open time: 2024-03-27T00:00:00.000 == close pos time: 2024-04-01T00:00:00.000
2024-12-12 23:54:14,910 - INFO - pnl: 2024-03-26T23:59:59.999 135308.47102573828 === 4.072%
2024-12-12 23:54:14,914 - DEBUG - cur time: 2024-03-27T23:59:59.999 == next bar open time: 2024-03-28T00:00:00.000 == close pos time: 2024-04-02T00:00:00.000
2024-12-12 23:54:14,915 - INFO - pnl: 2024-03-27T23:59:59.999 132517.1906923316 === -2.063%
2024-12-12 23:54:14,917 - DEBUG - cur time: 2024-03-28T23:59:59.999 == next bar open time: 2024-03-29T00:00:00.000 == close pos time: 2024-04-03T00:00:00.000
2024-12-12 23:54:14,920 - INFO - pnl: 2024-03-28T23:59:59.999 134109.44717470216 === 1.202%
2024-12-12 23:54:14,922 - DEBUG - cur time: 2024-03-29T23:59:59.999 == next bar open time: 2024-03-30T00:00:00.000 == close pos time: 2024-04-04T00:00:00.000
2024-12-12 23:54:14,935 - DEBUG - close time 2024-03-29T23:59:59.999 == vol_threshold: 14657946.0
2024-12-12 23:54:14,936 - DEBUG - 2024-03-29T23:59:59.999 == all trade symbol 231 == remain 161 after VOL filter
2024-12-12 23:54:14,938 - DEBUG - sorted_long_factors: shape: (161, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ MBLUSDT    ┆ -5.025615    ┆ 0    ┆ 160          │
│ BLZUSDT    ┆ -4.091369    ┆ 1    ┆ 159          │
│ MANTAUSDT  ┆ -3.210424    ┆ 2    ┆ 158          │
│ ARKMUSDT   ┆ -3.155597    ┆ 3    ┆ 157          │
│ XAIUSDT    ┆ -3.14906     ┆ 4    ┆ 156          │
│ LUNA2USDT  ┆ -3.128106    ┆ 5    ┆ 155          │
│ ROSEUSDT   ┆ -3.097326    ┆ 6    ┆ 154          │
│ MINAUSDT   ┆ -3.081106    ┆ 7    ┆ 153          │
│ HOOKUSDT   ┆ -2.988178    ┆ 8    ┆ 152          │
│ BEAMXUSDT  ┆ -2.952225    ┆ 9    ┆ 151          │
│ …          ┆ …            ┆ …    ┆ …            │
│ OMGUSDT    ┆ 3.444108     ┆ 151  ┆ 9            │
│ LOOMUSDT   ┆ 3.924838     ┆ 152  ┆ 8            │
│ SKLUSDT    ┆ 4.0672       ┆ 153  ┆ 7            │
│ PENDLEUSDT ┆ 4.173084     ┆ 154  ┆ 6            │
│ DARUSDT    ┆ 4.176576     ┆ 155  ┆ 5            │
│ RVNUSDT    ┆ 4.214968     ┆ 156  ┆ 4            │
│ ONTUSDT    ┆ 4.345482     ┆ 157  ┆ 3            │
│ MANAUSDT   ┆ 4.454831     ┆ 158  ┆ 2            │
│ XEMUSDT    ┆ 4.501841     ┆ 159  ┆ 1            │
│ ORBSUSDT   ┆ 7.223732     ┆ 160  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:14,942 - WARNING - 2024-03-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:14,942 - INFO - cur close time: 2024-03-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:14,942 - DEBUG - mean expected ret (mean factor): 0.13931285757211564
2024-12-12 23:54:14,950 - DEBUG - begin to update pos: =========
2024-12-12 23:54:14,950 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,950 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.026348    ┆ 0.24052     ┆ 0.15403     ┆ 0.0077528   ┆ … ┆ 0.03685 ┆ null   ┆ null    ┆ 0.8616  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:14,955 - DEBUG - update position: 2024-03-29T23:59:59.999 === diff_trading_value: 359937.6350401266 == cash: 135655.191499493 
2024-12-12 23:54:14,959 - INFO - pnl: 2024-03-29T23:59:59.999 135655.191499493 === 1.153%
2024-12-12 23:54:14,963 - DEBUG - cur time: 2024-03-30T23:59:59.999 == next bar open time: 2024-03-31T00:00:00.000 == close pos time: 2024-04-05T00:00:00.000
2024-12-12 23:54:14,964 - INFO - pnl: 2024-03-30T23:59:59.999 136810.03441971994 === 0.851%
2024-12-12 23:54:14,968 - DEBUG - cur time: 2024-03-31T23:59:59.999 == next bar open time: 2024-04-01T00:00:00.000 == close pos time: 2024-04-06T00:00:00.000
2024-12-12 23:54:14,969 - INFO - pnl: 2024-03-31T23:59:59.999 135968.58694562406 === -0.615%
2024-12-12 23:54:14,973 - DEBUG - cur time: 2024-04-01T23:59:59.999 == next bar open time: 2024-04-02T00:00:00.000 == close pos time: 2024-04-07T00:00:00.000
2024-12-12 23:54:14,973 - INFO - pnl: 2024-04-01T23:59:59.999 136400.9463705825 === 0.318%
2024-12-12 23:54:14,980 - DEBUG - cur time: 2024-04-02T23:59:59.999 == next bar open time: 2024-04-03T00:00:00.000 == close pos time: 2024-04-08T00:00:00.000
2024-12-12 23:54:14,980 - INFO - pnl: 2024-04-02T23:59:59.999 136668.38875117237 === 0.196%
2024-12-12 23:54:14,984 - DEBUG - cur time: 2024-04-03T23:59:59.999 == next bar open time: 2024-04-04T00:00:00.000 == close pos time: 2024-04-09T00:00:00.000
2024-12-12 23:54:14,996 - DEBUG - close time 2024-04-03T23:59:59.999 == vol_threshold: 13912906.6
2024-12-12 23:54:14,997 - DEBUG - 2024-04-03T23:59:59.999 == all trade symbol 232 == remain 162 after VOL filter
2024-12-12 23:54:14,997 - DEBUG - sorted_long_factors: shape: (162, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AIUSDT       ┆ -5.350862    ┆ 0    ┆ 161          │
│ 1000LUNCUSDT ┆ -4.096414    ┆ 1    ┆ 160          │
│ MANTAUSDT    ┆ -4.008309    ┆ 2    ┆ 159          │
│ OMGUSDT      ┆ -3.681944    ┆ 3    ┆ 158          │
│ MDTUSDT      ┆ -3.547198    ┆ 4    ┆ 157          │
│ RENUSDT      ┆ -3.371057    ┆ 5    ┆ 156          │
│ KEYUSDT      ┆ -3.106434    ┆ 6    ┆ 155          │
│ ONDOUSDT     ┆ -2.988342    ┆ 7    ┆ 154          │
│ ORBSUSDT     ┆ -2.939323    ┆ 8    ┆ 153          │
│ MEMEUSDT     ┆ -2.763636    ┆ 9    ┆ 152          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RIFUSDT      ┆ 3.087919     ┆ 152  ┆ 9            │
│ XVGUSDT      ┆ 3.194245     ┆ 153  ┆ 8            │
│ ANKRUSDT     ┆ 3.427474     ┆ 154  ┆ 7            │
│ STPTUSDT     ┆ 3.442226     ┆ 155  ┆ 6            │
│ TRXUSDT      ┆ 3.502433     ┆ 156  ┆ 5            │
│ SNTUSDT      ┆ 3.507669     ┆ 157  ┆ 4            │
│ BELUSDT      ┆ 3.974805     ┆ 158  ┆ 3            │
│ STMXUSDT     ┆ 4.175033     ┆ 159  ┆ 2            │
│ MBLUSDT      ┆ 4.349339     ┆ 160  ┆ 1            │
│ CTSIUSDT     ┆ 9.984219     ┆ 161  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,005 - WARNING - 2024-04-03T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,005 - INFO - cur close time: 2024-04-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:15,005 - DEBUG - mean expected ret (mean factor): 0.13048615787921602
2024-12-12 23:54:15,010 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,010 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,010 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.02237     ┆ 0.19879     ┆ 0.13611     ┆ 0.0068101   ┆ … ┆ 0.03189 ┆ null   ┆ null    ┆ 0.645   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,015 - DEBUG - update position: 2024-04-03T23:59:59.999 === diff_trading_value: 330466.6946478825 == cash: 137320.08229343075 
2024-12-12 23:54:15,016 - INFO - pnl: 2024-04-03T23:59:59.999 137320.08229343075 === 0.477%
2024-12-12 23:54:15,020 - DEBUG - cur time: 2024-04-04T23:59:59.999 == next bar open time: 2024-04-05T00:00:00.000 == close pos time: 2024-04-10T00:00:00.000
2024-12-12 23:54:15,021 - INFO - pnl: 2024-04-04T23:59:59.999 135796.23667428203 === -1.110%
2024-12-12 23:54:15,024 - DEBUG - cur time: 2024-04-05T23:59:59.999 == next bar open time: 2024-04-06T00:00:00.000 == close pos time: 2024-04-11T00:00:00.000
2024-12-12 23:54:15,025 - INFO - pnl: 2024-04-05T23:59:59.999 137811.11885566486 === 1.484%
2024-12-12 23:54:15,030 - DEBUG - cur time: 2024-04-06T23:59:59.999 == next bar open time: 2024-04-07T00:00:00.000 == close pos time: 2024-04-12T00:00:00.000
2024-12-12 23:54:15,030 - INFO - pnl: 2024-04-06T23:59:59.999 137763.09659688105 === -0.035%
2024-12-12 23:54:15,034 - DEBUG - cur time: 2024-04-07T23:59:59.999 == next bar open time: 2024-04-08T00:00:00.000 == close pos time: 2024-04-13T00:00:00.000
2024-12-12 23:54:15,035 - INFO - pnl: 2024-04-07T23:59:59.999 138858.540614818 === 0.795%
2024-12-12 23:54:15,038 - DEBUG - cur time: 2024-04-08T23:59:59.999 == next bar open time: 2024-04-09T00:00:00.000 == close pos time: 2024-04-14T00:00:00.000
2024-12-12 23:54:15,048 - DEBUG - close time 2024-04-08T23:59:59.999 == vol_threshold: 13948511.629999992
2024-12-12 23:54:15,049 - DEBUG - 2024-04-08T23:59:59.999 == all trade symbol 234 == remain 164 after VOL filter
2024-12-12 23:54:15,051 - DEBUG - sorted_long_factors: shape: (164, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ AMBUSDT   ┆ -6.537972    ┆ 0    ┆ 163          │
│ MEMEUSDT  ┆ -5.673263    ┆ 1    ┆ 162          │
│ WOOUSDT   ┆ -4.677164    ┆ 2    ┆ 161          │
│ NFPUSDT   ┆ -4.410111    ┆ 3    ┆ 160          │
│ STGUSDT   ┆ -3.898302    ┆ 4    ┆ 159          │
│ SEIUSDT   ┆ -3.642985    ┆ 5    ┆ 158          │
│ RDNTUSDT  ┆ -3.617145    ┆ 6    ┆ 157          │
│ AIUSDT    ┆ -3.579312    ┆ 7    ┆ 156          │
│ IDEXUSDT  ┆ -3.554892    ┆ 8    ┆ 155          │
│ BNXUSDT   ┆ -3.549049    ┆ 9    ┆ 154          │
│ …         ┆ …            ┆ …    ┆ …            │
│ STEEMUSDT ┆ 3.888041     ┆ 154  ┆ 9            │
│ CTSIUSDT  ┆ 3.985155     ┆ 155  ┆ 8            │
│ XTZUSDT   ┆ 3.99916      ┆ 156  ┆ 7            │
│ HOTUSDT   ┆ 4.077755     ┆ 157  ┆ 6            │
│ OXTUSDT   ┆ 4.166625     ┆ 158  ┆ 5            │
│ SFPUSDT   ┆ 4.219158     ┆ 159  ┆ 4            │
│ BELUSDT   ┆ 4.278303     ┆ 160  ┆ 3            │
│ BATUSDT   ┆ 5.024059     ┆ 161  ┆ 2            │
│ FLOWUSDT  ┆ 5.125121     ┆ 162  ┆ 1            │
│ MBLUSDT   ┆ 7.983303     ┆ 163  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,058 - WARNING - 2024-04-08T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,058 - INFO - cur close time: 2024-04-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:15,058 - DEBUG - mean expected ret (mean factor): 0.03200051346497658
2024-12-12 23:54:15,062 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,063 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,063 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024465    ┆ 0.21553     ┆ 0.14205     ┆ 0.0077766   ┆ … ┆ 0.03542 ┆ null   ┆ null    ┆ 0.7347  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,070 - DEBUG - update position: 2024-04-08T23:59:59.999 === diff_trading_value: 322081.4991313479 == cash: 137617.1135539401 
2024-12-12 23:54:15,071 - INFO - pnl: 2024-04-08T23:59:59.999 137617.1135539401 === -0.894%
2024-12-12 23:54:15,075 - DEBUG - cur time: 2024-04-09T23:59:59.999 == next bar open time: 2024-04-10T00:00:00.000 == close pos time: 2024-04-15T00:00:00.000
2024-12-12 23:54:15,077 - INFO - pnl: 2024-04-09T23:59:59.999 139315.8687349787 === 1.234%
2024-12-12 23:54:15,080 - DEBUG - cur time: 2024-04-10T23:59:59.999 == next bar open time: 2024-04-11T00:00:00.000 == close pos time: 2024-04-16T00:00:00.000
2024-12-12 23:54:15,080 - INFO - pnl: 2024-04-10T23:59:59.999 139077.15734112874 === -0.171%
2024-12-12 23:54:15,085 - DEBUG - cur time: 2024-04-11T23:59:59.999 == next bar open time: 2024-04-12T00:00:00.000 == close pos time: 2024-04-17T00:00:00.000
2024-12-12 23:54:15,085 - INFO - pnl: 2024-04-11T23:59:59.999 138835.08694471465 === -0.174%
2024-12-12 23:54:15,090 - DEBUG - cur time: 2024-04-12T23:59:59.999 == next bar open time: 2024-04-13T00:00:00.000 == close pos time: 2024-04-18T00:00:00.000
2024-12-12 23:54:15,091 - INFO - pnl: 2024-04-12T23:59:59.999 141810.14062334006 === 2.143%
2024-12-12 23:54:15,094 - DEBUG - cur time: 2024-04-13T23:59:59.999 == next bar open time: 2024-04-14T00:00:00.000 == close pos time: 2024-04-19T00:00:00.000
2024-12-12 23:54:15,107 - DEBUG - close time 2024-04-13T23:59:59.999 == vol_threshold: 46655487.75
2024-12-12 23:54:15,107 - DEBUG - 2024-04-13T23:59:59.999 == all trade symbol 236 == remain 165 after VOL filter
2024-12-12 23:54:15,110 - DEBUG - sorted_long_factors: shape: (165, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ KLAYUSDT   ┆ -7.594476    ┆ 0    ┆ 164          │
│ CHZUSDT    ┆ -5.843885    ┆ 1    ┆ 163          │
│ AIUSDT     ┆ -4.778288    ┆ 2    ┆ 162          │
│ RDNTUSDT   ┆ -4.470728    ┆ 3    ┆ 161          │
│ XRPUSDT    ┆ -3.987018    ┆ 4    ┆ 160          │
│ ALTUSDT    ┆ -3.969471    ┆ 5    ┆ 159          │
│ MANAUSDT   ┆ -3.692849    ┆ 6    ┆ 158          │
│ CFXUSDT    ┆ -3.650874    ┆ 7    ┆ 157          │
│ DOGEUSDT   ┆ -3.531276    ┆ 8    ┆ 156          │
│ EOSUSDT    ┆ -3.463507    ┆ 9    ┆ 155          │
│ …          ┆ …            ┆ …    ┆ …            │
│ PENDLEUSDT ┆ 3.336597     ┆ 155  ┆ 9            │
│ IDUSDT     ┆ 3.440245     ┆ 156  ┆ 8            │
│ SFPUSDT    ┆ 3.444449     ┆ 157  ┆ 7            │
│ BELUSDT    ┆ 3.508493     ┆ 158  ┆ 6            │
│ STEEMUSDT  ┆ 3.81495      ┆ 159  ┆ 5            │
│ STGUSDT    ┆ 3.854108     ┆ 160  ┆ 4            │
│ ONGUSDT    ┆ 3.916291     ┆ 161  ┆ 3            │
│ BLZUSDT    ┆ 4.121389     ┆ 162  ┆ 2            │
│ WOOUSDT    ┆ 4.428126     ┆ 163  ┆ 1            │
│ BNXUSDT    ┆ 7.248519     ┆ 164  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,115 - WARNING - 2024-04-13T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,115 - INFO - cur close time: 2024-04-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:15,115 - DEBUG - mean expected ret (mean factor): 0.06944093840713991
2024-12-12 23:54:15,120 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,120 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,121 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.015349    ┆ 0.13365     ┆ 0.08982     ┆ 0.0050422   ┆ … ┆ 0.02347 ┆ null   ┆ null    ┆ 0.4673  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,125 - DEBUG - update position: 2024-04-13T23:59:59.999 === diff_trading_value: 274464.56119272485 == cash: 141313.8755139622 
2024-12-12 23:54:15,125 - INFO - pnl: 2024-04-13T23:59:59.999 141313.8755139622 === -0.350%
2024-12-12 23:54:15,132 - DEBUG - cur time: 2024-04-14T23:59:59.999 == next bar open time: 2024-04-15T00:00:00.000 == close pos time: 2024-04-20T00:00:00.000
2024-12-12 23:54:15,133 - INFO - pnl: 2024-04-14T23:59:59.999 139345.61133678028 === -1.393%
2024-12-12 23:54:15,137 - DEBUG - cur time: 2024-04-15T23:59:59.999 == next bar open time: 2024-04-16T00:00:00.000 == close pos time: 2024-04-21T00:00:00.000
2024-12-12 23:54:15,138 - INFO - pnl: 2024-04-15T23:59:59.999 138498.67660779567 === -0.608%
2024-12-12 23:54:15,142 - DEBUG - cur time: 2024-04-16T23:59:59.999 == next bar open time: 2024-04-17T00:00:00.000 == close pos time: 2024-04-22T00:00:00.000
2024-12-12 23:54:15,142 - INFO - pnl: 2024-04-16T23:59:59.999 140755.3544607958 === 1.629%
2024-12-12 23:54:15,147 - DEBUG - cur time: 2024-04-17T23:59:59.999 == next bar open time: 2024-04-18T00:00:00.000 == close pos time: 2024-04-23T00:00:00.000
2024-12-12 23:54:15,149 - INFO - pnl: 2024-04-17T23:59:59.999 141118.60872841923 === 0.258%
2024-12-12 23:54:15,152 - DEBUG - cur time: 2024-04-18T23:59:59.999 == next bar open time: 2024-04-19T00:00:00.000 == close pos time: 2024-04-24T00:00:00.000
2024-12-12 23:54:15,164 - DEBUG - close time 2024-04-18T23:59:59.999 == vol_threshold: 18593138.8
2024-12-12 23:54:15,164 - DEBUG - 2024-04-18T23:59:59.999 == all trade symbol 238 == remain 166 after VOL filter
2024-12-12 23:54:15,164 - DEBUG - sorted_long_factors: shape: (166, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ KLAYUSDT  ┆ -5.206706    ┆ 0    ┆ 165          │
│ ALTUSDT   ┆ -4.036649    ┆ 1    ┆ 164          │
│ ARPAUSDT  ┆ -3.720844    ┆ 2    ┆ 163          │
│ DOGEUSDT  ┆ -3.645865    ┆ 3    ┆ 162          │
│ TOKENUSDT ┆ -3.629738    ┆ 4    ┆ 161          │
│ CHRUSDT   ┆ -3.291473    ┆ 5    ┆ 160          │
│ OGNUSDT   ┆ -3.194165    ┆ 6    ┆ 159          │
│ RDNTUSDT  ┆ -2.735882    ┆ 7    ┆ 158          │
│ MANAUSDT  ┆ -2.646557    ┆ 8    ┆ 157          │
│ BICOUSDT  ┆ -2.526667    ┆ 9    ┆ 156          │
│ …         ┆ …            ┆ …    ┆ …            │
│ LSKUSDT   ┆ 3.395154     ┆ 156  ┆ 9            │
│ C98USDT   ┆ 3.474913     ┆ 157  ┆ 8            │
│ STPTUSDT  ┆ 3.516991     ┆ 158  ┆ 7            │
│ BLZUSDT   ┆ 4.0659       ┆ 159  ┆ 6            │
│ RSRUSDT   ┆ 4.145971     ┆ 160  ┆ 5            │
│ SUPERUSDT ┆ 4.663328     ┆ 161  ┆ 4            │
│ XTZUSDT   ┆ 5.18652      ┆ 162  ┆ 3            │
│ SNTUSDT   ┆ 5.826487     ┆ 163  ┆ 2            │
│ RIFUSDT   ┆ 7.606592     ┆ 164  ┆ 1            │
│ LOOMUSDT  ┆ 14.685324    ┆ 165  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,171 - WARNING - 2024-04-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,171 - INFO - cur close time: 2024-04-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:15,172 - DEBUG - mean expected ret (mean factor): 0.027970650408551262
2024-12-12 23:54:15,176 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,176 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,176 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.014715    ┆ 0.13824     ┆ 0.1006      ┆ 0.0050799   ┆ … ┆ 0.0243  ┆ null   ┆ null    ┆ 0.5052  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,181 - DEBUG - update position: 2024-04-18T23:59:59.999 === diff_trading_value: 282184.5006289509 == cash: 143955.22711945654 
2024-12-12 23:54:15,181 - INFO - pnl: 2024-04-18T23:59:59.999 143955.22711945654 === 2.010%
2024-12-12 23:54:15,185 - DEBUG - cur time: 2024-04-19T23:59:59.999 == next bar open time: 2024-04-20T00:00:00.000 == close pos time: 2024-04-25T00:00:00.000
2024-12-12 23:54:15,188 - INFO - pnl: 2024-04-19T23:59:59.999 143152.77011811995 === -0.557%
2024-12-12 23:54:15,192 - DEBUG - cur time: 2024-04-20T23:59:59.999 == next bar open time: 2024-04-21T00:00:00.000 == close pos time: 2024-04-26T00:00:00.000
2024-12-12 23:54:15,193 - INFO - pnl: 2024-04-20T23:59:59.999 141104.58071471905 === -1.431%
2024-12-12 23:54:15,197 - DEBUG - cur time: 2024-04-21T23:59:59.999 == next bar open time: 2024-04-22T00:00:00.000 == close pos time: 2024-04-27T00:00:00.000
2024-12-12 23:54:15,197 - INFO - pnl: 2024-04-21T23:59:59.999 140909.73273982707 === -0.138%
2024-12-12 23:54:15,201 - DEBUG - cur time: 2024-04-22T23:59:59.999 == next bar open time: 2024-04-23T00:00:00.000 == close pos time: 2024-04-28T00:00:00.000
2024-12-12 23:54:15,201 - INFO - pnl: 2024-04-22T23:59:59.999 141415.3128398627 === 0.359%
2024-12-12 23:54:15,206 - DEBUG - cur time: 2024-04-23T23:59:59.999 == next bar open time: 2024-04-24T00:00:00.000 == close pos time: 2024-04-29T00:00:00.000
2024-12-12 23:54:15,218 - DEBUG - close time 2024-04-23T23:59:59.999 == vol_threshold: 11780237.919999998
2024-12-12 23:54:15,219 - DEBUG - 2024-04-23T23:59:59.999 == all trade symbol 238 == remain 166 after VOL filter
2024-12-12 23:54:15,222 - DEBUG - sorted_long_factors: shape: (166, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ XVGUSDT   ┆ -4.542795    ┆ 0    ┆ 165          │
│ MANTAUSDT ┆ -4.412224    ┆ 1    ┆ 164          │
│ CHRUSDT   ┆ -4.383592    ┆ 2    ┆ 163          │
│ ALTUSDT   ┆ -4.106462    ┆ 3    ┆ 162          │
│ RDNTUSDT  ┆ -3.679179    ┆ 4    ┆ 161          │
│ MAVUSDT   ┆ -3.678826    ┆ 5    ┆ 160          │
│ NTRNUSDT  ┆ -3.662686    ┆ 6    ┆ 159          │
│ JOEUSDT   ┆ -3.466069    ┆ 7    ┆ 158          │
│ REEFUSDT  ┆ -3.349286    ┆ 8    ┆ 157          │
│ ACHUSDT   ┆ -3.198309    ┆ 9    ┆ 156          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XTZUSDT   ┆ 3.16135      ┆ 156  ┆ 9            │
│ DODOXUSDT ┆ 3.20229      ┆ 157  ┆ 8            │
│ SANDUSDT  ┆ 3.39982      ┆ 158  ┆ 7            │
│ ASTRUSDT  ┆ 3.442501     ┆ 159  ┆ 6            │
│ ATAUSDT   ┆ 3.4569       ┆ 160  ┆ 5            │
│ PHBUSDT   ┆ 3.692708     ┆ 161  ┆ 4            │
│ STEEMUSDT ┆ 4.318084     ┆ 162  ┆ 3            │
│ HBARUSDT  ┆ 4.386405     ┆ 163  ┆ 2            │
│ STMXUSDT  ┆ 5.306052     ┆ 164  ┆ 1            │
│ BNXUSDT   ┆ 5.71594      ┆ 165  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,228 - WARNING - 2024-04-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,228 - INFO - cur close time: 2024-04-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:15,228 - DEBUG - mean expected ret (mean factor): -0.02398486467983253
2024-12-12 23:54:15,233 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,233 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,233 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.02474     ┆ 0.19338     ┆ 0.11123     ┆ 0.0076765   ┆ … ┆ 0.02718 ┆ null   ┆ null    ┆ 0.5585  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,241 - DEBUG - update position: 2024-04-23T23:59:59.999 === diff_trading_value: 329703.6046614057 == cash: 141240.44240192414 
2024-12-12 23:54:15,242 - INFO - pnl: 2024-04-23T23:59:59.999 141240.44240192414 === -0.124%
2024-12-12 23:54:15,246 - DEBUG - cur time: 2024-04-24T23:59:59.999 == next bar open time: 2024-04-25T00:00:00.000 == close pos time: 2024-04-30T00:00:00.000
2024-12-12 23:54:15,248 - INFO - pnl: 2024-04-24T23:59:59.999 143194.92367591095 === 1.384%
2024-12-12 23:54:15,252 - DEBUG - cur time: 2024-04-25T23:59:59.999 == next bar open time: 2024-04-26T00:00:00.000 == close pos time: 2024-05-01T00:00:00.000
2024-12-12 23:54:15,253 - INFO - pnl: 2024-04-25T23:59:59.999 140909.32689849654 === -1.596%
2024-12-12 23:54:15,257 - DEBUG - cur time: 2024-04-26T23:59:59.999 == next bar open time: 2024-04-27T00:00:00.000 == close pos time: 2024-05-02T00:00:00.000
2024-12-12 23:54:15,258 - INFO - pnl: 2024-04-26T23:59:59.999 141745.70810404595 === 0.594%
2024-12-12 23:54:15,264 - DEBUG - cur time: 2024-04-27T23:59:59.999 == next bar open time: 2024-04-28T00:00:00.000 == close pos time: 2024-05-03T00:00:00.000
2024-12-12 23:54:15,266 - INFO - pnl: 2024-04-27T23:59:59.999 140211.83038952775 === -1.082%
2024-12-12 23:54:15,270 - DEBUG - cur time: 2024-04-28T23:59:59.999 == next bar open time: 2024-04-29T00:00:00.000 == close pos time: 2024-05-04T00:00:00.000
2024-12-12 23:54:15,281 - DEBUG - close time 2024-04-28T23:59:59.999 == vol_threshold: 8660951.999999998
2024-12-12 23:54:15,281 - DEBUG - 2024-04-28T23:59:59.999 == all trade symbol 239 == remain 167 after VOL filter
2024-12-12 23:54:15,285 - DEBUG - sorted_long_factors: shape: (167, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ OXTUSDT   ┆ -5.94441     ┆ 0    ┆ 166          │
│ ONDOUSDT  ┆ -5.009487    ┆ 1    ┆ 165          │
│ AIUSDT    ┆ -4.187938    ┆ 2    ┆ 164          │
│ ZETAUSDT  ┆ -4.1611      ┆ 3    ┆ 163          │
│ NFPUSDT   ┆ -4.156291    ┆ 4    ┆ 162          │
│ KLAYUSDT  ┆ -3.949419    ┆ 5    ┆ 161          │
│ AMBUSDT   ┆ -3.661955    ┆ 6    ┆ 160          │
│ XRPUSDT   ┆ -3.291662    ┆ 7    ┆ 159          │
│ OCEANUSDT ┆ -3.146695    ┆ 8    ┆ 158          │
│ PYTHUSDT  ┆ -3.123675    ┆ 9    ┆ 157          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XTZUSDT   ┆ 3.586934     ┆ 157  ┆ 9            │
│ STGUSDT   ┆ 3.590144     ┆ 158  ┆ 8            │
│ KAVAUSDT  ┆ 3.894187     ┆ 159  ┆ 7            │
│ HIGHUSDT  ┆ 4.123478     ┆ 160  ┆ 6            │
│ KNCUSDT   ┆ 4.129494     ┆ 161  ┆ 5            │
│ REEFUSDT  ┆ 5.531522     ┆ 162  ┆ 4            │
│ ASTRUSDT  ┆ 5.886421     ┆ 163  ┆ 3            │
│ SXPUSDT   ┆ 5.917304     ┆ 164  ┆ 2            │
│ TRXUSDT   ┆ 6.069424     ┆ 165  ┆ 1            │
│ STPTUSDT  ┆ 7.484998     ┆ 166  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,298 - WARNING - 2024-04-28T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,298 - INFO - cur close time: 2024-04-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:15,298 - DEBUG - mean expected ret (mean factor): 0.1687325982881371
2024-12-12 23:54:15,308 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,309 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,310 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025099    ┆ 0.17015     ┆ 0.10564     ┆ 0.0072219   ┆ … ┆ 0.02448 ┆ null   ┆ null    ┆ 0.4991  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,329 - DEBUG - update position: 2024-04-28T23:59:59.999 === diff_trading_value: 353904.1398755079 == cash: 141070.20568436713 
2024-12-12 23:54:15,332 - INFO - pnl: 2024-04-28T23:59:59.999 141070.20568436713 === 0.612%
2024-12-12 23:54:15,338 - DEBUG - cur time: 2024-04-29T23:59:59.999 == next bar open time: 2024-04-30T00:00:00.000 == close pos time: 2024-05-05T00:00:00.000
2024-12-12 23:54:15,342 - INFO - pnl: 2024-04-29T23:59:59.999 140103.7598330423 === -0.685%
2024-12-12 23:54:15,350 - DEBUG - cur time: 2024-04-30T23:59:59.999 == next bar open time: 2024-05-01T00:00:00.000 == close pos time: 2024-05-06T00:00:00.000
2024-12-12 23:54:15,352 - INFO - pnl: 2024-04-30T23:59:59.999 139322.07583215833 === -0.558%
2024-12-12 23:54:15,358 - DEBUG - cur time: 2024-05-01T23:59:59.999 == next bar open time: 2024-05-02T00:00:00.000 == close pos time: 2024-05-07T00:00:00.000
2024-12-12 23:54:15,361 - INFO - pnl: 2024-05-01T23:59:59.999 137874.0694183631 === -1.039%
2024-12-12 23:54:15,365 - DEBUG - cur time: 2024-05-02T23:59:59.999 == next bar open time: 2024-05-03T00:00:00.000 == close pos time: 2024-05-08T00:00:00.000
2024-12-12 23:54:15,367 - INFO - pnl: 2024-05-02T23:59:59.999 139254.68275605456 === 1.001%
2024-12-12 23:54:15,370 - DEBUG - cur time: 2024-05-03T23:59:59.999 == next bar open time: 2024-05-04T00:00:00.000 == close pos time: 2024-05-09T00:00:00.000
2024-12-12 23:54:15,381 - DEBUG - close time 2024-05-03T23:59:59.999 == vol_threshold: 13344211.836
2024-12-12 23:54:15,381 - DEBUG - 2024-05-03T23:59:59.999 == all trade symbol 243 == remain 170 after VOL filter
2024-12-12 23:54:15,381 - DEBUG - sorted_long_factors: shape: (170, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ONDOUSDT    ┆ -4.340669    ┆ 0    ┆ 169          │
│ CFXUSDT     ┆ -4.079142    ┆ 1    ┆ 168          │
│ BLZUSDT     ┆ -4.015831    ┆ 2    ┆ 167          │
│ ALPHAUSDT   ┆ -3.917438    ┆ 3    ┆ 166          │
│ XVGUSDT     ┆ -3.754364    ┆ 4    ┆ 165          │
│ ORBSUSDT    ┆ -3.541974    ┆ 5    ┆ 164          │
│ PIXELUSDT   ┆ -3.399294    ┆ 6    ┆ 163          │
│ NFPUSDT     ┆ -3.320465    ┆ 7    ┆ 162          │
│ BIGTIMEUSDT ┆ -3.293678    ┆ 8    ┆ 161          │
│ PYTHUSDT    ┆ -3.018912    ┆ 9    ┆ 160          │
│ …           ┆ …            ┆ …    ┆ …            │
│ HIGHUSDT    ┆ 3.326998     ┆ 160  ┆ 9            │
│ ROSEUSDT    ┆ 3.434844     ┆ 161  ┆ 8            │
│ HIFIUSDT    ┆ 3.548256     ┆ 162  ┆ 7            │
│ HOTUSDT     ┆ 3.773578     ┆ 163  ┆ 6            │
│ XEMUSDT     ┆ 4.65272      ┆ 164  ┆ 5            │
│ OXTUSDT     ┆ 5.642381     ┆ 165  ┆ 4            │
│ ICXUSDT     ┆ 6.468551     ┆ 166  ┆ 3            │
│ MBLUSDT     ┆ 6.64102      ┆ 167  ┆ 2            │
│ RIFUSDT     ┆ 7.076353     ┆ 168  ┆ 1            │
│ SNTUSDT     ┆ 8.237022     ┆ 169  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,390 - INFO - cur close time: 2024-05-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:15,391 - DEBUG - mean expected ret (mean factor): 0.030742813461774474
2024-12-12 23:54:15,395 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,396 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,396 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.027186    ┆ 0.17487     ┆ 0.10692     ┆ 0.0080718   ┆ … ┆ 0.02456 ┆ null   ┆ null    ┆ 0.4904  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,401 - DEBUG - update position: 2024-05-03T23:59:59.999 === diff_trading_value: 295879.52295258536 == cash: 136284.03158939903 
2024-12-12 23:54:15,401 - INFO - pnl: 2024-05-03T23:59:59.999 136284.03158939903 === -2.133%
2024-12-12 23:54:15,406 - DEBUG - cur time: 2024-05-04T23:59:59.999 == next bar open time: 2024-05-05T00:00:00.000 == close pos time: 2024-05-10T00:00:00.000
2024-12-12 23:54:15,407 - INFO - pnl: 2024-05-04T23:59:59.999 137046.08425345563 === 0.559%
2024-12-12 23:54:15,410 - DEBUG - cur time: 2024-05-05T23:59:59.999 == next bar open time: 2024-05-06T00:00:00.000 == close pos time: 2024-05-11T00:00:00.000
2024-12-12 23:54:15,412 - INFO - pnl: 2024-05-05T23:59:59.999 133082.01796096016 === -2.893%
2024-12-12 23:54:15,413 - DEBUG - cur time: 2024-05-06T23:59:59.999 == next bar open time: 2024-05-07T00:00:00.000 == close pos time: 2024-05-12T00:00:00.000
2024-12-12 23:54:15,415 - INFO - pnl: 2024-05-06T23:59:59.999 119173.44562375735 === -10.451%
2024-12-12 23:54:15,417 - DEBUG - cur time: 2024-05-07T23:59:59.999 == next bar open time: 2024-05-08T00:00:00.000 == close pos time: 2024-05-13T00:00:00.000
2024-12-12 23:54:15,419 - INFO - pnl: 2024-05-07T23:59:59.999 121422.65066835695 === 1.887%
2024-12-12 23:54:15,421 - DEBUG - cur time: 2024-05-08T23:59:59.999 == next bar open time: 2024-05-09T00:00:00.000 == close pos time: 2024-05-14T00:00:00.000
2024-12-12 23:54:15,432 - DEBUG - close time 2024-05-08T23:59:59.999 == vol_threshold: 14895710.679999996
2024-12-12 23:54:15,434 - DEBUG - 2024-05-08T23:59:59.999 == all trade symbol 238 == remain 166 after VOL filter
2024-12-12 23:54:15,436 - DEBUG - sorted_long_factors: shape: (166, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ONDOUSDT  ┆ -5.311459    ┆ 0    ┆ 165          │
│ OXTUSDT   ┆ -4.4514      ┆ 1    ┆ 164          │
│ GLMRUSDT  ┆ -4.102054    ┆ 2    ┆ 163          │
│ AIUSDT    ┆ -3.543615    ┆ 3    ┆ 162          │
│ STEEMUSDT ┆ -3.407139    ┆ 4    ┆ 161          │
│ POLYXUSDT ┆ -3.354649    ┆ 5    ┆ 160          │
│ CHZUSDT   ┆ -3.341613    ┆ 6    ┆ 159          │
│ XAIUSDT   ┆ -3.328563    ┆ 7    ┆ 158          │
│ STGUSDT   ┆ -3.288256    ┆ 8    ┆ 157          │
│ WLDUSDT   ┆ -3.255618    ┆ 9    ┆ 156          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ICXUSDT   ┆ 3.236502     ┆ 156  ┆ 9            │
│ IOTXUSDT  ┆ 3.241391     ┆ 157  ┆ 8            │
│ CTSIUSDT  ┆ 3.284379     ┆ 158  ┆ 7            │
│ KNCUSDT   ┆ 3.303914     ┆ 159  ┆ 6            │
│ SANDUSDT  ┆ 3.349005     ┆ 160  ┆ 5            │
│ LINAUSDT  ┆ 3.676879     ┆ 161  ┆ 4            │
│ FLOWUSDT  ┆ 3.902389     ┆ 162  ┆ 3            │
│ CRVUSDT   ┆ 4.413937     ┆ 163  ┆ 2            │
│ MANAUSDT  ┆ 5.404511     ┆ 164  ┆ 1            │
│ XTZUSDT   ┆ 5.510721     ┆ 165  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,441 - WARNING - 2024-05-08T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,442 - INFO - cur close time: 2024-05-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:15,442 - DEBUG - mean expected ret (mean factor): 0.11026483030473924
2024-12-12 23:54:15,447 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,447 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,447 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023367    ┆ 0.17012     ┆ 0.10391     ┆ 0.0079604   ┆ … ┆ 0.02337 ┆ null   ┆ null    ┆ 0.4723  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,454 - DEBUG - update position: 2024-05-08T23:59:59.999 === diff_trading_value: 289395.7550343487 == cash: 112597.72981250944 
2024-12-12 23:54:15,455 - INFO - pnl: 2024-05-08T23:59:59.999 117597.72981250944 === -3.150%
2024-12-12 23:54:15,460 - DEBUG - cur time: 2024-05-09T23:59:59.999 == next bar open time: 2024-05-10T00:00:00.000 == close pos time: 2024-05-15T00:00:00.000
2024-12-12 23:54:15,460 - INFO - pnl: 2024-05-09T23:59:59.999 117860.04200554651 === 0.223%
2024-12-12 23:54:15,464 - DEBUG - cur time: 2024-05-10T23:59:59.999 == next bar open time: 2024-05-11T00:00:00.000 == close pos time: 2024-05-16T00:00:00.000
2024-12-12 23:54:15,465 - INFO - pnl: 2024-05-10T23:59:59.999 117235.82301323954 === -0.530%
2024-12-12 23:54:15,467 - DEBUG - cur time: 2024-05-11T23:59:59.999 == next bar open time: 2024-05-12T00:00:00.000 == close pos time: 2024-05-17T00:00:00.000
2024-12-12 23:54:15,468 - INFO - pnl: 2024-05-11T23:59:59.999 115358.14253135605 === -1.602%
2024-12-12 23:54:15,472 - DEBUG - cur time: 2024-05-12T23:59:59.999 == next bar open time: 2024-05-13T00:00:00.000 == close pos time: 2024-05-18T00:00:00.000
2024-12-12 23:54:15,472 - INFO - pnl: 2024-05-12T23:59:59.999 114408.82354320037 === -0.823%
2024-12-12 23:54:15,476 - DEBUG - cur time: 2024-05-13T23:59:59.999 == next bar open time: 2024-05-14T00:00:00.000 == close pos time: 2024-05-19T00:00:00.000
2024-12-12 23:54:15,485 - DEBUG - close time 2024-05-13T23:59:59.999 == vol_threshold: 14679558.919999994
2024-12-12 23:54:15,488 - DEBUG - 2024-05-13T23:59:59.999 == all trade symbol 237 == remain 166 after VOL filter
2024-12-12 23:54:15,490 - DEBUG - sorted_long_factors: shape: (166, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ CHZUSDT  ┆ -4.759382    ┆ 0    ┆ 165          │
│ DUSKUSDT ┆ -4.108232    ┆ 1    ┆ 164          │
│ NKNUSDT  ┆ -3.757065    ┆ 2    ┆ 163          │
│ ONDOUSDT ┆ -3.596122    ┆ 3    ┆ 162          │
│ FETUSDT  ┆ -3.514332    ┆ 4    ┆ 161          │
│ ARBUSDT  ┆ -3.320144    ┆ 5    ┆ 160          │
│ MINAUSDT ┆ -3.05873     ┆ 6    ┆ 159          │
│ HFTUSDT  ┆ -2.934572    ┆ 7    ┆ 158          │
│ OXTUSDT  ┆ -2.833286    ┆ 8    ┆ 157          │
│ CFXUSDT  ┆ -2.829266    ┆ 9    ┆ 156          │
│ …        ┆ …            ┆ …    ┆ …            │
│ EOSUSDT  ┆ 3.950833     ┆ 156  ┆ 9            │
│ LRCUSDT  ┆ 3.96928      ┆ 157  ┆ 8            │
│ ALGOUSDT ┆ 3.99921      ┆ 158  ┆ 7            │
│ ICXUSDT  ┆ 4.491092     ┆ 159  ┆ 6            │
│ MANAUSDT ┆ 4.847655     ┆ 160  ┆ 5            │
│ TRUUSDT  ┆ 5.079183     ┆ 161  ┆ 4            │
│ RENUSDT  ┆ 5.356501     ┆ 162  ┆ 3            │
│ XLMUSDT  ┆ 5.635379     ┆ 163  ┆ 2            │
│ FLOWUSDT ┆ 6.301283     ┆ 164  ┆ 1            │
│ HIGHUSDT ┆ 6.343699     ┆ 165  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,495 - WARNING - 2024-05-13T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,495 - INFO - cur close time: 2024-05-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:15,495 - DEBUG - mean expected ret (mean factor): 0.09919373137171468
2024-12-12 23:54:15,499 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,499 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 5000.0      ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,499 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023299    ┆ 0.18328     ┆ 0.10478     ┆ 0.0099128   ┆ … ┆ 0.02236 ┆ null   ┆ null    ┆ 0.4518  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,506 - DEBUG - update position: 2024-05-13T23:59:59.999 === diff_trading_value: 256217.93716947417 == cash: 114857.68779005828 
2024-12-12 23:54:15,507 - INFO - pnl: 2024-05-13T23:59:59.999 114857.68779005828 === 0.392%
2024-12-12 23:54:15,511 - DEBUG - cur time: 2024-05-14T23:59:59.999 == next bar open time: 2024-05-15T00:00:00.000 == close pos time: 2024-05-20T00:00:00.000
2024-12-12 23:54:15,512 - INFO - pnl: 2024-05-14T23:59:59.999 117149.69918327495 === 1.996%
2024-12-12 23:54:15,515 - DEBUG - cur time: 2024-05-15T23:59:59.999 == next bar open time: 2024-05-16T00:00:00.000 == close pos time: 2024-05-21T00:00:00.000
2024-12-12 23:54:15,516 - INFO - pnl: 2024-05-15T23:59:59.999 115883.20050473209 === -1.081%
2024-12-12 23:54:15,520 - DEBUG - cur time: 2024-05-16T23:59:59.999 == next bar open time: 2024-05-17T00:00:00.000 == close pos time: 2024-05-22T00:00:00.000
2024-12-12 23:54:15,521 - INFO - pnl: 2024-05-16T23:59:59.999 115691.02980877034 === -0.166%
2024-12-12 23:54:15,521 - DEBUG - cur time: 2024-05-17T23:59:59.999 == next bar open time: 2024-05-18T00:00:00.000 == close pos time: 2024-05-23T00:00:00.000
2024-12-12 23:54:15,525 - INFO - pnl: 2024-05-17T23:59:59.999 114448.29619379783 === -1.074%
2024-12-12 23:54:15,526 - DEBUG - cur time: 2024-05-18T23:59:59.999 == next bar open time: 2024-05-19T00:00:00.000 == close pos time: 2024-05-24T00:00:00.000
2024-12-12 23:54:15,538 - DEBUG - close time 2024-05-18T23:59:59.999 == vol_threshold: 7687857.799999996
2024-12-12 23:54:15,540 - DEBUG - 2024-05-18T23:59:59.999 == all trade symbol 238 == remain 166 after VOL filter
2024-12-12 23:54:15,540 - DEBUG - sorted_long_factors: shape: (166, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ COMBOUSDT  ┆ -6.970768    ┆ 0    ┆ 165          │
│ RIFUSDT    ┆ -4.967937    ┆ 1    ┆ 164          │
│ PORTALUSDT ┆ -4.956731    ┆ 2    ┆ 163          │
│ BELUSDT    ┆ -4.76125     ┆ 3    ┆ 162          │
│ BLZUSDT    ┆ -4.551396    ┆ 4    ┆ 161          │
│ HFTUSDT    ┆ -3.451193    ┆ 5    ┆ 160          │
│ TLMUSDT    ┆ -3.293292    ┆ 6    ┆ 159          │
│ WIFUSDT    ┆ -3.198322    ┆ 7    ┆ 158          │
│ CTSIUSDT   ┆ -3.031854    ┆ 8    ┆ 157          │
│ FLOWUSDT   ┆ -3.007731    ┆ 9    ┆ 156          │
│ …          ┆ …            ┆ …    ┆ …            │
│ JOEUSDT    ┆ 2.805192     ┆ 156  ┆ 9            │
│ ZETAUSDT   ┆ 2.84454      ┆ 157  ┆ 8            │
│ TIAUSDT    ┆ 2.989407     ┆ 158  ┆ 7            │
│ TRXUSDT    ┆ 3.086413     ┆ 159  ┆ 6            │
│ POWRUSDT   ┆ 3.131053     ┆ 160  ┆ 5            │
│ THETAUSDT  ┆ 3.255909     ┆ 161  ┆ 4            │
│ XEMUSDT    ┆ 3.389996     ┆ 162  ┆ 3            │
│ ONEUSDT    ┆ 3.820299     ┆ 163  ┆ 2            │
│ ASTRUSDT   ┆ 3.979928     ┆ 164  ┆ 1            │
│ DARUSDT    ┆ 4.777395     ┆ 165  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,548 - WARNING - 2024-05-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,548 - INFO - cur close time: 2024-05-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:15,548 - DEBUG - mean expected ret (mean factor): -0.0782276917033607
2024-12-12 23:54:15,554 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,554 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,555 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.02627     ┆ 0.20358     ┆ 0.10818     ┆ 0.0095332   ┆ … ┆ 0.02359 ┆ null   ┆ null    ┆ 0.5862  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,560 - DEBUG - update position: 2024-05-18T23:59:59.999 === diff_trading_value: 354876.26049469574 == cash: 113405.46931926734 
2024-12-12 23:54:15,560 - INFO - pnl: 2024-05-18T23:59:59.999 113405.46931926734 === -0.911%
2024-12-12 23:54:15,564 - DEBUG - cur time: 2024-05-19T23:59:59.999 == next bar open time: 2024-05-20T00:00:00.000 == close pos time: 2024-05-25T00:00:00.000
2024-12-12 23:54:15,565 - INFO - pnl: 2024-05-19T23:59:59.999 114255.49487225112 === 0.750%
2024-12-12 23:54:15,568 - DEBUG - cur time: 2024-05-20T23:59:59.999 == next bar open time: 2024-05-21T00:00:00.000 == close pos time: 2024-05-26T00:00:00.000
2024-12-12 23:54:15,569 - INFO - pnl: 2024-05-20T23:59:59.999 115724.42107369863 === 1.286%
2024-12-12 23:54:15,572 - DEBUG - cur time: 2024-05-21T23:59:59.999 == next bar open time: 2024-05-22T00:00:00.000 == close pos time: 2024-05-27T00:00:00.000
2024-12-12 23:54:15,572 - INFO - pnl: 2024-05-21T23:59:59.999 114068.82616453625 === -1.431%
2024-12-12 23:54:15,575 - DEBUG - cur time: 2024-05-22T23:59:59.999 == next bar open time: 2024-05-23T00:00:00.000 == close pos time: 2024-05-28T00:00:00.000
2024-12-12 23:54:15,578 - INFO - pnl: 2024-05-22T23:59:59.999 112789.39185141037 === -1.122%
2024-12-12 23:54:15,582 - DEBUG - cur time: 2024-05-23T23:59:59.999 == next bar open time: 2024-05-24T00:00:00.000 == close pos time: 2024-05-29T00:00:00.000
2024-12-12 23:54:15,593 - DEBUG - close time 2024-05-23T23:59:59.999 == vol_threshold: 18330983.0
2024-12-12 23:54:15,593 - DEBUG - 2024-05-23T23:59:59.999 == all trade symbol 241 == remain 168 after VOL filter
2024-12-12 23:54:15,595 - DEBUG - sorted_long_factors: shape: (168, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ AGIXUSDT    ┆ -4.823719    ┆ 0    ┆ 167          │
│ WLDUSDT     ┆ -4.289194    ┆ 1    ┆ 166          │
│ RIFUSDT     ┆ -3.972128    ┆ 2    ┆ 165          │
│ BNXUSDT     ┆ -3.903905    ┆ 3    ┆ 164          │
│ KASUSDT     ┆ -3.64113     ┆ 4    ┆ 163          │
│ AIUSDT      ┆ -3.508598    ┆ 5    ┆ 162          │
│ OCEANUSDT   ┆ -3.477871    ┆ 6    ┆ 161          │
│ NFPUSDT     ┆ -3.331775    ┆ 7    ┆ 160          │
│ ALTUSDT     ┆ -3.269968    ┆ 8    ┆ 159          │
│ TONUSDT     ┆ -3.229506    ┆ 9    ┆ 158          │
│ …           ┆ …            ┆ …    ┆ …            │
│ OXTUSDT     ┆ 2.76128      ┆ 158  ┆ 9            │
│ 1000XECUSDT ┆ 2.815442     ┆ 159  ┆ 8            │
│ FLOWUSDT    ┆ 3.096697     ┆ 160  ┆ 7            │
│ ONTUSDT     ┆ 3.105543     ┆ 161  ┆ 6            │
│ POWRUSDT    ┆ 3.164412     ┆ 162  ┆ 5            │
│ SKLUSDT     ┆ 3.245337     ┆ 163  ┆ 4            │
│ XTZUSDT     ┆ 3.606862     ┆ 164  ┆ 3            │
│ TUSDT       ┆ 3.991726     ┆ 165  ┆ 2            │
│ PEOPLEUSDT  ┆ 5.363248     ┆ 166  ┆ 1            │
│ EDUUSDT     ┆ 5.892746     ┆ 167  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,601 - INFO - cur close time: 2024-05-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:15,601 - DEBUG - mean expected ret (mean factor): -0.11969417021058418
2024-12-12 23:54:15,606 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,606 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,606 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.035217    ┆ 0.22651     ┆ 0.11416     ┆ 0.0149396   ┆ … ┆ 0.02373 ┆ null   ┆ null    ┆ 0.571   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,612 - DEBUG - update position: 2024-05-23T23:59:59.999 === diff_trading_value: 341921.2487714606 == cash: 113038.86497088229 
2024-12-12 23:54:15,614 - INFO - pnl: 2024-05-23T23:59:59.999 113038.86497088229 === 0.221%
2024-12-12 23:54:15,616 - DEBUG - cur time: 2024-05-24T23:59:59.999 == next bar open time: 2024-05-25T00:00:00.000 == close pos time: 2024-05-30T00:00:00.000
2024-12-12 23:54:15,617 - INFO - pnl: 2024-05-24T23:59:59.999 113727.02025298229 === 0.609%
2024-12-12 23:54:15,621 - DEBUG - cur time: 2024-05-25T23:59:59.999 == next bar open time: 2024-05-26T00:00:00.000 == close pos time: 2024-05-31T00:00:00.000
2024-12-12 23:54:15,621 - INFO - pnl: 2024-05-25T23:59:59.999 112537.5449494475 === -1.046%
2024-12-12 23:54:15,625 - DEBUG - cur time: 2024-05-26T23:59:59.999 == next bar open time: 2024-05-27T00:00:00.000 == close pos time: 2024-06-01T00:00:00.000
2024-12-12 23:54:15,625 - INFO - pnl: 2024-05-26T23:59:59.999 113504.09306393458 === 0.859%
2024-12-12 23:54:15,631 - DEBUG - cur time: 2024-05-27T23:59:59.999 == next bar open time: 2024-05-28T00:00:00.000 == close pos time: 2024-06-02T00:00:00.000
2024-12-12 23:54:15,632 - INFO - pnl: 2024-05-27T23:59:59.999 112437.12299903802 === -0.940%
2024-12-12 23:54:15,634 - DEBUG - cur time: 2024-05-28T23:59:59.999 == next bar open time: 2024-05-29T00:00:00.000 == close pos time: 2024-06-03T00:00:00.000
2024-12-12 23:54:15,646 - DEBUG - close time 2024-05-28T23:59:59.999 == vol_threshold: 13187776.899999999
2024-12-12 23:54:15,647 - DEBUG - 2024-05-28T23:59:59.999 == all trade symbol 243 == remain 170 after VOL filter
2024-12-12 23:54:15,649 - DEBUG - sorted_long_factors: shape: (170, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ RIFUSDT    ┆ -4.376827    ┆ 0    ┆ 169          │
│ PORTALUSDT ┆ -4.252605    ┆ 1    ┆ 168          │
│ MAVUSDT    ┆ -4.17696     ┆ 2    ┆ 167          │
│ AIUSDT     ┆ -3.923132    ┆ 3    ┆ 166          │
│ BNXUSDT    ┆ -3.533476    ┆ 4    ┆ 165          │
│ WLDUSDT    ┆ -3.471945    ┆ 5    ┆ 164          │
│ JTOUSDT    ┆ -3.289434    ┆ 6    ┆ 163          │
│ FTMUSDT    ┆ -3.245404    ┆ 7    ┆ 162          │
│ DOGEUSDT   ┆ -2.961494    ┆ 8    ┆ 161          │
│ DYMUSDT    ┆ -2.915046    ┆ 9    ┆ 160          │
│ …          ┆ …            ┆ …    ┆ …            │
│ WAXPUSDT   ┆ 2.859963     ┆ 160  ┆ 9            │
│ 1INCHUSDT  ┆ 2.875754     ┆ 161  ┆ 8            │
│ RVNUSDT    ┆ 3.23569      ┆ 162  ┆ 7            │
│ SKLUSDT    ┆ 3.338687     ┆ 163  ┆ 6            │
│ KEYUSDT    ┆ 3.359026     ┆ 164  ┆ 5            │
│ BATUSDT    ┆ 3.47503      ┆ 165  ┆ 4            │
│ UNIUSDT    ┆ 3.627827     ┆ 166  ┆ 3            │
│ ATAUSDT    ┆ 3.641775     ┆ 167  ┆ 2            │
│ KLAYUSDT   ┆ 4.372126     ┆ 168  ┆ 1            │
│ HIGHUSDT   ┆ 5.385582     ┆ 169  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,655 - WARNING - 2024-05-28T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,655 - INFO - cur close time: 2024-05-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:15,655 - DEBUG - mean expected ret (mean factor): -0.05190560642863928
2024-12-12 23:54:15,660 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,660 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,660 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.041152    ┆ 0.29484     ┆ 0.11473     ┆ 0.0160126   ┆ … ┆ 0.02484 ┆ null   ┆ null    ┆ 0.5476  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,666 - DEBUG - update position: 2024-05-28T23:59:59.999 === diff_trading_value: 275145.87345166865 == cash: 111883.81972561692 
2024-12-12 23:54:15,667 - INFO - pnl: 2024-05-28T23:59:59.999 111883.81972561692 === -0.492%
2024-12-12 23:54:15,671 - DEBUG - cur time: 2024-05-29T23:59:59.999 == next bar open time: 2024-05-30T00:00:00.000 == close pos time: 2024-06-04T00:00:00.000
2024-12-12 23:54:15,672 - INFO - pnl: 2024-05-29T23:59:59.999 112061.88699432954 === 0.159%
2024-12-12 23:54:15,676 - DEBUG - cur time: 2024-05-30T23:59:59.999 == next bar open time: 2024-05-31T00:00:00.000 == close pos time: 2024-06-05T00:00:00.000
2024-12-12 23:54:15,676 - INFO - pnl: 2024-05-30T23:59:59.999 111513.78764269582 === -0.489%
2024-12-12 23:54:15,681 - DEBUG - cur time: 2024-05-31T23:59:59.999 == next bar open time: 2024-06-01T00:00:00.000 == close pos time: 2024-06-06T00:00:00.000
2024-12-12 23:54:15,681 - INFO - pnl: 2024-05-31T23:59:59.999 112067.17430516331 === 0.496%
2024-12-12 23:54:15,684 - DEBUG - cur time: 2024-06-01T23:59:59.999 == next bar open time: 2024-06-02T00:00:00.000 == close pos time: 2024-06-07T00:00:00.000
2024-12-12 23:54:15,688 - INFO - pnl: 2024-06-01T23:59:59.999 111606.1967936522 === -0.411%
2024-12-12 23:54:15,693 - DEBUG - cur time: 2024-06-02T23:59:59.999 == next bar open time: 2024-06-03T00:00:00.000 == close pos time: 2024-06-08T00:00:00.000
2024-12-12 23:54:15,705 - DEBUG - close time 2024-06-02T23:59:59.999 == vol_threshold: 11019920.799999999
2024-12-12 23:54:15,706 - DEBUG - 2024-06-02T23:59:59.999 == all trade symbol 243 == remain 170 after VOL filter
2024-12-12 23:54:15,708 - DEBUG - sorted_long_factors: shape: (170, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT      ┆ -5.370975    ┆ 0    ┆ 169          │
│ OPUSDT       ┆ -4.09514     ┆ 1    ┆ 168          │
│ 1000SHIBUSDT ┆ -3.981024    ┆ 2    ┆ 167          │
│ CFXUSDT      ┆ -3.543341    ┆ 3    ┆ 166          │
│ STRKUSDT     ┆ -3.223429    ┆ 4    ┆ 165          │
│ BELUSDT      ┆ -3.122809    ┆ 5    ┆ 164          │
│ 1000SATSUSDT ┆ -3.078428    ┆ 6    ┆ 163          │
│ BNXUSDT      ┆ -2.991902    ┆ 7    ┆ 162          │
│ ACEUSDT      ┆ -2.974151    ┆ 8    ┆ 161          │
│ DARUSDT      ┆ -2.949089    ┆ 9    ┆ 160          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CTSIUSDT     ┆ 3.797387     ┆ 160  ┆ 9            │
│ STEEMUSDT    ┆ 3.980708     ┆ 161  ┆ 8            │
│ REEFUSDT     ┆ 4.039766     ┆ 162  ┆ 7            │
│ STGUSDT      ┆ 4.152993     ┆ 163  ┆ 6            │
│ SUPERUSDT    ┆ 4.304704     ┆ 164  ┆ 5            │
│ KLAYUSDT     ┆ 4.702948     ┆ 165  ┆ 4            │
│ ICXUSDT      ┆ 5.99423      ┆ 166  ┆ 3            │
│ STMXUSDT     ┆ 6.599142     ┆ 167  ┆ 2            │
│ ORBSUSDT     ┆ 6.860712     ┆ 168  ┆ 1            │
│ KASUSDT      ┆ 6.965733     ┆ 169  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,714 - WARNING - 2024-06-02T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,714 - INFO - cur close time: 2024-06-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:15,714 - DEBUG - mean expected ret (mean factor): 0.011535626934286825
2024-12-12 23:54:15,719 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,719 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,719 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.03171     ┆ 0.24391     ┆ 0.11652     ┆ 0.0146338   ┆ … ┆ 0.02313 ┆ null   ┆ null    ┆ 0.5087  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,725 - DEBUG - update position: 2024-06-02T23:59:59.999 === diff_trading_value: 309727.86851299845 == cash: 109800.63289673475 
2024-12-12 23:54:15,725 - INFO - pnl: 2024-06-02T23:59:59.999 109800.63289673475 === -1.618%
2024-12-12 23:54:15,731 - DEBUG - cur time: 2024-06-03T23:59:59.999 == next bar open time: 2024-06-04T00:00:00.000 == close pos time: 2024-06-09T00:00:00.000
2024-12-12 23:54:15,733 - INFO - pnl: 2024-06-03T23:59:59.999 105834.91599646347 === -3.612%
2024-12-12 23:54:15,736 - DEBUG - cur time: 2024-06-04T23:59:59.999 == next bar open time: 2024-06-05T00:00:00.000 == close pos time: 2024-06-10T00:00:00.000
2024-12-12 23:54:15,738 - INFO - pnl: 2024-06-04T23:59:59.999 105296.20348496319 === -0.509%
2024-12-12 23:54:15,739 - DEBUG - cur time: 2024-06-05T23:59:59.999 == next bar open time: 2024-06-06T00:00:00.000 == close pos time: 2024-06-11T00:00:00.000
2024-12-12 23:54:15,743 - INFO - pnl: 2024-06-05T23:59:59.999 105584.14813938255 === 0.273%
2024-12-12 23:54:15,746 - DEBUG - cur time: 2024-06-06T23:59:59.999 == next bar open time: 2024-06-07T00:00:00.000 == close pos time: 2024-06-12T00:00:00.000
2024-12-12 23:54:15,747 - INFO - pnl: 2024-06-06T23:59:59.999 104380.09969417744 === -1.140%
2024-12-12 23:54:15,753 - DEBUG - cur time: 2024-06-07T23:59:59.999 == next bar open time: 2024-06-08T00:00:00.000 == close pos time: 2024-06-13T00:00:00.000
2024-12-12 23:54:15,764 - DEBUG - close time 2024-06-07T23:59:59.999 == vol_threshold: 25335008.259999998
2024-12-12 23:54:15,765 - DEBUG - 2024-06-07T23:59:59.999 == all trade symbol 242 == remain 169 after VOL filter
2024-12-12 23:54:15,767 - DEBUG - sorted_long_factors: shape: (169, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ BOMEUSDT   ┆ -4.921443    ┆ 0    ┆ 168          │
│ BLZUSDT    ┆ -4.359386    ┆ 1    ┆ 167          │
│ WIFUSDT    ┆ -4.344617    ┆ 2    ┆ 166          │
│ AXLUSDT    ┆ -4.203089    ┆ 3    ┆ 165          │
│ PORTALUSDT ┆ -4.143609    ┆ 4    ┆ 164          │
│ ALTUSDT    ┆ -3.750136    ┆ 5    ┆ 163          │
│ NFPUSDT    ┆ -3.428055    ┆ 6    ┆ 162          │
│ WLDUSDT    ┆ -3.419969    ┆ 7    ┆ 161          │
│ MAVUSDT    ┆ -3.407945    ┆ 8    ┆ 160          │
│ DOGEUSDT   ┆ -3.235147    ┆ 9    ┆ 159          │
│ …          ┆ …            ┆ …    ┆ …            │
│ STXUSDT    ┆ 3.018935     ┆ 159  ┆ 9            │
│ 1INCHUSDT  ┆ 3.464636     ┆ 160  ┆ 8            │
│ STMXUSDT   ┆ 3.667103     ┆ 161  ┆ 7            │
│ OMGUSDT    ┆ 3.907264     ┆ 162  ┆ 6            │
│ XEMUSDT    ┆ 4.013432     ┆ 163  ┆ 5            │
│ XTZUSDT    ┆ 4.072284     ┆ 164  ┆ 4            │
│ JASMYUSDT  ┆ 4.952302     ┆ 165  ┆ 3            │
│ ROSEUSDT   ┆ 4.980345     ┆ 166  ┆ 2            │
│ HIGHUSDT   ┆ 8.625926     ┆ 167  ┆ 1            │
│ ARKUSDT    ┆ 9.040355     ┆ 168  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,775 - WARNING - 2024-06-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,776 - INFO - cur close time: 2024-06-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:15,776 - DEBUG - mean expected ret (mean factor): -0.10670543649766215
2024-12-12 23:54:15,781 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,781 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,781 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028801    ┆ 0.28249     ┆ 0.10906     ┆ 0.0127792   ┆ … ┆ 0.02264 ┆ null   ┆ null    ┆ 0.4798  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,789 - DEBUG - update position: 2024-06-07T23:59:59.999 === diff_trading_value: 307529.8474267449 == cash: 106901.10308878981 
2024-12-12 23:54:15,791 - INFO - pnl: 2024-06-07T23:59:59.999 106901.10308878981 === 2.415%
2024-12-12 23:54:15,795 - DEBUG - cur time: 2024-06-08T23:59:59.999 == next bar open time: 2024-06-09T00:00:00.000 == close pos time: 2024-06-14T00:00:00.000
2024-12-12 23:54:15,797 - INFO - pnl: 2024-06-08T23:59:59.999 105539.92467944817 === -1.273%
2024-12-12 23:54:15,805 - DEBUG - cur time: 2024-06-09T23:59:59.999 == next bar open time: 2024-06-10T00:00:00.000 == close pos time: 2024-06-15T00:00:00.000
2024-12-12 23:54:15,807 - INFO - pnl: 2024-06-09T23:59:59.999 106621.82171822892 === 1.025%
2024-12-12 23:54:15,812 - DEBUG - cur time: 2024-06-10T23:59:59.999 == next bar open time: 2024-06-11T00:00:00.000 == close pos time: 2024-06-16T00:00:00.000
2024-12-12 23:54:15,814 - INFO - pnl: 2024-06-10T23:59:59.999 108005.8898143215 === 1.298%
2024-12-12 23:54:15,820 - DEBUG - cur time: 2024-06-11T23:59:59.999 == next bar open time: 2024-06-12T00:00:00.000 == close pos time: 2024-06-17T00:00:00.000
2024-12-12 23:54:15,821 - INFO - pnl: 2024-06-11T23:59:59.999 108925.31516171937 === 0.851%
2024-12-12 23:54:15,825 - DEBUG - cur time: 2024-06-12T23:59:59.999 == next bar open time: 2024-06-13T00:00:00.000 == close pos time: 2024-06-18T00:00:00.000
2024-12-12 23:54:15,846 - DEBUG - close time 2024-06-12T23:59:59.999 == vol_threshold: 14000873.959999997
2024-12-12 23:54:15,847 - DEBUG - 2024-06-12T23:59:59.999 == all trade symbol 243 == remain 170 after VOL filter
2024-12-12 23:54:15,849 - DEBUG - sorted_long_factors: shape: (170, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ALTUSDT      ┆ -5.163541    ┆ 0    ┆ 169          │
│ ONDOUSDT     ┆ -4.068912    ┆ 1    ┆ 168          │
│ ENAUSDT      ┆ -3.925009    ┆ 2    ┆ 167          │
│ HBARUSDT     ┆ -3.899854    ┆ 3    ┆ 166          │
│ MANTAUSDT    ┆ -3.764966    ┆ 4    ┆ 165          │
│ CHZUSDT      ┆ -3.726849    ┆ 5    ┆ 164          │
│ PORTALUSDT   ┆ -3.654302    ┆ 6    ┆ 163          │
│ WAXPUSDT     ┆ -3.642282    ┆ 7    ┆ 162          │
│ HIFIUSDT     ┆ -3.378861    ┆ 8    ┆ 161          │
│ RENUSDT      ┆ -3.36159     ┆ 9    ┆ 160          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ATAUSDT      ┆ 3.865851     ┆ 160  ┆ 9            │
│ C98USDT      ┆ 4.018228     ┆ 161  ┆ 8            │
│ XTZUSDT      ┆ 4.150809     ┆ 162  ┆ 7            │
│ STMXUSDT     ┆ 4.564695     ┆ 163  ┆ 6            │
│ BNXUSDT      ┆ 4.566842     ┆ 164  ┆ 5            │
│ IOTAUSDT     ┆ 4.956881     ┆ 165  ┆ 4            │
│ TRXUSDT      ┆ 5.183543     ┆ 166  ┆ 3            │
│ DODOXUSDT    ┆ 5.57728      ┆ 167  ┆ 2            │
│ DOGEUSDT     ┆ 5.635849     ┆ 168  ┆ 1            │
│ 1000SHIBUSDT ┆ 6.011705     ┆ 169  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,861 - WARNING - 2024-06-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,862 - INFO - cur close time: 2024-06-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:15,862 - DEBUG - mean expected ret (mean factor): 0.06808776193274134
2024-12-12 23:54:15,868 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,868 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,870 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028962    ┆ 0.21971     ┆ 0.10624     ┆ 0.0132106   ┆ … ┆ 0.02101 ┆ null   ┆ null    ┆ 0.4494  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,879 - DEBUG - update position: 2024-06-12T23:59:59.999 === diff_trading_value: 322595.9356666974 == cash: 109078.46347910505 
2024-12-12 23:54:15,881 - INFO - pnl: 2024-06-12T23:59:59.999 109078.46347910505 === 0.141%
2024-12-12 23:54:15,887 - DEBUG - cur time: 2024-06-13T23:59:59.999 == next bar open time: 2024-06-14T00:00:00.000 == close pos time: 2024-06-19T00:00:00.000
2024-12-12 23:54:15,888 - INFO - pnl: 2024-06-13T23:59:59.999 110113.938085226 === 0.949%
2024-12-12 23:54:15,896 - DEBUG - cur time: 2024-06-14T23:59:59.999 == next bar open time: 2024-06-15T00:00:00.000 == close pos time: 2024-06-20T00:00:00.000
2024-12-12 23:54:15,897 - INFO - pnl: 2024-06-14T23:59:59.999 110362.98408883264 === 0.226%
2024-12-12 23:54:15,906 - DEBUG - cur time: 2024-06-15T23:59:59.999 == next bar open time: 2024-06-16T00:00:00.000 == close pos time: 2024-06-21T00:00:00.000
2024-12-12 23:54:15,909 - INFO - pnl: 2024-06-15T23:59:59.999 110630.71489399887 === 0.243%
2024-12-12 23:54:15,916 - DEBUG - cur time: 2024-06-16T23:59:59.999 == next bar open time: 2024-06-17T00:00:00.000 == close pos time: 2024-06-22T00:00:00.000
2024-12-12 23:54:15,919 - INFO - pnl: 2024-06-16T23:59:59.999 110950.54195753527 === 0.289%
2024-12-12 23:54:15,925 - DEBUG - cur time: 2024-06-17T23:59:59.999 == next bar open time: 2024-06-18T00:00:00.000 == close pos time: 2024-06-23T00:00:00.000
2024-12-12 23:54:15,944 - DEBUG - close time 2024-06-17T23:59:59.999 == vol_threshold: 18851768.479999997
2024-12-12 23:54:15,945 - DEBUG - 2024-06-17T23:59:59.999 == all trade symbol 244 == remain 171 after VOL filter
2024-12-12 23:54:15,946 - DEBUG - sorted_long_factors: shape: (171, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LUNA2USDT    ┆ -4.05028     ┆ 0    ┆ 170          │
│ CHZUSDT      ┆ -3.845937    ┆ 1    ┆ 169          │
│ 1000RATSUSDT ┆ -3.550961    ┆ 2    ┆ 168          │
│ BOMEUSDT     ┆ -3.347239    ┆ 3    ┆ 167          │
│ DOGEUSDT     ┆ -3.320325    ┆ 4    ┆ 166          │
│ BICOUSDT     ┆ -3.313821    ┆ 5    ┆ 165          │
│ RDNTUSDT     ┆ -3.303694    ┆ 6    ┆ 164          │
│ DYDXUSDT     ┆ -3.20527     ┆ 7    ┆ 163          │
│ 1000SATSUSDT ┆ -3.06001     ┆ 8    ┆ 162          │
│ C98USDT      ┆ -3.04962     ┆ 9    ┆ 161          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CRVUSDT      ┆ 3.207044     ┆ 161  ┆ 9            │
│ ALGOUSDT     ┆ 3.223785     ┆ 162  ┆ 8            │
│ XEMUSDT      ┆ 3.306595     ┆ 163  ┆ 7            │
│ FLOWUSDT     ┆ 3.401992     ┆ 164  ┆ 6            │
│ BATUSDT      ┆ 3.651187     ┆ 165  ┆ 5            │
│ MANAUSDT     ┆ 4.002405     ┆ 166  ┆ 4            │
│ RIFUSDT      ┆ 4.02929      ┆ 167  ┆ 3            │
│ UNFIUSDT     ┆ 4.061013     ┆ 168  ┆ 2            │
│ IDUSDT       ┆ 4.490715     ┆ 169  ┆ 1            │
│ LOOMUSDT     ┆ 4.810953     ┆ 170  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:15,953 - WARNING - 2024-06-17T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:15,953 - INFO - cur close time: 2024-06-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:15,953 - DEBUG - mean expected ret (mean factor): -0.10227341532709815
2024-12-12 23:54:15,958 - DEBUG - begin to update pos: =========
2024-12-12 23:54:15,958 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,958 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022957    ┆ 0.18186     ┆ 0.09484     ┆ 0.011162    ┆ … ┆ 0.01793 ┆ null   ┆ null    ┆ 0.3722  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:15,964 - DEBUG - update position: 2024-06-17T23:59:59.999 === diff_trading_value: 307311.8320826321 == cash: 113634.08284476462 
2024-12-12 23:54:15,966 - INFO - pnl: 2024-06-17T23:59:59.999 113634.08284476462 === 2.419%
2024-12-12 23:54:15,969 - DEBUG - cur time: 2024-06-18T23:59:59.999 == next bar open time: 2024-06-19T00:00:00.000 == close pos time: 2024-06-24T00:00:00.000
2024-12-12 23:54:15,971 - INFO - pnl: 2024-06-18T23:59:59.999 117980.17845450305 === 3.825%
2024-12-12 23:54:15,974 - DEBUG - cur time: 2024-06-19T23:59:59.999 == next bar open time: 2024-06-20T00:00:00.000 == close pos time: 2024-06-25T00:00:00.000
2024-12-12 23:54:15,975 - INFO - pnl: 2024-06-19T23:59:59.999 117446.15258183473 === -0.453%
2024-12-12 23:54:15,983 - DEBUG - cur time: 2024-06-20T23:59:59.999 == next bar open time: 2024-06-21T00:00:00.000 == close pos time: 2024-06-26T00:00:00.000
2024-12-12 23:54:15,986 - INFO - pnl: 2024-06-20T23:59:59.999 117035.15910251795 === -0.350%
2024-12-12 23:54:15,991 - DEBUG - cur time: 2024-06-21T23:59:59.999 == next bar open time: 2024-06-22T00:00:00.000 == close pos time: 2024-06-27T00:00:00.000
2024-12-12 23:54:15,992 - INFO - pnl: 2024-06-21T23:59:59.999 116565.8824242772 === -0.401%
2024-12-12 23:54:15,997 - DEBUG - cur time: 2024-06-22T23:59:59.999 == next bar open time: 2024-06-23T00:00:00.000 == close pos time: 2024-06-28T00:00:00.000
2024-12-12 23:54:16,010 - DEBUG - close time 2024-06-22T23:59:59.999 == vol_threshold: 7238301.02
2024-12-12 23:54:16,011 - DEBUG - 2024-06-22T23:59:59.999 == all trade symbol 245 == remain 171 after VOL filter
2024-12-12 23:54:16,013 - DEBUG - sorted_long_factors: shape: (171, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CHRUSDT      ┆ -5.078466    ┆ 0    ┆ 170          │
│ IOTXUSDT     ┆ -4.555788    ┆ 1    ┆ 169          │
│ ACHUSDT      ┆ -4.283815    ┆ 2    ┆ 168          │
│ ZILUSDT      ┆ -4.152495    ┆ 3    ┆ 167          │
│ CHZUSDT      ┆ -3.703459    ┆ 4    ┆ 166          │
│ WAXPUSDT     ┆ -3.634274    ┆ 5    ┆ 165          │
│ ALPHAUSDT    ┆ -3.621694    ┆ 6    ┆ 164          │
│ IOSTUSDT     ┆ -3.145914    ┆ 7    ┆ 163          │
│ ETHFIUSDT    ┆ -2.958959    ┆ 8    ┆ 162          │
│ 1000LUNCUSDT ┆ -2.844255    ┆ 9    ┆ 161          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ASTRUSDT     ┆ 3.960988     ┆ 161  ┆ 9            │
│ BICOUSDT     ┆ 3.985348     ┆ 162  ┆ 8            │
│ DENTUSDT     ┆ 4.892489     ┆ 163  ┆ 7            │
│ TLMUSDT      ┆ 5.014492     ┆ 164  ┆ 6            │
│ KASUSDT      ┆ 5.883313     ┆ 165  ┆ 5            │
│ AMBUSDT      ┆ 6.036568     ┆ 166  ┆ 4            │
│ BNXUSDT      ┆ 6.226165     ┆ 167  ┆ 3            │
│ OMGUSDT      ┆ 6.876862     ┆ 168  ┆ 2            │
│ IDUSDT       ┆ 7.128033     ┆ 169  ┆ 1            │
│ ATAUSDT      ┆ 7.954422     ┆ 170  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,022 - WARNING - 2024-06-22T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:16,023 - INFO - cur close time: 2024-06-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:16,023 - DEBUG - mean expected ret (mean factor): 0.12107196557420177
2024-12-12 23:54:16,028 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,029 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,029 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.020636    ┆ 0.1701      ┆ 0.07634     ┆ 0.0114174   ┆ … ┆ 0.01733 ┆ null   ┆ null    ┆ 0.3594  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,038 - DEBUG - update position: 2024-06-22T23:59:59.999 === diff_trading_value: 356042.77696917334 == cash: 111565.91535530722 
2024-12-12 23:54:16,041 - INFO - pnl: 2024-06-22T23:59:59.999 111565.91535530722 === -4.289%
2024-12-12 23:54:16,049 - DEBUG - cur time: 2024-06-23T23:59:59.999 == next bar open time: 2024-06-24T00:00:00.000 == close pos time: 2024-06-29T00:00:00.000
2024-12-12 23:54:16,050 - INFO - pnl: 2024-06-23T23:59:59.999 112181.17734156382 === 0.551%
2024-12-12 23:54:16,055 - DEBUG - cur time: 2024-06-24T23:59:59.999 == next bar open time: 2024-06-25T00:00:00.000 == close pos time: 2024-06-30T00:00:00.000
2024-12-12 23:54:16,056 - INFO - pnl: 2024-06-24T23:59:59.999 112887.78679238589 === 0.630%
2024-12-12 23:54:16,065 - DEBUG - cur time: 2024-06-25T23:59:59.999 == next bar open time: 2024-06-26T00:00:00.000 == close pos time: 2024-07-01T00:00:00.000
2024-12-12 23:54:16,067 - INFO - pnl: 2024-06-25T23:59:59.999 113844.02823865692 === 0.847%
2024-12-12 23:54:16,071 - DEBUG - cur time: 2024-06-26T23:59:59.999 == next bar open time: 2024-06-27T00:00:00.000 == close pos time: 2024-07-02T00:00:00.000
2024-12-12 23:54:16,072 - INFO - pnl: 2024-06-26T23:59:59.999 113041.13110641537 === -0.705%
2024-12-12 23:54:16,077 - DEBUG - cur time: 2024-06-27T23:59:59.999 == next bar open time: 2024-06-28T00:00:00.000 == close pos time: 2024-07-03T00:00:00.000
2024-12-12 23:54:16,088 - DEBUG - close time 2024-06-27T23:59:59.999 == vol_threshold: 9247844.65
2024-12-12 23:54:16,089 - DEBUG - 2024-06-27T23:59:59.999 == all trade symbol 246 == remain 172 after VOL filter
2024-12-12 23:54:16,090 - DEBUG - sorted_long_factors: shape: (172, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ STGUSDT   ┆ -5.060161    ┆ 0    ┆ 171          │
│ SKLUSDT   ┆ -3.949325    ┆ 1    ┆ 170          │
│ JOEUSDT   ┆ -3.927102    ┆ 2    ┆ 169          │
│ HIGHUSDT  ┆ -3.540793    ┆ 3    ┆ 168          │
│ DODOXUSDT ┆ -3.315422    ┆ 4    ┆ 167          │
│ ARKUSDT   ┆ -3.068553    ┆ 5    ┆ 166          │
│ ETHFIUSDT ┆ -2.991166    ┆ 6    ┆ 165          │
│ ORBSUSDT  ┆ -2.783943    ┆ 7    ┆ 164          │
│ ALTUSDT   ┆ -2.768289    ┆ 8    ┆ 163          │
│ AXLUSDT   ┆ -2.682256    ┆ 9    ┆ 162          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ALGOUSDT  ┆ 4.243341     ┆ 162  ┆ 9            │
│ XEMUSDT   ┆ 4.405874     ┆ 163  ┆ 8            │
│ ATAUSDT   ┆ 4.417685     ┆ 164  ┆ 7            │
│ C98USDT   ┆ 5.099543     ┆ 165  ┆ 6            │
│ BNXUSDT   ┆ 5.132103     ┆ 166  ┆ 5            │
│ BATUSDT   ┆ 5.805884     ┆ 167  ┆ 4            │
│ HOTUSDT   ┆ 5.84214      ┆ 168  ┆ 3            │
│ FLMUSDT   ┆ 5.895434     ┆ 169  ┆ 2            │
│ FLOWUSDT  ┆ 6.069112     ┆ 170  ┆ 1            │
│ DENTUSDT  ┆ 7.372055     ┆ 171  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,096 - WARNING - 2024-06-27T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:16,096 - INFO - cur close time: 2024-06-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:16,096 - DEBUG - mean expected ret (mean factor): 0.25292305272616356
2024-12-12 23:54:16,100 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,100 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,101 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024654    ┆ 0.17401     ┆ 0.08225     ┆ 0.0125913   ┆ … ┆ 0.01809 ┆ null   ┆ null    ┆ 0.3736  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,106 - DEBUG - update position: 2024-06-27T23:59:59.999 === diff_trading_value: 304890.0287084698 == cash: 112689.64724193398 
2024-12-12 23:54:16,107 - INFO - pnl: 2024-06-27T23:59:59.999 112689.64724193398 === -0.311%
2024-12-12 23:54:16,110 - DEBUG - cur time: 2024-06-28T23:59:59.999 == next bar open time: 2024-06-29T00:00:00.000 == close pos time: 2024-07-04T00:00:00.000
2024-12-12 23:54:16,111 - INFO - pnl: 2024-06-28T23:59:59.999 112648.370122777 === -0.037%
2024-12-12 23:54:16,114 - DEBUG - cur time: 2024-06-29T23:59:59.999 == next bar open time: 2024-06-30T00:00:00.000 == close pos time: 2024-07-05T00:00:00.000
2024-12-12 23:54:16,115 - INFO - pnl: 2024-06-29T23:59:59.999 111862.25191088054 === -0.698%
2024-12-12 23:54:16,118 - DEBUG - cur time: 2024-06-30T23:59:59.999 == next bar open time: 2024-07-01T00:00:00.000 == close pos time: 2024-07-06T00:00:00.000
2024-12-12 23:54:16,120 - INFO - pnl: 2024-06-30T23:59:59.999 111935.12770643586 === 0.065%
2024-12-12 23:54:16,121 - DEBUG - cur time: 2024-07-01T23:59:59.999 == next bar open time: 2024-07-02T00:00:00.000 == close pos time: 2024-07-07T00:00:00.000
2024-12-12 23:54:16,125 - INFO - pnl: 2024-07-01T23:59:59.999 111059.43783167192 === -0.782%
2024-12-12 23:54:16,130 - DEBUG - cur time: 2024-07-02T23:59:59.999 == next bar open time: 2024-07-03T00:00:00.000 == close pos time: 2024-07-08T00:00:00.000
2024-12-12 23:54:16,141 - DEBUG - close time 2024-07-02T23:59:59.999 == vol_threshold: 9092946.05
2024-12-12 23:54:16,142 - DEBUG - 2024-07-02T23:59:59.999 == all trade symbol 246 == remain 172 after VOL filter
2024-12-12 23:54:16,144 - DEBUG - sorted_long_factors: shape: (172, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ RDNTUSDT  ┆ -4.497071    ┆ 0    ┆ 171          │
│ ANKRUSDT  ┆ -3.626668    ┆ 1    ┆ 170          │
│ EDUUSDT   ┆ -3.270183    ┆ 2    ┆ 169          │
│ MANTAUSDT ┆ -2.978509    ┆ 3    ┆ 168          │
│ DYDXUSDT  ┆ -2.828333    ┆ 4    ┆ 167          │
│ XRPUSDT   ┆ -2.782528    ┆ 5    ┆ 166          │
│ ALTUSDT   ┆ -2.614106    ┆ 6    ┆ 165          │
│ MAGICUSDT ┆ -2.506567    ┆ 7    ┆ 164          │
│ LDOUSDT   ┆ -2.48311     ┆ 8    ┆ 163          │
│ FETUSDT   ┆ -2.427832    ┆ 9    ┆ 162          │
│ …         ┆ …            ┆ …    ┆ …            │
│ FTMUSDT   ┆ 3.078568     ┆ 162  ┆ 9            │
│ SXPUSDT   ┆ 3.428577     ┆ 163  ┆ 8            │
│ LINAUSDT  ┆ 3.535778     ┆ 164  ┆ 7            │
│ CHRUSDT   ┆ 3.868675     ┆ 165  ┆ 6            │
│ LSKUSDT   ┆ 4.040532     ┆ 166  ┆ 5            │
│ RENUSDT   ┆ 4.104792     ┆ 167  ┆ 4            │
│ IOSTUSDT  ┆ 4.213697     ┆ 168  ┆ 3            │
│ BNXUSDT   ┆ 4.470598     ┆ 169  ┆ 2            │
│ HOTUSDT   ┆ 4.489196     ┆ 170  ┆ 1            │
│ ARBUSDT   ┆ 5.041429     ┆ 171  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,151 - WARNING - 2024-07-02T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:16,152 - INFO - cur close time: 2024-07-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:16,152 - DEBUG - mean expected ret (mean factor): 0.007747879304519269
2024-12-12 23:54:16,155 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,155 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,155 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025402    ┆ 0.18312     ┆ 0.08182     ┆ 0.0113167   ┆ … ┆ 0.01769 ┆ null   ┆ null    ┆ 0.3613  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,160 - DEBUG - update position: 2024-07-02T23:59:59.999 === diff_trading_value: 308992.55903305777 == cash: 113732.03982316372 
2024-12-12 23:54:16,160 - INFO - pnl: 2024-07-02T23:59:59.999 113732.03982316372 === 2.406%
2024-12-12 23:54:16,166 - DEBUG - cur time: 2024-07-03T23:59:59.999 == next bar open time: 2024-07-04T00:00:00.000 == close pos time: 2024-07-09T00:00:00.000
2024-12-12 23:54:16,167 - INFO - pnl: 2024-07-03T23:59:59.999 114944.1148926372 === 1.066%
2024-12-12 23:54:16,171 - DEBUG - cur time: 2024-07-04T23:59:59.999 == next bar open time: 2024-07-05T00:00:00.000 == close pos time: 2024-07-10T00:00:00.000
2024-12-12 23:54:16,172 - INFO - pnl: 2024-07-04T23:59:59.999 114938.7789866659 === -0.005%
2024-12-12 23:54:16,175 - DEBUG - cur time: 2024-07-05T23:59:59.999 == next bar open time: 2024-07-06T00:00:00.000 == close pos time: 2024-07-11T00:00:00.000
2024-12-12 23:54:16,175 - INFO - pnl: 2024-07-05T23:59:59.999 116408.36667480822 === 1.279%
2024-12-12 23:54:16,180 - DEBUG - cur time: 2024-07-06T23:59:59.999 == next bar open time: 2024-07-07T00:00:00.000 == close pos time: 2024-07-12T00:00:00.000
2024-12-12 23:54:16,180 - INFO - pnl: 2024-07-06T23:59:59.999 116556.09073067334 === 0.127%
2024-12-12 23:54:16,186 - DEBUG - cur time: 2024-07-07T23:59:59.999 == next bar open time: 2024-07-08T00:00:00.000 == close pos time: 2024-07-13T00:00:00.000
2024-12-12 23:54:16,197 - DEBUG - close time 2024-07-07T23:59:59.999 == vol_threshold: 14448914.4
2024-12-12 23:54:16,197 - DEBUG - 2024-07-07T23:59:59.999 == all trade symbol 245 == remain 171 after VOL filter
2024-12-12 23:54:16,199 - DEBUG - sorted_long_factors: shape: (171, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TOKENUSDT ┆ -5.254133    ┆ 0    ┆ 170          │
│ ENJUSDT   ┆ -4.663884    ┆ 1    ┆ 169          │
│ TRXUSDT   ┆ -4.442217    ┆ 2    ┆ 168          │
│ XEMUSDT   ┆ -4.381009    ┆ 3    ┆ 167          │
│ JUPUSDT   ┆ -4.226627    ┆ 4    ┆ 166          │
│ RENUSDT   ┆ -4.046245    ┆ 5    ┆ 165          │
│ XVGUSDT   ┆ -3.718909    ┆ 6    ┆ 164          │
│ MAVUSDT   ┆ -3.711272    ┆ 7    ┆ 163          │
│ ONDOUSDT  ┆ -3.672985    ┆ 8    ┆ 162          │
│ DOGEUSDT  ┆ -3.27501     ┆ 9    ┆ 161          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ARKUSDT   ┆ 3.638991     ┆ 161  ┆ 9            │
│ MANAUSDT  ┆ 3.656586     ┆ 162  ┆ 8            │
│ XTZUSDT   ┆ 3.757502     ┆ 163  ┆ 7            │
│ ONTUSDT   ┆ 3.811128     ┆ 164  ┆ 6            │
│ AXLUSDT   ┆ 4.150995     ┆ 165  ┆ 5            │
│ IOTXUSDT  ┆ 4.227298     ┆ 166  ┆ 4            │
│ SFPUSDT   ┆ 4.258906     ┆ 167  ┆ 3            │
│ BNXUSDT   ┆ 4.571267     ┆ 168  ┆ 2            │
│ ORBSUSDT  ┆ 4.965038     ┆ 169  ┆ 1            │
│ LUNA2USDT ┆ 9.417757     ┆ 170  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,207 - WARNING - 2024-07-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:16,207 - INFO - cur close time: 2024-07-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:16,207 - DEBUG - mean expected ret (mean factor): 0.011673456376937761
2024-12-12 23:54:16,213 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,213 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,213 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.021079    ┆ 0.13602     ┆ 0.068       ┆ 0.0084052   ┆ … ┆ 0.01447 ┆ null   ┆ null    ┆ 0.2923  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,221 - DEBUG - update position: 2024-07-07T23:59:59.999 === diff_trading_value: 323643.0028348124 == cash: 116125.38595432493 
2024-12-12 23:54:16,222 - INFO - pnl: 2024-07-07T23:59:59.999 116125.38595432493 === -0.370%
2024-12-12 23:54:16,226 - DEBUG - cur time: 2024-07-08T23:59:59.999 == next bar open time: 2024-07-09T00:00:00.000 == close pos time: 2024-07-14T00:00:00.000
2024-12-12 23:54:16,226 - INFO - pnl: 2024-07-08T23:59:59.999 116064.55208376837 === -0.052%
2024-12-12 23:54:16,232 - DEBUG - cur time: 2024-07-09T23:59:59.999 == next bar open time: 2024-07-10T00:00:00.000 == close pos time: 2024-07-15T00:00:00.000
2024-12-12 23:54:16,235 - INFO - pnl: 2024-07-09T23:59:59.999 115585.44786373754 === -0.413%
2024-12-12 23:54:16,238 - DEBUG - cur time: 2024-07-10T23:59:59.999 == next bar open time: 2024-07-11T00:00:00.000 == close pos time: 2024-07-16T00:00:00.000
2024-12-12 23:54:16,239 - INFO - pnl: 2024-07-10T23:59:59.999 115167.92201326747 === -0.361%
2024-12-12 23:54:16,242 - DEBUG - cur time: 2024-07-11T23:59:59.999 == next bar open time: 2024-07-12T00:00:00.000 == close pos time: 2024-07-17T00:00:00.000
2024-12-12 23:54:16,242 - INFO - pnl: 2024-07-11T23:59:59.999 114595.89910802439 === -0.497%
2024-12-12 23:54:16,248 - DEBUG - cur time: 2024-07-12T23:59:59.999 == next bar open time: 2024-07-13T00:00:00.000 == close pos time: 2024-07-18T00:00:00.000
2024-12-12 23:54:16,259 - DEBUG - close time 2024-07-12T23:59:59.999 == vol_threshold: 9260709.0
2024-12-12 23:54:16,260 - DEBUG - 2024-07-12T23:59:59.999 == all trade symbol 245 == remain 171 after VOL filter
2024-12-12 23:54:16,260 - DEBUG - sorted_long_factors: shape: (171, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RDNTUSDT     ┆ -4.277083    ┆ 0    ┆ 170          │
│ KLAYUSDT     ┆ -4.19065     ┆ 1    ┆ 169          │
│ NTRNUSDT     ┆ -3.41904     ┆ 2    ┆ 168          │
│ IOTXUSDT     ┆ -3.295037    ┆ 3    ┆ 167          │
│ LDOUSDT      ┆ -3.16089     ┆ 4    ┆ 166          │
│ C98USDT      ┆ -3.044977    ┆ 5    ┆ 165          │
│ RVNUSDT      ┆ -2.989174    ┆ 6    ┆ 164          │
│ EDUUSDT      ┆ -2.894237    ┆ 7    ┆ 163          │
│ WIFUSDT      ┆ -2.874019    ┆ 8    ┆ 162          │
│ 1000PEPEUSDT ┆ -2.863247    ┆ 9    ┆ 161          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TRXUSDT      ┆ 2.828726     ┆ 161  ┆ 9            │
│ BLZUSDT      ┆ 3.605186     ┆ 162  ┆ 8            │
│ ZENUSDT      ┆ 3.713642     ┆ 163  ┆ 7            │
│ 1INCHUSDT    ┆ 3.94469      ┆ 164  ┆ 6            │
│ ICXUSDT      ┆ 4.414974     ┆ 165  ┆ 5            │
│ XVGUSDT      ┆ 4.861187     ┆ 166  ┆ 4            │
│ OGNUSDT      ┆ 4.927405     ┆ 167  ┆ 3            │
│ DENTUSDT     ┆ 5.132782     ┆ 168  ┆ 2            │
│ BATUSDT      ┆ 5.798999     ┆ 169  ┆ 1            │
│ SXPUSDT      ┆ 6.191866     ┆ 170  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,269 - WARNING - 2024-07-12T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:16,269 - INFO - cur close time: 2024-07-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:16,269 - DEBUG - mean expected ret (mean factor): -0.09718056729030054
2024-12-12 23:54:16,272 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,272 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,272 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022534    ┆ 0.14061     ┆ 0.07143     ┆ 0.0086816   ┆ … ┆ 0.01567 ┆ null   ┆ null    ┆ 0.3166  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,280 - DEBUG - update position: 2024-07-12T23:59:59.999 === diff_trading_value: 372579.53298172 == cash: 114791.96988408582 
2024-12-12 23:54:16,280 - INFO - pnl: 2024-07-12T23:59:59.999 114791.96988408582 === 0.171%
2024-12-12 23:54:16,284 - DEBUG - cur time: 2024-07-13T23:59:59.999 == next bar open time: 2024-07-14T00:00:00.000 == close pos time: 2024-07-19T00:00:00.000
2024-12-12 23:54:16,284 - INFO - pnl: 2024-07-13T23:59:59.999 117063.34325369672 === 1.979%
2024-12-12 23:54:16,291 - DEBUG - cur time: 2024-07-14T23:59:59.999 == next bar open time: 2024-07-15T00:00:00.000 == close pos time: 2024-07-20T00:00:00.000
2024-12-12 23:54:16,292 - INFO - pnl: 2024-07-14T23:59:59.999 115623.68248562675 === -1.230%
2024-12-12 23:54:16,295 - DEBUG - cur time: 2024-07-15T23:59:59.999 == next bar open time: 2024-07-16T00:00:00.000 == close pos time: 2024-07-21T00:00:00.000
2024-12-12 23:54:16,296 - INFO - pnl: 2024-07-15T23:59:59.999 111167.56962562106 === -3.854%
2024-12-12 23:54:16,299 - DEBUG - cur time: 2024-07-16T23:59:59.999 == next bar open time: 2024-07-17T00:00:00.000 == close pos time: 2024-07-22T00:00:00.000
2024-12-12 23:54:16,299 - INFO - pnl: 2024-07-16T23:59:59.999 108079.55229401104 === -2.778%
2024-12-12 23:54:16,306 - DEBUG - cur time: 2024-07-17T23:59:59.999 == next bar open time: 2024-07-18T00:00:00.000 == close pos time: 2024-07-23T00:00:00.000
2024-12-12 23:54:16,321 - DEBUG - close time 2024-07-17T23:59:59.999 == vol_threshold: 12171631.6
2024-12-12 23:54:16,321 - DEBUG - 2024-07-17T23:59:59.999 == all trade symbol 245 == remain 171 after VOL filter
2024-12-12 23:54:16,325 - DEBUG - sorted_long_factors: shape: (171, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ RDNTUSDT  ┆ -6.09606     ┆ 0    ┆ 170          │
│ ORBSUSDT  ┆ -5.630185    ┆ 1    ┆ 169          │
│ LUNA2USDT ┆ -4.73628     ┆ 2    ┆ 168          │
│ JOEUSDT   ┆ -4.391842    ┆ 3    ┆ 167          │
│ BLZUSDT   ┆ -3.621264    ┆ 4    ┆ 166          │
│ DODOXUSDT ┆ -3.487141    ┆ 5    ┆ 165          │
│ AMBUSDT   ┆ -3.167267    ┆ 6    ┆ 164          │
│ LEVERUSDT ┆ -3.146248    ┆ 7    ┆ 163          │
│ ACHUSDT   ┆ -3.074503    ┆ 8    ┆ 162          │
│ MAVUSDT   ┆ -3.013448    ┆ 9    ┆ 161          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XEMUSDT   ┆ 3.728969     ┆ 161  ┆ 9            │
│ SUPERUSDT ┆ 3.74587      ┆ 162  ┆ 8            │
│ IOTAUSDT  ┆ 3.854167     ┆ 163  ┆ 7            │
│ ONTUSDT   ┆ 3.916234     ┆ 164  ┆ 6            │
│ DYMUSDT   ┆ 3.958781     ┆ 165  ┆ 5            │
│ REZUSDT   ┆ 4.132653     ┆ 166  ┆ 4            │
│ OMUSDT    ┆ 4.196737     ┆ 167  ┆ 3            │
│ 1INCHUSDT ┆ 5.028046     ┆ 168  ┆ 2            │
│ BNXUSDT   ┆ 5.551251     ┆ 169  ┆ 1            │
│ DARUSDT   ┆ 5.551875     ┆ 170  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,336 - WARNING - 2024-07-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:16,337 - INFO - cur close time: 2024-07-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:16,337 - DEBUG - mean expected ret (mean factor): 0.08407842036446037
2024-12-12 23:54:16,342 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,342 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,342 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.026676    ┆ 0.17924     ┆ 0.08991     ┆ 0.0116862   ┆ … ┆ 0.01738 ┆ null   ┆ null    ┆ 0.3576  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,350 - DEBUG - update position: 2024-07-17T23:59:59.999 === diff_trading_value: 351131.57424912916 == cash: 107413.44203654418 
2024-12-12 23:54:16,351 - INFO - pnl: 2024-07-17T23:59:59.999 107413.44203654418 === -0.616%
2024-12-12 23:54:16,355 - DEBUG - cur time: 2024-07-18T23:59:59.999 == next bar open time: 2024-07-19T00:00:00.000 == close pos time: 2024-07-24T00:00:00.000
2024-12-12 23:54:16,355 - INFO - pnl: 2024-07-18T23:59:59.999 109573.03223478838 === 2.011%
2024-12-12 23:54:16,360 - DEBUG - cur time: 2024-07-19T23:59:59.999 == next bar open time: 2024-07-20T00:00:00.000 == close pos time: 2024-07-25T00:00:00.000
2024-12-12 23:54:16,360 - INFO - pnl: 2024-07-19T23:59:59.999 106837.71686463997 === -2.496%
2024-12-12 23:54:16,366 - DEBUG - cur time: 2024-07-20T23:59:59.999 == next bar open time: 2024-07-21T00:00:00.000 == close pos time: 2024-07-26T00:00:00.000
2024-12-12 23:54:16,367 - INFO - pnl: 2024-07-20T23:59:59.999 107059.79319671259 === 0.208%
2024-12-12 23:54:16,370 - DEBUG - cur time: 2024-07-21T23:59:59.999 == next bar open time: 2024-07-22T00:00:00.000 == close pos time: 2024-07-27T00:00:00.000
2024-12-12 23:54:16,370 - INFO - pnl: 2024-07-21T23:59:59.999 106122.18160768 === -0.876%
2024-12-12 23:54:16,374 - DEBUG - cur time: 2024-07-22T23:59:59.999 == next bar open time: 2024-07-23T00:00:00.000 == close pos time: 2024-07-28T00:00:00.000
2024-12-12 23:54:16,384 - DEBUG - close time 2024-07-22T23:59:59.999 == vol_threshold: 10925252.64
2024-12-12 23:54:16,384 - DEBUG - 2024-07-22T23:59:59.999 == all trade symbol 245 == remain 171 after VOL filter
2024-12-12 23:54:16,388 - DEBUG - sorted_long_factors: shape: (171, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ MAVUSDT    ┆ -4.650147    ┆ 0    ┆ 170          │
│ DENTUSDT   ┆ -4.390366    ┆ 1    ┆ 169          │
│ NKNUSDT    ┆ -4.23011     ┆ 2    ┆ 168          │
│ AIUSDT     ┆ -4.158315    ┆ 3    ┆ 167          │
│ TNSRUSDT   ┆ -4.149493    ┆ 4    ┆ 166          │
│ JOEUSDT    ┆ -3.624816    ┆ 5    ┆ 165          │
│ IOTXUSDT   ┆ -3.609856    ┆ 6    ┆ 164          │
│ PORTALUSDT ┆ -3.394382    ┆ 7    ┆ 163          │
│ EDUUSDT    ┆ -3.156274    ┆ 8    ┆ 162          │
│ HIFIUSDT   ┆ -2.829416    ┆ 9    ┆ 161          │
│ …          ┆ …            ┆ …    ┆ …            │
│ LINAUSDT   ┆ 3.694117     ┆ 161  ┆ 9            │
│ STXUSDT    ┆ 4.009528     ┆ 162  ┆ 8            │
│ TRXUSDT    ┆ 4.373473     ┆ 163  ┆ 7            │
│ BONDUSDT   ┆ 4.443739     ┆ 164  ┆ 6            │
│ STMXUSDT   ┆ 4.489818     ┆ 165  ┆ 5            │
│ MINAUSDT   ┆ 4.497663     ┆ 166  ┆ 4            │
│ OGNUSDT    ┆ 4.621762     ┆ 167  ┆ 3            │
│ BNXUSDT    ┆ 4.628803     ┆ 168  ┆ 2            │
│ FLOWUSDT   ┆ 5.048644     ┆ 169  ┆ 1            │
│ WAXPUSDT   ┆ 5.937382     ┆ 170  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,396 - INFO - cur close time: 2024-07-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:16,397 - DEBUG - mean expected ret (mean factor): 0.1449462943151655
2024-12-12 23:54:16,401 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,401 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,401 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.029975    ┆ 0.19362     ┆ 0.0883      ┆ 0.0118821   ┆ … ┆ 0.01736 ┆ null   ┆ null    ┆ 0.3736  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,411 - DEBUG - update position: 2024-07-22T23:59:59.999 === diff_trading_value: 278243.0271071962 == cash: 108016.91941764163 
2024-12-12 23:54:16,413 - INFO - pnl: 2024-07-22T23:59:59.999 108016.91941764163 === 1.785%
2024-12-12 23:54:16,421 - DEBUG - cur time: 2024-07-23T23:59:59.999 == next bar open time: 2024-07-24T00:00:00.000 == close pos time: 2024-07-29T00:00:00.000
2024-12-12 23:54:16,425 - INFO - pnl: 2024-07-23T23:59:59.999 111267.4122642393 === 3.009%
2024-12-12 23:54:16,430 - DEBUG - cur time: 2024-07-24T23:59:59.999 == next bar open time: 2024-07-25T00:00:00.000 == close pos time: 2024-07-30T00:00:00.000
2024-12-12 23:54:16,432 - INFO - pnl: 2024-07-24T23:59:59.999 111870.2821917137 === 0.542%
2024-12-12 23:54:16,436 - DEBUG - cur time: 2024-07-25T23:59:59.999 == next bar open time: 2024-07-26T00:00:00.000 == close pos time: 2024-07-31T00:00:00.000
2024-12-12 23:54:16,437 - INFO - pnl: 2024-07-25T23:59:59.999 112029.95141645611 === 0.143%
2024-12-12 23:54:16,439 - DEBUG - cur time: 2024-07-26T23:59:59.999 == next bar open time: 2024-07-27T00:00:00.000 == close pos time: 2024-08-01T00:00:00.000
2024-12-12 23:54:16,442 - INFO - pnl: 2024-07-26T23:59:59.999 113049.62317255966 === 0.910%
2024-12-12 23:54:16,448 - DEBUG - cur time: 2024-07-27T23:59:59.999 == next bar open time: 2024-07-28T00:00:00.000 == close pos time: 2024-08-02T00:00:00.000
2024-12-12 23:54:16,460 - DEBUG - close time 2024-07-27T23:59:59.999 == vol_threshold: 11302981.66
2024-12-12 23:54:16,460 - DEBUG - 2024-07-27T23:59:59.999 == all trade symbol 247 == remain 173 after VOL filter
2024-12-12 23:54:16,464 - DEBUG - sorted_long_factors: shape: (173, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ XVGUSDT   ┆ -5.018514    ┆ 0    ┆ 172          │
│ MAGICUSDT ┆ -4.951471    ┆ 1    ┆ 171          │
│ HFTUSDT   ┆ -3.907121    ┆ 2    ┆ 170          │
│ WOOUSDT   ┆ -3.876182    ┆ 3    ┆ 169          │
│ KEYUSDT   ┆ -3.64438     ┆ 4    ┆ 168          │
│ ACHUSDT   ┆ -3.367715    ┆ 5    ┆ 167          │
│ USTCUSDT  ┆ -3.342935    ┆ 6    ┆ 166          │
│ MAVUSDT   ┆ -3.341507    ┆ 7    ┆ 165          │
│ TIAUSDT   ┆ -3.216467    ┆ 8    ┆ 164          │
│ XRPUSDT   ┆ -3.021147    ┆ 9    ┆ 163          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CELRUSDT  ┆ 3.331095     ┆ 163  ┆ 9            │
│ STMXUSDT  ┆ 3.428408     ┆ 164  ┆ 8            │
│ HBARUSDT  ┆ 3.525285     ┆ 165  ┆ 7            │
│ ALGOUSDT  ┆ 3.59082      ┆ 166  ┆ 6            │
│ BNXUSDT   ┆ 3.602293     ┆ 167  ┆ 5            │
│ UNIUSDT   ┆ 3.742093     ┆ 168  ┆ 4            │
│ MANAUSDT  ┆ 4.104404     ┆ 169  ┆ 3            │
│ ANKRUSDT  ┆ 4.480445     ┆ 170  ┆ 2            │
│ STORJUSDT ┆ 4.821118     ┆ 171  ┆ 1            │
│ ICXUSDT   ┆ 5.575878     ┆ 172  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,471 - INFO - cur close time: 2024-07-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:16,471 - DEBUG - mean expected ret (mean factor): -0.20229551947287017
2024-12-12 23:54:16,475 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,475 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,475 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028281    ┆ 0.17764     ┆ 0.08504     ┆ 0.0119053   ┆ … ┆ 0.01726 ┆ null   ┆ null    ┆ 0.3839  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,484 - DEBUG - update position: 2024-07-27T23:59:59.999 === diff_trading_value: 343196.3620777829 == cash: 113339.9181490235 
2024-12-12 23:54:16,484 - INFO - pnl: 2024-07-27T23:59:59.999 113339.9181490235 === 0.257%
2024-12-12 23:54:16,490 - DEBUG - cur time: 2024-07-28T23:59:59.999 == next bar open time: 2024-07-29T00:00:00.000 == close pos time: 2024-08-03T00:00:00.000
2024-12-12 23:54:16,491 - INFO - pnl: 2024-07-28T23:59:59.999 112315.19078863351 === -0.904%
2024-12-12 23:54:16,494 - DEBUG - cur time: 2024-07-29T23:59:59.999 == next bar open time: 2024-07-30T00:00:00.000 == close pos time: 2024-08-04T00:00:00.000
2024-12-12 23:54:16,496 - INFO - pnl: 2024-07-29T23:59:59.999 113198.27054609175 === 0.786%
2024-12-12 23:54:16,499 - DEBUG - cur time: 2024-07-30T23:59:59.999 == next bar open time: 2024-07-31T00:00:00.000 == close pos time: 2024-08-05T00:00:00.000
2024-12-12 23:54:16,499 - INFO - pnl: 2024-07-30T23:59:59.999 114792.56584850528 === 1.408%
2024-12-12 23:54:16,500 - DEBUG - cur time: 2024-07-31T23:59:59.999 == next bar open time: 2024-08-01T00:00:00.000 == close pos time: 2024-08-06T00:00:00.000
2024-12-12 23:54:16,505 - INFO - pnl: 2024-07-31T23:59:59.999 114860.1605310454 === 0.059%
2024-12-12 23:54:16,509 - DEBUG - cur time: 2024-08-01T23:59:59.999 == next bar open time: 2024-08-02T00:00:00.000 == close pos time: 2024-08-07T00:00:00.000
2024-12-12 23:54:16,521 - DEBUG - close time 2024-08-01T23:59:59.999 == vol_threshold: 16633755.559999999
2024-12-12 23:54:16,521 - DEBUG - 2024-08-01T23:59:59.999 == all trade symbol 247 == remain 173 after VOL filter
2024-12-12 23:54:16,525 - DEBUG - sorted_long_factors: shape: (173, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ALTUSDT   ┆ -4.59748     ┆ 0    ┆ 172          │
│ SPELLUSDT ┆ -4.104139    ┆ 1    ┆ 171          │
│ ROSEUSDT  ┆ -3.94768     ┆ 2    ┆ 170          │
│ RSRUSDT   ┆ -3.725016    ┆ 3    ┆ 169          │
│ IOTXUSDT  ┆ -3.609678    ┆ 4    ┆ 168          │
│ CKBUSDT   ┆ -3.206555    ┆ 5    ┆ 167          │
│ ACHUSDT   ┆ -3.133893    ┆ 6    ┆ 166          │
│ MAVUSDT   ┆ -3.13106     ┆ 7    ┆ 165          │
│ ARPAUSDT  ┆ -3.056552    ┆ 8    ┆ 164          │
│ MANAUSDT  ┆ -3.04412     ┆ 9    ┆ 163          │
│ …         ┆ …            ┆ …    ┆ …            │
│ BONDUSDT  ┆ 3.883124     ┆ 163  ┆ 9            │
│ TRXUSDT   ┆ 3.993407     ┆ 164  ┆ 8            │
│ CRVUSDT   ┆ 4.038607     ┆ 165  ┆ 7            │
│ OMUSDT    ┆ 4.045278     ┆ 166  ┆ 6            │
│ BATUSDT   ┆ 4.408812     ┆ 167  ┆ 5            │
│ AMBUSDT   ┆ 4.563529     ┆ 168  ┆ 4            │
│ BNXUSDT   ┆ 4.812056     ┆ 169  ┆ 3            │
│ RVNUSDT   ┆ 5.779116     ┆ 170  ┆ 2            │
│ SANDUSDT  ┆ 6.073509     ┆ 171  ┆ 1            │
│ ICXUSDT   ┆ 8.153927     ┆ 172  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,532 - WARNING - 2024-08-01T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:16,533 - INFO - cur close time: 2024-08-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:16,533 - DEBUG - mean expected ret (mean factor): 0.04917695331365451
2024-12-12 23:54:16,537 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,537 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,537 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024971    ┆ 0.15707     ┆ 0.07808     ┆ 0.0105151   ┆ … ┆ 0.01607 ┆ null   ┆ null    ┆ 0.3492  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,542 - DEBUG - update position: 2024-08-01T23:59:59.999 === diff_trading_value: 321286.78500946437 == cash: 115597.54504464916 
2024-12-12 23:54:16,542 - INFO - pnl: 2024-08-01T23:59:59.999 115597.54504464916 === 0.642%
2024-12-12 23:54:16,550 - DEBUG - cur time: 2024-08-02T23:59:59.999 == next bar open time: 2024-08-03T00:00:00.000 == close pos time: 2024-08-08T00:00:00.000
2024-12-12 23:54:16,551 - INFO - pnl: 2024-08-02T23:59:59.999 119688.78390805588 === 3.539%
2024-12-12 23:54:16,554 - DEBUG - cur time: 2024-08-03T23:59:59.999 == next bar open time: 2024-08-04T00:00:00.000 == close pos time: 2024-08-09T00:00:00.000
2024-12-12 23:54:16,555 - INFO - pnl: 2024-08-03T23:59:59.999 119978.11756689093 === 0.242%
2024-12-12 23:54:16,559 - DEBUG - cur time: 2024-08-04T23:59:59.999 == next bar open time: 2024-08-05T00:00:00.000 == close pos time: 2024-08-10T00:00:00.000
2024-12-12 23:54:16,559 - INFO - pnl: 2024-08-04T23:59:59.999 119239.28489014671 === -0.616%
2024-12-12 23:54:16,563 - DEBUG - cur time: 2024-08-05T23:59:59.999 == next bar open time: 2024-08-06T00:00:00.000 == close pos time: 2024-08-11T00:00:00.000
2024-12-12 23:54:16,564 - INFO - pnl: 2024-08-05T23:59:59.999 121786.03283411113 === 2.136%
2024-12-12 23:54:16,568 - DEBUG - cur time: 2024-08-06T23:59:59.999 == next bar open time: 2024-08-07T00:00:00.000 == close pos time: 2024-08-12T00:00:00.000
2024-12-12 23:54:16,576 - DEBUG - close time 2024-08-06T23:59:59.999 == vol_threshold: 18222984.6
2024-12-12 23:54:16,580 - DEBUG - 2024-08-06T23:59:59.999 == all trade symbol 247 == remain 173 after VOL filter
2024-12-12 23:54:16,582 - DEBUG - sorted_long_factors: shape: (173, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ RDNTUSDT  ┆ -5.22815     ┆ 0    ┆ 172          │
│ SXPUSDT   ┆ -4.481666    ┆ 1    ┆ 171          │
│ HOOKUSDT  ┆ -4.359465    ┆ 2    ┆ 170          │
│ SAGAUSDT  ┆ -4.319949    ┆ 3    ┆ 169          │
│ JTOUSDT   ┆ -4.043382    ┆ 4    ┆ 168          │
│ KLAYUSDT  ┆ -3.952102    ┆ 5    ┆ 167          │
│ DOGEUSDT  ┆ -3.85973     ┆ 6    ┆ 166          │
│ SKLUSDT   ┆ -3.840371    ┆ 7    ┆ 165          │
│ XRPUSDT   ┆ -3.840106    ┆ 8    ┆ 164          │
│ ICXUSDT   ┆ -3.403772    ┆ 9    ┆ 163          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XVGUSDT   ┆ 3.427869     ┆ 163  ┆ 9            │
│ HOTUSDT   ┆ 3.579677     ┆ 164  ┆ 8            │
│ JASMYUSDT ┆ 3.786045     ┆ 165  ┆ 7            │
│ STGUSDT   ┆ 3.841803     ┆ 166  ┆ 6            │
│ CTSIUSDT  ┆ 3.892443     ┆ 167  ┆ 5            │
│ ZRXUSDT   ┆ 3.985577     ┆ 168  ┆ 4            │
│ STORJUSDT ┆ 4.235318     ┆ 169  ┆ 3            │
│ CKBUSDT   ┆ 4.622792     ┆ 170  ┆ 2            │
│ IOTXUSDT  ┆ 4.692603     ┆ 171  ┆ 1            │
│ ONTUSDT   ┆ 5.326942     ┆ 172  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,589 - WARNING - 2024-08-06T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:16,589 - INFO - cur close time: 2024-08-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:16,589 - DEBUG - mean expected ret (mean factor): -0.11102623623930519
2024-12-12 23:54:16,594 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,594 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,594 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.019827    ┆ 0.12081     ┆ 0.06682     ┆ 0.0077357   ┆ … ┆ 0.01303 ┆ null   ┆ null    ┆ 0.2788  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,599 - DEBUG - update position: 2024-08-06T23:59:59.999 === diff_trading_value: 345518.2749416024 == cash: 121254.0522772313 
2024-12-12 23:54:16,600 - INFO - pnl: 2024-08-06T23:59:59.999 121254.0522772313 === -0.437%
2024-12-12 23:54:16,600 - DEBUG - cur time: 2024-08-07T23:59:59.999 == next bar open time: 2024-08-08T00:00:00.000 == close pos time: 2024-08-13T00:00:00.000
2024-12-12 23:54:16,605 - INFO - pnl: 2024-08-07T23:59:59.999 119314.23015458701 === -1.600%
2024-12-12 23:54:16,609 - DEBUG - cur time: 2024-08-08T23:59:59.999 == next bar open time: 2024-08-09T00:00:00.000 == close pos time: 2024-08-14T00:00:00.000
2024-12-12 23:54:16,610 - INFO - pnl: 2024-08-08T23:59:59.999 120441.1868308365 === 0.945%
2024-12-12 23:54:16,614 - DEBUG - cur time: 2024-08-09T23:59:59.999 == next bar open time: 2024-08-10T00:00:00.000 == close pos time: 2024-08-15T00:00:00.000
2024-12-12 23:54:16,614 - INFO - pnl: 2024-08-09T23:59:59.999 119885.52664855265 === -0.461%
2024-12-12 23:54:16,617 - DEBUG - cur time: 2024-08-10T23:59:59.999 == next bar open time: 2024-08-11T00:00:00.000 == close pos time: 2024-08-16T00:00:00.000
2024-12-12 23:54:16,618 - INFO - pnl: 2024-08-10T23:59:59.999 119459.19481576681 === -0.356%
2024-12-12 23:54:16,623 - DEBUG - cur time: 2024-08-11T23:59:59.999 == next bar open time: 2024-08-12T00:00:00.000 == close pos time: 2024-08-17T00:00:00.000
2024-12-12 23:54:16,637 - DEBUG - close time 2024-08-11T23:59:59.999 == vol_threshold: 11652019.849999992
2024-12-12 23:54:16,638 - DEBUG - 2024-08-11T23:59:59.999 == all trade symbol 248 == remain 173 after VOL filter
2024-12-12 23:54:16,639 - DEBUG - sorted_long_factors: shape: (173, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ C98USDT   ┆ -5.088935    ┆ 0    ┆ 172          │
│ EDUUSDT   ┆ -3.80178     ┆ 1    ┆ 171          │
│ POLYXUSDT ┆ -3.325362    ┆ 2    ┆ 170          │
│ ALTUSDT   ┆ -3.181784    ┆ 3    ┆ 169          │
│ XRPUSDT   ┆ -3.119301    ┆ 4    ┆ 168          │
│ HOTUSDT   ┆ -3.058735    ┆ 5    ┆ 167          │
│ COTIUSDT  ┆ -3.040093    ┆ 6    ┆ 166          │
│ MAGICUSDT ┆ -3.012221    ┆ 7    ┆ 165          │
│ NTRNUSDT  ┆ -2.910825    ┆ 8    ┆ 164          │
│ PIXELUSDT ┆ -2.821655    ┆ 9    ┆ 163          │
│ …         ┆ …            ┆ …    ┆ …            │
│ TUSDT     ┆ 3.210086     ┆ 163  ┆ 9            │
│ SUPERUSDT ┆ 3.246945     ┆ 164  ┆ 8            │
│ AMBUSDT   ┆ 3.298116     ┆ 165  ┆ 7            │
│ CELOUSDT  ┆ 3.409808     ┆ 166  ┆ 6            │
│ FLOWUSDT  ┆ 3.498487     ┆ 167  ┆ 5            │
│ BNXUSDT   ┆ 3.844469     ┆ 168  ┆ 4            │
│ ZILUSDT   ┆ 4.066618     ┆ 169  ┆ 3            │
│ SXPUSDT   ┆ 4.355747     ┆ 170  ┆ 2            │
│ ALPHAUSDT ┆ 4.953632     ┆ 171  ┆ 1            │
│ LRCUSDT   ┆ 6.480586     ┆ 172  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,648 - WARNING - 2024-08-11T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:16,648 - INFO - cur close time: 2024-08-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:16,648 - DEBUG - mean expected ret (mean factor): -0.15651171058778687
2024-12-12 23:54:16,652 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,652 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,652 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.018804    ┆ 0.11733     ┆ 0.0773      ┆ 0.007718    ┆ … ┆ 0.01333 ┆ null   ┆ null    ┆ 0.2927  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,659 - DEBUG - update position: 2024-08-11T23:59:59.999 === diff_trading_value: 369600.1503147617 == cash: 118806.81968985034 
2024-12-12 23:54:16,659 - INFO - pnl: 2024-08-11T23:59:59.999 118806.81968985034 === -0.546%
2024-12-12 23:54:16,663 - DEBUG - cur time: 2024-08-12T23:59:59.999 == next bar open time: 2024-08-13T00:00:00.000 == close pos time: 2024-08-18T00:00:00.000
2024-12-12 23:54:16,665 - INFO - pnl: 2024-08-12T23:59:59.999 114450.89114451347 === -3.666%
2024-12-12 23:54:16,668 - DEBUG - cur time: 2024-08-13T23:59:59.999 == next bar open time: 2024-08-14T00:00:00.000 == close pos time: 2024-08-19T00:00:00.000
2024-12-12 23:54:16,670 - INFO - pnl: 2024-08-13T23:59:59.999 113858.46287484306 === -0.518%
2024-12-12 23:54:16,673 - DEBUG - cur time: 2024-08-14T23:59:59.999 == next bar open time: 2024-08-15T00:00:00.000 == close pos time: 2024-08-20T00:00:00.000
2024-12-12 23:54:16,675 - INFO - pnl: 2024-08-14T23:59:59.999 115610.27957628336 === 1.539%
2024-12-12 23:54:16,678 - DEBUG - cur time: 2024-08-15T23:59:59.999 == next bar open time: 2024-08-16T00:00:00.000 == close pos time: 2024-08-21T00:00:00.000
2024-12-12 23:54:16,679 - INFO - pnl: 2024-08-15T23:59:59.999 116777.26119179354 === 1.009%
2024-12-12 23:54:16,683 - DEBUG - cur time: 2024-08-16T23:59:59.999 == next bar open time: 2024-08-17T00:00:00.000 == close pos time: 2024-08-22T00:00:00.000
2024-12-12 23:54:16,694 - DEBUG - close time 2024-08-16T23:59:59.999 == vol_threshold: 11756194.189999994
2024-12-12 23:54:16,695 - DEBUG - 2024-08-16T23:59:59.999 == all trade symbol 248 == remain 173 after VOL filter
2024-12-12 23:54:16,696 - DEBUG - sorted_long_factors: shape: (173, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ IOTXUSDT     ┆ -5.294148    ┆ 0    ┆ 172          │
│ LUNA2USDT    ┆ -4.861061    ┆ 1    ┆ 171          │
│ 1000XECUSDT  ┆ -4.325958    ┆ 2    ┆ 170          │
│ MYROUSDT     ┆ -4.25968     ┆ 3    ┆ 169          │
│ JUPUSDT      ┆ -4.166122    ┆ 4    ┆ 168          │
│ KEYUSDT      ┆ -4.066755    ┆ 5    ┆ 167          │
│ BOMEUSDT     ┆ -3.957832    ┆ 6    ┆ 166          │
│ FETUSDT      ┆ -3.716547    ┆ 7    ┆ 165          │
│ 1000PEPEUSDT ┆ -3.658929    ┆ 8    ┆ 164          │
│ 1000BONKUSDT ┆ -3.458922    ┆ 9    ┆ 163          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DOTUSDT      ┆ 3.055711     ┆ 163  ┆ 9            │
│ KLAYUSDT     ┆ 3.303306     ┆ 164  ┆ 8            │
│ DENTUSDT     ┆ 3.314879     ┆ 165  ┆ 7            │
│ DARUSDT      ┆ 4.087129     ┆ 166  ┆ 6            │
│ ALTUSDT      ┆ 4.500931     ┆ 167  ┆ 5            │
│ CELRUSDT     ┆ 4.670124     ┆ 168  ┆ 4            │
│ IDUSDT       ┆ 4.954512     ┆ 169  ┆ 3            │
│ TRXUSDT      ┆ 4.959567     ┆ 170  ┆ 2            │
│ BLZUSDT      ┆ 5.064445     ┆ 171  ┆ 1            │
│ ICXUSDT      ┆ 6.459298     ┆ 172  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,702 - INFO - cur close time: 2024-08-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:16,702 - DEBUG - mean expected ret (mean factor): -0.07616414158935193
2024-12-12 23:54:16,707 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,707 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ f64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ -10000.0    ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,707 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.017528    ┆ 0.11294     ┆ 0.07674     ┆ 0.0071747   ┆ … ┆ 0.01317 ┆ null   ┆ null    ┆ 0.2981  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,713 - DEBUG - update position: 2024-08-16T23:59:59.999 === diff_trading_value: 381476.5362384527 == cash: 114191.35412815833 
2024-12-12 23:54:16,714 - INFO - pnl: 2024-08-16T23:59:59.999 114191.35412815833 === -2.214%
2024-12-12 23:54:16,717 - DEBUG - cur time: 2024-08-17T23:59:59.999 == next bar open time: 2024-08-18T00:00:00.000 == close pos time: 2024-08-23T00:00:00.000
2024-12-12 23:54:16,718 - INFO - pnl: 2024-08-17T23:59:59.999 113880.98250364524 === -0.272%
2024-12-12 23:54:16,720 - DEBUG - cur time: 2024-08-18T23:59:59.999 == next bar open time: 2024-08-19T00:00:00.000 == close pos time: 2024-08-24T00:00:00.000
2024-12-12 23:54:16,722 - INFO - pnl: 2024-08-18T23:59:59.999 117781.02122947213 === 3.425%
2024-12-12 23:54:16,725 - DEBUG - cur time: 2024-08-19T23:59:59.999 == next bar open time: 2024-08-20T00:00:00.000 == close pos time: 2024-08-25T00:00:00.000
2024-12-12 23:54:16,727 - INFO - pnl: 2024-08-19T23:59:59.999 115442.95561656181 === -1.985%
2024-12-12 23:54:16,730 - DEBUG - cur time: 2024-08-20T23:59:59.999 == next bar open time: 2024-08-21T00:00:00.000 == close pos time: 2024-08-26T00:00:00.000
2024-12-12 23:54:16,731 - INFO - pnl: 2024-08-20T23:59:59.999 116572.317406725 === 0.978%
2024-12-12 23:54:16,733 - DEBUG - cur time: 2024-08-21T23:59:59.999 == next bar open time: 2024-08-22T00:00:00.000 == close pos time: 2024-08-27T00:00:00.000
2024-12-12 23:54:16,745 - DEBUG - close time 2024-08-21T23:59:59.999 == vol_threshold: 12807660.399999995
2024-12-12 23:54:16,746 - DEBUG - 2024-08-21T23:59:59.999 == all trade symbol 249 == remain 174 after VOL filter
2024-12-12 23:54:16,749 - DEBUG - sorted_long_factors: shape: (174, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ HOOKUSDT  ┆ -4.321337    ┆ 0    ┆ 173          │
│ ONDOUSDT  ┆ -3.61918     ┆ 1    ┆ 172          │
│ POLYXUSDT ┆ -3.2398      ┆ 2    ┆ 171          │
│ SAGAUSDT  ┆ -3.133634    ┆ 3    ┆ 170          │
│ 1INCHUSDT ┆ -3.044857    ┆ 4    ┆ 169          │
│ ZETAUSDT  ┆ -3.018778    ┆ 5    ┆ 168          │
│ STRKUSDT  ┆ -2.849799    ┆ 6    ┆ 167          │
│ TURBOUSDT ┆ -2.790049    ┆ 7    ┆ 166          │
│ XRPUSDT   ┆ -2.746117    ┆ 8    ┆ 165          │
│ TIAUSDT   ┆ -2.657932    ┆ 9    ┆ 164          │
│ …         ┆ …            ┆ …    ┆ …            │
│ WAXPUSDT  ┆ 2.45574      ┆ 164  ┆ 9            │
│ OXTUSDT   ┆ 2.475283     ┆ 165  ┆ 8            │
│ STGUSDT   ┆ 2.773319     ┆ 166  ┆ 7            │
│ UNIUSDT   ┆ 3.048814     ┆ 167  ┆ 6            │
│ ZRXUSDT   ┆ 3.058499     ┆ 168  ┆ 5            │
│ ONEUSDT   ┆ 3.074875     ┆ 169  ┆ 4            │
│ XVGUSDT   ┆ 3.077262     ┆ 170  ┆ 3            │
│ NEARUSDT  ┆ 3.182487     ┆ 171  ┆ 2            │
│ BNXUSDT   ┆ 5.465959     ┆ 172  ┆ 1            │
│ GLMUSDT   ┆ 13.480698    ┆ 173  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,756 - WARNING - 2024-08-21T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:16,757 - INFO - cur close time: 2024-08-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:16,757 - DEBUG - mean expected ret (mean factor): -0.02423464278234102
2024-12-12 23:54:16,769 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,769 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,770 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.018556    ┆ 0.12749     ┆ 0.0834      ┆ 0.0079182   ┆ … ┆ 0.01432 ┆ null   ┆ null    ┆ 0.3219  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,781 - DEBUG - update position: 2024-08-21T23:59:59.999 === diff_trading_value: 383131.6885919718 == cash: 115822.75881267237 
2024-12-12 23:54:16,784 - INFO - pnl: 2024-08-21T23:59:59.999 115822.75881267237 === -0.643%
2024-12-12 23:54:16,790 - DEBUG - cur time: 2024-08-22T23:59:59.999 == next bar open time: 2024-08-23T00:00:00.000 == close pos time: 2024-08-28T00:00:00.000
2024-12-12 23:54:16,792 - INFO - pnl: 2024-08-22T23:59:59.999 114853.00272000306 === -0.837%
2024-12-12 23:54:16,796 - DEBUG - cur time: 2024-08-23T23:59:59.999 == next bar open time: 2024-08-24T00:00:00.000 == close pos time: 2024-08-29T00:00:00.000
2024-12-12 23:54:16,797 - INFO - pnl: 2024-08-23T23:59:59.999 110396.22422240241 === -3.880%
2024-12-12 23:54:16,799 - DEBUG - cur time: 2024-08-24T23:59:59.999 == next bar open time: 2024-08-25T00:00:00.000 == close pos time: 2024-08-30T00:00:00.000
2024-12-12 23:54:16,802 - INFO - pnl: 2024-08-24T23:59:59.999 109492.49698997423 === -0.819%
2024-12-12 23:54:16,806 - DEBUG - cur time: 2024-08-25T23:59:59.999 == next bar open time: 2024-08-26T00:00:00.000 == close pos time: 2024-08-31T00:00:00.000
2024-12-12 23:54:16,807 - INFO - pnl: 2024-08-25T23:59:59.999 111314.67872282422 === 1.664%
2024-12-12 23:54:16,812 - DEBUG - cur time: 2024-08-26T23:59:59.999 == next bar open time: 2024-08-27T00:00:00.000 == close pos time: 2024-09-01T00:00:00.000
2024-12-12 23:54:16,830 - DEBUG - close time 2024-08-26T23:59:59.999 == vol_threshold: 12960496.159999996
2024-12-12 23:54:16,831 - DEBUG - 2024-08-26T23:59:59.999 == all trade symbol 249 == remain 174 after VOL filter
2024-12-12 23:54:16,833 - DEBUG - sorted_long_factors: shape: (174, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ JOEUSDT   ┆ -6.586537    ┆ 0    ┆ 173          │
│ ACHUSDT   ┆ -5.863778    ┆ 1    ┆ 172          │
│ HOOKUSDT  ┆ -3.915588    ┆ 2    ┆ 171          │
│ XRPUSDT   ┆ -3.875351    ┆ 3    ┆ 170          │
│ SPELLUSDT ┆ -3.810897    ┆ 4    ┆ 169          │
│ ONEUSDT   ┆ -3.700749    ┆ 5    ┆ 168          │
│ BLZUSDT   ┆ -3.430266    ┆ 6    ┆ 167          │
│ MANTAUSDT ┆ -3.399093    ┆ 7    ┆ 166          │
│ ROSEUSDT  ┆ -3.390405    ┆ 8    ┆ 165          │
│ ZILUSDT   ┆ -3.315179    ┆ 9    ┆ 164          │
│ …         ┆ …            ┆ …    ┆ …            │
│ EOSUSDT   ┆ 3.286795     ┆ 164  ┆ 9            │
│ RIFUSDT   ┆ 3.464888     ┆ 165  ┆ 8            │
│ LQTYUSDT  ┆ 3.643738     ┆ 166  ┆ 7            │
│ DENTUSDT  ┆ 3.772651     ┆ 167  ┆ 6            │
│ MANAUSDT  ┆ 3.780199     ┆ 168  ┆ 5            │
│ GLMUSDT   ┆ 3.942467     ┆ 169  ┆ 4            │
│ KEYUSDT   ┆ 4.006458     ┆ 170  ┆ 3            │
│ OGNUSDT   ┆ 4.145144     ┆ 171  ┆ 2            │
│ HFTUSDT   ┆ 6.749447     ┆ 172  ┆ 1            │
│ RENUSDT   ┆ 7.839495     ┆ 173  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,842 - INFO - cur close time: 2024-08-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:16,843 - DEBUG - mean expected ret (mean factor): -0.11989068161557083
2024-12-12 23:54:16,849 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,849 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,849 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.019661    ┆ 0.14812     ┆ 0.08475     ┆ 0.0085181  ┆ … ┆ 0.01439 ┆ 0.11782 ┆ null    ┆ 0.3205  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:16,859 - DEBUG - update position: 2024-08-26T23:59:59.999 === diff_trading_value: 333169.138467525 == cash: 112136.43334723375 
2024-12-12 23:54:16,860 - INFO - pnl: 2024-08-26T23:59:59.999 112136.43334723375 === 0.738%
2024-12-12 23:54:16,867 - DEBUG - cur time: 2024-08-27T23:59:59.999 == next bar open time: 2024-08-28T00:00:00.000 == close pos time: 2024-09-02T00:00:00.000
2024-12-12 23:54:16,868 - INFO - pnl: 2024-08-27T23:59:59.999 112986.49969149855 === 0.758%
2024-12-12 23:54:16,873 - DEBUG - cur time: 2024-08-28T23:59:59.999 == next bar open time: 2024-08-29T00:00:00.000 == close pos time: 2024-09-03T00:00:00.000
2024-12-12 23:54:16,875 - INFO - pnl: 2024-08-28T23:59:59.999 112607.01934112063 === -0.336%
2024-12-12 23:54:16,880 - DEBUG - cur time: 2024-08-29T23:59:59.999 == next bar open time: 2024-08-30T00:00:00.000 == close pos time: 2024-09-04T00:00:00.000
2024-12-12 23:54:16,883 - INFO - pnl: 2024-08-29T23:59:59.999 111096.44479667653 === -1.341%
2024-12-12 23:54:16,888 - DEBUG - cur time: 2024-08-30T23:59:59.999 == next bar open time: 2024-08-31T00:00:00.000 == close pos time: 2024-09-05T00:00:00.000
2024-12-12 23:54:16,890 - INFO - pnl: 2024-08-30T23:59:59.999 111592.36487468559 === 0.446%
2024-12-12 23:54:16,892 - DEBUG - cur time: 2024-08-31T23:59:59.999 == next bar open time: 2024-09-01T00:00:00.000 == close pos time: 2024-09-06T00:00:00.000
2024-12-12 23:54:16,908 - DEBUG - close time 2024-08-31T23:59:59.999 == vol_threshold: 6589445.099999999
2024-12-12 23:54:16,908 - DEBUG - 2024-08-31T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:16,909 - DEBUG - sorted_long_factors: shape: (176, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ ANKRUSDT   ┆ -4.775811    ┆ 0    ┆ 175          │
│ MINAUSDT   ┆ -3.844052    ┆ 1    ┆ 174          │
│ DENTUSDT   ┆ -3.728411    ┆ 2    ┆ 173          │
│ BOMEUSDT   ┆ -3.608452    ┆ 3    ┆ 172          │
│ STGUSDT    ┆ -3.548904    ┆ 4    ┆ 171          │
│ IOTXUSDT   ┆ -3.500426    ┆ 5    ┆ 170          │
│ IDUSDT     ┆ -3.383148    ┆ 6    ┆ 169          │
│ PORTALUSDT ┆ -3.222531    ┆ 7    ┆ 168          │
│ DYMUSDT    ┆ -3.206199    ┆ 8    ┆ 167          │
│ LUNA2USDT  ┆ -3.183731    ┆ 9    ┆ 166          │
│ …          ┆ …            ┆ …    ┆ …            │
│ RDNTUSDT   ┆ 2.903655     ┆ 166  ┆ 9            │
│ DODOXUSDT  ┆ 3.545682     ┆ 167  ┆ 8            │
│ STMXUSDT   ┆ 3.696996     ┆ 168  ┆ 7            │
│ ONEUSDT    ┆ 3.838869     ┆ 169  ┆ 6            │
│ ORBSUSDT   ┆ 3.92376      ┆ 170  ┆ 5            │
│ ONTUSDT    ┆ 3.961751     ┆ 171  ┆ 4            │
│ XLMUSDT    ┆ 4.361777     ┆ 172  ┆ 3            │
│ REEFUSDT   ┆ 4.760263     ┆ 173  ┆ 2            │
│ EOSUSDT    ┆ 5.727843     ┆ 174  ┆ 1            │
│ LITUSDT    ┆ 6.754604     ┆ 175  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,919 - WARNING - 2024-08-31T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:16,919 - INFO - cur close time: 2024-08-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:16,919 - DEBUG - mean expected ret (mean factor): -0.1159258795335885
2024-12-12 23:54:16,924 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,926 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,926 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.017311    ┆ 0.125       ┆ 0.07835     ┆ 0.0075933  ┆ … ┆ 0.01328 ┆ 0.10403 ┆ 4.051   ┆ 0.2898  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:16,934 - DEBUG - update position: 2024-08-31T23:59:59.999 === diff_trading_value: 325950.3360051475 == cash: 110972.41571625245 
2024-12-12 23:54:16,935 - INFO - pnl: 2024-08-31T23:59:59.999 110972.41571625245 === -0.556%
2024-12-12 23:54:16,940 - DEBUG - cur time: 2024-09-01T23:59:59.999 == next bar open time: 2024-09-02T00:00:00.000 == close pos time: 2024-09-07T00:00:00.000
2024-12-12 23:54:16,942 - INFO - pnl: 2024-09-01T23:59:59.999 111062.90899522424 === 0.082%
2024-12-12 23:54:16,949 - DEBUG - cur time: 2024-09-02T23:59:59.999 == next bar open time: 2024-09-03T00:00:00.000 == close pos time: 2024-09-08T00:00:00.000
2024-12-12 23:54:16,951 - INFO - pnl: 2024-09-02T23:59:59.999 113934.13115726109 === 2.585%
2024-12-12 23:54:16,956 - DEBUG - cur time: 2024-09-03T23:59:59.999 == next bar open time: 2024-09-04T00:00:00.000 == close pos time: 2024-09-09T00:00:00.000
2024-12-12 23:54:16,958 - INFO - pnl: 2024-09-03T23:59:59.999 113857.12749037606 === -0.068%
2024-12-12 23:54:16,959 - DEBUG - cur time: 2024-09-04T23:59:59.999 == next bar open time: 2024-09-05T00:00:00.000 == close pos time: 2024-09-10T00:00:00.000
2024-12-12 23:54:16,963 - INFO - pnl: 2024-09-04T23:59:59.999 113414.70410599651 === -0.389%
2024-12-12 23:54:16,968 - DEBUG - cur time: 2024-09-05T23:59:59.999 == next bar open time: 2024-09-06T00:00:00.000 == close pos time: 2024-09-11T00:00:00.000
2024-12-12 23:54:16,980 - DEBUG - close time 2024-09-05T23:59:59.999 == vol_threshold: 10719879.899999999
2024-12-12 23:54:16,981 - DEBUG - 2024-09-05T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:16,983 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SPELLUSDT    ┆ -6.596424    ┆ 0    ┆ 175          │
│ ACHUSDT      ┆ -5.267046    ┆ 1    ┆ 174          │
│ LUNA2USDT    ┆ -4.47389     ┆ 2    ┆ 173          │
│ PENDLEUSDT   ┆ -3.723412    ┆ 3    ┆ 172          │
│ AMBUSDT      ┆ -3.510558    ┆ 4    ┆ 171          │
│ JTOUSDT      ┆ -3.468966    ┆ 5    ┆ 170          │
│ 1000BONKUSDT ┆ -3.468083    ┆ 6    ┆ 169          │
│ XRPUSDT      ┆ -3.276523    ┆ 7    ┆ 168          │
│ ALTUSDT      ┆ -3.273375    ┆ 8    ┆ 167          │
│ NFPUSDT      ┆ -3.229009    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ STMXUSDT     ┆ 3.11857      ┆ 166  ┆ 9            │
│ BBUSDT       ┆ 3.165012     ┆ 167  ┆ 8            │
│ OXTUSDT      ┆ 3.832588     ┆ 168  ┆ 7            │
│ SXPUSDT      ┆ 3.991011     ┆ 169  ┆ 6            │
│ IOTXUSDT     ┆ 4.068946     ┆ 170  ┆ 5            │
│ ASTRUSDT     ┆ 4.197755     ┆ 171  ┆ 4            │
│ LOOMUSDT     ┆ 4.215167     ┆ 172  ┆ 3            │
│ MAGICUSDT    ┆ 5.11455      ┆ 173  ┆ 2            │
│ GLMUSDT      ┆ 5.951264     ┆ 174  ┆ 1            │
│ ZETAUSDT     ┆ 7.49463      ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:16,989 - WARNING - 2024-09-05T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:16,989 - INFO - cur close time: 2024-09-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:16,989 - DEBUG - mean expected ret (mean factor): -0.12802164051933082
2024-12-12 23:54:16,993 - DEBUG - begin to update pos: =========
2024-12-12 23:54:16,993 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ f64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ -10000.0    ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:16,993 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.015808    ┆ 0.119       ┆ 0.07577     ┆ 0.0071017  ┆ … ┆ 0.01299 ┆ 0.10044 ┆ 3.222   ┆ 0.2714  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:16,999 - DEBUG - update position: 2024-09-05T23:59:59.999 === diff_trading_value: 344540.8592015121 == cash: 113751.1206739991 
2024-12-12 23:54:17,003 - INFO - pnl: 2024-09-05T23:59:59.999 113751.1206739991 === 0.297%
2024-12-12 23:54:17,007 - DEBUG - cur time: 2024-09-06T23:59:59.999 == next bar open time: 2024-09-07T00:00:00.000 == close pos time: 2024-09-12T00:00:00.000
2024-12-12 23:54:17,009 - INFO - pnl: 2024-09-06T23:59:59.999 113799.7055859687 === 0.043%
2024-12-12 23:54:17,014 - DEBUG - cur time: 2024-09-07T23:59:59.999 == next bar open time: 2024-09-08T00:00:00.000 == close pos time: 2024-09-13T00:00:00.000
2024-12-12 23:54:17,014 - INFO - pnl: 2024-09-07T23:59:59.999 113562.39053941423 === -0.209%
2024-12-12 23:54:17,017 - DEBUG - cur time: 2024-09-08T23:59:59.999 == next bar open time: 2024-09-09T00:00:00.000 == close pos time: 2024-09-14T00:00:00.000
2024-12-12 23:54:17,020 - INFO - pnl: 2024-09-08T23:59:59.999 114463.14714296036 === 0.793%
2024-12-12 23:54:17,025 - DEBUG - cur time: 2024-09-09T23:59:59.999 == next bar open time: 2024-09-10T00:00:00.000 == close pos time: 2024-09-15T00:00:00.000
2024-12-12 23:54:17,025 - INFO - pnl: 2024-09-09T23:59:59.999 114224.64450984457 === -0.208%
2024-12-12 23:54:17,030 - DEBUG - cur time: 2024-09-10T23:59:59.999 == next bar open time: 2024-09-11T00:00:00.000 == close pos time: 2024-09-16T00:00:00.000
2024-12-12 23:54:17,041 - DEBUG - close time 2024-09-10T23:59:59.999 == vol_threshold: 9483953.98
2024-12-12 23:54:17,041 - DEBUG - 2024-09-10T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:17,045 - DEBUG - sorted_long_factors: shape: (176, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ DODOXUSDT ┆ -6.060566    ┆ 0    ┆ 175          │
│ IOTXUSDT  ┆ -3.935141    ┆ 1    ┆ 174          │
│ BAKEUSDT  ┆ -3.746814    ┆ 2    ┆ 173          │
│ TLMUSDT   ┆ -3.666582    ┆ 3    ┆ 172          │
│ ORBSUSDT  ┆ -3.633616    ┆ 4    ┆ 171          │
│ GTCUSDT   ┆ -3.498115    ┆ 5    ┆ 170          │
│ HFTUSDT   ┆ -3.419323    ┆ 6    ┆ 169          │
│ ARKMUSDT  ┆ -3.189632    ┆ 7    ┆ 168          │
│ AMBUSDT   ┆ -3.10216     ┆ 8    ┆ 167          │
│ NFPUSDT   ┆ -3.015093    ┆ 9    ┆ 166          │
│ …         ┆ …            ┆ …    ┆ …            │
│ FLMUSDT   ┆ 3.372465     ┆ 166  ┆ 9            │
│ C98USDT   ┆ 3.587801     ┆ 167  ┆ 8            │
│ ONEUSDT   ┆ 3.716338     ┆ 168  ┆ 7            │
│ KAVAUSDT  ┆ 3.728076     ┆ 169  ┆ 6            │
│ ARKUSDT   ┆ 3.742556     ┆ 170  ┆ 5            │
│ REEFUSDT  ┆ 3.760625     ┆ 171  ┆ 4            │
│ KEYUSDT   ┆ 4.318099     ┆ 172  ┆ 3            │
│ ALPHAUSDT ┆ 5.02936      ┆ 173  ┆ 2            │
│ ANKRUSDT  ┆ 5.341635     ┆ 174  ┆ 1            │
│ BNXUSDT   ┆ 5.35393      ┆ 175  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,050 - WARNING - 2024-09-10T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,052 - INFO - cur close time: 2024-09-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:17,052 - DEBUG - mean expected ret (mean factor): -0.02837970492260739
2024-12-12 23:54:17,056 - DEBUG - begin to update pos: =========
2024-12-12 23:54:17,057 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,057 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.017236    ┆ 0.12736     ┆ 0.08483     ┆ 0.0074615  ┆ … ┆ 0.01334 ┆ 0.11096 ┆ 3.57    ┆ 0.2831  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:17,063 - DEBUG - update position: 2024-09-10T23:59:59.999 === diff_trading_value: 320425.72475795937 == cash: 115533.28173223381 
2024-12-12 23:54:17,064 - INFO - pnl: 2024-09-10T23:59:59.999 115533.28173223381 === 1.146%
2024-12-12 23:54:17,066 - DEBUG - cur time: 2024-09-11T23:59:59.999 == next bar open time: 2024-09-12T00:00:00.000 == close pos time: 2024-09-17T00:00:00.000
2024-12-12 23:54:17,070 - INFO - pnl: 2024-09-11T23:59:59.999 113734.59162020484 === -1.557%
2024-12-12 23:54:17,074 - DEBUG - cur time: 2024-09-12T23:59:59.999 == next bar open time: 2024-09-13T00:00:00.000 == close pos time: 2024-09-18T00:00:00.000
2024-12-12 23:54:17,076 - INFO - pnl: 2024-09-12T23:59:59.999 114439.34476375907 === 0.620%
2024-12-12 23:54:17,081 - DEBUG - cur time: 2024-09-13T23:59:59.999 == next bar open time: 2024-09-14T00:00:00.000 == close pos time: 2024-09-19T00:00:00.000
2024-12-12 23:54:17,082 - INFO - pnl: 2024-09-13T23:59:59.999 115174.31827213305 === 0.642%
2024-12-12 23:54:17,088 - DEBUG - cur time: 2024-09-14T23:59:59.999 == next bar open time: 2024-09-15T00:00:00.000 == close pos time: 2024-09-20T00:00:00.000
2024-12-12 23:54:17,091 - INFO - pnl: 2024-09-14T23:59:59.999 116153.88236346711 === 0.851%
2024-12-12 23:54:17,100 - DEBUG - cur time: 2024-09-15T23:59:59.999 == next bar open time: 2024-09-16T00:00:00.000 == close pos time: 2024-09-21T00:00:00.000
2024-12-12 23:54:17,113 - DEBUG - close time 2024-09-15T23:59:59.999 == vol_threshold: 8527764.86
2024-12-12 23:54:17,114 - DEBUG - 2024-09-15T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:17,116 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DODOXUSDT    ┆ -4.423828    ┆ 0    ┆ 175          │
│ 1000SATSUSDT ┆ -4.210971    ┆ 1    ┆ 174          │
│ YGGUSDT      ┆ -3.014461    ┆ 2    ┆ 173          │
│ C98USDT      ┆ -2.882512    ┆ 3    ┆ 172          │
│ ARPAUSDT     ┆ -2.785956    ┆ 4    ┆ 171          │
│ DUSKUSDT     ┆ -2.746173    ┆ 5    ┆ 170          │
│ ENJUSDT      ┆ -2.632929    ┆ 6    ┆ 169          │
│ RVNUSDT      ┆ -2.613188    ┆ 7    ┆ 168          │
│ TONUSDT      ┆ -2.56449     ┆ 8    ┆ 167          │
│ BOMEUSDT     ┆ -2.428237    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ 2.663451     ┆ 166  ┆ 9            │
│ HBARUSDT     ┆ 2.694069     ┆ 167  ┆ 8            │
│ SUIUSDT      ┆ 2.709979     ┆ 168  ┆ 7            │
│ STMXUSDT     ┆ 2.974583     ┆ 169  ┆ 6            │
│ KLAYUSDT     ┆ 3.462164     ┆ 170  ┆ 5            │
│ ORBSUSDT     ┆ 3.982835     ┆ 171  ┆ 4            │
│ CKBUSDT      ┆ 4.0287       ┆ 172  ┆ 3            │
│ OMGUSDT      ┆ 4.42892      ┆ 173  ┆ 2            │
│ POWRUSDT     ┆ 4.562445     ┆ 174  ┆ 1            │
│ STORJUSDT    ┆ 5.953479     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,123 - WARNING - 2024-09-15T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,123 - INFO - cur close time: 2024-09-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:17,123 - DEBUG - mean expected ret (mean factor): -0.04307307189893216
2024-12-12 23:54:17,125 - DEBUG - begin to update pos: =========
2024-12-12 23:54:17,125 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,129 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.016444    ┆ 0.12035     ┆ 0.08259     ┆ 0.0073499  ┆ … ┆ 0.01326 ┆ 0.10898 ┆ 3.712   ┆ 0.2852  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:17,136 - DEBUG - update position: 2024-09-15T23:59:59.999 === diff_trading_value: 339032.5610621331 == cash: 118125.84998505814 
2024-12-12 23:54:17,137 - INFO - pnl: 2024-09-15T23:59:59.999 118125.84998505814 === 1.698%
2024-12-12 23:54:17,142 - DEBUG - cur time: 2024-09-16T23:59:59.999 == next bar open time: 2024-09-17T00:00:00.000 == close pos time: 2024-09-22T00:00:00.000
2024-12-12 23:54:17,142 - INFO - pnl: 2024-09-16T23:59:59.999 119001.63869258022 === 0.741%
2024-12-12 23:54:17,147 - DEBUG - cur time: 2024-09-17T23:59:59.999 == next bar open time: 2024-09-18T00:00:00.000 == close pos time: 2024-09-23T00:00:00.000
2024-12-12 23:54:17,150 - INFO - pnl: 2024-09-17T23:59:59.999 118345.23082974911 === -0.552%
2024-12-12 23:54:17,156 - DEBUG - cur time: 2024-09-18T23:59:59.999 == next bar open time: 2024-09-19T00:00:00.000 == close pos time: 2024-09-24T00:00:00.000
2024-12-12 23:54:17,158 - INFO - pnl: 2024-09-18T23:59:59.999 118114.25123604789 === -0.195%
2024-12-12 23:54:17,163 - DEBUG - cur time: 2024-09-19T23:59:59.999 == next bar open time: 2024-09-20T00:00:00.000 == close pos time: 2024-09-25T00:00:00.000
2024-12-12 23:54:17,165 - INFO - pnl: 2024-09-19T23:59:59.999 118379.84695958545 === 0.225%
2024-12-12 23:54:17,166 - DEBUG - cur time: 2024-09-20T23:59:59.999 == next bar open time: 2024-09-21T00:00:00.000 == close pos time: 2024-09-26T00:00:00.000
2024-12-12 23:54:17,181 - DEBUG - close time 2024-09-20T23:59:59.999 == vol_threshold: 18643546.599999998
2024-12-12 23:54:17,181 - DEBUG - 2024-09-20T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:17,185 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ARPAUSDT     ┆ -6.097028    ┆ 0    ┆ 175          │
│ ACHUSDT      ┆ -3.841833    ┆ 1    ┆ 174          │
│ KLAYUSDT     ┆ -3.368607    ┆ 2    ┆ 173          │
│ 1000SATSUSDT ┆ -3.11602     ┆ 3    ┆ 172          │
│ NFPUSDT      ┆ -2.942715    ┆ 4    ┆ 171          │
│ VANRYUSDT    ┆ -2.919868    ┆ 5    ┆ 170          │
│ TRUUSDT      ┆ -2.869526    ┆ 6    ┆ 169          │
│ XAIUSDT      ┆ -2.836303    ┆ 7    ┆ 168          │
│ WLDUSDT      ┆ -2.801221    ┆ 8    ┆ 167          │
│ DOGEUSDT     ┆ -2.699353    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ 3.386155     ┆ 166  ┆ 9            │
│ JASMYUSDT    ┆ 3.426245     ┆ 167  ┆ 8            │
│ ARKUSDT      ┆ 3.604452     ┆ 168  ┆ 7            │
│ SEIUSDT      ┆ 3.664306     ┆ 169  ┆ 6            │
│ HOOKUSDT     ┆ 3.797081     ┆ 170  ┆ 5            │
│ EOSUSDT      ┆ 4.11086      ┆ 171  ┆ 4            │
│ OXTUSDT      ┆ 4.992875     ┆ 172  ┆ 3            │
│ ENJUSDT      ┆ 5.167898     ┆ 173  ┆ 2            │
│ ANKRUSDT     ┆ 5.456503     ┆ 174  ┆ 1            │
│ LDOUSDT      ┆ 6.335827     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,193 - WARNING - 2024-09-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,193 - INFO - cur close time: 2024-09-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:17,193 - DEBUG - mean expected ret (mean factor): 0.0797333488513397
2024-12-12 23:54:17,197 - DEBUG - begin to update pos: =========
2024-12-12 23:54:17,197 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,197 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.018282    ┆ 0.13434     ┆ 0.08533     ┆ 0.0082411  ┆ … ┆ 0.01469 ┆ 0.12177 ┆ 4.23    ┆ 0.3277  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:17,206 - DEBUG - update position: 2024-09-20T23:59:59.999 === diff_trading_value: 376718.77142201277 == cash: 116971.04845540282 
2024-12-12 23:54:17,207 - INFO - pnl: 2024-09-20T23:59:59.999 116971.04845540282 === -1.190%
2024-12-12 23:54:17,211 - DEBUG - cur time: 2024-09-21T23:59:59.999 == next bar open time: 2024-09-22T00:00:00.000 == close pos time: 2024-09-27T00:00:00.000
2024-12-12 23:54:17,211 - INFO - pnl: 2024-09-21T23:59:59.999 116066.28727932138 === -0.773%
2024-12-12 23:54:17,215 - DEBUG - cur time: 2024-09-22T23:59:59.999 == next bar open time: 2024-09-23T00:00:00.000 == close pos time: 2024-09-28T00:00:00.000
2024-12-12 23:54:17,216 - INFO - pnl: 2024-09-22T23:59:59.999 115981.10820488037 === -0.073%
2024-12-12 23:54:17,220 - DEBUG - cur time: 2024-09-23T23:59:59.999 == next bar open time: 2024-09-24T00:00:00.000 == close pos time: 2024-09-29T00:00:00.000
2024-12-12 23:54:17,221 - INFO - pnl: 2024-09-23T23:59:59.999 113222.91595536622 === -2.378%
2024-12-12 23:54:17,225 - DEBUG - cur time: 2024-09-24T23:59:59.999 == next bar open time: 2024-09-25T00:00:00.000 == close pos time: 2024-09-30T00:00:00.000
2024-12-12 23:54:17,225 - INFO - pnl: 2024-09-24T23:59:59.999 113876.88306420628 === 0.578%
2024-12-12 23:54:17,231 - DEBUG - cur time: 2024-09-25T23:59:59.999 == next bar open time: 2024-09-26T00:00:00.000 == close pos time: 2024-10-01T00:00:00.000
2024-12-12 23:54:17,241 - DEBUG - close time 2024-09-25T23:59:59.999 == vol_threshold: 14836002.699999997
2024-12-12 23:54:17,241 - DEBUG - 2024-09-25T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:17,246 - DEBUG - sorted_long_factors: shape: (176, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ACHUSDT   ┆ -5.71009     ┆ 0    ┆ 175          │
│ BAKEUSDT  ┆ -5.26389     ┆ 1    ┆ 174          │
│ XVGUSDT   ┆ -4.139257    ┆ 2    ┆ 173          │
│ TLMUSDT   ┆ -3.781425    ┆ 3    ┆ 172          │
│ IOTXUSDT  ┆ -3.507017    ┆ 4    ┆ 171          │
│ PIXELUSDT ┆ -3.440429    ┆ 5    ┆ 170          │
│ ONTUSDT   ┆ -3.26734     ┆ 6    ┆ 169          │
│ STRKUSDT  ┆ -3.098092    ┆ 7    ┆ 168          │
│ OMGUSDT   ┆ -3.046064    ┆ 8    ┆ 167          │
│ EDUUSDT   ┆ -2.519026    ┆ 9    ┆ 166          │
│ …         ┆ …            ┆ …    ┆ …            │
│ SUIUSDT   ┆ 3.636529     ┆ 166  ┆ 9            │
│ CELRUSDT  ┆ 3.912973     ┆ 167  ┆ 8            │
│ ANKRUSDT  ┆ 4.166884     ┆ 168  ┆ 7            │
│ FTMUSDT   ┆ 4.188014     ┆ 169  ┆ 6            │
│ TRUUSDT   ┆ 4.205965     ┆ 170  ┆ 5            │
│ PHBUSDT   ┆ 4.303615     ┆ 171  ┆ 4            │
│ KLAYUSDT  ┆ 4.892044     ┆ 172  ┆ 3            │
│ STEEMUSDT ┆ 5.441211     ┆ 173  ┆ 2            │
│ FLOWUSDT  ┆ 5.453702     ┆ 174  ┆ 1            │
│ ASTRUSDT  ┆ 7.114075     ┆ 175  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,256 - WARNING - 2024-09-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,256 - INFO - cur close time: 2024-09-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:17,256 - DEBUG - mean expected ret (mean factor): 0.1297239984179367
2024-12-12 23:54:17,260 - DEBUG - begin to update pos: =========
2024-12-12 23:54:17,260 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,260 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.018543    ┆ 0.13737     ┆ 0.08648     ┆ 0.0084426  ┆ … ┆ 0.01563 ┆ 0.13121 ┆ 4.4172  ┆ 0.3472  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:17,266 - DEBUG - update position: 2024-09-25T23:59:59.999 === diff_trading_value: 358137.70926367375 == cash: 112220.92877249667 
2024-12-12 23:54:17,268 - INFO - pnl: 2024-09-25T23:59:59.999 112220.92877249667 === -1.454%
2024-12-12 23:54:17,273 - DEBUG - cur time: 2024-09-26T23:59:59.999 == next bar open time: 2024-09-27T00:00:00.000 == close pos time: 2024-10-02T00:00:00.000
2024-12-12 23:54:17,273 - INFO - pnl: 2024-09-26T23:59:59.999 110759.0827191964 === -1.303%
2024-12-12 23:54:17,279 - DEBUG - cur time: 2024-09-27T23:59:59.999 == next bar open time: 2024-09-28T00:00:00.000 == close pos time: 2024-10-03T00:00:00.000
2024-12-12 23:54:17,281 - INFO - pnl: 2024-09-27T23:59:59.999 111198.75484807395 === 0.397%
2024-12-12 23:54:17,285 - DEBUG - cur time: 2024-09-28T23:59:59.999 == next bar open time: 2024-09-29T00:00:00.000 == close pos time: 2024-10-04T00:00:00.000
2024-12-12 23:54:17,288 - INFO - pnl: 2024-09-28T23:59:59.999 112729.62082957332 === 1.377%
2024-12-12 23:54:17,296 - DEBUG - cur time: 2024-09-29T23:59:59.999 == next bar open time: 2024-09-30T00:00:00.000 == close pos time: 2024-10-05T00:00:00.000
2024-12-12 23:54:17,300 - INFO - pnl: 2024-09-29T23:59:59.999 112280.58786792005 === -0.398%
2024-12-12 23:54:17,307 - DEBUG - cur time: 2024-09-30T23:59:59.999 == next bar open time: 2024-10-01T00:00:00.000 == close pos time: 2024-10-06T00:00:00.000
2024-12-12 23:54:17,330 - DEBUG - close time 2024-09-30T23:59:59.999 == vol_threshold: 17980671.099999998
2024-12-12 23:54:17,332 - DEBUG - 2024-09-30T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:17,334 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TLMUSDT      ┆ -4.066058    ┆ 0    ┆ 175          │
│ EDUUSDT      ┆ -3.860894    ┆ 1    ┆ 174          │
│ ASTRUSDT     ┆ -3.657795    ┆ 2    ┆ 173          │
│ 1000SATSUSDT ┆ -3.557406    ┆ 3    ┆ 172          │
│ KNCUSDT      ┆ -3.409053    ┆ 4    ┆ 171          │
│ ARPAUSDT     ┆ -3.325366    ┆ 5    ┆ 170          │
│ IOTXUSDT     ┆ -3.234486    ┆ 6    ┆ 169          │
│ DOGEUSDT     ┆ -3.193311    ┆ 7    ┆ 168          │
│ NEARUSDT     ┆ -3.100796    ┆ 8    ┆ 167          │
│ NFPUSDT      ┆ -2.877766    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOSTUSDT     ┆ 2.902078     ┆ 166  ┆ 9            │
│ ETHWUSDT     ┆ 2.934226     ┆ 167  ┆ 8            │
│ SANDUSDT     ┆ 3.149954     ┆ 168  ┆ 7            │
│ SAGAUSDT     ┆ 3.183313     ┆ 169  ┆ 6            │
│ CELOUSDT     ┆ 3.244124     ┆ 170  ┆ 5            │
│ SKLUSDT      ┆ 3.383572     ┆ 171  ┆ 4            │
│ FLOWUSDT     ┆ 3.414782     ┆ 172  ┆ 3            │
│ TUSDT        ┆ 3.574353     ┆ 173  ┆ 2            │
│ 1000XECUSDT  ┆ 3.59597      ┆ 174  ┆ 1            │
│ FLMUSDT      ┆ 4.988987     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,342 - WARNING - 2024-09-30T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,342 - INFO - cur close time: 2024-09-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:17,342 - DEBUG - mean expected ret (mean factor): 0.05081082387593112
2024-12-12 23:54:17,348 - DEBUG - begin to update pos: =========
2024-12-12 23:54:17,349 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,349 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.023804    ┆ 0.15312     ┆ 0.09147     ┆ 0.0104665  ┆ … ┆ 0.01497 ┆ 0.13619 ┆ 4.5636  ┆ 0.3344  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:17,357 - DEBUG - update position: 2024-09-30T23:59:59.999 === diff_trading_value: 284189.1399750414 == cash: 114262.96251429529 
2024-12-12 23:54:17,357 - INFO - pnl: 2024-09-30T23:59:59.999 114262.96251429529 === 1.766%
2024-12-12 23:54:17,361 - DEBUG - cur time: 2024-10-01T23:59:59.999 == next bar open time: 2024-10-02T00:00:00.000 == close pos time: 2024-10-07T00:00:00.000
2024-12-12 23:54:17,363 - INFO - pnl: 2024-10-01T23:59:59.999 116345.5983100697 === 1.823%
2024-12-12 23:54:17,367 - DEBUG - cur time: 2024-10-02T23:59:59.999 == next bar open time: 2024-10-03T00:00:00.000 == close pos time: 2024-10-08T00:00:00.000
2024-12-12 23:54:17,368 - INFO - pnl: 2024-10-02T23:59:59.999 116833.82112880665 === 0.420%
2024-12-12 23:54:17,372 - DEBUG - cur time: 2024-10-03T23:59:59.999 == next bar open time: 2024-10-04T00:00:00.000 == close pos time: 2024-10-09T00:00:00.000
2024-12-12 23:54:17,374 - INFO - pnl: 2024-10-03T23:59:59.999 116149.26217253551 === -0.586%
2024-12-12 23:54:17,374 - DEBUG - cur time: 2024-10-04T23:59:59.999 == next bar open time: 2024-10-05T00:00:00.000 == close pos time: 2024-10-10T00:00:00.000
2024-12-12 23:54:17,378 - INFO - pnl: 2024-10-04T23:59:59.999 116418.62664908486 === 0.232%
2024-12-12 23:54:17,383 - DEBUG - cur time: 2024-10-05T23:59:59.999 == next bar open time: 2024-10-06T00:00:00.000 == close pos time: 2024-10-11T00:00:00.000
2024-12-12 23:54:17,396 - DEBUG - close time 2024-10-05T23:59:59.999 == vol_threshold: 9973148.379999999
2024-12-12 23:54:17,397 - DEBUG - 2024-10-05T23:59:59.999 == all trade symbol 253 == remain 177 after VOL filter
2024-12-12 23:54:17,399 - DEBUG - sorted_long_factors: shape: (177, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ARPAUSDT  ┆ -4.95897     ┆ 0    ┆ 176          │
│ BELUSDT   ┆ -4.751416    ┆ 1    ┆ 175          │
│ SXPUSDT   ┆ -3.130399    ┆ 2    ┆ 174          │
│ STRKUSDT  ┆ -3.068069    ┆ 3    ┆ 173          │
│ NTRNUSDT  ┆ -3.05748     ┆ 4    ┆ 172          │
│ BLZUSDT   ┆ -2.945974    ┆ 5    ┆ 171          │
│ BAKEUSDT  ┆ -2.930497    ┆ 6    ┆ 170          │
│ RDNTUSDT  ┆ -2.899976    ┆ 7    ┆ 169          │
│ MANTAUSDT ┆ -2.878407    ┆ 8    ┆ 168          │
│ POLYXUSDT ┆ -2.858143    ┆ 9    ┆ 167          │
│ …         ┆ …            ┆ …    ┆ …            │
│ NKNUSDT   ┆ 3.060225     ┆ 167  ┆ 9            │
│ BLURUSDT  ┆ 3.07378      ┆ 168  ┆ 8            │
│ THETAUSDT ┆ 3.414484     ┆ 169  ┆ 7            │
│ SANDUSDT  ┆ 4.523148     ┆ 170  ┆ 6            │
│ WAXPUSDT  ┆ 4.63802      ┆ 171  ┆ 5            │
│ MAGICUSDT ┆ 5.031985     ┆ 172  ┆ 4            │
│ TRXUSDT   ┆ 5.373436     ┆ 173  ┆ 3            │
│ EOSUSDT   ┆ 5.403482     ┆ 174  ┆ 2            │
│ ASTRUSDT  ┆ 5.758939     ┆ 175  ┆ 1            │
│ XEMUSDT   ┆ 5.838742     ┆ 176  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,410 - WARNING - 2024-10-05T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,410 - INFO - cur close time: 2024-10-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:17,410 - DEBUG - mean expected ret (mean factor): -0.10906916033904004
2024-12-12 23:54:17,416 - DEBUG - begin to update pos: =========
2024-12-12 23:54:17,417 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,417 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.020582    ┆ 0.13242     ┆ 0.08922     ┆ 0.0093489   ┆ … ┆ 0.01411 ┆ 0.1244 ┆ 4.1056  ┆ 0.3097  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,430 - DEBUG - update position: 2024-10-05T23:59:59.999 === diff_trading_value: 337345.71228646766 == cash: 116491.71588560319 
2024-12-12 23:54:17,433 - INFO - pnl: 2024-10-05T23:59:59.999 116491.71588560319 === 0.063%
2024-12-12 23:54:17,436 - DEBUG - cur time: 2024-10-06T23:59:59.999 == next bar open time: 2024-10-07T00:00:00.000 == close pos time: 2024-10-12T00:00:00.000
2024-12-12 23:54:17,439 - INFO - pnl: 2024-10-06T23:59:59.999 115791.56310263084 === -0.601%
2024-12-12 23:54:17,442 - DEBUG - cur time: 2024-10-07T23:59:59.999 == next bar open time: 2024-10-08T00:00:00.000 == close pos time: 2024-10-13T00:00:00.000
2024-12-12 23:54:17,442 - INFO - pnl: 2024-10-07T23:59:59.999 116268.09637037136 === 0.412%
2024-12-12 23:54:17,448 - DEBUG - cur time: 2024-10-08T23:59:59.999 == next bar open time: 2024-10-09T00:00:00.000 == close pos time: 2024-10-14T00:00:00.000
2024-12-12 23:54:17,449 - INFO - pnl: 2024-10-08T23:59:59.999 115784.83086482802 === -0.416%
2024-12-12 23:54:17,453 - DEBUG - cur time: 2024-10-09T23:59:59.999 == next bar open time: 2024-10-10T00:00:00.000 == close pos time: 2024-10-15T00:00:00.000
2024-12-12 23:54:17,455 - INFO - pnl: 2024-10-09T23:59:59.999 116779.13141250018 === 0.859%
2024-12-12 23:54:17,460 - DEBUG - cur time: 2024-10-10T23:59:59.999 == next bar open time: 2024-10-11T00:00:00.000 == close pos time: 2024-10-16T00:00:00.000
2024-12-12 23:54:17,474 - DEBUG - close time 2024-10-10T23:59:59.999 == vol_threshold: 11391400.999999996
2024-12-12 23:54:17,475 - DEBUG - 2024-10-10T23:59:59.999 == all trade symbol 253 == remain 177 after VOL filter
2024-12-12 23:54:17,475 - DEBUG - sorted_long_factors: shape: (177, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ XAIUSDT   ┆ -4.100115    ┆ 0    ┆ 176          │
│ RVNUSDT   ┆ -3.747478    ┆ 1    ┆ 175          │
│ FETUSDT   ┆ -3.448135    ┆ 2    ┆ 174          │
│ JUPUSDT   ┆ -3.44361     ┆ 3    ┆ 173          │
│ EDUUSDT   ┆ -3.318457    ┆ 4    ┆ 172          │
│ ATAUSDT   ┆ -3.309077    ┆ 5    ┆ 171          │
│ MYROUSDT  ┆ -3.30161     ┆ 6    ┆ 170          │
│ ACHUSDT   ┆ -3.114862    ┆ 7    ┆ 169          │
│ PIXELUSDT ┆ -2.915259    ┆ 8    ┆ 168          │
│ DYMUSDT   ┆ -2.811921    ┆ 9    ┆ 167          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CKBUSDT   ┆ 3.197813     ┆ 167  ┆ 9            │
│ ANKRUSDT  ┆ 3.41842      ┆ 168  ┆ 8            │
│ KAVAUSDT  ┆ 3.470226     ┆ 169  ┆ 7            │
│ VETUSDT   ┆ 3.603774     ┆ 170  ┆ 6            │
│ BATUSDT   ┆ 3.61655      ┆ 171  ┆ 5            │
│ WAXPUSDT  ┆ 3.950757     ┆ 172  ┆ 4            │
│ BAKEUSDT  ┆ 3.95368      ┆ 173  ┆ 3            │
│ ALPHAUSDT ┆ 4.282894     ┆ 174  ┆ 2            │
│ LQTYUSDT  ┆ 4.586719     ┆ 175  ┆ 1            │
│ C98USDT   ┆ 5.471221     ┆ 176  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,483 - WARNING - 2024-10-10T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,483 - INFO - cur close time: 2024-10-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:17,483 - DEBUG - mean expected ret (mean factor): -0.09462621465698651
2024-12-12 23:54:17,488 - DEBUG - begin to update pos: =========
2024-12-12 23:54:17,488 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,490 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.020269    ┆ 0.13134     ┆ 0.08475     ┆ 0.0092899  ┆ … ┆ 0.01397 ┆ 0.12579 ┆ 3.868   ┆ 0.3041  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:17,494 - DEBUG - update position: 2024-10-10T23:59:59.999 === diff_trading_value: 375777.37205023994 == cash: 115176.60709862948 
2024-12-12 23:54:17,497 - INFO - pnl: 2024-10-10T23:59:59.999 115176.60709862948 === -1.372%
2024-12-12 23:54:17,501 - DEBUG - cur time: 2024-10-11T23:59:59.999 == next bar open time: 2024-10-12T00:00:00.000 == close pos time: 2024-10-17T00:00:00.000
2024-12-12 23:54:17,501 - INFO - pnl: 2024-10-11T23:59:59.999 109238.41091395669 === -5.156%
2024-12-12 23:54:17,506 - DEBUG - cur time: 2024-10-12T23:59:59.999 == next bar open time: 2024-10-13T00:00:00.000 == close pos time: 2024-10-18T00:00:00.000
2024-12-12 23:54:17,508 - INFO - pnl: 2024-10-12T23:59:59.999 108675.54010891434 === -0.515%
2024-12-12 23:54:17,511 - DEBUG - cur time: 2024-10-13T23:59:59.999 == next bar open time: 2024-10-14T00:00:00.000 == close pos time: 2024-10-19T00:00:00.000
2024-12-12 23:54:17,513 - INFO - pnl: 2024-10-13T23:59:59.999 108718.36583437397 === 0.039%
2024-12-12 23:54:17,521 - DEBUG - cur time: 2024-10-14T23:59:59.999 == next bar open time: 2024-10-15T00:00:00.000 == close pos time: 2024-10-20T00:00:00.000
2024-12-12 23:54:17,526 - INFO - pnl: 2024-10-14T23:59:59.999 106502.61854675536 === -2.038%
2024-12-12 23:54:17,534 - DEBUG - cur time: 2024-10-15T23:59:59.999 == next bar open time: 2024-10-16T00:00:00.000 == close pos time: 2024-10-21T00:00:00.000
2024-12-12 23:54:17,548 - DEBUG - close time 2024-10-15T23:59:59.999 == vol_threshold: 19344677.399999995
2024-12-12 23:54:17,549 - DEBUG - 2024-10-15T23:59:59.999 == all trade symbol 253 == remain 177 after VOL filter
2024-12-12 23:54:17,549 - DEBUG - sorted_long_factors: shape: (177, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ IOTXUSDT     ┆ -4.81219     ┆ 0    ┆ 176          │
│ JOEUSDT      ┆ -4.657035    ┆ 1    ┆ 175          │
│ EDUUSDT      ┆ -4.566801    ┆ 2    ┆ 174          │
│ DUSKUSDT     ┆ -4.017545    ┆ 3    ┆ 173          │
│ XRPUSDT      ┆ -3.808015    ┆ 4    ┆ 172          │
│ BNXUSDT      ┆ -3.783943    ┆ 5    ┆ 171          │
│ ACHUSDT      ┆ -3.430226    ┆ 6    ┆ 170          │
│ TONUSDT      ┆ -3.342223    ┆ 7    ┆ 169          │
│ RENUSDT      ┆ -3.34069     ┆ 8    ┆ 168          │
│ 1000SATSUSDT ┆ -3.27696     ┆ 9    ┆ 167          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOSTUSDT     ┆ 2.97944      ┆ 167  ┆ 9            │
│ XEMUSDT      ┆ 3.028498     ┆ 168  ┆ 8            │
│ SANDUSDT     ┆ 3.211667     ┆ 169  ┆ 7            │
│ EOSUSDT      ┆ 3.606327     ┆ 170  ┆ 6            │
│ ANKRUSDT     ┆ 3.752696     ┆ 171  ┆ 5            │
│ STORJUSDT    ┆ 4.004634     ┆ 172  ┆ 4            │
│ FLOWUSDT     ┆ 4.138898     ┆ 173  ┆ 3            │
│ HBARUSDT     ┆ 4.754294     ┆ 174  ┆ 2            │
│ STEEMUSDT    ┆ 5.617218     ┆ 175  ┆ 1            │
│ BLZUSDT      ┆ 6.764387     ┆ 176  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,557 - WARNING - 2024-10-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,557 - INFO - cur close time: 2024-10-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:17,557 - DEBUG - mean expected ret (mean factor): -0.014956365504877235
2024-12-12 23:54:17,561 - DEBUG - begin to update pos: =========
2024-12-12 23:54:17,561 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,561 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.022482    ┆ 0.14815     ┆ 0.09038     ┆ 0.0103876  ┆ … ┆ 0.0153  ┆ 0.13358 ┆ 4.1105  ┆ 0.336   │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:17,573 - DEBUG - update position: 2024-10-15T23:59:59.999 === diff_trading_value: 357431.35102747125 == cash: 98272.17725768263 
2024-12-12 23:54:17,577 - INFO - pnl: 2024-10-15T23:59:59.999 98272.17725768263 === -7.728%
2024-12-12 23:54:17,581 - DEBUG - cur time: 2024-10-16T23:59:59.999 == next bar open time: 2024-10-17T00:00:00.000 == close pos time: 2024-10-22T00:00:00.000
2024-12-12 23:54:17,584 - INFO - pnl: 2024-10-16T23:59:59.999 97859.32895788646 === -0.420%
2024-12-12 23:54:17,589 - DEBUG - cur time: 2024-10-17T23:59:59.999 == next bar open time: 2024-10-18T00:00:00.000 == close pos time: 2024-10-23T00:00:00.000
2024-12-12 23:54:17,592 - INFO - pnl: 2024-10-17T23:59:59.999 96945.96580415912 === -0.933%
2024-12-12 23:54:17,598 - DEBUG - cur time: 2024-10-18T23:59:59.999 == next bar open time: 2024-10-19T00:00:00.000 == close pos time: 2024-10-24T00:00:00.000
2024-12-12 23:54:17,599 - INFO - pnl: 2024-10-18T23:59:59.999 97337.15531242685 === 0.404%
2024-12-12 23:54:17,601 - DEBUG - cur time: 2024-10-19T23:59:59.999 == next bar open time: 2024-10-20T00:00:00.000 == close pos time: 2024-10-25T00:00:00.000
2024-12-12 23:54:17,605 - INFO - pnl: 2024-10-19T23:59:59.999 96990.677543369 === -0.356%
2024-12-12 23:54:17,610 - DEBUG - cur time: 2024-10-20T23:59:59.999 == next bar open time: 2024-10-21T00:00:00.000 == close pos time: 2024-10-26T00:00:00.000
2024-12-12 23:54:17,621 - DEBUG - close time 2024-10-20T23:59:59.999 == vol_threshold: 15064525.24
2024-12-12 23:54:17,622 - DEBUG - 2024-10-20T23:59:59.999 == all trade symbol 252 == remain 176 after VOL filter
2024-12-12 23:54:17,622 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DUSKUSDT     ┆ -5.181363    ┆ 0    ┆ 175          │
│ COMBOUSDT    ┆ -4.527101    ┆ 1    ┆ 174          │
│ OXTUSDT      ┆ -4.168254    ┆ 2    ┆ 173          │
│ KEYUSDT      ┆ -4.132434    ┆ 3    ┆ 172          │
│ FETUSDT      ┆ -3.951899    ┆ 4    ┆ 171          │
│ STXUSDT      ┆ -3.779354    ┆ 5    ┆ 170          │
│ 1000PEPEUSDT ┆ -3.771018    ┆ 6    ┆ 169          │
│ 1000SHIBUSDT ┆ -3.491065    ┆ 7    ┆ 168          │
│ USTCUSDT     ┆ -3.384363    ┆ 8    ┆ 167          │
│ WAXPUSDT     ┆ -3.308425    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ WOOUSDT      ┆ 3.656097     ┆ 166  ┆ 9            │
│ ONEUSDT      ┆ 3.668591     ┆ 167  ┆ 8            │
│ APEUSDT      ┆ 3.695014     ┆ 168  ┆ 7            │
│ CELRUSDT     ┆ 4.273016     ┆ 169  ┆ 6            │
│ PERPUSDT     ┆ 4.344565     ┆ 170  ┆ 5            │
│ LINAUSDT     ┆ 4.577149     ┆ 171  ┆ 4            │
│ XEMUSDT      ┆ 5.099272     ┆ 172  ┆ 3            │
│ FLMUSDT      ┆ 5.787667     ┆ 173  ┆ 2            │
│ CKBUSDT      ┆ 6.61086      ┆ 174  ┆ 1            │
│ ATAUSDT      ┆ 6.873328     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,631 - WARNING - 2024-10-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,632 - INFO - cur close time: 2024-10-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:17,632 - DEBUG - mean expected ret (mean factor): -0.12678333052037016
2024-12-12 23:54:17,638 - DEBUG - begin to update pos: =========
2024-12-12 23:54:17,638 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,638 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.024223    ┆ 0.15754     ┆ 0.09347     ┆ 0.0106932  ┆ … ┆ 0.01612 ┆ 0.14893 ┆ 4.0715  ┆ 0.3553  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:17,645 - DEBUG - update position: 2024-10-20T23:59:59.999 === diff_trading_value: 344280.89126494556 == cash: 96777.1260532262 
2024-12-12 23:54:17,646 - INFO - pnl: 2024-10-20T23:59:59.999 96777.1260532262 === -0.220%
2024-12-12 23:54:17,650 - DEBUG - cur time: 2024-10-21T23:59:59.999 == next bar open time: 2024-10-22T00:00:00.000 == close pos time: 2024-10-27T00:00:00.000
2024-12-12 23:54:17,650 - INFO - pnl: 2024-10-21T23:59:59.999 98837.32938109008 === 2.129%
2024-12-12 23:54:17,657 - DEBUG - cur time: 2024-10-22T23:59:59.999 == next bar open time: 2024-10-23T00:00:00.000 == close pos time: 2024-10-28T00:00:00.000
2024-12-12 23:54:17,658 - INFO - pnl: 2024-10-22T23:59:59.999 99024.75382717697 === 0.190%
2024-12-12 23:54:17,665 - DEBUG - cur time: 2024-10-23T23:59:59.999 == next bar open time: 2024-10-24T00:00:00.000 == close pos time: 2024-10-29T00:00:00.000
2024-12-12 23:54:17,667 - INFO - pnl: 2024-10-23T23:59:59.999 98122.49200220745 === -0.911%
2024-12-12 23:54:17,670 - DEBUG - cur time: 2024-10-24T23:59:59.999 == next bar open time: 2024-10-25T00:00:00.000 == close pos time: 2024-10-30T00:00:00.000
2024-12-12 23:54:17,671 - INFO - pnl: 2024-10-24T23:59:59.999 98266.8383439215 === 0.147%
2024-12-12 23:54:17,674 - DEBUG - cur time: 2024-10-25T23:59:59.999 == next bar open time: 2024-10-26T00:00:00.000 == close pos time: 2024-10-31T00:00:00.000
2024-12-12 23:54:17,684 - DEBUG - close time 2024-10-25T23:59:59.999 == vol_threshold: 19507819.829999994
2024-12-12 23:54:17,684 - DEBUG - 2024-10-25T23:59:59.999 == all trade symbol 254 == remain 178 after VOL filter
2024-12-12 23:54:17,688 - DEBUG - sorted_long_factors: shape: (178, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ GTCUSDT      ┆ -4.078108    ┆ 0    ┆ 177          │
│ RDNTUSDT     ┆ -3.990113    ┆ 1    ┆ 176          │
│ EDUUSDT      ┆ -3.683281    ┆ 2    ┆ 175          │
│ BAKEUSDT     ┆ -3.619648    ┆ 3    ┆ 174          │
│ 1000PEPEUSDT ┆ -3.596947    ┆ 4    ┆ 173          │
│ STRKUSDT     ┆ -3.478239    ┆ 5    ┆ 172          │
│ APTUSDT      ┆ -3.382935    ┆ 6    ┆ 171          │
│ DUSKUSDT     ┆ -3.319022    ┆ 7    ┆ 170          │
│ MINAUSDT     ┆ -3.173139    ┆ 8    ┆ 169          │
│ ONDOUSDT     ┆ -3.111157    ┆ 9    ┆ 168          │
│ …            ┆ …            ┆ …    ┆ …            │
│ APEUSDT      ┆ 3.295496     ┆ 168  ┆ 9            │
│ GLMUSDT      ┆ 3.322862     ┆ 169  ┆ 8            │
│ TNSRUSDT     ┆ 3.355687     ┆ 170  ┆ 7            │
│ EOSUSDT      ┆ 3.427119     ┆ 171  ┆ 6            │
│ MEWUSDT      ┆ 3.492568     ┆ 172  ┆ 5            │
│ BATUSDT      ┆ 3.65133      ┆ 173  ┆ 4            │
│ SUPERUSDT    ┆ 3.767086     ┆ 174  ┆ 3            │
│ TUSDT        ┆ 4.323807     ┆ 175  ┆ 2            │
│ ORBSUSDT     ┆ 4.772014     ┆ 176  ┆ 1            │
│ WAXPUSDT     ┆ 5.367154     ┆ 177  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,695 - WARNING - 2024-10-25T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,695 - INFO - cur close time: 2024-10-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:17,695 - DEBUG - mean expected ret (mean factor): -0.09168088483654051
2024-12-12 23:54:17,697 - DEBUG - begin to update pos: =========
2024-12-12 23:54:17,697 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,700 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.020488    ┆ 0.1311      ┆ 0.08671     ┆ 0.0087774  ┆ … ┆ 0.01405 ┆ 0.12602 ┆ 3.2969  ┆ 0.3194  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-12-12 23:54:17,705 - DEBUG - update position: 2024-10-25T23:59:59.999 === diff_trading_value: 321382.3749559068 == cash: 97828.29213042314 
2024-12-12 23:54:17,705 - INFO - pnl: 2024-10-25T23:59:59.999 97828.29213042314 === -0.446%
2024-12-12 23:54:17,709 - DEBUG - cur time: 2024-10-26T23:59:59.999 == next bar open time: 2024-10-27T00:00:00.000 == close pos time: 2024-11-01T00:00:00.000
2024-12-12 23:54:17,709 - INFO - pnl: 2024-10-26T23:59:59.999 97206.64361429364 === -0.635%
2024-12-12 23:54:17,740 - INFO - start get SinglePnl: shape: (130_305, 99)
┌────────────┬───────────┬──────────┬──────────┬───┬───────────┬───────────┬───────────┬───────────┐
│ symbol     ┆ open_time ┆ open     ┆ high     ┆ … ┆ long_valu ┆ short_val ┆ long_valu ┆ short_val │
│ ---        ┆ ---       ┆ ---      ┆ ---      ┆   ┆ e_scale_9 ┆ ue_scale_ ┆ e_scale_1 ┆ ue_scale_ │
│ str        ┆ datetime[ ┆ f64      ┆ f64      ┆   ┆ day       ┆ 9day      ┆ 0day      ┆ 10day     │
│            ┆ ms]       ┆          ┆          ┆   ┆ ---       ┆ ---       ┆ ---       ┆ ---       │
│            ┆           ┆          ┆          ┆   ┆ f64       ┆ f64       ┆ f64       ┆ f64       │
╞════════════╪═══════════╪══════════╪══════════╪═══╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010656 ┆ 0.010834 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.0       ┆ 1.0       │
│ DT         ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010747 ┆ 0.010872 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010541 ┆ 0.010638 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010346 ┆ 0.010412 ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010074 ┆ 0.010637 ┆ … ┆ 0.8       ┆ 1.2       ┆ 1.0       ┆ 1.0       │
│ DT         ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010172 ┆ 0.010209 ┆ … ┆ 1.0       ┆ 1.0       ┆ 0.8       ┆ 1.2       │
│ DT         ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.009935 ┆ 0.01061  ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010431 ┆ 0.010635 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.0       ┆ 1.0       │
│ DT         ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-0 ┆ 0.010362 ┆ 0.012789 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-02-1 ┆ 0.012146 ┆ 0.013725 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ …          ┆ …         ┆ …        ┆ …        ┆ … ┆ …         ┆ …         ┆ …         ┆ …         │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3196   ┆ 0.3373   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3355   ┆ 0.3415   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3359   ┆ 0.3565   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3553   ┆ 0.3881   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3577   ┆ 0.3581   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3511   ┆ 0.3547   ┆ … ┆ 0.8       ┆ 1.2       ┆ 1.2       ┆ 0.8       │
│            ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3383   ┆ 0.3548   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3417   ┆ 0.3632   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3194   ┆ 0.3243   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.316    ┆ 0.3317   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
└────────────┴───────────┴──────────┴──────────┴───┴───────────┴───────────┴───────────┴───────────┘
2024-12-12 23:54:17,826 - DEBUG - cur time: 2023-01-10T23:59:59.999 == next bar open time: 2023-01-11T00:00:00.000 == close pos time: 2023-01-16T00:00:00.000
2024-12-12 23:54:17,839 - DEBUG - close time 2023-01-10T23:59:59.999 == vol_threshold: 21018568.37999998
2024-12-12 23:54:17,840 - DEBUG - 2023-01-10T23:59:59.999 == all trade symbol 135 == remain 94 after VOL filter
2024-12-12 23:54:17,840 - DEBUG - sorted_long_factors: shape: (94, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ARPAUSDT  ┆ -4.78716     ┆ 0    ┆ 93           │
│ ATAUSDT   ┆ -4.406557    ┆ 1    ┆ 92           │
│ THETAUSDT ┆ -4.020645    ┆ 2    ┆ 91           │
│ VETUSDT   ┆ -3.987658    ┆ 3    ┆ 90           │
│ DGBUSDT   ┆ -3.77495     ┆ 4    ┆ 89           │
│ MTLUSDT   ┆ -3.636046    ┆ 5    ┆ 88           │
│ ONTUSDT   ┆ -3.568723    ┆ 6    ┆ 87           │
│ LUNA2USDT ┆ -3.276649    ┆ 7    ┆ 86           │
│ STORJUSDT ┆ -3.030891    ┆ 8    ┆ 85           │
│ BAKEUSDT  ┆ -2.689567    ┆ 9    ┆ 84           │
│ …         ┆ …            ┆ …    ┆ …            │
│ ALGOUSDT  ┆ 2.34574      ┆ 84   ┆ 9            │
│ CELOUSDT  ┆ 2.604856     ┆ 85   ┆ 8            │
│ GALAUSDT  ┆ 2.891872     ┆ 86   ┆ 7            │
│ TRXUSDT   ┆ 2.916143     ┆ 87   ┆ 6            │
│ RVNUSDT   ┆ 2.996737     ┆ 88   ┆ 5            │
│ STMXUSDT  ┆ 3.027801     ┆ 89   ┆ 4            │
│ RSRUSDT   ┆ 3.04457      ┆ 90   ┆ 3            │
│ STGUSDT   ┆ 3.390454     ┆ 91   ┆ 2            │
│ 1INCHUSDT ┆ 3.636014     ┆ 92   ┆ 1            │
│ DUSKUSDT  ┆ 9.337099     ┆ 93   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,847 - WARNING - 2023-01-10T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,847 - INFO - cur close time: 2023-01-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:17,847 - DEBUG - mean expected ret (mean factor): -0.048229522086130884
2024-12-12 23:54:17,851 - DEBUG - begin to update pos: =========
2024-12-12 23:54:17,851 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,852 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1667      ┆ null        ┆ … ┆ 0.02399 ┆ null   ┆ null    ┆ 0.1738  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,858 - DEBUG - update position: 2023-01-10T23:59:59.999 === diff_trading_value: 200000.0 == cash: 99800.0 
2024-12-12 23:54:17,863 - DEBUG - cur time: 2023-01-11T23:59:59.999 == next bar open time: 2023-01-12T00:00:00.000 == close pos time: 2023-01-17T00:00:00.000
2024-12-12 23:54:17,864 - INFO - pnl: 2023-01-11T23:59:59.999 98964.60774791737 === -0.837%
2024-12-12 23:54:17,866 - DEBUG - cur time: 2023-01-12T23:59:59.999 == next bar open time: 2023-01-13T00:00:00.000 == close pos time: 2023-01-18T00:00:00.000
2024-12-12 23:54:17,868 - INFO - pnl: 2023-01-12T23:59:59.999 98566.03568680395 === -0.403%
2024-12-12 23:54:17,871 - DEBUG - cur time: 2023-01-13T23:59:59.999 == next bar open time: 2023-01-14T00:00:00.000 == close pos time: 2023-01-19T00:00:00.000
2024-12-12 23:54:17,872 - INFO - pnl: 2023-01-13T23:59:59.999 100746.94637297007 === 2.213%
2024-12-12 23:54:17,876 - DEBUG - cur time: 2023-01-14T23:59:59.999 == next bar open time: 2023-01-15T00:00:00.000 == close pos time: 2023-01-20T00:00:00.000
2024-12-12 23:54:17,876 - INFO - pnl: 2023-01-14T23:59:59.999 101159.78016498224 === 0.410%
2024-12-12 23:54:17,880 - DEBUG - cur time: 2023-01-15T23:59:59.999 == next bar open time: 2023-01-16T00:00:00.000 == close pos time: 2023-01-21T00:00:00.000
2024-12-12 23:54:17,888 - DEBUG - close time 2023-01-15T23:59:59.999 == vol_threshold: 28452371.0
2024-12-12 23:54:17,890 - DEBUG - 2023-01-15T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:17,891 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT  ┆ -4.467515    ┆ 0    ┆ 94           │
│ ARPAUSDT ┆ -4.293587    ┆ 1    ┆ 93           │
│ FILUSDT  ┆ -3.748396    ┆ 2    ┆ 92           │
│ BLZUSDT  ┆ -2.533847    ┆ 3    ┆ 91           │
│ REEFUSDT ┆ -2.380017    ┆ 4    ┆ 90           │
│ FTMUSDT  ┆ -2.29692     ┆ 5    ┆ 89           │
│ KLAYUSDT ┆ -2.199216    ┆ 6    ┆ 88           │
│ DOTUSDT  ┆ -2.185926    ┆ 7    ┆ 87           │
│ KAVAUSDT ┆ -2.124684    ┆ 8    ┆ 86           │
│ BAKEUSDT ┆ -1.956392    ┆ 9    ┆ 85           │
│ …        ┆ …            ┆ …    ┆ …            │
│ GMTUSDT  ┆ 3.04963      ┆ 85   ┆ 9            │
│ SKLUSDT  ┆ 3.304035     ┆ 86   ┆ 8            │
│ IOSTUSDT ┆ 3.474591     ┆ 87   ┆ 7            │
│ DARUSDT  ┆ 3.951104     ┆ 88   ┆ 6            │
│ CHRUSDT  ┆ 4.060349     ┆ 89   ┆ 5            │
│ SXPUSDT  ┆ 4.258916     ┆ 90   ┆ 4            │
│ NKNUSDT  ┆ 4.431912     ┆ 91   ┆ 3            │
│ ZRXUSDT  ┆ 5.046866     ┆ 92   ┆ 2            │
│ ALGOUSDT ┆ 5.137385     ┆ 93   ┆ 1            │
│ CTSIUSDT ┆ 5.20516      ┆ 94   ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,897 - WARNING - 2023-01-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,897 - INFO - cur close time: 2023-01-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:17,897 - DEBUG - mean expected ret (mean factor): 0.22043728907902063
2024-12-12 23:54:17,901 - DEBUG - begin to update pos: =========
2024-12-12 23:54:17,901 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,901 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1808      ┆ null        ┆ … ┆ 0.02594 ┆ null   ┆ null    ┆ 0.2037  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,908 - DEBUG - update position: 2023-01-15T23:59:59.999 === diff_trading_value: 354525.9141827589 == cash: 99291.85271910671 
2024-12-12 23:54:17,909 - INFO - pnl: 2023-01-15T23:59:59.999 99291.85271910671 === -1.847%
2024-12-12 23:54:17,913 - DEBUG - cur time: 2023-01-16T23:59:59.999 == next bar open time: 2023-01-17T00:00:00.000 == close pos time: 2023-01-22T00:00:00.000
2024-12-12 23:54:17,914 - INFO - pnl: 2023-01-16T23:59:59.999 98413.06228433331 === -0.885%
2024-12-12 23:54:17,918 - DEBUG - cur time: 2023-01-17T23:59:59.999 == next bar open time: 2023-01-18T00:00:00.000 == close pos time: 2023-01-23T00:00:00.000
2024-12-12 23:54:17,919 - INFO - pnl: 2023-01-17T23:59:59.999 96728.70372958732 === -1.712%
2024-12-12 23:54:17,922 - DEBUG - cur time: 2023-01-18T23:59:59.999 == next bar open time: 2023-01-19T00:00:00.000 == close pos time: 2023-01-24T00:00:00.000
2024-12-12 23:54:17,922 - INFO - pnl: 2023-01-18T23:59:59.999 94504.61547377202 === -2.299%
2024-12-12 23:54:17,926 - DEBUG - cur time: 2023-01-19T23:59:59.999 == next bar open time: 2023-01-20T00:00:00.000 == close pos time: 2023-01-25T00:00:00.000
2024-12-12 23:54:17,926 - INFO - pnl: 2023-01-19T23:59:59.999 95530.670327363 === 1.086%
2024-12-12 23:54:17,931 - DEBUG - cur time: 2023-01-20T23:59:59.999 == next bar open time: 2023-01-21T00:00:00.000 == close pos time: 2023-01-26T00:00:00.000
2024-12-12 23:54:17,939 - DEBUG - close time 2023-01-20T23:59:59.999 == vol_threshold: 23854192.0
2024-12-12 23:54:17,940 - DEBUG - 2023-01-20T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:17,941 - DEBUG - sorted_long_factors: shape: (95, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ SFPUSDT   ┆ -4.328565    ┆ 0    ┆ 94           │
│ BELUSDT   ┆ -3.785489    ┆ 1    ┆ 93           │
│ ALPHAUSDT ┆ -3.714706    ┆ 2    ┆ 92           │
│ SPELLUSDT ┆ -3.647667    ┆ 3    ┆ 91           │
│ NKNUSDT   ┆ -3.306098    ┆ 4    ┆ 90           │
│ DUSKUSDT  ┆ -3.152258    ┆ 5    ┆ 89           │
│ OCEANUSDT ┆ -3.037336    ┆ 6    ┆ 88           │
│ RLCUSDT   ┆ -3.001541    ┆ 7    ┆ 87           │
│ BAKEUSDT  ┆ -2.956407    ┆ 8    ┆ 86           │
│ CHRUSDT   ┆ -2.773505    ┆ 9    ┆ 85           │
│ …         ┆ …            ┆ …    ┆ …            │
│ SNXUSDT   ┆ 2.577103     ┆ 85   ┆ 9            │
│ DOTUSDT   ┆ 2.757184     ┆ 86   ┆ 8            │
│ XEMUSDT   ┆ 2.967951     ┆ 87   ┆ 7            │
│ OPUSDT    ┆ 3.179071     ┆ 88   ┆ 6            │
│ HBARUSDT  ┆ 3.481893     ┆ 89   ┆ 5            │
│ APTUSDT   ┆ 3.555783     ┆ 90   ┆ 4            │
│ RVNUSDT   ┆ 3.635303     ┆ 91   ┆ 3            │
│ TRXUSDT   ┆ 3.828987     ┆ 92   ┆ 2            │
│ CRVUSDT   ┆ 3.896613     ┆ 93   ┆ 1            │
│ XLMUSDT   ┆ 6.782062     ┆ 94   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,948 - WARNING - 2023-01-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,948 - INFO - cur close time: 2023-01-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:17,948 - DEBUG - mean expected ret (mean factor): -0.019848261670171837
2024-12-12 23:54:17,949 - DEBUG - begin to update pos: =========
2024-12-12 23:54:17,949 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,949 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1791      ┆ null        ┆ … ┆ 0.02761 ┆ null   ┆ null    ┆ 0.2187  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:17,959 - DEBUG - update position: 2023-01-20T23:59:59.999 === diff_trading_value: 351204.61330139573 == cash: 99500.99039970334 
2024-12-12 23:54:17,961 - INFO - pnl: 2023-01-20T23:59:59.999 99500.99039970334 === 4.156%
2024-12-12 23:54:17,964 - DEBUG - cur time: 2023-01-21T23:59:59.999 == next bar open time: 2023-01-22T00:00:00.000 == close pos time: 2023-01-27T00:00:00.000
2024-12-12 23:54:17,965 - INFO - pnl: 2023-01-21T23:59:59.999 96659.13841294704 === -2.856%
2024-12-12 23:54:17,968 - DEBUG - cur time: 2023-01-22T23:59:59.999 == next bar open time: 2023-01-23T00:00:00.000 == close pos time: 2023-01-28T00:00:00.000
2024-12-12 23:54:17,970 - INFO - pnl: 2023-01-22T23:59:59.999 96754.62101421277 === 0.099%
2024-12-12 23:54:17,972 - DEBUG - cur time: 2023-01-23T23:59:59.999 == next bar open time: 2023-01-24T00:00:00.000 == close pos time: 2023-01-29T00:00:00.000
2024-12-12 23:54:17,972 - INFO - pnl: 2023-01-23T23:59:59.999 94078.1204851272 === -2.766%
2024-12-12 23:54:17,976 - DEBUG - cur time: 2023-01-24T23:59:59.999 == next bar open time: 2023-01-25T00:00:00.000 == close pos time: 2023-01-30T00:00:00.000
2024-12-12 23:54:17,979 - INFO - pnl: 2023-01-24T23:59:59.999 88021.34615182507 === -6.438%
2024-12-12 23:54:17,984 - DEBUG - cur time: 2023-01-25T23:59:59.999 == next bar open time: 2023-01-26T00:00:00.000 == close pos time: 2023-01-31T00:00:00.000
2024-12-12 23:54:17,992 - DEBUG - close time 2023-01-25T23:59:59.999 == vol_threshold: 26572747.9
2024-12-12 23:54:17,993 - DEBUG - 2023-01-25T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:17,994 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DARUSDT      ┆ -7.266381    ┆ 0    ┆ 94           │
│ SPELLUSDT    ┆ -6.030023    ┆ 1    ┆ 93           │
│ XLMUSDT      ┆ -5.097365    ┆ 2    ┆ 92           │
│ ARPAUSDT     ┆ -3.398397    ┆ 3    ┆ 91           │
│ HOTUSDT      ┆ -3.349415    ┆ 4    ┆ 90           │
│ BAKEUSDT     ┆ -3.047645    ┆ 5    ┆ 89           │
│ KLAYUSDT     ┆ -2.910085    ┆ 6    ┆ 88           │
│ JASMYUSDT    ┆ -2.87138     ┆ 7    ┆ 87           │
│ DOGEUSDT     ┆ -2.616157    ┆ 8    ┆ 86           │
│ 1000LUNCUSDT ┆ -2.605353    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ CELOUSDT     ┆ 2.809422     ┆ 85   ┆ 9            │
│ EOSUSDT      ┆ 2.84643      ┆ 86   ┆ 8            │
│ FLMUSDT      ┆ 2.859671     ┆ 87   ┆ 7            │
│ ZRXUSDT      ┆ 3.127233     ┆ 88   ┆ 6            │
│ CELRUSDT     ┆ 3.24658      ┆ 89   ┆ 5            │
│ CRVUSDT      ┆ 3.431274     ┆ 90   ┆ 4            │
│ DYDXUSDT     ┆ 3.488155     ┆ 91   ┆ 3            │
│ PEOPLEUSDT   ┆ 3.61324      ┆ 92   ┆ 2            │
│ ONEUSDT      ┆ 4.56706      ┆ 93   ┆ 1            │
│ APTUSDT      ┆ 5.190183     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:17,997 - WARNING - 2023-01-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:17,997 - INFO - cur close time: 2023-01-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:18,000 - DEBUG - mean expected ret (mean factor): 0.015600256942572848
2024-12-12 23:54:18,000 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,000 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,004 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1735      ┆ null        ┆ … ┆ 0.028   ┆ null   ┆ null    ┆ 0.2252  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,008 - DEBUG - update position: 2023-01-25T23:59:59.999 === diff_trading_value: 300413.33230858133 == cash: 93314.29070628037 
2024-12-12 23:54:18,011 - INFO - pnl: 2023-01-25T23:59:59.999 93314.29070628037 === 6.013%
2024-12-12 23:54:18,019 - DEBUG - cur time: 2023-01-26T23:59:59.999 == next bar open time: 2023-01-27T00:00:00.000 == close pos time: 2023-02-01T00:00:00.000
2024-12-12 23:54:18,021 - INFO - pnl: 2023-01-26T23:59:59.999 93212.3567345203 === -0.109%
2024-12-12 23:54:18,032 - DEBUG - cur time: 2023-01-27T23:59:59.999 == next bar open time: 2023-01-28T00:00:00.000 == close pos time: 2023-02-02T00:00:00.000
2024-12-12 23:54:18,036 - INFO - pnl: 2023-01-27T23:59:59.999 89891.69774272083 === -3.562%
2024-12-12 23:54:18,043 - DEBUG - cur time: 2023-01-28T23:59:59.999 == next bar open time: 2023-01-29T00:00:00.000 == close pos time: 2023-02-03T00:00:00.000
2024-12-12 23:54:18,047 - INFO - pnl: 2023-01-28T23:59:59.999 87327.57146048396 === -2.852%
2024-12-12 23:54:18,053 - DEBUG - cur time: 2023-01-29T23:59:59.999 == next bar open time: 2023-01-30T00:00:00.000 == close pos time: 2023-02-04T00:00:00.000
2024-12-12 23:54:18,055 - INFO - pnl: 2023-01-29T23:59:59.999 89223.40369945813 === 2.171%
2024-12-12 23:54:18,059 - DEBUG - cur time: 2023-01-30T23:59:59.999 == next bar open time: 2023-01-31T00:00:00.000 == close pos time: 2023-02-05T00:00:00.000
2024-12-12 23:54:18,070 - DEBUG - close time 2023-01-30T23:59:59.999 == vol_threshold: 28014433.5
2024-12-12 23:54:18,070 - DEBUG - 2023-01-30T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:18,072 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ STGUSDT      ┆ -4.96641     ┆ 0    ┆ 94           │
│ 1000LUNCUSDT ┆ -3.330513    ┆ 1    ┆ 93           │
│ ZILUSDT      ┆ -3.200108    ┆ 2    ┆ 92           │
│ ANKRUSDT     ┆ -2.895699    ┆ 3    ┆ 91           │
│ IOTXUSDT     ┆ -2.835649    ┆ 4    ┆ 90           │
│ FILUSDT      ┆ -2.816537    ┆ 5    ┆ 89           │
│ LDOUSDT      ┆ -2.815811    ┆ 6    ┆ 88           │
│ RVNUSDT      ┆ -2.362648    ┆ 7    ┆ 87           │
│ ALPHAUSDT    ┆ -2.31223     ┆ 8    ┆ 86           │
│ ROSEUSDT     ┆ -1.980019    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ ATAUSDT      ┆ 2.235514     ┆ 85   ┆ 9            │
│ DUSKUSDT     ┆ 2.245455     ┆ 86   ┆ 8            │
│ SFPUSDT      ┆ 2.388872     ┆ 87   ┆ 7            │
│ TRXUSDT      ┆ 2.577533     ┆ 88   ┆ 6            │
│ MASKUSDT     ┆ 3.110355     ┆ 89   ┆ 5            │
│ IOSTUSDT     ┆ 3.357835     ┆ 90   ┆ 4            │
│ DYDXUSDT     ┆ 3.577521     ┆ 91   ┆ 3            │
│ BATUSDT      ┆ 3.886733     ┆ 92   ┆ 2            │
│ INJUSDT      ┆ 4.133225     ┆ 93   ┆ 1            │
│ XEMUSDT      ┆ 4.979246     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,078 - WARNING - 2023-01-30T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,078 - INFO - cur close time: 2023-01-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:18,078 - DEBUG - mean expected ret (mean factor): 0.0020072807826582713
2024-12-12 23:54:18,082 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,082 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,082 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1646      ┆ null        ┆ … ┆ 0.02671 ┆ null   ┆ null    ┆ 0.2144  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,088 - DEBUG - update position: 2023-01-30T23:59:59.999 === diff_trading_value: 325995.78052974073 == cash: 87162.22688199629 
2024-12-12 23:54:18,088 - INFO - pnl: 2023-01-30T23:59:59.999 87162.22688199629 === -2.310%
2024-12-12 23:54:18,090 - DEBUG - cur time: 2023-01-31T23:59:59.999 == next bar open time: 2023-02-01T00:00:00.000 == close pos time: 2023-02-06T00:00:00.000
2024-12-12 23:54:18,094 - INFO - pnl: 2023-01-31T23:59:59.999 91956.60081907506 === 5.501%
2024-12-12 23:54:18,096 - DEBUG - cur time: 2023-02-01T23:59:59.999 == next bar open time: 2023-02-02T00:00:00.000 == close pos time: 2023-02-07T00:00:00.000
2024-12-12 23:54:18,098 - INFO - pnl: 2023-02-01T23:59:59.999 91744.16987854232 === -0.231%
2024-12-12 23:54:18,100 - DEBUG - cur time: 2023-02-02T23:59:59.999 == next bar open time: 2023-02-03T00:00:00.000 == close pos time: 2023-02-08T00:00:00.000
2024-12-12 23:54:18,103 - INFO - pnl: 2023-02-02T23:59:59.999 93441.0220207513 === 1.850%
2024-12-12 23:54:18,106 - DEBUG - cur time: 2023-02-03T23:59:59.999 == next bar open time: 2023-02-04T00:00:00.000 == close pos time: 2023-02-09T00:00:00.000
2024-12-12 23:54:18,107 - INFO - pnl: 2023-02-03T23:59:59.999 91004.93826846669 === -2.607%
2024-12-12 23:54:18,111 - DEBUG - cur time: 2023-02-04T23:59:59.999 == next bar open time: 2023-02-05T00:00:00.000 == close pos time: 2023-02-10T00:00:00.000
2024-12-12 23:54:18,120 - DEBUG - close time 2023-02-04T23:59:59.999 == vol_threshold: 20658467.05
2024-12-12 23:54:18,121 - DEBUG - 2023-02-04T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:18,122 - DEBUG - sorted_long_factors: shape: (95, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ STGUSDT   ┆ -4.266958    ┆ 0    ┆ 94           │
│ ONTUSDT   ┆ -3.478956    ┆ 1    ┆ 93           │
│ LDOUSDT   ┆ -2.950536    ┆ 2    ┆ 92           │
│ LRCUSDT   ┆ -2.778326    ┆ 3    ┆ 91           │
│ FLMUSDT   ┆ -2.603193    ┆ 4    ┆ 90           │
│ CELRUSDT  ┆ -2.439008    ┆ 5    ┆ 89           │
│ C98USDT   ┆ -2.377319    ┆ 6    ┆ 88           │
│ CHZUSDT   ┆ -2.22765     ┆ 7    ┆ 87           │
│ LUNA2USDT ┆ -2.142131    ┆ 8    ┆ 86           │
│ GMTUSDT   ┆ -1.891227    ┆ 9    ┆ 85           │
│ …         ┆ …            ┆ …    ┆ …            │
│ KLAYUSDT  ┆ 2.913802     ┆ 85   ┆ 9            │
│ INJUSDT   ┆ 3.176706     ┆ 86   ┆ 8            │
│ MASKUSDT  ┆ 3.270669     ┆ 87   ┆ 7            │
│ ICXUSDT   ┆ 3.42382      ┆ 88   ┆ 6            │
│ MTLUSDT   ┆ 3.480079     ┆ 89   ┆ 5            │
│ ARPAUSDT  ┆ 4.040823     ┆ 90   ┆ 4            │
│ RENUSDT   ┆ 4.085208     ┆ 91   ┆ 3            │
│ XLMUSDT   ┆ 4.106837     ┆ 92   ┆ 2            │
│ EOSUSDT   ┆ 4.153394     ┆ 93   ┆ 1            │
│ BAKEUSDT  ┆ 5.068883     ┆ 94   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,127 - WARNING - 2023-02-04T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,130 - INFO - cur close time: 2023-02-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:18,130 - DEBUG - mean expected ret (mean factor): 0.30467470871259483
2024-12-12 23:54:18,132 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,132 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,132 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1921      ┆ null        ┆ … ┆ 0.02985 ┆ null   ┆ null    ┆ 0.259   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,140 - DEBUG - update position: 2023-02-04T23:59:59.999 === diff_trading_value: 347817.0505249549 == cash: 93254.34174723686 
2024-12-12 23:54:18,140 - INFO - pnl: 2023-02-04T23:59:59.999 93254.34174723686 === 2.472%
2024-12-12 23:54:18,144 - DEBUG - cur time: 2023-02-05T23:59:59.999 == next bar open time: 2023-02-06T00:00:00.000 == close pos time: 2023-02-11T00:00:00.000
2024-12-12 23:54:18,145 - INFO - pnl: 2023-02-05T23:59:59.999 94602.26746466209 === 1.445%
2024-12-12 23:54:18,150 - DEBUG - cur time: 2023-02-06T23:59:59.999 == next bar open time: 2023-02-07T00:00:00.000 == close pos time: 2023-02-12T00:00:00.000
2024-12-12 23:54:18,150 - INFO - pnl: 2023-02-06T23:59:59.999 94520.02526532841 === -0.087%
2024-12-12 23:54:18,157 - DEBUG - cur time: 2023-02-07T23:59:59.999 == next bar open time: 2023-02-08T00:00:00.000 == close pos time: 2023-02-13T00:00:00.000
2024-12-12 23:54:18,158 - INFO - pnl: 2023-02-07T23:59:59.999 96049.03043556573 === 1.618%
2024-12-12 23:54:18,162 - DEBUG - cur time: 2023-02-08T23:59:59.999 == next bar open time: 2023-02-09T00:00:00.000 == close pos time: 2023-02-14T00:00:00.000
2024-12-12 23:54:18,163 - INFO - pnl: 2023-02-08T23:59:59.999 93359.72615735652 === -2.800%
2024-12-12 23:54:18,167 - DEBUG - cur time: 2023-02-09T23:59:59.999 == next bar open time: 2023-02-10T00:00:00.000 == close pos time: 2023-02-15T00:00:00.000
2024-12-12 23:54:18,183 - DEBUG - close time 2023-02-09T23:59:59.999 == vol_threshold: 30482412.6
2024-12-12 23:54:18,183 - DEBUG - 2023-02-09T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:18,187 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SPELLUSDT    ┆ -4.139177    ┆ 0    ┆ 94           │
│ DARUSDT      ┆ -3.909592    ┆ 1    ┆ 93           │
│ ATAUSDT      ┆ -3.609946    ┆ 2    ┆ 92           │
│ DOGEUSDT     ┆ -3.523571    ┆ 3    ┆ 91           │
│ COTIUSDT     ┆ -3.428326    ┆ 4    ┆ 90           │
│ 1000SHIBUSDT ┆ -3.344739    ┆ 5    ┆ 89           │
│ 1000LUNCUSDT ┆ -3.108687    ┆ 6    ┆ 88           │
│ APTUSDT      ┆ -2.778407    ┆ 7    ┆ 87           │
│ SFPUSDT      ┆ -2.588256    ┆ 8    ┆ 86           │
│ GMTUSDT      ┆ -2.016757    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ OGNUSDT      ┆ 2.53245      ┆ 85   ┆ 9            │
│ FLMUSDT      ┆ 2.553118     ┆ 86   ┆ 8            │
│ ENJUSDT      ┆ 2.76207      ┆ 87   ┆ 7            │
│ HBARUSDT     ┆ 2.771763     ┆ 88   ┆ 6            │
│ MATICUSDT    ┆ 2.826927     ┆ 89   ┆ 5            │
│ LINAUSDT     ┆ 3.001496     ┆ 90   ┆ 4            │
│ IOSTUSDT     ┆ 3.114546     ┆ 91   ┆ 3            │
│ SKLUSDT      ┆ 3.405388     ┆ 92   ┆ 2            │
│ ONTUSDT      ┆ 3.857557     ┆ 93   ┆ 1            │
│ IOTXUSDT     ┆ 4.525678     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,192 - WARNING - 2023-02-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,192 - INFO - cur close time: 2023-02-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:18,192 - DEBUG - mean expected ret (mean factor): 0.2973442889988012
2024-12-12 23:54:18,196 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,196 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,196 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1603      ┆ null        ┆ … ┆ 0.0271  ┆ null   ┆ null    ┆ 0.2288  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,202 - DEBUG - update position: 2023-02-09T23:59:59.999 === diff_trading_value: 331982.65220879647 == cash: 92697.06915551794 
2024-12-12 23:54:18,202 - INFO - pnl: 2023-02-09T23:59:59.999 92697.06915551794 === -0.710%
2024-12-12 23:54:18,209 - DEBUG - cur time: 2023-02-10T23:59:59.999 == next bar open time: 2023-02-11T00:00:00.000 == close pos time: 2023-02-16T00:00:00.000
2024-12-12 23:54:18,210 - INFO - pnl: 2023-02-10T23:59:59.999 93523.77483096895 === 0.892%
2024-12-12 23:54:18,213 - DEBUG - cur time: 2023-02-11T23:59:59.999 == next bar open time: 2023-02-12T00:00:00.000 == close pos time: 2023-02-17T00:00:00.000
2024-12-12 23:54:18,214 - INFO - pnl: 2023-02-11T23:59:59.999 94602.7033717856 === 1.154%
2024-12-12 23:54:18,217 - DEBUG - cur time: 2023-02-12T23:59:59.999 == next bar open time: 2023-02-13T00:00:00.000 == close pos time: 2023-02-18T00:00:00.000
2024-12-12 23:54:18,218 - INFO - pnl: 2023-02-12T23:59:59.999 96081.96877783458 === 1.564%
2024-12-12 23:54:18,221 - DEBUG - cur time: 2023-02-13T23:59:59.999 == next bar open time: 2023-02-14T00:00:00.000 == close pos time: 2023-02-19T00:00:00.000
2024-12-12 23:54:18,221 - INFO - pnl: 2023-02-13T23:59:59.999 93533.8000181289 === -2.652%
2024-12-12 23:54:18,225 - DEBUG - cur time: 2023-02-14T23:59:59.999 == next bar open time: 2023-02-15T00:00:00.000 == close pos time: 2023-02-20T00:00:00.000
2024-12-12 23:54:18,234 - DEBUG - close time 2023-02-14T23:59:59.999 == vol_threshold: 16563095.5
2024-12-12 23:54:18,235 - DEBUG - 2023-02-14T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:18,236 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LUNA2USDT    ┆ -5.797357    ┆ 0    ┆ 94           │
│ SPELLUSDT    ┆ -4.935868    ┆ 1    ┆ 93           │
│ 1000LUNCUSDT ┆ -4.323988    ┆ 2    ┆ 92           │
│ CHRUSDT      ┆ -3.522179    ┆ 3    ┆ 91           │
│ COTIUSDT     ┆ -2.851337    ┆ 4    ┆ 90           │
│ BATUSDT      ┆ -2.811487    ┆ 5    ┆ 89           │
│ OGNUSDT      ┆ -2.443878    ┆ 6    ┆ 88           │
│ RSRUSDT      ┆ -2.392326    ┆ 7    ┆ 87           │
│ ALPHAUSDT    ┆ -2.375324    ┆ 8    ┆ 86           │
│ C98USDT      ┆ -2.304441    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ STMXUSDT     ┆ 2.393918     ┆ 85   ┆ 9            │
│ XEMUSDT      ┆ 2.534682     ┆ 86   ┆ 8            │
│ FTMUSDT      ┆ 2.542405     ┆ 87   ┆ 7            │
│ ADAUSDT      ┆ 2.663099     ┆ 88   ┆ 6            │
│ FILUSDT      ┆ 2.984509     ┆ 89   ┆ 5            │
│ APEUSDT      ┆ 3.198814     ┆ 90   ┆ 4            │
│ DGBUSDT      ┆ 3.26359      ┆ 91   ┆ 3            │
│ XRPUSDT      ┆ 3.266081     ┆ 92   ┆ 2            │
│ ROSEUSDT     ┆ 3.996389     ┆ 93   ┆ 1            │
│ RUNEUSDT     ┆ 4.908954     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,239 - WARNING - 2023-02-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,239 - INFO - cur close time: 2023-02-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:18,242 - DEBUG - mean expected ret (mean factor): 0.15131254201564429
2024-12-12 23:54:18,246 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,247 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,247 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1697      ┆ null        ┆ … ┆ 0.02959 ┆ null   ┆ null    ┆ 0.233   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,251 - DEBUG - update position: 2023-02-14T23:59:59.999 === diff_trading_value: 312841.743381329 == cash: 92118.18336875302 
2024-12-12 23:54:18,253 - INFO - pnl: 2023-02-14T23:59:59.999 92118.18336875302 === -1.513%
2024-12-12 23:54:18,255 - DEBUG - cur time: 2023-02-15T23:59:59.999 == next bar open time: 2023-02-16T00:00:00.000 == close pos time: 2023-02-21T00:00:00.000
2024-12-12 23:54:18,255 - INFO - pnl: 2023-02-15T23:59:59.999 93958.25614312687 === 1.998%
2024-12-12 23:54:18,260 - DEBUG - cur time: 2023-02-16T23:59:59.999 == next bar open time: 2023-02-17T00:00:00.000 == close pos time: 2023-02-22T00:00:00.000
2024-12-12 23:54:18,260 - INFO - pnl: 2023-02-16T23:59:59.999 92831.00647552186 === -1.200%
2024-12-12 23:54:18,264 - DEBUG - cur time: 2023-02-17T23:59:59.999 == next bar open time: 2023-02-18T00:00:00.000 == close pos time: 2023-02-23T00:00:00.000
2024-12-12 23:54:18,265 - INFO - pnl: 2023-02-17T23:59:59.999 92432.40492906242 === -0.429%
2024-12-12 23:54:18,268 - DEBUG - cur time: 2023-02-18T23:59:59.999 == next bar open time: 2023-02-19T00:00:00.000 == close pos time: 2023-02-24T00:00:00.000
2024-12-12 23:54:18,270 - INFO - pnl: 2023-02-18T23:59:59.999 91169.77996669928 === -1.366%
2024-12-12 23:54:18,272 - DEBUG - cur time: 2023-02-19T23:59:59.999 == next bar open time: 2023-02-20T00:00:00.000 == close pos time: 2023-02-25T00:00:00.000
2024-12-12 23:54:18,282 - DEBUG - close time 2023-02-19T23:59:59.999 == vol_threshold: 22802125.65
2024-12-12 23:54:18,283 - DEBUG - 2023-02-19T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:18,283 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SPELLUSDT    ┆ -4.001347    ┆ 0    ┆ 94           │
│ ANKRUSDT     ┆ -3.220504    ┆ 1    ┆ 93           │
│ XLMUSDT      ┆ -3.079047    ┆ 2    ┆ 92           │
│ GTCUSDT      ┆ -3.039167    ┆ 3    ┆ 91           │
│ 1000LUNCUSDT ┆ -2.507955    ┆ 4    ┆ 90           │
│ IMXUSDT      ┆ -2.362444    ┆ 5    ┆ 89           │
│ REEFUSDT     ┆ -2.128698    ┆ 6    ┆ 88           │
│ OPUSDT       ┆ -1.993137    ┆ 7    ┆ 87           │
│ XRPUSDT      ┆ -1.883066    ┆ 8    ┆ 86           │
│ LDOUSDT      ┆ -1.850638    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ OMGUSDT      ┆ 2.995729     ┆ 85   ┆ 9            │
│ SKLUSDT      ┆ 3.028198     ┆ 86   ┆ 8            │
│ FILUSDT      ┆ 3.478847     ┆ 87   ┆ 7            │
│ KLAYUSDT     ┆ 3.643472     ┆ 88   ┆ 6            │
│ LITUSDT      ┆ 3.833779     ┆ 89   ┆ 5            │
│ DENTUSDT     ┆ 4.095052     ┆ 90   ┆ 4            │
│ MTLUSDT      ┆ 4.704265     ┆ 91   ┆ 3            │
│ TOMOUSDT     ┆ 5.20339      ┆ 92   ┆ 2            │
│ XEMUSDT      ┆ 5.275381     ┆ 93   ┆ 1            │
│ ICXUSDT      ┆ 7.398627     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,290 - WARNING - 2023-02-19T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,290 - INFO - cur close time: 2023-02-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:18,290 - DEBUG - mean expected ret (mean factor): 0.3590284884748129
2024-12-12 23:54:18,294 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,294 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,295 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1683      ┆ null        ┆ … ┆ 0.03234 ┆ null   ┆ null    ┆ 0.2553  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,300 - DEBUG - update position: 2023-02-19T23:59:59.999 === diff_trading_value: 336267.43358679116 == cash: 91593.91415697301 
2024-12-12 23:54:18,301 - INFO - pnl: 2023-02-19T23:59:59.999 91593.91415697301 === 0.465%
2024-12-12 23:54:18,301 - DEBUG - cur time: 2023-02-20T23:59:59.999 == next bar open time: 2023-02-21T00:00:00.000 == close pos time: 2023-02-26T00:00:00.000
2024-12-12 23:54:18,305 - INFO - pnl: 2023-02-20T23:59:59.999 95646.70500805425 === 4.425%
2024-12-12 23:54:18,308 - DEBUG - cur time: 2023-02-21T23:59:59.999 == next bar open time: 2023-02-22T00:00:00.000 == close pos time: 2023-02-27T00:00:00.000
2024-12-12 23:54:18,308 - INFO - pnl: 2023-02-21T23:59:59.999 88551.93552558035 === -7.418%
2024-12-12 23:54:18,311 - DEBUG - cur time: 2023-02-22T23:59:59.999 == next bar open time: 2023-02-23T00:00:00.000 == close pos time: 2023-02-28T00:00:00.000
2024-12-12 23:54:18,312 - INFO - pnl: 2023-02-22T23:59:59.999 86609.61193335109 === -2.193%
2024-12-12 23:54:18,315 - DEBUG - cur time: 2023-02-23T23:59:59.999 == next bar open time: 2023-02-24T00:00:00.000 == close pos time: 2023-03-01T00:00:00.000
2024-12-12 23:54:18,316 - INFO - pnl: 2023-02-23T23:59:59.999 83998.9865081352 === -3.014%
2024-12-12 23:54:18,318 - DEBUG - cur time: 2023-02-24T23:59:59.999 == next bar open time: 2023-02-25T00:00:00.000 == close pos time: 2023-03-02T00:00:00.000
2024-12-12 23:54:18,326 - DEBUG - close time 2023-02-24T23:59:59.999 == vol_threshold: 18361955.0
2024-12-12 23:54:18,326 - DEBUG - 2023-02-24T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:18,329 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ PEOPLEUSDT   ┆ -4.248634    ┆ 0    ┆ 94           │
│ ATAUSDT      ┆ -3.889936    ┆ 1    ┆ 93           │
│ ARPAUSDT     ┆ -3.623642    ┆ 2    ┆ 92           │
│ BLZUSDT      ┆ -3.395929    ┆ 3    ┆ 91           │
│ DARUSDT      ┆ -2.937832    ┆ 4    ┆ 90           │
│ 1000SHIBUSDT ┆ -2.935663    ┆ 5    ┆ 89           │
│ SPELLUSDT    ┆ -2.806566    ┆ 6    ┆ 88           │
│ COTIUSDT     ┆ -2.640784    ┆ 7    ┆ 87           │
│ RVNUSDT      ┆ -2.574236    ┆ 8    ┆ 86           │
│ STGUSDT      ┆ -2.509158    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ CTSIUSDT     ┆ 3.16254      ┆ 85   ┆ 9            │
│ CELOUSDT     ┆ 3.207615     ┆ 86   ┆ 8            │
│ TOMOUSDT     ┆ 3.413106     ┆ 87   ┆ 7            │
│ ICXUSDT      ┆ 3.596673     ┆ 88   ┆ 6            │
│ DGBUSDT      ┆ 3.711293     ┆ 89   ┆ 5            │
│ OPUSDT       ┆ 4.157423     ┆ 90   ┆ 4            │
│ STMXUSDT     ┆ 4.180953     ┆ 91   ┆ 3            │
│ LINAUSDT     ┆ 4.194035     ┆ 92   ┆ 2            │
│ XEMUSDT      ┆ 5.589389     ┆ 93   ┆ 1            │
│ FLOWUSDT     ┆ 5.772673     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,334 - WARNING - 2023-02-24T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,334 - INFO - cur close time: 2023-02-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:18,334 - DEBUG - mean expected ret (mean factor): 0.3139180629580564
2024-12-12 23:54:18,339 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,339 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,339 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1644      ┆ null        ┆ … ┆ 0.0335  ┆ null   ┆ null    ┆ 0.2675  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,342 - DEBUG - update position: 2023-02-24T23:59:59.999 === diff_trading_value: 308386.1304609951 == cash: 82265.02299671544 
2024-12-12 23:54:18,347 - INFO - pnl: 2023-02-24T23:59:59.999 82265.02299671544 === -2.064%
2024-12-12 23:54:18,350 - DEBUG - cur time: 2023-02-25T23:59:59.999 == next bar open time: 2023-02-26T00:00:00.000 == close pos time: 2023-03-03T00:00:00.000
2024-12-12 23:54:18,351 - INFO - pnl: 2023-02-25T23:59:59.999 81904.31072988108 === -0.438%
2024-12-12 23:54:18,354 - DEBUG - cur time: 2023-02-26T23:59:59.999 == next bar open time: 2023-02-27T00:00:00.000 == close pos time: 2023-03-04T00:00:00.000
2024-12-12 23:54:18,355 - INFO - pnl: 2023-02-26T23:59:59.999 80706.57122096782 === -1.462%
2024-12-12 23:54:18,358 - DEBUG - cur time: 2023-02-27T23:59:59.999 == next bar open time: 2023-02-28T00:00:00.000 == close pos time: 2023-03-05T00:00:00.000
2024-12-12 23:54:18,359 - INFO - pnl: 2023-02-27T23:59:59.999 82294.01911336213 === 1.967%
2024-12-12 23:54:18,364 - DEBUG - cur time: 2023-02-28T23:59:59.999 == next bar open time: 2023-03-01T00:00:00.000 == close pos time: 2023-03-06T00:00:00.000
2024-12-12 23:54:18,366 - INFO - pnl: 2023-02-28T23:59:59.999 81376.02301121195 === -1.116%
2024-12-12 23:54:18,369 - DEBUG - cur time: 2023-03-01T23:59:59.999 == next bar open time: 2023-03-02T00:00:00.000 == close pos time: 2023-03-07T00:00:00.000
2024-12-12 23:54:18,376 - DEBUG - close time 2023-03-01T23:59:59.999 == vol_threshold: 13751479.05
2024-12-12 23:54:18,376 - DEBUG - 2023-03-01T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:18,380 - DEBUG - sorted_long_factors: shape: (95, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ REEFUSDT    ┆ -4.148741    ┆ 0    ┆ 94           │
│ BAKEUSDT    ┆ -3.703822    ┆ 1    ┆ 93           │
│ 1INCHUSDT   ┆ -3.336926    ┆ 2    ┆ 92           │
│ 1000XECUSDT ┆ -3.138563    ┆ 3    ┆ 91           │
│ ALPHAUSDT   ┆ -3.044205    ┆ 4    ┆ 90           │
│ IOTAUSDT    ┆ -2.809835    ┆ 5    ┆ 89           │
│ BLZUSDT     ┆ -2.420099    ┆ 6    ┆ 88           │
│ XRPUSDT     ┆ -2.242585    ┆ 7    ┆ 87           │
│ STORJUSDT   ┆ -2.194079    ┆ 8    ┆ 86           │
│ GTCUSDT     ┆ -2.159212    ┆ 9    ┆ 85           │
│ …           ┆ …            ┆ …    ┆ …            │
│ EOSUSDT     ┆ 2.864568     ┆ 85   ┆ 9            │
│ RSRUSDT     ┆ 2.879055     ┆ 86   ┆ 8            │
│ NEARUSDT    ┆ 2.972588     ┆ 87   ┆ 7            │
│ ADAUSDT     ┆ 3.246452     ┆ 88   ┆ 6            │
│ SNXUSDT     ┆ 3.412227     ┆ 89   ┆ 5            │
│ LINAUSDT    ┆ 3.793255     ┆ 90   ┆ 4            │
│ ONEUSDT     ┆ 3.857239     ┆ 91   ┆ 3            │
│ ALGOUSDT    ┆ 4.634865     ┆ 92   ┆ 2            │
│ RENUSDT     ┆ 4.649735     ┆ 93   ┆ 1            │
│ RUNEUSDT    ┆ 4.788368     ┆ 94   ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,384 - WARNING - 2023-03-01T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,384 - INFO - cur close time: 2023-03-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:18,384 - DEBUG - mean expected ret (mean factor): 0.25808690684904784
2024-12-12 23:54:18,390 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,390 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,390 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1655      ┆ null        ┆ … ┆ 0.03209 ┆ null   ┆ null    ┆ 0.3018  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,397 - DEBUG - update position: 2023-03-01T23:59:59.999 === diff_trading_value: 333480.55026670924 == cash: 82082.64924610227 
2024-12-12 23:54:18,397 - INFO - pnl: 2023-03-01T23:59:59.999 82082.64924610227 === 0.868%
2024-12-12 23:54:18,401 - DEBUG - cur time: 2023-03-02T23:59:59.999 == next bar open time: 2023-03-03T00:00:00.000 == close pos time: 2023-03-08T00:00:00.000
2024-12-12 23:54:18,401 - INFO - pnl: 2023-03-02T23:59:59.999 81611.8438465823 === -0.574%
2024-12-12 23:54:18,406 - DEBUG - cur time: 2023-03-03T23:59:59.999 == next bar open time: 2023-03-04T00:00:00.000 == close pos time: 2023-03-09T00:00:00.000
2024-12-12 23:54:18,407 - INFO - pnl: 2023-03-03T23:59:59.999 83882.317945384 === 2.782%
2024-12-12 23:54:18,410 - DEBUG - cur time: 2023-03-04T23:59:59.999 == next bar open time: 2023-03-05T00:00:00.000 == close pos time: 2023-03-10T00:00:00.000
2024-12-12 23:54:18,412 - INFO - pnl: 2023-03-04T23:59:59.999 83526.99530291473 === -0.424%
2024-12-12 23:54:18,415 - DEBUG - cur time: 2023-03-05T23:59:59.999 == next bar open time: 2023-03-06T00:00:00.000 == close pos time: 2023-03-11T00:00:00.000
2024-12-12 23:54:18,417 - INFO - pnl: 2023-03-05T23:59:59.999 84296.71157676935 === 0.922%
2024-12-12 23:54:18,420 - DEBUG - cur time: 2023-03-06T23:59:59.999 == next bar open time: 2023-03-07T00:00:00.000 == close pos time: 2023-03-12T00:00:00.000
2024-12-12 23:54:18,425 - DEBUG - close time 2023-03-06T23:59:59.999 == vol_threshold: 11895505.0
2024-12-12 23:54:18,430 - DEBUG - 2023-03-06T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:18,431 - DEBUG - sorted_long_factors: shape: (95, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BAKEUSDT  ┆ -3.762681    ┆ 0    ┆ 94           │
│ STORJUSDT ┆ -3.471343    ┆ 1    ┆ 93           │
│ FILUSDT   ┆ -3.132359    ┆ 2    ┆ 92           │
│ HOTUSDT   ┆ -3.13097     ┆ 3    ┆ 91           │
│ DGBUSDT   ┆ -2.785089    ┆ 4    ┆ 90           │
│ WAVESUSDT ┆ -2.732101    ┆ 5    ┆ 89           │
│ ICXUSDT   ┆ -2.424382    ┆ 6    ┆ 88           │
│ ANKRUSDT  ┆ -2.371876    ┆ 7    ┆ 87           │
│ BATUSDT   ┆ -2.138306    ┆ 8    ┆ 86           │
│ CHZUSDT   ┆ -1.925089    ┆ 9    ┆ 85           │
│ …         ┆ …            ┆ …    ┆ …            │
│ MASKUSDT  ┆ 3.05867      ┆ 85   ┆ 9            │
│ CRVUSDT   ┆ 3.11845      ┆ 86   ┆ 8            │
│ MANAUSDT  ┆ 3.15756      ┆ 87   ┆ 7            │
│ SNXUSDT   ┆ 3.261091     ┆ 88   ┆ 6            │
│ CELRUSDT  ┆ 3.427267     ┆ 89   ┆ 5            │
│ CELOUSDT  ┆ 3.569432     ┆ 90   ┆ 4            │
│ STMXUSDT  ┆ 4.13732      ┆ 91   ┆ 3            │
│ IOTAUSDT  ┆ 4.276352     ┆ 92   ┆ 2            │
│ RENUSDT   ┆ 4.317108     ┆ 93   ┆ 1            │
│ DENTUSDT  ┆ 6.651153     ┆ 94   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,437 - WARNING - 2023-03-06T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,437 - INFO - cur close time: 2023-03-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:18,437 - DEBUG - mean expected ret (mean factor): 0.19638236295373424
2024-12-12 23:54:18,440 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,440 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,440 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.146       ┆ null        ┆ … ┆ 0.02741 ┆ null   ┆ null    ┆ 0.2398  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,448 - DEBUG - update position: 2023-03-06T23:59:59.999 === diff_trading_value: 267109.67976150266 == cash: 84587.03088968409 
2024-12-12 23:54:18,449 - INFO - pnl: 2023-03-06T23:59:59.999 84587.03088968409 === 0.344%
2024-12-12 23:54:18,452 - DEBUG - cur time: 2023-03-07T23:59:59.999 == next bar open time: 2023-03-08T00:00:00.000 == close pos time: 2023-03-13T00:00:00.000
2024-12-12 23:54:18,453 - INFO - pnl: 2023-03-07T23:59:59.999 84943.02777025185 === 0.421%
2024-12-12 23:54:18,455 - DEBUG - cur time: 2023-03-08T23:59:59.999 == next bar open time: 2023-03-09T00:00:00.000 == close pos time: 2023-03-14T00:00:00.000
2024-12-12 23:54:18,455 - INFO - pnl: 2023-03-08T23:59:59.999 83532.80568234538 === -1.660%
2024-12-12 23:54:18,460 - DEBUG - cur time: 2023-03-09T23:59:59.999 == next bar open time: 2023-03-10T00:00:00.000 == close pos time: 2023-03-15T00:00:00.000
2024-12-12 23:54:18,460 - INFO - pnl: 2023-03-09T23:59:59.999 83552.72720772243 === 0.024%
2024-12-12 23:54:18,465 - DEBUG - cur time: 2023-03-10T23:59:59.999 == next bar open time: 2023-03-11T00:00:00.000 == close pos time: 2023-03-16T00:00:00.000
2024-12-12 23:54:18,466 - INFO - pnl: 2023-03-10T23:59:59.999 84603.33837212835 === 1.257%
2024-12-12 23:54:18,470 - DEBUG - cur time: 2023-03-11T23:59:59.999 == next bar open time: 2023-03-12T00:00:00.000 == close pos time: 2023-03-17T00:00:00.000
2024-12-12 23:54:18,479 - DEBUG - close time 2023-03-11T23:59:59.999 == vol_threshold: 22989516.25
2024-12-12 23:54:18,480 - DEBUG - 2023-03-11T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:18,480 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BAKEUSDT     ┆ -4.752662    ┆ 0    ┆ 94           │
│ ONTUSDT      ┆ -3.709736    ┆ 1    ┆ 93           │
│ CTSIUSDT     ┆ -3.392673    ┆ 2    ┆ 92           │
│ SPELLUSDT    ┆ -2.893496    ┆ 3    ┆ 91           │
│ BLZUSDT      ┆ -2.698192    ┆ 4    ┆ 90           │
│ CHRUSDT      ┆ -2.027635    ┆ 5    ┆ 89           │
│ CELOUSDT     ┆ -2.003382    ┆ 6    ┆ 88           │
│ 1000LUNCUSDT ┆ -1.987386    ┆ 7    ┆ 87           │
│ NKNUSDT      ┆ -1.912451    ┆ 8    ┆ 86           │
│ OGNUSDT      ┆ -1.893512    ┆ 9    ┆ 85           │
│ …            ┆ …            ┆ …    ┆ …            │
│ FLOWUSDT     ┆ 2.715566     ┆ 85   ┆ 9            │
│ RSRUSDT      ┆ 3.016638     ┆ 86   ┆ 8            │
│ TRXUSDT      ┆ 3.042376     ┆ 87   ┆ 7            │
│ LRCUSDT      ┆ 3.340202     ┆ 88   ┆ 6            │
│ BATUSDT      ┆ 4.064704     ┆ 89   ┆ 5            │
│ 1000XECUSDT  ┆ 4.174311     ┆ 90   ┆ 4            │
│ TOMOUSDT     ┆ 4.650622     ┆ 91   ┆ 3            │
│ DGBUSDT      ┆ 4.808732     ┆ 92   ┆ 2            │
│ INJUSDT      ┆ 5.592061     ┆ 93   ┆ 1            │
│ HOTUSDT      ┆ 5.976545     ┆ 94   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,488 - WARNING - 2023-03-11T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,488 - INFO - cur close time: 2023-03-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:18,488 - DEBUG - mean expected ret (mean factor): 0.25846526053260954
2024-12-12 23:54:18,492 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,492 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,492 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1207      ┆ null        ┆ … ┆ 0.02252 ┆ null   ┆ null    ┆ 0.1978  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,498 - DEBUG - update position: 2023-03-11T23:59:59.999 === diff_trading_value: 308142.25485358975 == cash: 84215.63347076188 
2024-12-12 23:54:18,499 - INFO - pnl: 2023-03-11T23:59:59.999 84215.63347076188 === -0.458%
2024-12-12 23:54:18,500 - DEBUG - cur time: 2023-03-12T23:59:59.999 == next bar open time: 2023-03-13T00:00:00.000 == close pos time: 2023-03-18T00:00:00.000
2024-12-12 23:54:18,500 - INFO - pnl: 2023-03-12T23:59:59.999 84979.24549341218 === 0.907%
2024-12-12 23:54:18,506 - DEBUG - cur time: 2023-03-13T23:59:59.999 == next bar open time: 2023-03-14T00:00:00.000 == close pos time: 2023-03-19T00:00:00.000
2024-12-12 23:54:18,507 - INFO - pnl: 2023-03-13T23:59:59.999 86376.99993430851 === 1.645%
2024-12-12 23:54:18,509 - DEBUG - cur time: 2023-03-14T23:59:59.999 == next bar open time: 2023-03-15T00:00:00.000 == close pos time: 2023-03-20T00:00:00.000
2024-12-12 23:54:18,510 - INFO - pnl: 2023-03-14T23:59:59.999 87602.34942060767 === 1.419%
2024-12-12 23:54:18,513 - DEBUG - cur time: 2023-03-15T23:59:59.999 == next bar open time: 2023-03-16T00:00:00.000 == close pos time: 2023-03-21T00:00:00.000
2024-12-12 23:54:18,514 - INFO - pnl: 2023-03-15T23:59:59.999 90362.09143449987 === 3.150%
2024-12-12 23:54:18,517 - DEBUG - cur time: 2023-03-16T23:59:59.999 == next bar open time: 2023-03-17T00:00:00.000 == close pos time: 2023-03-22T00:00:00.000
2024-12-12 23:54:18,525 - DEBUG - close time 2023-03-16T23:59:59.999 == vol_threshold: 25339813.27999999
2024-12-12 23:54:18,525 - DEBUG - 2023-03-16T23:59:59.999 == all trade symbol 135 == remain 94 after VOL filter
2024-12-12 23:54:18,525 - DEBUG - sorted_long_factors: shape: (94, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT      ┆ -3.907515    ┆ 0    ┆ 93           │
│ 1000SHIBUSDT ┆ -3.892056    ┆ 1    ┆ 92           │
│ XLMUSDT      ┆ -3.548957    ┆ 2    ┆ 91           │
│ 1000LUNCUSDT ┆ -3.258748    ┆ 3    ┆ 90           │
│ THETAUSDT    ┆ -3.078883    ┆ 4    ┆ 89           │
│ APTUSDT      ┆ -2.908269    ┆ 5    ┆ 88           │
│ ADAUSDT      ┆ -2.724432    ┆ 6    ┆ 87           │
│ FILUSDT      ┆ -2.584933    ┆ 7    ┆ 86           │
│ LDOUSDT      ┆ -2.430639    ┆ 8    ┆ 85           │
│ IOTXUSDT     ┆ -2.381798    ┆ 9    ┆ 84           │
│ …            ┆ …            ┆ …    ┆ …            │
│ OGNUSDT      ┆ 2.106619     ┆ 84   ┆ 9            │
│ PEOPLEUSDT   ┆ 2.174122     ┆ 85   ┆ 8            │
│ BELUSDT      ┆ 2.796811     ┆ 86   ┆ 7            │
│ 1INCHUSDT    ┆ 3.196497     ┆ 87   ┆ 6            │
│ ICXUSDT      ┆ 3.278018     ┆ 88   ┆ 5            │
│ IOSTUSDT     ┆ 3.48022      ┆ 89   ┆ 4            │
│ ARPAUSDT     ┆ 3.606084     ┆ 90   ┆ 3            │
│ SPELLUSDT    ┆ 3.723383     ┆ 91   ┆ 2            │
│ NKNUSDT      ┆ 3.810346     ┆ 92   ┆ 1            │
│ TOMOUSDT     ┆ 5.262023     ┆ 93   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,532 - WARNING - 2023-03-16T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,532 - INFO - cur close time: 2023-03-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:18,532 - DEBUG - mean expected ret (mean factor): -0.12384026373823881
2024-12-12 23:54:18,536 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,536 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,536 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1255      ┆ null        ┆ … ┆ 0.02733 ┆ null   ┆ null    ┆ 0.2218  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,542 - DEBUG - update position: 2023-03-16T23:59:59.999 === diff_trading_value: 359703.58345567086 == cash: 89281.51579499245 
2024-12-12 23:54:18,542 - INFO - pnl: 2023-03-16T23:59:59.999 89281.51579499245 === -1.196%
2024-12-12 23:54:18,546 - DEBUG - cur time: 2023-03-17T23:59:59.999 == next bar open time: 2023-03-18T00:00:00.000 == close pos time: 2023-03-23T00:00:00.000
2024-12-12 23:54:18,548 - INFO - pnl: 2023-03-17T23:59:59.999 91662.53760663554 === 2.667%
2024-12-12 23:54:18,551 - DEBUG - cur time: 2023-03-18T23:59:59.999 == next bar open time: 2023-03-19T00:00:00.000 == close pos time: 2023-03-24T00:00:00.000
2024-12-12 23:54:18,552 - INFO - pnl: 2023-03-18T23:59:59.999 92650.86525606987 === 1.078%
2024-12-12 23:54:18,555 - DEBUG - cur time: 2023-03-19T23:59:59.999 == next bar open time: 2023-03-20T00:00:00.000 == close pos time: 2023-03-25T00:00:00.000
2024-12-12 23:54:18,555 - INFO - pnl: 2023-03-19T23:59:59.999 94440.91513350178 === 1.932%
2024-12-12 23:54:18,560 - DEBUG - cur time: 2023-03-20T23:59:59.999 == next bar open time: 2023-03-21T00:00:00.000 == close pos time: 2023-03-26T00:00:00.000
2024-12-12 23:54:18,560 - INFO - pnl: 2023-03-20T23:59:59.999 96006.03801436964 === 1.657%
2024-12-12 23:54:18,565 - DEBUG - cur time: 2023-03-21T23:59:59.999 == next bar open time: 2023-03-22T00:00:00.000 == close pos time: 2023-03-27T00:00:00.000
2024-12-12 23:54:18,572 - DEBUG - close time 2023-03-21T23:59:59.999 == vol_threshold: 26358848.799999993
2024-12-12 23:54:18,572 - DEBUG - 2023-03-21T23:59:59.999 == all trade symbol 135 == remain 94 after VOL filter
2024-12-12 23:54:18,575 - DEBUG - sorted_long_factors: shape: (94, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CTSIUSDT     ┆ -5.45644     ┆ 0    ┆ 93           │
│ FLMUSDT      ┆ -4.313058    ┆ 1    ┆ 92           │
│ BAKEUSDT     ┆ -3.768496    ┆ 2    ┆ 91           │
│ C98USDT      ┆ -3.284581    ┆ 3    ┆ 90           │
│ BELUSDT      ┆ -3.152623    ┆ 4    ┆ 89           │
│ DUSKUSDT     ┆ -2.994091    ┆ 5    ┆ 88           │
│ ATAUSDT      ┆ -2.944634    ┆ 6    ┆ 87           │
│ APEUSDT      ┆ -2.829682    ┆ 7    ┆ 86           │
│ COTIUSDT     ┆ -2.317648    ┆ 8    ┆ 85           │
│ 1000LUNCUSDT ┆ -2.142713    ┆ 9    ┆ 84           │
│ …            ┆ …            ┆ …    ┆ …            │
│ ONEUSDT      ┆ 2.853811     ┆ 84   ┆ 9            │
│ GTCUSDT      ┆ 3.26809      ┆ 85   ┆ 8            │
│ TOMOUSDT     ┆ 3.268131     ┆ 86   ┆ 7            │
│ OMGUSDT      ┆ 3.349924     ┆ 87   ┆ 6            │
│ TRXUSDT      ┆ 3.371063     ┆ 88   ┆ 5            │
│ MATICUSDT    ┆ 3.428425     ┆ 89   ┆ 4            │
│ CRVUSDT      ┆ 3.915487     ┆ 90   ┆ 3            │
│ RLCUSDT      ┆ 4.089475     ┆ 91   ┆ 2            │
│ CELRUSDT     ┆ 4.323925     ┆ 92   ┆ 1            │
│ LINAUSDT     ┆ 5.129949     ┆ 93   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,584 - WARNING - 2023-03-21T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,584 - INFO - cur close time: 2023-03-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:18,584 - DEBUG - mean expected ret (mean factor): 0.10654876562499545
2024-12-12 23:54:18,588 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,588 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,588 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.129       ┆ null        ┆ … ┆ 0.02868 ┆ null   ┆ null    ┆ 0.2378  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,597 - DEBUG - update position: 2023-03-21T23:59:59.999 === diff_trading_value: 336117.085844498 == cash: 89874.02693185603 
2024-12-12 23:54:18,597 - INFO - pnl: 2023-03-21T23:59:59.999 89874.02693185603 === -6.387%
2024-12-12 23:54:18,605 - DEBUG - cur time: 2023-03-22T23:59:59.999 == next bar open time: 2023-03-23T00:00:00.000 == close pos time: 2023-03-28T00:00:00.000
2024-12-12 23:54:18,606 - INFO - pnl: 2023-03-22T23:59:59.999 90930.6131579567 === 1.176%
2024-12-12 23:54:18,611 - DEBUG - cur time: 2023-03-23T23:59:59.999 == next bar open time: 2023-03-24T00:00:00.000 == close pos time: 2023-03-29T00:00:00.000
2024-12-12 23:54:18,613 - INFO - pnl: 2023-03-23T23:59:59.999 91541.57289916227 === 0.672%
2024-12-12 23:54:18,619 - DEBUG - cur time: 2023-03-24T23:59:59.999 == next bar open time: 2023-03-25T00:00:00.000 == close pos time: 2023-03-30T00:00:00.000
2024-12-12 23:54:18,621 - INFO - pnl: 2023-03-24T23:59:59.999 91529.17220007756 === -0.014%
2024-12-12 23:54:18,622 - DEBUG - cur time: 2023-03-25T23:59:59.999 == next bar open time: 2023-03-26T00:00:00.000 == close pos time: 2023-03-31T00:00:00.000
2024-12-12 23:54:18,622 - INFO - pnl: 2023-03-25T23:59:59.999 91827.56037054615 === 0.326%
2024-12-12 23:54:18,626 - DEBUG - cur time: 2023-03-26T23:59:59.999 == next bar open time: 2023-03-27T00:00:00.000 == close pos time: 2023-04-01T00:00:00.000
2024-12-12 23:54:18,638 - DEBUG - close time 2023-03-26T23:59:59.999 == vol_threshold: 14045729.079999998
2024-12-12 23:54:18,639 - DEBUG - 2023-03-26T23:59:59.999 == all trade symbol 135 == remain 94 after VOL filter
2024-12-12 23:54:18,640 - DEBUG - sorted_long_factors: shape: (94, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ IOTAUSDT     ┆ -4.331311    ┆ 0    ┆ 93           │
│ APTUSDT      ┆ -2.953424    ┆ 1    ┆ 92           │
│ XRPUSDT      ┆ -2.866068    ┆ 2    ┆ 91           │
│ 1000SHIBUSDT ┆ -2.794984    ┆ 3    ┆ 90           │
│ 1000LUNCUSDT ┆ -2.656941    ┆ 4    ┆ 89           │
│ BLZUSDT      ┆ -2.654946    ┆ 5    ┆ 88           │
│ LUNA2USDT    ┆ -2.345759    ┆ 6    ┆ 87           │
│ FLMUSDT      ┆ -2.332512    ┆ 7    ┆ 86           │
│ DARUSDT      ┆ -2.300911    ┆ 8    ┆ 85           │
│ ATAUSDT      ┆ -2.235834    ┆ 9    ┆ 84           │
│ …            ┆ …            ┆ …    ┆ …            │
│ HOTUSDT      ┆ 2.565734     ┆ 84   ┆ 9            │
│ MATICUSDT    ┆ 2.590499     ┆ 85   ┆ 8            │
│ RSRUSDT      ┆ 2.938268     ┆ 86   ┆ 7            │
│ OMGUSDT      ┆ 3.188039     ┆ 87   ┆ 6            │
│ NKNUSDT      ┆ 3.514224     ┆ 88   ┆ 5            │
│ ZRXUSDT      ┆ 3.930096     ┆ 89   ┆ 4            │
│ ICXUSDT      ┆ 3.966525     ┆ 90   ┆ 3            │
│ MASKUSDT     ┆ 3.991426     ┆ 91   ┆ 2            │
│ GTCUSDT      ┆ 5.524879     ┆ 92   ┆ 1            │
│ IOSTUSDT     ┆ 12.766391    ┆ 93   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,647 - WARNING - 2023-03-26T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,647 - INFO - cur close time: 2023-03-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:18,647 - DEBUG - mean expected ret (mean factor): 0.20108482726579682
2024-12-12 23:54:18,651 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,651 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,651 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1246      ┆ null        ┆ … ┆ 0.02734 ┆ null   ┆ null    ┆ 0.2289  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,659 - DEBUG - update position: 2023-03-26T23:59:59.999 === diff_trading_value: 257315.79664586266 == cash: 92315.93645819396 
2024-12-12 23:54:18,659 - INFO - pnl: 2023-03-26T23:59:59.999 92315.93645819396 === 0.532%
2024-12-12 23:54:18,665 - DEBUG - cur time: 2023-03-27T23:59:59.999 == next bar open time: 2023-03-28T00:00:00.000 == close pos time: 2023-04-02T00:00:00.000
2024-12-12 23:54:18,666 - INFO - pnl: 2023-03-27T23:59:59.999 89289.71232836443 === -3.278%
2024-12-12 23:54:18,671 - DEBUG - cur time: 2023-03-28T23:59:59.999 == next bar open time: 2023-03-29T00:00:00.000 == close pos time: 2023-04-03T00:00:00.000
2024-12-12 23:54:18,672 - INFO - pnl: 2023-03-28T23:59:59.999 89586.24172496836 === 0.332%
2024-12-12 23:54:18,672 - DEBUG - cur time: 2023-03-29T23:59:59.999 == next bar open time: 2023-03-30T00:00:00.000 == close pos time: 2023-04-04T00:00:00.000
2024-12-12 23:54:18,676 - INFO - pnl: 2023-03-29T23:59:59.999 89628.40716733647 === 0.047%
2024-12-12 23:54:18,680 - DEBUG - cur time: 2023-03-30T23:59:59.999 == next bar open time: 2023-03-31T00:00:00.000 == close pos time: 2023-04-05T00:00:00.000
2024-12-12 23:54:18,680 - INFO - pnl: 2023-03-30T23:59:59.999 89137.42742282667 === -0.548%
2024-12-12 23:54:18,687 - DEBUG - cur time: 2023-03-31T23:59:59.999 == next bar open time: 2023-04-01T00:00:00.000 == close pos time: 2023-04-06T00:00:00.000
2024-12-12 23:54:18,699 - DEBUG - close time 2023-03-31T23:59:59.999 == vol_threshold: 18605504.9
2024-12-12 23:54:18,699 - DEBUG - 2023-03-31T23:59:59.999 == all trade symbol 136 == remain 95 after VOL filter
2024-12-12 23:54:18,700 - DEBUG - sorted_long_factors: shape: (95, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ KLAYUSDT ┆ -5.549309    ┆ 0    ┆ 94           │
│ FILUSDT  ┆ -2.700985    ┆ 1    ┆ 93           │
│ APTUSDT  ┆ -2.512833    ┆ 2    ┆ 92           │
│ XRPUSDT  ┆ -2.375191    ┆ 3    ┆ 91           │
│ FETUSDT  ┆ -2.322193    ┆ 4    ┆ 90           │
│ DARUSDT  ┆ -2.288057    ┆ 5    ┆ 89           │
│ REEFUSDT ┆ -2.238745    ┆ 6    ┆ 88           │
│ ATAUSDT  ┆ -2.051393    ┆ 7    ┆ 87           │
│ LRCUSDT  ┆ -1.938206    ┆ 8    ┆ 86           │
│ NKNUSDT  ┆ -1.878959    ┆ 9    ┆ 85           │
│ …        ┆ …            ┆ …    ┆ …            │
│ ONEUSDT  ┆ 1.716983     ┆ 85   ┆ 9            │
│ ENJUSDT  ┆ 1.743612     ┆ 86   ┆ 8            │
│ IOSTUSDT ┆ 1.773159     ┆ 87   ┆ 7            │
│ CRVUSDT  ┆ 1.88394      ┆ 88   ┆ 6            │
│ ZILUSDT  ┆ 1.960667     ┆ 89   ┆ 5            │
│ ZRXUSDT  ┆ 2.14494      ┆ 90   ┆ 4            │
│ IOTAUSDT ┆ 2.445258     ┆ 91   ┆ 3            │
│ STMXUSDT ┆ 2.625678     ┆ 92   ┆ 2            │
│ RSRUSDT  ┆ 3.611253     ┆ 93   ┆ 1            │
│ SXPUSDT  ┆ 3.6478       ┆ 94   ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,707 - WARNING - 2023-03-31T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,707 - INFO - cur close time: 2023-03-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:18,707 - DEBUG - mean expected ret (mean factor): 0.0017406781963221353
2024-12-12 23:54:18,710 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,710 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,712 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1247      ┆ null        ┆ … ┆ 0.02914 ┆ null   ┆ null    ┆ 0.2953  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,717 - DEBUG - update position: 2023-03-31T23:59:59.999 === diff_trading_value: 257447.5331414505 == cash: 90722.34167407194 
2024-12-12 23:54:18,718 - INFO - pnl: 2023-03-31T23:59:59.999 90722.34167407194 === 1.778%
2024-12-12 23:54:18,722 - DEBUG - cur time: 2023-04-01T23:59:59.999 == next bar open time: 2023-04-02T00:00:00.000 == close pos time: 2023-04-07T00:00:00.000
2024-12-12 23:54:18,723 - INFO - pnl: 2023-04-01T23:59:59.999 95114.95627969707 === 4.842%
2024-12-12 23:54:18,724 - DEBUG - cur time: 2023-04-02T23:59:59.999 == next bar open time: 2023-04-03T00:00:00.000 == close pos time: 2023-04-08T00:00:00.000
2024-12-12 23:54:18,728 - INFO - pnl: 2023-04-02T23:59:59.999 92555.51743297845 === -2.691%
2024-12-12 23:54:18,732 - DEBUG - cur time: 2023-04-03T23:59:59.999 == next bar open time: 2023-04-04T00:00:00.000 == close pos time: 2023-04-09T00:00:00.000
2024-12-12 23:54:18,734 - INFO - pnl: 2023-04-03T23:59:59.999 98985.78989872111 === 6.947%
2024-12-12 23:54:18,737 - DEBUG - cur time: 2023-04-04T23:59:59.999 == next bar open time: 2023-04-05T00:00:00.000 == close pos time: 2023-04-10T00:00:00.000
2024-12-12 23:54:18,739 - INFO - pnl: 2023-04-04T23:59:59.999 100676.5620102186 === 1.708%
2024-12-12 23:54:18,743 - DEBUG - cur time: 2023-04-05T23:59:59.999 == next bar open time: 2023-04-06T00:00:00.000 == close pos time: 2023-04-11T00:00:00.000
2024-12-12 23:54:18,750 - DEBUG - close time 2023-04-05T23:59:59.999 == vol_threshold: 17442462.64
2024-12-12 23:54:18,750 - DEBUG - 2023-04-05T23:59:59.999 == all trade symbol 138 == remain 96 after VOL filter
2024-12-12 23:54:18,754 - DEBUG - sorted_long_factors: shape: (96, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000SHIBUSDT ┆ -3.552002    ┆ 0    ┆ 95           │
│ FETUSDT      ┆ -3.221872    ┆ 1    ┆ 94           │
│ KAVAUSDT     ┆ -2.416161    ┆ 2    ┆ 93           │
│ HOOKUSDT     ┆ -2.358117    ┆ 3    ┆ 92           │
│ REEFUSDT     ┆ -2.252849    ┆ 4    ┆ 91           │
│ DUSKUSDT     ┆ -2.197606    ┆ 5    ┆ 90           │
│ THETAUSDT    ┆ -2.091218    ┆ 6    ┆ 89           │
│ RENUSDT      ┆ -2.061683    ┆ 7    ┆ 88           │
│ BLZUSDT      ┆ -1.954539    ┆ 8    ┆ 87           │
│ APTUSDT      ┆ -1.865003    ┆ 9    ┆ 86           │
│ …            ┆ …            ┆ …    ┆ …            │
│ GMTUSDT      ┆ 2.994546     ┆ 86   ┆ 9            │
│ ICXUSDT      ┆ 3.167261     ┆ 87   ┆ 8            │
│ ARPAUSDT     ┆ 3.182313     ┆ 88   ┆ 7            │
│ XEMUSDT      ┆ 3.428403     ┆ 89   ┆ 6            │
│ TOMOUSDT     ┆ 4.030175     ┆ 90   ┆ 5            │
│ STMXUSDT     ┆ 4.446562     ┆ 91   ┆ 4            │
│ IOSTUSDT     ┆ 4.477898     ┆ 92   ┆ 3            │
│ LINAUSDT     ┆ 4.969037     ┆ 93   ┆ 2            │
│ KLAYUSDT     ┆ 5.053429     ┆ 94   ┆ 1            │
│ KNCUSDT      ┆ 5.416477     ┆ 95   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,759 - WARNING - 2023-04-05T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,759 - INFO - cur close time: 2023-04-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:18,759 - DEBUG - mean expected ret (mean factor): 0.5573014415416503
2024-12-12 23:54:18,763 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,764 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,764 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1232      ┆ null        ┆ … ┆ 0.03032 ┆ null   ┆ null    ┆ 0.3213  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,768 - DEBUG - update position: 2023-04-05T23:59:59.999 === diff_trading_value: 282157.41891582886 == cash: 97171.85905566347 
2024-12-12 23:54:18,771 - INFO - pnl: 2023-04-05T23:59:59.999 97171.85905566347 === -3.481%
2024-12-12 23:54:18,773 - DEBUG - cur time: 2023-04-06T23:59:59.999 == next bar open time: 2023-04-07T00:00:00.000 == close pos time: 2023-04-12T00:00:00.000
2024-12-12 23:54:18,774 - INFO - pnl: 2023-04-06T23:59:59.999 96603.12016703816 === -0.585%
2024-12-12 23:54:18,778 - DEBUG - cur time: 2023-04-07T23:59:59.999 == next bar open time: 2023-04-08T00:00:00.000 == close pos time: 2023-04-13T00:00:00.000
2024-12-12 23:54:18,780 - INFO - pnl: 2023-04-07T23:59:59.999 97139.0230778869 === 0.555%
2024-12-12 23:54:18,782 - DEBUG - cur time: 2023-04-08T23:59:59.999 == next bar open time: 2023-04-09T00:00:00.000 == close pos time: 2023-04-14T00:00:00.000
2024-12-12 23:54:18,782 - INFO - pnl: 2023-04-08T23:59:59.999 96431.5170299397 === -0.728%
2024-12-12 23:54:18,788 - DEBUG - cur time: 2023-04-09T23:59:59.999 == next bar open time: 2023-04-10T00:00:00.000 == close pos time: 2023-04-15T00:00:00.000
2024-12-12 23:54:18,789 - INFO - pnl: 2023-04-09T23:59:59.999 94788.79604980134 === -1.704%
2024-12-12 23:54:18,792 - DEBUG - cur time: 2023-04-10T23:59:59.999 == next bar open time: 2023-04-11T00:00:00.000 == close pos time: 2023-04-16T00:00:00.000
2024-12-12 23:54:18,800 - DEBUG - close time 2023-04-10T23:59:59.999 == vol_threshold: 17144179.819999997
2024-12-12 23:54:18,800 - DEBUG - 2023-04-10T23:59:59.999 == all trade symbol 139 == remain 97 after VOL filter
2024-12-12 23:54:18,803 - DEBUG - sorted_long_factors: shape: (97, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ RVNUSDT     ┆ -3.746209    ┆ 0    ┆ 96           │
│ PEOPLEUSDT  ┆ -3.671827    ┆ 1    ┆ 95           │
│ LUNA2USDT   ┆ -3.312549    ┆ 2    ┆ 94           │
│ FLMUSDT     ┆ -3.12192     ┆ 3    ┆ 93           │
│ XLMUSDT     ┆ -3.039936    ┆ 4    ┆ 92           │
│ 1000XECUSDT ┆ -2.929914    ┆ 5    ┆ 91           │
│ DOGEUSDT    ┆ -2.798601    ┆ 6    ┆ 90           │
│ CHZUSDT     ┆ -2.714876    ┆ 7    ┆ 89           │
│ CELOUSDT    ┆ -2.655119    ┆ 8    ┆ 88           │
│ ATAUSDT     ┆ -2.255081    ┆ 9    ┆ 87           │
│ …           ┆ …            ┆ …    ┆ …            │
│ TRXUSDT     ┆ 2.462296     ┆ 87   ┆ 9            │
│ JASMYUSDT   ┆ 2.66107      ┆ 88   ┆ 8            │
│ IOTAUSDT    ┆ 2.726779     ┆ 89   ┆ 7            │
│ ONEUSDT     ┆ 2.753839     ┆ 90   ┆ 6            │
│ APEUSDT     ┆ 3.444287     ┆ 91   ┆ 5            │
│ GALAUSDT    ┆ 3.618137     ┆ 92   ┆ 4            │
│ BATUSDT     ┆ 3.734645     ┆ 93   ┆ 3            │
│ STMXUSDT    ┆ 3.854928     ┆ 94   ┆ 2            │
│ INJUSDT     ┆ 3.97303      ┆ 95   ┆ 1            │
│ GRTUSDT     ┆ 5.192069     ┆ 96   ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,810 - INFO - cur close time: 2023-04-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:18,810 - DEBUG - mean expected ret (mean factor): 0.09433825555756481
2024-12-12 23:54:18,813 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,814 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,814 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1251      ┆ null        ┆ … ┆ 0.0297  ┆ null   ┆ null    ┆ 0.2885  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,820 - DEBUG - update position: 2023-04-10T23:59:59.999 === diff_trading_value: 349532.7296916344 == cash: 93137.98525608193 
2024-12-12 23:54:18,821 - INFO - pnl: 2023-04-10T23:59:59.999 93137.98525608193 === -1.742%
2024-12-12 23:54:18,824 - DEBUG - cur time: 2023-04-11T23:59:59.999 == next bar open time: 2023-04-12T00:00:00.000 == close pos time: 2023-04-17T00:00:00.000
2024-12-12 23:54:18,824 - INFO - pnl: 2023-04-11T23:59:59.999 92357.28590365381 === -0.838%
2024-12-12 23:54:18,824 - DEBUG - cur time: 2023-04-12T23:59:59.999 == next bar open time: 2023-04-13T00:00:00.000 == close pos time: 2023-04-18T00:00:00.000
2024-12-12 23:54:18,828 - INFO - pnl: 2023-04-12T23:59:59.999 93532.00783435305 === 1.272%
2024-12-12 23:54:18,831 - DEBUG - cur time: 2023-04-13T23:59:59.999 == next bar open time: 2023-04-14T00:00:00.000 == close pos time: 2023-04-19T00:00:00.000
2024-12-12 23:54:18,832 - INFO - pnl: 2023-04-13T23:59:59.999 93324.44462042156 === -0.222%
2024-12-12 23:54:18,835 - DEBUG - cur time: 2023-04-14T23:59:59.999 == next bar open time: 2023-04-15T00:00:00.000 == close pos time: 2023-04-20T00:00:00.000
2024-12-12 23:54:18,837 - INFO - pnl: 2023-04-14T23:59:59.999 95874.42468195785 === 2.732%
2024-12-12 23:54:18,838 - DEBUG - cur time: 2023-04-15T23:59:59.999 == next bar open time: 2023-04-16T00:00:00.000 == close pos time: 2023-04-21T00:00:00.000
2024-12-12 23:54:18,847 - DEBUG - close time 2023-04-15T23:59:59.999 == vol_threshold: 13663273.5
2024-12-12 23:54:18,848 - DEBUG - 2023-04-15T23:59:59.999 == all trade symbol 141 == remain 98 after VOL filter
2024-12-12 23:54:18,849 - DEBUG - sorted_long_factors: shape: (98, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ STGUSDT   ┆ -4.221361    ┆ 0    ┆ 97           │
│ IOTXUSDT  ┆ -3.757656    ┆ 1    ┆ 96           │
│ APTUSDT   ┆ -3.064197    ┆ 2    ┆ 95           │
│ MAGICUSDT ┆ -2.851296    ┆ 3    ┆ 94           │
│ CHZUSDT   ┆ -2.836425    ┆ 4    ┆ 93           │
│ SFPUSDT   ┆ -2.703858    ┆ 5    ┆ 92           │
│ RVNUSDT   ┆ -2.676847    ┆ 6    ┆ 91           │
│ DARUSDT   ┆ -2.391724    ┆ 7    ┆ 90           │
│ HOOKUSDT  ┆ -2.373007    ┆ 8    ┆ 89           │
│ MASKUSDT  ┆ -2.276485    ┆ 9    ┆ 88           │
│ …         ┆ …            ┆ …    ┆ …            │
│ CRVUSDT   ┆ 2.80326      ┆ 88   ┆ 9            │
│ FLOWUSDT  ┆ 2.83553      ┆ 89   ┆ 8            │
│ ALGOUSDT  ┆ 2.941268     ┆ 90   ┆ 7            │
│ OGNUSDT   ┆ 3.24857      ┆ 91   ┆ 6            │
│ CTSIUSDT  ┆ 3.55757      ┆ 92   ┆ 5            │
│ VETUSDT   ┆ 3.63777      ┆ 93   ┆ 4            │
│ ATAUSDT   ┆ 3.701231     ┆ 94   ┆ 3            │
│ WOOUSDT   ┆ 3.893962     ┆ 95   ┆ 2            │
│ STMXUSDT  ┆ 3.934378     ┆ 96   ┆ 1            │
│ TOMOUSDT  ┆ 5.536419     ┆ 97   ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,855 - WARNING - 2023-04-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,855 - INFO - cur close time: 2023-04-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:18,855 - DEBUG - mean expected ret (mean factor): 0.14411463571632344
2024-12-12 23:54:18,857 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,859 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,859 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1276      ┆ null        ┆ … ┆ 0.03087 ┆ null   ┆ null    ┆ 0.2952  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,865 - DEBUG - update position: 2023-04-15T23:59:59.999 === diff_trading_value: 308444.0413510683 == cash: 96304.958910372 
2024-12-12 23:54:18,866 - INFO - pnl: 2023-04-15T23:59:59.999 96304.958910372 === 0.449%
2024-12-12 23:54:18,868 - DEBUG - cur time: 2023-04-16T23:59:59.999 == next bar open time: 2023-04-17T00:00:00.000 == close pos time: 2023-04-22T00:00:00.000
2024-12-12 23:54:18,871 - INFO - pnl: 2023-04-16T23:59:59.999 96803.03739791691 === 0.517%
2024-12-12 23:54:18,872 - DEBUG - cur time: 2023-04-17T23:59:59.999 == next bar open time: 2023-04-18T00:00:00.000 == close pos time: 2023-04-23T00:00:00.000
2024-12-12 23:54:18,872 - INFO - pnl: 2023-04-17T23:59:59.999 95928.27240645184 === -0.904%
2024-12-12 23:54:18,876 - DEBUG - cur time: 2023-04-18T23:59:59.999 == next bar open time: 2023-04-19T00:00:00.000 == close pos time: 2023-04-24T00:00:00.000
2024-12-12 23:54:18,876 - INFO - pnl: 2023-04-18T23:59:59.999 99227.90642405498 === 3.440%
2024-12-12 23:54:18,880 - DEBUG - cur time: 2023-04-19T23:59:59.999 == next bar open time: 2023-04-20T00:00:00.000 == close pos time: 2023-04-25T00:00:00.000
2024-12-12 23:54:18,880 - INFO - pnl: 2023-04-19T23:59:59.999 100412.371244534 === 1.194%
2024-12-12 23:54:18,884 - DEBUG - cur time: 2023-04-20T23:59:59.999 == next bar open time: 2023-04-21T00:00:00.000 == close pos time: 2023-04-26T00:00:00.000
2024-12-12 23:54:18,893 - DEBUG - close time 2023-04-20T23:59:59.999 == vol_threshold: 24402380.080000002
2024-12-12 23:54:18,894 - DEBUG - 2023-04-20T23:59:59.999 == all trade symbol 143 == remain 100 after VOL filter
2024-12-12 23:54:18,896 - DEBUG - sorted_long_factors: shape: (100, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MINAUSDT     ┆ -4.288815    ┆ 0    ┆ 99           │
│ 1000SHIBUSDT ┆ -3.479312    ┆ 1    ┆ 98           │
│ SKLUSDT      ┆ -2.777473    ┆ 2    ┆ 97           │
│ XRPUSDT      ┆ -2.634863    ┆ 3    ┆ 96           │
│ DENTUSDT     ┆ -2.579167    ┆ 4    ┆ 95           │
│ BLZUSDT      ┆ -2.551456    ┆ 5    ┆ 94           │
│ ATAUSDT      ┆ -2.378981    ┆ 6    ┆ 93           │
│ CHRUSDT      ┆ -2.30682     ┆ 7    ┆ 92           │
│ CHZUSDT      ┆ -2.282417    ┆ 8    ┆ 91           │
│ HOOKUSDT     ┆ -2.273618    ┆ 9    ┆ 90           │
│ …            ┆ …            ┆ …    ┆ …            │
│ INJUSDT      ┆ 2.21109      ┆ 90   ┆ 9            │
│ WOOUSDT      ┆ 2.212389     ┆ 91   ┆ 8            │
│ OMGUSDT      ┆ 2.285185     ┆ 92   ┆ 7            │
│ XEMUSDT      ┆ 2.612439     ┆ 93   ┆ 6            │
│ 1INCHUSDT    ┆ 2.729136     ┆ 94   ┆ 5            │
│ STORJUSDT    ┆ 3.066549     ┆ 95   ┆ 4            │
│ KNCUSDT      ┆ 3.526146     ┆ 96   ┆ 3            │
│ BATUSDT      ┆ 3.853801     ┆ 97   ┆ 2            │
│ ONTUSDT      ┆ 4.309106     ┆ 98   ┆ 1            │
│ IOTXUSDT     ┆ 4.395143     ┆ 99   ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,901 - WARNING - 2023-04-20T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,901 - INFO - cur close time: 2023-04-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:18,901 - DEBUG - mean expected ret (mean factor): -0.043708755419544464
2024-12-12 23:54:18,906 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,907 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,907 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1135      ┆ null        ┆ … ┆ 0.03016 ┆ null   ┆ null    ┆ 0.2656  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,914 - DEBUG - update position: 2023-04-20T23:59:59.999 === diff_trading_value: 289528.3866681049 == cash: 100620.92337004532 
2024-12-12 23:54:18,915 - INFO - pnl: 2023-04-20T23:59:59.999 100620.92337004532 === 0.208%
2024-12-12 23:54:18,917 - DEBUG - cur time: 2023-04-21T23:59:59.999 == next bar open time: 2023-04-22T00:00:00.000 == close pos time: 2023-04-27T00:00:00.000
2024-12-12 23:54:18,919 - INFO - pnl: 2023-04-21T23:59:59.999 99793.9379825487 === -0.822%
2024-12-12 23:54:18,922 - DEBUG - cur time: 2023-04-22T23:59:59.999 == next bar open time: 2023-04-23T00:00:00.000 == close pos time: 2023-04-28T00:00:00.000
2024-12-12 23:54:18,922 - INFO - pnl: 2023-04-22T23:59:59.999 99884.60975091356 === 0.091%
2024-12-12 23:54:18,925 - DEBUG - cur time: 2023-04-23T23:59:59.999 == next bar open time: 2023-04-24T00:00:00.000 == close pos time: 2023-04-29T00:00:00.000
2024-12-12 23:54:18,925 - INFO - pnl: 2023-04-23T23:59:59.999 98934.56275725814 === -0.951%
2024-12-12 23:54:18,933 - DEBUG - cur time: 2023-04-24T23:59:59.999 == next bar open time: 2023-04-25T00:00:00.000 == close pos time: 2023-04-30T00:00:00.000
2024-12-12 23:54:18,934 - INFO - pnl: 2023-04-24T23:59:59.999 98243.58405884226 === -0.698%
2024-12-12 23:54:18,937 - DEBUG - cur time: 2023-04-25T23:59:59.999 == next bar open time: 2023-04-26T00:00:00.000 == close pos time: 2023-05-01T00:00:00.000
2024-12-12 23:54:18,947 - DEBUG - close time 2023-04-25T23:59:59.999 == vol_threshold: 18527613.080000002
2024-12-12 23:54:18,948 - DEBUG - 2023-04-25T23:59:59.999 == all trade symbol 143 == remain 100 after VOL filter
2024-12-12 23:54:18,950 - DEBUG - sorted_long_factors: shape: (100, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ATAUSDT     ┆ -3.735323    ┆ 0    ┆ 99           │
│ MAGICUSDT   ┆ -3.388941    ┆ 1    ┆ 98           │
│ PEOPLEUSDT  ┆ -3.152106    ┆ 2    ┆ 97           │
│ BLZUSDT     ┆ -2.537231    ┆ 3    ┆ 96           │
│ KLAYUSDT    ┆ -2.485313    ┆ 4    ┆ 95           │
│ CHRUSDT     ┆ -2.484536    ┆ 5    ┆ 94           │
│ OCEANUSDT   ┆ -2.274196    ┆ 6    ┆ 93           │
│ GALAUSDT    ┆ -2.17354     ┆ 7    ┆ 92           │
│ HOOKUSDT    ┆ -2.083818    ┆ 8    ┆ 91           │
│ FLMUSDT     ┆ -1.944265    ┆ 9    ┆ 90           │
│ …           ┆ …            ┆ …    ┆ …            │
│ SFPUSDT     ┆ 2.241821     ┆ 90   ┆ 9            │
│ 1000XECUSDT ┆ 2.56438      ┆ 91   ┆ 8            │
│ 1INCHUSDT   ┆ 2.805748     ┆ 92   ┆ 7            │
│ ICXUSDT     ┆ 2.948154     ┆ 93   ┆ 6            │
│ INJUSDT     ┆ 3.363062     ┆ 94   ┆ 5            │
│ DGBUSDT     ┆ 3.416102     ┆ 95   ┆ 4            │
│ SPELLUSDT   ┆ 3.717276     ┆ 96   ┆ 3            │
│ STGUSDT     ┆ 4.324173     ┆ 97   ┆ 2            │
│ TOMOUSDT    ┆ 4.841831     ┆ 98   ┆ 1            │
│ DARUSDT     ┆ 8.136893     ┆ 99   ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:18,956 - WARNING - 2023-04-25T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:18,956 - INFO - cur close time: 2023-04-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:18,956 - DEBUG - mean expected ret (mean factor): 0.2719033734864408
2024-12-12 23:54:18,960 - DEBUG - begin to update pos: =========
2024-12-12 23:54:18,960 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,960 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1112      ┆ null        ┆ … ┆ 0.03018 ┆ null   ┆ null    ┆ 0.2628  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:18,967 - DEBUG - update position: 2023-04-25T23:59:59.999 === diff_trading_value: 267737.43829345726 == cash: 99163.84177296676 
2024-12-12 23:54:18,968 - INFO - pnl: 2023-04-25T23:59:59.999 99163.84177296676 === 0.937%
2024-12-12 23:54:18,971 - DEBUG - cur time: 2023-04-26T23:59:59.999 == next bar open time: 2023-04-27T00:00:00.000 == close pos time: 2023-05-02T00:00:00.000
2024-12-12 23:54:18,972 - INFO - pnl: 2023-04-26T23:59:59.999 100152.17879413143 === 0.997%
2024-12-12 23:54:18,974 - DEBUG - cur time: 2023-04-27T23:59:59.999 == next bar open time: 2023-04-28T00:00:00.000 == close pos time: 2023-05-03T00:00:00.000
2024-12-12 23:54:18,978 - INFO - pnl: 2023-04-27T23:59:59.999 100883.5623363585 === 0.730%
2024-12-12 23:54:18,980 - DEBUG - cur time: 2023-04-28T23:59:59.999 == next bar open time: 2023-04-29T00:00:00.000 == close pos time: 2023-05-04T00:00:00.000
2024-12-12 23:54:18,982 - INFO - pnl: 2023-04-28T23:59:59.999 100956.19741025276 === 0.072%
2024-12-12 23:54:18,982 - DEBUG - cur time: 2023-04-29T23:59:59.999 == next bar open time: 2023-04-30T00:00:00.000 == close pos time: 2023-05-05T00:00:00.000
2024-12-12 23:54:18,986 - INFO - pnl: 2023-04-29T23:59:59.999 100408.0721796532 === -0.543%
2024-12-12 23:54:18,990 - DEBUG - cur time: 2023-04-30T23:59:59.999 == next bar open time: 2023-05-01T00:00:00.000 == close pos time: 2023-05-06T00:00:00.000
2024-12-12 23:54:18,998 - DEBUG - close time 2023-04-30T23:59:59.999 == vol_threshold: 14934445.799999991
2024-12-12 23:54:18,998 - DEBUG - 2023-04-30T23:59:59.999 == all trade symbol 147 == remain 103 after VOL filter
2024-12-12 23:54:19,000 - DEBUG - sorted_long_factors: shape: (103, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ APEUSDT   ┆ -6.065181    ┆ 0    ┆ 102          │
│ DUSKUSDT  ┆ -4.738356    ┆ 1    ┆ 101          │
│ AGIXUSDT  ┆ -4.082561    ┆ 2    ┆ 100          │
│ IOTAUSDT  ┆ -3.624107    ┆ 3    ┆ 99           │
│ C98USDT   ┆ -3.160677    ┆ 4    ┆ 98           │
│ ROSEUSDT  ┆ -3.090379    ┆ 5    ┆ 97           │
│ HOTUSDT   ┆ -2.938633    ┆ 6    ┆ 96           │
│ FILUSDT   ┆ -2.856738    ┆ 7    ┆ 95           │
│ ONEUSDT   ┆ -2.807587    ┆ 8    ┆ 94           │
│ HOOKUSDT  ┆ -2.789987    ┆ 9    ┆ 93           │
│ …         ┆ …            ┆ …    ┆ …            │
│ ONTUSDT   ┆ 2.794835     ┆ 93   ┆ 9            │
│ JASMYUSDT ┆ 2.817937     ┆ 94   ┆ 8            │
│ RSRUSDT   ┆ 2.913969     ┆ 95   ┆ 7            │
│ HBARUSDT  ┆ 3.365029     ┆ 96   ┆ 6            │
│ XEMUSDT   ┆ 3.371132     ┆ 97   ┆ 5            │
│ KLAYUSDT  ┆ 3.531581     ┆ 98   ┆ 4            │
│ IOSTUSDT  ┆ 3.799724     ┆ 99   ┆ 3            │
│ RNDRUSDT  ┆ 4.375835     ┆ 100  ┆ 2            │
│ RLCUSDT   ┆ 4.686348     ┆ 101  ┆ 1            │
│ RVNUSDT   ┆ 8.408998     ┆ 102  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,007 - WARNING - 2023-04-30T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,007 - INFO - cur close time: 2023-04-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:19,007 - DEBUG - mean expected ret (mean factor): -0.027803985227198295
2024-12-12 23:54:19,011 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,011 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,012 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1095      ┆ null        ┆ … ┆ 0.028   ┆ null   ┆ null    ┆ 0.2559  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,017 - DEBUG - update position: 2023-04-30T23:59:59.999 === diff_trading_value: 336870.077297169 == cash: 99421.52613592896 
2024-12-12 23:54:19,017 - INFO - pnl: 2023-04-30T23:59:59.999 99421.52613592896 === -0.983%
2024-12-12 23:54:19,021 - DEBUG - cur time: 2023-05-01T23:59:59.999 == next bar open time: 2023-05-02T00:00:00.000 == close pos time: 2023-05-07T00:00:00.000
2024-12-12 23:54:19,022 - INFO - pnl: 2023-05-01T23:59:59.999 99043.15751969398 === -0.381%
2024-12-12 23:54:19,025 - DEBUG - cur time: 2023-05-02T23:59:59.999 == next bar open time: 2023-05-03T00:00:00.000 == close pos time: 2023-05-08T00:00:00.000
2024-12-12 23:54:19,025 - INFO - pnl: 2023-05-02T23:59:59.999 98504.88350049377 === -0.543%
2024-12-12 23:54:19,031 - DEBUG - cur time: 2023-05-03T23:59:59.999 == next bar open time: 2023-05-04T00:00:00.000 == close pos time: 2023-05-09T00:00:00.000
2024-12-12 23:54:19,032 - INFO - pnl: 2023-05-03T23:59:59.999 98074.6556027036 === -0.437%
2024-12-12 23:54:19,035 - DEBUG - cur time: 2023-05-04T23:59:59.999 == next bar open time: 2023-05-05T00:00:00.000 == close pos time: 2023-05-10T00:00:00.000
2024-12-12 23:54:19,036 - INFO - pnl: 2023-05-04T23:59:59.999 98709.50653533285 === 0.647%
2024-12-12 23:54:19,039 - DEBUG - cur time: 2023-05-05T23:59:59.999 == next bar open time: 2023-05-06T00:00:00.000 == close pos time: 2023-05-11T00:00:00.000
2024-12-12 23:54:19,047 - DEBUG - close time 2023-05-05T23:59:59.999 == vol_threshold: 16236839.0
2024-12-12 23:54:19,048 - DEBUG - 2023-05-05T23:59:59.999 == all trade symbol 151 == remain 105 after VOL filter
2024-12-12 23:54:19,050 - DEBUG - sorted_long_factors: shape: (105, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DARUSDT      ┆ -3.256031    ┆ 0    ┆ 104          │
│ CHRUSDT      ┆ -3.034518    ┆ 1    ┆ 103          │
│ ENJUSDT      ┆ -3.007436    ┆ 2    ┆ 102          │
│ C98USDT      ┆ -2.809347    ┆ 3    ┆ 101          │
│ FETUSDT      ┆ -2.803921    ┆ 4    ┆ 100          │
│ 1000SHIBUSDT ┆ -2.725877    ┆ 5    ┆ 99           │
│ 1000LUNCUSDT ┆ -2.647758    ┆ 6    ┆ 98           │
│ REEFUSDT     ┆ -2.532259    ┆ 7    ┆ 97           │
│ APTUSDT      ┆ -2.48065     ┆ 8    ┆ 96           │
│ BLZUSDT      ┆ -2.333773    ┆ 9    ┆ 95           │
│ …            ┆ …            ┆ …    ┆ …            │
│ ROSEUSDT     ┆ 3.811245     ┆ 95   ┆ 9            │
│ TUSDT        ┆ 3.819053     ┆ 96   ┆ 8            │
│ ADAUSDT      ┆ 3.879215     ┆ 97   ┆ 7            │
│ LRCUSDT      ┆ 3.934979     ┆ 98   ┆ 6            │
│ TRXUSDT      ┆ 3.994663     ┆ 99   ┆ 5            │
│ IOTXUSDT     ┆ 4.415876     ┆ 100  ┆ 4            │
│ CRVUSDT      ┆ 4.880356     ┆ 101  ┆ 3            │
│ ANKRUSDT     ┆ 5.122622     ┆ 102  ┆ 2            │
│ DOTUSDT      ┆ 5.234544     ┆ 103  ┆ 1            │
│ KLAYUSDT     ┆ 5.450476     ┆ 104  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,056 - WARNING - 2023-05-05T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,056 - INFO - cur close time: 2023-05-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:19,056 - DEBUG - mean expected ret (mean factor): 0.287969024631741
2024-12-12 23:54:19,060 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,060 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,060 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.103       ┆ null        ┆ … ┆ 0.02731 ┆ null   ┆ null    ┆ 0.2528  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,066 - DEBUG - update position: 2023-05-05T23:59:59.999 === diff_trading_value: 327782.7488339388 == cash: 99177.27788237599 
2024-12-12 23:54:19,068 - INFO - pnl: 2023-05-05T23:59:59.999 99177.27788237599 === 0.474%
2024-12-12 23:54:19,070 - DEBUG - cur time: 2023-05-06T23:59:59.999 == next bar open time: 2023-05-07T00:00:00.000 == close pos time: 2023-05-12T00:00:00.000
2024-12-12 23:54:19,071 - INFO - pnl: 2023-05-06T23:59:59.999 101224.11968254381 === 2.064%
2024-12-12 23:54:19,074 - DEBUG - cur time: 2023-05-07T23:59:59.999 == next bar open time: 2023-05-08T00:00:00.000 == close pos time: 2023-05-13T00:00:00.000
2024-12-12 23:54:19,074 - INFO - pnl: 2023-05-07T23:59:59.999 100861.4488781982 === -0.358%
2024-12-12 23:54:19,080 - DEBUG - cur time: 2023-05-08T23:59:59.999 == next bar open time: 2023-05-09T00:00:00.000 == close pos time: 2023-05-14T00:00:00.000
2024-12-12 23:54:19,080 - INFO - pnl: 2023-05-08T23:59:59.999 103621.60754967594 === 2.737%
2024-12-12 23:54:19,084 - DEBUG - cur time: 2023-05-09T23:59:59.999 == next bar open time: 2023-05-10T00:00:00.000 == close pos time: 2023-05-15T00:00:00.000
2024-12-12 23:54:19,084 - INFO - pnl: 2023-05-09T23:59:59.999 102999.46496146069 === -0.600%
2024-12-12 23:54:19,088 - DEBUG - cur time: 2023-05-10T23:59:59.999 == next bar open time: 2023-05-11T00:00:00.000 == close pos time: 2023-05-16T00:00:00.000
2024-12-12 23:54:19,097 - DEBUG - close time 2023-05-10T23:59:59.999 == vol_threshold: 27342556.54
2024-12-12 23:54:19,097 - DEBUG - 2023-05-10T23:59:59.999 == all trade symbol 153 == remain 107 after VOL filter
2024-12-12 23:54:19,097 - DEBUG - sorted_long_factors: shape: (107, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XLMUSDT      ┆ -4.201952    ┆ 0    ┆ 106          │
│ ALPHAUSDT    ┆ -3.681486    ┆ 1    ┆ 105          │
│ REEFUSDT     ┆ -3.487143    ┆ 2    ┆ 104          │
│ C98USDT      ┆ -3.126947    ┆ 3    ┆ 103          │
│ 1000XECUSDT  ┆ -3.052932    ┆ 4    ┆ 102          │
│ RVNUSDT      ┆ -2.982702    ┆ 5    ┆ 101          │
│ EOSUSDT      ┆ -2.352075    ┆ 6    ┆ 100          │
│ KLAYUSDT     ┆ -2.301059    ┆ 7    ┆ 99           │
│ NKNUSDT      ┆ -2.231437    ┆ 8    ┆ 98           │
│ 1000SHIBUSDT ┆ -2.103247    ┆ 9    ┆ 97           │
│ …            ┆ …            ┆ …    ┆ …            │
│ OGNUSDT      ┆ 2.219607     ┆ 97   ┆ 9            │
│ APEUSDT      ┆ 2.256874     ┆ 98   ┆ 8            │
│ ANKRUSDT     ┆ 3.350627     ┆ 99   ┆ 7            │
│ LDOUSDT      ┆ 4.270861     ┆ 100  ┆ 6            │
│ ASTRUSDT     ┆ 5.831169     ┆ 101  ┆ 5            │
│ VETUSDT      ┆ 5.846308     ┆ 102  ┆ 4            │
│ KAVAUSDT     ┆ 6.856332     ┆ 103  ┆ 3            │
│ ARPAUSDT     ┆ 7.154088     ┆ 104  ┆ 2            │
│ TOMOUSDT     ┆ 7.284342     ┆ 105  ┆ 1            │
│ RSRUSDT      ┆ 7.375551     ┆ 106  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,101 - WARNING - 2023-05-10T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,101 - INFO - cur close time: 2023-05-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:19,105 - DEBUG - mean expected ret (mean factor): -0.051199805062340994
2024-12-12 23:54:19,108 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,108 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,108 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.093       ┆ null        ┆ … ┆ 0.02447 ┆ null   ┆ null    ┆ 0.2264  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,113 - DEBUG - update position: 2023-05-10T23:59:59.999 === diff_trading_value: 289316.34864675015 == cash: 102477.32249511122 
2024-12-12 23:54:19,115 - INFO - pnl: 2023-05-10T23:59:59.999 102477.32249511122 === -0.507%
2024-12-12 23:54:19,117 - DEBUG - cur time: 2023-05-11T23:59:59.999 == next bar open time: 2023-05-12T00:00:00.000 == close pos time: 2023-05-17T00:00:00.000
2024-12-12 23:54:19,119 - INFO - pnl: 2023-05-11T23:59:59.999 101010.055958291 === -1.432%
2024-12-12 23:54:19,121 - DEBUG - cur time: 2023-05-12T23:59:59.999 == next bar open time: 2023-05-13T00:00:00.000 == close pos time: 2023-05-18T00:00:00.000
2024-12-12 23:54:19,124 - INFO - pnl: 2023-05-12T23:59:59.999 103399.21333904006 === 2.365%
2024-12-12 23:54:19,125 - DEBUG - cur time: 2023-05-13T23:59:59.999 == next bar open time: 2023-05-14T00:00:00.000 == close pos time: 2023-05-19T00:00:00.000
2024-12-12 23:54:19,129 - INFO - pnl: 2023-05-13T23:59:59.999 103018.89943665198 === -0.368%
2024-12-12 23:54:19,132 - DEBUG - cur time: 2023-05-14T23:59:59.999 == next bar open time: 2023-05-15T00:00:00.000 == close pos time: 2023-05-20T00:00:00.000
2024-12-12 23:54:19,133 - INFO - pnl: 2023-05-14T23:59:59.999 103966.01668653416 === 0.919%
2024-12-12 23:54:19,136 - DEBUG - cur time: 2023-05-15T23:59:59.999 == next bar open time: 2023-05-16T00:00:00.000 == close pos time: 2023-05-21T00:00:00.000
2024-12-12 23:54:19,142 - DEBUG - close time 2023-05-15T23:59:59.999 == vol_threshold: 15729338.180000002
2024-12-12 23:54:19,142 - DEBUG - 2023-05-15T23:59:59.999 == all trade symbol 153 == remain 107 after VOL filter
2024-12-12 23:54:19,146 - DEBUG - sorted_long_factors: shape: (107, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BNXUSDT   ┆ -2.975661    ┆ 0    ┆ 106          │
│ 1INCHUSDT ┆ -2.622616    ┆ 1    ┆ 105          │
│ KLAYUSDT  ┆ -2.368796    ┆ 2    ┆ 104          │
│ REEFUSDT  ┆ -2.228982    ┆ 3    ┆ 103          │
│ HBARUSDT  ┆ -1.892482    ┆ 4    ┆ 102          │
│ XRPUSDT   ┆ -1.856815    ┆ 5    ┆ 101          │
│ IOTXUSDT  ┆ -1.710521    ┆ 6    ┆ 100          │
│ ASTRUSDT  ┆ -1.623578    ┆ 7    ┆ 99           │
│ BAKEUSDT  ┆ -1.597274    ┆ 8    ┆ 98           │
│ MTLUSDT   ┆ -1.491595    ┆ 9    ┆ 97           │
│ …         ┆ …            ┆ …    ┆ …            │
│ TOMOUSDT  ┆ 1.643005     ┆ 97   ┆ 9            │
│ GMTUSDT   ┆ 1.665227     ┆ 98   ┆ 8            │
│ TRXUSDT   ┆ 1.716794     ┆ 99   ┆ 7            │
│ GRTUSDT   ┆ 1.93216      ┆ 100  ┆ 6            │
│ CRVUSDT   ┆ 2.095016     ┆ 101  ┆ 5            │
│ ONTUSDT   ┆ 2.217029     ┆ 102  ┆ 4            │
│ RSRUSDT   ┆ 2.22805      ┆ 103  ┆ 3            │
│ LDOUSDT   ┆ 2.768275     ┆ 104  ┆ 2            │
│ KAVAUSDT  ┆ 3.137615     ┆ 105  ┆ 1            │
│ ARPAUSDT  ┆ 3.428377     ┆ 106  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,152 - WARNING - 2023-05-15T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,152 - INFO - cur close time: 2023-05-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:19,153 - DEBUG - mean expected ret (mean factor): -0.12472538257311419
2024-12-12 23:54:19,157 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,157 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,157 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0897      ┆ null        ┆ … ┆ 0.0241  ┆ null   ┆ null    ┆ 0.2223  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,163 - DEBUG - update position: 2023-05-15T23:59:59.999 === diff_trading_value: 293183.14993295446 == cash: 105044.0840837524 
2024-12-12 23:54:19,164 - INFO - pnl: 2023-05-15T23:59:59.999 105044.0840837524 === 1.037%
2024-12-12 23:54:19,167 - DEBUG - cur time: 2023-05-16T23:59:59.999 == next bar open time: 2023-05-17T00:00:00.000 == close pos time: 2023-05-22T00:00:00.000
2024-12-12 23:54:19,168 - INFO - pnl: 2023-05-16T23:59:59.999 103933.36138235895 === -1.057%
2024-12-12 23:54:19,172 - DEBUG - cur time: 2023-05-17T23:59:59.999 == next bar open time: 2023-05-18T00:00:00.000 == close pos time: 2023-05-23T00:00:00.000
2024-12-12 23:54:19,175 - INFO - pnl: 2023-05-17T23:59:59.999 104536.25393082626 === 0.580%
2024-12-12 23:54:19,180 - DEBUG - cur time: 2023-05-18T23:59:59.999 == next bar open time: 2023-05-19T00:00:00.000 == close pos time: 2023-05-24T00:00:00.000
2024-12-12 23:54:19,180 - INFO - pnl: 2023-05-18T23:59:59.999 104370.60070860511 === -0.158%
2024-12-12 23:54:19,188 - DEBUG - cur time: 2023-05-19T23:59:59.999 == next bar open time: 2023-05-20T00:00:00.000 == close pos time: 2023-05-25T00:00:00.000
2024-12-12 23:54:19,190 - INFO - pnl: 2023-05-19T23:59:59.999 104991.17002174788 === 0.595%
2024-12-12 23:54:19,194 - DEBUG - cur time: 2023-05-20T23:59:59.999 == next bar open time: 2023-05-21T00:00:00.000 == close pos time: 2023-05-26T00:00:00.000
2024-12-12 23:54:19,208 - DEBUG - close time 2023-05-20T23:59:59.999 == vol_threshold: 10247641.1
2024-12-12 23:54:19,208 - DEBUG - 2023-05-20T23:59:59.999 == all trade symbol 156 == remain 109 after VOL filter
2024-12-12 23:54:19,210 - DEBUG - sorted_long_factors: shape: (109, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DUSKUSDT     ┆ -6.260932    ┆ 0    ┆ 108          │
│ MTLUSDT      ┆ -5.54826     ┆ 1    ┆ 107          │
│ SPELLUSDT    ┆ -3.857603    ┆ 2    ┆ 106          │
│ FETUSDT      ┆ -3.560661    ┆ 3    ┆ 105          │
│ BLZUSDT      ┆ -3.338229    ┆ 4    ┆ 104          │
│ 1000SHIBUSDT ┆ -3.189131    ┆ 5    ┆ 103          │
│ GRTUSDT      ┆ -3.099125    ┆ 6    ┆ 102          │
│ HBARUSDT     ┆ -3.098914    ┆ 7    ┆ 101          │
│ 1000LUNCUSDT ┆ -3.031185    ┆ 8    ┆ 100          │
│ VETUSDT      ┆ -2.987416    ┆ 9    ┆ 99           │
│ …            ┆ …            ┆ …    ┆ …            │
│ DOTUSDT      ┆ 3.367594     ┆ 99   ┆ 9            │
│ STXUSDT      ┆ 3.478782     ┆ 100  ┆ 8            │
│ ZRXUSDT      ┆ 3.583836     ┆ 101  ┆ 7            │
│ ARPAUSDT     ┆ 3.643623     ┆ 102  ┆ 6            │
│ KLAYUSDT     ┆ 3.671198     ┆ 103  ┆ 5            │
│ RNDRUSDT     ┆ 4.461629     ┆ 104  ┆ 4            │
│ TUSDT        ┆ 4.742955     ┆ 105  ┆ 3            │
│ TOMOUSDT     ┆ 5.431433     ┆ 106  ┆ 2            │
│ KAVAUSDT     ┆ 6.406726     ┆ 107  ┆ 1            │
│ TRXUSDT      ┆ 7.242011     ┆ 108  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,217 - WARNING - 2023-05-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,217 - INFO - cur close time: 2023-05-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:19,217 - DEBUG - mean expected ret (mean factor): 0.2315837192893568
2024-12-12 23:54:19,223 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,223 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,224 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0903      ┆ null        ┆ … ┆ 0.02414 ┆ null   ┆ null    ┆ 0.2278  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,232 - DEBUG - update position: 2023-05-20T23:59:59.999 === diff_trading_value: 297570.6680337373 == cash: 105178.78190167947 
2024-12-12 23:54:19,234 - INFO - pnl: 2023-05-20T23:59:59.999 105178.78190167947 === 0.179%
2024-12-12 23:54:19,239 - DEBUG - cur time: 2023-05-21T23:59:59.999 == next bar open time: 2023-05-22T00:00:00.000 == close pos time: 2023-05-27T00:00:00.000
2024-12-12 23:54:19,240 - INFO - pnl: 2023-05-21T23:59:59.999 105965.50182392525 === 0.748%
2024-12-12 23:54:19,244 - DEBUG - cur time: 2023-05-22T23:59:59.999 == next bar open time: 2023-05-23T00:00:00.000 == close pos time: 2023-05-28T00:00:00.000
2024-12-12 23:54:19,246 - INFO - pnl: 2023-05-22T23:59:59.999 107191.3731094873 === 1.157%
2024-12-12 23:54:19,252 - DEBUG - cur time: 2023-05-23T23:59:59.999 == next bar open time: 2023-05-24T00:00:00.000 == close pos time: 2023-05-29T00:00:00.000
2024-12-12 23:54:19,254 - INFO - pnl: 2023-05-23T23:59:59.999 108891.06171729446 === 1.586%
2024-12-12 23:54:19,255 - DEBUG - cur time: 2023-05-24T23:59:59.999 == next bar open time: 2023-05-25T00:00:00.000 == close pos time: 2023-05-30T00:00:00.000
2024-12-12 23:54:19,259 - INFO - pnl: 2023-05-24T23:59:59.999 112996.26944485251 === 3.770%
2024-12-12 23:54:19,260 - DEBUG - cur time: 2023-05-25T23:59:59.999 == next bar open time: 2023-05-26T00:00:00.000 == close pos time: 2023-05-31T00:00:00.000
2024-12-12 23:54:19,272 - DEBUG - close time 2023-05-25T23:59:59.999 == vol_threshold: 16327882.959999997
2024-12-12 23:54:19,272 - DEBUG - 2023-05-25T23:59:59.999 == all trade symbol 157 == remain 110 after VOL filter
2024-12-12 23:54:19,272 - DEBUG - sorted_long_factors: shape: (110, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ APEUSDT   ┆ -3.487558    ┆ 0    ┆ 109          │
│ ADAUSDT   ┆ -3.466244    ┆ 1    ┆ 108          │
│ VETUSDT   ┆ -2.931655    ┆ 2    ┆ 107          │
│ ALGOUSDT  ┆ -2.569277    ┆ 3    ┆ 106          │
│ IOSTUSDT  ┆ -2.237714    ┆ 4    ┆ 105          │
│ DYDXUSDT  ┆ -2.070799    ┆ 5    ┆ 104          │
│ CHZUSDT   ┆ -2.06498     ┆ 6    ┆ 103          │
│ TRUUSDT   ┆ -1.816466    ┆ 7    ┆ 102          │
│ IMXUSDT   ┆ -1.758116    ┆ 8    ┆ 101          │
│ BAKEUSDT  ┆ -1.6325      ┆ 9    ┆ 100          │
│ …         ┆ …            ┆ …    ┆ …            │
│ KAVAUSDT  ┆ 1.951545     ┆ 100  ┆ 9            │
│ DENTUSDT  ┆ 1.958781     ┆ 101  ┆ 8            │
│ XLMUSDT   ┆ 1.985911     ┆ 102  ┆ 7            │
│ IOTXUSDT  ┆ 2.002778     ┆ 103  ┆ 6            │
│ STORJUSDT ┆ 2.150011     ┆ 104  ┆ 5            │
│ SKLUSDT   ┆ 2.357509     ┆ 105  ┆ 4            │
│ ARPAUSDT  ┆ 2.743802     ┆ 106  ┆ 3            │
│ TOMOUSDT  ┆ 3.219954     ┆ 107  ┆ 2            │
│ WOOUSDT   ┆ 3.401916     ┆ 108  ┆ 1            │
│ ZRXUSDT   ┆ 3.555977     ┆ 109  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,280 - INFO - cur close time: 2023-05-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:19,280 - DEBUG - mean expected ret (mean factor): -0.010607326021919732
2024-12-12 23:54:19,284 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,284 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,284 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0847      ┆ null        ┆ … ┆ 0.02264 ┆ null   ┆ null    ┆ 0.2175  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,294 - DEBUG - update position: 2023-05-25T23:59:59.999 === diff_trading_value: 310496.2223302056 == cash: 112183.72681031225 
2024-12-12 23:54:19,295 - INFO - pnl: 2023-05-25T23:59:59.999 112183.72681031225 === -0.719%
2024-12-12 23:54:19,300 - DEBUG - cur time: 2023-05-26T23:59:59.999 == next bar open time: 2023-05-27T00:00:00.000 == close pos time: 2023-06-01T00:00:00.000
2024-12-12 23:54:19,300 - INFO - pnl: 2023-05-26T23:59:59.999 112519.93254229365 === 0.300%
2024-12-12 23:54:19,307 - DEBUG - cur time: 2023-05-27T23:59:59.999 == next bar open time: 2023-05-28T00:00:00.000 == close pos time: 2023-06-02T00:00:00.000
2024-12-12 23:54:19,308 - INFO - pnl: 2023-05-27T23:59:59.999 111359.3252614699 === -1.031%
2024-12-12 23:54:19,313 - DEBUG - cur time: 2023-05-28T23:59:59.999 == next bar open time: 2023-05-29T00:00:00.000 == close pos time: 2023-06-03T00:00:00.000
2024-12-12 23:54:19,313 - INFO - pnl: 2023-05-28T23:59:59.999 111870.05217386567 === 0.459%
2024-12-12 23:54:19,318 - DEBUG - cur time: 2023-05-29T23:59:59.999 == next bar open time: 2023-05-30T00:00:00.000 == close pos time: 2023-06-04T00:00:00.000
2024-12-12 23:54:19,319 - INFO - pnl: 2023-05-29T23:59:59.999 111047.38676938816 === -0.735%
2024-12-12 23:54:19,321 - DEBUG - cur time: 2023-05-30T23:59:59.999 == next bar open time: 2023-05-31T00:00:00.000 == close pos time: 2023-06-05T00:00:00.000
2024-12-12 23:54:19,344 - DEBUG - close time 2023-05-30T23:59:59.999 == vol_threshold: 13710600.18
2024-12-12 23:54:19,344 - DEBUG - 2023-05-30T23:59:59.999 == all trade symbol 157 == remain 110 after VOL filter
2024-12-12 23:54:19,348 - DEBUG - sorted_long_factors: shape: (110, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000XECUSDT  ┆ -8.013891    ┆ 0    ┆ 109          │
│ MTLUSDT      ┆ -5.007822    ┆ 1    ┆ 108          │
│ BAKEUSDT     ┆ -3.703271    ┆ 2    ┆ 107          │
│ CRVUSDT      ┆ -3.586746    ┆ 3    ┆ 106          │
│ RVNUSDT      ┆ -3.270843    ┆ 4    ┆ 105          │
│ RSRUSDT      ┆ -3.185952    ┆ 5    ┆ 104          │
│ STXUSDT      ┆ -2.939362    ┆ 6    ┆ 103          │
│ ALPHAUSDT    ┆ -2.779732    ┆ 7    ┆ 102          │
│ LRCUSDT      ┆ -2.711293    ┆ 8    ┆ 101          │
│ OPUSDT       ┆ -2.661461    ┆ 9    ┆ 100          │
│ …            ┆ …            ┆ …    ┆ …            │
│ C98USDT      ┆ 2.784614     ┆ 100  ┆ 9            │
│ ATAUSDT      ┆ 2.884718     ┆ 101  ┆ 8            │
│ TRXUSDT      ┆ 2.984944     ┆ 102  ┆ 7            │
│ SXPUSDT      ┆ 3.131521     ┆ 103  ┆ 6            │
│ DYDXUSDT     ┆ 3.532802     ┆ 104  ┆ 5            │
│ 1000SHIBUSDT ┆ 3.836828     ┆ 105  ┆ 4            │
│ ADAUSDT      ┆ 4.259354     ┆ 106  ┆ 3            │
│ IOTXUSDT     ┆ 4.71383      ┆ 107  ┆ 2            │
│ EOSUSDT      ┆ 4.882979     ┆ 108  ┆ 1            │
│ LINAUSDT     ┆ 5.286846     ┆ 109  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,355 - WARNING - 2023-05-30T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,355 - INFO - cur close time: 2023-05-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:19,355 - DEBUG - mean expected ret (mean factor): 0.21452778559810387
2024-12-12 23:54:19,359 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,359 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,359 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0865      ┆ null        ┆ … ┆ 0.02364 ┆ null   ┆ null    ┆ 0.2299  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,366 - DEBUG - update position: 2023-05-30T23:59:59.999 === diff_trading_value: 329305.3159336969 == cash: 110463.66727444262 
2024-12-12 23:54:19,367 - INFO - pnl: 2023-05-30T23:59:59.999 110463.66727444262 === -0.526%
2024-12-12 23:54:19,371 - DEBUG - cur time: 2023-05-31T23:59:59.999 == next bar open time: 2023-06-01T00:00:00.000 == close pos time: 2023-06-06T00:00:00.000
2024-12-12 23:54:19,372 - INFO - pnl: 2023-05-31T23:59:59.999 112786.96950058476 === 2.103%
2024-12-12 23:54:19,375 - DEBUG - cur time: 2023-06-01T23:59:59.999 == next bar open time: 2023-06-02T00:00:00.000 == close pos time: 2023-06-07T00:00:00.000
2024-12-12 23:54:19,376 - INFO - pnl: 2023-06-01T23:59:59.999 112293.12411588969 === -0.438%
2024-12-12 23:54:19,381 - DEBUG - cur time: 2023-06-02T23:59:59.999 == next bar open time: 2023-06-03T00:00:00.000 == close pos time: 2023-06-08T00:00:00.000
2024-12-12 23:54:19,381 - INFO - pnl: 2023-06-02T23:59:59.999 112211.38682159652 === -0.073%
2024-12-12 23:54:19,388 - DEBUG - cur time: 2023-06-03T23:59:59.999 == next bar open time: 2023-06-04T00:00:00.000 == close pos time: 2023-06-09T00:00:00.000
2024-12-12 23:54:19,388 - INFO - pnl: 2023-06-03T23:59:59.999 110390.17413306083 === -1.623%
2024-12-12 23:54:19,393 - DEBUG - cur time: 2023-06-04T23:59:59.999 == next bar open time: 2023-06-05T00:00:00.000 == close pos time: 2023-06-10T00:00:00.000
2024-12-12 23:54:19,403 - DEBUG - close time 2023-06-04T23:59:59.999 == vol_threshold: 10915260.679999998
2024-12-12 23:54:19,403 - DEBUG - 2023-06-04T23:59:59.999 == all trade symbol 159 == remain 111 after VOL filter
2024-12-12 23:54:19,405 - DEBUG - sorted_long_factors: shape: (111, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ACHUSDT      ┆ -4.812092    ┆ 0    ┆ 110          │
│ C98USDT      ┆ -4.096062    ┆ 1    ┆ 109          │
│ DUSKUSDT     ┆ -4.009264    ┆ 2    ┆ 108          │
│ HOTUSDT      ┆ -3.699251    ┆ 3    ┆ 107          │
│ ANKRUSDT     ┆ -3.346733    ┆ 4    ┆ 106          │
│ STORJUSDT    ┆ -3.249344    ┆ 5    ┆ 105          │
│ 1000XECUSDT  ┆ -3.210605    ┆ 6    ┆ 104          │
│ BLZUSDT      ┆ -2.897619    ┆ 7    ┆ 103          │
│ AGIXUSDT     ┆ -2.774241    ┆ 8    ┆ 102          │
│ CKBUSDT      ┆ -2.582016    ┆ 9    ┆ 101          │
│ …            ┆ …            ┆ …    ┆ …            │
│ 1000LUNCUSDT ┆ 3.402395     ┆ 101  ┆ 9            │
│ BANDUSDT     ┆ 3.535492     ┆ 102  ┆ 8            │
│ CELOUSDT     ┆ 3.907947     ┆ 103  ┆ 7            │
│ XRPUSDT      ┆ 3.939547     ┆ 104  ┆ 6            │
│ DENTUSDT     ┆ 3.961482     ┆ 105  ┆ 5            │
│ ZRXUSDT      ┆ 4.386401     ┆ 106  ┆ 4            │
│ SUSHIUSDT    ┆ 5.16022      ┆ 107  ┆ 3            │
│ LINAUSDT     ┆ 6.179852     ┆ 108  ┆ 2            │
│ TRXUSDT      ┆ 6.340061     ┆ 109  ┆ 1            │
│ APEUSDT      ┆ 6.353888     ┆ 110  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,412 - WARNING - 2023-06-04T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,412 - INFO - cur close time: 2023-06-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:19,413 - DEBUG - mean expected ret (mean factor): 0.35828122531246803
2024-12-12 23:54:19,417 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,417 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,417 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1094      ┆ null        ┆ … ┆ 0.02394 ┆ null   ┆ null    ┆ 0.2207  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,426 - DEBUG - update position: 2023-06-04T23:59:59.999 === diff_trading_value: 320971.80612408556 == cash: 109305.4575327312 
2024-12-12 23:54:19,430 - INFO - pnl: 2023-06-04T23:59:59.999 109305.4575327312 === -0.983%
2024-12-12 23:54:19,435 - DEBUG - cur time: 2023-06-05T23:59:59.999 == next bar open time: 2023-06-06T00:00:00.000 == close pos time: 2023-06-11T00:00:00.000
2024-12-12 23:54:19,435 - INFO - pnl: 2023-06-05T23:59:59.999 109751.26274103759 === 0.408%
2024-12-12 23:54:19,440 - DEBUG - cur time: 2023-06-06T23:59:59.999 == next bar open time: 2023-06-07T00:00:00.000 == close pos time: 2023-06-12T00:00:00.000
2024-12-12 23:54:19,442 - INFO - pnl: 2023-06-06T23:59:59.999 109110.8712660822 === -0.583%
2024-12-12 23:54:19,446 - DEBUG - cur time: 2023-06-07T23:59:59.999 == next bar open time: 2023-06-08T00:00:00.000 == close pos time: 2023-06-13T00:00:00.000
2024-12-12 23:54:19,447 - INFO - pnl: 2023-06-07T23:59:59.999 107708.40704024123 === -1.285%
2024-12-12 23:54:19,451 - DEBUG - cur time: 2023-06-08T23:59:59.999 == next bar open time: 2023-06-09T00:00:00.000 == close pos time: 2023-06-14T00:00:00.000
2024-12-12 23:54:19,452 - INFO - pnl: 2023-06-08T23:59:59.999 106764.04964089044 === -0.877%
2024-12-12 23:54:19,456 - DEBUG - cur time: 2023-06-09T23:59:59.999 == next bar open time: 2023-06-10T00:00:00.000 == close pos time: 2023-06-15T00:00:00.000
2024-12-12 23:54:19,465 - DEBUG - close time 2023-06-09T23:59:59.999 == vol_threshold: 19040775.42
2024-12-12 23:54:19,465 - DEBUG - 2023-06-09T23:59:59.999 == all trade symbol 163 == remain 114 after VOL filter
2024-12-12 23:54:19,467 - DEBUG - sorted_long_factors: shape: (114, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ENJUSDT     ┆ -3.945098    ┆ 0    ┆ 113          │
│ DUSKUSDT    ┆ -3.1931      ┆ 1    ┆ 112          │
│ HOOKUSDT    ┆ -3.125389    ┆ 2    ┆ 111          │
│ BELUSDT     ┆ -2.739723    ┆ 3    ┆ 110          │
│ APTUSDT     ┆ -2.518376    ┆ 4    ┆ 109          │
│ REEFUSDT    ┆ -2.489587    ┆ 5    ┆ 108          │
│ PEOPLEUSDT  ┆ -2.295512    ┆ 6    ┆ 107          │
│ DYDXUSDT    ┆ -2.240195    ┆ 7    ┆ 106          │
│ FETUSDT     ┆ -2.205944    ┆ 8    ┆ 105          │
│ JASMYUSDT   ┆ -2.176367    ┆ 9    ┆ 104          │
│ …           ┆ …            ┆ …    ┆ …            │
│ CELOUSDT    ┆ 2.039951     ┆ 104  ┆ 9            │
│ ZRXUSDT     ┆ 2.47507      ┆ 105  ┆ 8            │
│ AMBUSDT     ┆ 2.655734     ┆ 106  ┆ 7            │
│ DGBUSDT     ┆ 2.694752     ┆ 107  ┆ 6            │
│ DOGEUSDT    ┆ 2.778123     ┆ 108  ┆ 5            │
│ ASTRUSDT    ┆ 3.277986     ┆ 109  ┆ 4            │
│ 1000XECUSDT ┆ 3.33658      ┆ 110  ┆ 3            │
│ MTLUSDT     ┆ 3.415872     ┆ 111  ┆ 2            │
│ XLMUSDT     ┆ 3.465024     ┆ 112  ┆ 1            │
│ LINAUSDT    ┆ 3.811774     ┆ 113  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,472 - WARNING - 2023-06-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,472 - INFO - cur close time: 2023-06-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:19,472 - DEBUG - mean expected ret (mean factor): -0.14701351235437543
2024-12-12 23:54:19,476 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,476 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,477 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09923     ┆ null        ┆ … ┆ 0.02087 ┆ null   ┆ null    ┆ 0.1991  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,480 - DEBUG - update position: 2023-06-09T23:59:59.999 === diff_trading_value: 314733.5919575398 == cash: 108020.60941935223 
2024-12-12 23:54:19,484 - INFO - pnl: 2023-06-09T23:59:59.999 108020.60941935223 === 1.177%
2024-12-12 23:54:19,484 - DEBUG - cur time: 2023-06-10T23:59:59.999 == next bar open time: 2023-06-11T00:00:00.000 == close pos time: 2023-06-16T00:00:00.000
2024-12-12 23:54:19,488 - INFO - pnl: 2023-06-10T23:59:59.999 113599.94391303239 === 5.165%
2024-12-12 23:54:19,493 - DEBUG - cur time: 2023-06-11T23:59:59.999 == next bar open time: 2023-06-12T00:00:00.000 == close pos time: 2023-06-17T00:00:00.000
2024-12-12 23:54:19,496 - INFO - pnl: 2023-06-11T23:59:59.999 115037.75172201404 === 1.266%
2024-12-12 23:54:19,501 - DEBUG - cur time: 2023-06-12T23:59:59.999 == next bar open time: 2023-06-13T00:00:00.000 == close pos time: 2023-06-18T00:00:00.000
2024-12-12 23:54:19,501 - INFO - pnl: 2023-06-12T23:59:59.999 115883.97849992121 === 0.736%
2024-12-12 23:54:19,506 - DEBUG - cur time: 2023-06-13T23:59:59.999 == next bar open time: 2023-06-14T00:00:00.000 == close pos time: 2023-06-19T00:00:00.000
2024-12-12 23:54:19,508 - INFO - pnl: 2023-06-13T23:59:59.999 114297.67472910775 === -1.369%
2024-12-12 23:54:19,510 - DEBUG - cur time: 2023-06-14T23:59:59.999 == next bar open time: 2023-06-15T00:00:00.000 == close pos time: 2023-06-20T00:00:00.000
2024-12-12 23:54:19,520 - DEBUG - close time 2023-06-14T23:59:59.999 == vol_threshold: 31390460.68
2024-12-12 23:54:19,521 - DEBUG - 2023-06-14T23:59:59.999 == all trade symbol 163 == remain 114 after VOL filter
2024-12-12 23:54:19,521 - DEBUG - sorted_long_factors: shape: (114, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ MINAUSDT  ┆ -6.432253    ┆ 0    ┆ 113          │
│ HOTUSDT   ┆ -4.56691     ┆ 1    ┆ 112          │
│ XRPUSDT   ┆ -4.104616    ┆ 2    ┆ 111          │
│ RENUSDT   ┆ -3.826802    ┆ 3    ┆ 110          │
│ DUSKUSDT  ┆ -3.617419    ┆ 4    ┆ 109          │
│ TRUUSDT   ┆ -3.456889    ┆ 5    ┆ 108          │
│ ARBUSDT   ┆ -3.37294     ┆ 6    ┆ 107          │
│ VETUSDT   ┆ -3.232254    ┆ 7    ┆ 106          │
│ LEVERUSDT ┆ -3.159131    ┆ 8    ┆ 105          │
│ JOEUSDT   ┆ -3.117769    ┆ 9    ┆ 104          │
│ …         ┆ …            ┆ …    ┆ …            │
│ JASMYUSDT ┆ 2.226156     ┆ 104  ┆ 9            │
│ CELOUSDT  ┆ 2.472749     ┆ 105  ┆ 8            │
│ STMXUSDT  ┆ 2.671289     ┆ 106  ┆ 7            │
│ RVNUSDT   ┆ 3.131428     ┆ 107  ┆ 6            │
│ XTZUSDT   ┆ 3.278273     ┆ 108  ┆ 5            │
│ COTIUSDT  ┆ 3.362723     ┆ 109  ┆ 4            │
│ IOTXUSDT  ┆ 3.496604     ┆ 110  ┆ 3            │
│ GALUSDT   ┆ 3.94336      ┆ 111  ┆ 2            │
│ LINAUSDT  ┆ 4.578711     ┆ 112  ┆ 1            │
│ TRXUSDT   ┆ 4.802512     ┆ 113  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,530 - WARNING - 2023-06-14T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,530 - INFO - cur close time: 2023-06-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:19,530 - DEBUG - mean expected ret (mean factor): -0.0836664949878044
2024-12-12 23:54:19,534 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,534 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,535 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09387     ┆ null        ┆ … ┆ 0.01679 ┆ null   ┆ null    ┆ 0.169   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,540 - DEBUG - update position: 2023-06-14T23:59:59.999 === diff_trading_value: 314801.56268189347 == cash: 115112.91247650419 
2024-12-12 23:54:19,541 - INFO - pnl: 2023-06-14T23:59:59.999 115112.91247650419 === 0.713%
2024-12-12 23:54:19,546 - DEBUG - cur time: 2023-06-15T23:59:59.999 == next bar open time: 2023-06-16T00:00:00.000 == close pos time: 2023-06-21T00:00:00.000
2024-12-12 23:54:19,546 - INFO - pnl: 2023-06-15T23:59:59.999 113421.47802784246 === -1.469%
2024-12-12 23:54:19,550 - DEBUG - cur time: 2023-06-16T23:59:59.999 == next bar open time: 2023-06-17T00:00:00.000 == close pos time: 2023-06-22T00:00:00.000
2024-12-12 23:54:19,551 - INFO - pnl: 2023-06-16T23:59:59.999 113396.39643400496 === -0.022%
2024-12-12 23:54:19,555 - DEBUG - cur time: 2023-06-17T23:59:59.999 == next bar open time: 2023-06-18T00:00:00.000 == close pos time: 2023-06-23T00:00:00.000
2024-12-12 23:54:19,555 - INFO - pnl: 2023-06-17T23:59:59.999 111523.81648433593 === -1.651%
2024-12-12 23:54:19,559 - DEBUG - cur time: 2023-06-18T23:59:59.999 == next bar open time: 2023-06-19T00:00:00.000 == close pos time: 2023-06-24T00:00:00.000
2024-12-12 23:54:19,559 - INFO - pnl: 2023-06-18T23:59:59.999 110899.38650721815 === -0.560%
2024-12-12 23:54:19,563 - DEBUG - cur time: 2023-06-19T23:59:59.999 == next bar open time: 2023-06-20T00:00:00.000 == close pos time: 2023-06-25T00:00:00.000
2024-12-12 23:54:19,572 - DEBUG - close time 2023-06-19T23:59:59.999 == vol_threshold: 21531691.599999998
2024-12-12 23:54:19,572 - DEBUG - 2023-06-19T23:59:59.999 == all trade symbol 165 == remain 115 after VOL filter
2024-12-12 23:54:19,575 - DEBUG - sorted_long_factors: shape: (115, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ IOTXUSDT     ┆ -3.947052    ┆ 0    ┆ 114          │
│ SPELLUSDT    ┆ -3.557799    ┆ 1    ┆ 113          │
│ 1000LUNCUSDT ┆ -2.990595    ┆ 2    ┆ 112          │
│ ACHUSDT      ┆ -2.985333    ┆ 3    ┆ 111          │
│ COTIUSDT     ┆ -2.9125      ┆ 4    ┆ 110          │
│ NKNUSDT      ┆ -2.664218    ┆ 5    ┆ 109          │
│ RDNTUSDT     ┆ -2.633422    ┆ 6    ┆ 108          │
│ HIGHUSDT     ┆ -2.630744    ┆ 7    ┆ 107          │
│ OPUSDT       ┆ -2.533912    ┆ 8    ┆ 106          │
│ IOSTUSDT     ┆ -2.396116    ┆ 9    ┆ 105          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TUSDT        ┆ 2.846033     ┆ 105  ┆ 9            │
│ DARUSDT      ┆ 3.009184     ┆ 106  ┆ 8            │
│ MTLUSDT      ┆ 3.019328     ┆ 107  ┆ 7            │
│ INJUSDT      ┆ 3.246603     ┆ 108  ┆ 6            │
│ JOEUSDT      ┆ 3.527695     ┆ 109  ┆ 5            │
│ SFPUSDT      ┆ 3.557545     ┆ 110  ┆ 4            │
│ KLAYUSDT     ┆ 3.608684     ┆ 111  ┆ 3            │
│ ANTUSDT      ┆ 3.668757     ┆ 112  ┆ 2            │
│ CTSIUSDT     ┆ 4.111549     ┆ 113  ┆ 1            │
│ ICXUSDT      ┆ 4.258428     ┆ 114  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,580 - WARNING - 2023-06-19T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,580 - INFO - cur close time: 2023-06-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:19,580 - DEBUG - mean expected ret (mean factor): 0.2790130693571892
2024-12-12 23:54:19,584 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,584 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,584 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09012     ┆ null        ┆ … ┆ 0.01735 ┆ null   ┆ null    ┆ 0.178   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,591 - DEBUG - update position: 2023-06-19T23:59:59.999 === diff_trading_value: 368107.42051735055 == cash: 109111.35484196908 
2024-12-12 23:54:19,592 - INFO - pnl: 2023-06-19T23:59:59.999 109111.35484196908 === -1.612%
2024-12-12 23:54:19,596 - DEBUG - cur time: 2023-06-20T23:59:59.999 == next bar open time: 2023-06-21T00:00:00.000 == close pos time: 2023-06-26T00:00:00.000
2024-12-12 23:54:19,597 - INFO - pnl: 2023-06-20T23:59:59.999 109889.31718678497 === 0.713%
2024-12-12 23:54:19,600 - DEBUG - cur time: 2023-06-21T23:59:59.999 == next bar open time: 2023-06-22T00:00:00.000 == close pos time: 2023-06-27T00:00:00.000
2024-12-12 23:54:19,601 - INFO - pnl: 2023-06-21T23:59:59.999 109139.71664881107 === -0.682%
2024-12-12 23:54:19,602 - DEBUG - cur time: 2023-06-22T23:59:59.999 == next bar open time: 2023-06-23T00:00:00.000 == close pos time: 2023-06-28T00:00:00.000
2024-12-12 23:54:19,605 - INFO - pnl: 2023-06-22T23:59:59.999 110127.71976012849 === 0.905%
2024-12-12 23:54:19,608 - DEBUG - cur time: 2023-06-23T23:59:59.999 == next bar open time: 2023-06-24T00:00:00.000 == close pos time: 2023-06-29T00:00:00.000
2024-12-12 23:54:19,608 - INFO - pnl: 2023-06-23T23:59:59.999 111865.87229035208 === 1.578%
2024-12-12 23:54:19,612 - DEBUG - cur time: 2023-06-24T23:59:59.999 == next bar open time: 2023-06-25T00:00:00.000 == close pos time: 2023-06-30T00:00:00.000
2024-12-12 23:54:19,621 - DEBUG - close time 2023-06-24T23:59:59.999 == vol_threshold: 25421830.65
2024-12-12 23:54:19,621 - DEBUG - 2023-06-24T23:59:59.999 == all trade symbol 166 == remain 116 after VOL filter
2024-12-12 23:54:19,621 - DEBUG - sorted_long_factors: shape: (116, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ FETUSDT      ┆ -4.256415    ┆ 0    ┆ 115          │
│ XRPUSDT      ┆ -4.023191    ┆ 1    ┆ 114          │
│ 1000LUNCUSDT ┆ -3.876236    ┆ 2    ┆ 113          │
│ ARBUSDT      ┆ -3.705217    ┆ 3    ┆ 112          │
│ LQTYUSDT     ┆ -3.117022    ┆ 4    ┆ 111          │
│ APEUSDT      ┆ -2.899906    ┆ 5    ┆ 110          │
│ MINAUSDT     ┆ -2.761127    ┆ 6    ┆ 109          │
│ ASTRUSDT     ┆ -2.75873     ┆ 7    ┆ 108          │
│ ONTUSDT      ┆ -2.596942    ┆ 8    ┆ 107          │
│ ARPAUSDT     ┆ -2.366001    ┆ 9    ┆ 106          │
│ …            ┆ …            ┆ …    ┆ …            │
│ XEMUSDT      ┆ 3.205462     ┆ 106  ┆ 9            │
│ DARUSDT      ┆ 3.350836     ┆ 107  ┆ 8            │
│ IOTAUSDT     ┆ 3.533415     ┆ 108  ┆ 7            │
│ WAVESUSDT    ┆ 3.632248     ┆ 109  ┆ 6            │
│ DENTUSDT     ┆ 3.669971     ┆ 110  ┆ 5            │
│ FLOWUSDT     ┆ 3.915708     ┆ 111  ┆ 4            │
│ BAKEUSDT     ┆ 4.10628      ┆ 112  ┆ 3            │
│ OGNUSDT      ┆ 4.683657     ┆ 113  ┆ 2            │
│ HBARUSDT     ┆ 4.784918     ┆ 114  ┆ 1            │
│ HOTUSDT      ┆ 6.284518     ┆ 115  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,625 - WARNING - 2023-06-24T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,625 - INFO - cur close time: 2023-06-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:19,625 - DEBUG - mean expected ret (mean factor): 0.13994660281686683
2024-12-12 23:54:19,633 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,633 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,634 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09082     ┆ null        ┆ … ┆ 0.02125 ┆ null   ┆ null    ┆ 0.2052  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,640 - DEBUG - update position: 2023-06-24T23:59:59.999 === diff_trading_value: 344727.0800158075 == cash: 111082.44056162577 
2024-12-12 23:54:19,642 - INFO - pnl: 2023-06-24T23:59:59.999 111082.44056162577 === -0.700%
2024-12-12 23:54:19,643 - DEBUG - cur time: 2023-06-25T23:59:59.999 == next bar open time: 2023-06-26T00:00:00.000 == close pos time: 2023-07-01T00:00:00.000
2024-12-12 23:54:19,647 - INFO - pnl: 2023-06-25T23:59:59.999 108866.47274475405 === -1.995%
2024-12-12 23:54:19,651 - DEBUG - cur time: 2023-06-26T23:59:59.999 == next bar open time: 2023-06-27T00:00:00.000 == close pos time: 2023-07-02T00:00:00.000
2024-12-12 23:54:19,652 - INFO - pnl: 2023-06-26T23:59:59.999 107427.51174295873 === -1.322%
2024-12-12 23:54:19,656 - DEBUG - cur time: 2023-06-27T23:59:59.999 == next bar open time: 2023-06-28T00:00:00.000 == close pos time: 2023-07-03T00:00:00.000
2024-12-12 23:54:19,657 - INFO - pnl: 2023-06-27T23:59:59.999 105894.09920231416 === -1.427%
2024-12-12 23:54:19,659 - DEBUG - cur time: 2023-06-28T23:59:59.999 == next bar open time: 2023-06-29T00:00:00.000 == close pos time: 2023-07-04T00:00:00.000
2024-12-12 23:54:19,660 - INFO - pnl: 2023-06-28T23:59:59.999 105778.16114458628 === -0.109%
2024-12-12 23:54:19,663 - DEBUG - cur time: 2023-06-29T23:59:59.999 == next bar open time: 2023-06-30T00:00:00.000 == close pos time: 2023-07-05T00:00:00.000
2024-12-12 23:54:19,672 - DEBUG - close time 2023-06-29T23:59:59.999 == vol_threshold: 20179401.3125
2024-12-12 23:54:19,672 - DEBUG - 2023-06-29T23:59:59.999 == all trade symbol 166 == remain 116 after VOL filter
2024-12-12 23:54:19,674 - DEBUG - sorted_long_factors: shape: (116, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RDNTUSDT     ┆ -5.171404    ┆ 0    ┆ 115          │
│ IDUSDT       ┆ -3.882404    ┆ 1    ┆ 114          │
│ ARBUSDT      ┆ -3.606786    ┆ 2    ┆ 113          │
│ ATAUSDT      ┆ -3.312266    ┆ 3    ┆ 112          │
│ TOMOUSDT     ┆ -3.089461    ┆ 4    ┆ 111          │
│ THETAUSDT    ┆ -2.963847    ┆ 5    ┆ 110          │
│ XRPUSDT      ┆ -2.878705    ┆ 6    ┆ 109          │
│ AGIXUSDT     ┆ -2.860939    ┆ 7    ┆ 108          │
│ 1000SHIBUSDT ┆ -2.542661    ┆ 8    ┆ 107          │
│ MAGICUSDT    ┆ -2.527303    ┆ 9    ┆ 106          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COTIUSDT     ┆ 2.971097     ┆ 106  ┆ 9            │
│ BAKEUSDT     ┆ 3.402196     ┆ 107  ┆ 8            │
│ ADAUSDT      ┆ 3.534827     ┆ 108  ┆ 7            │
│ DENTUSDT     ┆ 3.797801     ┆ 109  ┆ 6            │
│ RVNUSDT      ┆ 3.875833     ┆ 110  ┆ 5            │
│ TLMUSDT      ┆ 4.378986     ┆ 111  ┆ 4            │
│ CHRUSDT      ┆ 4.576098     ┆ 112  ┆ 3            │
│ CTSIUSDT     ┆ 4.625946     ┆ 113  ┆ 2            │
│ CELRUSDT     ┆ 4.719252     ┆ 114  ┆ 1            │
│ ALGOUSDT     ┆ 5.242311     ┆ 115  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,680 - WARNING - 2023-06-29T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,680 - INFO - cur close time: 2023-06-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:19,681 - DEBUG - mean expected ret (mean factor): 0.05600705509425752
2024-12-12 23:54:19,682 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,682 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,682 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08729     ┆ null        ┆ … ┆ 0.01959 ┆ null   ┆ null    ┆ 0.2016  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,690 - DEBUG - update position: 2023-06-29T23:59:59.999 === diff_trading_value: 277558.3384722194 == cash: 105592.40480919203 
2024-12-12 23:54:19,691 - INFO - pnl: 2023-06-29T23:59:59.999 105592.40480919203 === -0.176%
2024-12-12 23:54:19,694 - DEBUG - cur time: 2023-06-30T23:59:59.999 == next bar open time: 2023-07-01T00:00:00.000 == close pos time: 2023-07-06T00:00:00.000
2024-12-12 23:54:19,696 - INFO - pnl: 2023-06-30T23:59:59.999 107567.19405029702 === 1.870%
2024-12-12 23:54:19,700 - DEBUG - cur time: 2023-07-01T23:59:59.999 == next bar open time: 2023-07-02T00:00:00.000 == close pos time: 2023-07-07T00:00:00.000
2024-12-12 23:54:19,700 - INFO - pnl: 2023-07-01T23:59:59.999 108928.44109119676 === 1.265%
2024-12-12 23:54:19,705 - DEBUG - cur time: 2023-07-02T23:59:59.999 == next bar open time: 2023-07-03T00:00:00.000 == close pos time: 2023-07-08T00:00:00.000
2024-12-12 23:54:19,706 - INFO - pnl: 2023-07-02T23:59:59.999 109046.44821990535 === 0.108%
2024-12-12 23:54:19,709 - DEBUG - cur time: 2023-07-03T23:59:59.999 == next bar open time: 2023-07-04T00:00:00.000 == close pos time: 2023-07-09T00:00:00.000
2024-12-12 23:54:19,710 - INFO - pnl: 2023-07-03T23:59:59.999 111207.2002476263 === 1.981%
2024-12-12 23:54:19,714 - DEBUG - cur time: 2023-07-04T23:59:59.999 == next bar open time: 2023-07-05T00:00:00.000 == close pos time: 2023-07-10T00:00:00.000
2024-12-12 23:54:19,723 - DEBUG - close time 2023-07-04T23:59:59.999 == vol_threshold: 26555689.25
2024-12-12 23:54:19,727 - DEBUG - 2023-07-04T23:59:59.999 == all trade symbol 166 == remain 116 after VOL filter
2024-12-12 23:54:19,727 - DEBUG - sorted_long_factors: shape: (116, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MINAUSDT     ┆ -6.050987    ┆ 0    ┆ 115          │
│ RDNTUSDT     ┆ -5.239189    ┆ 1    ┆ 114          │
│ APEUSDT      ┆ -4.585154    ┆ 2    ┆ 113          │
│ 1000LUNCUSDT ┆ -4.580097    ┆ 3    ┆ 112          │
│ HOOKUSDT     ┆ -3.54279     ┆ 4    ┆ 111          │
│ SXPUSDT      ┆ -3.275576    ┆ 5    ┆ 110          │
│ RVNUSDT      ┆ -3.130078    ┆ 6    ┆ 109          │
│ AGIXUSDT     ┆ -3.125836    ┆ 7    ┆ 108          │
│ CFXUSDT      ┆ -2.877509    ┆ 8    ┆ 107          │
│ LEVERUSDT    ┆ -2.754138    ┆ 9    ┆ 106          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RSRUSDT      ┆ 2.666571     ┆ 106  ┆ 9            │
│ DENTUSDT     ┆ 2.723794     ┆ 107  ┆ 8            │
│ GMTUSDT      ┆ 3.007344     ┆ 108  ┆ 7            │
│ KLAYUSDT     ┆ 3.028889     ┆ 109  ┆ 6            │
│ XEMUSDT      ┆ 3.267811     ┆ 110  ┆ 5            │
│ TRXUSDT      ┆ 4.026962     ┆ 111  ┆ 4            │
│ SFPUSDT      ┆ 4.686935     ┆ 112  ┆ 3            │
│ FLOWUSDT     ┆ 4.941123     ┆ 113  ┆ 2            │
│ XTZUSDT      ┆ 5.079389     ┆ 114  ┆ 1            │
│ STORJUSDT    ┆ 5.763358     ┆ 115  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,736 - WARNING - 2023-07-04T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,736 - INFO - cur close time: 2023-07-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:19,736 - DEBUG - mean expected ret (mean factor): -0.08455181519966519
2024-12-12 23:54:19,740 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,740 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,740 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08599     ┆ null        ┆ … ┆ 0.02304 ┆ null   ┆ null    ┆ 0.2151  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,747 - DEBUG - update position: 2023-07-04T23:59:59.999 === diff_trading_value: 314534.95210853155 == cash: 110832.89321986306 
2024-12-12 23:54:19,749 - INFO - pnl: 2023-07-04T23:59:59.999 110832.89321986306 === -0.337%
2024-12-12 23:54:19,751 - DEBUG - cur time: 2023-07-05T23:59:59.999 == next bar open time: 2023-07-06T00:00:00.000 == close pos time: 2023-07-11T00:00:00.000
2024-12-12 23:54:19,755 - INFO - pnl: 2023-07-05T23:59:59.999 108924.51268167348 === -1.722%
2024-12-12 23:54:19,755 - DEBUG - cur time: 2023-07-06T23:59:59.999 == next bar open time: 2023-07-07T00:00:00.000 == close pos time: 2023-07-12T00:00:00.000
2024-12-12 23:54:19,760 - INFO - pnl: 2023-07-06T23:59:59.999 110778.79345612795 === 1.702%
2024-12-12 23:54:19,763 - DEBUG - cur time: 2023-07-07T23:59:59.999 == next bar open time: 2023-07-08T00:00:00.000 == close pos time: 2023-07-13T00:00:00.000
2024-12-12 23:54:19,764 - INFO - pnl: 2023-07-07T23:59:59.999 110680.25801244254 === -0.089%
2024-12-12 23:54:19,768 - DEBUG - cur time: 2023-07-08T23:59:59.999 == next bar open time: 2023-07-09T00:00:00.000 == close pos time: 2023-07-14T00:00:00.000
2024-12-12 23:54:19,769 - INFO - pnl: 2023-07-08T23:59:59.999 110034.9201397097 === -0.583%
2024-12-12 23:54:19,772 - DEBUG - cur time: 2023-07-09T23:59:59.999 == next bar open time: 2023-07-10T00:00:00.000 == close pos time: 2023-07-15T00:00:00.000
2024-12-12 23:54:19,780 - DEBUG - close time 2023-07-09T23:59:59.999 == vol_threshold: 11626304.08
2024-12-12 23:54:19,780 - DEBUG - 2023-07-09T23:59:59.999 == all trade symbol 167 == remain 117 after VOL filter
2024-12-12 23:54:19,780 - DEBUG - sorted_long_factors: shape: (117, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -4.138634    ┆ 0    ┆ 116          │
│ TRXUSDT      ┆ -3.863963    ┆ 1    ┆ 115          │
│ ROSEUSDT     ┆ -3.659101    ┆ 2    ┆ 114          │
│ TUSDT        ┆ -3.640284    ┆ 3    ┆ 113          │
│ DOTUSDT      ┆ -3.256302    ┆ 4    ┆ 112          │
│ IDUSDT       ┆ -3.162047    ┆ 5    ┆ 111          │
│ XRPUSDT      ┆ -2.992488    ┆ 6    ┆ 110          │
│ C98USDT      ┆ -2.976262    ┆ 7    ┆ 109          │
│ HOTUSDT      ┆ -2.869897    ┆ 8    ┆ 108          │
│ MTLUSDT      ┆ -2.771886    ┆ 9    ┆ 107          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BATUSDT      ┆ 3.155945     ┆ 107  ┆ 9            │
│ SFPUSDT      ┆ 3.202327     ┆ 108  ┆ 8            │
│ OCEANUSDT    ┆ 3.262892     ┆ 109  ┆ 7            │
│ ZRXUSDT      ┆ 3.593421     ┆ 110  ┆ 6            │
│ JOEUSDT      ┆ 3.635625     ┆ 111  ┆ 5            │
│ LEVERUSDT    ┆ 3.658504     ┆ 112  ┆ 4            │
│ XEMUSDT      ┆ 4.01238      ┆ 113  ┆ 3            │
│ COTIUSDT     ┆ 4.040956     ┆ 114  ┆ 2            │
│ CRVUSDT      ┆ 4.301807     ┆ 115  ┆ 1            │
│ IOSTUSDT     ┆ 5.296553     ┆ 116  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,789 - WARNING - 2023-07-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,789 - INFO - cur close time: 2023-07-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:19,789 - DEBUG - mean expected ret (mean factor): 0.11302134443585266
2024-12-12 23:54:19,792 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,792 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,792 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08195     ┆ null        ┆ … ┆ 0.02022 ┆ null   ┆ null    ┆ 0.2021  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,799 - DEBUG - update position: 2023-07-09T23:59:59.999 === diff_trading_value: 319355.7913434153 == cash: 110802.1129396856 
2024-12-12 23:54:19,799 - INFO - pnl: 2023-07-09T23:59:59.999 110802.1129396856 === 0.697%
2024-12-12 23:54:19,803 - DEBUG - cur time: 2023-07-10T23:59:59.999 == next bar open time: 2023-07-11T00:00:00.000 == close pos time: 2023-07-16T00:00:00.000
2024-12-12 23:54:19,805 - INFO - pnl: 2023-07-10T23:59:59.999 110147.37505187075 === -0.591%
2024-12-12 23:54:19,808 - DEBUG - cur time: 2023-07-11T23:59:59.999 == next bar open time: 2023-07-12T00:00:00.000 == close pos time: 2023-07-17T00:00:00.000
2024-12-12 23:54:19,808 - INFO - pnl: 2023-07-11T23:59:59.999 110283.80858606694 === 0.124%
2024-12-12 23:54:19,811 - DEBUG - cur time: 2023-07-12T23:59:59.999 == next bar open time: 2023-07-13T00:00:00.000 == close pos time: 2023-07-18T00:00:00.000
2024-12-12 23:54:19,812 - INFO - pnl: 2023-07-12T23:59:59.999 110789.47490586124 === 0.459%
2024-12-12 23:54:19,815 - DEBUG - cur time: 2023-07-13T23:59:59.999 == next bar open time: 2023-07-14T00:00:00.000 == close pos time: 2023-07-19T00:00:00.000
2024-12-12 23:54:19,816 - INFO - pnl: 2023-07-13T23:59:59.999 105530.61245599116 === -4.747%
2024-12-12 23:54:19,820 - DEBUG - cur time: 2023-07-14T23:59:59.999 == next bar open time: 2023-07-15T00:00:00.000 == close pos time: 2023-07-20T00:00:00.000
2024-12-12 23:54:19,830 - DEBUG - close time 2023-07-14T23:59:59.999 == vol_threshold: 48670584.81999999
2024-12-12 23:54:19,830 - DEBUG - 2023-07-14T23:59:59.999 == all trade symbol 170 == remain 119 after VOL filter
2024-12-12 23:54:19,832 - DEBUG - sorted_long_factors: shape: (119, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ MINAUSDT  ┆ -4.395106    ┆ 0    ┆ 118          │
│ VETUSDT   ┆ -3.960361    ┆ 1    ┆ 117          │
│ BLURUSDT  ┆ -3.871498    ┆ 2    ┆ 116          │
│ COTIUSDT  ┆ -3.589159    ┆ 3    ┆ 115          │
│ DUSKUSDT  ┆ -3.302189    ┆ 4    ┆ 114          │
│ RDNTUSDT  ┆ -3.224093    ┆ 5    ┆ 113          │
│ TLMUSDT   ┆ -3.148877    ┆ 6    ┆ 112          │
│ FILUSDT   ┆ -2.965687    ┆ 7    ┆ 111          │
│ JASMYUSDT ┆ -2.908818    ┆ 8    ┆ 110          │
│ HOTUSDT   ┆ -2.830684    ┆ 9    ┆ 109          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XLMUSDT   ┆ 2.485094     ┆ 109  ┆ 9            │
│ TUSDT     ┆ 2.839458     ┆ 110  ┆ 8            │
│ SFPUSDT   ┆ 2.92373      ┆ 111  ┆ 7            │
│ TRXUSDT   ┆ 3.012225     ┆ 112  ┆ 6            │
│ LDOUSDT   ┆ 3.48028      ┆ 113  ┆ 5            │
│ LQTYUSDT  ┆ 3.633649     ┆ 114  ┆ 4            │
│ XEMUSDT   ┆ 5.013959     ┆ 115  ┆ 3            │
│ INJUSDT   ┆ 5.073409     ┆ 116  ┆ 2            │
│ SNXUSDT   ┆ 5.165974     ┆ 117  ┆ 1            │
│ CKBUSDT   ┆ 5.436906     ┆ 118  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,838 - WARNING - 2023-07-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,838 - INFO - cur close time: 2023-07-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:19,838 - DEBUG - mean expected ret (mean factor): 0.007392494875527056
2024-12-12 23:54:19,842 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,842 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,842 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08546     ┆ 0.0016397   ┆ … ┆ 0.02152 ┆ null   ┆ null    ┆ 0.2183  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,851 - DEBUG - update position: 2023-07-14T23:59:59.999 === diff_trading_value: 355245.2440256584 == cash: 107018.3753561631 
2024-12-12 23:54:19,852 - INFO - pnl: 2023-07-14T23:59:59.999 107018.3753561631 === 1.410%
2024-12-12 23:54:19,855 - DEBUG - cur time: 2023-07-15T23:59:59.999 == next bar open time: 2023-07-16T00:00:00.000 == close pos time: 2023-07-21T00:00:00.000
2024-12-12 23:54:19,857 - INFO - pnl: 2023-07-15T23:59:59.999 106640.3148025201 === -0.353%
2024-12-12 23:54:19,860 - DEBUG - cur time: 2023-07-16T23:59:59.999 == next bar open time: 2023-07-17T00:00:00.000 == close pos time: 2023-07-22T00:00:00.000
2024-12-12 23:54:19,863 - INFO - pnl: 2023-07-16T23:59:59.999 106754.65714824297 === 0.107%
2024-12-12 23:54:19,866 - DEBUG - cur time: 2023-07-17T23:59:59.999 == next bar open time: 2023-07-18T00:00:00.000 == close pos time: 2023-07-23T00:00:00.000
2024-12-12 23:54:19,867 - INFO - pnl: 2023-07-17T23:59:59.999 106685.40146010826 === -0.065%
2024-12-12 23:54:19,871 - DEBUG - cur time: 2023-07-18T23:59:59.999 == next bar open time: 2023-07-19T00:00:00.000 == close pos time: 2023-07-24T00:00:00.000
2024-12-12 23:54:19,872 - INFO - pnl: 2023-07-18T23:59:59.999 106307.20911905143 === -0.354%
2024-12-12 23:54:19,872 - DEBUG - cur time: 2023-07-19T23:59:59.999 == next bar open time: 2023-07-20T00:00:00.000 == close pos time: 2023-07-25T00:00:00.000
2024-12-12 23:54:19,884 - DEBUG - close time 2023-07-19T23:59:59.999 == vol_threshold: 19593225.209999997
2024-12-12 23:54:19,884 - DEBUG - 2023-07-19T23:59:59.999 == all trade symbol 172 == remain 120 after VOL filter
2024-12-12 23:54:19,888 - DEBUG - sorted_long_factors: shape: (120, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ RVNUSDT   ┆ -5.293146    ┆ 0    ┆ 119          │
│ RDNTUSDT  ┆ -3.138706    ┆ 1    ┆ 118          │
│ WAVESUSDT ┆ -2.608203    ┆ 2    ┆ 117          │
│ BLZUSDT   ┆ -2.468825    ┆ 3    ┆ 116          │
│ LEVERUSDT ┆ -2.392334    ┆ 4    ┆ 115          │
│ ARBUSDT   ┆ -2.290423    ┆ 5    ┆ 114          │
│ XRPUSDT   ┆ -2.22805     ┆ 6    ┆ 113          │
│ EDUUSDT   ┆ -2.173935    ┆ 7    ┆ 112          │
│ BNXUSDT   ┆ -2.12218     ┆ 8    ┆ 111          │
│ IDUSDT    ┆ -1.96204     ┆ 9    ┆ 110          │
│ …         ┆ …            ┆ …    ┆ …            │
│ BAKEUSDT  ┆ 1.6023       ┆ 110  ┆ 9            │
│ ONEUSDT   ┆ 1.630673     ┆ 111  ┆ 8            │
│ IOSTUSDT  ┆ 1.673988     ┆ 112  ┆ 7            │
│ SNXUSDT   ┆ 1.679517     ┆ 113  ┆ 6            │
│ FLMUSDT   ┆ 1.696395     ┆ 114  ┆ 5            │
│ NKNUSDT   ┆ 1.907116     ┆ 115  ┆ 4            │
│ TRUUSDT   ┆ 2.087272     ┆ 116  ┆ 3            │
│ DARUSDT   ┆ 2.298571     ┆ 117  ┆ 2            │
│ RSRUSDT   ┆ 2.429003     ┆ 118  ┆ 1            │
│ BATUSDT   ┆ 3.335357     ┆ 119  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,893 - WARNING - 2023-07-19T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,893 - INFO - cur close time: 2023-07-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:19,894 - DEBUG - mean expected ret (mean factor): -0.16472965709514625
2024-12-12 23:54:19,897 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,897 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,897 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02397     ┆ 0.08668     ┆ 0.0015244   ┆ … ┆ 0.02174 ┆ null   ┆ null    ┆ 0.2099  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,906 - DEBUG - update position: 2023-07-19T23:59:59.999 === diff_trading_value: 332844.30399703875 == cash: 107808.6171897063 
2024-12-12 23:54:19,908 - INFO - pnl: 2023-07-19T23:59:59.999 107808.6171897063 === 1.412%
2024-12-12 23:54:19,912 - DEBUG - cur time: 2023-07-20T23:59:59.999 == next bar open time: 2023-07-21T00:00:00.000 == close pos time: 2023-07-26T00:00:00.000
2024-12-12 23:54:19,913 - INFO - pnl: 2023-07-20T23:59:59.999 108397.20876494225 === 0.546%
2024-12-12 23:54:19,918 - DEBUG - cur time: 2023-07-21T23:59:59.999 == next bar open time: 2023-07-22T00:00:00.000 == close pos time: 2023-07-27T00:00:00.000
2024-12-12 23:54:19,918 - INFO - pnl: 2023-07-21T23:59:59.999 110247.92032649484 === 1.707%
2024-12-12 23:54:19,923 - DEBUG - cur time: 2023-07-22T23:59:59.999 == next bar open time: 2023-07-23T00:00:00.000 == close pos time: 2023-07-28T00:00:00.000
2024-12-12 23:54:19,925 - INFO - pnl: 2023-07-22T23:59:59.999 112528.09421617424 === 2.068%
2024-12-12 23:54:19,926 - DEBUG - cur time: 2023-07-23T23:59:59.999 == next bar open time: 2023-07-24T00:00:00.000 == close pos time: 2023-07-29T00:00:00.000
2024-12-12 23:54:19,930 - INFO - pnl: 2023-07-23T23:59:59.999 111556.04923093221 === -0.864%
2024-12-12 23:54:19,934 - DEBUG - cur time: 2023-07-24T23:59:59.999 == next bar open time: 2023-07-25T00:00:00.000 == close pos time: 2023-07-30T00:00:00.000
2024-12-12 23:54:19,946 - DEBUG - close time 2023-07-24T23:59:59.999 == vol_threshold: 24088584.23
2024-12-12 23:54:19,946 - DEBUG - 2023-07-24T23:59:59.999 == all trade symbol 174 == remain 122 after VOL filter
2024-12-12 23:54:19,950 - DEBUG - sorted_long_factors: shape: (122, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -4.280709    ┆ 0    ┆ 121          │
│ BLURUSDT     ┆ -3.927373    ┆ 1    ┆ 120          │
│ DUSKUSDT     ┆ -3.364815    ┆ 2    ┆ 119          │
│ LUNA2USDT    ┆ -3.344119    ┆ 3    ┆ 118          │
│ JOEUSDT      ┆ -3.296062    ┆ 4    ┆ 117          │
│ RDNTUSDT     ┆ -3.266603    ┆ 5    ┆ 116          │
│ ARBUSDT      ┆ -3.244437    ┆ 6    ┆ 115          │
│ VETUSDT      ┆ -3.222793    ┆ 7    ┆ 114          │
│ CHZUSDT      ┆ -3.098359    ┆ 8    ┆ 113          │
│ OMGUSDT      ┆ -2.874414    ┆ 9    ┆ 112          │
│ …            ┆ …            ┆ …    ┆ …            │
│ AMBUSDT      ┆ 2.801185     ┆ 112  ┆ 9            │
│ SNXUSDT      ┆ 3.132067     ┆ 113  ┆ 8            │
│ SKLUSDT      ┆ 3.174941     ┆ 114  ┆ 7            │
│ TOMOUSDT     ┆ 3.416623     ┆ 115  ┆ 6            │
│ OGNUSDT      ┆ 3.437992     ┆ 116  ┆ 5            │
│ KNCUSDT      ┆ 3.502544     ┆ 117  ┆ 4            │
│ SPELLUSDT    ┆ 3.92574      ┆ 118  ┆ 3            │
│ IOTXUSDT     ┆ 4.79431      ┆ 119  ┆ 2            │
│ STMXUSDT     ┆ 4.806737     ┆ 120  ┆ 1            │
│ CKBUSDT      ┆ 6.724703     ┆ 121  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:19,959 - WARNING - 2023-07-24T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:19,959 - INFO - cur close time: 2023-07-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:19,959 - DEBUG - mean expected ret (mean factor): -0.16438852338680113
2024-12-12 23:54:19,966 - DEBUG - begin to update pos: =========
2024-12-12 23:54:19,967 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,967 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02211     ┆ 0.08187     ┆ 0.0013465   ┆ … ┆ 0.02072 ┆ null   ┆ null    ┆ 0.2065  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:19,976 - DEBUG - update position: 2023-07-24T23:59:59.999 === diff_trading_value: 304931.594306431 == cash: 111224.30639114876 
2024-12-12 23:54:19,980 - INFO - pnl: 2023-07-24T23:59:59.999 111224.30639114876 === -0.297%
2024-12-12 23:54:19,985 - DEBUG - cur time: 2023-07-25T23:59:59.999 == next bar open time: 2023-07-26T00:00:00.000 == close pos time: 2023-07-31T00:00:00.000
2024-12-12 23:54:19,987 - INFO - pnl: 2023-07-25T23:59:59.999 110886.99602688872 === -0.303%
2024-12-12 23:54:19,994 - DEBUG - cur time: 2023-07-26T23:59:59.999 == next bar open time: 2023-07-27T00:00:00.000 == close pos time: 2023-08-01T00:00:00.000
2024-12-12 23:54:19,994 - INFO - pnl: 2023-07-26T23:59:59.999 112680.08379574839 === 1.617%
2024-12-12 23:54:20,000 - DEBUG - cur time: 2023-07-27T23:59:59.999 == next bar open time: 2023-07-28T00:00:00.000 == close pos time: 2023-08-02T00:00:00.000
2024-12-12 23:54:20,002 - INFO - pnl: 2023-07-27T23:59:59.999 112502.23685636275 === -0.158%
2024-12-12 23:54:20,007 - DEBUG - cur time: 2023-07-28T23:59:59.999 == next bar open time: 2023-07-29T00:00:00.000 == close pos time: 2023-08-03T00:00:00.000
2024-12-12 23:54:20,008 - INFO - pnl: 2023-07-28T23:59:59.999 114397.21986801429 === 1.684%
2024-12-12 23:54:20,013 - DEBUG - cur time: 2023-07-29T23:59:59.999 == next bar open time: 2023-07-30T00:00:00.000 == close pos time: 2023-08-04T00:00:00.000
2024-12-12 23:54:20,021 - DEBUG - close time 2023-07-29T23:59:59.999 == vol_threshold: 9224551.61
2024-12-12 23:54:20,021 - DEBUG - 2023-07-29T23:59:59.999 == all trade symbol 174 == remain 122 after VOL filter
2024-12-12 23:54:20,025 - DEBUG - sorted_long_factors: shape: (122, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RVNUSDT      ┆ -5.493443    ┆ 0    ┆ 121          │
│ IOTXUSDT     ┆ -4.240075    ┆ 1    ┆ 120          │
│ XRPUSDT      ┆ -3.804177    ┆ 2    ┆ 119          │
│ BNXUSDT      ┆ -3.357433    ┆ 3    ┆ 118          │
│ IDEXUSDT     ┆ -3.256406    ┆ 4    ┆ 117          │
│ 1000LUNCUSDT ┆ -3.101359    ┆ 5    ┆ 116          │
│ LUNA2USDT    ┆ -3.078608    ┆ 6    ┆ 115          │
│ DARUSDT      ┆ -2.798918    ┆ 7    ┆ 114          │
│ NKNUSDT      ┆ -2.768748    ┆ 8    ┆ 113          │
│ RDNTUSDT     ┆ -2.735906    ┆ 9    ┆ 112          │
│ …            ┆ …            ┆ …    ┆ …            │
│ OMGUSDT      ┆ 3.080989     ┆ 112  ┆ 9            │
│ BLURUSDT     ┆ 3.360994     ┆ 113  ┆ 8            │
│ IOTAUSDT     ┆ 3.448639     ┆ 114  ┆ 7            │
│ KNCUSDT      ┆ 3.471519     ┆ 115  ┆ 6            │
│ ENJUSDT      ┆ 3.598768     ┆ 116  ┆ 5            │
│ CELOUSDT     ┆ 4.243297     ┆ 117  ┆ 4            │
│ SKLUSDT      ┆ 4.349527     ┆ 118  ┆ 3            │
│ KAVAUSDT     ┆ 5.122802     ┆ 119  ┆ 2            │
│ CRVUSDT      ┆ 7.301578     ┆ 120  ┆ 1            │
│ BATUSDT      ┆ 12.343737    ┆ 121  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,041 - WARNING - 2023-07-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,042 - INFO - cur close time: 2023-07-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:20,042 - DEBUG - mean expected ret (mean factor): 0.0013728696018617196
2024-12-12 23:54:20,047 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,047 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,048 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02295     ┆ 0.08196     ┆ 0.0013465   ┆ … ┆ 0.0215  ┆ null   ┆ null    ┆ 0.2204  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,060 - DEBUG - update position: 2023-07-29T23:59:59.999 === diff_trading_value: 267876.87563668157 == cash: 116323.90311969661 
2024-12-12 23:54:20,063 - INFO - pnl: 2023-07-29T23:59:59.999 116323.90311969661 === 1.684%
2024-12-12 23:54:20,069 - DEBUG - cur time: 2023-07-30T23:59:59.999 == next bar open time: 2023-07-31T00:00:00.000 == close pos time: 2023-08-05T00:00:00.000
2024-12-12 23:54:20,073 - INFO - pnl: 2023-07-30T23:59:59.999 115928.49315862227 === -0.340%
2024-12-12 23:54:20,081 - DEBUG - cur time: 2023-07-31T23:59:59.999 == next bar open time: 2023-08-01T00:00:00.000 == close pos time: 2023-08-06T00:00:00.000
2024-12-12 23:54:20,087 - INFO - pnl: 2023-07-31T23:59:59.999 115904.66530936028 === -0.021%
2024-12-12 23:54:20,096 - DEBUG - cur time: 2023-08-01T23:59:59.999 == next bar open time: 2023-08-02T00:00:00.000 == close pos time: 2023-08-07T00:00:00.000
2024-12-12 23:54:20,099 - INFO - pnl: 2023-08-01T23:59:59.999 115726.69604592811 === -0.154%
2024-12-12 23:54:20,108 - DEBUG - cur time: 2023-08-02T23:59:59.999 == next bar open time: 2023-08-03T00:00:00.000 == close pos time: 2023-08-08T00:00:00.000
2024-12-12 23:54:20,111 - INFO - pnl: 2023-08-02T23:59:59.999 115929.76387091697 === 0.175%
2024-12-12 23:54:20,122 - DEBUG - cur time: 2023-08-03T23:59:59.999 == next bar open time: 2023-08-04T00:00:00.000 == close pos time: 2023-08-09T00:00:00.000
2024-12-12 23:54:20,144 - DEBUG - close time 2023-08-03T23:59:59.999 == vol_threshold: 15567614.34
2024-12-12 23:54:20,145 - DEBUG - 2023-08-03T23:59:59.999 == all trade symbol 175 == remain 122 after VOL filter
2024-12-12 23:54:20,146 - DEBUG - sorted_long_factors: shape: (122, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT      ┆ -3.574487    ┆ 0    ┆ 121          │
│ IDUSDT       ┆ -3.072762    ┆ 1    ┆ 120          │
│ IDEXUSDT     ┆ -2.840782    ┆ 2    ┆ 119          │
│ RVNUSDT      ┆ -2.754423    ┆ 3    ┆ 118          │
│ ARBUSDT      ┆ -2.13898     ┆ 4    ┆ 117          │
│ 1000LUNCUSDT ┆ -1.9769      ┆ 5    ┆ 116          │
│ BLURUSDT     ┆ -1.962378    ┆ 6    ┆ 115          │
│ MASKUSDT     ┆ -1.945722    ┆ 7    ┆ 114          │
│ IOTXUSDT     ┆ -1.926908    ┆ 8    ┆ 113          │
│ FILUSDT      ┆ -1.611399    ┆ 9    ┆ 112          │
│ …            ┆ …            ┆ …    ┆ …            │
│ OMGUSDT      ┆ 1.165784     ┆ 112  ┆ 9            │
│ SNXUSDT      ┆ 1.178574     ┆ 113  ┆ 8            │
│ NKNUSDT      ┆ 1.259591     ┆ 114  ┆ 7            │
│ FLMUSDT      ┆ 1.400663     ┆ 115  ┆ 6            │
│ RSRUSDT      ┆ 1.639907     ┆ 116  ┆ 5            │
│ CHRUSDT      ┆ 1.663826     ┆ 117  ┆ 4            │
│ CRVUSDT      ┆ 2.019137     ┆ 118  ┆ 3            │
│ OPUSDT       ┆ 2.035903     ┆ 119  ┆ 2            │
│ CKBUSDT      ┆ 2.458596     ┆ 120  ┆ 1            │
│ LQTYUSDT     ┆ 3.566797     ┆ 121  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,158 - WARNING - 2023-08-03T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,159 - INFO - cur close time: 2023-08-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:20,159 - DEBUG - mean expected ret (mean factor): -0.21356637649053156
2024-12-12 23:54:20,166 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,166 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,166 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02179     ┆ 0.07887     ┆ 0.0011981   ┆ … ┆ 0.02033 ┆ null   ┆ null    ┆ 0.2204  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,173 - DEBUG - update position: 2023-08-03T23:59:59.999 === diff_trading_value: 240009.40050041975 == cash: 116421.58794763818 
2024-12-12 23:54:20,177 - INFO - pnl: 2023-08-03T23:59:59.999 116421.58794763818 === 0.424%
2024-12-12 23:54:20,184 - DEBUG - cur time: 2023-08-04T23:59:59.999 == next bar open time: 2023-08-05T00:00:00.000 == close pos time: 2023-08-10T00:00:00.000
2024-12-12 23:54:20,186 - INFO - pnl: 2023-08-04T23:59:59.999 117427.95333781763 === 0.864%
2024-12-12 23:54:20,192 - DEBUG - cur time: 2023-08-05T23:59:59.999 == next bar open time: 2023-08-06T00:00:00.000 == close pos time: 2023-08-11T00:00:00.000
2024-12-12 23:54:20,192 - INFO - pnl: 2023-08-05T23:59:59.999 117657.78424947319 === 0.196%
2024-12-12 23:54:20,200 - DEBUG - cur time: 2023-08-06T23:59:59.999 == next bar open time: 2023-08-07T00:00:00.000 == close pos time: 2023-08-12T00:00:00.000
2024-12-12 23:54:20,205 - INFO - pnl: 2023-08-06T23:59:59.999 117445.4098898415 === -0.181%
2024-12-12 23:54:20,211 - DEBUG - cur time: 2023-08-07T23:59:59.999 == next bar open time: 2023-08-08T00:00:00.000 == close pos time: 2023-08-13T00:00:00.000
2024-12-12 23:54:20,213 - INFO - pnl: 2023-08-07T23:59:59.999 118945.6544467649 === 1.277%
2024-12-12 23:54:20,220 - DEBUG - cur time: 2023-08-08T23:59:59.999 == next bar open time: 2023-08-09T00:00:00.000 == close pos time: 2023-08-14T00:00:00.000
2024-12-12 23:54:20,235 - DEBUG - close time 2023-08-08T23:59:59.999 == vol_threshold: 18568153.66
2024-12-12 23:54:20,236 - DEBUG - 2023-08-08T23:59:59.999 == all trade symbol 175 == remain 122 after VOL filter
2024-12-12 23:54:20,237 - DEBUG - sorted_long_factors: shape: (122, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ LQTYUSDT      ┆ -4.266058    ┆ 0    ┆ 121          │
│ IOSTUSDT      ┆ -3.716851    ┆ 1    ┆ 120          │
│ ACHUSDT       ┆ -3.339849    ┆ 2    ┆ 119          │
│ IDEXUSDT      ┆ -3.277647    ┆ 3    ┆ 118          │
│ 1000FLOKIUSDT ┆ -3.121108    ┆ 4    ┆ 117          │
│ ZILUSDT       ┆ -2.927686    ┆ 5    ┆ 116          │
│ HOTUSDT       ┆ -2.774744    ┆ 6    ┆ 115          │
│ RVNUSDT       ┆ -2.666276    ┆ 7    ┆ 114          │
│ KEYUSDT       ┆ -2.60466     ┆ 8    ┆ 113          │
│ NKNUSDT       ┆ -2.558245    ┆ 9    ┆ 112          │
│ …             ┆ …            ┆ …    ┆ …            │
│ TRXUSDT       ┆ 2.657442     ┆ 112  ┆ 9            │
│ C98USDT       ┆ 2.665132     ┆ 113  ┆ 8            │
│ VETUSDT       ┆ 3.193307     ┆ 114  ┆ 7            │
│ IOTAUSDT      ┆ 3.318858     ┆ 115  ┆ 6            │
│ SNXUSDT       ┆ 3.329166     ┆ 116  ┆ 5            │
│ SPELLUSDT     ┆ 3.365464     ┆ 117  ┆ 4            │
│ BATUSDT       ┆ 3.634206     ┆ 118  ┆ 3            │
│ KAVAUSDT      ┆ 4.46468      ┆ 119  ┆ 2            │
│ FLOWUSDT      ┆ 4.627471     ┆ 120  ┆ 1            │
│ KLAYUSDT      ┆ 5.375292     ┆ 121  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,246 - WARNING - 2023-08-08T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,246 - INFO - cur close time: 2023-08-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:20,246 - DEBUG - mean expected ret (mean factor): 0.1681931975822284
2024-12-12 23:54:20,249 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,249 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,249 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02221     ┆ 0.07815     ┆ 0.0011753   ┆ … ┆ 0.02014 ┆ null   ┆ null    ┆ 0.2157  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,260 - DEBUG - update position: 2023-08-08T23:59:59.999 === diff_trading_value: 323815.8487214062 == cash: 116825.64442930924 
2024-12-12 23:54:20,262 - INFO - pnl: 2023-08-08T23:59:59.999 116825.64442930924 === -1.782%
2024-12-12 23:54:20,267 - DEBUG - cur time: 2023-08-09T23:59:59.999 == next bar open time: 2023-08-10T00:00:00.000 == close pos time: 2023-08-15T00:00:00.000
2024-12-12 23:54:20,271 - INFO - pnl: 2023-08-09T23:59:59.999 116915.49947844724 === 0.077%
2024-12-12 23:54:20,275 - DEBUG - cur time: 2023-08-10T23:59:59.999 == next bar open time: 2023-08-11T00:00:00.000 == close pos time: 2023-08-16T00:00:00.000
2024-12-12 23:54:20,275 - INFO - pnl: 2023-08-10T23:59:59.999 117410.1791328007 === 0.423%
2024-12-12 23:54:20,285 - DEBUG - cur time: 2023-08-11T23:59:59.999 == next bar open time: 2023-08-12T00:00:00.000 == close pos time: 2023-08-17T00:00:00.000
2024-12-12 23:54:20,289 - INFO - pnl: 2023-08-11T23:59:59.999 118145.38527771714 === 0.626%
2024-12-12 23:54:20,291 - DEBUG - cur time: 2023-08-12T23:59:59.999 == next bar open time: 2023-08-13T00:00:00.000 == close pos time: 2023-08-18T00:00:00.000
2024-12-12 23:54:20,291 - INFO - pnl: 2023-08-12T23:59:59.999 119929.38019721286 === 1.510%
2024-12-12 23:54:20,298 - DEBUG - cur time: 2023-08-13T23:59:59.999 == next bar open time: 2023-08-14T00:00:00.000 == close pos time: 2023-08-19T00:00:00.000
2024-12-12 23:54:20,310 - DEBUG - close time 2023-08-13T23:59:59.999 == vol_threshold: 13843338.35
2024-12-12 23:54:20,310 - DEBUG - 2023-08-13T23:59:59.999 == all trade symbol 176 == remain 123 after VOL filter
2024-12-12 23:54:20,313 - DEBUG - sorted_long_factors: shape: (123, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ ARBUSDT       ┆ -4.490538    ┆ 0    ┆ 122          │
│ 1000FLOKIUSDT ┆ -4.006806    ┆ 1    ┆ 121          │
│ IMXUSDT       ┆ -3.760238    ┆ 2    ┆ 120          │
│ 1000LUNCUSDT  ┆ -3.668905    ┆ 3    ┆ 119          │
│ RDNTUSDT      ┆ -3.247797    ┆ 4    ┆ 118          │
│ DOGEUSDT      ┆ -3.002916    ┆ 5    ┆ 117          │
│ SUIUSDT       ┆ -2.917079    ┆ 6    ┆ 116          │
│ ALPHAUSDT     ┆ -2.811187    ┆ 7    ┆ 115          │
│ FILUSDT       ┆ -2.670483    ┆ 8    ┆ 114          │
│ JOEUSDT       ┆ -2.550718    ┆ 9    ┆ 113          │
│ …             ┆ …            ┆ …    ┆ …            │
│ CHRUSDT       ┆ 3.632105     ┆ 113  ┆ 9            │
│ AMBUSDT       ┆ 3.785628     ┆ 114  ┆ 8            │
│ LPTUSDT       ┆ 3.923563     ┆ 115  ┆ 7            │
│ HOOKUSDT      ┆ 4.06185      ┆ 116  ┆ 6            │
│ RUNEUSDT      ┆ 4.402692     ┆ 117  ┆ 5            │
│ REEFUSDT      ┆ 4.756672     ┆ 118  ┆ 4            │
│ NKNUSDT       ┆ 4.952248     ┆ 119  ┆ 3            │
│ BLZUSDT       ┆ 5.170676     ┆ 120  ┆ 2            │
│ XEMUSDT       ┆ 5.915899     ┆ 121  ┆ 1            │
│ KEYUSDT       ┆ 7.378868     ┆ 122  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,317 - WARNING - 2023-08-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,320 - INFO - cur close time: 2023-08-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:20,320 - DEBUG - mean expected ret (mean factor): 0.3813507104703594
2024-12-12 23:54:20,321 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,321 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,321 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02296     ┆ 0.07765     ┆ 0.0013648   ┆ … ┆ 0.01998 ┆ null   ┆ null    ┆ 0.2193  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,331 - DEBUG - update position: 2023-08-13T23:59:59.999 === diff_trading_value: 337909.85577026394 == cash: 122742.72747763332 
2024-12-12 23:54:20,333 - INFO - pnl: 2023-08-13T23:59:59.999 122742.72747763332 === 2.346%
2024-12-12 23:54:20,336 - DEBUG - cur time: 2023-08-14T23:59:59.999 == next bar open time: 2023-08-15T00:00:00.000 == close pos time: 2023-08-20T00:00:00.000
2024-12-12 23:54:20,337 - INFO - pnl: 2023-08-14T23:59:59.999 122048.931284525 === -0.565%
2024-12-12 23:54:20,339 - DEBUG - cur time: 2023-08-15T23:59:59.999 == next bar open time: 2023-08-16T00:00:00.000 == close pos time: 2023-08-21T00:00:00.000
2024-12-12 23:54:20,341 - INFO - pnl: 2023-08-15T23:59:59.999 121196.44153490827 === -0.698%
2024-12-12 23:54:20,343 - DEBUG - cur time: 2023-08-16T23:59:59.999 == next bar open time: 2023-08-17T00:00:00.000 == close pos time: 2023-08-22T00:00:00.000
2024-12-12 23:54:20,345 - INFO - pnl: 2023-08-16T23:59:59.999 123032.29184301844 === 1.515%
2024-12-12 23:54:20,346 - DEBUG - cur time: 2023-08-17T23:59:59.999 == next bar open time: 2023-08-18T00:00:00.000 == close pos time: 2023-08-23T00:00:00.000
2024-12-12 23:54:20,346 - INFO - pnl: 2023-08-17T23:59:59.999 123753.50684166173 === 0.586%
2024-12-12 23:54:20,351 - DEBUG - cur time: 2023-08-18T23:59:59.999 == next bar open time: 2023-08-19T00:00:00.000 == close pos time: 2023-08-24T00:00:00.000
2024-12-12 23:54:20,360 - DEBUG - close time 2023-08-18T23:59:59.999 == vol_threshold: 31936344.5
2024-12-12 23:54:20,360 - DEBUG - 2023-08-18T23:59:59.999 == all trade symbol 176 == remain 123 after VOL filter
2024-12-12 23:54:20,363 - DEBUG - sorted_long_factors: shape: (123, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT   ┆ -5.443619    ┆ 0    ┆ 122          │
│ DOGEUSDT  ┆ -4.969103    ┆ 1    ┆ 121          │
│ DGBUSDT   ┆ -4.83429     ┆ 2    ┆ 120          │
│ LEVERUSDT ┆ -4.669955    ┆ 3    ┆ 119          │
│ STXUSDT   ┆ -4.080697    ┆ 4    ┆ 118          │
│ RDNTUSDT  ┆ -3.543026    ┆ 5    ┆ 117          │
│ ARBUSDT   ┆ -3.012755    ┆ 6    ┆ 116          │
│ HOTUSDT   ┆ -3.001827    ┆ 7    ┆ 115          │
│ APEUSDT   ┆ -2.961004    ┆ 8    ┆ 114          │
│ GRTUSDT   ┆ -2.861632    ┆ 9    ┆ 113          │
│ …         ┆ …            ┆ …    ┆ …            │
│ FLOWUSDT  ┆ 2.865523     ┆ 113  ┆ 9            │
│ CKBUSDT   ┆ 3.248942     ┆ 114  ┆ 8            │
│ WAVESUSDT ┆ 3.348519     ┆ 115  ┆ 7            │
│ RUNEUSDT  ┆ 3.363788     ┆ 116  ┆ 6            │
│ PHBUSDT   ┆ 3.576087     ┆ 117  ┆ 5            │
│ CHZUSDT   ┆ 3.62621      ┆ 118  ┆ 4            │
│ IOSTUSDT  ┆ 3.733231     ┆ 119  ┆ 3            │
│ SFPUSDT   ┆ 4.928836     ┆ 120  ┆ 2            │
│ BNXUSDT   ┆ 5.540478     ┆ 121  ┆ 1            │
│ IDEXUSDT  ┆ 9.305429     ┆ 122  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,370 - WARNING - 2023-08-18T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,370 - INFO - cur close time: 2023-08-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:20,370 - DEBUG - mean expected ret (mean factor): 0.051214843748394294
2024-12-12 23:54:20,375 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,375 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,376 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01839     ┆ 0.06237     ┆ 0.0010892   ┆ … ┆ 0.01667 ┆ null   ┆ null    ┆ 0.1739  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,382 - DEBUG - update position: 2023-08-18T23:59:59.999 === diff_trading_value: 296873.22194423433 == cash: 124467.12382912329 
2024-12-12 23:54:20,383 - INFO - pnl: 2023-08-18T23:59:59.999 124467.12382912329 === 0.577%
2024-12-12 23:54:20,386 - DEBUG - cur time: 2023-08-19T23:59:59.999 == next bar open time: 2023-08-20T00:00:00.000 == close pos time: 2023-08-25T00:00:00.000
2024-12-12 23:54:20,388 - INFO - pnl: 2023-08-19T23:59:59.999 124100.79019574808 === -0.294%
2024-12-12 23:54:20,390 - DEBUG - cur time: 2023-08-20T23:59:59.999 == next bar open time: 2023-08-21T00:00:00.000 == close pos time: 2023-08-26T00:00:00.000
2024-12-12 23:54:20,392 - INFO - pnl: 2023-08-20T23:59:59.999 124001.76086859794 === -0.080%
2024-12-12 23:54:20,395 - DEBUG - cur time: 2023-08-21T23:59:59.999 == next bar open time: 2023-08-22T00:00:00.000 == close pos time: 2023-08-27T00:00:00.000
2024-12-12 23:54:20,396 - INFO - pnl: 2023-08-21T23:59:59.999 125740.47482780956 === 1.402%
2024-12-12 23:54:20,400 - DEBUG - cur time: 2023-08-22T23:59:59.999 == next bar open time: 2023-08-23T00:00:00.000 == close pos time: 2023-08-28T00:00:00.000
2024-12-12 23:54:20,400 - INFO - pnl: 2023-08-22T23:59:59.999 125329.41033483772 === -0.327%
2024-12-12 23:54:20,405 - DEBUG - cur time: 2023-08-23T23:59:59.999 == next bar open time: 2023-08-24T00:00:00.000 == close pos time: 2023-08-29T00:00:00.000
2024-12-12 23:54:20,414 - DEBUG - close time 2023-08-23T23:59:59.999 == vol_threshold: 18035154.85
2024-12-12 23:54:20,415 - DEBUG - 2023-08-23T23:59:59.999 == all trade symbol 176 == remain 123 after VOL filter
2024-12-12 23:54:20,415 - DEBUG - sorted_long_factors: shape: (123, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ MINAUSDT  ┆ -4.96336     ┆ 0    ┆ 122          │
│ CTKUSDT   ┆ -4.182488    ┆ 1    ┆ 121          │
│ ARBUSDT   ┆ -3.538555    ┆ 2    ┆ 120          │
│ KLAYUSDT  ┆ -3.005948    ┆ 3    ┆ 119          │
│ SUSHIUSDT ┆ -2.926416    ┆ 4    ┆ 118          │
│ TLMUSDT   ┆ -2.849046    ┆ 5    ┆ 117          │
│ XRPUSDT   ┆ -2.815752    ┆ 6    ┆ 116          │
│ IOSTUSDT  ┆ -2.6903      ┆ 7    ┆ 115          │
│ JOEUSDT   ┆ -2.599333    ┆ 8    ┆ 114          │
│ ATAUSDT   ┆ -2.597757    ┆ 9    ┆ 113          │
│ …         ┆ …            ┆ …    ┆ …            │
│ THETAUSDT ┆ 3.587396     ┆ 113  ┆ 9            │
│ SFPUSDT   ┆ 3.703856     ┆ 114  ┆ 8            │
│ IDEXUSDT  ┆ 3.775949     ┆ 115  ┆ 7            │
│ CKBUSDT   ┆ 3.963267     ┆ 116  ┆ 6            │
│ STORJUSDT ┆ 4.086772     ┆ 117  ┆ 5            │
│ TRXUSDT   ┆ 4.530373     ┆ 118  ┆ 4            │
│ LDOUSDT   ┆ 5.013637     ┆ 119  ┆ 3            │
│ TUSDT     ┆ 5.666629     ┆ 120  ┆ 2            │
│ HOTUSDT   ┆ 5.788546     ┆ 121  ┆ 1            │
│ OMGUSDT   ┆ 6.863912     ┆ 122  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,422 - WARNING - 2023-08-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,422 - INFO - cur close time: 2023-08-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:20,422 - DEBUG - mean expected ret (mean factor): 0.26995348514513345
2024-12-12 23:54:20,428 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,428 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,428 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0185      ┆ 0.06491     ┆ 0.0011043   ┆ … ┆ 0.01698 ┆ null   ┆ null    ┆ 0.177   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,434 - DEBUG - update position: 2023-08-23T23:59:59.999 === diff_trading_value: 337674.8796491614 == cash: 126536.14762458623 
2024-12-12 23:54:20,435 - INFO - pnl: 2023-08-23T23:59:59.999 126536.14762458623 === 0.963%
2024-12-12 23:54:20,438 - DEBUG - cur time: 2023-08-24T23:59:59.999 == next bar open time: 2023-08-25T00:00:00.000 == close pos time: 2023-08-30T00:00:00.000
2024-12-12 23:54:20,438 - INFO - pnl: 2023-08-24T23:59:59.999 127755.35879170022 === 0.964%
2024-12-12 23:54:20,441 - DEBUG - cur time: 2023-08-25T23:59:59.999 == next bar open time: 2023-08-26T00:00:00.000 == close pos time: 2023-08-31T00:00:00.000
2024-12-12 23:54:20,442 - INFO - pnl: 2023-08-25T23:59:59.999 126653.90401816506 === -0.862%
2024-12-12 23:54:20,445 - DEBUG - cur time: 2023-08-26T23:59:59.999 == next bar open time: 2023-08-27T00:00:00.000 == close pos time: 2023-09-01T00:00:00.000
2024-12-12 23:54:20,446 - INFO - pnl: 2023-08-26T23:59:59.999 126797.83484008041 === 0.114%
2024-12-12 23:54:20,446 - DEBUG - cur time: 2023-08-27T23:59:59.999 == next bar open time: 2023-08-28T00:00:00.000 == close pos time: 2023-09-02T00:00:00.000
2024-12-12 23:54:20,450 - INFO - pnl: 2023-08-27T23:59:59.999 125823.56011589161 === -0.768%
2024-12-12 23:54:20,450 - DEBUG - cur time: 2023-08-28T23:59:59.999 == next bar open time: 2023-08-29T00:00:00.000 == close pos time: 2023-09-03T00:00:00.000
2024-12-12 23:54:20,460 - DEBUG - close time 2023-08-28T23:59:59.999 == vol_threshold: 21182059.5
2024-12-12 23:54:20,460 - DEBUG - 2023-08-28T23:59:59.999 == all trade symbol 176 == remain 123 after VOL filter
2024-12-12 23:54:20,462 - DEBUG - sorted_long_factors: shape: (123, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ FETUSDT     ┆ -4.708127    ┆ 0    ┆ 122          │
│ ACHUSDT     ┆ -4.292572    ┆ 1    ┆ 121          │
│ PHBUSDT     ┆ -3.227193    ┆ 2    ┆ 120          │
│ TRXUSDT     ┆ -3.058866    ┆ 3    ┆ 119          │
│ DUSKUSDT    ┆ -2.98638     ┆ 4    ┆ 118          │
│ ASTRUSDT    ┆ -2.86777     ┆ 5    ┆ 117          │
│ 1000XECUSDT ┆ -2.708213    ┆ 6    ┆ 116          │
│ OCEANUSDT   ┆ -2.486133    ┆ 7    ┆ 115          │
│ CKBUSDT     ┆ -2.404809    ┆ 8    ┆ 114          │
│ HBARUSDT    ┆ -2.314815    ┆ 9    ┆ 113          │
│ …           ┆ …            ┆ …    ┆ …            │
│ TUSDT       ┆ 2.778215     ┆ 113  ┆ 9            │
│ TRUUSDT     ┆ 2.989227     ┆ 114  ┆ 8            │
│ UNFIUSDT    ┆ 3.251699     ┆ 115  ┆ 7            │
│ GRTUSDT     ┆ 3.332604     ┆ 116  ┆ 6            │
│ OMGUSDT     ┆ 3.475762     ┆ 117  ┆ 5            │
│ FILUSDT     ┆ 3.592547     ┆ 118  ┆ 4            │
│ ENJUSDT     ┆ 3.937211     ┆ 119  ┆ 3            │
│ BNXUSDT     ┆ 4.142055     ┆ 120  ┆ 2            │
│ FLMUSDT     ┆ 4.181283     ┆ 121  ┆ 1            │
│ BATUSDT     ┆ 5.183482     ┆ 122  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,466 - WARNING - 2023-08-28T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,466 - INFO - cur close time: 2023-08-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:20,466 - DEBUG - mean expected ret (mean factor): 0.3603704170737147
2024-12-12 23:54:20,474 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,474 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,474 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01758     ┆ 0.06274     ┆ 0.0008576   ┆ … ┆ 0.01672 ┆ null   ┆ null    ┆ 0.1712  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,480 - DEBUG - update position: 2023-08-28T23:59:59.999 === diff_trading_value: 365451.6064965604 == cash: 123979.43728961065 
2024-12-12 23:54:20,481 - INFO - pnl: 2023-08-28T23:59:59.999 123979.43728961065 === -1.466%
2024-12-12 23:54:20,484 - DEBUG - cur time: 2023-08-29T23:59:59.999 == next bar open time: 2023-08-30T00:00:00.000 == close pos time: 2023-09-04T00:00:00.000
2024-12-12 23:54:20,485 - INFO - pnl: 2023-08-29T23:59:59.999 124471.47391290989 === 0.397%
2024-12-12 23:54:20,488 - DEBUG - cur time: 2023-08-30T23:59:59.999 == next bar open time: 2023-08-31T00:00:00.000 == close pos time: 2023-09-05T00:00:00.000
2024-12-12 23:54:20,490 - INFO - pnl: 2023-08-30T23:59:59.999 125016.5259915475 === 0.438%
2024-12-12 23:54:20,493 - DEBUG - cur time: 2023-08-31T23:59:59.999 == next bar open time: 2023-09-01T00:00:00.000 == close pos time: 2023-09-06T00:00:00.000
2024-12-12 23:54:20,495 - INFO - pnl: 2023-08-31T23:59:59.999 124299.37962271273 === -0.574%
2024-12-12 23:54:20,498 - DEBUG - cur time: 2023-09-01T23:59:59.999 == next bar open time: 2023-09-02T00:00:00.000 == close pos time: 2023-09-07T00:00:00.000
2024-12-12 23:54:20,498 - INFO - pnl: 2023-09-01T23:59:59.999 125895.42065171277 === 1.284%
2024-12-12 23:54:20,500 - DEBUG - cur time: 2023-09-02T23:59:59.999 == next bar open time: 2023-09-03T00:00:00.000 == close pos time: 2023-09-08T00:00:00.000
2024-12-12 23:54:20,511 - DEBUG - close time 2023-09-02T23:59:59.999 == vol_threshold: 14847185.68
2024-12-12 23:54:20,512 - DEBUG - 2023-09-02T23:59:59.999 == all trade symbol 177 == remain 124 after VOL filter
2024-12-12 23:54:20,514 - DEBUG - sorted_long_factors: shape: (124, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ COMBOUSDT ┆ -3.999862    ┆ 0    ┆ 123          │
│ LEVERUSDT ┆ -2.979752    ┆ 1    ┆ 122          │
│ TLMUSDT   ┆ -2.762052    ┆ 2    ┆ 121          │
│ XRPUSDT   ┆ -2.742129    ┆ 3    ┆ 120          │
│ DARUSDT   ┆ -2.464592    ┆ 4    ┆ 119          │
│ TRUUSDT   ┆ -2.378681    ┆ 5    ┆ 118          │
│ MTLUSDT   ┆ -2.337812    ┆ 6    ┆ 117          │
│ HBARUSDT  ┆ -2.333172    ┆ 7    ┆ 116          │
│ BELUSDT   ┆ -2.175637    ┆ 8    ┆ 115          │
│ COTIUSDT  ┆ -2.132243    ┆ 9    ┆ 114          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ZRXUSDT   ┆ 1.990497     ┆ 114  ┆ 9            │
│ HIGHUSDT  ┆ 2.01831      ┆ 115  ┆ 8            │
│ ANKRUSDT  ┆ 2.219887     ┆ 116  ┆ 7            │
│ GMTUSDT   ┆ 2.358137     ┆ 117  ┆ 6            │
│ STORJUSDT ┆ 3.012186     ┆ 118  ┆ 5            │
│ NMRUSDT   ┆ 3.106227     ┆ 119  ┆ 4            │
│ TRBUSDT   ┆ 3.203777     ┆ 120  ┆ 3            │
│ RUNEUSDT  ┆ 3.710694     ┆ 121  ┆ 2            │
│ SPELLUSDT ┆ 4.918382     ┆ 122  ┆ 1            │
│ TRXUSDT   ┆ 5.399435     ┆ 123  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,519 - INFO - cur close time: 2023-09-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:20,519 - DEBUG - mean expected ret (mean factor): -0.09748244840130275
2024-12-12 23:54:20,521 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,521 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,521 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01703     ┆ 0.06024     ┆ 0.0007839   ┆ … ┆ 0.01595 ┆ null   ┆ null    ┆ 0.1642  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,530 - DEBUG - update position: 2023-09-02T23:59:59.999 === diff_trading_value: 342073.208503963 == cash: 122186.58228052367 
2024-12-12 23:54:20,532 - INFO - pnl: 2023-09-02T23:59:59.999 122186.58228052367 === -2.946%
2024-12-12 23:54:20,534 - DEBUG - cur time: 2023-09-03T23:59:59.999 == next bar open time: 2023-09-04T00:00:00.000 == close pos time: 2023-09-09T00:00:00.000
2024-12-12 23:54:20,536 - INFO - pnl: 2023-09-03T23:59:59.999 121036.98763062475 === -0.941%
2024-12-12 23:54:20,538 - DEBUG - cur time: 2023-09-04T23:59:59.999 == next bar open time: 2023-09-05T00:00:00.000 == close pos time: 2023-09-10T00:00:00.000
2024-12-12 23:54:20,539 - INFO - pnl: 2023-09-04T23:59:59.999 120347.74653151749 === -0.569%
2024-12-12 23:54:20,542 - DEBUG - cur time: 2023-09-05T23:59:59.999 == next bar open time: 2023-09-06T00:00:00.000 == close pos time: 2023-09-11T00:00:00.000
2024-12-12 23:54:20,543 - INFO - pnl: 2023-09-05T23:59:59.999 119489.48808965144 === -0.713%
2024-12-12 23:54:20,545 - DEBUG - cur time: 2023-09-06T23:59:59.999 == next bar open time: 2023-09-07T00:00:00.000 == close pos time: 2023-09-12T00:00:00.000
2024-12-12 23:54:20,546 - INFO - pnl: 2023-09-06T23:59:59.999 119255.77138307376 === -0.196%
2024-12-12 23:54:20,549 - DEBUG - cur time: 2023-09-07T23:59:59.999 == next bar open time: 2023-09-08T00:00:00.000 == close pos time: 2023-09-13T00:00:00.000
2024-12-12 23:54:20,559 - DEBUG - close time 2023-09-07T23:59:59.999 == vol_threshold: 14990463.079999996
2024-12-12 23:54:20,559 - DEBUG - 2023-09-07T23:59:59.999 == all trade symbol 177 == remain 124 after VOL filter
2024-12-12 23:54:20,562 - DEBUG - sorted_long_factors: shape: (124, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ACHUSDT   ┆ -4.219073    ┆ 0    ┆ 123          │
│ EDUUSDT   ┆ -3.375888    ┆ 1    ┆ 122          │
│ BATUSDT   ┆ -3.100066    ┆ 2    ┆ 121          │
│ IOSTUSDT  ┆ -3.064871    ┆ 3    ┆ 120          │
│ LUNA2USDT ┆ -2.342686    ┆ 4    ┆ 119          │
│ KNCUSDT   ┆ -2.293822    ┆ 5    ┆ 118          │
│ MAGICUSDT ┆ -2.104959    ┆ 6    ┆ 117          │
│ ASTRUSDT  ┆ -2.062094    ┆ 7    ┆ 116          │
│ IDUSDT    ┆ -2.030095    ┆ 8    ┆ 115          │
│ XRPUSDT   ┆ -1.866235    ┆ 9    ┆ 114          │
│ …         ┆ …            ┆ …    ┆ …            │
│ FLOWUSDT  ┆ 3.119359     ┆ 114  ┆ 9            │
│ HOOKUSDT  ┆ 3.13392      ┆ 115  ┆ 8            │
│ BLURUSDT  ┆ 3.36931      ┆ 116  ┆ 7            │
│ VETUSDT   ┆ 3.40842      ┆ 117  ┆ 6            │
│ MANAUSDT  ┆ 3.56332      ┆ 118  ┆ 5            │
│ TRXUSDT   ┆ 3.710028     ┆ 119  ┆ 4            │
│ DGBUSDT   ┆ 3.74842      ┆ 120  ┆ 3            │
│ PERPUSDT  ┆ 4.121184     ┆ 121  ┆ 2            │
│ TRBUSDT   ┆ 4.525965     ┆ 122  ┆ 1            │
│ OGNUSDT   ┆ 5.665191     ┆ 123  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,566 - WARNING - 2023-09-07T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,566 - INFO - cur close time: 2023-09-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:20,566 - DEBUG - mean expected ret (mean factor): 0.24474079210743171
2024-12-12 23:54:20,570 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,570 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,570 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01719     ┆ 0.06095     ┆ 0.0008083   ┆ … ┆ 0.0166  ┆ null   ┆ null    ┆ 0.1705  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,580 - DEBUG - update position: 2023-09-07T23:59:59.999 === diff_trading_value: 344729.2654639494 == cash: 119886.20496962336 
2024-12-12 23:54:20,581 - INFO - pnl: 2023-09-07T23:59:59.999 119886.20496962336 === 0.529%
2024-12-12 23:54:20,584 - DEBUG - cur time: 2023-09-08T23:59:59.999 == next bar open time: 2023-09-09T00:00:00.000 == close pos time: 2023-09-14T00:00:00.000
2024-12-12 23:54:20,585 - INFO - pnl: 2023-09-08T23:59:59.999 117962.25722199376 === -1.605%
2024-12-12 23:54:20,588 - DEBUG - cur time: 2023-09-09T23:59:59.999 == next bar open time: 2023-09-10T00:00:00.000 == close pos time: 2023-09-15T00:00:00.000
2024-12-12 23:54:20,589 - INFO - pnl: 2023-09-09T23:59:59.999 115520.83772143349 === -2.070%
2024-12-12 23:54:20,592 - DEBUG - cur time: 2023-09-10T23:59:59.999 == next bar open time: 2023-09-11T00:00:00.000 == close pos time: 2023-09-16T00:00:00.000
2024-12-12 23:54:20,594 - INFO - pnl: 2023-09-10T23:59:59.999 117221.56610250172 === 1.472%
2024-12-12 23:54:20,596 - DEBUG - cur time: 2023-09-11T23:59:59.999 == next bar open time: 2023-09-12T00:00:00.000 == close pos time: 2023-09-17T00:00:00.000
2024-12-12 23:54:20,596 - INFO - pnl: 2023-09-11T23:59:59.999 117831.07841657149 === 0.520%
2024-12-12 23:54:20,600 - DEBUG - cur time: 2023-09-12T23:59:59.999 == next bar open time: 2023-09-13T00:00:00.000 == close pos time: 2023-09-18T00:00:00.000
2024-12-12 23:54:20,611 - DEBUG - close time 2023-09-12T23:59:59.999 == vol_threshold: 23128393.279999997
2024-12-12 23:54:20,611 - DEBUG - 2023-09-12T23:59:59.999 == all trade symbol 179 == remain 125 after VOL filter
2024-12-12 23:54:20,614 - DEBUG - sorted_long_factors: shape: (125, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ IDEXUSDT  ┆ -4.72573     ┆ 0    ┆ 124          │
│ MAVUSDT   ┆ -4.683371    ┆ 1    ┆ 123          │
│ WOOUSDT   ┆ -4.107603    ┆ 2    ┆ 122          │
│ STXUSDT   ┆ -3.77832     ┆ 3    ┆ 121          │
│ MDTUSDT   ┆ -3.620087    ┆ 4    ┆ 120          │
│ TUSDT     ┆ -3.271784    ┆ 5    ┆ 119          │
│ COTIUSDT  ┆ -2.919339    ┆ 6    ┆ 118          │
│ BLURUSDT  ┆ -2.818193    ┆ 7    ┆ 117          │
│ XLMUSDT   ┆ -2.803762    ┆ 8    ┆ 116          │
│ ARPAUSDT  ┆ -2.770682    ┆ 9    ┆ 115          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ALGOUSDT  ┆ 2.057707     ┆ 115  ┆ 9            │
│ PERPUSDT  ┆ 2.142701     ┆ 116  ┆ 8            │
│ SPELLUSDT ┆ 2.145413     ┆ 117  ┆ 7            │
│ OGNUSDT   ┆ 2.284534     ┆ 118  ┆ 6            │
│ RUNEUSDT  ┆ 2.43707      ┆ 119  ┆ 5            │
│ ATAUSDT   ┆ 2.742806     ┆ 120  ┆ 4            │
│ NEARUSDT  ┆ 2.940243     ┆ 121  ┆ 3            │
│ FLMUSDT   ┆ 3.087181     ┆ 122  ┆ 2            │
│ SUSHIUSDT ┆ 3.334303     ┆ 123  ┆ 1            │
│ STORJUSDT ┆ 3.422874     ┆ 124  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,620 - WARNING - 2023-09-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,620 - INFO - cur close time: 2023-09-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:20,620 - DEBUG - mean expected ret (mean factor): -0.3145622496434789
2024-12-12 23:54:20,622 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,622 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,622 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01568     ┆ 0.05709     ┆ 0.0006714   ┆ … ┆ 0.01521 ┆ null   ┆ null    ┆ 0.1646  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,631 - DEBUG - update position: 2023-09-12T23:59:59.999 === diff_trading_value: 352798.57420364907 == cash: 118708.42909143836 
2024-12-12 23:54:20,632 - INFO - pnl: 2023-09-12T23:59:59.999 118708.42909143836 === 0.745%
2024-12-12 23:54:20,635 - DEBUG - cur time: 2023-09-13T23:59:59.999 == next bar open time: 2023-09-14T00:00:00.000 == close pos time: 2023-09-19T00:00:00.000
2024-12-12 23:54:20,636 - INFO - pnl: 2023-09-13T23:59:59.999 119452.250859016 === 0.627%
2024-12-12 23:54:20,638 - DEBUG - cur time: 2023-09-14T23:59:59.999 == next bar open time: 2023-09-15T00:00:00.000 == close pos time: 2023-09-20T00:00:00.000
2024-12-12 23:54:20,638 - INFO - pnl: 2023-09-14T23:59:59.999 121207.30883872684 === 1.469%
2024-12-12 23:54:20,642 - DEBUG - cur time: 2023-09-15T23:59:59.999 == next bar open time: 2023-09-16T00:00:00.000 == close pos time: 2023-09-21T00:00:00.000
2024-12-12 23:54:20,643 - INFO - pnl: 2023-09-15T23:59:59.999 123458.95995466452 === 1.858%
2024-12-12 23:54:20,646 - DEBUG - cur time: 2023-09-16T23:59:59.999 == next bar open time: 2023-09-17T00:00:00.000 == close pos time: 2023-09-22T00:00:00.000
2024-12-12 23:54:20,646 - INFO - pnl: 2023-09-16T23:59:59.999 121103.64601904432 === -1.908%
2024-12-12 23:54:20,649 - DEBUG - cur time: 2023-09-17T23:59:59.999 == next bar open time: 2023-09-18T00:00:00.000 == close pos time: 2023-09-23T00:00:00.000
2024-12-12 23:54:20,658 - DEBUG - close time 2023-09-17T23:59:59.999 == vol_threshold: 16269462.879999999
2024-12-12 23:54:20,660 - DEBUG - 2023-09-17T23:59:59.999 == all trade symbol 180 == remain 126 after VOL filter
2024-12-12 23:54:20,661 - DEBUG - sorted_long_factors: shape: (126, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ MDTUSDT   ┆ -5.253763    ┆ 0    ┆ 125          │
│ MAVUSDT   ┆ -5.124005    ┆ 1    ┆ 124          │
│ CTSIUSDT  ┆ -3.702932    ┆ 2    ┆ 123          │
│ EDUUSDT   ┆ -3.430707    ┆ 3    ┆ 122          │
│ ACHUSDT   ┆ -3.424099    ┆ 4    ┆ 121          │
│ TRUUSDT   ┆ -3.309652    ┆ 5    ┆ 120          │
│ REEFUSDT  ┆ -3.286323    ┆ 6    ┆ 119          │
│ COTIUSDT  ┆ -3.254876    ┆ 7    ┆ 118          │
│ AMBUSDT   ┆ -3.145954    ┆ 8    ┆ 117          │
│ FETUSDT   ┆ -3.096417    ┆ 9    ┆ 116          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CRVUSDT   ┆ 3.029344     ┆ 116  ┆ 9            │
│ STGUSDT   ┆ 3.047063     ┆ 117  ┆ 8            │
│ ICXUSDT   ┆ 3.050198     ┆ 118  ┆ 7            │
│ JASMYUSDT ┆ 3.128592     ┆ 119  ┆ 6            │
│ STORJUSDT ┆ 3.381789     ┆ 120  ┆ 5            │
│ IOTXUSDT  ┆ 3.446548     ┆ 121  ┆ 4            │
│ OMGUSDT   ┆ 3.528077     ┆ 122  ┆ 3            │
│ TRXUSDT   ┆ 3.590183     ┆ 123  ┆ 2            │
│ DGBUSDT   ┆ 4.049738     ┆ 124  ┆ 1            │
│ BLZUSDT   ┆ 4.566126     ┆ 125  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,665 - WARNING - 2023-09-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,665 - INFO - cur close time: 2023-09-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:20,665 - DEBUG - mean expected ret (mean factor): -0.01010384488589707
2024-12-12 23:54:20,670 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,670 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,670 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01555     ┆ 0.05734     ┆ 0.0006271   ┆ … ┆ 0.01585 ┆ null   ┆ null    ┆ 0.179   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,676 - DEBUG - update position: 2023-09-17T23:59:59.999 === diff_trading_value: 288869.0893178438 == cash: 122190.5763310236 
2024-12-12 23:54:20,676 - INFO - pnl: 2023-09-17T23:59:59.999 122190.5763310236 === 0.898%
2024-12-12 23:54:20,680 - DEBUG - cur time: 2023-09-18T23:59:59.999 == next bar open time: 2023-09-19T00:00:00.000 == close pos time: 2023-09-24T00:00:00.000
2024-12-12 23:54:20,682 - INFO - pnl: 2023-09-18T23:59:59.999 122178.85960998794 === -0.010%
2024-12-12 23:54:20,684 - DEBUG - cur time: 2023-09-19T23:59:59.999 == next bar open time: 2023-09-20T00:00:00.000 == close pos time: 2023-09-25T00:00:00.000
2024-12-12 23:54:20,685 - INFO - pnl: 2023-09-19T23:59:59.999 122628.22495921797 === 0.368%
2024-12-12 23:54:20,688 - DEBUG - cur time: 2023-09-20T23:59:59.999 == next bar open time: 2023-09-21T00:00:00.000 == close pos time: 2023-09-26T00:00:00.000
2024-12-12 23:54:20,689 - INFO - pnl: 2023-09-20T23:59:59.999 122877.80333528842 === 0.204%
2024-12-12 23:54:20,692 - DEBUG - cur time: 2023-09-21T23:59:59.999 == next bar open time: 2023-09-22T00:00:00.000 == close pos time: 2023-09-27T00:00:00.000
2024-12-12 23:54:20,694 - INFO - pnl: 2023-09-21T23:59:59.999 122899.72576088176 === 0.018%
2024-12-12 23:54:20,696 - DEBUG - cur time: 2023-09-22T23:59:59.999 == next bar open time: 2023-09-23T00:00:00.000 == close pos time: 2023-09-28T00:00:00.000
2024-12-12 23:54:20,703 - DEBUG - close time 2023-09-22T23:59:59.999 == vol_threshold: 13672981.889999997
2024-12-12 23:54:20,703 - DEBUG - 2023-09-22T23:59:59.999 == all trade symbol 180 == remain 126 after VOL filter
2024-12-12 23:54:20,707 - DEBUG - sorted_long_factors: shape: (126, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ NKNUSDT     ┆ -5.292431    ┆ 0    ┆ 125          │
│ IOTXUSDT    ┆ -4.113566    ┆ 1    ┆ 124          │
│ RVNUSDT     ┆ -3.70976     ┆ 2    ┆ 123          │
│ CKBUSDT     ┆ -3.408395    ┆ 3    ┆ 122          │
│ IDEXUSDT    ┆ -3.26441     ┆ 4    ┆ 121          │
│ LITUSDT     ┆ -3.20859     ┆ 5    ┆ 120          │
│ MDTUSDT     ┆ -3.058192    ┆ 6    ┆ 119          │
│ JASMYUSDT   ┆ -3.004447    ┆ 7    ┆ 118          │
│ EDUUSDT     ┆ -2.806924    ┆ 8    ┆ 117          │
│ FETUSDT     ┆ -2.735126    ┆ 9    ┆ 116          │
│ …           ┆ …            ┆ …    ┆ …            │
│ FLMUSDT     ┆ 2.911594     ┆ 116  ┆ 9            │
│ STORJUSDT   ┆ 3.052873     ┆ 117  ┆ 8            │
│ TRXUSDT     ┆ 3.103402     ┆ 118  ┆ 7            │
│ 1000XECUSDT ┆ 3.178668     ┆ 119  ┆ 6            │
│ ANKRUSDT    ┆ 3.43908      ┆ 120  ┆ 5            │
│ TRBUSDT     ┆ 3.940499     ┆ 121  ┆ 4            │
│ ARPAUSDT    ┆ 4.772049     ┆ 122  ┆ 3            │
│ LRCUSDT     ┆ 4.792618     ┆ 123  ┆ 2            │
│ DARUSDT     ┆ 4.951165     ┆ 124  ┆ 1            │
│ ADAUSDT     ┆ 6.710639     ┆ 125  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,712 - WARNING - 2023-09-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,712 - INFO - cur close time: 2023-09-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:20,712 - DEBUG - mean expected ret (mean factor): 0.044004689897395456
2024-12-12 23:54:20,716 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,716 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,720 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01616     ┆ 0.06059     ┆ 0.0007144   ┆ … ┆ 0.01791 ┆ null   ┆ null    ┆ 0.1868  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,723 - DEBUG - update position: 2023-09-22T23:59:59.999 === diff_trading_value: 298956.8847775629 == cash: 121674.05829675002 
2024-12-12 23:54:20,723 - INFO - pnl: 2023-09-22T23:59:59.999 121674.05829675002 === -0.997%
2024-12-12 23:54:20,730 - DEBUG - cur time: 2023-09-23T23:59:59.999 == next bar open time: 2023-09-24T00:00:00.000 == close pos time: 2023-09-29T00:00:00.000
2024-12-12 23:54:20,731 - INFO - pnl: 2023-09-23T23:59:59.999 119534.72736486854 === -1.758%
2024-12-12 23:54:20,735 - DEBUG - cur time: 2023-09-24T23:59:59.999 == next bar open time: 2023-09-25T00:00:00.000 == close pos time: 2023-09-30T00:00:00.000
2024-12-12 23:54:20,736 - INFO - pnl: 2023-09-24T23:59:59.999 119313.0136835094 === -0.185%
2024-12-12 23:54:20,738 - DEBUG - cur time: 2023-09-25T23:59:59.999 == next bar open time: 2023-09-26T00:00:00.000 == close pos time: 2023-10-01T00:00:00.000
2024-12-12 23:54:20,740 - INFO - pnl: 2023-09-25T23:59:59.999 119499.06983620655 === 0.156%
2024-12-12 23:54:20,745 - DEBUG - cur time: 2023-09-26T23:59:59.999 == next bar open time: 2023-09-27T00:00:00.000 == close pos time: 2023-10-02T00:00:00.000
2024-12-12 23:54:20,746 - INFO - pnl: 2023-09-26T23:59:59.999 121113.21003083613 === 1.351%
2024-12-12 23:54:20,749 - DEBUG - cur time: 2023-09-27T23:59:59.999 == next bar open time: 2023-09-28T00:00:00.000 == close pos time: 2023-10-03T00:00:00.000
2024-12-12 23:54:20,759 - DEBUG - close time 2023-09-27T23:59:59.999 == vol_threshold: 17742493.999999996
2024-12-12 23:54:20,759 - DEBUG - 2023-09-27T23:59:59.999 == all trade symbol 180 == remain 126 after VOL filter
2024-12-12 23:54:20,762 - DEBUG - sorted_long_factors: shape: (126, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ LINAUSDT  ┆ -4.597988    ┆ 0    ┆ 125          │
│ MDTUSDT   ┆ -4.480146    ┆ 1    ┆ 124          │
│ BNXUSDT   ┆ -3.98743     ┆ 2    ┆ 123          │
│ ENJUSDT   ┆ -3.952897    ┆ 3    ┆ 122          │
│ XVGUSDT   ┆ -3.659322    ┆ 4    ┆ 121          │
│ MAVUSDT   ┆ -3.529642    ┆ 5    ┆ 120          │
│ ACHUSDT   ┆ -3.329862    ┆ 6    ┆ 119          │
│ STXUSDT   ┆ -3.095124    ┆ 7    ┆ 118          │
│ LRCUSDT   ┆ -2.931214    ┆ 8    ┆ 117          │
│ RVNUSDT   ┆ -2.636933    ┆ 9    ┆ 116          │
│ …         ┆ …            ┆ …    ┆ …            │
│ API3USDT  ┆ 3.076809     ┆ 116  ┆ 9            │
│ STMXUSDT  ┆ 3.111317     ┆ 117  ┆ 8            │
│ ONEUSDT   ┆ 3.135089     ┆ 118  ┆ 7            │
│ KNCUSDT   ┆ 3.194699     ┆ 119  ┆ 6            │
│ STORJUSDT ┆ 3.308012     ┆ 120  ┆ 5            │
│ LUNA2USDT ┆ 3.560673     ┆ 121  ┆ 4            │
│ TRXUSDT   ┆ 3.659664     ┆ 122  ┆ 3            │
│ TOMOUSDT  ┆ 4.108165     ┆ 123  ┆ 2            │
│ CELOUSDT  ┆ 4.935758     ┆ 124  ┆ 1            │
│ TRBUSDT   ┆ 6.676012     ┆ 125  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,766 - INFO - cur close time: 2023-09-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:20,766 - DEBUG - mean expected ret (mean factor): 0.05342210521782083
2024-12-12 23:54:20,770 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,770 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,770 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01564     ┆ 0.06518     ┆ 0.0007353   ┆ … ┆ 0.01676 ┆ null   ┆ null    ┆ 0.1848  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,775 - DEBUG - update position: 2023-09-27T23:59:59.999 === diff_trading_value: 309846.96378496976 == cash: 122562.74046878378 
2024-12-12 23:54:20,778 - INFO - pnl: 2023-09-27T23:59:59.999 122562.74046878378 === 1.197%
2024-12-12 23:54:20,782 - DEBUG - cur time: 2023-09-28T23:59:59.999 == next bar open time: 2023-09-29T00:00:00.000 == close pos time: 2023-10-04T00:00:00.000
2024-12-12 23:54:20,783 - INFO - pnl: 2023-09-28T23:59:59.999 119202.3392492038 === -2.742%
2024-12-12 23:54:20,787 - DEBUG - cur time: 2023-09-29T23:59:59.999 == next bar open time: 2023-09-30T00:00:00.000 == close pos time: 2023-10-05T00:00:00.000
2024-12-12 23:54:20,788 - INFO - pnl: 2023-09-29T23:59:59.999 118963.10893641997 === -0.201%
2024-12-12 23:54:20,792 - DEBUG - cur time: 2023-09-30T23:59:59.999 == next bar open time: 2023-10-01T00:00:00.000 == close pos time: 2023-10-06T00:00:00.000
2024-12-12 23:54:20,793 - INFO - pnl: 2023-09-30T23:59:59.999 118669.6412494611 === -0.247%
2024-12-12 23:54:20,796 - DEBUG - cur time: 2023-10-01T23:59:59.999 == next bar open time: 2023-10-02T00:00:00.000 == close pos time: 2023-10-07T00:00:00.000
2024-12-12 23:54:20,796 - INFO - pnl: 2023-10-01T23:59:59.999 120868.93473736002 === 1.853%
2024-12-12 23:54:20,801 - DEBUG - cur time: 2023-10-02T23:59:59.999 == next bar open time: 2023-10-03T00:00:00.000 == close pos time: 2023-10-08T00:00:00.000
2024-12-12 23:54:20,817 - DEBUG - close time 2023-10-02T23:59:59.999 == vol_threshold: 24326941.76
2024-12-12 23:54:20,817 - DEBUG - 2023-10-02T23:59:59.999 == all trade symbol 180 == remain 126 after VOL filter
2024-12-12 23:54:20,820 - DEBUG - sorted_long_factors: shape: (126, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ MAVUSDT   ┆ -4.290524    ┆ 0    ┆ 125          │
│ COTIUSDT  ┆ -3.534383    ┆ 1    ┆ 124          │
│ IDUSDT    ┆ -3.404584    ┆ 2    ┆ 123          │
│ ARPAUSDT  ┆ -3.301689    ┆ 3    ┆ 122          │
│ SUIUSDT   ┆ -3.20307     ┆ 4    ┆ 121          │
│ JASMYUSDT ┆ -3.100571    ┆ 5    ┆ 120          │
│ EDUUSDT   ┆ -3.032196    ┆ 6    ┆ 119          │
│ DUSKUSDT  ┆ -2.765905    ┆ 7    ┆ 118          │
│ CTSIUSDT  ┆ -2.660779    ┆ 8    ┆ 117          │
│ NKNUSDT   ┆ -2.474939    ┆ 9    ┆ 116          │
│ …         ┆ …            ┆ …    ┆ …            │
│ TRXUSDT   ┆ 3.00679      ┆ 116  ┆ 9            │
│ ALGOUSDT  ┆ 3.235791     ┆ 117  ┆ 8            │
│ STORJUSDT ┆ 3.647079     ┆ 118  ┆ 7            │
│ KNCUSDT   ┆ 3.715451     ┆ 119  ┆ 6            │
│ XEMUSDT   ┆ 3.735289     ┆ 120  ┆ 5            │
│ BAKEUSDT  ┆ 3.74507      ┆ 121  ┆ 4            │
│ STMXUSDT  ┆ 4.077588     ┆ 122  ┆ 3            │
│ BLZUSDT   ┆ 4.593504     ┆ 123  ┆ 2            │
│ ZRXUSDT   ┆ 5.234728     ┆ 124  ┆ 1            │
│ LEVERUSDT ┆ 5.34733      ┆ 125  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,830 - WARNING - 2023-10-02T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,830 - INFO - cur close time: 2023-10-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:20,830 - DEBUG - mean expected ret (mean factor): 0.07347130003853214
2024-12-12 23:54:20,834 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,834 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,834 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01898     ┆ 0.06151     ┆ 0.0007428   ┆ … ┆ 0.01718 ┆ null   ┆ null    ┆ 0.1901  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,842 - DEBUG - update position: 2023-10-02T23:59:59.999 === diff_trading_value: 312928.26347719535 == cash: 122765.70804326702 
2024-12-12 23:54:20,843 - INFO - pnl: 2023-10-02T23:59:59.999 122765.70804326702 === 1.569%
2024-12-12 23:54:20,846 - DEBUG - cur time: 2023-10-03T23:59:59.999 == next bar open time: 2023-10-04T00:00:00.000 == close pos time: 2023-10-09T00:00:00.000
2024-12-12 23:54:20,846 - INFO - pnl: 2023-10-03T23:59:59.999 122832.03809968641 === 0.054%
2024-12-12 23:54:20,850 - DEBUG - cur time: 2023-10-04T23:59:59.999 == next bar open time: 2023-10-05T00:00:00.000 == close pos time: 2023-10-10T00:00:00.000
2024-12-12 23:54:20,854 - INFO - pnl: 2023-10-04T23:59:59.999 121714.94027500677 === -0.909%
2024-12-12 23:54:20,860 - DEBUG - cur time: 2023-10-05T23:59:59.999 == next bar open time: 2023-10-06T00:00:00.000 == close pos time: 2023-10-11T00:00:00.000
2024-12-12 23:54:20,860 - INFO - pnl: 2023-10-05T23:59:59.999 124081.63022041626 === 1.944%
2024-12-12 23:54:20,862 - DEBUG - cur time: 2023-10-06T23:59:59.999 == next bar open time: 2023-10-07T00:00:00.000 == close pos time: 2023-10-12T00:00:00.000
2024-12-12 23:54:20,866 - INFO - pnl: 2023-10-06T23:59:59.999 125181.35643005525 === 0.886%
2024-12-12 23:54:20,870 - DEBUG - cur time: 2023-10-07T23:59:59.999 == next bar open time: 2023-10-08T00:00:00.000 == close pos time: 2023-10-13T00:00:00.000
2024-12-12 23:54:20,880 - DEBUG - close time 2023-10-07T23:59:59.999 == vol_threshold: 9210388.68
2024-12-12 23:54:20,881 - DEBUG - 2023-10-07T23:59:59.999 == all trade symbol 183 == remain 128 after VOL filter
2024-12-12 23:54:20,882 - DEBUG - sorted_long_factors: shape: (128, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ IDEXUSDT      ┆ -4.880874    ┆ 0    ┆ 127          │
│ IOSTUSDT      ┆ -4.624626    ┆ 1    ┆ 126          │
│ ASTRUSDT      ┆ -3.671913    ┆ 2    ┆ 125          │
│ IOTAUSDT      ┆ -3.408883    ┆ 3    ┆ 124          │
│ XRPUSDT       ┆ -3.296673    ┆ 4    ┆ 123          │
│ KEYUSDT       ┆ -3.276865    ┆ 5    ┆ 122          │
│ MDTUSDT       ┆ -3.134939    ┆ 6    ┆ 121          │
│ KAVAUSDT      ┆ -2.704353    ┆ 7    ┆ 120          │
│ COTIUSDT      ┆ -2.695299    ┆ 8    ┆ 119          │
│ LUNA2USDT     ┆ -2.475963    ┆ 9    ┆ 118          │
│ …             ┆ …            ┆ …    ┆ …            │
│ DENTUSDT      ┆ 2.432194     ┆ 118  ┆ 9            │
│ STORJUSDT     ┆ 2.544914     ┆ 119  ┆ 8            │
│ DYDXUSDT      ┆ 2.817359     ┆ 120  ┆ 7            │
│ BAKEUSDT      ┆ 2.925281     ┆ 121  ┆ 6            │
│ STGUSDT       ┆ 3.064957     ┆ 122  ┆ 5            │
│ LRCUSDT       ┆ 3.06503      ┆ 123  ┆ 4            │
│ 1000FLOKIUSDT ┆ 3.345911     ┆ 124  ┆ 3            │
│ TRBUSDT       ┆ 3.369705     ┆ 125  ┆ 2            │
│ LITUSDT       ┆ 4.284612     ┆ 126  ┆ 1            │
│ ONTUSDT       ┆ 4.722885     ┆ 127  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,887 - WARNING - 2023-10-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,888 - INFO - cur close time: 2023-10-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:20,888 - DEBUG - mean expected ret (mean factor): 0.01604099764322503
2024-12-12 23:54:20,892 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,892 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,892 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01823     ┆ 0.05856     ┆ 0.000708    ┆ … ┆ 0.01692 ┆ null   ┆ null    ┆ 0.1849  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,896 - DEBUG - update position: 2023-10-07T23:59:59.999 === diff_trading_value: 304337.9207710955 == cash: 124842.73379790301 
2024-12-12 23:54:20,899 - INFO - pnl: 2023-10-07T23:59:59.999 124842.73379790301 === -0.271%
2024-12-12 23:54:20,900 - DEBUG - cur time: 2023-10-08T23:59:59.999 == next bar open time: 2023-10-09T00:00:00.000 == close pos time: 2023-10-14T00:00:00.000
2024-12-12 23:54:20,904 - INFO - pnl: 2023-10-08T23:59:59.999 122732.50964728431 === -1.690%
2024-12-12 23:54:20,908 - DEBUG - cur time: 2023-10-09T23:59:59.999 == next bar open time: 2023-10-10T00:00:00.000 == close pos time: 2023-10-15T00:00:00.000
2024-12-12 23:54:20,910 - INFO - pnl: 2023-10-09T23:59:59.999 125691.91541147037 === 2.411%
2024-12-12 23:54:20,913 - DEBUG - cur time: 2023-10-10T23:59:59.999 == next bar open time: 2023-10-11T00:00:00.000 == close pos time: 2023-10-16T00:00:00.000
2024-12-12 23:54:20,913 - INFO - pnl: 2023-10-10T23:59:59.999 124788.8999456002 === -0.718%
2024-12-12 23:54:20,917 - DEBUG - cur time: 2023-10-11T23:59:59.999 == next bar open time: 2023-10-12T00:00:00.000 == close pos time: 2023-10-17T00:00:00.000
2024-12-12 23:54:20,919 - INFO - pnl: 2023-10-11T23:59:59.999 125586.02048282362 === 0.639%
2024-12-12 23:54:20,923 - DEBUG - cur time: 2023-10-12T23:59:59.999 == next bar open time: 2023-10-13T00:00:00.000 == close pos time: 2023-10-18T00:00:00.000
2024-12-12 23:54:20,950 - DEBUG - close time 2023-10-12T23:59:59.999 == vol_threshold: 15746079.079999998
2024-12-12 23:54:20,952 - DEBUG - 2023-10-12T23:59:59.999 == all trade symbol 184 == remain 129 after VOL filter
2024-12-12 23:54:20,956 - DEBUG - sorted_long_factors: shape: (129, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ ARKMUSDT      ┆ -3.754099    ┆ 0    ┆ 128          │
│ XVGUSDT       ┆ -3.365397    ┆ 1    ┆ 127          │
│ COTIUSDT      ┆ -3.089279    ┆ 2    ┆ 126          │
│ CKBUSDT       ┆ -2.993885    ┆ 3    ┆ 125          │
│ IDUSDT        ┆ -2.929471    ┆ 4    ┆ 124          │
│ JOEUSDT       ┆ -2.898283    ┆ 5    ┆ 123          │
│ SUIUSDT       ┆ -2.822257    ┆ 6    ┆ 122          │
│ XRPUSDT       ┆ -2.814726    ┆ 7    ┆ 121          │
│ TRUUSDT       ┆ -2.686411    ┆ 8    ┆ 120          │
│ MAVUSDT       ┆ -2.623474    ┆ 9    ┆ 119          │
│ …             ┆ …            ┆ …    ┆ …            │
│ BNXUSDT       ┆ 2.750131     ┆ 119  ┆ 9            │
│ STXUSDT       ┆ 2.956248     ┆ 120  ┆ 8            │
│ 1000FLOKIUSDT ┆ 3.184732     ┆ 121  ┆ 7            │
│ BLZUSDT       ┆ 3.338719     ┆ 122  ┆ 6            │
│ VETUSDT       ┆ 3.425989     ┆ 123  ┆ 5            │
│ C98USDT       ┆ 3.652137     ┆ 124  ┆ 4            │
│ IOTAUSDT      ┆ 4.144442     ┆ 125  ┆ 3            │
│ LRCUSDT       ┆ 4.624914     ┆ 126  ┆ 2            │
│ LQTYUSDT      ┆ 5.38031      ┆ 127  ┆ 1            │
│ KEYUSDT       ┆ 8.604458     ┆ 128  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:20,971 - WARNING - 2023-10-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:20,972 - INFO - cur close time: 2023-10-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:20,972 - DEBUG - mean expected ret (mean factor): 0.01976967412763869
2024-12-12 23:54:20,982 - DEBUG - begin to update pos: =========
2024-12-12 23:54:20,983 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,983 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01734     ┆ 0.05691     ┆ 0.0006255   ┆ … ┆ 0.01581 ┆ null   ┆ null    ┆ 0.1879  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:20,993 - DEBUG - update position: 2023-10-12T23:59:59.999 === diff_trading_value: 300678.72924589505 == cash: 125593.5455201106 
2024-12-12 23:54:20,998 - INFO - pnl: 2023-10-12T23:59:59.999 125593.5455201106 === 0.006%
2024-12-12 23:54:21,003 - DEBUG - cur time: 2023-10-13T23:59:59.999 == next bar open time: 2023-10-14T00:00:00.000 == close pos time: 2023-10-19T00:00:00.000
2024-12-12 23:54:21,005 - INFO - pnl: 2023-10-13T23:59:59.999 126535.21417448764 === 0.750%
2024-12-12 23:54:21,010 - DEBUG - cur time: 2023-10-14T23:59:59.999 == next bar open time: 2023-10-15T00:00:00.000 == close pos time: 2023-10-20T00:00:00.000
2024-12-12 23:54:21,015 - INFO - pnl: 2023-10-14T23:59:59.999 127726.21403269119 === 0.941%
2024-12-12 23:54:21,022 - DEBUG - cur time: 2023-10-15T23:59:59.999 == next bar open time: 2023-10-16T00:00:00.000 == close pos time: 2023-10-21T00:00:00.000
2024-12-12 23:54:21,023 - INFO - pnl: 2023-10-15T23:59:59.999 128346.8863707409 === 0.486%
2024-12-12 23:54:21,031 - DEBUG - cur time: 2023-10-16T23:59:59.999 == next bar open time: 2023-10-17T00:00:00.000 == close pos time: 2023-10-22T00:00:00.000
2024-12-12 23:54:21,034 - INFO - pnl: 2023-10-16T23:59:59.999 129348.38537646864 === 0.780%
2024-12-12 23:54:21,041 - DEBUG - cur time: 2023-10-17T23:59:59.999 == next bar open time: 2023-10-18T00:00:00.000 == close pos time: 2023-10-23T00:00:00.000
2024-12-12 23:54:21,062 - DEBUG - close time 2023-10-17T23:59:59.999 == vol_threshold: 19583215.14
2024-12-12 23:54:21,062 - DEBUG - 2023-10-17T23:59:59.999 == all trade symbol 185 == remain 129 after VOL filter
2024-12-12 23:54:21,065 - DEBUG - sorted_long_factors: shape: (129, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ARKMUSDT     ┆ -4.698238    ┆ 0    ┆ 128          │
│ HFTUSDT      ┆ -4.368991    ┆ 1    ┆ 127          │
│ LUNA2USDT    ┆ -3.505924    ┆ 2    ┆ 126          │
│ 1000PEPEUSDT ┆ -3.393177    ┆ 3    ┆ 125          │
│ OMGUSDT      ┆ -3.384417    ┆ 4    ┆ 124          │
│ ASTRUSDT     ┆ -3.113554    ┆ 5    ┆ 123          │
│ RDNTUSDT     ┆ -3.005499    ┆ 6    ┆ 122          │
│ MAVUSDT      ┆ -2.892013    ┆ 7    ┆ 121          │
│ NKNUSDT      ┆ -2.866627    ┆ 8    ┆ 120          │
│ ARBUSDT      ┆ -2.796334    ┆ 9    ┆ 119          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RNDRUSDT     ┆ 3.369802     ┆ 119  ┆ 9            │
│ LRCUSDT      ┆ 3.485299     ┆ 120  ┆ 8            │
│ HBARUSDT     ┆ 3.70012      ┆ 121  ┆ 7            │
│ LDOUSDT      ┆ 3.893491     ┆ 122  ┆ 6            │
│ BLZUSDT      ┆ 4.029753     ┆ 123  ┆ 5            │
│ HOTUSDT      ┆ 4.423288     ┆ 124  ┆ 4            │
│ TUSDT        ┆ 4.452645     ┆ 125  ┆ 3            │
│ LQTYUSDT     ┆ 4.525789     ┆ 126  ┆ 2            │
│ XEMUSDT      ┆ 4.812641     ┆ 127  ┆ 1            │
│ TRXUSDT      ┆ 4.939308     ┆ 128  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:21,072 - INFO - cur close time: 2023-10-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-12-12 23:54:21,072 - DEBUG - mean expected ret (mean factor): 0.11878696635322789
2024-12-12 23:54:21,080 - DEBUG - begin to update pos: =========
2024-12-12 23:54:21,080 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,080 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01804     ┆ 0.05594     ┆ 0.0006351   ┆ … ┆ 0.01683 ┆ null   ┆ null    ┆ 0.253   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,088 - DEBUG - update position: 2023-10-17T23:59:59.999 === diff_trading_value: 284673.9592733566 == cash: 133923.6008792258 
2024-12-12 23:54:21,089 - INFO - pnl: 2023-10-17T23:59:59.999 133923.6008792258 === 3.537%
2024-12-12 23:54:21,092 - DEBUG - cur time: 2023-10-18T23:59:59.999 == next bar open time: 2023-10-19T00:00:00.000 == close pos time: 2023-10-24T00:00:00.000
2024-12-12 23:54:21,096 - INFO - pnl: 2023-10-18T23:59:59.999 135791.97434781515 === 1.395%
2024-12-12 23:54:21,100 - DEBUG - cur time: 2023-10-19T23:59:59.999 == next bar open time: 2023-10-20T00:00:00.000 == close pos time: 2023-10-25T00:00:00.000
2024-12-12 23:54:21,100 - INFO - pnl: 2023-10-19T23:59:59.999 134343.37637898437 === -1.067%
2024-12-12 23:54:21,106 - DEBUG - cur time: 2023-10-20T23:59:59.999 == next bar open time: 2023-10-21T00:00:00.000 == close pos time: 2023-10-26T00:00:00.000
2024-12-12 23:54:21,109 - INFO - pnl: 2023-10-20T23:59:59.999 133957.01946546897 === -0.288%
2024-12-12 23:54:21,113 - DEBUG - cur time: 2023-10-21T23:59:59.999 == next bar open time: 2023-10-22T00:00:00.000 == close pos time: 2023-10-27T00:00:00.000
2024-12-12 23:54:21,115 - INFO - pnl: 2023-10-21T23:59:59.999 133268.4987453671 === -0.514%
2024-12-12 23:54:21,122 - DEBUG - cur time: 2023-10-22T23:59:59.999 == next bar open time: 2023-10-23T00:00:00.000 == close pos time: 2023-10-28T00:00:00.000
2024-12-12 23:54:21,137 - DEBUG - close time 2023-10-22T23:59:59.999 == vol_threshold: 17693330.200000003
2024-12-12 23:54:21,138 - DEBUG - 2023-10-22T23:59:59.999 == all trade symbol 188 == remain 131 after VOL filter
2024-12-12 23:54:21,140 - DEBUG - sorted_long_factors: shape: (131, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ MINAUSDT      ┆ -5.853225    ┆ 0    ┆ 130          │
│ DODOXUSDT     ┆ -5.692217    ┆ 1    ┆ 129          │
│ ARKMUSDT      ┆ -4.719324    ┆ 2    ┆ 128          │
│ COTIUSDT      ┆ -4.209512    ┆ 3    ┆ 127          │
│ OXTUSDT       ┆ -3.85207     ┆ 4    ┆ 126          │
│ TUSDT         ┆ -3.554979    ┆ 5    ┆ 125          │
│ RENUSDT       ┆ -3.411842    ┆ 6    ┆ 124          │
│ EDUUSDT       ┆ -3.175251    ┆ 7    ┆ 123          │
│ LUNA2USDT     ┆ -3.131456    ┆ 8    ┆ 122          │
│ XRPUSDT       ┆ -2.811763    ┆ 9    ┆ 121          │
│ …             ┆ …            ┆ …    ┆ …            │
│ CELRUSDT      ┆ 2.733879     ┆ 121  ┆ 9            │
│ XEMUSDT       ┆ 2.820434     ┆ 122  ┆ 8            │
│ BATUSDT       ┆ 3.010963     ┆ 123  ┆ 7            │
│ 1000FLOKIUSDT ┆ 3.401081     ┆ 124  ┆ 6            │
│ BLZUSDT       ┆ 3.892709     ┆ 125  ┆ 5            │
│ DGBUSDT       ┆ 4.108926     ┆ 126  ┆ 4            │
│ ARPAUSDT      ┆ 4.18246      ┆ 127  ┆ 3            │
│ MDTUSDT       ┆ 4.393272     ┆ 128  ┆ 2            │
│ AGLDUSDT      ┆ 5.307329     ┆ 129  ┆ 1            │
│ PENDLEUSDT    ┆ 6.238882     ┆ 130  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:21,146 - WARNING - 2023-10-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:21,146 - INFO - cur close time: 2023-10-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:21,146 - DEBUG - mean expected ret (mean factor): 0.022753787339900817
2024-12-12 23:54:21,152 - DEBUG - begin to update pos: =========
2024-12-12 23:54:21,152 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,152 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02482     ┆ 0.0586      ┆ 0.0007473   ┆ … ┆ 0.01758 ┆ null   ┆ null    ┆ 0.2215  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,162 - DEBUG - update position: 2023-10-22T23:59:59.999 === diff_trading_value: 328501.41173522547 == cash: 131765.78990996332 
2024-12-12 23:54:21,165 - INFO - pnl: 2023-10-22T23:59:59.999 131765.78990996332 === -1.128%
2024-12-12 23:54:21,171 - DEBUG - cur time: 2023-10-23T23:59:59.999 == next bar open time: 2023-10-24T00:00:00.000 == close pos time: 2023-10-29T00:00:00.000
2024-12-12 23:54:21,175 - INFO - pnl: 2023-10-23T23:59:59.999 133114.7092610055 === 1.024%
2024-12-12 23:54:21,183 - DEBUG - cur time: 2023-10-24T23:59:59.999 == next bar open time: 2023-10-25T00:00:00.000 == close pos time: 2023-10-30T00:00:00.000
2024-12-12 23:54:21,187 - INFO - pnl: 2023-10-24T23:59:59.999 124605.77904345753 === -6.392%
2024-12-12 23:54:21,195 - DEBUG - cur time: 2023-10-25T23:59:59.999 == next bar open time: 2023-10-26T00:00:00.000 == close pos time: 2023-10-31T00:00:00.000
2024-12-12 23:54:21,196 - INFO - pnl: 2023-10-25T23:59:59.999 124687.6092495168 === 0.066%
2024-12-12 23:54:21,202 - DEBUG - cur time: 2023-10-26T23:59:59.999 == next bar open time: 2023-10-27T00:00:00.000 == close pos time: 2023-11-01T00:00:00.000
2024-12-12 23:54:21,203 - INFO - pnl: 2023-10-26T23:59:59.999 126647.73234424363 === 1.572%
2024-12-12 23:54:21,209 - DEBUG - cur time: 2023-10-27T23:59:59.999 == next bar open time: 2023-10-28T00:00:00.000 == close pos time: 2023-11-02T00:00:00.000
2024-12-12 23:54:21,224 - DEBUG - close time 2023-10-27T23:59:59.999 == vol_threshold: 25211434.759999998
2024-12-12 23:54:21,225 - DEBUG - 2023-10-27T23:59:59.999 == all trade symbol 189 == remain 132 after VOL filter
2024-12-12 23:54:21,227 - DEBUG - sorted_long_factors: shape: (132, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ AMBUSDT     ┆ -4.80176     ┆ 0    ┆ 131          │
│ RDNTUSDT    ┆ -4.44082     ┆ 1    ┆ 130          │
│ DOGEUSDT    ┆ -3.381741    ┆ 2    ┆ 129          │
│ DODOXUSDT   ┆ -3.23533     ┆ 3    ┆ 128          │
│ IDUSDT      ┆ -3.228638    ┆ 4    ┆ 127          │
│ XRPUSDT     ┆ -3.068674    ┆ 5    ┆ 126          │
│ COTIUSDT    ┆ -3.042421    ┆ 6    ┆ 125          │
│ IMXUSDT     ┆ -3.038784    ┆ 7    ┆ 124          │
│ FILUSDT     ┆ -2.945864    ┆ 8    ┆ 123          │
│ ARPAUSDT    ┆ -2.908846    ┆ 9    ┆ 122          │
│ …           ┆ …            ┆ …    ┆ …            │
│ 1000XECUSDT ┆ 3.273317     ┆ 122  ┆ 9            │
│ INJUSDT     ┆ 3.277534     ┆ 123  ┆ 8            │
│ DUSKUSDT    ┆ 3.508576     ┆ 124  ┆ 7            │
│ FLOWUSDT    ┆ 3.575196     ┆ 125  ┆ 6            │
│ NEOUSDT     ┆ 3.600562     ┆ 126  ┆ 5            │
│ IOSTUSDT    ┆ 4.067918     ┆ 127  ┆ 4            │
│ ONTUSDT     ┆ 4.077461     ┆ 128  ┆ 3            │
│ CHRUSDT     ┆ 4.168614     ┆ 129  ┆ 2            │
│ RNDRUSDT    ┆ 4.736948     ┆ 130  ┆ 1            │
│ ATAUSDT     ┆ 4.878997     ┆ 131  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:21,235 - WARNING - 2023-10-27T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:21,235 - INFO - cur close time: 2023-10-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:21,235 - DEBUG - mean expected ret (mean factor): 0.22642427431937223
2024-12-12 23:54:21,240 - DEBUG - begin to update pos: =========
2024-12-12 23:54:21,240 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,240 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03442     ┆ 0.06318     ┆ 0.0011625   ┆ … ┆ 0.01818 ┆ null   ┆ null    ┆ 0.2334  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,247 - DEBUG - update position: 2023-10-27T23:59:59.999 === diff_trading_value: 313852.12162563205 == cash: 126146.22361357117 
2024-12-12 23:54:21,247 - INFO - pnl: 2023-10-27T23:59:59.999 126146.22361357117 === -0.396%
2024-12-12 23:54:21,251 - DEBUG - cur time: 2023-10-28T23:59:59.999 == next bar open time: 2023-10-29T00:00:00.000 == close pos time: 2023-11-03T00:00:00.000
2024-12-12 23:54:21,251 - INFO - pnl: 2023-10-28T23:59:59.999 125164.42715929603 === -0.778%
2024-12-12 23:54:21,255 - DEBUG - cur time: 2023-10-29T23:59:59.999 == next bar open time: 2023-10-30T00:00:00.000 == close pos time: 2023-11-04T00:00:00.000
2024-12-12 23:54:21,255 - INFO - pnl: 2023-10-29T23:59:59.999 124582.02940476093 === -0.465%
2024-12-12 23:54:21,260 - DEBUG - cur time: 2023-10-30T23:59:59.999 == next bar open time: 2023-10-31T00:00:00.000 == close pos time: 2023-11-05T00:00:00.000
2024-12-12 23:54:21,260 - INFO - pnl: 2023-10-30T23:59:59.999 122261.93826168509 === -1.862%
2024-12-12 23:54:21,264 - DEBUG - cur time: 2023-10-31T23:59:59.999 == next bar open time: 2023-11-01T00:00:00.000 == close pos time: 2023-11-06T00:00:00.000
2024-12-12 23:54:21,264 - INFO - pnl: 2023-10-31T23:59:59.999 123750.78635773217 === 1.218%
2024-12-12 23:54:21,269 - DEBUG - cur time: 2023-11-01T23:59:59.999 == next bar open time: 2023-11-02T00:00:00.000 == close pos time: 2023-11-07T00:00:00.000
2024-12-12 23:54:21,280 - DEBUG - close time 2023-11-01T23:59:59.999 == vol_threshold: 26107825.042
2024-12-12 23:54:21,280 - DEBUG - 2023-11-01T23:59:59.999 == all trade symbol 190 == remain 133 after VOL filter
2024-12-12 23:54:21,280 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -5.051586    ┆ 0    ┆ 132          │
│ KAVAUSDT     ┆ -3.459968    ┆ 1    ┆ 131          │
│ CYBERUSDT    ┆ -3.415029    ┆ 2    ┆ 130          │
│ STGUSDT      ┆ -3.300811    ┆ 3    ┆ 129          │
│ ARKMUSDT     ┆ -3.264763    ┆ 4    ┆ 128          │
│ MDTUSDT      ┆ -3.222063    ┆ 5    ┆ 127          │
│ SUIUSDT      ┆ -3.185457    ┆ 6    ┆ 126          │
│ EDUUSDT      ┆ -2.852321    ┆ 7    ┆ 125          │
│ GMTUSDT      ┆ -2.788484    ┆ 8    ┆ 124          │
│ TRUUSDT      ┆ -2.646102    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ EOSUSDT      ┆ 2.6055       ┆ 123  ┆ 9            │
│ XEMUSDT      ┆ 2.606611     ┆ 124  ┆ 8            │
│ CTSIUSDT     ┆ 2.793612     ┆ 125  ┆ 7            │
│ WOOUSDT      ┆ 2.825784     ┆ 126  ┆ 6            │
│ RUNEUSDT     ┆ 3.423775     ┆ 127  ┆ 5            │
│ TRXUSDT      ┆ 3.436683     ┆ 128  ┆ 4            │
│ CRVUSDT      ┆ 3.8301       ┆ 129  ┆ 3            │
│ ONEUSDT      ┆ 3.876291     ┆ 130  ┆ 2            │
│ JOEUSDT      ┆ 6.018386     ┆ 131  ┆ 1            │
│ SUSHIUSDT    ┆ 6.914515     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:21,294 - WARNING - 2023-11-01T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:21,294 - INFO - cur close time: 2023-11-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:21,294 - DEBUG - mean expected ret (mean factor): 0.02884818210337553
2024-12-12 23:54:21,299 - DEBUG - begin to update pos: =========
2024-12-12 23:54:21,299 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,299 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03296     ┆ 0.06492     ┆ 0.0011867   ┆ … ┆ 0.0203  ┆ null   ┆ null    ┆ 0.2748  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,309 - DEBUG - update position: 2023-11-01T23:59:59.999 === diff_trading_value: 360390.6090653395 == cash: 123448.89590075344 
2024-12-12 23:54:21,311 - INFO - pnl: 2023-11-01T23:59:59.999 123448.89590075344 === -0.244%
2024-12-12 23:54:21,314 - DEBUG - cur time: 2023-11-02T23:59:59.999 == next bar open time: 2023-11-03T00:00:00.000 == close pos time: 2023-11-08T00:00:00.000
2024-12-12 23:54:21,318 - INFO - pnl: 2023-11-02T23:59:59.999 124311.30555642676 === 0.699%
2024-12-12 23:54:21,323 - DEBUG - cur time: 2023-11-03T23:59:59.999 == next bar open time: 2023-11-04T00:00:00.000 == close pos time: 2023-11-09T00:00:00.000
2024-12-12 23:54:21,326 - INFO - pnl: 2023-11-03T23:59:59.999 125577.49998754472 === 1.019%
2024-12-12 23:54:21,330 - DEBUG - cur time: 2023-11-04T23:59:59.999 == next bar open time: 2023-11-05T00:00:00.000 == close pos time: 2023-11-10T00:00:00.000
2024-12-12 23:54:21,333 - INFO - pnl: 2023-11-04T23:59:59.999 123243.23007038471 === -1.859%
2024-12-12 23:54:21,338 - DEBUG - cur time: 2023-11-05T23:59:59.999 == next bar open time: 2023-11-06T00:00:00.000 == close pos time: 2023-11-11T00:00:00.000
2024-12-12 23:54:21,340 - INFO - pnl: 2023-11-05T23:59:59.999 121622.09291330946 === -1.315%
2024-12-12 23:54:21,343 - DEBUG - cur time: 2023-11-06T23:59:59.999 == next bar open time: 2023-11-07T00:00:00.000 == close pos time: 2023-11-12T00:00:00.000
2024-12-12 23:54:21,355 - DEBUG - close time 2023-11-06T23:59:59.999 == vol_threshold: 26259284.56
2024-12-12 23:54:21,360 - DEBUG - 2023-11-06T23:59:59.999 == all trade symbol 190 == remain 133 after VOL filter
2024-12-12 23:54:21,364 - DEBUG - sorted_long_factors: shape: (133, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ DODOXUSDT ┆ -2.64821     ┆ 0    ┆ 132          │
│ XRPUSDT   ┆ -2.473678    ┆ 1    ┆ 131          │
│ HOOKUSDT  ┆ -2.227002    ┆ 2    ┆ 130          │
│ NKNUSDT   ┆ -2.181856    ┆ 3    ┆ 129          │
│ ARPAUSDT  ┆ -1.936223    ┆ 4    ┆ 128          │
│ EDUUSDT   ┆ -1.877721    ┆ 5    ┆ 127          │
│ ALPHAUSDT ┆ -1.854622    ┆ 6    ┆ 126          │
│ KAVAUSDT  ┆ -1.577446    ┆ 7    ┆ 125          │
│ AMBUSDT   ┆ -1.571272    ┆ 8    ┆ 124          │
│ CELRUSDT  ┆ -1.5085      ┆ 9    ┆ 123          │
│ …         ┆ …            ┆ …    ┆ …            │
│ OXTUSDT   ┆ 1.277397     ┆ 123  ┆ 9            │
│ CRVUSDT   ┆ 1.404763     ┆ 124  ┆ 8            │
│ EOSUSDT   ┆ 1.413633     ┆ 125  ┆ 7            │
│ RSRUSDT   ┆ 1.523146     ┆ 126  ┆ 6            │
│ BLZUSDT   ┆ 1.596795     ┆ 127  ┆ 5            │
│ CHRUSDT   ┆ 1.64938      ┆ 128  ┆ 4            │
│ DUSKUSDT  ┆ 1.700796     ┆ 129  ┆ 3            │
│ XEMUSDT   ┆ 1.71037      ┆ 130  ┆ 2            │
│ ONEUSDT   ┆ 1.962998     ┆ 131  ┆ 1            │
│ ASTRUSDT  ┆ 2.709146     ┆ 132  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:21,370 - WARNING - 2023-11-06T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:21,370 - INFO - cur close time: 2023-11-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:21,370 - DEBUG - mean expected ret (mean factor): -0.11370418207088269
2024-12-12 23:54:21,376 - DEBUG - begin to update pos: =========
2024-12-12 23:54:21,376 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,376 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03143     ┆ 0.06807     ┆ 0.0012085   ┆ … ┆ 0.02109 ┆ null   ┆ null    ┆ 0.2727  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,383 - DEBUG - update position: 2023-11-06T23:59:59.999 === diff_trading_value: 284427.8886669152 == cash: 119385.58023556268 
2024-12-12 23:54:21,387 - INFO - pnl: 2023-11-06T23:59:59.999 119385.58023556268 === -1.839%
2024-12-12 23:54:21,391 - DEBUG - cur time: 2023-11-07T23:59:59.999 == next bar open time: 2023-11-08T00:00:00.000 == close pos time: 2023-11-13T00:00:00.000
2024-12-12 23:54:21,391 - INFO - pnl: 2023-11-07T23:59:59.999 120338.54754966628 === 0.798%
2024-12-12 23:54:21,396 - DEBUG - cur time: 2023-11-08T23:59:59.999 == next bar open time: 2023-11-09T00:00:00.000 == close pos time: 2023-11-14T00:00:00.000
2024-12-12 23:54:21,396 - INFO - pnl: 2023-11-08T23:59:59.999 121378.05970919941 === 0.864%
2024-12-12 23:54:21,399 - DEBUG - cur time: 2023-11-09T23:59:59.999 == next bar open time: 2023-11-10T00:00:00.000 == close pos time: 2023-11-15T00:00:00.000
2024-12-12 23:54:21,399 - INFO - pnl: 2023-11-09T23:59:59.999 125595.59861956758 === 3.475%
2024-12-12 23:54:21,405 - DEBUG - cur time: 2023-11-10T23:59:59.999 == next bar open time: 2023-11-11T00:00:00.000 == close pos time: 2023-11-16T00:00:00.000
2024-12-12 23:54:21,405 - INFO - pnl: 2023-11-10T23:59:59.999 126028.11171685929 === 0.344%
2024-12-12 23:54:21,410 - DEBUG - cur time: 2023-11-11T23:59:59.999 == next bar open time: 2023-11-12T00:00:00.000 == close pos time: 2023-11-17T00:00:00.000
2024-12-12 23:54:21,422 - DEBUG - close time 2023-11-11T23:59:59.999 == vol_threshold: 23930358.72
2024-12-12 23:54:21,422 - DEBUG - 2023-11-11T23:59:59.999 == all trade symbol 189 == remain 132 after VOL filter
2024-12-12 23:54:21,426 - DEBUG - sorted_long_factors: shape: (132, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ XVGUSDT  ┆ -4.572662    ┆ 0    ┆ 131          │
│ AMBUSDT  ┆ -4.113611    ┆ 1    ┆ 130          │
│ MAVUSDT  ┆ -3.944228    ┆ 2    ┆ 129          │
│ XRPUSDT  ┆ -3.759662    ┆ 3    ┆ 128          │
│ CKBUSDT  ┆ -3.69128     ┆ 4    ┆ 127          │
│ BELUSDT  ┆ -3.655676    ┆ 5    ┆ 126          │
│ ARBUSDT  ┆ -3.151726    ┆ 6    ┆ 125          │
│ PERPUSDT ┆ -2.75847     ┆ 7    ┆ 124          │
│ ACHUSDT  ┆ -2.749825    ┆ 8    ┆ 123          │
│ RENUSDT  ┆ -2.640473    ┆ 9    ┆ 122          │
│ …        ┆ …            ┆ …    ┆ …            │
│ STXUSDT  ┆ 2.419366     ┆ 122  ┆ 9            │
│ ANKRUSDT ┆ 2.484428     ┆ 123  ┆ 8            │
│ CHRUSDT  ┆ 2.529331     ┆ 124  ┆ 7            │
│ CRVUSDT  ┆ 2.575859     ┆ 125  ┆ 6            │
│ DUSKUSDT ┆ 2.607082     ┆ 126  ┆ 5            │
│ CFXUSDT  ┆ 2.765425     ┆ 127  ┆ 4            │
│ RUNEUSDT ┆ 2.988193     ┆ 128  ┆ 3            │
│ ONEUSDT  ┆ 3.918202     ┆ 129  ┆ 2            │
│ STMXUSDT ┆ 4.335376     ┆ 130  ┆ 1            │
│ ZRXUSDT  ┆ 4.378312     ┆ 131  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:21,433 - WARNING - 2023-11-11T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:21,433 - INFO - cur close time: 2023-11-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:21,433 - DEBUG - mean expected ret (mean factor): 0.12229879058828581
2024-12-12 23:54:21,439 - DEBUG - begin to update pos: =========
2024-12-12 23:54:21,439 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,439 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03135     ┆ 0.0831      ┆ 0.0012775   ┆ … ┆ 0.02261 ┆ null   ┆ null    ┆ 0.4621  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,446 - DEBUG - update position: 2023-11-11T23:59:59.999 === diff_trading_value: 321890.48968206544 == cash: 127348.15983943458 
2024-12-12 23:54:21,446 - INFO - pnl: 2023-11-11T23:59:59.999 127348.15983943458 === 1.047%
2024-12-12 23:54:21,450 - DEBUG - cur time: 2023-11-12T23:59:59.999 == next bar open time: 2023-11-13T00:00:00.000 == close pos time: 2023-11-18T00:00:00.000
2024-12-12 23:54:21,450 - INFO - pnl: 2023-11-12T23:59:59.999 128855.70836927212 === 1.184%
2024-12-12 23:54:21,455 - DEBUG - cur time: 2023-11-13T23:59:59.999 == next bar open time: 2023-11-14T00:00:00.000 == close pos time: 2023-11-19T00:00:00.000
2024-12-12 23:54:21,455 - INFO - pnl: 2023-11-13T23:59:59.999 127375.5991905145 === -1.149%
2024-12-12 23:54:21,459 - DEBUG - cur time: 2023-11-14T23:59:59.999 == next bar open time: 2023-11-15T00:00:00.000 == close pos time: 2023-11-20T00:00:00.000
2024-12-12 23:54:21,459 - INFO - pnl: 2023-11-14T23:59:59.999 128943.63138437974 === 1.231%
2024-12-12 23:54:21,463 - DEBUG - cur time: 2023-11-15T23:59:59.999 == next bar open time: 2023-11-16T00:00:00.000 == close pos time: 2023-11-21T00:00:00.000
2024-12-12 23:54:21,463 - INFO - pnl: 2023-11-15T23:59:59.999 129581.81086658106 === 0.495%
2024-12-12 23:54:21,467 - DEBUG - cur time: 2023-11-16T23:59:59.999 == next bar open time: 2023-11-17T00:00:00.000 == close pos time: 2023-11-22T00:00:00.000
2024-12-12 23:54:21,477 - DEBUG - close time 2023-11-16T23:59:59.999 == vol_threshold: 30273878.6
2024-12-12 23:54:21,480 - DEBUG - 2023-11-16T23:59:59.999 == all trade symbol 189 == remain 132 after VOL filter
2024-12-12 23:54:21,480 - DEBUG - sorted_long_factors: shape: (132, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT      ┆ -5.159962    ┆ 0    ┆ 131          │
│ DUSKUSDT     ┆ -3.831577    ┆ 1    ┆ 130          │
│ XVGUSDT      ┆ -3.680992    ┆ 2    ┆ 129          │
│ IOTXUSDT     ┆ -3.432376    ┆ 3    ┆ 128          │
│ OXTUSDT      ┆ -3.350711    ┆ 4    ┆ 127          │
│ 1000SHIBUSDT ┆ -3.078693    ┆ 5    ┆ 126          │
│ ICXUSDT      ┆ -3.004546    ┆ 6    ┆ 125          │
│ ASTRUSDT     ┆ -2.905834    ┆ 7    ┆ 124          │
│ DODOXUSDT    ┆ -2.827873    ┆ 8    ┆ 123          │
│ HFTUSDT      ┆ -2.735441    ┆ 9    ┆ 122          │
│ …            ┆ …            ┆ …    ┆ …            │
│ JOEUSDT      ┆ 2.469532     ┆ 122  ┆ 9            │
│ CELOUSDT     ┆ 2.518812     ┆ 123  ┆ 8            │
│ CHRUSDT      ┆ 2.617349     ┆ 124  ┆ 7            │
│ RNDRUSDT     ┆ 2.776649     ┆ 125  ┆ 6            │
│ LRCUSDT      ┆ 3.130815     ┆ 126  ┆ 5            │
│ RVNUSDT      ┆ 3.204367     ┆ 127  ┆ 4            │
│ CKBUSDT      ┆ 3.375093     ┆ 128  ┆ 3            │
│ BATUSDT      ┆ 3.378412     ┆ 129  ┆ 2            │
│ DGBUSDT      ┆ 3.726991     ┆ 130  ┆ 1            │
│ DENTUSDT     ┆ 5.208066     ┆ 131  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:21,486 - WARNING - 2023-11-16T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:21,486 - INFO - cur close time: 2023-11-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:21,486 - DEBUG - mean expected ret (mean factor): 0.05269727858713036
2024-12-12 23:54:21,490 - DEBUG - begin to update pos: =========
2024-12-12 23:54:21,490 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,492 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03328     ┆ 0.07783     ┆ 0.001142    ┆ … ┆ 0.02128 ┆ null   ┆ null    ┆ 0.4671  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,496 - DEBUG - update position: 2023-11-16T23:59:59.999 === diff_trading_value: 307989.72250206966 == cash: 129821.66345372153 
2024-12-12 23:54:21,496 - INFO - pnl: 2023-11-16T23:59:59.999 129821.66345372153 === 0.185%
2024-12-12 23:54:21,499 - DEBUG - cur time: 2023-11-17T23:59:59.999 == next bar open time: 2023-11-18T00:00:00.000 == close pos time: 2023-11-23T00:00:00.000
2024-12-12 23:54:21,499 - INFO - pnl: 2023-11-17T23:59:59.999 129568.63525748545 === -0.195%
2024-12-12 23:54:21,503 - DEBUG - cur time: 2023-11-18T23:59:59.999 == next bar open time: 2023-11-19T00:00:00.000 == close pos time: 2023-11-24T00:00:00.000
2024-12-12 23:54:21,503 - INFO - pnl: 2023-11-18T23:59:59.999 129185.32764328195 === -0.296%
2024-12-12 23:54:21,509 - DEBUG - cur time: 2023-11-19T23:59:59.999 == next bar open time: 2023-11-20T00:00:00.000 == close pos time: 2023-11-25T00:00:00.000
2024-12-12 23:54:21,509 - INFO - pnl: 2023-11-19T23:59:59.999 129420.2973956331 === 0.182%
2024-12-12 23:54:21,512 - DEBUG - cur time: 2023-11-20T23:59:59.999 == next bar open time: 2023-11-21T00:00:00.000 == close pos time: 2023-11-26T00:00:00.000
2024-12-12 23:54:21,512 - INFO - pnl: 2023-11-20T23:59:59.999 130670.31172254517 === 0.966%
2024-12-12 23:54:21,516 - DEBUG - cur time: 2023-11-21T23:59:59.999 == next bar open time: 2023-11-22T00:00:00.000 == close pos time: 2023-11-27T00:00:00.000
2024-12-12 23:54:21,525 - DEBUG - close time 2023-11-21T23:59:59.999 == vol_threshold: 29544984.16
2024-12-12 23:54:21,529 - DEBUG - 2023-11-21T23:59:59.999 == all trade symbol 189 == remain 132 after VOL filter
2024-12-12 23:54:21,529 - DEBUG - sorted_long_factors: shape: (132, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ DUSKUSDT      ┆ -6.250723    ┆ 0    ┆ 131          │
│ DODOXUSDT     ┆ -5.548018    ┆ 1    ┆ 130          │
│ DOGEUSDT      ┆ -3.963024    ┆ 2    ┆ 129          │
│ ARKMUSDT      ┆ -3.719733    ┆ 3    ┆ 128          │
│ IDUSDT        ┆ -3.273992    ┆ 4    ┆ 127          │
│ 1000SHIBUSDT  ┆ -2.523656    ┆ 5    ┆ 126          │
│ KEYUSDT       ┆ -2.353915    ┆ 6    ┆ 125          │
│ BNTUSDT       ┆ -2.185505    ┆ 7    ┆ 124          │
│ XRPUSDT       ┆ -2.123179    ┆ 8    ┆ 123          │
│ FILUSDT       ┆ -2.117416    ┆ 9    ┆ 122          │
│ …             ┆ …            ┆ …    ┆ …            │
│ WLDUSDT       ┆ 2.938803     ┆ 122  ┆ 9            │
│ GMTUSDT       ┆ 2.942175     ┆ 123  ┆ 8            │
│ ONTUSDT       ┆ 3.256352     ┆ 124  ┆ 7            │
│ XEMUSDT       ┆ 3.366077     ┆ 125  ┆ 6            │
│ 1000FLOKIUSDT ┆ 3.451996     ┆ 126  ┆ 5            │
│ DENTUSDT      ┆ 3.506489     ┆ 127  ┆ 4            │
│ SPELLUSDT     ┆ 3.772635     ┆ 128  ┆ 3            │
│ IMXUSDT       ┆ 4.656348     ┆ 129  ┆ 2            │
│ COTIUSDT      ┆ 5.455606     ┆ 130  ┆ 1            │
│ SKLUSDT       ┆ 5.756413     ┆ 131  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:21,538 - WARNING - 2023-11-21T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-12-12 23:54:21,538 - INFO - cur close time: 2023-11-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-12-12 23:54:21,538 - DEBUG - mean expected ret (mean factor): 0.30298286879755576
2024-12-12 23:54:21,542 - DEBUG - begin to update pos: =========
2024-12-12 23:54:21,542 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,542 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02927     ┆ 0.0692      ┆ 0.0010339   ┆ … ┆ 0.01953 ┆ null   ┆ null    ┆ 0.3704  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,550 - DEBUG - update position: 2023-11-21T23:59:59.999 === diff_trading_value: 233247.49099608397 == cash: 129747.7897725985 
2024-12-12 23:54:21,550 - INFO - pnl: 2023-11-21T23:59:59.999 129747.7897725985 === -0.706%
2024-12-12 23:54:21,554 - DEBUG - cur time: 2023-11-22T23:59:59.999 == next bar open time: 2023-11-23T00:00:00.000 == close pos time: 2023-11-28T00:00:00.000
2024-12-12 23:54:21,554 - INFO - pnl: 2023-11-22T23:59:59.999 133213.6026598854 === 2.671%
2024-12-12 23:54:21,559 - DEBUG - cur time: 2023-11-23T23:59:59.999 == next bar open time: 2023-11-24T00:00:00.000 == close pos time: 2023-11-29T00:00:00.000
2024-12-12 23:54:21,560 - INFO - pnl: 2023-11-23T23:59:59.999 133232.93676743025 === 0.015%
2024-12-12 23:54:21,563 - DEBUG - cur time: 2023-11-24T23:59:59.999 == next bar open time: 2023-11-25T00:00:00.000 == close pos time: 2023-11-30T00:00:00.000
2024-12-12 23:54:21,563 - INFO - pnl: 2023-11-24T23:59:59.999 133581.48492042246 === 0.262%
2024-12-12 23:54:21,567 - DEBUG - cur time: 2023-11-25T23:59:59.999 == next bar open time: 2023-11-26T00:00:00.000 == close pos time: 2023-12-01T00:00:00.000
2024-12-12 23:54:21,567 - INFO - pnl: 2023-11-25T23:59:59.999 133249.09725805194 === -0.249%
2024-12-12 23:54:21,571 - DEBUG - cur time: 2023-11-26T23:59:59.999 == next bar open time: 2023-11-27T00:00:00.000 == close pos time: 2023-12-02T00:00:00.000
2024-12-12 23:54:21,580 - DEBUG - close time 2023-11-26T23:59:59.999 == vol_threshold: 21700386.41
2024-12-12 23:54:21,580 - DEBUG - 2023-11-26T23:59:59.999 == all trade symbol 190 == remain 133 after VOL filter
2024-12-12 23:54:21,584 - DEBUG - sorted_long_factors: shape: (133, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ HIFIUSDT   ┆ -4.247081    ┆ 0    ┆ 132          │
│ BLZUSDT    ┆ -3.948437    ┆ 1    ┆ 131          │
│ MAVUSDT    ┆ -3.474906    ┆ 2    ┆ 130          │
│ HFTUSDT    ┆ -3.358819    ┆ 3    ┆ 129          │
│ KEYUSDT    ┆ -3.199558    ┆ 4    ┆ 128          │
│ RDNTUSDT   ┆ -3.131553    ┆ 5    ┆ 127          │
│ DUSKUSDT   ┆ -3.05717     ┆ 6    ┆ 126          │
│ JOEUSDT    ┆ -2.714025    ┆ 7    ┆ 125          │
│ PENDLEUSDT ┆ -2.677065    ┆ 8    ┆ 124          │
│ HOOKUSDT   ┆ -2.65594     ┆ 9    ┆ 123          │
│ …          ┆ …            ┆ …    ┆ …            │
│ MDTUSDT    ┆ 3.518781     ┆ 123  ┆ 9            │
│ RADUSDT    ┆ 3.579761     ┆ 124  ┆ 8            │
│ ATOMUSDT   ┆ 3.638854     ┆ 125  ┆ 7            │
│ SPELLUSDT  ┆ 3.869448     ┆ 126  ┆ 6            │
│ TRUUSDT    ┆ 4.055401     ┆ 127  ┆ 5            │
│ IOSTUSDT   ┆ 4.411366     ┆ 128  ┆ 4            │
│ FLOWUSDT   ┆ 4.475786     ┆ 129  ┆ 3            │
│ UNFIUSDT   ┆ 4.64867      ┆ 130  ┆ 2            │
│ OXTUSDT    ┆ 4.959619     ┆ 131  ┆ 1            │
│ TLMUSDT    ┆ 5.124993     ┆ 132  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-12-12 23:54:21,589 - WARNING - 2023-11-26T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-12-12 23:54:21,589 - INFO - cur close time: 2023-11-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-12-12 23:54:21,589 - DEBUG - mean expected ret (mean factor): 0.27107351917321837
2024-12-12 23:54:21,593 - DEBUG - begin to update pos: =========
2024-12-12 23:54:21,593 - DEBUG - next_step_value: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 5000.0      ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,596 - DEBUG - all_open_price_when_open_pos: shape: (1, 280)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0322      ┆ 0.10002     ┆ 0.0011153   ┆ … ┆ 0.02121 ┆ null   ┆ null    ┆ 0.4006  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-12-12 23:54:21,601 - DEBUG - update position: 2023-11-26T23:59:59.999 === diff_trading_value: 336713.48632713914 == cash: 131366.62347186782 
2024-12-12 23:54:21,601 - INFO - pnl: 2023-11-26T23:59:59.999 131366.62347186782 === -1.413%
2024-12-12 23:54:21,606 - DEBUG - cur time: 2023-11-27T23:59:59.999 == next bar open time: 2023-11-28T00:00:00.000 == close pos time: 2023-12-03T00:00:00.000
2024-12-12 23:54:21,606 - INFO - pnl: 2023-11-27T23:59:59.999 130959.62355193708 === -0.310%
2024-12-12 23:54:21,609 - DEBUG - cur time: 2023-11-28T23:59:59.999 == next bar open time: 2023-11-29T00:00:00.000 == close pos time: 2023-12-04T00:00:00.000
2024-12-12 23:54:21,609 - INFO - pnl: 2023-11-28T23:59:59.999 131819.4287274753 === 0.657%
2024-12-12 23:54:21,615 - DEBUG - cur time: 2023-11-29T23:59:59.999 == next bar open time: 2023-11-30T00:00:00.000 == close pos time: 2023-12-05T00:00:00.000
2024-12-12 23:54:21,615 - INFO - pnl: 2023-11-29T23:59:59.999 126086.22294320351 === -4.349%
2024-12-12 23:54:21,619 - DEBUG - cur time: 2023-11-30T23:59:59.999 == next bar open time: 2023-12-01T00:00:00.000 == close pos time: 2023-12-06T00:00:00.000
2024-12-12 23:54:21,621 - INFO - pnl: 2023-11-30T23:59:59.999 126070.25895719667 === -0.013%
2024-12-12 23:54:21,623 - DEBUG - cur time: 2023-12-01T23:59:59.999 == next bar open time: 2023-12-02T00:00:00.000 == close pos time: 2023-12-07T00:00:00.000
