2024-11-20 23:06:56,101 - INFO - TRADE_RANK_NUM: 20
2024-11-20 23:06:56,101 - INFO - LINEAR_INPUT_FILE data/predictions.parquet
2024-11-20 23:06:56,117 - INFO - LONG_TRADE_RANK_RATIO: 1.0, SHORT_TRADE_RANK_RATIO: 0.5
2024-11-20 23:06:56,118 - INFO - DYNAMIC_POS_SCALE: 0 === threshold: 3.0
2024-11-20 23:06:56,434 - INFO - start get SinglePnl: shape: (126_300, 83)
┌────────────┬───────────┬──────────┬──────────┬───┬───────────┬───────────┬───────────┬───────────┐
│ symbol     ┆ open_time ┆ open     ┆ high     ┆ … ┆ long_valu ┆ short_val ┆ long_valu ┆ short_val │
│ ---        ┆ ---       ┆ ---      ┆ ---      ┆   ┆ e_scale_9 ┆ ue_scale_ ┆ e_scale_1 ┆ ue_scale_ │
│ str        ┆ datetime[ ┆ f64      ┆ f64      ┆   ┆ day       ┆ 9day      ┆ 0day      ┆ 10day     │
│            ┆ ms]       ┆          ┆          ┆   ┆ ---       ┆ ---       ┆ ---       ┆ ---       │
│            ┆           ┆          ┆          ┆   ┆ f64       ┆ f64       ┆ f64       ┆ f64       │
╞════════════╪═══════════╪══════════╪══════════╪═══╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.024872 ┆ 0.02937  ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.024425 ┆ 0.027349 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.027227 ┆ 0.047868 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.03773  ┆ 0.042696 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.030505 ┆ 0.036907 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.029994 ┆ 0.030839 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.027063 ┆ 0.035125 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.031768 ┆ 0.034467 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-1 ┆ 0.0339   ┆ 0.033974 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-1 ┆ 0.031026 ┆ 0.03276  ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ …          ┆ …         ┆ …        ┆ …        ┆ … ┆ …         ┆ …         ┆ …         ┆ …         │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3196   ┆ 0.3373   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3355   ┆ 0.3415   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3359   ┆ 0.3565   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3553   ┆ 0.3881   ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.2       ┆ 0.8       │
│            ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3577   ┆ 0.3581   ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.0       ┆ 1.0       │
│            ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3511   ┆ 0.3547   ┆ … ┆ 0.8       ┆ 1.2       ┆ 1.0       ┆ 1.0       │
│            ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3383   ┆ 0.3548   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3417   ┆ 0.3632   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3194   ┆ 0.3243   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.316    ┆ 0.3317   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
└────────────┴───────────┴──────────┴──────────┴───┴───────────┴───────────┴───────────┴───────────┘
2024-11-20 23:06:56,505 - DEBUG - cur time: 2023-01-08T23:59:59.999 == next bar open time: 2023-01-09T00:00:00.000 == close pos time: 2023-01-16T00:00:00.000
2024-11-20 23:06:56,511 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ UNFIUSDT     ┆ -2.142995    ┆ 0    ┆ 132          │
│ TRBUSDT      ┆ -1.962053    ┆ 1    ┆ 131          │
│ 1000LUNCUSDT ┆ -1.908423    ┆ 2    ┆ 130          │
│ ICPUSDT      ┆ -1.883074    ┆ 3    ┆ 129          │
│ DOTUSDT      ┆ -1.879993    ┆ 4    ┆ 128          │
│ LDOUSDT      ┆ -1.735541    ┆ 5    ┆ 127          │
│ AAVEUSDT     ┆ -1.673961    ┆ 6    ┆ 126          │
│ FOOTBALLUSDT ┆ -1.617124    ┆ 7    ┆ 125          │
│ YFIUSDT      ┆ -1.584448    ┆ 8    ┆ 124          │
│ AXSUSDT      ┆ -1.576204    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CTSIUSDT     ┆ -0.041161    ┆ 123  ┆ 9            │
│ ZENUSDT      ┆ -0.01377     ┆ 124  ┆ 8            │
│ BLZUSDT      ┆ 0.00809      ┆ 125  ┆ 7            │
│ ARPAUSDT     ┆ 0.039205     ┆ 126  ┆ 6            │
│ SKLUSDT      ┆ 0.053183     ┆ 127  ┆ 5            │
│ KSMUSDT      ┆ 0.082113     ┆ 128  ┆ 4            │
│ API3USDT     ┆ 0.103579     ┆ 129  ┆ 3            │
│ IOTXUSDT     ┆ 0.197656     ┆ 130  ┆ 2            │
│ TOMOUSDT     ┆ 0.253422     ┆ 131  ┆ 1            │
│ DUSKUSDT     ┆ 0.611623     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:56,518 - WARNING - 2023-01-08T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:56,519 - INFO - cur close time: 2023-01-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:56,519 - DEBUG - mean expected ret (mean factor): -0.8312081766067181
2024-11-20 23:06:56,523 - DEBUG - begin to update pos: =========
2024-11-20 23:06:56,523 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,524 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1585      ┆ null        ┆ … ┆ 0.02177 ┆ null   ┆ null    ┆ 0.166   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,529 - DEBUG - update position: 2023-01-08T23:59:59.999 === diff_trading_value: 200000.0 == cash: 99800.0 
2024-11-20 23:06:56,533 - DEBUG - cur time: 2023-01-09T23:59:59.999 == next bar open time: 2023-01-10T00:00:00.000 == close pos time: 2023-01-17T00:00:00.000
2024-11-20 23:06:56,534 - INFO - pnl: 2023-01-09T23:59:59.999 100568.40526848004 === 0.770%
2024-11-20 23:06:56,537 - DEBUG - cur time: 2023-01-10T23:59:59.999 == next bar open time: 2023-01-11T00:00:00.000 == close pos time: 2023-01-18T00:00:00.000
2024-11-20 23:06:56,538 - INFO - pnl: 2023-01-10T23:59:59.999 101002.57474315798 === 0.432%
2024-11-20 23:06:56,541 - DEBUG - cur time: 2023-01-11T23:59:59.999 == next bar open time: 2023-01-12T00:00:00.000 == close pos time: 2023-01-19T00:00:00.000
2024-11-20 23:06:56,542 - INFO - pnl: 2023-01-11T23:59:59.999 101680.36552651627 === 0.671%
2024-11-20 23:06:56,544 - DEBUG - cur time: 2023-01-12T23:59:59.999 == next bar open time: 2023-01-13T00:00:00.000 == close pos time: 2023-01-20T00:00:00.000
2024-11-20 23:06:56,545 - INFO - pnl: 2023-01-12T23:59:59.999 100624.34412411085 === -1.039%
2024-11-20 23:06:56,548 - DEBUG - cur time: 2023-01-13T23:59:59.999 == next bar open time: 2023-01-14T00:00:00.000 == close pos time: 2023-01-21T00:00:00.000
2024-11-20 23:06:56,549 - INFO - pnl: 2023-01-13T23:59:59.999 100508.09448223782 === -0.116%
2024-11-20 23:06:56,551 - DEBUG - cur time: 2023-01-14T23:59:59.999 == next bar open time: 2023-01-15T00:00:00.000 == close pos time: 2023-01-22T00:00:00.000
2024-11-20 23:06:56,554 - INFO - pnl: 2023-01-14T23:59:59.999 99547.32953087 === -0.956%
2024-11-20 23:06:56,557 - DEBUG - cur time: 2023-01-15T23:59:59.999 == next bar open time: 2023-01-16T00:00:00.000 == close pos time: 2023-01-23T00:00:00.000
2024-11-20 23:06:56,566 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ENSUSDT      ┆ -1.942368    ┆ 0    ┆ 132          │
│ LUNA2USDT    ┆ -1.868957    ┆ 1    ┆ 131          │
│ AAVEUSDT     ┆ -1.862981    ┆ 2    ┆ 130          │
│ 1000LUNCUSDT ┆ -1.758802    ┆ 3    ┆ 129          │
│ ICPUSDT      ┆ -1.741199    ┆ 4    ┆ 128          │
│ DASHUSDT     ┆ -1.667196    ┆ 5    ┆ 127          │
│ NEOUSDT      ┆ -1.606792    ┆ 6    ┆ 126          │
│ ZECUSDT      ┆ -1.587238    ┆ 7    ┆ 125          │
│ EOSUSDT      ┆ -1.576868    ┆ 8    ┆ 124          │
│ INJUSDT      ┆ -1.538397    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ FLMUSDT      ┆ -0.112244    ┆ 123  ┆ 9            │
│ CTSIUSDT     ┆ -0.106303    ┆ 124  ┆ 8            │
│ ONEUSDT      ┆ -0.020722    ┆ 125  ┆ 7            │
│ STMXUSDT     ┆ -0.002921    ┆ 126  ┆ 6            │
│ CELRUSDT     ┆ 0.058357     ┆ 127  ┆ 5            │
│ BLZUSDT      ┆ 0.059617     ┆ 128  ┆ 4            │
│ TOMOUSDT     ┆ 0.06258      ┆ 129  ┆ 3            │
│ IOSTUSDT     ┆ 0.137749     ┆ 130  ┆ 2            │
│ ARPAUSDT     ┆ 0.214786     ┆ 131  ┆ 1            │
│ DEFIUSDT     ┆ 0.252295     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:56,575 - WARNING - 2023-01-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:56,575 - INFO - cur close time: 2023-01-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:56,576 - DEBUG - mean expected ret (mean factor): -0.8196454674422513
2024-11-20 23:06:56,581 - DEBUG - begin to update pos: =========
2024-11-20 23:06:56,581 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,582 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1808      ┆ null        ┆ … ┆ 0.02594 ┆ null   ┆ null    ┆ 0.2037  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,588 - DEBUG - update position: 2023-01-15T23:59:59.999 === diff_trading_value: 261723.0177573407 == cash: 98053.75264577757 
2024-11-20 23:06:56,589 - INFO - pnl: 2023-01-15T23:59:59.999 98053.75264577757 === -1.500%
2024-11-20 23:06:56,592 - DEBUG - cur time: 2023-01-16T23:59:59.999 == next bar open time: 2023-01-17T00:00:00.000 == close pos time: 2023-01-24T00:00:00.000
2024-11-20 23:06:56,593 - INFO - pnl: 2023-01-16T23:59:59.999 98874.05081182547 === 0.837%
2024-11-20 23:06:56,596 - DEBUG - cur time: 2023-01-17T23:59:59.999 == next bar open time: 2023-01-18T00:00:00.000 == close pos time: 2023-01-25T00:00:00.000
2024-11-20 23:06:56,597 - INFO - pnl: 2023-01-17T23:59:59.999 98943.21976748957 === 0.070%
2024-11-20 23:06:56,599 - DEBUG - cur time: 2023-01-18T23:59:59.999 == next bar open time: 2023-01-19T00:00:00.000 == close pos time: 2023-01-26T00:00:00.000
2024-11-20 23:06:56,601 - INFO - pnl: 2023-01-18T23:59:59.999 96742.45864774339 === -2.224%
2024-11-20 23:06:56,603 - DEBUG - cur time: 2023-01-19T23:59:59.999 == next bar open time: 2023-01-20T00:00:00.000 == close pos time: 2023-01-27T00:00:00.000
2024-11-20 23:06:56,604 - INFO - pnl: 2023-01-19T23:59:59.999 94921.65896570403 === -1.882%
2024-11-20 23:06:56,607 - DEBUG - cur time: 2023-01-20T23:59:59.999 == next bar open time: 2023-01-21T00:00:00.000 == close pos time: 2023-01-28T00:00:00.000
2024-11-20 23:06:56,607 - INFO - pnl: 2023-01-20T23:59:59.999 97683.33167057966 === 2.909%
2024-11-20 23:06:56,610 - DEBUG - cur time: 2023-01-21T23:59:59.999 == next bar open time: 2023-01-22T00:00:00.000 == close pos time: 2023-01-29T00:00:00.000
2024-11-20 23:06:56,611 - INFO - pnl: 2023-01-21T23:59:59.999 96963.01141973906 === -0.737%
2024-11-20 23:06:56,613 - DEBUG - cur time: 2023-01-22T23:59:59.999 == next bar open time: 2023-01-23T00:00:00.000 == close pos time: 2023-01-30T00:00:00.000
2024-11-20 23:06:56,620 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT      ┆ -2.013736    ┆ 0    ┆ 132          │
│ LUNA2USDT    ┆ -1.958101    ┆ 1    ┆ 131          │
│ INJUSDT      ┆ -1.760474    ┆ 2    ┆ 130          │
│ KSMUSDT      ┆ -1.756075    ┆ 3    ┆ 129          │
│ UNFIUSDT     ┆ -1.747295    ┆ 4    ┆ 128          │
│ APEUSDT      ┆ -1.726545    ┆ 5    ┆ 127          │
│ LITUSDT      ┆ -1.688506    ┆ 6    ┆ 126          │
│ 1000LUNCUSDT ┆ -1.653139    ┆ 7    ┆ 125          │
│ ATOMUSDT     ┆ -1.610047    ┆ 8    ┆ 124          │
│ MATICUSDT    ┆ -1.606846    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BALUSDT      ┆ -0.149747    ┆ 123  ┆ 9            │
│ 1000XECUSDT  ┆ -0.122748    ┆ 124  ┆ 8            │
│ HNTUSDT      ┆ -0.11707     ┆ 125  ┆ 7            │
│ GTCUSDT      ┆ -0.075768    ┆ 126  ┆ 6            │
│ DARUSDT      ┆ 0.026009     ┆ 127  ┆ 5            │
│ SKLUSDT      ┆ 0.079178     ┆ 128  ┆ 4            │
│ ARPAUSDT     ┆ 0.11426      ┆ 129  ┆ 3            │
│ BTCDOMUSDT   ┆ 0.265722     ┆ 130  ┆ 2            │
│ TOMOUSDT     ┆ 0.63464      ┆ 131  ┆ 1            │
│ DEFIUSDT     ┆ 0.710206     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:56,626 - WARNING - 2023-01-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:56,626 - INFO - cur close time: 2023-01-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:56,626 - DEBUG - mean expected ret (mean factor): -0.8156768933196109
2024-11-20 23:06:56,630 - DEBUG - begin to update pos: =========
2024-11-20 23:06:56,630 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,630 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1816      ┆ null        ┆ … ┆ 0.027   ┆ null   ┆ null    ┆ 0.2277  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,636 - DEBUG - update position: 2023-01-22T23:59:59.999 === diff_trading_value: 261679.35729334815 == cash: 97647.51177398338 
2024-11-20 23:06:56,637 - INFO - pnl: 2023-01-22T23:59:59.999 97647.51177398338 === 0.706%
2024-11-20 23:06:56,640 - DEBUG - cur time: 2023-01-23T23:59:59.999 == next bar open time: 2023-01-24T00:00:00.000 == close pos time: 2023-01-31T00:00:00.000
2024-11-20 23:06:56,640 - INFO - pnl: 2023-01-23T23:59:59.999 99162.18899939375 === 1.551%
2024-11-20 23:06:56,643 - DEBUG - cur time: 2023-01-24T23:59:59.999 == next bar open time: 2023-01-25T00:00:00.000 == close pos time: 2023-02-01T00:00:00.000
2024-11-20 23:06:56,645 - INFO - pnl: 2023-01-24T23:59:59.999 102646.13605321354 === 3.513%
2024-11-20 23:06:56,648 - DEBUG - cur time: 2023-01-25T23:59:59.999 == next bar open time: 2023-01-26T00:00:00.000 == close pos time: 2023-02-02T00:00:00.000
2024-11-20 23:06:56,649 - INFO - pnl: 2023-01-25T23:59:59.999 97857.36518105178 === -4.665%
2024-11-20 23:06:56,651 - DEBUG - cur time: 2023-01-26T23:59:59.999 == next bar open time: 2023-01-27T00:00:00.000 == close pos time: 2023-02-03T00:00:00.000
2024-11-20 23:06:56,652 - INFO - pnl: 2023-01-26T23:59:59.999 98588.46021027339 === 0.747%
2024-11-20 23:06:56,655 - DEBUG - cur time: 2023-01-27T23:59:59.999 == next bar open time: 2023-01-28T00:00:00.000 == close pos time: 2023-02-04T00:00:00.000
2024-11-20 23:06:56,656 - INFO - pnl: 2023-01-27T23:59:59.999 99753.43496655369 === 1.182%
2024-11-20 23:06:56,658 - DEBUG - cur time: 2023-01-28T23:59:59.999 == next bar open time: 2023-01-29T00:00:00.000 == close pos time: 2023-02-05T00:00:00.000
2024-11-20 23:06:56,660 - INFO - pnl: 2023-01-28T23:59:59.999 100386.08582634486 === 0.634%
2024-11-20 23:06:56,663 - DEBUG - cur time: 2023-01-29T23:59:59.999 == next bar open time: 2023-01-30T00:00:00.000 == close pos time: 2023-02-06T00:00:00.000
2024-11-20 23:06:56,669 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LUNA2USDT    ┆ -2.11734     ┆ 0    ┆ 134          │
│ COMPUSDT     ┆ -1.73503     ┆ 1    ┆ 133          │
│ BNBUSDT      ┆ -1.698847    ┆ 2    ┆ 132          │
│ DASHUSDT     ┆ -1.688403    ┆ 3    ┆ 131          │
│ LDOUSDT      ┆ -1.687034    ┆ 4    ┆ 130          │
│ FOOTBALLUSDT ┆ -1.682814    ┆ 5    ┆ 129          │
│ QNTUSDT      ┆ -1.659409    ┆ 6    ┆ 128          │
│ FILUSDT      ┆ -1.632668    ┆ 7    ┆ 127          │
│ 1000LUNCUSDT ┆ -1.584526    ┆ 8    ┆ 126          │
│ LITUSDT      ┆ -1.576241    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ONTUSDT      ┆ -0.074217    ┆ 125  ┆ 9            │
│ QTUMUSDT     ┆ -0.066201    ┆ 126  ┆ 8            │
│ GALUSDT      ┆ -0.059625    ┆ 127  ┆ 7            │
│ ANTUSDT      ┆ -0.04762     ┆ 128  ┆ 6            │
│ BLZUSDT      ┆ 0.009912     ┆ 129  ┆ 5            │
│ TOMOUSDT     ┆ 0.155431     ┆ 130  ┆ 4            │
│ ARPAUSDT     ┆ 0.200176     ┆ 131  ┆ 3            │
│ DGBUSDT      ┆ 0.288516     ┆ 132  ┆ 2            │
│ SKLUSDT      ┆ 0.367932     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 2.371        ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:56,677 - WARNING - 2023-01-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:56,677 - INFO - cur close time: 2023-01-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:56,677 - DEBUG - mean expected ret (mean factor): -0.8208553350279464
2024-11-20 23:06:56,681 - DEBUG - begin to update pos: =========
2024-11-20 23:06:56,682 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,682 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1762      ┆ null        ┆ … ┆ 0.02958 ┆ null   ┆ null    ┆ 0.2355  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,688 - DEBUG - update position: 2023-01-29T23:59:59.999 === diff_trading_value: 263634.2983031372 == cash: 100248.64733640377 
2024-11-20 23:06:56,690 - INFO - pnl: 2023-01-29T23:59:59.999 100248.64733640377 === -0.137%
2024-11-20 23:06:56,693 - DEBUG - cur time: 2023-01-30T23:59:59.999 == next bar open time: 2023-01-31T00:00:00.000 == close pos time: 2023-02-07T00:00:00.000
2024-11-20 23:06:56,695 - INFO - pnl: 2023-01-30T23:59:59.999 101663.34839735951 === 1.411%
2024-11-20 23:06:56,698 - DEBUG - cur time: 2023-01-31T23:59:59.999 == next bar open time: 2023-02-01T00:00:00.000 == close pos time: 2023-02-08T00:00:00.000
2024-11-20 23:06:56,699 - INFO - pnl: 2023-01-31T23:59:59.999 101459.89091753782 === -0.200%
2024-11-20 23:06:56,702 - DEBUG - cur time: 2023-02-01T23:59:59.999 == next bar open time: 2023-02-02T00:00:00.000 == close pos time: 2023-02-09T00:00:00.000
2024-11-20 23:06:56,704 - INFO - pnl: 2023-02-01T23:59:59.999 102447.01548716263 === 0.973%
2024-11-20 23:06:56,706 - DEBUG - cur time: 2023-02-02T23:59:59.999 == next bar open time: 2023-02-03T00:00:00.000 == close pos time: 2023-02-10T00:00:00.000
2024-11-20 23:06:56,707 - INFO - pnl: 2023-02-02T23:59:59.999 105361.82596295414 === 2.845%
2024-11-20 23:06:56,710 - DEBUG - cur time: 2023-02-03T23:59:59.999 == next bar open time: 2023-02-04T00:00:00.000 == close pos time: 2023-02-11T00:00:00.000
2024-11-20 23:06:56,711 - INFO - pnl: 2023-02-03T23:59:59.999 103608.17621795625 === -1.664%
2024-11-20 23:06:56,714 - DEBUG - cur time: 2023-02-04T23:59:59.999 == next bar open time: 2023-02-05T00:00:00.000 == close pos time: 2023-02-12T00:00:00.000
2024-11-20 23:06:56,715 - INFO - pnl: 2023-02-04T23:59:59.999 106568.53069948473 === 2.857%
2024-11-20 23:06:56,718 - DEBUG - cur time: 2023-02-05T23:59:59.999 == next bar open time: 2023-02-06T00:00:00.000 == close pos time: 2023-02-13T00:00:00.000
2024-11-20 23:06:56,724 - DEBUG - sorted_long_factors: shape: (135, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ICPUSDT   ┆ -1.589509    ┆ 0    ┆ 134          │
│ MTLUSDT   ┆ -1.577957    ┆ 1    ┆ 133          │
│ RLCUSDT   ┆ -1.577952    ┆ 2    ┆ 132          │
│ BNBUSDT   ┆ -1.520794    ┆ 3    ┆ 131          │
│ UNIUSDT   ┆ -1.506618    ┆ 4    ┆ 130          │
│ LUNA2USDT ┆ -1.493431    ┆ 5    ┆ 129          │
│ APTUSDT   ┆ -1.465595    ┆ 6    ┆ 128          │
│ XTZUSDT   ┆ -1.465457    ┆ 7    ┆ 127          │
│ ATOMUSDT  ┆ -1.454228    ┆ 8    ┆ 126          │
│ AXSUSDT   ┆ -1.444641    ┆ 9    ┆ 125          │
│ …         ┆ …            ┆ …    ┆ …            │
│ TOMOUSDT  ┆ -0.20605     ┆ 125  ┆ 9            │
│ SKLUSDT   ┆ -0.197043    ┆ 126  ┆ 8            │
│ ARPAUSDT  ┆ -0.184008    ┆ 127  ┆ 7            │
│ HNTUSDT   ┆ -0.099683    ┆ 128  ┆ 6            │
│ DENTUSDT  ┆ -0.08777     ┆ 129  ┆ 5            │
│ CTSIUSDT  ┆ 0.095866     ┆ 130  ┆ 4            │
│ KSMUSDT   ┆ 0.181051     ┆ 131  ┆ 3            │
│ API3USDT  ┆ 0.196244     ┆ 132  ┆ 2            │
│ DGBUSDT   ┆ 0.430846     ┆ 133  ┆ 1            │
│ DEFIUSDT  ┆ 2.152188     ┆ 134  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:56,730 - INFO - cur close time: 2023-02-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:06:56,730 - DEBUG - mean expected ret (mean factor): -0.8091004617979871
2024-11-20 23:06:56,734 - DEBUG - begin to update pos: =========
2024-11-20 23:06:56,735 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,735 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1814      ┆ null        ┆ … ┆ 0.02882 ┆ null   ┆ null    ┆ 0.249   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,741 - DEBUG - update position: 2023-02-05T23:59:59.999 === diff_trading_value: 281259.733726647 == cash: 106919.4073209448 
2024-11-20 23:06:56,742 - INFO - pnl: 2023-02-05T23:59:59.999 106919.4073209448 === 0.329%
2024-11-20 23:06:56,745 - DEBUG - cur time: 2023-02-06T23:59:59.999 == next bar open time: 2023-02-07T00:00:00.000 == close pos time: 2023-02-14T00:00:00.000
2024-11-20 23:06:56,746 - INFO - pnl: 2023-02-06T23:59:59.999 108780.9079851643 === 1.741%
2024-11-20 23:06:56,749 - DEBUG - cur time: 2023-02-07T23:59:59.999 == next bar open time: 2023-02-08T00:00:00.000 == close pos time: 2023-02-15T00:00:00.000
2024-11-20 23:06:56,750 - INFO - pnl: 2023-02-07T23:59:59.999 112743.08364869092 === 3.642%
2024-11-20 23:06:56,753 - DEBUG - cur time: 2023-02-08T23:59:59.999 == next bar open time: 2023-02-09T00:00:00.000 == close pos time: 2023-02-16T00:00:00.000
2024-11-20 23:06:56,755 - INFO - pnl: 2023-02-08T23:59:59.999 112464.97683043528 === -0.247%
2024-11-20 23:06:56,758 - DEBUG - cur time: 2023-02-09T23:59:59.999 == next bar open time: 2023-02-10T00:00:00.000 == close pos time: 2023-02-17T00:00:00.000
2024-11-20 23:06:56,760 - INFO - pnl: 2023-02-09T23:59:59.999 111031.53150794788 === -1.275%
2024-11-20 23:06:56,763 - DEBUG - cur time: 2023-02-10T23:59:59.999 == next bar open time: 2023-02-11T00:00:00.000 == close pos time: 2023-02-18T00:00:00.000
2024-11-20 23:06:56,764 - INFO - pnl: 2023-02-10T23:59:59.999 113210.66280511793 === 1.963%
2024-11-20 23:06:56,767 - DEBUG - cur time: 2023-02-11T23:59:59.999 == next bar open time: 2023-02-12T00:00:00.000 == close pos time: 2023-02-19T00:00:00.000
2024-11-20 23:06:56,769 - INFO - pnl: 2023-02-11T23:59:59.999 115252.59980201002 === 1.804%
2024-11-20 23:06:56,774 - DEBUG - cur time: 2023-02-12T23:59:59.999 == next bar open time: 2023-02-13T00:00:00.000 == close pos time: 2023-02-20T00:00:00.000
2024-11-20 23:06:56,781 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LDOUSDT      ┆ -1.933746    ┆ 0    ┆ 135          │
│ BNBUSDT      ┆ -1.797587    ┆ 1    ┆ 134          │
│ NEARUSDT     ┆ -1.7347      ┆ 2    ┆ 133          │
│ LITUSDT      ┆ -1.728023    ┆ 3    ┆ 132          │
│ STGUSDT      ┆ -1.541614    ┆ 4    ┆ 131          │
│ TRXUSDT      ┆ -1.511822    ┆ 5    ┆ 130          │
│ AXSUSDT      ┆ -1.47877     ┆ 6    ┆ 129          │
│ INJUSDT      ┆ -1.472826    ┆ 7    ┆ 128          │
│ TRBUSDT      ┆ -1.472377    ┆ 8    ┆ 127          │
│ CRVUSDT      ┆ -1.471754    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ FTMUSDT      ┆ -0.113064    ┆ 126  ┆ 9            │
│ XMRUSDT      ┆ -0.107901    ┆ 127  ┆ 8            │
│ TOMOUSDT     ┆ -0.105168    ┆ 128  ┆ 7            │
│ CELRUSDT     ┆ -0.04519     ┆ 129  ┆ 6            │
│ LINAUSDT     ┆ 0.00274      ┆ 130  ┆ 5            │
│ DENTUSDT     ┆ 0.02481      ┆ 131  ┆ 4            │
│ BLUEBIRDUSDT ┆ 0.576985     ┆ 132  ┆ 3            │
│ ANTUSDT      ┆ 0.587591     ┆ 133  ┆ 2            │
│ DGBUSDT      ┆ 0.803383     ┆ 134  ┆ 1            │
│ DEFIUSDT     ┆ 1.174381     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:56,787 - INFO - cur close time: 2023-02-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:06:56,787 - DEBUG - mean expected ret (mean factor): -0.8031861100270218
2024-11-20 23:06:56,792 - DEBUG - begin to update pos: =========
2024-11-20 23:06:56,792 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,792 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1651      ┆ null        ┆ … ┆ 0.02919 ┆ null   ┆ null    ┆ 0.234   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,797 - DEBUG - update position: 2023-02-12T23:59:59.999 === diff_trading_value: 271994.0342958133 == cash: 118076.13531437481 
2024-11-20 23:06:56,798 - INFO - pnl: 2023-02-12T23:59:59.999 118076.13531437481 === 2.450%
2024-11-20 23:06:56,802 - DEBUG - cur time: 2023-02-13T23:59:59.999 == next bar open time: 2023-02-14T00:00:00.000 == close pos time: 2023-02-21T00:00:00.000
2024-11-20 23:06:56,802 - INFO - pnl: 2023-02-13T23:59:59.999 117427.28592018464 === -0.550%
2024-11-20 23:06:56,805 - DEBUG - cur time: 2023-02-14T23:59:59.999 == next bar open time: 2023-02-15T00:00:00.000 == close pos time: 2023-02-22T00:00:00.000
2024-11-20 23:06:56,806 - INFO - pnl: 2023-02-14T23:59:59.999 117197.18572607251 === -0.196%
2024-11-20 23:06:56,809 - DEBUG - cur time: 2023-02-15T23:59:59.999 == next bar open time: 2023-02-16T00:00:00.000 == close pos time: 2023-02-23T00:00:00.000
2024-11-20 23:06:56,811 - INFO - pnl: 2023-02-15T23:59:59.999 112926.32565919458 === -3.644%
2024-11-20 23:06:56,813 - DEBUG - cur time: 2023-02-16T23:59:59.999 == next bar open time: 2023-02-17T00:00:00.000 == close pos time: 2023-02-24T00:00:00.000
2024-11-20 23:06:56,814 - INFO - pnl: 2023-02-16T23:59:59.999 112538.65838993451 === -0.343%
2024-11-20 23:06:56,817 - DEBUG - cur time: 2023-02-17T23:59:59.999 == next bar open time: 2023-02-18T00:00:00.000 == close pos time: 2023-02-25T00:00:00.000
2024-11-20 23:06:56,819 - INFO - pnl: 2023-02-17T23:59:59.999 111540.9323891082 === -0.887%
2024-11-20 23:06:56,821 - DEBUG - cur time: 2023-02-18T23:59:59.999 == next bar open time: 2023-02-19T00:00:00.000 == close pos time: 2023-02-26T00:00:00.000
2024-11-20 23:06:56,824 - INFO - pnl: 2023-02-18T23:59:59.999 108261.58566214239 === -2.940%
2024-11-20 23:06:56,827 - DEBUG - cur time: 2023-02-19T23:59:59.999 == next bar open time: 2023-02-20T00:00:00.000 == close pos time: 2023-02-27T00:00:00.000
2024-11-20 23:06:56,836 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ COMPUSDT     ┆ -1.926228    ┆ 0    ┆ 135          │
│ 1000LUNCUSDT ┆ -1.601081    ┆ 1    ┆ 134          │
│ LUNA2USDT    ┆ -1.551485    ┆ 2    ┆ 133          │
│ ICPUSDT      ┆ -1.540799    ┆ 3    ┆ 132          │
│ MKRUSDT      ┆ -1.522538    ┆ 4    ┆ 131          │
│ NEARUSDT     ┆ -1.521242    ┆ 5    ┆ 130          │
│ ZECUSDT      ┆ -1.517814    ┆ 6    ┆ 129          │
│ SANDUSDT     ┆ -1.462514    ┆ 7    ┆ 128          │
│ KAVAUSDT     ┆ -1.454946    ┆ 8    ┆ 127          │
│ STGUSDT      ┆ -1.429723    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ API3USDT     ┆ -0.199987    ┆ 126  ┆ 9            │
│ XEMUSDT      ┆ -0.183174    ┆ 127  ┆ 8            │
│ DUSKUSDT     ┆ -0.170048    ┆ 128  ┆ 7            │
│ ANTUSDT      ┆ -0.169528    ┆ 129  ┆ 6            │
│ LINAUSDT     ┆ -0.152117    ┆ 130  ┆ 5            │
│ TOMOUSDT     ┆ 0.003667     ┆ 131  ┆ 4            │
│ DGBUSDT      ┆ 0.191495     ┆ 132  ┆ 3            │
│ 1000XECUSDT  ┆ 0.288788     ┆ 133  ┆ 2            │
│ DEFIUSDT     ┆ 1.126589     ┆ 134  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.285946     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:56,843 - WARNING - 2023-02-19T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:56,843 - INFO - cur close time: 2023-02-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:56,844 - DEBUG - mean expected ret (mean factor): -0.7925448527442609
2024-11-20 23:06:56,848 - DEBUG - begin to update pos: =========
2024-11-20 23:06:56,849 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,849 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1683      ┆ null        ┆ … ┆ 0.03234 ┆ null   ┆ null    ┆ 0.2553  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,856 - DEBUG - update position: 2023-02-19T23:59:59.999 === diff_trading_value: 302868.06616671826 == cash: 112216.74832483975 
2024-11-20 23:06:56,857 - INFO - pnl: 2023-02-19T23:59:59.999 112216.74832483975 === 3.653%
2024-11-20 23:06:56,861 - DEBUG - cur time: 2023-02-20T23:59:59.999 == next bar open time: 2023-02-21T00:00:00.000 == close pos time: 2023-02-28T00:00:00.000
2024-11-20 23:06:56,863 - INFO - pnl: 2023-02-20T23:59:59.999 116224.87867971529 === 3.572%
2024-11-20 23:06:56,868 - DEBUG - cur time: 2023-02-21T23:59:59.999 == next bar open time: 2023-02-22T00:00:00.000 == close pos time: 2023-03-01T00:00:00.000
2024-11-20 23:06:56,870 - INFO - pnl: 2023-02-21T23:59:59.999 118800.3652053834 === 2.216%
2024-11-20 23:06:56,873 - DEBUG - cur time: 2023-02-22T23:59:59.999 == next bar open time: 2023-02-23T00:00:00.000 == close pos time: 2023-03-02T00:00:00.000
2024-11-20 23:06:56,874 - INFO - pnl: 2023-02-22T23:59:59.999 120055.44877749123 === 1.056%
2024-11-20 23:06:56,877 - DEBUG - cur time: 2023-02-23T23:59:59.999 == next bar open time: 2023-02-24T00:00:00.000 == close pos time: 2023-03-03T00:00:00.000
2024-11-20 23:06:56,879 - INFO - pnl: 2023-02-23T23:59:59.999 120842.14869239001 === 0.655%
2024-11-20 23:06:56,885 - DEBUG - cur time: 2023-02-24T23:59:59.999 == next bar open time: 2023-02-25T00:00:00.000 == close pos time: 2023-03-04T00:00:00.000
2024-11-20 23:06:56,887 - INFO - pnl: 2023-02-24T23:59:59.999 119585.70081292065 === -1.040%
2024-11-20 23:06:56,891 - DEBUG - cur time: 2023-02-25T23:59:59.999 == next bar open time: 2023-02-26T00:00:00.000 == close pos time: 2023-03-05T00:00:00.000
2024-11-20 23:06:56,893 - INFO - pnl: 2023-02-25T23:59:59.999 119846.99521727682 === 0.218%
2024-11-20 23:06:56,897 - DEBUG - cur time: 2023-02-26T23:59:59.999 == next bar open time: 2023-02-27T00:00:00.000 == close pos time: 2023-03-06T00:00:00.000
2024-11-20 23:06:56,906 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT      ┆ -1.734204    ┆ 0    ┆ 135          │
│ ZECUSDT      ┆ -1.713328    ┆ 1    ┆ 134          │
│ OPUSDT       ┆ -1.692152    ┆ 2    ┆ 133          │
│ COMPUSDT     ┆ -1.664885    ┆ 3    ┆ 132          │
│ XMRUSDT      ┆ -1.644724    ┆ 4    ┆ 131          │
│ AAVEUSDT     ┆ -1.614969    ┆ 5    ┆ 130          │
│ YFIUSDT      ┆ -1.600253    ┆ 6    ┆ 129          │
│ APTUSDT      ┆ -1.547279    ┆ 7    ┆ 128          │
│ UNFIUSDT     ┆ -1.509656    ┆ 8    ┆ 127          │
│ ENSUSDT      ┆ -1.486634    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DENTUSDT     ┆ 0.037405     ┆ 126  ┆ 9            │
│ COTIUSDT     ┆ 0.091172     ┆ 127  ┆ 8            │
│ LINAUSDT     ┆ 0.101646     ┆ 128  ┆ 7            │
│ STMXUSDT     ┆ 0.142966     ┆ 129  ┆ 6            │
│ 1000XECUSDT  ┆ 0.163678     ┆ 130  ┆ 5            │
│ ANTUSDT      ┆ 0.195218     ┆ 131  ┆ 4            │
│ DARUSDT      ┆ 0.3275       ┆ 132  ┆ 3            │
│ API3USDT     ┆ 0.463589     ┆ 133  ┆ 2            │
│ DEFIUSDT     ┆ 0.993919     ┆ 134  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.451674     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:56,915 - WARNING - 2023-02-26T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:56,915 - INFO - cur close time: 2023-02-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:56,915 - DEBUG - mean expected ret (mean factor): -0.7812742652740119
2024-11-20 23:06:56,920 - DEBUG - begin to update pos: =========
2024-11-20 23:06:56,921 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,921 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1632      ┆ null        ┆ … ┆ 0.03282 ┆ null   ┆ null    ┆ 0.2691  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,928 - DEBUG - update position: 2023-02-26T23:59:59.999 === diff_trading_value: 270045.7850145546 == cash: 117945.90206167688 
2024-11-20 23:06:56,929 - INFO - pnl: 2023-02-26T23:59:59.999 117945.90206167688 === -1.586%
2024-11-20 23:06:56,932 - DEBUG - cur time: 2023-02-27T23:59:59.999 == next bar open time: 2023-02-28T00:00:00.000 == close pos time: 2023-03-07T00:00:00.000
2024-11-20 23:06:56,933 - INFO - pnl: 2023-02-27T23:59:59.999 121616.1904085343 === 3.112%
2024-11-20 23:06:56,936 - DEBUG - cur time: 2023-02-28T23:59:59.999 == next bar open time: 2023-03-01T00:00:00.000 == close pos time: 2023-03-08T00:00:00.000
2024-11-20 23:06:56,938 - INFO - pnl: 2023-02-28T23:59:59.999 120931.18576249608 === -0.563%
2024-11-20 23:06:56,940 - DEBUG - cur time: 2023-03-01T23:59:59.999 == next bar open time: 2023-03-02T00:00:00.000 == close pos time: 2023-03-09T00:00:00.000
2024-11-20 23:06:56,942 - INFO - pnl: 2023-03-01T23:59:59.999 118563.1205382502 === -1.958%
2024-11-20 23:06:56,945 - DEBUG - cur time: 2023-03-02T23:59:59.999 == next bar open time: 2023-03-03T00:00:00.000 == close pos time: 2023-03-10T00:00:00.000
2024-11-20 23:06:56,946 - INFO - pnl: 2023-03-02T23:59:59.999 118035.23414431678 === -0.445%
2024-11-20 23:06:56,948 - DEBUG - cur time: 2023-03-03T23:59:59.999 == next bar open time: 2023-03-04T00:00:00.000 == close pos time: 2023-03-11T00:00:00.000
2024-11-20 23:06:56,950 - INFO - pnl: 2023-03-03T23:59:59.999 116966.22738887425 === -0.906%
2024-11-20 23:06:56,953 - DEBUG - cur time: 2023-03-04T23:59:59.999 == next bar open time: 2023-03-05T00:00:00.000 == close pos time: 2023-03-12T00:00:00.000
2024-11-20 23:06:56,955 - INFO - pnl: 2023-03-04T23:59:59.999 116645.61688571796 === -0.274%
2024-11-20 23:06:56,958 - DEBUG - cur time: 2023-03-05T23:59:59.999 == next bar open time: 2023-03-06T00:00:00.000 == close pos time: 2023-03-13T00:00:00.000
2024-11-20 23:06:56,966 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LUNA2USDT    ┆ -2.027075    ┆ 0    ┆ 135          │
│ 1000LUNCUSDT ┆ -1.967091    ┆ 1    ┆ 134          │
│ YFIUSDT      ┆ -1.934919    ┆ 2    ┆ 133          │
│ MKRUSDT      ┆ -1.754086    ┆ 3    ┆ 132          │
│ NEOUSDT      ┆ -1.747321    ┆ 4    ┆ 131          │
│ OPUSDT       ┆ -1.735806    ┆ 5    ┆ 130          │
│ FILUSDT      ┆ -1.63721     ┆ 6    ┆ 129          │
│ BTCDOMUSDT   ┆ -1.558705    ┆ 7    ┆ 128          │
│ DOTUSDT      ┆ -1.541071    ┆ 8    ┆ 127          │
│ EOSUSDT      ┆ -1.525366    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CTSIUSDT     ┆ 0.147387     ┆ 126  ┆ 9            │
│ SFPUSDT      ┆ 0.1928       ┆ 127  ┆ 8            │
│ API3USDT     ┆ 0.21116      ┆ 128  ┆ 7            │
│ CTKUSDT      ┆ 0.219545     ┆ 129  ┆ 6            │
│ 1000XECUSDT  ┆ 0.220077     ┆ 130  ┆ 5            │
│ DARUSDT      ┆ 0.238448     ┆ 131  ┆ 4            │
│ DGBUSDT      ┆ 0.314005     ┆ 132  ┆ 3            │
│ LPTUSDT      ┆ 0.358336     ┆ 133  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.82105      ┆ 134  ┆ 1            │
│ DEFIUSDT     ┆ 0.933574     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:56,973 - WARNING - 2023-03-05T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:56,973 - INFO - cur close time: 2023-03-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:56,973 - DEBUG - mean expected ret (mean factor): -0.7551452946800624
2024-11-20 23:06:56,977 - DEBUG - begin to update pos: =========
2024-11-20 23:06:56,978 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,978 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1445      ┆ null        ┆ … ┆ 0.02755 ┆ null   ┆ null    ┆ 0.2377  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:56,985 - DEBUG - update position: 2023-03-05T23:59:59.999 === diff_trading_value: 260399.3352592026 == cash: 116415.11346001043 
2024-11-20 23:06:56,986 - INFO - pnl: 2023-03-05T23:59:59.999 116415.11346001043 === -0.198%
2024-11-20 23:06:56,989 - DEBUG - cur time: 2023-03-06T23:59:59.999 == next bar open time: 2023-03-07T00:00:00.000 == close pos time: 2023-03-14T00:00:00.000
2024-11-20 23:06:56,991 - INFO - pnl: 2023-03-06T23:59:59.999 118192.76201690262 === 1.527%
2024-11-20 23:06:56,994 - DEBUG - cur time: 2023-03-07T23:59:59.999 == next bar open time: 2023-03-08T00:00:00.000 == close pos time: 2023-03-15T00:00:00.000
2024-11-20 23:06:56,996 - INFO - pnl: 2023-03-07T23:59:59.999 118197.08587920376 === 0.004%
2024-11-20 23:06:56,999 - DEBUG - cur time: 2023-03-08T23:59:59.999 == next bar open time: 2023-03-09T00:00:00.000 == close pos time: 2023-03-16T00:00:00.000
2024-11-20 23:06:57,002 - INFO - pnl: 2023-03-08T23:59:59.999 118484.26109498694 === 0.243%
2024-11-20 23:06:57,004 - DEBUG - cur time: 2023-03-09T23:59:59.999 == next bar open time: 2023-03-10T00:00:00.000 == close pos time: 2023-03-17T00:00:00.000
2024-11-20 23:06:57,007 - INFO - pnl: 2023-03-09T23:59:59.999 117160.4828178627 === -1.117%
2024-11-20 23:06:57,011 - DEBUG - cur time: 2023-03-10T23:59:59.999 == next bar open time: 2023-03-11T00:00:00.000 == close pos time: 2023-03-18T00:00:00.000
2024-11-20 23:06:57,012 - INFO - pnl: 2023-03-10T23:59:59.999 118530.12234540767 === 1.169%
2024-11-20 23:06:57,017 - DEBUG - cur time: 2023-03-11T23:59:59.999 == next bar open time: 2023-03-12T00:00:00.000 == close pos time: 2023-03-19T00:00:00.000
2024-11-20 23:06:57,019 - INFO - pnl: 2023-03-11T23:59:59.999 120941.989850222 === 2.035%
2024-11-20 23:06:57,022 - DEBUG - cur time: 2023-03-12T23:59:59.999 == next bar open time: 2023-03-13T00:00:00.000 == close pos time: 2023-03-20T00:00:00.000
2024-11-20 23:06:57,029 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -2.06679     ┆ 0    ┆ 135          │
│ NEOUSDT      ┆ -2.03051     ┆ 1    ┆ 134          │
│ 1000LUNCUSDT ┆ -2.013594    ┆ 2    ┆ 133          │
│ EOSUSDT      ┆ -1.988008    ┆ 3    ┆ 132          │
│ XRPUSDT      ┆ -1.908299    ┆ 4    ┆ 131          │
│ 1000SHIBUSDT ┆ -1.80408     ┆ 5    ┆ 130          │
│ FOOTBALLUSDT ┆ -1.636601    ┆ 6    ┆ 129          │
│ KAVAUSDT     ┆ -1.634612    ┆ 7    ┆ 128          │
│ GTCUSDT      ┆ -1.597136    ┆ 8    ┆ 127          │
│ APTUSDT      ┆ -1.583206    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TRBUSDT      ┆ -0.005957    ┆ 126  ┆ 9            │
│ DASHUSDT     ┆ 0.113808     ┆ 127  ┆ 8            │
│ ANTUSDT      ┆ 0.137384     ┆ 128  ┆ 7            │
│ DGBUSDT      ┆ 0.18434      ┆ 129  ┆ 6            │
│ BLUEBIRDUSDT ┆ 0.20626      ┆ 130  ┆ 5            │
│ 1000XECUSDT  ┆ 0.327866     ┆ 131  ┆ 4            │
│ CTSIUSDT     ┆ 0.547488     ┆ 132  ┆ 3            │
│ ARPAUSDT     ┆ 0.587286     ┆ 133  ┆ 2            │
│ HNTUSDT      ┆ 0.632254     ┆ 134  ┆ 1            │
│ DEFIUSDT     ┆ 1.77008      ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,036 - WARNING - 2023-03-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,036 - INFO - cur close time: 2023-03-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:57,036 - DEBUG - mean expected ret (mean factor): -0.7605707045635115
2024-11-20 23:06:57,041 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,041 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,042 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1286      ┆ null        ┆ … ┆ 0.02442 ┆ null   ┆ null    ┆ 0.2129  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,048 - DEBUG - update position: 2023-03-12T23:59:59.999 === diff_trading_value: 232013.24212115997 == cash: 120434.66182768953 
2024-11-20 23:06:57,050 - INFO - pnl: 2023-03-12T23:59:59.999 120434.66182768953 === -0.419%
2024-11-20 23:06:57,053 - DEBUG - cur time: 2023-03-13T23:59:59.999 == next bar open time: 2023-03-14T00:00:00.000 == close pos time: 2023-03-21T00:00:00.000
2024-11-20 23:06:57,053 - INFO - pnl: 2023-03-13T23:59:59.999 116159.0763281928 === -3.550%
2024-11-20 23:06:57,056 - DEBUG - cur time: 2023-03-14T23:59:59.999 == next bar open time: 2023-03-15T00:00:00.000 == close pos time: 2023-03-22T00:00:00.000
2024-11-20 23:06:57,057 - INFO - pnl: 2023-03-14T23:59:59.999 116708.70107532619 === 0.473%
2024-11-20 23:06:57,060 - DEBUG - cur time: 2023-03-15T23:59:59.999 == next bar open time: 2023-03-16T00:00:00.000 == close pos time: 2023-03-23T00:00:00.000
2024-11-20 23:06:57,061 - INFO - pnl: 2023-03-15T23:59:59.999 114336.98193392661 === -2.032%
2024-11-20 23:06:57,065 - DEBUG - cur time: 2023-03-16T23:59:59.999 == next bar open time: 2023-03-17T00:00:00.000 == close pos time: 2023-03-24T00:00:00.000
2024-11-20 23:06:57,066 - INFO - pnl: 2023-03-16T23:59:59.999 115834.12389528466 === 1.309%
2024-11-20 23:06:57,069 - DEBUG - cur time: 2023-03-17T23:59:59.999 == next bar open time: 2023-03-18T00:00:00.000 == close pos time: 2023-03-25T00:00:00.000
2024-11-20 23:06:57,070 - INFO - pnl: 2023-03-17T23:59:59.999 115181.77077063557 === -0.563%
2024-11-20 23:06:57,073 - DEBUG - cur time: 2023-03-18T23:59:59.999 == next bar open time: 2023-03-19T00:00:00.000 == close pos time: 2023-03-26T00:00:00.000
2024-11-20 23:06:57,074 - INFO - pnl: 2023-03-18T23:59:59.999 111931.32458114481 === -2.822%
2024-11-20 23:06:57,077 - DEBUG - cur time: 2023-03-19T23:59:59.999 == next bar open time: 2023-03-20T00:00:00.000 == close pos time: 2023-03-27T00:00:00.000
2024-11-20 23:06:57,085 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ FILUSDT      ┆ -1.887024    ┆ 0    ┆ 134          │
│ LUNA2USDT    ┆ -1.837458    ┆ 1    ┆ 133          │
│ AXSUSDT      ┆ -1.811838    ┆ 2    ┆ 132          │
│ MASKUSDT     ┆ -1.711334    ┆ 3    ┆ 131          │
│ NEOUSDT      ┆ -1.693331    ┆ 4    ┆ 130          │
│ 1000LUNCUSDT ┆ -1.681149    ┆ 5    ┆ 129          │
│ BNBUSDT      ┆ -1.599028    ┆ 6    ┆ 128          │
│ XRPUSDT      ┆ -1.573408    ┆ 7    ┆ 127          │
│ GTCUSDT      ┆ -1.507831    ┆ 8    ┆ 126          │
│ 1000SHIBUSDT ┆ -1.448576    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ C98USDT      ┆ -0.156994    ┆ 125  ┆ 9            │
│ SPELLUSDT    ┆ -0.085514    ┆ 126  ┆ 8            │
│ OGNUSDT      ┆ 0.045483     ┆ 127  ┆ 7            │
│ NKNUSDT      ┆ 0.163914     ┆ 128  ┆ 6            │
│ 1000XECUSDT  ┆ 0.223243     ┆ 129  ┆ 5            │
│ IOTXUSDT     ┆ 0.270876     ┆ 130  ┆ 4            │
│ DEFIUSDT     ┆ 0.298902     ┆ 131  ┆ 3            │
│ CTSIUSDT     ┆ 0.318905     ┆ 132  ┆ 2            │
│ DGBUSDT      ┆ 0.32175      ┆ 133  ┆ 1            │
│ INJUSDT      ┆ 0.42596      ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,091 - WARNING - 2023-03-19T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,091 - INFO - cur close time: 2023-03-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:57,091 - DEBUG - mean expected ret (mean factor): -0.7650498184012485
2024-11-20 23:06:57,096 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,096 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,096 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1346      ┆ null        ┆ … ┆ 0.02937 ┆ null   ┆ null    ┆ 0.2494  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,103 - DEBUG - update position: 2023-03-19T23:59:59.999 === diff_trading_value: 205217.8236412173 == cash: 111851.78431971914 
2024-11-20 23:06:57,104 - INFO - pnl: 2023-03-19T23:59:59.999 111851.78431971914 === -0.071%
2024-11-20 23:06:57,106 - DEBUG - cur time: 2023-03-20T23:59:59.999 == next bar open time: 2023-03-21T00:00:00.000 == close pos time: 2023-03-28T00:00:00.000
2024-11-20 23:06:57,108 - INFO - pnl: 2023-03-20T23:59:59.999 112403.5673724357 === 0.493%
2024-11-20 23:06:57,111 - DEBUG - cur time: 2023-03-21T23:59:59.999 == next bar open time: 2023-03-22T00:00:00.000 == close pos time: 2023-03-29T00:00:00.000
2024-11-20 23:06:57,113 - INFO - pnl: 2023-03-21T23:59:59.999 110332.57205131512 === -1.842%
2024-11-20 23:06:57,115 - DEBUG - cur time: 2023-03-22T23:59:59.999 == next bar open time: 2023-03-23T00:00:00.000 == close pos time: 2023-03-30T00:00:00.000
2024-11-20 23:06:57,117 - INFO - pnl: 2023-03-22T23:59:59.999 108864.61624345175 === -1.330%
2024-11-20 23:06:57,120 - DEBUG - cur time: 2023-03-23T23:59:59.999 == next bar open time: 2023-03-24T00:00:00.000 == close pos time: 2023-03-31T00:00:00.000
2024-11-20 23:06:57,122 - INFO - pnl: 2023-03-23T23:59:59.999 109136.20785889975 === 0.249%
2024-11-20 23:06:57,125 - DEBUG - cur time: 2023-03-24T23:59:59.999 == next bar open time: 2023-03-25T00:00:00.000 == close pos time: 2023-04-01T00:00:00.000
2024-11-20 23:06:57,127 - INFO - pnl: 2023-03-24T23:59:59.999 108984.97669590771 === -0.139%
2024-11-20 23:06:57,130 - DEBUG - cur time: 2023-03-25T23:59:59.999 == next bar open time: 2023-03-26T00:00:00.000 == close pos time: 2023-04-02T00:00:00.000
2024-11-20 23:06:57,131 - INFO - pnl: 2023-03-25T23:59:59.999 106652.92921398916 === -2.140%
2024-11-20 23:06:57,136 - DEBUG - cur time: 2023-03-26T23:59:59.999 == next bar open time: 2023-03-27T00:00:00.000 == close pos time: 2023-04-03T00:00:00.000
2024-11-20 23:06:57,143 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MKRUSDT      ┆ -2.186616    ┆ 0    ┆ 134          │
│ APTUSDT      ┆ -2.103801    ┆ 1    ┆ 133          │
│ FILUSDT      ┆ -2.016614    ┆ 2    ┆ 132          │
│ SNXUSDT      ┆ -1.89406     ┆ 3    ┆ 131          │
│ AXSUSDT      ┆ -1.872252    ┆ 4    ┆ 130          │
│ ATOMUSDT     ┆ -1.859185    ┆ 5    ┆ 129          │
│ LDOUSDT      ┆ -1.775676    ┆ 6    ┆ 128          │
│ EGLDUSDT     ┆ -1.719694    ┆ 7    ┆ 127          │
│ EOSUSDT      ┆ -1.574954    ┆ 8    ┆ 126          │
│ DASHUSDT     ┆ -1.545013    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DENTUSDT     ┆ 0.09872      ┆ 125  ┆ 9            │
│ HOTUSDT      ┆ 0.176995     ┆ 126  ┆ 8            │
│ OGNUSDT      ┆ 0.187827     ┆ 127  ┆ 7            │
│ REEFUSDT     ┆ 0.208973     ┆ 128  ┆ 6            │
│ BLUEBIRDUSDT ┆ 0.363544     ┆ 129  ┆ 5            │
│ IOTXUSDT     ┆ 0.380534     ┆ 130  ┆ 4            │
│ 1000XECUSDT  ┆ 0.443319     ┆ 131  ┆ 3            │
│ DEFIUSDT     ┆ 0.487357     ┆ 132  ┆ 2            │
│ DGBUSDT      ┆ 0.56134      ┆ 133  ┆ 1            │
│ SPELLUSDT    ┆ 0.986442     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,149 - INFO - cur close time: 2023-03-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:06:57,149 - DEBUG - mean expected ret (mean factor): -0.7360325766870183
2024-11-20 23:06:57,153 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,153 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,154 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1246      ┆ null        ┆ … ┆ 0.02734 ┆ null   ┆ null    ┆ 0.2289  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,160 - DEBUG - update position: 2023-03-26T23:59:59.999 === diff_trading_value: 244390.2050582283 == cash: 105350.42231696271 
2024-11-20 23:06:57,161 - INFO - pnl: 2023-03-26T23:59:59.999 105350.42231696271 === -1.221%
2024-11-20 23:06:57,164 - DEBUG - cur time: 2023-03-27T23:59:59.999 == next bar open time: 2023-03-28T00:00:00.000 == close pos time: 2023-04-04T00:00:00.000
2024-11-20 23:06:57,165 - INFO - pnl: 2023-03-27T23:59:59.999 104115.6591245517 === -1.172%
2024-11-20 23:06:57,168 - DEBUG - cur time: 2023-03-28T23:59:59.999 == next bar open time: 2023-03-29T00:00:00.000 == close pos time: 2023-04-05T00:00:00.000
2024-11-20 23:06:57,170 - INFO - pnl: 2023-03-28T23:59:59.999 103645.6600523698 === -0.451%
2024-11-20 23:06:57,173 - DEBUG - cur time: 2023-03-29T23:59:59.999 == next bar open time: 2023-03-30T00:00:00.000 == close pos time: 2023-04-06T00:00:00.000
2024-11-20 23:06:57,174 - INFO - pnl: 2023-03-29T23:59:59.999 105733.92342177093 === 2.015%
2024-11-20 23:06:57,178 - DEBUG - cur time: 2023-03-30T23:59:59.999 == next bar open time: 2023-03-31T00:00:00.000 == close pos time: 2023-04-07T00:00:00.000
2024-11-20 23:06:57,179 - INFO - pnl: 2023-03-30T23:59:59.999 108024.4746899746 === 2.166%
2024-11-20 23:06:57,182 - DEBUG - cur time: 2023-03-31T23:59:59.999 == next bar open time: 2023-04-01T00:00:00.000 == close pos time: 2023-04-08T00:00:00.000
2024-11-20 23:06:57,183 - INFO - pnl: 2023-03-31T23:59:59.999 109015.19691050462 === 0.917%
2024-11-20 23:06:57,186 - DEBUG - cur time: 2023-04-01T23:59:59.999 == next bar open time: 2023-04-02T00:00:00.000 == close pos time: 2023-04-09T00:00:00.000
2024-11-20 23:06:57,188 - INFO - pnl: 2023-04-01T23:59:59.999 109730.09891290106 === 0.656%
2024-11-20 23:06:57,190 - DEBUG - cur time: 2023-04-02T23:59:59.999 == next bar open time: 2023-04-03T00:00:00.000 == close pos time: 2023-04-10T00:00:00.000
2024-11-20 23:06:57,198 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT   ┆ -2.133731    ┆ 0    ┆ 134          │
│ APTUSDT      ┆ -1.998294    ┆ 1    ┆ 133          │
│ XRPUSDT      ┆ -1.90755     ┆ 2    ┆ 132          │
│ XMRUSDT      ┆ -1.71211     ┆ 3    ┆ 131          │
│ GTCUSDT      ┆ -1.64823     ┆ 4    ┆ 130          │
│ EOSUSDT      ┆ -1.408367    ┆ 5    ┆ 129          │
│ EGLDUSDT     ┆ -1.384138    ┆ 6    ┆ 128          │
│ INJUSDT      ┆ -1.373606    ┆ 7    ┆ 127          │
│ RLCUSDT      ┆ -1.351102    ┆ 8    ┆ 126          │
│ QTUMUSDT     ┆ -1.350324    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DGBUSDT      ┆ -0.070757    ┆ 125  ┆ 9            │
│ WOOUSDT      ┆ -0.065989    ┆ 126  ┆ 8            │
│ 1000XECUSDT  ┆ -0.026982    ┆ 127  ┆ 7            │
│ KSMUSDT      ┆ 0.057189     ┆ 128  ┆ 6            │
│ BLUEBIRDUSDT ┆ 0.104022     ┆ 129  ┆ 5            │
│ IOTAUSDT     ┆ 0.112315     ┆ 130  ┆ 4            │
│ ARUSDT       ┆ 0.125839     ┆ 131  ┆ 3            │
│ BAKEUSDT     ┆ 0.162538     ┆ 132  ┆ 2            │
│ TRBUSDT      ┆ 0.571904     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 1.372859     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,203 - WARNING - 2023-04-02T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,203 - INFO - cur close time: 2023-04-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:57,204 - DEBUG - mean expected ret (mean factor): -0.7424753457124667
2024-11-20 23:06:57,208 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,208 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,209 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1226      ┆ null        ┆ … ┆ 0.0309  ┆ null   ┆ null    ┆ 0.285   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,215 - DEBUG - update position: 2023-04-02T23:59:59.999 === diff_trading_value: 275453.5538667586 == cash: 107297.78221649381 
2024-11-20 23:06:57,216 - INFO - pnl: 2023-04-02T23:59:59.999 107297.78221649381 === -2.217%
2024-11-20 23:06:57,219 - DEBUG - cur time: 2023-04-03T23:59:59.999 == next bar open time: 2023-04-04T00:00:00.000 == close pos time: 2023-04-11T00:00:00.000
2024-11-20 23:06:57,221 - INFO - pnl: 2023-04-03T23:59:59.999 109295.24322753244 === 1.862%
2024-11-20 23:06:57,225 - DEBUG - cur time: 2023-04-04T23:59:59.999 == next bar open time: 2023-04-05T00:00:00.000 == close pos time: 2023-04-12T00:00:00.000
2024-11-20 23:06:57,227 - INFO - pnl: 2023-04-04T23:59:59.999 111730.34927369082 === 2.228%
2024-11-20 23:06:57,231 - DEBUG - cur time: 2023-04-05T23:59:59.999 == next bar open time: 2023-04-06T00:00:00.000 == close pos time: 2023-04-13T00:00:00.000
2024-11-20 23:06:57,232 - INFO - pnl: 2023-04-05T23:59:59.999 111788.25285183286 === 0.052%
2024-11-20 23:06:57,236 - DEBUG - cur time: 2023-04-06T23:59:59.999 == next bar open time: 2023-04-07T00:00:00.000 == close pos time: 2023-04-14T00:00:00.000
2024-11-20 23:06:57,238 - INFO - pnl: 2023-04-06T23:59:59.999 110721.81842756116 === -0.954%
2024-11-20 23:06:57,241 - DEBUG - cur time: 2023-04-07T23:59:59.999 == next bar open time: 2023-04-08T00:00:00.000 == close pos time: 2023-04-15T00:00:00.000
2024-11-20 23:06:57,243 - INFO - pnl: 2023-04-07T23:59:59.999 110734.92004131286 === 0.012%
2024-11-20 23:06:57,246 - DEBUG - cur time: 2023-04-08T23:59:59.999 == next bar open time: 2023-04-09T00:00:00.000 == close pos time: 2023-04-16T00:00:00.000
2024-11-20 23:06:57,247 - INFO - pnl: 2023-04-08T23:59:59.999 111562.97567075184 === 0.748%
2024-11-20 23:06:57,250 - DEBUG - cur time: 2023-04-09T23:59:59.999 == next bar open time: 2023-04-10T00:00:00.000 == close pos time: 2023-04-17T00:00:00.000
2024-11-20 23:06:57,258 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ APTUSDT  ┆ -2.310626    ┆ 0    ┆ 134          │
│ OMGUSDT  ┆ -1.960012    ┆ 1    ┆ 133          │
│ MKRUSDT  ┆ -1.852198    ┆ 2    ┆ 132          │
│ XMRUSDT  ┆ -1.812048    ┆ 3    ┆ 131          │
│ MASKUSDT ┆ -1.777327    ┆ 4    ┆ 130          │
│ ATOMUSDT ┆ -1.679093    ┆ 5    ┆ 129          │
│ QTUMUSDT ┆ -1.565815    ┆ 6    ┆ 128          │
│ EOSUSDT  ┆ -1.506667    ┆ 7    ┆ 127          │
│ FILUSDT  ┆ -1.475506    ┆ 8    ┆ 126          │
│ XRPUSDT  ┆ -1.4734      ┆ 9    ┆ 125          │
│ …        ┆ …            ┆ …    ┆ …            │
│ ARUSDT   ┆ -0.17636     ┆ 125  ┆ 9            │
│ REEFUSDT ┆ -0.079629    ┆ 126  ┆ 8            │
│ DENTUSDT ┆ 0.010028     ┆ 127  ┆ 7            │
│ ONEUSDT  ┆ 0.053659     ┆ 128  ┆ 6            │
│ BLZUSDT  ┆ 0.074021     ┆ 129  ┆ 5            │
│ DGBUSDT  ┆ 0.182803     ┆ 130  ┆ 4            │
│ SKLUSDT  ┆ 0.192869     ┆ 131  ┆ 3            │
│ CTKUSDT  ┆ 0.617077     ┆ 132  ┆ 2            │
│ CVXUSDT  ┆ 0.630398     ┆ 133  ┆ 1            │
│ DEFIUSDT ┆ 1.09433      ┆ 134  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,264 - WARNING - 2023-04-09T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,264 - INFO - cur close time: 2023-04-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:57,264 - DEBUG - mean expected ret (mean factor): -0.7823673244657852
2024-11-20 23:06:57,269 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,269 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,269 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1249      ┆ null        ┆ … ┆ 0.02922 ┆ null   ┆ null    ┆ 0.2874  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,275 - DEBUG - update position: 2023-04-09T23:59:59.999 === diff_trading_value: 218496.14866088337 == cash: 112696.89178814413 
2024-11-20 23:06:57,277 - INFO - pnl: 2023-04-09T23:59:59.999 112696.89178814413 === 1.016%
2024-11-20 23:06:57,280 - DEBUG - cur time: 2023-04-10T23:59:59.999 == next bar open time: 2023-04-11T00:00:00.000 == close pos time: 2023-04-18T00:00:00.000
2024-11-20 23:06:57,281 - INFO - pnl: 2023-04-10T23:59:59.999 112722.09936936747 === 0.022%
2024-11-20 23:06:57,284 - DEBUG - cur time: 2023-04-11T23:59:59.999 == next bar open time: 2023-04-12T00:00:00.000 == close pos time: 2023-04-19T00:00:00.000
2024-11-20 23:06:57,286 - INFO - pnl: 2023-04-11T23:59:59.999 112068.01803313289 === -0.580%
2024-11-20 23:06:57,289 - DEBUG - cur time: 2023-04-12T23:59:59.999 == next bar open time: 2023-04-13T00:00:00.000 == close pos time: 2023-04-20T00:00:00.000
2024-11-20 23:06:57,290 - INFO - pnl: 2023-04-12T23:59:59.999 113260.81249270838 === 1.064%
2024-11-20 23:06:57,294 - DEBUG - cur time: 2023-04-13T23:59:59.999 == next bar open time: 2023-04-14T00:00:00.000 == close pos time: 2023-04-21T00:00:00.000
2024-11-20 23:06:57,296 - INFO - pnl: 2023-04-13T23:59:59.999 113163.69018580756 === -0.086%
2024-11-20 23:06:57,298 - DEBUG - cur time: 2023-04-14T23:59:59.999 == next bar open time: 2023-04-15T00:00:00.000 == close pos time: 2023-04-22T00:00:00.000
2024-11-20 23:06:57,300 - INFO - pnl: 2023-04-14T23:59:59.999 113358.68720272831 === 0.172%
2024-11-20 23:06:57,304 - DEBUG - cur time: 2023-04-15T23:59:59.999 == next bar open time: 2023-04-16T00:00:00.000 == close pos time: 2023-04-23T00:00:00.000
2024-11-20 23:06:57,306 - INFO - pnl: 2023-04-15T23:59:59.999 113872.7221019282 === 0.453%
2024-11-20 23:06:57,309 - DEBUG - cur time: 2023-04-16T23:59:59.999 == next bar open time: 2023-04-17T00:00:00.000 == close pos time: 2023-04-24T00:00:00.000
2024-11-20 23:06:57,318 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ NEOUSDT      ┆ -1.7715      ┆ 0    ┆ 134          │
│ APTUSDT      ┆ -1.766101    ┆ 1    ┆ 133          │
│ BNBUSDT      ┆ -1.747258    ┆ 2    ┆ 132          │
│ ATOMUSDT     ┆ -1.561088    ┆ 3    ┆ 131          │
│ AAVEUSDT     ┆ -1.529695    ┆ 4    ┆ 130          │
│ MKRUSDT      ┆ -1.52555     ┆ 5    ┆ 129          │
│ YFIUSDT      ┆ -1.505463    ┆ 6    ┆ 128          │
│ AXSUSDT      ┆ -1.466445    ┆ 7    ┆ 127          │
│ FTMUSDT      ┆ -1.433932    ┆ 8    ┆ 126          │
│ DOTUSDT      ┆ -1.433019    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ALPHAUSDT    ┆ -0.12477     ┆ 125  ┆ 9            │
│ IOTXUSDT     ┆ -0.059389    ┆ 126  ┆ 8            │
│ BLZUSDT      ┆ -0.010038    ┆ 127  ┆ 7            │
│ SKLUSDT      ┆ 0.013252     ┆ 128  ┆ 6            │
│ LPTUSDT      ┆ 0.066443     ┆ 129  ┆ 5            │
│ CTKUSDT      ┆ 0.085306     ┆ 130  ┆ 4            │
│ DGBUSDT      ┆ 0.233428     ┆ 131  ┆ 3            │
│ CVXUSDT      ┆ 0.405366     ┆ 132  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.475267     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 1.819704     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,326 - WARNING - 2023-04-16T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,326 - INFO - cur close time: 2023-04-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:57,327 - DEBUG - mean expected ret (mean factor): -0.7630961896915004
2024-11-20 23:06:57,331 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,332 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,332 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1278      ┆ null        ┆ … ┆ 0.0326  ┆ null   ┆ null    ┆ 0.3063  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,338 - DEBUG - update position: 2023-04-16T23:59:59.999 === diff_trading_value: 247576.48420122065 == cash: 115543.53469451818 
2024-11-20 23:06:57,340 - INFO - pnl: 2023-04-16T23:59:59.999 115543.53469451818 === 1.467%
2024-11-20 23:06:57,343 - DEBUG - cur time: 2023-04-17T23:59:59.999 == next bar open time: 2023-04-18T00:00:00.000 == close pos time: 2023-04-25T00:00:00.000
2024-11-20 23:06:57,344 - INFO - pnl: 2023-04-17T23:59:59.999 115521.23747365219 === -0.019%
2024-11-20 23:06:57,347 - DEBUG - cur time: 2023-04-18T23:59:59.999 == next bar open time: 2023-04-19T00:00:00.000 == close pos time: 2023-04-26T00:00:00.000
2024-11-20 23:06:57,348 - INFO - pnl: 2023-04-18T23:59:59.999 116220.61384610533 === 0.605%
2024-11-20 23:06:57,351 - DEBUG - cur time: 2023-04-19T23:59:59.999 == next bar open time: 2023-04-20T00:00:00.000 == close pos time: 2023-04-27T00:00:00.000
2024-11-20 23:06:57,353 - INFO - pnl: 2023-04-19T23:59:59.999 116461.58183682103 === 0.207%
2024-11-20 23:06:57,356 - DEBUG - cur time: 2023-04-20T23:59:59.999 == next bar open time: 2023-04-21T00:00:00.000 == close pos time: 2023-04-28T00:00:00.000
2024-11-20 23:06:57,357 - INFO - pnl: 2023-04-20T23:59:59.999 115062.1703407052 === -1.202%
2024-11-20 23:06:57,360 - DEBUG - cur time: 2023-04-21T23:59:59.999 == next bar open time: 2023-04-22T00:00:00.000 == close pos time: 2023-04-29T00:00:00.000
2024-11-20 23:06:57,362 - INFO - pnl: 2023-04-21T23:59:59.999 114937.71960267931 === -0.108%
2024-11-20 23:06:57,365 - DEBUG - cur time: 2023-04-22T23:59:59.999 == next bar open time: 2023-04-23T00:00:00.000 == close pos time: 2023-04-30T00:00:00.000
2024-11-20 23:06:57,366 - INFO - pnl: 2023-04-22T23:59:59.999 115316.02688764269 === 0.329%
2024-11-20 23:06:57,369 - DEBUG - cur time: 2023-04-23T23:59:59.999 == next bar open time: 2023-04-24T00:00:00.000 == close pos time: 2023-05-01T00:00:00.000
2024-11-20 23:06:57,376 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AXSUSDT      ┆ -1.869455    ┆ 0    ┆ 134          │
│ EGLDUSDT     ┆ -1.73915     ┆ 1    ┆ 133          │
│ APTUSDT      ┆ -1.589361    ┆ 2    ┆ 132          │
│ UNFIUSDT     ┆ -1.581909    ┆ 3    ┆ 131          │
│ AAVEUSDT     ┆ -1.54886     ┆ 4    ┆ 130          │
│ ICPUSDT      ┆ -1.509482    ┆ 5    ┆ 129          │
│ SANDUSDT     ┆ -1.50138     ┆ 6    ┆ 128          │
│ DOTUSDT      ┆ -1.50005     ┆ 7    ┆ 127          │
│ APEUSDT      ┆ -1.40795     ┆ 8    ┆ 126          │
│ MANAUSDT     ┆ -1.40312     ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BLZUSDT      ┆ -0.227982    ┆ 125  ┆ 9            │
│ SXPUSDT      ┆ -0.222836    ┆ 126  ┆ 8            │
│ API3USDT     ┆ -0.196114    ┆ 127  ┆ 7            │
│ SFPUSDT      ┆ -0.195719    ┆ 128  ┆ 6            │
│ GTCUSDT      ┆ -0.188753    ┆ 129  ┆ 5            │
│ ICXUSDT      ┆ -0.119746    ┆ 130  ┆ 4            │
│ BLUEBIRDUSDT ┆ -0.078277    ┆ 131  ┆ 3            │
│ BAKEUSDT     ┆ 0.166395     ┆ 132  ┆ 2            │
│ CVXUSDT      ┆ 0.178337     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 1.412807     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,381 - WARNING - 2023-04-23T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,381 - INFO - cur close time: 2023-04-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:57,381 - DEBUG - mean expected ret (mean factor): -0.7879168689509307
2024-11-20 23:06:57,387 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,387 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,388 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.11        ┆ null        ┆ … ┆ 0.0322  ┆ null   ┆ null    ┆ 0.261   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,394 - DEBUG - update position: 2023-04-23T23:59:59.999 === diff_trading_value: 210581.8079593722 == cash: 114588.47985525466 
2024-11-20 23:06:57,395 - INFO - pnl: 2023-04-23T23:59:59.999 114588.47985525466 === -0.631%
2024-11-20 23:06:57,398 - DEBUG - cur time: 2023-04-24T23:59:59.999 == next bar open time: 2023-04-25T00:00:00.000 == close pos time: 2023-05-02T00:00:00.000
2024-11-20 23:06:57,399 - INFO - pnl: 2023-04-24T23:59:59.999 115147.66321488144 === 0.488%
2024-11-20 23:06:57,402 - DEBUG - cur time: 2023-04-25T23:59:59.999 == next bar open time: 2023-04-26T00:00:00.000 == close pos time: 2023-05-03T00:00:00.000
2024-11-20 23:06:57,404 - INFO - pnl: 2023-04-25T23:59:59.999 116229.77123080446 === 0.940%
2024-11-20 23:06:57,407 - DEBUG - cur time: 2023-04-26T23:59:59.999 == next bar open time: 2023-04-27T00:00:00.000 == close pos time: 2023-05-04T00:00:00.000
2024-11-20 23:06:57,408 - INFO - pnl: 2023-04-26T23:59:59.999 116982.92321542618 === 0.648%
2024-11-20 23:06:57,411 - DEBUG - cur time: 2023-04-27T23:59:59.999 == next bar open time: 2023-04-28T00:00:00.000 == close pos time: 2023-05-05T00:00:00.000
2024-11-20 23:06:57,412 - INFO - pnl: 2023-04-27T23:59:59.999 116297.16954177439 === -0.586%
2024-11-20 23:06:57,415 - DEBUG - cur time: 2023-04-28T23:59:59.999 == next bar open time: 2023-04-29T00:00:00.000 == close pos time: 2023-05-06T00:00:00.000
2024-11-20 23:06:57,417 - INFO - pnl: 2023-04-28T23:59:59.999 114672.69211475672 === -1.397%
2024-11-20 23:06:57,421 - DEBUG - cur time: 2023-04-29T23:59:59.999 == next bar open time: 2023-04-30T00:00:00.000 == close pos time: 2023-05-07T00:00:00.000
2024-11-20 23:06:57,423 - INFO - pnl: 2023-04-29T23:59:59.999 113447.42102568847 === -1.068%
2024-11-20 23:06:57,426 - DEBUG - cur time: 2023-04-30T23:59:59.999 == next bar open time: 2023-05-01T00:00:00.000 == close pos time: 2023-05-08T00:00:00.000
2024-11-20 23:06:57,433 - DEBUG - sorted_long_factors: shape: (136, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ XMRUSDT    ┆ -1.64342     ┆ 0    ┆ 135          │
│ APTUSDT    ┆ -1.576244    ┆ 1    ┆ 134          │
│ CTSIUSDT   ┆ -1.484615    ┆ 2    ┆ 133          │
│ CRVUSDT    ┆ -1.45179     ┆ 3    ┆ 132          │
│ AXSUSDT    ┆ -1.428583    ┆ 4    ┆ 131          │
│ YFIUSDT    ┆ -1.417439    ┆ 5    ┆ 130          │
│ DOTUSDT    ┆ -1.363791    ┆ 6    ┆ 129          │
│ MANAUSDT   ┆ -1.353588    ┆ 7    ┆ 128          │
│ OPUSDT     ┆ -1.327287    ┆ 8    ┆ 127          │
│ SNXUSDT    ┆ -1.312728    ┆ 9    ┆ 126          │
│ …          ┆ …            ┆ …    ┆ …            │
│ QTUMUSDT   ┆ -0.187824    ┆ 126  ┆ 9            │
│ SPELLUSDT  ┆ -0.128093    ┆ 127  ┆ 8            │
│ WOOUSDT    ┆ -0.128019    ┆ 128  ┆ 7            │
│ ONEUSDT    ┆ -0.106014    ┆ 129  ┆ 6            │
│ BLZUSDT    ┆ -0.095561    ┆ 130  ┆ 5            │
│ OMGUSDT    ┆ -0.094915    ┆ 131  ┆ 4            │
│ BTCDOMUSDT ┆ -0.087328    ┆ 132  ┆ 3            │
│ IOTXUSDT   ┆ 0.042425     ┆ 133  ┆ 2            │
│ DGBUSDT    ┆ 0.060124     ┆ 134  ┆ 1            │
│ DEFIUSDT   ┆ 1.456969     ┆ 135  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,439 - WARNING - 2023-04-30T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,440 - INFO - cur close time: 2023-04-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:57,440 - DEBUG - mean expected ret (mean factor): -0.7707450662196369
2024-11-20 23:06:57,445 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,445 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,445 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1095      ┆ null        ┆ … ┆ 0.028   ┆ null   ┆ null    ┆ 0.2559  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,453 - DEBUG - update position: 2023-04-30T23:59:59.999 === diff_trading_value: 234678.3504614386 == cash: 112810.9936788184 
2024-11-20 23:06:57,454 - INFO - pnl: 2023-04-30T23:59:59.999 112810.9936788184 === -0.561%
2024-11-20 23:06:57,457 - DEBUG - cur time: 2023-05-01T23:59:59.999 == next bar open time: 2023-05-02T00:00:00.000 == close pos time: 2023-05-09T00:00:00.000
2024-11-20 23:06:57,459 - INFO - pnl: 2023-05-01T23:59:59.999 114357.89211753577 === 1.371%
2024-11-20 23:06:57,462 - DEBUG - cur time: 2023-05-02T23:59:59.999 == next bar open time: 2023-05-03T00:00:00.000 == close pos time: 2023-05-10T00:00:00.000
2024-11-20 23:06:57,464 - INFO - pnl: 2023-05-02T23:59:59.999 114453.26960328527 === 0.083%
2024-11-20 23:06:57,466 - DEBUG - cur time: 2023-05-03T23:59:59.999 == next bar open time: 2023-05-04T00:00:00.000 == close pos time: 2023-05-11T00:00:00.000
2024-11-20 23:06:57,468 - INFO - pnl: 2023-05-03T23:59:59.999 114127.44429843978 === -0.285%
2024-11-20 23:06:57,471 - DEBUG - cur time: 2023-05-04T23:59:59.999 == next bar open time: 2023-05-05T00:00:00.000 == close pos time: 2023-05-12T00:00:00.000
2024-11-20 23:06:57,473 - INFO - pnl: 2023-05-04T23:59:59.999 114980.01931419379 === 0.747%
2024-11-20 23:06:57,476 - DEBUG - cur time: 2023-05-05T23:59:59.999 == next bar open time: 2023-05-06T00:00:00.000 == close pos time: 2023-05-13T00:00:00.000
2024-11-20 23:06:57,478 - INFO - pnl: 2023-05-05T23:59:59.999 115685.26777358784 === 0.613%
2024-11-20 23:06:57,482 - DEBUG - cur time: 2023-05-06T23:59:59.999 == next bar open time: 2023-05-07T00:00:00.000 == close pos time: 2023-05-14T00:00:00.000
2024-11-20 23:06:57,483 - INFO - pnl: 2023-05-06T23:59:59.999 115678.30640670445 === -0.006%
2024-11-20 23:06:57,486 - DEBUG - cur time: 2023-05-07T23:59:59.999 == next bar open time: 2023-05-08T00:00:00.000 == close pos time: 2023-05-15T00:00:00.000
2024-11-20 23:06:57,495 - DEBUG - sorted_long_factors: shape: (139, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ INJUSDT   ┆ -1.844673    ┆ 0    ┆ 138          │
│ HOOKUSDT  ┆ -1.82088     ┆ 1    ┆ 137          │
│ MKRUSDT   ┆ -1.623199    ┆ 2    ┆ 136          │
│ TOMOUSDT  ┆ -1.503951    ┆ 3    ┆ 135          │
│ MAGICUSDT ┆ -1.502808    ┆ 4    ┆ 134          │
│ CHZUSDT   ┆ -1.464548    ┆ 5    ┆ 133          │
│ ICPUSDT   ┆ -1.460757    ┆ 6    ┆ 132          │
│ APTUSDT   ┆ -1.46017     ┆ 7    ┆ 131          │
│ BELUSDT   ┆ -1.394482    ┆ 8    ┆ 130          │
│ OMGUSDT   ┆ -1.377959    ┆ 9    ┆ 129          │
│ …         ┆ …            ┆ …    ┆ …            │
│ KSMUSDT   ┆ -0.053299    ┆ 129  ┆ 9            │
│ STORJUSDT ┆ -0.041312    ┆ 130  ┆ 8            │
│ DGBUSDT   ┆ -0.015546    ┆ 131  ┆ 7            │
│ NEOUSDT   ┆ -0.005937    ┆ 132  ┆ 6            │
│ OGNUSDT   ┆ 0.014084     ┆ 133  ┆ 5            │
│ SKLUSDT   ┆ 0.032743     ┆ 134  ┆ 4            │
│ ONEUSDT   ┆ 0.035027     ┆ 135  ┆ 3            │
│ BAKEUSDT  ┆ 0.279521     ┆ 136  ┆ 2            │
│ CVXUSDT   ┆ 0.422621     ┆ 137  ┆ 1            │
│ DEFIUSDT  ┆ 1.153158     ┆ 138  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,500 - WARNING - 2023-05-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,501 - INFO - cur close time: 2023-05-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:57,501 - DEBUG - mean expected ret (mean factor): -0.7635160817035275
2024-11-20 23:06:57,505 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,506 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,506 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0947      ┆ null        ┆ … ┆ 0.02608 ┆ null   ┆ null    ┆ 0.2374  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,512 - DEBUG - update position: 2023-05-07T23:59:59.999 === diff_trading_value: 287754.6499501548 == cash: 115473.7621501555 
2024-11-20 23:06:57,514 - INFO - pnl: 2023-05-07T23:59:59.999 115473.7621501555 === -0.177%
2024-11-20 23:06:57,518 - DEBUG - cur time: 2023-05-08T23:59:59.999 == next bar open time: 2023-05-09T00:00:00.000 == close pos time: 2023-05-16T00:00:00.000
2024-11-20 23:06:57,520 - INFO - pnl: 2023-05-08T23:59:59.999 116213.38457726238 === 0.641%
2024-11-20 23:06:57,524 - DEBUG - cur time: 2023-05-09T23:59:59.999 == next bar open time: 2023-05-10T00:00:00.000 == close pos time: 2023-05-17T00:00:00.000
2024-11-20 23:06:57,526 - INFO - pnl: 2023-05-09T23:59:59.999 117789.7801258222 === 1.356%
2024-11-20 23:06:57,531 - DEBUG - cur time: 2023-05-10T23:59:59.999 == next bar open time: 2023-05-11T00:00:00.000 == close pos time: 2023-05-18T00:00:00.000
2024-11-20 23:06:57,533 - INFO - pnl: 2023-05-10T23:59:59.999 116687.49502198835 === -0.936%
2024-11-20 23:06:57,537 - DEBUG - cur time: 2023-05-11T23:59:59.999 == next bar open time: 2023-05-12T00:00:00.000 == close pos time: 2023-05-19T00:00:00.000
2024-11-20 23:06:57,539 - INFO - pnl: 2023-05-11T23:59:59.999 118757.840156128 === 1.774%
2024-11-20 23:06:57,543 - DEBUG - cur time: 2023-05-12T23:59:59.999 == next bar open time: 2023-05-13T00:00:00.000 == close pos time: 2023-05-20T00:00:00.000
2024-11-20 23:06:57,545 - INFO - pnl: 2023-05-12T23:59:59.999 118280.316520635 === -0.402%
2024-11-20 23:06:57,549 - DEBUG - cur time: 2023-05-13T23:59:59.999 == next bar open time: 2023-05-14T00:00:00.000 == close pos time: 2023-05-21T00:00:00.000
2024-11-20 23:06:57,550 - INFO - pnl: 2023-05-13T23:59:59.999 118260.00623525986 === -0.017%
2024-11-20 23:06:57,556 - DEBUG - cur time: 2023-05-14T23:59:59.999 == next bar open time: 2023-05-15T00:00:00.000 == close pos time: 2023-05-22T00:00:00.000
2024-11-20 23:06:57,566 - DEBUG - sorted_long_factors: shape: (140, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ZECUSDT      ┆ -2.000114    ┆ 0    ┆ 139          │
│ FETUSDT      ┆ -1.67415     ┆ 1    ┆ 138          │
│ BELUSDT      ┆ -1.670938    ┆ 2    ┆ 137          │
│ MTLUSDT      ┆ -1.584863    ┆ 3    ┆ 136          │
│ BTCDOMUSDT   ┆ -1.522381    ┆ 4    ┆ 135          │
│ APTUSDT      ┆ -1.504051    ┆ 5    ┆ 134          │
│ BNBUSDT      ┆ -1.502256    ┆ 6    ┆ 133          │
│ ICPUSDT      ┆ -1.499708    ┆ 7    ┆ 132          │
│ FILUSDT      ┆ -1.495227    ┆ 8    ┆ 131          │
│ EOSUSDT      ┆ -1.460594    ┆ 9    ┆ 130          │
│ …            ┆ …            ┆ …    ┆ …            │
│ 1000XECUSDT  ┆ -0.047512    ┆ 130  ┆ 9            │
│ FOOTBALLUSDT ┆ 0.009868     ┆ 131  ┆ 8            │
│ DGBUSDT      ┆ 0.030908     ┆ 132  ┆ 7            │
│ BLZUSDT      ┆ 0.040277     ┆ 133  ┆ 6            │
│ DUSKUSDT     ┆ 0.094278     ┆ 134  ┆ 5            │
│ LPTUSDT      ┆ 0.216326     ┆ 135  ┆ 4            │
│ DARUSDT      ┆ 0.243222     ┆ 136  ┆ 3            │
│ DEFIUSDT     ┆ 0.354747     ┆ 137  ┆ 2            │
│ BAKEUSDT     ┆ 0.359375     ┆ 138  ┆ 1            │
│ CVXUSDT      ┆ 0.765927     ┆ 139  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,573 - WARNING - 2023-05-14T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,573 - INFO - cur close time: 2023-05-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:57,573 - DEBUG - mean expected ret (mean factor): -0.7682641928023928
2024-11-20 23:06:57,578 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,578 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,578 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0902      ┆ null        ┆ … ┆ 0.02381 ┆ null   ┆ null    ┆ 0.2218  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,587 - DEBUG - update position: 2023-05-14T23:59:59.999 === diff_trading_value: 217140.97266395407 == cash: 117832.71917126155 
2024-11-20 23:06:57,588 - INFO - pnl: 2023-05-14T23:59:59.999 117832.71917126155 === -0.361%
2024-11-20 23:06:57,591 - DEBUG - cur time: 2023-05-15T23:59:59.999 == next bar open time: 2023-05-16T00:00:00.000 == close pos time: 2023-05-23T00:00:00.000
2024-11-20 23:06:57,594 - INFO - pnl: 2023-05-15T23:59:59.999 118313.7871822776 === 0.408%
2024-11-20 23:06:57,597 - DEBUG - cur time: 2023-05-16T23:59:59.999 == next bar open time: 2023-05-17T00:00:00.000 == close pos time: 2023-05-24T00:00:00.000
2024-11-20 23:06:57,598 - INFO - pnl: 2023-05-16T23:59:59.999 118992.02459536125 === 0.573%
2024-11-20 23:06:57,601 - DEBUG - cur time: 2023-05-17T23:59:59.999 == next bar open time: 2023-05-18T00:00:00.000 == close pos time: 2023-05-25T00:00:00.000
2024-11-20 23:06:57,604 - INFO - pnl: 2023-05-17T23:59:59.999 119554.79687081 === 0.473%
2024-11-20 23:06:57,607 - DEBUG - cur time: 2023-05-18T23:59:59.999 == next bar open time: 2023-05-19T00:00:00.000 == close pos time: 2023-05-26T00:00:00.000
2024-11-20 23:06:57,608 - INFO - pnl: 2023-05-18T23:59:59.999 119461.61965721598 === -0.078%
2024-11-20 23:06:57,611 - DEBUG - cur time: 2023-05-19T23:59:59.999 == next bar open time: 2023-05-20T00:00:00.000 == close pos time: 2023-05-27T00:00:00.000
2024-11-20 23:06:57,613 - INFO - pnl: 2023-05-19T23:59:59.999 119648.73066515279 === 0.157%
2024-11-20 23:06:57,615 - DEBUG - cur time: 2023-05-20T23:59:59.999 == next bar open time: 2023-05-21T00:00:00.000 == close pos time: 2023-05-28T00:00:00.000
2024-11-20 23:06:57,616 - INFO - pnl: 2023-05-20T23:59:59.999 120492.91896711629 === 0.706%
2024-11-20 23:06:57,619 - DEBUG - cur time: 2023-05-21T23:59:59.999 == next bar open time: 2023-05-22T00:00:00.000 == close pos time: 2023-05-29T00:00:00.000
2024-11-20 23:06:57,627 - DEBUG - sorted_long_factors: shape: (143, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ RLCUSDT   ┆ -1.845062    ┆ 0    ┆ 142          │
│ RNDRUSDT  ┆ -1.754037    ┆ 1    ┆ 141          │
│ CRVUSDT   ┆ -1.649251    ┆ 2    ┆ 140          │
│ FETUSDT   ┆ -1.51223     ┆ 3    ┆ 139          │
│ INJUSDT   ┆ -1.485467    ┆ 4    ┆ 138          │
│ JASMYUSDT ┆ -1.439973    ┆ 5    ┆ 137          │
│ XTZUSDT   ┆ -1.412491    ┆ 6    ┆ 136          │
│ FILUSDT   ┆ -1.364072    ┆ 7    ┆ 135          │
│ APTUSDT   ┆ -1.351537    ┆ 8    ┆ 134          │
│ MKRUSDT   ┆ -1.346855    ┆ 9    ┆ 133          │
│ …         ┆ …            ┆ …    ┆ …            │
│ UNFIUSDT  ┆ -0.145869    ┆ 133  ┆ 9            │
│ API3USDT  ┆ -0.088721    ┆ 134  ┆ 8            │
│ ATAUSDT   ┆ -0.049049    ┆ 135  ┆ 7            │
│ IOTXUSDT  ┆ -0.02046     ┆ 136  ┆ 6            │
│ BAKEUSDT  ┆ 0.001229     ┆ 137  ┆ 5            │
│ ZENUSDT   ┆ 0.066554     ┆ 138  ┆ 4            │
│ BLZUSDT   ┆ 0.278992     ┆ 139  ┆ 3            │
│ CVXUSDT   ┆ 0.284596     ┆ 140  ┆ 2            │
│ DEFIUSDT  ┆ 0.383058     ┆ 141  ┆ 1            │
│ LPTUSDT   ┆ 0.396372     ┆ 142  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,633 - INFO - cur close time: 2023-05-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:06:57,634 - DEBUG - mean expected ret (mean factor): -0.7840224472132001
2024-11-20 23:06:57,638 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,639 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,639 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0886      ┆ null        ┆ … ┆ 0.0235  ┆ null   ┆ null    ┆ 0.2197  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,645 - DEBUG - update position: 2023-05-21T23:59:59.999 === diff_trading_value: 231784.61305855977 == cash: 120516.78129770936 
2024-11-20 23:06:57,646 - INFO - pnl: 2023-05-21T23:59:59.999 120516.78129770936 === 0.020%
2024-11-20 23:06:57,649 - DEBUG - cur time: 2023-05-22T23:59:59.999 == next bar open time: 2023-05-23T00:00:00.000 == close pos time: 2023-05-30T00:00:00.000
2024-11-20 23:06:57,651 - INFO - pnl: 2023-05-22T23:59:59.999 121019.48717542445 === 0.417%
2024-11-20 23:06:57,653 - DEBUG - cur time: 2023-05-23T23:59:59.999 == next bar open time: 2023-05-24T00:00:00.000 == close pos time: 2023-05-31T00:00:00.000
2024-11-20 23:06:57,655 - INFO - pnl: 2023-05-23T23:59:59.999 120441.9630160237 === -0.477%
2024-11-20 23:06:57,658 - DEBUG - cur time: 2023-05-24T23:59:59.999 == next bar open time: 2023-05-25T00:00:00.000 == close pos time: 2023-06-01T00:00:00.000
2024-11-20 23:06:57,660 - INFO - pnl: 2023-05-24T23:59:59.999 121389.94589960376 === 0.787%
2024-11-20 23:06:57,663 - DEBUG - cur time: 2023-05-25T23:59:59.999 == next bar open time: 2023-05-26T00:00:00.000 == close pos time: 2023-06-02T00:00:00.000
2024-11-20 23:06:57,665 - INFO - pnl: 2023-05-25T23:59:59.999 120842.69485214062 === -0.451%
2024-11-20 23:06:57,668 - DEBUG - cur time: 2023-05-26T23:59:59.999 == next bar open time: 2023-05-27T00:00:00.000 == close pos time: 2023-06-03T00:00:00.000
2024-11-20 23:06:57,670 - INFO - pnl: 2023-05-26T23:59:59.999 120041.29832827358 === -0.663%
2024-11-20 23:06:57,673 - DEBUG - cur time: 2023-05-27T23:59:59.999 == next bar open time: 2023-05-28T00:00:00.000 == close pos time: 2023-06-04T00:00:00.000
2024-11-20 23:06:57,675 - INFO - pnl: 2023-05-27T23:59:59.999 119657.1252329956 === -0.320%
2024-11-20 23:06:57,678 - DEBUG - cur time: 2023-05-28T23:59:59.999 == next bar open time: 2023-05-29T00:00:00.000 == close pos time: 2023-06-05T00:00:00.000
2024-11-20 23:06:57,687 - DEBUG - sorted_long_factors: shape: (146, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ FETUSDT      ┆ -1.660446    ┆ 0    ┆ 145          │
│ INJUSDT      ┆ -1.646013    ┆ 1    ┆ 144          │
│ CRVUSDT      ┆ -1.626354    ┆ 2    ┆ 143          │
│ FXSUSDT      ┆ -1.588446    ┆ 3    ┆ 142          │
│ BELUSDT      ┆ -1.575415    ┆ 4    ┆ 141          │
│ HOOKUSDT     ┆ -1.563943    ┆ 5    ┆ 140          │
│ AGIXUSDT     ┆ -1.533906    ┆ 6    ┆ 139          │
│ NEOUSDT      ┆ -1.530549    ┆ 7    ┆ 138          │
│ KAVAUSDT     ┆ -1.528723    ┆ 8    ┆ 137          │
│ MKRUSDT      ┆ -1.471634    ┆ 9    ┆ 136          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ATAUSDT      ┆ 0.048347     ┆ 136  ┆ 9            │
│ IOTXUSDT     ┆ 0.058431     ┆ 137  ┆ 8            │
│ BLZUSDT      ┆ 0.069924     ┆ 138  ┆ 7            │
│ GALUSDT      ┆ 0.136688     ┆ 139  ┆ 6            │
│ CVXUSDT      ┆ 0.180626     ┆ 140  ┆ 5            │
│ RVNUSDT      ┆ 0.20229      ┆ 141  ┆ 4            │
│ SPELLUSDT    ┆ 0.274        ┆ 142  ┆ 3            │
│ QNTUSDT      ┆ 0.304368     ┆ 143  ┆ 2            │
│ DEFIUSDT     ┆ 0.402049     ┆ 144  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.807134     ┆ 145  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,693 - WARNING - 2023-05-28T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,694 - INFO - cur close time: 2023-05-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:57,694 - DEBUG - mean expected ret (mean factor): -0.7830895892186288
2024-11-20 23:06:57,701 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,701 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,701 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0881      ┆ null        ┆ … ┆ 0.02368 ┆ null   ┆ null    ┆ 0.227   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,707 - DEBUG - update position: 2023-05-28T23:59:59.999 === diff_trading_value: 207632.37971547138 == cash: 118934.17414390945 
2024-11-20 23:06:57,708 - INFO - pnl: 2023-05-28T23:59:59.999 118934.17414390945 === -0.604%
2024-11-20 23:06:57,711 - DEBUG - cur time: 2023-05-29T23:59:59.999 == next bar open time: 2023-05-30T00:00:00.000 == close pos time: 2023-06-06T00:00:00.000
2024-11-20 23:06:57,714 - INFO - pnl: 2023-05-29T23:59:59.999 118316.67752281262 === -0.519%
2024-11-20 23:06:57,717 - DEBUG - cur time: 2023-05-30T23:59:59.999 == next bar open time: 2023-05-31T00:00:00.000 == close pos time: 2023-06-07T00:00:00.000
2024-11-20 23:06:57,719 - INFO - pnl: 2023-05-30T23:59:59.999 118752.74312735343 === 0.369%
2024-11-20 23:06:57,722 - DEBUG - cur time: 2023-05-31T23:59:59.999 == next bar open time: 2023-06-01T00:00:00.000 == close pos time: 2023-06-08T00:00:00.000
2024-11-20 23:06:57,723 - INFO - pnl: 2023-05-31T23:59:59.999 119065.29160298748 === 0.263%
2024-11-20 23:06:57,726 - DEBUG - cur time: 2023-06-01T23:59:59.999 == next bar open time: 2023-06-02T00:00:00.000 == close pos time: 2023-06-09T00:00:00.000
2024-11-20 23:06:57,728 - INFO - pnl: 2023-06-01T23:59:59.999 119490.72980294065 === 0.357%
2024-11-20 23:06:57,731 - DEBUG - cur time: 2023-06-02T23:59:59.999 == next bar open time: 2023-06-03T00:00:00.000 == close pos time: 2023-06-10T00:00:00.000
2024-11-20 23:06:57,731 - INFO - pnl: 2023-06-02T23:59:59.999 118407.18764022316 === -0.907%
2024-11-20 23:06:57,736 - DEBUG - cur time: 2023-06-03T23:59:59.999 == next bar open time: 2023-06-04T00:00:00.000 == close pos time: 2023-06-11T00:00:00.000
2024-11-20 23:06:57,737 - INFO - pnl: 2023-06-03T23:59:59.999 117962.02001515632 === -0.376%
2024-11-20 23:06:57,740 - DEBUG - cur time: 2023-06-04T23:59:59.999 == next bar open time: 2023-06-05T00:00:00.000 == close pos time: 2023-06-12T00:00:00.000
2024-11-20 23:06:57,748 - DEBUG - sorted_long_factors: shape: (151, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RNDRUSDT     ┆ -2.046783    ┆ 0    ┆ 150          │
│ MKRUSDT      ┆ -1.746029    ┆ 1    ┆ 149          │
│ WAVESUSDT    ┆ -1.682241    ┆ 2    ┆ 148          │
│ APTUSDT      ┆ -1.59073     ┆ 3    ┆ 147          │
│ HIGHUSDT     ┆ -1.52337     ┆ 4    ┆ 146          │
│ RLCUSDT      ┆ -1.489936    ┆ 5    ┆ 145          │
│ FILUSDT      ┆ -1.48492     ┆ 6    ┆ 144          │
│ GMTUSDT      ┆ -1.462126    ┆ 7    ┆ 143          │
│ CFXUSDT      ┆ -1.433041    ┆ 8    ┆ 142          │
│ HOOKUSDT     ┆ -1.39792     ┆ 9    ┆ 141          │
│ …            ┆ …            ┆ …    ┆ …            │
│ LRCUSDT      ┆ -0.103596    ┆ 141  ┆ 9            │
│ 1000XECUSDT  ┆ -0.083097    ┆ 142  ┆ 8            │
│ TRBUSDT      ┆ -0.079504    ┆ 143  ┆ 7            │
│ RVNUSDT      ┆ 0.015159     ┆ 144  ┆ 6            │
│ ATAUSDT      ┆ 0.097471     ┆ 145  ┆ 5            │
│ LPTUSDT      ┆ 0.105125     ┆ 146  ┆ 4            │
│ BAKEUSDT     ┆ 0.156791     ┆ 147  ┆ 3            │
│ CVXUSDT      ┆ 0.397631     ┆ 148  ┆ 2            │
│ DEFIUSDT     ┆ 0.896898     ┆ 149  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.061703     ┆ 150  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,755 - WARNING - 2023-06-04T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,755 - INFO - cur close time: 2023-06-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:57,755 - DEBUG - mean expected ret (mean factor): -0.7940264837378718
2024-11-20 23:06:57,759 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,760 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,760 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1094      ┆ null        ┆ … ┆ 0.02394 ┆ null   ┆ null    ┆ 0.2207  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,767 - DEBUG - update position: 2023-06-04T23:59:59.999 === diff_trading_value: 231001.198887069 == cash: 118404.66091322445 
2024-11-20 23:06:57,768 - INFO - pnl: 2023-06-04T23:59:59.999 118404.66091322445 === 0.375%
2024-11-20 23:06:57,771 - DEBUG - cur time: 2023-06-05T23:59:59.999 == next bar open time: 2023-06-06T00:00:00.000 == close pos time: 2023-06-13T00:00:00.000
2024-11-20 23:06:57,771 - INFO - pnl: 2023-06-05T23:59:59.999 120506.60860843398 === 1.775%
2024-11-20 23:06:57,776 - DEBUG - cur time: 2023-06-06T23:59:59.999 == next bar open time: 2023-06-07T00:00:00.000 == close pos time: 2023-06-14T00:00:00.000
2024-11-20 23:06:57,779 - INFO - pnl: 2023-06-06T23:59:59.999 121149.5482344906 === 0.534%
2024-11-20 23:06:57,783 - DEBUG - cur time: 2023-06-07T23:59:59.999 == next bar open time: 2023-06-08T00:00:00.000 == close pos time: 2023-06-15T00:00:00.000
2024-11-20 23:06:57,785 - INFO - pnl: 2023-06-07T23:59:59.999 121259.35601102326 === 0.091%
2024-11-20 23:06:57,788 - DEBUG - cur time: 2023-06-08T23:59:59.999 == next bar open time: 2023-06-09T00:00:00.000 == close pos time: 2023-06-16T00:00:00.000
2024-11-20 23:06:57,789 - INFO - pnl: 2023-06-08T23:59:59.999 121189.26307823202 === -0.058%
2024-11-20 23:06:57,793 - DEBUG - cur time: 2023-06-09T23:59:59.999 == next bar open time: 2023-06-10T00:00:00.000 == close pos time: 2023-06-17T00:00:00.000
2024-11-20 23:06:57,795 - INFO - pnl: 2023-06-09T23:59:59.999 121566.28082231803 === 0.311%
2024-11-20 23:06:57,797 - DEBUG - cur time: 2023-06-10T23:59:59.999 == next bar open time: 2023-06-11T00:00:00.000 == close pos time: 2023-06-18T00:00:00.000
2024-11-20 23:06:57,799 - INFO - pnl: 2023-06-10T23:59:59.999 121563.035306251 === -0.003%
2024-11-20 23:06:57,803 - DEBUG - cur time: 2023-06-11T23:59:59.999 == next bar open time: 2023-06-12T00:00:00.000 == close pos time: 2023-06-19T00:00:00.000
2024-11-20 23:06:57,811 - DEBUG - sorted_long_factors: shape: (153, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ KAVAUSDT     ┆ -1.841636    ┆ 0    ┆ 152          │
│ TOMOUSDT     ┆ -1.733951    ┆ 1    ┆ 151          │
│ MTLUSDT      ┆ -1.673263    ┆ 2    ┆ 150          │
│ RNDRUSDT     ┆ -1.665668    ┆ 3    ┆ 149          │
│ XRPUSDT      ┆ -1.508924    ┆ 4    ┆ 148          │
│ STXUSDT      ┆ -1.507112    ┆ 5    ┆ 147          │
│ BTCDOMUSDT   ┆ -1.485097    ┆ 6    ┆ 146          │
│ SXPUSDT      ┆ -1.446036    ┆ 7    ┆ 145          │
│ AGIXUSDT     ┆ -1.434329    ┆ 8    ┆ 144          │
│ CFXUSDT      ┆ -1.43005     ┆ 9    ┆ 143          │
│ …            ┆ …            ┆ …    ┆ …            │
│ 1000XECUSDT  ┆ -0.134931    ┆ 143  ┆ 9            │
│ QNTUSDT      ┆ -0.094567    ┆ 144  ┆ 8            │
│ API3USDT     ┆ 0.032614     ┆ 145  ┆ 7            │
│ FOOTBALLUSDT ┆ 0.066733     ┆ 146  ┆ 6            │
│ ATAUSDT      ┆ 0.067653     ┆ 147  ┆ 5            │
│ GALUSDT      ┆ 0.068252     ┆ 148  ┆ 4            │
│ CVXUSDT      ┆ 0.19245      ┆ 149  ┆ 3            │
│ ZENUSDT      ┆ 0.30684      ┆ 150  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.025611     ┆ 151  ┆ 1            │
│ DEFIUSDT     ┆ 1.098246     ┆ 152  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,817 - WARNING - 2023-06-11T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,818 - INFO - cur close time: 2023-06-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:57,818 - DEBUG - mean expected ret (mean factor): -0.7968377229846213
2024-11-20 23:06:57,823 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,823 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,823 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08744     ┆ null        ┆ … ┆ 0.01745 ┆ null   ┆ null    ┆ 0.1758  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,830 - DEBUG - update position: 2023-06-11T23:59:59.999 === diff_trading_value: 241887.20232138786 == cash: 120898.1110397068 
2024-11-20 23:06:57,831 - INFO - pnl: 2023-06-11T23:59:59.999 120898.1110397068 === -0.547%
2024-11-20 23:06:57,835 - DEBUG - cur time: 2023-06-12T23:59:59.999 == next bar open time: 2023-06-13T00:00:00.000 == close pos time: 2023-06-20T00:00:00.000
2024-11-20 23:06:57,837 - INFO - pnl: 2023-06-12T23:59:59.999 121004.04689813296 === 0.088%
2024-11-20 23:06:57,840 - DEBUG - cur time: 2023-06-13T23:59:59.999 == next bar open time: 2023-06-14T00:00:00.000 == close pos time: 2023-06-21T00:00:00.000
2024-11-20 23:06:57,841 - INFO - pnl: 2023-06-13T23:59:59.999 122236.6958587199 === 1.019%
2024-11-20 23:06:57,845 - DEBUG - cur time: 2023-06-14T23:59:59.999 == next bar open time: 2023-06-15T00:00:00.000 == close pos time: 2023-06-22T00:00:00.000
2024-11-20 23:06:57,847 - INFO - pnl: 2023-06-14T23:59:59.999 121756.02067509243 === -0.393%
2024-11-20 23:06:57,849 - DEBUG - cur time: 2023-06-15T23:59:59.999 == next bar open time: 2023-06-16T00:00:00.000 == close pos time: 2023-06-23T00:00:00.000
2024-11-20 23:06:57,851 - INFO - pnl: 2023-06-15T23:59:59.999 120176.55773893876 === -1.297%
2024-11-20 23:06:57,855 - DEBUG - cur time: 2023-06-16T23:59:59.999 == next bar open time: 2023-06-17T00:00:00.000 == close pos time: 2023-06-24T00:00:00.000
2024-11-20 23:06:57,855 - INFO - pnl: 2023-06-16T23:59:59.999 121005.52091328896 === 0.690%
2024-11-20 23:06:57,859 - DEBUG - cur time: 2023-06-17T23:59:59.999 == next bar open time: 2023-06-18T00:00:00.000 == close pos time: 2023-06-25T00:00:00.000
2024-11-20 23:06:57,859 - INFO - pnl: 2023-06-17T23:59:59.999 120699.18308783189 === -0.253%
2024-11-20 23:06:57,863 - DEBUG - cur time: 2023-06-18T23:59:59.999 == next bar open time: 2023-06-19T00:00:00.000 == close pos time: 2023-06-26T00:00:00.000
2024-11-20 23:06:57,870 - DEBUG - sorted_long_factors: shape: (155, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT    ┆ -1.899774    ┆ 0    ┆ 154          │
│ WAVESUSDT   ┆ -1.736332    ┆ 1    ┆ 153          │
│ RNDRUSDT    ┆ -1.671071    ┆ 2    ┆ 152          │
│ EOSUSDT     ┆ -1.650427    ┆ 3    ┆ 151          │
│ ANTUSDT     ┆ -1.616943    ┆ 4    ┆ 150          │
│ HIGHUSDT    ┆ -1.579532    ┆ 5    ┆ 149          │
│ XRPUSDT     ┆ -1.504538    ┆ 6    ┆ 148          │
│ CFXUSDT     ┆ -1.482354    ┆ 7    ┆ 147          │
│ MAGICUSDT   ┆ -1.481766    ┆ 8    ┆ 146          │
│ KAVAUSDT    ┆ -1.452715    ┆ 9    ┆ 145          │
│ …           ┆ …            ┆ …    ┆ …            │
│ REEFUSDT    ┆ -0.057844    ┆ 145  ┆ 9            │
│ BLZUSDT     ┆ -0.035977    ┆ 146  ┆ 8            │
│ WOOUSDT     ┆ 0.013009     ┆ 147  ┆ 7            │
│ FLMUSDT     ┆ 0.036623     ┆ 148  ┆ 6            │
│ 1000XECUSDT ┆ 0.064525     ┆ 149  ┆ 5            │
│ BTCDOMUSDT  ┆ 0.068222     ┆ 150  ┆ 4            │
│ DEFIUSDT    ┆ 0.088654     ┆ 151  ┆ 3            │
│ DGBUSDT     ┆ 0.119637     ┆ 152  ┆ 2            │
│ CVXUSDT     ┆ 0.284367     ┆ 153  ┆ 1            │
│ ATAUSDT     ┆ 0.433046     ┆ 154  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,878 - WARNING - 2023-06-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,878 - INFO - cur close time: 2023-06-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:57,878 - DEBUG - mean expected ret (mean factor): -0.8045011484691498
2024-11-20 23:06:57,883 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,883 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,883 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08878     ┆ null        ┆ … ┆ 0.01724 ┆ null   ┆ null    ┆ 0.1748  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,890 - DEBUG - update position: 2023-06-18T23:59:59.999 === diff_trading_value: 247731.85946438176 == cash: 120733.13996203472 
2024-11-20 23:06:57,892 - INFO - pnl: 2023-06-18T23:59:59.999 120733.13996203472 === 0.028%
2024-11-20 23:06:57,896 - DEBUG - cur time: 2023-06-19T23:59:59.999 == next bar open time: 2023-06-20T00:00:00.000 == close pos time: 2023-06-27T00:00:00.000
2024-11-20 23:06:57,898 - INFO - pnl: 2023-06-19T23:59:59.999 120211.78088323351 === -0.432%
2024-11-20 23:06:57,903 - DEBUG - cur time: 2023-06-20T23:59:59.999 == next bar open time: 2023-06-21T00:00:00.000 == close pos time: 2023-06-28T00:00:00.000
2024-11-20 23:06:57,906 - INFO - pnl: 2023-06-20T23:59:59.999 118616.87206089347 === -1.327%
2024-11-20 23:06:57,913 - DEBUG - cur time: 2023-06-21T23:59:59.999 == next bar open time: 2023-06-22T00:00:00.000 == close pos time: 2023-06-29T00:00:00.000
2024-11-20 23:06:57,915 - INFO - pnl: 2023-06-21T23:59:59.999 119509.25421238912 === 0.752%
2024-11-20 23:06:57,920 - DEBUG - cur time: 2023-06-22T23:59:59.999 == next bar open time: 2023-06-23T00:00:00.000 == close pos time: 2023-06-30T00:00:00.000
2024-11-20 23:06:57,923 - INFO - pnl: 2023-06-22T23:59:59.999 118826.93960951151 === -0.571%
2024-11-20 23:06:57,928 - DEBUG - cur time: 2023-06-23T23:59:59.999 == next bar open time: 2023-06-24T00:00:00.000 == close pos time: 2023-07-01T00:00:00.000
2024-11-20 23:06:57,930 - INFO - pnl: 2023-06-23T23:59:59.999 119989.32851683605 === 0.978%
2024-11-20 23:06:57,936 - DEBUG - cur time: 2023-06-24T23:59:59.999 == next bar open time: 2023-06-25T00:00:00.000 == close pos time: 2023-07-02T00:00:00.000
2024-11-20 23:06:57,938 - INFO - pnl: 2023-06-24T23:59:59.999 114077.44769365573 === -4.927%
2024-11-20 23:06:57,943 - DEBUG - cur time: 2023-06-25T23:59:59.999 == next bar open time: 2023-06-26T00:00:00.000 == close pos time: 2023-07-03T00:00:00.000
2024-11-20 23:06:57,953 - DEBUG - sorted_long_factors: shape: (157, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT      ┆ -1.841211    ┆ 0    ┆ 156          │
│ XMRUSDT      ┆ -1.806841    ┆ 1    ┆ 155          │
│ RNDRUSDT     ┆ -1.717546    ┆ 2    ┆ 154          │
│ FILUSDT      ┆ -1.686005    ┆ 3    ┆ 153          │
│ BNBUSDT      ┆ -1.633611    ┆ 4    ┆ 152          │
│ MINAUSDT     ┆ -1.588924    ┆ 5    ┆ 151          │
│ AGIXUSDT     ┆ -1.545843    ┆ 6    ┆ 150          │
│ MASKUSDT     ┆ -1.533788    ┆ 7    ┆ 149          │
│ AXSUSDT      ┆ -1.42972     ┆ 8    ┆ 148          │
│ LUNA2USDT    ┆ -1.426191    ┆ 9    ┆ 147          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOTXUSDT     ┆ -0.079876    ┆ 147  ┆ 9            │
│ REEFUSDT     ┆ 0.012649     ┆ 148  ┆ 8            │
│ IOSTUSDT     ┆ 0.016136     ┆ 149  ┆ 7            │
│ 1000XECUSDT  ┆ 0.036601     ┆ 150  ┆ 6            │
│ CVXUSDT      ┆ 0.067221     ┆ 151  ┆ 5            │
│ DGBUSDT      ┆ 0.117536     ┆ 152  ┆ 4            │
│ CTKUSDT      ┆ 0.157951     ┆ 153  ┆ 3            │
│ DARUSDT      ┆ 0.255302     ┆ 154  ┆ 2            │
│ DEFIUSDT     ┆ 0.315907     ┆ 155  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.698034     ┆ 156  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:57,963 - WARNING - 2023-06-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:57,963 - INFO - cur close time: 2023-06-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:57,963 - DEBUG - mean expected ret (mean factor): -0.8194053516140899
2024-11-20 23:06:57,968 - DEBUG - begin to update pos: =========
2024-11-20 23:06:57,969 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,969 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09206     ┆ null        ┆ … ┆ 0.02064 ┆ null   ┆ null    ┆ 0.2072  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:57,979 - DEBUG - update position: 2023-06-25T23:59:59.999 === diff_trading_value: 272636.9991782454 == cash: 116578.3776278607 
2024-11-20 23:06:57,981 - INFO - pnl: 2023-06-25T23:59:59.999 116578.3776278607 === 2.192%
2024-11-20 23:06:57,987 - DEBUG - cur time: 2023-06-26T23:59:59.999 == next bar open time: 2023-06-27T00:00:00.000 == close pos time: 2023-07-04T00:00:00.000
2024-11-20 23:06:57,988 - INFO - pnl: 2023-06-26T23:59:59.999 115907.51897974458 === -0.575%
2024-11-20 23:06:57,993 - DEBUG - cur time: 2023-06-27T23:59:59.999 == next bar open time: 2023-06-28T00:00:00.000 == close pos time: 2023-07-05T00:00:00.000
2024-11-20 23:06:57,995 - INFO - pnl: 2023-06-27T23:59:59.999 115909.18457610635 === 0.001%
2024-11-20 23:06:57,999 - DEBUG - cur time: 2023-06-28T23:59:59.999 == next bar open time: 2023-06-29T00:00:00.000 == close pos time: 2023-07-06T00:00:00.000
2024-11-20 23:06:58,001 - INFO - pnl: 2023-06-28T23:59:59.999 114978.8062620243 === -0.803%
2024-11-20 23:06:58,006 - DEBUG - cur time: 2023-06-29T23:59:59.999 == next bar open time: 2023-06-30T00:00:00.000 == close pos time: 2023-07-07T00:00:00.000
2024-11-20 23:06:58,007 - INFO - pnl: 2023-06-29T23:59:59.999 114914.19334016692 === -0.056%
2024-11-20 23:06:58,012 - DEBUG - cur time: 2023-06-30T23:59:59.999 == next bar open time: 2023-07-01T00:00:00.000 == close pos time: 2023-07-08T00:00:00.000
2024-11-20 23:06:58,013 - INFO - pnl: 2023-06-30T23:59:59.999 120272.88771533457 === 4.663%
2024-11-20 23:06:58,018 - DEBUG - cur time: 2023-07-01T23:59:59.999 == next bar open time: 2023-07-02T00:00:00.000 == close pos time: 2023-07-09T00:00:00.000
2024-11-20 23:06:58,021 - INFO - pnl: 2023-07-01T23:59:59.999 118665.09963195349 === -1.337%
2024-11-20 23:06:58,030 - DEBUG - cur time: 2023-07-02T23:59:59.999 == next bar open time: 2023-07-03T00:00:00.000 == close pos time: 2023-07-10T00:00:00.000
2024-11-20 23:06:58,044 - DEBUG - sorted_long_factors: shape: (159, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HOOKUSDT     ┆ -1.834974    ┆ 0    ┆ 158          │
│ ARBUSDT      ┆ -1.739934    ┆ 1    ┆ 157          │
│ MAGICUSDT    ┆ -1.646652    ┆ 2    ┆ 156          │
│ KAVAUSDT     ┆ -1.517509    ┆ 3    ┆ 155          │
│ MASKUSDT     ┆ -1.50557     ┆ 4    ┆ 154          │
│ HIGHUSDT     ┆ -1.442429    ┆ 5    ┆ 153          │
│ NEARUSDT     ┆ -1.435847    ┆ 6    ┆ 152          │
│ YFIUSDT      ┆ -1.433853    ┆ 7    ┆ 151          │
│ FILUSDT      ┆ -1.427679    ┆ 8    ┆ 150          │
│ DASHUSDT     ┆ -1.420766    ┆ 9    ┆ 149          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DGBUSDT      ┆ 0.030061     ┆ 149  ┆ 9            │
│ ATAUSDT      ┆ 0.034553     ┆ 150  ┆ 8            │
│ API3USDT     ┆ 0.112763     ┆ 151  ┆ 7            │
│ PERPUSDT     ┆ 0.177003     ┆ 152  ┆ 6            │
│ SPELLUSDT    ┆ 0.21404      ┆ 153  ┆ 5            │
│ IOTXUSDT     ┆ 0.226272     ┆ 154  ┆ 4            │
│ DARUSDT      ┆ 0.357519     ┆ 155  ┆ 3            │
│ CTKUSDT      ┆ 0.539404     ┆ 156  ┆ 2            │
│ DEFIUSDT     ┆ 0.719745     ┆ 157  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.163344     ┆ 158  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:58,054 - WARNING - 2023-07-02T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:58,055 - INFO - cur close time: 2023-07-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:58,055 - DEBUG - mean expected ret (mean factor): -0.8250308002326419
2024-11-20 23:06:58,060 - DEBUG - begin to update pos: =========
2024-11-20 23:06:58,061 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,061 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08679     ┆ null        ┆ … ┆ 0.02149 ┆ null   ┆ null    ┆ 0.2143  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,073 - DEBUG - update position: 2023-07-02T23:59:59.999 === diff_trading_value: 215336.22670542513 == cash: 119015.93038752327 
2024-11-20 23:06:58,077 - INFO - pnl: 2023-07-02T23:59:59.999 119015.93038752327 === 0.296%
2024-11-20 23:06:58,087 - DEBUG - cur time: 2023-07-03T23:59:59.999 == next bar open time: 2023-07-04T00:00:00.000 == close pos time: 2023-07-11T00:00:00.000
2024-11-20 23:06:58,090 - INFO - pnl: 2023-07-03T23:59:59.999 119378.0606132165 === 0.304%
2024-11-20 23:06:58,099 - DEBUG - cur time: 2023-07-04T23:59:59.999 == next bar open time: 2023-07-05T00:00:00.000 == close pos time: 2023-07-12T00:00:00.000
2024-11-20 23:06:58,105 - INFO - pnl: 2023-07-04T23:59:59.999 121336.87310379845 === 1.641%
2024-11-20 23:06:58,117 - DEBUG - cur time: 2023-07-05T23:59:59.999 == next bar open time: 2023-07-06T00:00:00.000 == close pos time: 2023-07-13T00:00:00.000
2024-11-20 23:06:58,121 - INFO - pnl: 2023-07-05T23:59:59.999 120606.61064210245 === -0.602%
2024-11-20 23:06:58,133 - DEBUG - cur time: 2023-07-06T23:59:59.999 == next bar open time: 2023-07-07T00:00:00.000 == close pos time: 2023-07-14T00:00:00.000
2024-11-20 23:06:58,139 - INFO - pnl: 2023-07-06T23:59:59.999 121448.3198624104 === 0.698%
2024-11-20 23:06:58,148 - DEBUG - cur time: 2023-07-07T23:59:59.999 == next bar open time: 2023-07-08T00:00:00.000 == close pos time: 2023-07-15T00:00:00.000
2024-11-20 23:06:58,152 - INFO - pnl: 2023-07-07T23:59:59.999 120806.61721810019 === -0.528%
2024-11-20 23:06:58,159 - DEBUG - cur time: 2023-07-08T23:59:59.999 == next bar open time: 2023-07-09T00:00:00.000 == close pos time: 2023-07-16T00:00:00.000
2024-11-20 23:06:58,166 - INFO - pnl: 2023-07-08T23:59:59.999 119885.74244464729 === -0.762%
2024-11-20 23:06:58,181 - DEBUG - cur time: 2023-07-09T23:59:59.999 == next bar open time: 2023-07-10T00:00:00.000 == close pos time: 2023-07-17T00:00:00.000
2024-11-20 23:06:58,212 - DEBUG - sorted_long_factors: shape: (163, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -2.194241    ┆ 0    ┆ 162          │
│ SSVUSDT      ┆ -1.814915    ┆ 1    ┆ 161          │
│ MAGICUSDT    ┆ -1.742308    ┆ 2    ┆ 160          │
│ CFXUSDT      ┆ -1.643647    ┆ 3    ┆ 159          │
│ TOMOUSDT     ┆ -1.624541    ┆ 4    ┆ 158          │
│ BTCDOMUSDT   ┆ -1.591703    ┆ 5    ┆ 157          │
│ HOOKUSDT     ┆ -1.540507    ┆ 6    ┆ 156          │
│ STGUSDT      ┆ -1.497273    ┆ 7    ┆ 155          │
│ STXUSDT      ┆ -1.472238    ┆ 8    ┆ 154          │
│ RNDRUSDT     ┆ -1.463409    ┆ 9    ┆ 153          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ -0.073095    ┆ 153  ┆ 9            │
│ RSRUSDT      ┆ 0.013777     ┆ 154  ┆ 8            │
│ API3USDT     ┆ 0.015354     ┆ 155  ┆ 7            │
│ CHRUSDT      ┆ 0.015573     ┆ 156  ┆ 6            │
│ IOTXUSDT     ┆ 0.066348     ┆ 157  ┆ 5            │
│ PERPUSDT     ┆ 0.3685       ┆ 158  ┆ 4            │
│ DEFIUSDT     ┆ 0.386286     ┆ 159  ┆ 3            │
│ GTCUSDT      ┆ 0.481805     ┆ 160  ┆ 2            │
│ CTKUSDT      ┆ 0.817175     ┆ 161  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.876938     ┆ 162  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:58,233 - WARNING - 2023-07-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:58,233 - INFO - cur close time: 2023-07-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:58,234 - DEBUG - mean expected ret (mean factor): -0.804513461976363
2024-11-20 23:06:58,248 - DEBUG - begin to update pos: =========
2024-11-20 23:06:58,249 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,250 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08195     ┆ null        ┆ … ┆ 0.02022 ┆ null   ┆ null    ┆ 0.2021  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,264 - DEBUG - update position: 2023-07-09T23:59:59.999 === diff_trading_value: 241271.82705528257 == cash: 119592.77271238819 
2024-11-20 23:06:58,266 - INFO - pnl: 2023-07-09T23:59:59.999 119592.77271238819 === -0.244%
2024-11-20 23:06:58,276 - DEBUG - cur time: 2023-07-10T23:59:59.999 == next bar open time: 2023-07-11T00:00:00.000 == close pos time: 2023-07-18T00:00:00.000
2024-11-20 23:06:58,280 - INFO - pnl: 2023-07-10T23:59:59.999 120343.95140555863 === 0.628%
2024-11-20 23:06:58,287 - DEBUG - cur time: 2023-07-11T23:59:59.999 == next bar open time: 2023-07-12T00:00:00.000 == close pos time: 2023-07-19T00:00:00.000
2024-11-20 23:06:58,290 - INFO - pnl: 2023-07-11T23:59:59.999 119089.76750661072 === -1.042%
2024-11-20 23:06:58,299 - DEBUG - cur time: 2023-07-12T23:59:59.999 == next bar open time: 2023-07-13T00:00:00.000 == close pos time: 2023-07-20T00:00:00.000
2024-11-20 23:06:58,302 - INFO - pnl: 2023-07-12T23:59:59.999 118262.16812781253 === -0.695%
2024-11-20 23:06:58,306 - DEBUG - cur time: 2023-07-13T23:59:59.999 == next bar open time: 2023-07-14T00:00:00.000 == close pos time: 2023-07-21T00:00:00.000
2024-11-20 23:06:58,309 - INFO - pnl: 2023-07-13T23:59:59.999 122053.00989677562 === 3.205%
2024-11-20 23:06:58,313 - DEBUG - cur time: 2023-07-14T23:59:59.999 == next bar open time: 2023-07-15T00:00:00.000 == close pos time: 2023-07-22T00:00:00.000
2024-11-20 23:06:58,315 - INFO - pnl: 2023-07-14T23:59:59.999 123476.98296424939 === 1.167%
2024-11-20 23:06:58,322 - DEBUG - cur time: 2023-07-15T23:59:59.999 == next bar open time: 2023-07-16T00:00:00.000 == close pos time: 2023-07-23T00:00:00.000
2024-11-20 23:06:58,324 - INFO - pnl: 2023-07-15T23:59:59.999 123774.87917742335 === 0.241%
2024-11-20 23:06:58,329 - DEBUG - cur time: 2023-07-16T23:59:59.999 == next bar open time: 2023-07-17T00:00:00.000 == close pos time: 2023-07-24T00:00:00.000
2024-11-20 23:06:58,340 - DEBUG - sorted_long_factors: shape: (165, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MKRUSDT      ┆ -1.751045    ┆ 0    ┆ 164          │
│ COMPUSDT     ┆ -1.746011    ┆ 1    ┆ 163          │
│ STXUSDT      ┆ -1.740029    ┆ 2    ┆ 162          │
│ ARBUSDT      ┆ -1.73492     ┆ 3    ┆ 161          │
│ STORJUSDT    ┆ -1.682944    ┆ 4    ┆ 160          │
│ SSVUSDT      ┆ -1.619923    ┆ 5    ┆ 159          │
│ USDCUSDT     ┆ -1.607099    ┆ 6    ┆ 158          │
│ LQTYUSDT     ┆ -1.605019    ┆ 7    ┆ 157          │
│ WAVESUSDT    ┆ -1.54635     ┆ 8    ┆ 156          │
│ FETUSDT      ┆ -1.543777    ┆ 9    ┆ 155          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BAKEUSDT     ┆ 0.134503     ┆ 155  ┆ 9            │
│ LPTUSDT      ┆ 0.151861     ┆ 156  ┆ 8            │
│ REEFUSDT     ┆ 0.152136     ┆ 157  ┆ 7            │
│ CTKUSDT      ┆ 0.225446     ┆ 158  ┆ 6            │
│ OGNUSDT      ┆ 0.2619       ┆ 159  ┆ 5            │
│ GTCUSDT      ┆ 0.319321     ┆ 160  ┆ 4            │
│ CHRUSDT      ┆ 0.326284     ┆ 161  ┆ 3            │
│ DEFIUSDT     ┆ 0.387479     ┆ 162  ┆ 2            │
│ IOTXUSDT     ┆ 0.447706     ┆ 163  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.550545     ┆ 164  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:58,347 - INFO - cur close time: 2023-07-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:06:58,347 - DEBUG - mean expected ret (mean factor): -0.8188432038410135
2024-11-20 23:06:58,352 - DEBUG - begin to update pos: =========
2024-11-20 23:06:58,353 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,353 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09195     ┆ null        ┆ … ┆ 0.02163 ┆ null   ┆ null    ┆ 0.2122  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,361 - DEBUG - update position: 2023-07-16T23:59:59.999 === diff_trading_value: 233284.2321665366 == cash: 122921.76432043254 
2024-11-20 23:06:58,363 - INFO - pnl: 2023-07-16T23:59:59.999 122921.76432043254 === -0.689%
2024-11-20 23:06:58,366 - DEBUG - cur time: 2023-07-17T23:59:59.999 == next bar open time: 2023-07-18T00:00:00.000 == close pos time: 2023-07-25T00:00:00.000
2024-11-20 23:06:58,368 - INFO - pnl: 2023-07-17T23:59:59.999 124522.64780863222 === 1.302%
2024-11-20 23:06:58,372 - DEBUG - cur time: 2023-07-18T23:59:59.999 == next bar open time: 2023-07-19T00:00:00.000 == close pos time: 2023-07-26T00:00:00.000
2024-11-20 23:06:58,373 - INFO - pnl: 2023-07-18T23:59:59.999 124150.54602419617 === -0.299%
2024-11-20 23:06:58,377 - DEBUG - cur time: 2023-07-19T23:59:59.999 == next bar open time: 2023-07-20T00:00:00.000 == close pos time: 2023-07-27T00:00:00.000
2024-11-20 23:06:58,379 - INFO - pnl: 2023-07-19T23:59:59.999 123330.48030744192 === -0.661%
2024-11-20 23:06:58,382 - DEBUG - cur time: 2023-07-20T23:59:59.999 == next bar open time: 2023-07-21T00:00:00.000 == close pos time: 2023-07-28T00:00:00.000
2024-11-20 23:06:58,383 - INFO - pnl: 2023-07-20T23:59:59.999 124154.44083522746 === 0.668%
2024-11-20 23:06:58,386 - DEBUG - cur time: 2023-07-21T23:59:59.999 == next bar open time: 2023-07-22T00:00:00.000 == close pos time: 2023-07-29T00:00:00.000
2024-11-20 23:06:58,388 - INFO - pnl: 2023-07-21T23:59:59.999 123665.87409159461 === -0.394%
2024-11-20 23:06:58,391 - DEBUG - cur time: 2023-07-22T23:59:59.999 == next bar open time: 2023-07-23T00:00:00.000 == close pos time: 2023-07-30T00:00:00.000
2024-11-20 23:06:58,393 - INFO - pnl: 2023-07-22T23:59:59.999 122334.92644577072 === -1.076%
2024-11-20 23:06:58,396 - DEBUG - cur time: 2023-07-23T23:59:59.999 == next bar open time: 2023-07-24T00:00:00.000 == close pos time: 2023-07-31T00:00:00.000
2024-11-20 23:06:58,403 - DEBUG - sorted_long_factors: shape: (166, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ STXUSDT      ┆ -2.004889    ┆ 0    ┆ 165          │
│ ARBUSDT      ┆ -1.786047    ┆ 1    ┆ 164          │
│ LQTYUSDT     ┆ -1.783317    ┆ 2    ┆ 163          │
│ YFIUSDT      ┆ -1.726139    ┆ 3    ┆ 162          │
│ WAVESUSDT    ┆ -1.708471    ┆ 4    ┆ 161          │
│ AAVEUSDT     ┆ -1.657644    ┆ 5    ┆ 160          │
│ RNDRUSDT     ┆ -1.621526    ┆ 6    ┆ 159          │
│ CELOUSDT     ┆ -1.601871    ┆ 7    ┆ 158          │
│ BELUSDT      ┆ -1.58614     ┆ 8    ┆ 157          │
│ MAGICUSDT    ┆ -1.536082    ┆ 9    ┆ 156          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SKLUSDT      ┆ 0.214141     ┆ 156  ┆ 9            │
│ IOTXUSDT     ┆ 0.226876     ┆ 157  ┆ 8            │
│ LEVERUSDT    ┆ 0.260697     ┆ 158  ┆ 7            │
│ RVNUSDT      ┆ 0.30668      ┆ 159  ┆ 6            │
│ ATAUSDT      ┆ 0.332868     ┆ 160  ┆ 5            │
│ CTKUSDT      ┆ 0.40632      ┆ 161  ┆ 4            │
│ SPELLUSDT    ┆ 0.586022     ┆ 162  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.625285     ┆ 163  ┆ 2            │
│ LPTUSDT      ┆ 0.631836     ┆ 164  ┆ 1            │
│ TLMUSDT      ┆ 0.638232     ┆ 165  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:58,410 - INFO - cur close time: 2023-07-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:06:58,410 - DEBUG - mean expected ret (mean factor): -0.8296327751803848
2024-11-20 23:06:58,415 - DEBUG - begin to update pos: =========
2024-11-20 23:06:58,416 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,416 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08619     ┆ null        ┆ … ┆ 0.0222  ┆ null   ┆ null    ┆ 0.2154  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,422 - DEBUG - update position: 2023-07-23T23:59:59.999 === diff_trading_value: 175076.39434045862 == cash: 126836.58017715409 
2024-11-20 23:06:58,424 - INFO - pnl: 2023-07-23T23:59:59.999 126836.58017715409 === 3.680%
2024-11-20 23:06:58,427 - DEBUG - cur time: 2023-07-24T23:59:59.999 == next bar open time: 2023-07-25T00:00:00.000 == close pos time: 2023-08-01T00:00:00.000
2024-11-20 23:06:58,429 - INFO - pnl: 2023-07-24T23:59:59.999 126423.38126659025 === -0.326%
2024-11-20 23:06:58,433 - DEBUG - cur time: 2023-07-25T23:59:59.999 == next bar open time: 2023-07-26T00:00:00.000 == close pos time: 2023-08-02T00:00:00.000
2024-11-20 23:06:58,435 - INFO - pnl: 2023-07-25T23:59:59.999 125420.79962122778 === -0.793%
2024-11-20 23:06:58,438 - DEBUG - cur time: 2023-07-26T23:59:59.999 == next bar open time: 2023-07-27T00:00:00.000 == close pos time: 2023-08-03T00:00:00.000
2024-11-20 23:06:58,440 - INFO - pnl: 2023-07-26T23:59:59.999 125422.68725042872 === 0.002%
2024-11-20 23:06:58,444 - DEBUG - cur time: 2023-07-27T23:59:59.999 == next bar open time: 2023-07-28T00:00:00.000 == close pos time: 2023-08-04T00:00:00.000
2024-11-20 23:06:58,446 - INFO - pnl: 2023-07-27T23:59:59.999 125749.98670657753 === 0.261%
2024-11-20 23:06:58,450 - DEBUG - cur time: 2023-07-28T23:59:59.999 == next bar open time: 2023-07-29T00:00:00.000 == close pos time: 2023-08-05T00:00:00.000
2024-11-20 23:06:58,453 - INFO - pnl: 2023-07-28T23:59:59.999 124832.14330046313 === -0.730%
2024-11-20 23:06:58,457 - DEBUG - cur time: 2023-07-29T23:59:59.999 == next bar open time: 2023-07-30T00:00:00.000 == close pos time: 2023-08-06T00:00:00.000
2024-11-20 23:06:58,459 - INFO - pnl: 2023-07-29T23:59:59.999 124908.46925681902 === 0.061%
2024-11-20 23:06:58,463 - DEBUG - cur time: 2023-07-30T23:59:59.999 == next bar open time: 2023-07-31T00:00:00.000 == close pos time: 2023-08-07T00:00:00.000
2024-11-20 23:06:58,473 - DEBUG - sorted_long_factors: shape: (166, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WAVESUSDT    ┆ -1.873014    ┆ 0    ┆ 165          │
│ IDUSDT       ┆ -1.83555     ┆ 1    ┆ 164          │
│ NEOUSDT      ┆ -1.737361    ┆ 2    ┆ 163          │
│ UNIUSDT      ┆ -1.694233    ┆ 3    ┆ 162          │
│ ARBUSDT      ┆ -1.655491    ┆ 4    ┆ 161          │
│ DYDXUSDT     ┆ -1.546952    ┆ 5    ┆ 160          │
│ STXUSDT      ┆ -1.511637    ┆ 6    ┆ 159          │
│ DOTUSDT      ┆ -1.50527     ┆ 7    ┆ 158          │
│ IMXUSDT      ┆ -1.504489    ┆ 8    ┆ 157          │
│ ZECUSDT      ┆ -1.470193    ┆ 9    ┆ 156          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RVNUSDT      ┆ 0.014625     ┆ 156  ┆ 9            │
│ LPTUSDT      ┆ 0.111942     ┆ 157  ┆ 8            │
│ TLMUSDT      ┆ 0.124042     ┆ 158  ┆ 7            │
│ HFTUSDT      ┆ 0.12508      ┆ 159  ┆ 6            │
│ CVXUSDT      ┆ 0.159327     ┆ 160  ┆ 5            │
│ BLUEBIRDUSDT ┆ 0.312131     ┆ 161  ┆ 4            │
│ BLZUSDT      ┆ 0.38292      ┆ 162  ┆ 3            │
│ IOTXUSDT     ┆ 0.407206     ┆ 163  ┆ 2            │
│ CTKUSDT      ┆ 0.504317     ┆ 164  ┆ 1            │
│ DEFIUSDT     ┆ 0.586407     ┆ 165  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:58,480 - WARNING - 2023-07-30T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:58,480 - INFO - cur close time: 2023-07-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:58,480 - DEBUG - mean expected ret (mean factor): -0.79308493303424
2024-11-20 23:06:58,485 - DEBUG - begin to update pos: =========
2024-11-20 23:06:58,486 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,486 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08115     ┆ null        ┆ … ┆ 0.02091 ┆ null   ┆ null    ┆ 0.2163  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,492 - DEBUG - update position: 2023-07-30T23:59:59.999 === diff_trading_value: 182320.89795175014 == cash: 123998.1735058909 
2024-11-20 23:06:58,494 - INFO - pnl: 2023-07-30T23:59:59.999 123998.1735058909 === -0.729%
2024-11-20 23:06:58,497 - DEBUG - cur time: 2023-07-31T23:59:59.999 == next bar open time: 2023-08-01T00:00:00.000 == close pos time: 2023-08-08T00:00:00.000
2024-11-20 23:06:58,498 - INFO - pnl: 2023-07-31T23:59:59.999 123010.62163383272 === -0.796%
2024-11-20 23:06:58,502 - DEBUG - cur time: 2023-08-01T23:59:59.999 == next bar open time: 2023-08-02T00:00:00.000 == close pos time: 2023-08-09T00:00:00.000
2024-11-20 23:06:58,503 - INFO - pnl: 2023-08-01T23:59:59.999 124530.37684860351 === 1.235%
2024-11-20 23:06:58,507 - DEBUG - cur time: 2023-08-02T23:59:59.999 == next bar open time: 2023-08-03T00:00:00.000 == close pos time: 2023-08-10T00:00:00.000
2024-11-20 23:06:58,509 - INFO - pnl: 2023-08-02T23:59:59.999 124888.93448253129 === 0.288%
2024-11-20 23:06:58,511 - DEBUG - cur time: 2023-08-03T23:59:59.999 == next bar open time: 2023-08-04T00:00:00.000 == close pos time: 2023-08-11T00:00:00.000
2024-11-20 23:06:58,514 - INFO - pnl: 2023-08-03T23:59:59.999 124958.09867852443 === 0.055%
2024-11-20 23:06:58,517 - DEBUG - cur time: 2023-08-04T23:59:59.999 == next bar open time: 2023-08-05T00:00:00.000 == close pos time: 2023-08-12T00:00:00.000
2024-11-20 23:06:58,519 - INFO - pnl: 2023-08-04T23:59:59.999 125084.32797945764 === 0.101%
2024-11-20 23:06:58,523 - DEBUG - cur time: 2023-08-05T23:59:59.999 == next bar open time: 2023-08-06T00:00:00.000 == close pos time: 2023-08-13T00:00:00.000
2024-11-20 23:06:58,524 - INFO - pnl: 2023-08-05T23:59:59.999 125567.2652777027 === 0.386%
2024-11-20 23:06:58,527 - DEBUG - cur time: 2023-08-06T23:59:59.999 == next bar open time: 2023-08-07T00:00:00.000 == close pos time: 2023-08-14T00:00:00.000
2024-11-20 23:06:58,538 - DEBUG - sorted_long_factors: shape: (166, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SSVUSDT      ┆ -1.776904    ┆ 0    ┆ 165          │
│ UNIUSDT      ┆ -1.745556    ┆ 1    ┆ 164          │
│ BNBUSDT      ┆ -1.724183    ┆ 2    ┆ 163          │
│ MAGICUSDT    ┆ -1.604988    ┆ 3    ┆ 162          │
│ ZENUSDT      ┆ -1.577331    ┆ 4    ┆ 161          │
│ WAVESUSDT    ┆ -1.570634    ┆ 5    ┆ 160          │
│ USDCUSDT     ┆ -1.545755    ┆ 6    ┆ 159          │
│ CELOUSDT     ┆ -1.515049    ┆ 7    ┆ 158          │
│ IMXUSDT      ┆ -1.496756    ┆ 8    ┆ 157          │
│ NEOUSDT      ┆ -1.447831    ┆ 9    ┆ 156          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COMPUSDT     ┆ -0.180953    ┆ 156  ┆ 9            │
│ TRUUSDT      ┆ -0.142569    ┆ 157  ┆ 8            │
│ ATAUSDT      ┆ -0.137458    ┆ 158  ┆ 7            │
│ KSMUSDT      ┆ 0.036421     ┆ 159  ┆ 6            │
│ DEFIUSDT     ┆ 0.255068     ┆ 160  ┆ 5            │
│ CTKUSDT      ┆ 0.444434     ┆ 161  ┆ 4            │
│ LEVERUSDT    ┆ 0.459703     ┆ 162  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.514444     ┆ 163  ┆ 2            │
│ IOTXUSDT     ┆ 0.546498     ┆ 164  ┆ 1            │
│ BLZUSDT      ┆ 0.875338     ┆ 165  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:58,544 - INFO - cur close time: 2023-08-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:06:58,544 - DEBUG - mean expected ret (mean factor): -0.8054883294669173
2024-11-20 23:06:58,549 - DEBUG - begin to update pos: =========
2024-11-20 23:06:58,549 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,550 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.07887     ┆ null        ┆ … ┆ 0.02017 ┆ null   ┆ null    ┆ 0.2191  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,557 - DEBUG - update position: 2023-08-06T23:59:59.999 === diff_trading_value: 224855.48624296323 == cash: 128018.73199187029 
2024-11-20 23:06:58,559 - INFO - pnl: 2023-08-06T23:59:59.999 128018.73199187029 === 1.952%
2024-11-20 23:06:58,563 - DEBUG - cur time: 2023-08-07T23:59:59.999 == next bar open time: 2023-08-08T00:00:00.000 == close pos time: 2023-08-15T00:00:00.000
2024-11-20 23:06:58,564 - INFO - pnl: 2023-08-07T23:59:59.999 129663.44954005303 === 1.285%
2024-11-20 23:06:58,568 - DEBUG - cur time: 2023-08-08T23:59:59.999 == next bar open time: 2023-08-09T00:00:00.000 == close pos time: 2023-08-16T00:00:00.000
2024-11-20 23:06:58,570 - INFO - pnl: 2023-08-08T23:59:59.999 129911.54301726648 === 0.191%
2024-11-20 23:06:58,574 - DEBUG - cur time: 2023-08-09T23:59:59.999 == next bar open time: 2023-08-10T00:00:00.000 == close pos time: 2023-08-17T00:00:00.000
2024-11-20 23:06:58,577 - INFO - pnl: 2023-08-09T23:59:59.999 129367.61273148595 === -0.419%
2024-11-20 23:06:58,583 - DEBUG - cur time: 2023-08-10T23:59:59.999 == next bar open time: 2023-08-11T00:00:00.000 == close pos time: 2023-08-18T00:00:00.000
2024-11-20 23:06:58,586 - INFO - pnl: 2023-08-10T23:59:59.999 129279.62658386136 === -0.068%
2024-11-20 23:06:58,592 - DEBUG - cur time: 2023-08-11T23:59:59.999 == next bar open time: 2023-08-12T00:00:00.000 == close pos time: 2023-08-19T00:00:00.000
2024-11-20 23:06:58,595 - INFO - pnl: 2023-08-11T23:59:59.999 129684.52243059137 === 0.313%
2024-11-20 23:06:58,598 - DEBUG - cur time: 2023-08-12T23:59:59.999 == next bar open time: 2023-08-13T00:00:00.000 == close pos time: 2023-08-20T00:00:00.000
2024-11-20 23:06:58,600 - INFO - pnl: 2023-08-12T23:59:59.999 131474.44432322343 === 1.380%
2024-11-20 23:06:58,604 - DEBUG - cur time: 2023-08-13T23:59:59.999 == next bar open time: 2023-08-14T00:00:00.000 == close pos time: 2023-08-21T00:00:00.000
2024-11-20 23:06:58,613 - DEBUG - sorted_long_factors: shape: (170, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HIGHUSDT     ┆ -1.941933    ┆ 0    ┆ 169          │
│ MKRUSDT      ┆ -1.841655    ┆ 1    ┆ 168          │
│ QNTUSDT      ┆ -1.700053    ┆ 2    ┆ 167          │
│ CFXUSDT      ┆ -1.60911     ┆ 3    ┆ 166          │
│ OPUSDT       ┆ -1.568087    ┆ 4    ┆ 165          │
│ BNBUSDT      ┆ -1.568043    ┆ 5    ┆ 164          │
│ STXUSDT      ┆ -1.530497    ┆ 6    ┆ 163          │
│ BLURUSDT     ┆ -1.480701    ┆ 7    ┆ 162          │
│ KNCUSDT      ┆ -1.441861    ┆ 8    ┆ 161          │
│ ASTRUSDT     ┆ -1.423308    ┆ 9    ┆ 160          │
│ …            ┆ …            ┆ …    ┆ …            │
│ NKNUSDT      ┆ -0.123196    ┆ 160  ┆ 9            │
│ CHRUSDT      ┆ -0.065072    ┆ 161  ┆ 8            │
│ CTKUSDT      ┆ -0.050976    ┆ 162  ┆ 7            │
│ ENSUSDT      ┆ -0.038593    ┆ 163  ┆ 6            │
│ ICXUSDT      ┆ 0.016964     ┆ 164  ┆ 5            │
│ AMBUSDT      ┆ 0.096401     ┆ 165  ┆ 4            │
│ SKLUSDT      ┆ 0.250541     ┆ 166  ┆ 3            │
│ ARUSDT       ┆ 0.27421      ┆ 167  ┆ 2            │
│ IOTXUSDT     ┆ 0.282835     ┆ 168  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.579431     ┆ 169  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:58,621 - INFO - cur close time: 2023-08-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:06:58,621 - DEBUG - mean expected ret (mean factor): -0.8326781596584624
2024-11-20 23:06:58,628 - DEBUG - begin to update pos: =========
2024-11-20 23:06:58,628 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,629 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.07765     ┆ 0.0013648   ┆ … ┆ 0.01998 ┆ null   ┆ null    ┆ 0.2193  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,642 - DEBUG - update position: 2023-08-13T23:59:59.999 === diff_trading_value: 308133.6977828009 == cash: 137650.54625527558 
2024-11-20 23:06:58,645 - INFO - pnl: 2023-08-13T23:59:59.999 137650.54625527558 === 4.698%
2024-11-20 23:06:58,653 - DEBUG - cur time: 2023-08-14T23:59:59.999 == next bar open time: 2023-08-15T00:00:00.000 == close pos time: 2023-08-22T00:00:00.000
2024-11-20 23:06:58,655 - INFO - pnl: 2023-08-14T23:59:59.999 137882.54719277934 === 0.169%
2024-11-20 23:06:58,664 - DEBUG - cur time: 2023-08-15T23:59:59.999 == next bar open time: 2023-08-16T00:00:00.000 == close pos time: 2023-08-23T00:00:00.000
2024-11-20 23:06:58,666 - INFO - pnl: 2023-08-15T23:59:59.999 136627.61226727837 === -0.910%
2024-11-20 23:06:58,674 - DEBUG - cur time: 2023-08-16T23:59:59.999 == next bar open time: 2023-08-17T00:00:00.000 == close pos time: 2023-08-24T00:00:00.000
2024-11-20 23:06:58,678 - INFO - pnl: 2023-08-16T23:59:59.999 136721.78946368492 === 0.069%
2024-11-20 23:06:58,689 - DEBUG - cur time: 2023-08-17T23:59:59.999 == next bar open time: 2023-08-18T00:00:00.000 == close pos time: 2023-08-25T00:00:00.000
2024-11-20 23:06:58,692 - INFO - pnl: 2023-08-17T23:59:59.999 136203.0297586052 === -0.379%
2024-11-20 23:06:58,699 - DEBUG - cur time: 2023-08-18T23:59:59.999 == next bar open time: 2023-08-19T00:00:00.000 == close pos time: 2023-08-26T00:00:00.000
2024-11-20 23:06:58,705 - INFO - pnl: 2023-08-18T23:59:59.999 134542.38021373824 === -1.219%
2024-11-20 23:06:58,717 - DEBUG - cur time: 2023-08-19T23:59:59.999 == next bar open time: 2023-08-20T00:00:00.000 == close pos time: 2023-08-27T00:00:00.000
2024-11-20 23:06:58,721 - INFO - pnl: 2023-08-19T23:59:59.999 134699.1266674523 === 0.117%
2024-11-20 23:06:58,733 - DEBUG - cur time: 2023-08-20T23:59:59.999 == next bar open time: 2023-08-21T00:00:00.000 == close pos time: 2023-08-28T00:00:00.000
2024-11-20 23:06:58,747 - DEBUG - sorted_long_factors: shape: (174, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RUNEUSDT     ┆ -1.69083     ┆ 0    ┆ 173          │
│ LEVERUSDT    ┆ -1.684586    ┆ 1    ┆ 172          │
│ RNDRUSDT     ┆ -1.676429    ┆ 2    ┆ 171          │
│ ARBUSDT      ┆ -1.652084    ┆ 3    ┆ 170          │
│ UNFIUSDT     ┆ -1.646386    ┆ 4    ┆ 169          │
│ HIGHUSDT     ┆ -1.632519    ┆ 5    ┆ 168          │
│ MKRUSDT      ┆ -1.614282    ┆ 6    ┆ 167          │
│ BTCDOMUSDT   ┆ -1.562852    ┆ 7    ┆ 166          │
│ KNCUSDT      ┆ -1.53881     ┆ 8    ┆ 165          │
│ USDCUSDT     ┆ -1.496989    ┆ 9    ┆ 164          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ARUSDT       ┆ -0.162028    ┆ 164  ┆ 9            │
│ SKLUSDT      ┆ -0.142058    ┆ 165  ┆ 8            │
│ IOTXUSDT     ┆ -0.093862    ┆ 166  ┆ 7            │
│ SPELLUSDT    ┆ 0.057076     ┆ 167  ┆ 6            │
│ FOOTBALLUSDT ┆ 0.057714     ┆ 168  ┆ 5            │
│ CTKUSDT      ┆ 0.081371     ┆ 169  ┆ 4            │
│ IDEXUSDT     ┆ 0.212838     ┆ 170  ┆ 3            │
│ XVSUSDT      ┆ 0.277366     ┆ 171  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.404423     ┆ 172  ┆ 1            │
│ DEFIUSDT     ┆ 0.825169     ┆ 173  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:58,756 - WARNING - 2023-08-20T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:58,756 - INFO - cur close time: 2023-08-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:58,756 - DEBUG - mean expected ret (mean factor): -0.8246575542743064
2024-11-20 23:06:58,761 - DEBUG - begin to update pos: =========
2024-11-20 23:06:58,761 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,762 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01889     ┆ 0.06765     ┆ 0.0011173   ┆ … ┆ 0.01702 ┆ null   ┆ null    ┆ 0.1788  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,771 - DEBUG - update position: 2023-08-20T23:59:59.999 === diff_trading_value: 237836.91818549845 == cash: 134298.02342831387 
2024-11-20 23:06:58,773 - INFO - pnl: 2023-08-20T23:59:59.999 134298.02342831387 === -0.298%
2024-11-20 23:06:58,781 - DEBUG - cur time: 2023-08-21T23:59:59.999 == next bar open time: 2023-08-22T00:00:00.000 == close pos time: 2023-08-29T00:00:00.000
2024-11-20 23:06:58,785 - INFO - pnl: 2023-08-21T23:59:59.999 132280.7320380582 === -1.502%
2024-11-20 23:06:58,789 - DEBUG - cur time: 2023-08-22T23:59:59.999 == next bar open time: 2023-08-23T00:00:00.000 == close pos time: 2023-08-30T00:00:00.000
2024-11-20 23:06:58,791 - INFO - pnl: 2023-08-22T23:59:59.999 131199.99071996444 === -0.817%
2024-11-20 23:06:58,797 - DEBUG - cur time: 2023-08-23T23:59:59.999 == next bar open time: 2023-08-24T00:00:00.000 == close pos time: 2023-08-31T00:00:00.000
2024-11-20 23:06:58,798 - INFO - pnl: 2023-08-23T23:59:59.999 131287.37850494386 === 0.067%
2024-11-20 23:06:58,803 - DEBUG - cur time: 2023-08-24T23:59:59.999 == next bar open time: 2023-08-25T00:00:00.000 == close pos time: 2023-09-01T00:00:00.000
2024-11-20 23:06:58,804 - INFO - pnl: 2023-08-24T23:59:59.999 130164.77389607255 === -0.855%
2024-11-20 23:06:58,810 - DEBUG - cur time: 2023-08-25T23:59:59.999 == next bar open time: 2023-08-26T00:00:00.000 == close pos time: 2023-09-02T00:00:00.000
2024-11-20 23:06:58,812 - INFO - pnl: 2023-08-25T23:59:59.999 132734.26202919683 === 1.974%
2024-11-20 23:06:58,815 - DEBUG - cur time: 2023-08-26T23:59:59.999 == next bar open time: 2023-08-27T00:00:00.000 == close pos time: 2023-09-03T00:00:00.000
2024-11-20 23:06:58,817 - INFO - pnl: 2023-08-26T23:59:59.999 132215.99416651245 === -0.390%
2024-11-20 23:06:58,821 - DEBUG - cur time: 2023-08-27T23:59:59.999 == next bar open time: 2023-08-28T00:00:00.000 == close pos time: 2023-09-04T00:00:00.000
2024-11-20 23:06:58,831 - DEBUG - sorted_long_factors: shape: (174, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ GTCUSDT   ┆ -1.771934    ┆ 0    ┆ 173          │
│ COMPUSDT  ┆ -1.680041    ┆ 1    ┆ 172          │
│ USDCUSDT  ┆ -1.654872    ┆ 2    ┆ 171          │
│ LPTUSDT   ┆ -1.602622    ┆ 3    ┆ 170          │
│ LEVERUSDT ┆ -1.58274     ┆ 4    ┆ 169          │
│ RUNEUSDT  ┆ -1.581114    ┆ 5    ┆ 168          │
│ CFXUSDT   ┆ -1.559972    ┆ 6    ┆ 167          │
│ AGIXUSDT  ┆ -1.557507    ┆ 7    ┆ 166          │
│ SSVUSDT   ┆ -1.552975    ┆ 8    ┆ 165          │
│ APEUSDT   ┆ -1.527076    ┆ 9    ┆ 164          │
│ …         ┆ …            ┆ …    ┆ …            │
│ PERPUSDT  ┆ 0.005085     ┆ 164  ┆ 9            │
│ SPELLUSDT ┆ 0.041575     ┆ 165  ┆ 8            │
│ BALUSDT   ┆ 0.051743     ┆ 166  ┆ 7            │
│ DGBUSDT   ┆ 0.07694      ┆ 167  ┆ 6            │
│ XVSUSDT   ┆ 0.091584     ┆ 168  ┆ 5            │
│ DEFIUSDT  ┆ 0.126941     ┆ 169  ┆ 4            │
│ TUSDT     ┆ 0.209552     ┆ 170  ┆ 3            │
│ IDEXUSDT  ┆ 0.222844     ┆ 171  ┆ 2            │
│ CKBUSDT   ┆ 0.486166     ┆ 172  ┆ 1            │
│ CTKUSDT   ┆ 0.804611     ┆ 173  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:58,839 - WARNING - 2023-08-27T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:58,839 - INFO - cur close time: 2023-08-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:58,840 - DEBUG - mean expected ret (mean factor): -0.8114244860099837
2024-11-20 23:06:58,845 - DEBUG - begin to update pos: =========
2024-11-20 23:06:58,845 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,845 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01763     ┆ 0.06232     ┆ 0.0008956   ┆ … ┆ 0.0167  ┆ null   ┆ null    ┆ 0.172   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,852 - DEBUG - update position: 2023-08-27T23:59:59.999 === diff_trading_value: 252656.88958536892 == cash: 132088.60491050733 
2024-11-20 23:06:58,854 - INFO - pnl: 2023-08-27T23:59:59.999 132088.60491050733 === -0.096%
2024-11-20 23:06:58,860 - DEBUG - cur time: 2023-08-28T23:59:59.999 == next bar open time: 2023-08-29T00:00:00.000 == close pos time: 2023-09-05T00:00:00.000
2024-11-20 23:06:58,862 - INFO - pnl: 2023-08-28T23:59:59.999 133922.75829556453 === 1.389%
2024-11-20 23:06:58,867 - DEBUG - cur time: 2023-08-29T23:59:59.999 == next bar open time: 2023-08-30T00:00:00.000 == close pos time: 2023-09-06T00:00:00.000
2024-11-20 23:06:58,869 - INFO - pnl: 2023-08-29T23:59:59.999 134294.43186356276 === 0.278%
2024-11-20 23:06:58,874 - DEBUG - cur time: 2023-08-30T23:59:59.999 == next bar open time: 2023-08-31T00:00:00.000 == close pos time: 2023-09-07T00:00:00.000
2024-11-20 23:06:58,876 - INFO - pnl: 2023-08-30T23:59:59.999 133112.4263733394 === -0.880%
2024-11-20 23:06:58,881 - DEBUG - cur time: 2023-08-31T23:59:59.999 == next bar open time: 2023-09-01T00:00:00.000 == close pos time: 2023-09-08T00:00:00.000
2024-11-20 23:06:58,883 - INFO - pnl: 2023-08-31T23:59:59.999 133677.02450487672 === 0.424%
2024-11-20 23:06:58,888 - DEBUG - cur time: 2023-09-01T23:59:59.999 == next bar open time: 2023-09-02T00:00:00.000 == close pos time: 2023-09-09T00:00:00.000
2024-11-20 23:06:58,890 - INFO - pnl: 2023-09-01T23:59:59.999 133063.49464369658 === -0.459%
2024-11-20 23:06:58,896 - DEBUG - cur time: 2023-09-02T23:59:59.999 == next bar open time: 2023-09-03T00:00:00.000 == close pos time: 2023-09-10T00:00:00.000
2024-11-20 23:06:58,897 - INFO - pnl: 2023-09-02T23:59:59.999 135111.14262763775 === 1.539%
2024-11-20 23:06:58,902 - DEBUG - cur time: 2023-09-03T23:59:59.999 == next bar open time: 2023-09-04T00:00:00.000 == close pos time: 2023-09-11T00:00:00.000
2024-11-20 23:06:58,913 - DEBUG - sorted_long_factors: shape: (175, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RADUSDT      ┆ -1.732566    ┆ 0    ┆ 174          │
│ EGLDUSDT     ┆ -1.696671    ┆ 1    ┆ 173          │
│ DYDXUSDT     ┆ -1.690819    ┆ 2    ┆ 172          │
│ ZECUSDT      ┆ -1.670513    ┆ 3    ┆ 171          │
│ EOSUSDT      ┆ -1.665009    ┆ 4    ┆ 170          │
│ USDCUSDT     ┆ -1.656138    ┆ 5    ┆ 169          │
│ XMRUSDT      ┆ -1.639306    ┆ 6    ┆ 168          │
│ ARBUSDT      ┆ -1.62318     ┆ 7    ┆ 167          │
│ BNBUSDT      ┆ -1.597444    ┆ 8    ┆ 166          │
│ DOTUSDT      ┆ -1.59473     ┆ 9    ┆ 165          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BALUSDT      ┆ 0.143154     ┆ 165  ┆ 9            │
│ DGBUSDT      ┆ 0.148214     ┆ 166  ┆ 8            │
│ CTKUSDT      ┆ 0.155351     ┆ 167  ┆ 7            │
│ BNXUSDT      ┆ 0.162089     ┆ 168  ┆ 6            │
│ ICXUSDT      ┆ 0.276342     ┆ 169  ┆ 5            │
│ IOTXUSDT     ┆ 0.29358      ┆ 170  ┆ 4            │
│ SPELLUSDT    ┆ 0.378046     ┆ 171  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.453964     ┆ 172  ┆ 2            │
│ TUSDT        ┆ 0.470388     ┆ 173  ┆ 1            │
│ CKBUSDT      ┆ 0.643302     ┆ 174  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:58,921 - INFO - cur close time: 2023-09-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:06:58,922 - DEBUG - mean expected ret (mean factor): -0.7899840898001981
2024-11-20 23:06:58,926 - DEBUG - begin to update pos: =========
2024-11-20 23:06:58,927 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,927 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01686     ┆ 0.05977     ┆ 0.0008023   ┆ … ┆ 0.01609 ┆ null   ┆ null    ┆ 0.1643  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:58,934 - DEBUG - update position: 2023-09-03T23:59:59.999 === diff_trading_value: 281081.66141048505 == cash: 135643.7920236155 
2024-11-20 23:06:58,935 - INFO - pnl: 2023-09-03T23:59:59.999 135643.7920236155 === 0.394%
2024-11-20 23:06:58,939 - DEBUG - cur time: 2023-09-04T23:59:59.999 == next bar open time: 2023-09-05T00:00:00.000 == close pos time: 2023-09-12T00:00:00.000
2024-11-20 23:06:58,941 - INFO - pnl: 2023-09-04T23:59:59.999 135739.3452570901 === 0.070%
2024-11-20 23:06:58,944 - DEBUG - cur time: 2023-09-05T23:59:59.999 == next bar open time: 2023-09-06T00:00:00.000 == close pos time: 2023-09-13T00:00:00.000
2024-11-20 23:06:58,946 - INFO - pnl: 2023-09-05T23:59:59.999 138593.08094271683 === 2.102%
2024-11-20 23:06:58,949 - DEBUG - cur time: 2023-09-06T23:59:59.999 == next bar open time: 2023-09-07T00:00:00.000 == close pos time: 2023-09-14T00:00:00.000
2024-11-20 23:06:58,952 - INFO - pnl: 2023-09-06T23:59:59.999 139354.81383937362 === 0.550%
2024-11-20 23:06:58,957 - DEBUG - cur time: 2023-09-07T23:59:59.999 == next bar open time: 2023-09-08T00:00:00.000 == close pos time: 2023-09-15T00:00:00.000
2024-11-20 23:06:58,960 - INFO - pnl: 2023-09-07T23:59:59.999 140734.52052207344 === 0.990%
2024-11-20 23:06:58,970 - DEBUG - cur time: 2023-09-08T23:59:59.999 == next bar open time: 2023-09-09T00:00:00.000 == close pos time: 2023-09-16T00:00:00.000
2024-11-20 23:06:58,973 - INFO - pnl: 2023-09-08T23:59:59.999 141348.11593642467 === 0.436%
2024-11-20 23:06:58,980 - DEBUG - cur time: 2023-09-09T23:59:59.999 == next bar open time: 2023-09-10T00:00:00.000 == close pos time: 2023-09-17T00:00:00.000
2024-11-20 23:06:58,984 - INFO - pnl: 2023-09-09T23:59:59.999 143453.73918104975 === 1.490%
2024-11-20 23:06:58,990 - DEBUG - cur time: 2023-09-10T23:59:59.999 == next bar open time: 2023-09-11T00:00:00.000 == close pos time: 2023-09-18T00:00:00.000
2024-11-20 23:06:59,000 - DEBUG - sorted_long_factors: shape: (175, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SUIUSDT      ┆ -1.631495    ┆ 0    ┆ 174          │
│ EDUUSDT      ┆ -1.581703    ┆ 1    ┆ 173          │
│ USDCUSDT     ┆ -1.571022    ┆ 2    ┆ 172          │
│ RADUSDT      ┆ -1.539574    ┆ 3    ┆ 171          │
│ 1000PEPEUSDT ┆ -1.527239    ┆ 4    ┆ 170          │
│ DYDXUSDT     ┆ -1.523083    ┆ 5    ┆ 169          │
│ BNBUSDT      ┆ -1.505336    ┆ 6    ┆ 168          │
│ PERPUSDT     ┆ -1.479298    ┆ 7    ┆ 167          │
│ ARBUSDT      ┆ -1.476332    ┆ 8    ┆ 166          │
│ MTLUSDT      ┆ -1.462492    ┆ 9    ┆ 165          │
│ …            ┆ …            ┆ …    ┆ …            │
│ QNTUSDT      ┆ -0.048873    ┆ 165  ┆ 9            │
│ GMXUSDT      ┆ 0.060827     ┆ 166  ┆ 8            │
│ ICXUSDT      ┆ 0.140195     ┆ 167  ┆ 7            │
│ SPELLUSDT    ┆ 0.226175     ┆ 168  ┆ 6            │
│ CVXUSDT      ┆ 0.2351       ┆ 169  ┆ 5            │
│ RVNUSDT      ┆ 0.241476     ┆ 170  ┆ 4            │
│ DGBUSDT      ┆ 0.370182     ┆ 171  ┆ 3            │
│ CKBUSDT      ┆ 0.382067     ┆ 172  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.666085     ┆ 173  ┆ 1            │
│ DEFIUSDT     ┆ 1.067734     ┆ 174  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:59,010 - INFO - cur close time: 2023-09-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:06:59,010 - DEBUG - mean expected ret (mean factor): -0.7894080177806615
2024-11-20 23:06:59,016 - DEBUG - begin to update pos: =========
2024-11-20 23:06:59,016 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,017 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01674     ┆ 0.05935     ┆ 0.0007069   ┆ … ┆ 0.01576 ┆ null   ┆ null    ┆ 0.1672  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,024 - DEBUG - update position: 2023-09-10T23:59:59.999 === diff_trading_value: 216497.70898521994 == cash: 142799.72632434827 
2024-11-20 23:06:59,026 - INFO - pnl: 2023-09-10T23:59:59.999 142799.72632434827 === -0.456%
2024-11-20 23:06:59,031 - DEBUG - cur time: 2023-09-11T23:59:59.999 == next bar open time: 2023-09-12T00:00:00.000 == close pos time: 2023-09-19T00:00:00.000
2024-11-20 23:06:59,033 - INFO - pnl: 2023-09-11T23:59:59.999 143576.50583582305 === 0.544%
2024-11-20 23:06:59,037 - DEBUG - cur time: 2023-09-12T23:59:59.999 == next bar open time: 2023-09-13T00:00:00.000 == close pos time: 2023-09-20T00:00:00.000
2024-11-20 23:06:59,039 - INFO - pnl: 2023-09-12T23:59:59.999 144221.4785452478 === 0.449%
2024-11-20 23:06:59,045 - DEBUG - cur time: 2023-09-13T23:59:59.999 == next bar open time: 2023-09-14T00:00:00.000 == close pos time: 2023-09-21T00:00:00.000
2024-11-20 23:06:59,048 - INFO - pnl: 2023-09-13T23:59:59.999 143938.0604138305 === -0.197%
2024-11-20 23:06:59,052 - DEBUG - cur time: 2023-09-14T23:59:59.999 == next bar open time: 2023-09-15T00:00:00.000 == close pos time: 2023-09-22T00:00:00.000
2024-11-20 23:06:59,054 - INFO - pnl: 2023-09-14T23:59:59.999 144943.74226145833 === 0.699%
2024-11-20 23:06:59,060 - DEBUG - cur time: 2023-09-15T23:59:59.999 == next bar open time: 2023-09-16T00:00:00.000 == close pos time: 2023-09-23T00:00:00.000
2024-11-20 23:06:59,062 - INFO - pnl: 2023-09-15T23:59:59.999 146549.18393003262 === 1.108%
2024-11-20 23:06:59,066 - DEBUG - cur time: 2023-09-16T23:59:59.999 == next bar open time: 2023-09-17T00:00:00.000 == close pos time: 2023-09-24T00:00:00.000
2024-11-20 23:06:59,069 - INFO - pnl: 2023-09-16T23:59:59.999 147297.10705738125 === 0.510%
2024-11-20 23:06:59,074 - DEBUG - cur time: 2023-09-17T23:59:59.999 == next bar open time: 2023-09-18T00:00:00.000 == close pos time: 2023-09-25T00:00:00.000
2024-11-20 23:06:59,085 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ FOOTBALLUSDT ┆ -1.846967    ┆ 0    ┆ 175          │
│ 1000PEPEUSDT ┆ -1.749667    ┆ 1    ┆ 174          │
│ AAVEUSDT     ┆ -1.729467    ┆ 2    ┆ 173          │
│ EDUUSDT      ┆ -1.706851    ┆ 3    ┆ 172          │
│ RADUSDT      ┆ -1.675787    ┆ 4    ┆ 171          │
│ PERPUSDT     ┆ -1.669446    ┆ 5    ┆ 170          │
│ UMAUSDT      ┆ -1.627443    ┆ 6    ┆ 169          │
│ IDUSDT       ┆ -1.606962    ┆ 7    ┆ 168          │
│ LEVERUSDT    ┆ -1.600281    ┆ 8    ┆ 167          │
│ WAVESUSDT    ┆ -1.541942    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DASHUSDT     ┆ -0.099088    ┆ 166  ┆ 9            │
│ CVXUSDT      ┆ -0.046842    ┆ 167  ┆ 8            │
│ DGBUSDT      ┆ -0.017784    ┆ 168  ┆ 7            │
│ KSMUSDT      ┆ -0.007762    ┆ 169  ┆ 6            │
│ ICXUSDT      ┆ 0.001428     ┆ 170  ┆ 5            │
│ YFIUSDT      ┆ 0.060177     ┆ 171  ┆ 4            │
│ TUSDT        ┆ 0.070424     ┆ 172  ┆ 3            │
│ ZENUSDT      ┆ 0.324803     ┆ 173  ┆ 2            │
│ DEFIUSDT     ┆ 1.339807     ┆ 174  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.506488     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:59,094 - INFO - cur close time: 2023-09-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:06:59,095 - DEBUG - mean expected ret (mean factor): -0.7993171812661625
2024-11-20 23:06:59,100 - DEBUG - begin to update pos: =========
2024-11-20 23:06:59,101 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,102 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01555     ┆ 0.05734     ┆ 0.0006271   ┆ … ┆ 0.01585 ┆ null   ┆ null    ┆ 0.179   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,116 - DEBUG - update position: 2023-09-17T23:59:59.999 === diff_trading_value: 232614.0912454093 == cash: 146924.93547403856 
2024-11-20 23:06:59,117 - INFO - pnl: 2023-09-17T23:59:59.999 146924.93547403856 === -0.253%
2024-11-20 23:06:59,122 - DEBUG - cur time: 2023-09-18T23:59:59.999 == next bar open time: 2023-09-19T00:00:00.000 == close pos time: 2023-09-26T00:00:00.000
2024-11-20 23:06:59,123 - INFO - pnl: 2023-09-18T23:59:59.999 146902.15448498458 === -0.016%
2024-11-20 23:06:59,128 - DEBUG - cur time: 2023-09-19T23:59:59.999 == next bar open time: 2023-09-20T00:00:00.000 == close pos time: 2023-09-27T00:00:00.000
2024-11-20 23:06:59,130 - INFO - pnl: 2023-09-19T23:59:59.999 145885.96152869458 === -0.692%
2024-11-20 23:06:59,135 - DEBUG - cur time: 2023-09-20T23:59:59.999 == next bar open time: 2023-09-21T00:00:00.000 == close pos time: 2023-09-28T00:00:00.000
2024-11-20 23:06:59,136 - INFO - pnl: 2023-09-20T23:59:59.999 145576.56687568675 === -0.212%
2024-11-20 23:06:59,140 - DEBUG - cur time: 2023-09-21T23:59:59.999 == next bar open time: 2023-09-22T00:00:00.000 == close pos time: 2023-09-29T00:00:00.000
2024-11-20 23:06:59,142 - INFO - pnl: 2023-09-21T23:59:59.999 145064.1316719425 === -0.352%
2024-11-20 23:06:59,149 - DEBUG - cur time: 2023-09-22T23:59:59.999 == next bar open time: 2023-09-23T00:00:00.000 == close pos time: 2023-09-30T00:00:00.000
2024-11-20 23:06:59,151 - INFO - pnl: 2023-09-22T23:59:59.999 143220.97428226026 === -1.271%
2024-11-20 23:06:59,155 - DEBUG - cur time: 2023-09-23T23:59:59.999 == next bar open time: 2023-09-24T00:00:00.000 == close pos time: 2023-10-01T00:00:00.000
2024-11-20 23:06:59,159 - INFO - pnl: 2023-09-23T23:59:59.999 144095.38084155467 === 0.611%
2024-11-20 23:06:59,165 - DEBUG - cur time: 2023-09-24T23:59:59.999 == next bar open time: 2023-09-25T00:00:00.000 == close pos time: 2023-10-02T00:00:00.000
2024-11-20 23:06:59,176 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XVSUSDT      ┆ -1.773142    ┆ 0    ┆ 175          │
│ TRBUSDT      ┆ -1.760021    ┆ 1    ┆ 174          │
│ IDUSDT       ┆ -1.725317    ┆ 2    ┆ 173          │
│ SUIUSDT      ┆ -1.676063    ┆ 3    ┆ 172          │
│ RADUSDT      ┆ -1.562034    ┆ 4    ┆ 171          │
│ LUNA2USDT    ┆ -1.547412    ┆ 5    ┆ 170          │
│ RDNTUSDT     ┆ -1.542125    ┆ 6    ┆ 169          │
│ WAVESUSDT    ┆ -1.52681     ┆ 7    ┆ 168          │
│ MTLUSDT      ┆ -1.518785    ┆ 8    ┆ 167          │
│ DOTUSDT      ┆ -1.456728    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ MAGICUSDT    ┆ -0.06378     ┆ 166  ┆ 9            │
│ ENSUSDT      ┆ -0.060516    ┆ 167  ┆ 8            │
│ SKLUSDT      ┆ -0.000523    ┆ 168  ┆ 7            │
│ CKBUSDT      ┆ 0.016784     ┆ 169  ┆ 6            │
│ FXSUSDT      ┆ 0.027922     ┆ 170  ┆ 5            │
│ ZECUSDT      ┆ 0.069557     ┆ 171  ┆ 4            │
│ KSMUSDT      ┆ 0.26856      ┆ 172  ┆ 3            │
│ DGBUSDT      ┆ 0.424681     ┆ 173  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.622425     ┆ 174  ┆ 1            │
│ DEFIUSDT     ┆ 1.843834     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:59,185 - WARNING - 2023-09-24T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:59,186 - INFO - cur close time: 2023-09-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:59,186 - DEBUG - mean expected ret (mean factor): -0.7931216050760749
2024-11-20 23:06:59,191 - DEBUG - begin to update pos: =========
2024-11-20 23:06:59,191 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,191 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01548     ┆ 0.06104     ┆ 0.0006759   ┆ … ┆ 0.01697 ┆ null   ┆ null    ┆ 0.1838  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,199 - DEBUG - update position: 2023-09-24T23:59:59.999 === diff_trading_value: 218158.65319008354 == cash: 143329.1260915853 
2024-11-20 23:06:59,200 - INFO - pnl: 2023-09-24T23:59:59.999 143329.1260915853 === -0.532%
2024-11-20 23:06:59,205 - DEBUG - cur time: 2023-09-25T23:59:59.999 == next bar open time: 2023-09-26T00:00:00.000 == close pos time: 2023-10-03T00:00:00.000
2024-11-20 23:06:59,206 - INFO - pnl: 2023-09-25T23:59:59.999 144511.0839159325 === 0.825%
2024-11-20 23:06:59,210 - DEBUG - cur time: 2023-09-26T23:59:59.999 == next bar open time: 2023-09-27T00:00:00.000 == close pos time: 2023-10-04T00:00:00.000
2024-11-20 23:06:59,211 - INFO - pnl: 2023-09-26T23:59:59.999 141406.20404008805 === -2.149%
2024-11-20 23:06:59,215 - DEBUG - cur time: 2023-09-27T23:59:59.999 == next bar open time: 2023-09-28T00:00:00.000 == close pos time: 2023-10-05T00:00:00.000
2024-11-20 23:06:59,218 - INFO - pnl: 2023-09-27T23:59:59.999 135049.32937702577 === -4.495%
2024-11-20 23:06:59,224 - DEBUG - cur time: 2023-09-28T23:59:59.999 == next bar open time: 2023-09-29T00:00:00.000 == close pos time: 2023-10-06T00:00:00.000
2024-11-20 23:06:59,226 - INFO - pnl: 2023-09-28T23:59:59.999 138512.2327497942 === 2.564%
2024-11-20 23:06:59,230 - DEBUG - cur time: 2023-09-29T23:59:59.999 == next bar open time: 2023-09-30T00:00:00.000 == close pos time: 2023-10-07T00:00:00.000
2024-11-20 23:06:59,232 - INFO - pnl: 2023-09-29T23:59:59.999 138498.94883365036 === -0.010%
2024-11-20 23:06:59,237 - DEBUG - cur time: 2023-09-30T23:59:59.999 == next bar open time: 2023-10-01T00:00:00.000 == close pos time: 2023-10-08T00:00:00.000
2024-11-20 23:06:59,238 - INFO - pnl: 2023-09-30T23:59:59.999 139840.51680634957 === 0.969%
2024-11-20 23:06:59,244 - DEBUG - cur time: 2023-10-01T23:59:59.999 == next bar open time: 2023-10-02T00:00:00.000 == close pos time: 2023-10-09T00:00:00.000
2024-11-20 23:06:59,255 - DEBUG - sorted_long_factors: shape: (177, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -1.850413    ┆ 0    ┆ 176          │
│ INJUSDT      ┆ -1.802616    ┆ 1    ┆ 175          │
│ ARBUSDT      ┆ -1.800676    ┆ 2    ┆ 174          │
│ TRBUSDT      ┆ -1.799734    ┆ 3    ┆ 173          │
│ BNBUSDT      ┆ -1.577746    ┆ 4    ┆ 172          │
│ FILUSDT      ┆ -1.57236     ┆ 5    ┆ 171          │
│ AXSUSDT      ┆ -1.555115    ┆ 6    ┆ 170          │
│ RUNEUSDT     ┆ -1.542493    ┆ 7    ┆ 169          │
│ DOTUSDT      ┆ -1.539014    ┆ 8    ┆ 168          │
│ SUIUSDT      ┆ -1.535298    ┆ 9    ┆ 167          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TUSDT        ┆ 0.167688     ┆ 167  ┆ 9            │
│ ALICEUSDT    ┆ 0.172498     ┆ 168  ┆ 8            │
│ DEFIUSDT     ┆ 0.247185     ┆ 169  ┆ 7            │
│ SKLUSDT      ┆ 0.260686     ┆ 170  ┆ 6            │
│ CTKUSDT      ┆ 0.361464     ┆ 171  ┆ 5            │
│ DENTUSDT     ┆ 0.391395     ┆ 172  ┆ 4            │
│ CVXUSDT      ┆ 0.417492     ┆ 173  ┆ 3            │
│ DGBUSDT      ┆ 0.550635     ┆ 174  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.022351     ┆ 175  ┆ 1            │
│ BNXUSDT      ┆ 1.167441     ┆ 176  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:59,264 - WARNING - 2023-10-01T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:59,264 - INFO - cur close time: 2023-10-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:59,264 - DEBUG - mean expected ret (mean factor): -0.7865000446327217
2024-11-20 23:06:59,270 - DEBUG - begin to update pos: =========
2024-11-20 23:06:59,270 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,271 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01938     ┆ 0.06441     ┆ 0.0008143   ┆ … ┆ 0.01796 ┆ null   ┆ null    ┆ 0.197   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,278 - DEBUG - update position: 2023-10-01T23:59:59.999 === diff_trading_value: 265850.88927358587 == cash: 139802.78403398514 
2024-11-20 23:06:59,279 - INFO - pnl: 2023-10-01T23:59:59.999 139802.78403398514 === -0.027%
2024-11-20 23:06:59,283 - DEBUG - cur time: 2023-10-02T23:59:59.999 == next bar open time: 2023-10-03T00:00:00.000 == close pos time: 2023-10-10T00:00:00.000
2024-11-20 23:06:59,285 - INFO - pnl: 2023-10-02T23:59:59.999 139887.25597685497 === 0.060%
2024-11-20 23:06:59,289 - DEBUG - cur time: 2023-10-03T23:59:59.999 == next bar open time: 2023-10-04T00:00:00.000 == close pos time: 2023-10-11T00:00:00.000
2024-11-20 23:06:59,291 - INFO - pnl: 2023-10-03T23:59:59.999 140352.4116420917 === 0.333%
2024-11-20 23:06:59,296 - DEBUG - cur time: 2023-10-04T23:59:59.999 == next bar open time: 2023-10-05T00:00:00.000 == close pos time: 2023-10-12T00:00:00.000
2024-11-20 23:06:59,298 - INFO - pnl: 2023-10-04T23:59:59.999 140278.43415659363 === -0.053%
2024-11-20 23:06:59,304 - DEBUG - cur time: 2023-10-05T23:59:59.999 == next bar open time: 2023-10-06T00:00:00.000 == close pos time: 2023-10-13T00:00:00.000
2024-11-20 23:06:59,306 - INFO - pnl: 2023-10-05T23:59:59.999 140456.9496990696 === 0.127%
2024-11-20 23:06:59,314 - DEBUG - cur time: 2023-10-06T23:59:59.999 == next bar open time: 2023-10-07T00:00:00.000 == close pos time: 2023-10-14T00:00:00.000
2024-11-20 23:06:59,319 - INFO - pnl: 2023-10-06T23:59:59.999 140824.44771687957 === 0.262%
2024-11-20 23:06:59,324 - DEBUG - cur time: 2023-10-07T23:59:59.999 == next bar open time: 2023-10-08T00:00:00.000 == close pos time: 2023-10-15T00:00:00.000
2024-11-20 23:06:59,326 - INFO - pnl: 2023-10-07T23:59:59.999 141298.99970957745 === 0.337%
2024-11-20 23:06:59,330 - DEBUG - cur time: 2023-10-08T23:59:59.999 == next bar open time: 2023-10-09T00:00:00.000 == close pos time: 2023-10-16T00:00:00.000
2024-11-20 23:06:59,340 - DEBUG - sorted_long_factors: shape: (178, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -2.106964    ┆ 0    ┆ 177          │
│ XMRUSDT      ┆ -1.693278    ┆ 1    ┆ 176          │
│ XVSUSDT      ┆ -1.567924    ┆ 2    ┆ 175          │
│ DYDXUSDT     ┆ -1.54147     ┆ 3    ┆ 174          │
│ ATOMUSDT     ┆ -1.539903    ┆ 4    ┆ 173          │
│ APTUSDT      ┆ -1.479441    ┆ 5    ┆ 172          │
│ SUIUSDT      ┆ -1.473363    ┆ 6    ┆ 171          │
│ BNBUSDT      ┆ -1.471723    ┆ 7    ┆ 170          │
│ FILUSDT      ┆ -1.469126    ┆ 8    ┆ 169          │
│ UNFIUSDT     ┆ -1.451048    ┆ 9    ┆ 168          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DARUSDT      ┆ 0.039778     ┆ 168  ┆ 9            │
│ ASTRUSDT     ┆ 0.041198     ┆ 169  ┆ 8            │
│ RENUSDT      ┆ 0.11304      ┆ 170  ┆ 7            │
│ RSRUSDT      ┆ 0.125903     ┆ 171  ┆ 6            │
│ CTKUSDT      ┆ 0.296513     ┆ 172  ┆ 5            │
│ DGBUSDT      ┆ 0.402734     ┆ 173  ┆ 4            │
│ SKLUSDT      ┆ 0.518559     ┆ 174  ┆ 3            │
│ DEFIUSDT     ┆ 0.527241     ┆ 175  ┆ 2            │
│ CKBUSDT      ┆ 0.53252      ┆ 176  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.556621     ┆ 177  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:59,348 - WARNING - 2023-10-08T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:59,348 - INFO - cur close time: 2023-10-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:59,348 - DEBUG - mean expected ret (mean factor): -0.7932108488421686
2024-11-20 23:06:59,353 - DEBUG - begin to update pos: =========
2024-11-20 23:06:59,353 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,353 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01772     ┆ 0.05797     ┆ 0.0007155   ┆ … ┆ 0.01688 ┆ null   ┆ null    ┆ 0.2156  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,361 - DEBUG - update position: 2023-10-08T23:59:59.999 === diff_trading_value: 190388.64677675674 == cash: 142833.29595512705 
2024-11-20 23:06:59,363 - INFO - pnl: 2023-10-08T23:59:59.999 142833.29595512705 === 1.086%
2024-11-20 23:06:59,366 - DEBUG - cur time: 2023-10-09T23:59:59.999 == next bar open time: 2023-10-10T00:00:00.000 == close pos time: 2023-10-17T00:00:00.000
2024-11-20 23:06:59,368 - INFO - pnl: 2023-10-09T23:59:59.999 141134.12057141378 === -1.190%
2024-11-20 23:06:59,373 - DEBUG - cur time: 2023-10-10T23:59:59.999 == next bar open time: 2023-10-11T00:00:00.000 == close pos time: 2023-10-18T00:00:00.000
2024-11-20 23:06:59,375 - INFO - pnl: 2023-10-10T23:59:59.999 141008.88121155652 === -0.089%
2024-11-20 23:06:59,381 - DEBUG - cur time: 2023-10-11T23:59:59.999 == next bar open time: 2023-10-12T00:00:00.000 == close pos time: 2023-10-19T00:00:00.000
2024-11-20 23:06:59,383 - INFO - pnl: 2023-10-11T23:59:59.999 140793.91381292298 === -0.152%
2024-11-20 23:06:59,388 - DEBUG - cur time: 2023-10-12T23:59:59.999 == next bar open time: 2023-10-13T00:00:00.000 == close pos time: 2023-10-20T00:00:00.000
2024-11-20 23:06:59,389 - INFO - pnl: 2023-10-12T23:59:59.999 142204.0414860727 === 1.002%
2024-11-20 23:06:59,394 - DEBUG - cur time: 2023-10-13T23:59:59.999 == next bar open time: 2023-10-14T00:00:00.000 == close pos time: 2023-10-21T00:00:00.000
2024-11-20 23:06:59,395 - INFO - pnl: 2023-10-13T23:59:59.999 141852.85807534787 === -0.247%
2024-11-20 23:06:59,399 - DEBUG - cur time: 2023-10-14T23:59:59.999 == next bar open time: 2023-10-15T00:00:00.000 == close pos time: 2023-10-22T00:00:00.000
2024-11-20 23:06:59,402 - INFO - pnl: 2023-10-14T23:59:59.999 143294.64550424914 === 1.016%
2024-11-20 23:06:59,407 - DEBUG - cur time: 2023-10-15T23:59:59.999 == next bar open time: 2023-10-16T00:00:00.000 == close pos time: 2023-10-23T00:00:00.000
2024-11-20 23:06:59,417 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RUNEUSDT     ┆ -2.014087    ┆ 0    ┆ 179          │
│ STORJUSDT    ┆ -1.942397    ┆ 1    ┆ 178          │
│ MASKUSDT     ┆ -1.895953    ┆ 2    ┆ 177          │
│ TOMOUSDT     ┆ -1.776029    ┆ 3    ┆ 176          │
│ TRBUSDT      ┆ -1.715195    ┆ 4    ┆ 175          │
│ SUIUSDT      ┆ -1.685009    ┆ 5    ┆ 174          │
│ NMRUSDT      ┆ -1.641873    ┆ 6    ┆ 173          │
│ FILUSDT      ┆ -1.622648    ┆ 7    ┆ 172          │
│ UNFIUSDT     ┆ -1.619587    ┆ 8    ┆ 171          │
│ DYDXUSDT     ┆ -1.614745    ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ENSUSDT      ┆ -0.037337    ┆ 170  ┆ 9            │
│ DARUSDT      ┆ 0.033208     ┆ 171  ┆ 8            │
│ CELRUSDT     ┆ 0.057781     ┆ 172  ┆ 7            │
│ RVNUSDT      ┆ 0.176621     ┆ 173  ┆ 6            │
│ DGBUSDT      ┆ 0.17864      ┆ 174  ┆ 5            │
│ SKLUSDT      ┆ 0.325968     ┆ 175  ┆ 4            │
│ CVXUSDT      ┆ 0.458883     ┆ 176  ┆ 3            │
│ CKBUSDT      ┆ 0.594657     ┆ 177  ┆ 2            │
│ DEFIUSDT     ┆ 0.678693     ┆ 178  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.21072      ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:59,424 - WARNING - 2023-10-15T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:59,424 - INFO - cur close time: 2023-10-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:59,425 - DEBUG - mean expected ret (mean factor): -0.7852510771804722
2024-11-20 23:06:59,430 - DEBUG - begin to update pos: =========
2024-11-20 23:06:59,431 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,431 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01807     ┆ 0.05744     ┆ 0.0006655   ┆ … ┆ 0.01653 ┆ null   ┆ null    ┆ 0.2173  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,444 - DEBUG - update position: 2023-10-15T23:59:59.999 === diff_trading_value: 199616.2597279643 == cash: 142925.950720916 
2024-11-20 23:06:59,447 - INFO - pnl: 2023-10-15T23:59:59.999 142925.950720916 === -0.257%
2024-11-20 23:06:59,454 - DEBUG - cur time: 2023-10-16T23:59:59.999 == next bar open time: 2023-10-17T00:00:00.000 == close pos time: 2023-10-24T00:00:00.000
2024-11-20 23:06:59,457 - INFO - pnl: 2023-10-16T23:59:59.999 143460.69385325996 === 0.374%
2024-11-20 23:06:59,461 - DEBUG - cur time: 2023-10-17T23:59:59.999 == next bar open time: 2023-10-18T00:00:00.000 == close pos time: 2023-10-25T00:00:00.000
2024-11-20 23:06:59,464 - INFO - pnl: 2023-10-17T23:59:59.999 144529.29785533657 === 0.745%
2024-11-20 23:06:59,470 - DEBUG - cur time: 2023-10-18T23:59:59.999 == next bar open time: 2023-10-19T00:00:00.000 == close pos time: 2023-10-26T00:00:00.000
2024-11-20 23:06:59,472 - INFO - pnl: 2023-10-18T23:59:59.999 143302.79379365782 === -0.849%
2024-11-20 23:06:59,479 - DEBUG - cur time: 2023-10-19T23:59:59.999 == next bar open time: 2023-10-20T00:00:00.000 == close pos time: 2023-10-27T00:00:00.000
2024-11-20 23:06:59,482 - INFO - pnl: 2023-10-19T23:59:59.999 142751.2688566342 === -0.385%
2024-11-20 23:06:59,486 - DEBUG - cur time: 2023-10-20T23:59:59.999 == next bar open time: 2023-10-21T00:00:00.000 == close pos time: 2023-10-28T00:00:00.000
2024-11-20 23:06:59,488 - INFO - pnl: 2023-10-20T23:59:59.999 140504.2378955155 === -1.574%
2024-11-20 23:06:59,495 - DEBUG - cur time: 2023-10-21T23:59:59.999 == next bar open time: 2023-10-22T00:00:00.000 == close pos time: 2023-10-29T00:00:00.000
2024-11-20 23:06:59,498 - INFO - pnl: 2023-10-21T23:59:59.999 140975.7571057868 === 0.336%
2024-11-20 23:06:59,504 - DEBUG - cur time: 2023-10-22T23:59:59.999 == next bar open time: 2023-10-23T00:00:00.000 == close pos time: 2023-10-30T00:00:00.000
2024-11-20 23:06:59,515 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ KNCUSDT      ┆ -1.976602    ┆ 0    ┆ 179          │
│ MKRUSDT      ┆ -1.832538    ┆ 1    ┆ 178          │
│ UNFIUSDT     ┆ -1.818966    ┆ 2    ┆ 177          │
│ UMAUSDT      ┆ -1.756364    ┆ 3    ┆ 176          │
│ EGLDUSDT     ┆ -1.730225    ┆ 4    ┆ 175          │
│ APEUSDT      ┆ -1.714136    ┆ 5    ┆ 174          │
│ BNBUSDT      ┆ -1.706662    ┆ 6    ┆ 173          │
│ XVSUSDT      ┆ -1.640671    ┆ 7    ┆ 172          │
│ MASKUSDT     ┆ -1.588139    ┆ 8    ┆ 171          │
│ BNXUSDT      ┆ -1.543456    ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CELRUSDT     ┆ 0.025079     ┆ 170  ┆ 9            │
│ IDEXUSDT     ┆ 0.084411     ┆ 171  ┆ 8            │
│ DGBUSDT      ┆ 0.178831     ┆ 172  ┆ 7            │
│ CTKUSDT      ┆ 0.256017     ┆ 173  ┆ 6            │
│ SKLUSDT      ┆ 0.262682     ┆ 174  ┆ 5            │
│ TLMUSDT      ┆ 0.284677     ┆ 175  ┆ 4            │
│ CVXUSDT      ┆ 0.328953     ┆ 176  ┆ 3            │
│ CKBUSDT      ┆ 0.397798     ┆ 177  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.398368     ┆ 178  ┆ 1            │
│ DEFIUSDT     ┆ 0.864496     ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:59,529 - WARNING - 2023-10-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:59,529 - INFO - cur close time: 2023-10-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:59,529 - DEBUG - mean expected ret (mean factor): -0.7784432919851648
2024-11-20 23:06:59,535 - DEBUG - begin to update pos: =========
2024-11-20 23:06:59,535 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,535 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02482     ┆ 0.0586      ┆ 0.0007473   ┆ … ┆ 0.01758 ┆ null   ┆ null    ┆ 0.2215  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,542 - DEBUG - update position: 2023-10-22T23:59:59.999 === diff_trading_value: 247893.23604987416 == cash: 140897.184662168 
2024-11-20 23:06:59,544 - INFO - pnl: 2023-10-22T23:59:59.999 140897.184662168 === -0.056%
2024-11-20 23:06:59,548 - DEBUG - cur time: 2023-10-23T23:59:59.999 == next bar open time: 2023-10-24T00:00:00.000 == close pos time: 2023-10-31T00:00:00.000
2024-11-20 23:06:59,550 - INFO - pnl: 2023-10-23T23:59:59.999 142422.09457162648 === 1.082%
2024-11-20 23:06:59,556 - DEBUG - cur time: 2023-10-24T23:59:59.999 == next bar open time: 2023-10-25T00:00:00.000 == close pos time: 2023-11-01T00:00:00.000
2024-11-20 23:06:59,559 - INFO - pnl: 2023-10-24T23:59:59.999 144281.4874337726 === 1.306%
2024-11-20 23:06:59,565 - DEBUG - cur time: 2023-10-25T23:59:59.999 == next bar open time: 2023-10-26T00:00:00.000 == close pos time: 2023-11-02T00:00:00.000
2024-11-20 23:06:59,569 - INFO - pnl: 2023-10-25T23:59:59.999 144306.93660721043 === 0.018%
2024-11-20 23:06:59,574 - DEBUG - cur time: 2023-10-26T23:59:59.999 == next bar open time: 2023-10-27T00:00:00.000 == close pos time: 2023-11-03T00:00:00.000
2024-11-20 23:06:59,577 - INFO - pnl: 2023-10-26T23:59:59.999 146359.33621130005 === 1.422%
2024-11-20 23:06:59,584 - DEBUG - cur time: 2023-10-27T23:59:59.999 == next bar open time: 2023-10-28T00:00:00.000 == close pos time: 2023-11-04T00:00:00.000
2024-11-20 23:06:59,588 - INFO - pnl: 2023-10-27T23:59:59.999 143926.48542628673 === -1.662%
2024-11-20 23:06:59,593 - DEBUG - cur time: 2023-10-28T23:59:59.999 == next bar open time: 2023-10-29T00:00:00.000 == close pos time: 2023-11-05T00:00:00.000
2024-11-20 23:06:59,596 - INFO - pnl: 2023-10-28T23:59:59.999 143689.64221126554 === -0.165%
2024-11-20 23:06:59,602 - DEBUG - cur time: 2023-10-29T23:59:59.999 == next bar open time: 2023-10-30T00:00:00.000 == close pos time: 2023-11-06T00:00:00.000
2024-11-20 23:06:59,614 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -1.767789    ┆ 0    ┆ 179          │
│ BNBUSDT      ┆ -1.716513    ┆ 1    ┆ 178          │
│ MKRUSDT      ┆ -1.678784    ┆ 2    ┆ 177          │
│ UNIUSDT      ┆ -1.658111    ┆ 3    ┆ 176          │
│ EDUUSDT      ┆ -1.634416    ┆ 4    ┆ 175          │
│ RNDRUSDT     ┆ -1.572394    ┆ 5    ┆ 174          │
│ AXSUSDT      ┆ -1.54361     ┆ 6    ┆ 173          │
│ DYDXUSDT     ┆ -1.467522    ┆ 7    ┆ 172          │
│ BLURUSDT     ┆ -1.438706    ┆ 8    ┆ 171          │
│ WAVESUSDT    ┆ -1.434262    ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ -0.034341    ┆ 170  ┆ 9            │
│ ZENUSDT      ┆ -0.004179    ┆ 171  ┆ 8            │
│ CTKUSDT      ┆ 0.054102     ┆ 172  ┆ 7            │
│ DGBUSDT      ┆ 0.158965     ┆ 173  ┆ 6            │
│ DARUSDT      ┆ 0.172228     ┆ 174  ┆ 5            │
│ SKLUSDT      ┆ 0.272181     ┆ 175  ┆ 4            │
│ RVNUSDT      ┆ 0.573606     ┆ 176  ┆ 3            │
│ DEFIUSDT     ┆ 0.634528     ┆ 177  ┆ 2            │
│ CKBUSDT      ┆ 0.769783     ┆ 178  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.786473     ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:59,624 - WARNING - 2023-10-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:59,624 - INFO - cur close time: 2023-10-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:59,624 - DEBUG - mean expected ret (mean factor): -0.7619127525625787
2024-11-20 23:06:59,630 - DEBUG - begin to update pos: =========
2024-11-20 23:06:59,630 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,630 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03479     ┆ 0.06464     ┆ 0.0011473   ┆ … ┆ 0.01904 ┆ null   ┆ null    ┆ 0.2609  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,643 - DEBUG - update position: 2023-10-29T23:59:59.999 === diff_trading_value: 260733.74270498735 == cash: 143220.46827436797 
2024-11-20 23:06:59,646 - INFO - pnl: 2023-10-29T23:59:59.999 143220.46827436797 === -0.327%
2024-11-20 23:06:59,653 - DEBUG - cur time: 2023-10-30T23:59:59.999 == next bar open time: 2023-10-31T00:00:00.000 == close pos time: 2023-11-07T00:00:00.000
2024-11-20 23:06:59,654 - INFO - pnl: 2023-10-30T23:59:59.999 144363.44153382376 === 0.798%
2024-11-20 23:06:59,661 - DEBUG - cur time: 2023-10-31T23:59:59.999 == next bar open time: 2023-11-01T00:00:00.000 == close pos time: 2023-11-08T00:00:00.000
2024-11-20 23:06:59,663 - INFO - pnl: 2023-10-31T23:59:59.999 145882.36094803966 === 1.052%
2024-11-20 23:06:59,668 - DEBUG - cur time: 2023-11-01T23:59:59.999 == next bar open time: 2023-11-02T00:00:00.000 == close pos time: 2023-11-09T00:00:00.000
2024-11-20 23:06:59,670 - INFO - pnl: 2023-11-01T23:59:59.999 146334.7525104657 === 0.310%
2024-11-20 23:06:59,674 - DEBUG - cur time: 2023-11-02T23:59:59.999 == next bar open time: 2023-11-03T00:00:00.000 == close pos time: 2023-11-10T00:00:00.000
2024-11-20 23:06:59,676 - INFO - pnl: 2023-11-02T23:59:59.999 145753.97145576327 === -0.397%
2024-11-20 23:06:59,682 - DEBUG - cur time: 2023-11-03T23:59:59.999 == next bar open time: 2023-11-04T00:00:00.000 == close pos time: 2023-11-11T00:00:00.000
2024-11-20 23:06:59,684 - INFO - pnl: 2023-11-03T23:59:59.999 148611.54744591948 === 1.961%
2024-11-20 23:06:59,689 - DEBUG - cur time: 2023-11-04T23:59:59.999 == next bar open time: 2023-11-05T00:00:00.000 == close pos time: 2023-11-12T00:00:00.000
2024-11-20 23:06:59,691 - INFO - pnl: 2023-11-04T23:59:59.999 148614.97859155212 === 0.002%
2024-11-20 23:06:59,696 - DEBUG - cur time: 2023-11-05T23:59:59.999 == next bar open time: 2023-11-06T00:00:00.000 == close pos time: 2023-11-13T00:00:00.000
2024-11-20 23:06:59,706 - DEBUG - sorted_long_factors: shape: (181, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT      ┆ -1.719992    ┆ 0    ┆ 180          │
│ RNDRUSDT     ┆ -1.713375    ┆ 1    ┆ 179          │
│ OPUSDT       ┆ -1.674009    ┆ 2    ┆ 178          │
│ FILUSDT      ┆ -1.660358    ┆ 3    ┆ 177          │
│ COMPUSDT     ┆ -1.574072    ┆ 4    ┆ 176          │
│ ZECUSDT      ┆ -1.551329    ┆ 5    ┆ 175          │
│ MTLUSDT      ┆ -1.539413    ┆ 6    ┆ 174          │
│ WAVESUSDT    ┆ -1.517207    ┆ 7    ┆ 173          │
│ DASHUSDT     ┆ -1.496405    ┆ 8    ┆ 172          │
│ YFIUSDT      ┆ -1.491916    ┆ 9    ┆ 171          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ 0.027824     ┆ 171  ┆ 9            │
│ TLMUSDT      ┆ 0.088527     ┆ 172  ┆ 8            │
│ CTKUSDT      ┆ 0.125126     ┆ 173  ┆ 7            │
│ RVNUSDT      ┆ 0.215927     ┆ 174  ┆ 6            │
│ DENTUSDT     ┆ 0.21846      ┆ 175  ┆ 5            │
│ BTCDOMUSDT   ┆ 0.324309     ┆ 176  ┆ 4            │
│ CVXUSDT      ┆ 0.332928     ┆ 177  ┆ 3            │
│ CKBUSDT      ┆ 0.716482     ┆ 178  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.12824      ┆ 179  ┆ 1            │
│ DEFIUSDT     ┆ 1.624302     ┆ 180  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:59,715 - WARNING - 2023-11-05T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:59,715 - INFO - cur close time: 2023-11-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:59,715 - DEBUG - mean expected ret (mean factor): -0.7787267264110691
2024-11-20 23:06:59,720 - DEBUG - begin to update pos: =========
2024-11-20 23:06:59,720 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,721 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03104     ┆ 0.06495     ┆ 0.0011226   ┆ … ┆ 0.02043 ┆ null   ┆ null    ┆ 0.2668  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,731 - DEBUG - update position: 2023-11-05T23:59:59.999 === diff_trading_value: 235563.9052558405 == cash: 148795.4406394521 
2024-11-20 23:06:59,732 - INFO - pnl: 2023-11-05T23:59:59.999 148795.4406394521 === 0.121%
2024-11-20 23:06:59,740 - DEBUG - cur time: 2023-11-06T23:59:59.999 == next bar open time: 2023-11-07T00:00:00.000 == close pos time: 2023-11-14T00:00:00.000
2024-11-20 23:06:59,744 - INFO - pnl: 2023-11-06T23:59:59.999 150057.78866669367 === 0.848%
2024-11-20 23:06:59,748 - DEBUG - cur time: 2023-11-07T23:59:59.999 == next bar open time: 2023-11-08T00:00:00.000 == close pos time: 2023-11-15T00:00:00.000
2024-11-20 23:06:59,750 - INFO - pnl: 2023-11-07T23:59:59.999 148605.16008911506 === -0.968%
2024-11-20 23:06:59,754 - DEBUG - cur time: 2023-11-08T23:59:59.999 == next bar open time: 2023-11-09T00:00:00.000 == close pos time: 2023-11-16T00:00:00.000
2024-11-20 23:06:59,756 - INFO - pnl: 2023-11-08T23:59:59.999 150235.33840263728 === 1.097%
2024-11-20 23:06:59,760 - DEBUG - cur time: 2023-11-09T23:59:59.999 == next bar open time: 2023-11-10T00:00:00.000 == close pos time: 2023-11-17T00:00:00.000
2024-11-20 23:06:59,763 - INFO - pnl: 2023-11-09T23:59:59.999 149200.66796960367 === -0.689%
2024-11-20 23:06:59,769 - DEBUG - cur time: 2023-11-10T23:59:59.999 == next bar open time: 2023-11-11T00:00:00.000 == close pos time: 2023-11-18T00:00:00.000
2024-11-20 23:06:59,773 - INFO - pnl: 2023-11-10T23:59:59.999 147442.31224331906 === -1.179%
2024-11-20 23:06:59,780 - DEBUG - cur time: 2023-11-11T23:59:59.999 == next bar open time: 2023-11-12T00:00:00.000 == close pos time: 2023-11-19T00:00:00.000
2024-11-20 23:06:59,784 - INFO - pnl: 2023-11-11T23:59:59.999 145248.86256418476 === -1.488%
2024-11-20 23:06:59,791 - DEBUG - cur time: 2023-11-12T23:59:59.999 == next bar open time: 2023-11-13T00:00:00.000 == close pos time: 2023-11-20T00:00:00.000
2024-11-20 23:06:59,802 - DEBUG - sorted_long_factors: shape: (183, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -1.810599    ┆ 0    ┆ 182          │
│ FILUSDT      ┆ -1.693023    ┆ 1    ┆ 181          │
│ WLDUSDT      ┆ -1.670339    ┆ 2    ┆ 180          │
│ DOTUSDT      ┆ -1.643958    ┆ 3    ┆ 179          │
│ AAVEUSDT     ┆ -1.596766    ┆ 4    ┆ 178          │
│ DYDXUSDT     ┆ -1.578323    ┆ 5    ┆ 177          │
│ MATICUSDT    ┆ -1.526181    ┆ 6    ┆ 176          │
│ MKRUSDT      ┆ -1.4973      ┆ 7    ┆ 175          │
│ SUIUSDT      ┆ -1.491302    ┆ 8    ┆ 174          │
│ MTLUSDT      ┆ -1.433131    ┆ 9    ┆ 173          │
│ …            ┆ …            ┆ …    ┆ …            │
│ OMGUSDT      ┆ 0.026432     ┆ 173  ┆ 9            │
│ DENTUSDT     ┆ 0.114562     ┆ 174  ┆ 8            │
│ JASMYUSDT    ┆ 0.118022     ┆ 175  ┆ 7            │
│ CVXUSDT      ┆ 0.165702     ┆ 176  ┆ 6            │
│ TRUUSDT      ┆ 0.25772      ┆ 177  ┆ 5            │
│ DGBUSDT      ┆ 0.345877     ┆ 178  ┆ 4            │
│ CKBUSDT      ┆ 0.357448     ┆ 179  ┆ 3            │
│ BTCDOMUSDT   ┆ 0.36165      ┆ 180  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.181327     ┆ 181  ┆ 1            │
│ DEFIUSDT     ┆ 1.614785     ┆ 182  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:59,810 - WARNING - 2023-11-12T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:06:59,810 - INFO - cur close time: 2023-11-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:06:59,810 - DEBUG - mean expected ret (mean factor): -0.7745251667272429
2024-11-20 23:06:59,816 - DEBUG - begin to update pos: =========
2024-11-20 23:06:59,817 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,818 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03036     ┆ 0.08414     ┆ 0.0012272   ┆ … ┆ 0.02275 ┆ null   ┆ null    ┆ 0.4976  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,828 - DEBUG - update position: 2023-11-12T23:59:59.999 === diff_trading_value: 247093.87166772128 == cash: 143482.1214625809 
2024-11-20 23:06:59,831 - INFO - pnl: 2023-11-12T23:59:59.999 143482.1214625809 === -1.216%
2024-11-20 23:06:59,836 - DEBUG - cur time: 2023-11-13T23:59:59.999 == next bar open time: 2023-11-14T00:00:00.000 == close pos time: 2023-11-21T00:00:00.000
2024-11-20 23:06:59,838 - INFO - pnl: 2023-11-13T23:59:59.999 139317.5418252403 === -2.903%
2024-11-20 23:06:59,844 - DEBUG - cur time: 2023-11-14T23:59:59.999 == next bar open time: 2023-11-15T00:00:00.000 == close pos time: 2023-11-22T00:00:00.000
2024-11-20 23:06:59,846 - INFO - pnl: 2023-11-14T23:59:59.999 136839.72077621985 === -1.779%
2024-11-20 23:06:59,851 - DEBUG - cur time: 2023-11-15T23:59:59.999 == next bar open time: 2023-11-16T00:00:00.000 == close pos time: 2023-11-23T00:00:00.000
2024-11-20 23:06:59,853 - INFO - pnl: 2023-11-15T23:59:59.999 137469.15000005937 === 0.460%
2024-11-20 23:06:59,858 - DEBUG - cur time: 2023-11-16T23:59:59.999 == next bar open time: 2023-11-17T00:00:00.000 == close pos time: 2023-11-24T00:00:00.000
2024-11-20 23:06:59,861 - INFO - pnl: 2023-11-16T23:59:59.999 141137.76477037382 === 2.669%
2024-11-20 23:06:59,866 - DEBUG - cur time: 2023-11-17T23:59:59.999 == next bar open time: 2023-11-18T00:00:00.000 == close pos time: 2023-11-25T00:00:00.000
2024-11-20 23:06:59,870 - INFO - pnl: 2023-11-17T23:59:59.999 143365.63704335125 === 1.579%
2024-11-20 23:06:59,878 - DEBUG - cur time: 2023-11-18T23:59:59.999 == next bar open time: 2023-11-19T00:00:00.000 == close pos time: 2023-11-26T00:00:00.000
2024-11-20 23:06:59,881 - INFO - pnl: 2023-11-18T23:59:59.999 142921.4241533648 === -0.310%
2024-11-20 23:06:59,888 - DEBUG - cur time: 2023-11-19T23:59:59.999 == next bar open time: 2023-11-20T00:00:00.000 == close pos time: 2023-11-27T00:00:00.000
2024-11-20 23:06:59,900 - DEBUG - sorted_long_factors: shape: (186, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNTUSDT      ┆ -2.140143    ┆ 0    ┆ 185          │
│ MKRUSDT      ┆ -1.979671    ┆ 1    ┆ 184          │
│ BNBUSDT      ┆ -1.837082    ┆ 2    ┆ 183          │
│ ARKMUSDT     ┆ -1.744447    ┆ 3    ┆ 182          │
│ XRPUSDT      ┆ -1.735538    ┆ 4    ┆ 181          │
│ MASKUSDT     ┆ -1.715418    ┆ 5    ┆ 180          │
│ AAVEUSDT     ┆ -1.706648    ┆ 6    ┆ 179          │
│ FILUSDT      ┆ -1.702036    ┆ 7    ┆ 178          │
│ DOTUSDT      ┆ -1.697996    ┆ 8    ┆ 177          │
│ YFIUSDT      ┆ -1.666848    ┆ 9    ┆ 176          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SPELLUSDT    ┆ 0.183855     ┆ 176  ┆ 9            │
│ REEFUSDT     ┆ 0.185992     ┆ 177  ┆ 8            │
│ RSRUSDT      ┆ 0.239232     ┆ 178  ┆ 7            │
│ DGBUSDT      ┆ 0.243816     ┆ 179  ┆ 6            │
│ DENTUSDT     ┆ 0.277812     ┆ 180  ┆ 5            │
│ CTKUSDT      ┆ 0.307925     ┆ 181  ┆ 4            │
│ TLMUSDT      ┆ 0.383887     ┆ 182  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.588214     ┆ 183  ┆ 2            │
│ DEFIUSDT     ┆ 1.212664     ┆ 184  ┆ 1            │
│ IDEXUSDT     ┆ 1.23725      ┆ 185  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:06:59,913 - WARNING - 2023-11-19T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:06:59,913 - INFO - cur close time: 2023-11-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:06:59,913 - DEBUG - mean expected ret (mean factor): -0.7708348585533276
2024-11-20 23:06:59,918 - DEBUG - begin to update pos: =========
2024-11-20 23:06:59,919 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,919 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03286     ┆ 0.07784     ┆ 0.0011914   ┆ … ┆ 0.02221 ┆ null   ┆ null    ┆ 0.3997  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:06:59,927 - DEBUG - update position: 2023-11-19T23:59:59.999 === diff_trading_value: 216182.430223143 == cash: 143046.07304674922 
2024-11-20 23:06:59,928 - INFO - pnl: 2023-11-19T23:59:59.999 143046.07304674922 === 0.087%
2024-11-20 23:06:59,933 - DEBUG - cur time: 2023-11-20T23:59:59.999 == next bar open time: 2023-11-21T00:00:00.000 == close pos time: 2023-11-28T00:00:00.000
2024-11-20 23:06:59,934 - INFO - pnl: 2023-11-20T23:59:59.999 146324.42409255577 === 2.292%
2024-11-20 23:06:59,938 - DEBUG - cur time: 2023-11-21T23:59:59.999 == next bar open time: 2023-11-22T00:00:00.000 == close pos time: 2023-11-29T00:00:00.000
2024-11-20 23:06:59,940 - INFO - pnl: 2023-11-21T23:59:59.999 144347.23026669613 === -1.351%
2024-11-20 23:06:59,946 - DEBUG - cur time: 2023-11-22T23:59:59.999 == next bar open time: 2023-11-23T00:00:00.000 == close pos time: 2023-11-30T00:00:00.000
2024-11-20 23:06:59,947 - INFO - pnl: 2023-11-22T23:59:59.999 144340.46583554658 === -0.005%
2024-11-20 23:06:59,952 - DEBUG - cur time: 2023-11-23T23:59:59.999 == next bar open time: 2023-11-24T00:00:00.000 == close pos time: 2023-12-01T00:00:00.000
2024-11-20 23:06:59,954 - INFO - pnl: 2023-11-23T23:59:59.999 144844.1659469215 === 0.349%
2024-11-20 23:06:59,960 - DEBUG - cur time: 2023-11-24T23:59:59.999 == next bar open time: 2023-11-25T00:00:00.000 == close pos time: 2023-12-02T00:00:00.000
2024-11-20 23:06:59,963 - INFO - pnl: 2023-11-24T23:59:59.999 146474.21772380668 === 1.125%
2024-11-20 23:06:59,969 - DEBUG - cur time: 2023-11-25T23:59:59.999 == next bar open time: 2023-11-26T00:00:00.000 == close pos time: 2023-12-03T00:00:00.000
2024-11-20 23:06:59,971 - INFO - pnl: 2023-11-25T23:59:59.999 145835.74293842443 === -0.436%
2024-11-20 23:06:59,978 - DEBUG - cur time: 2023-11-26T23:59:59.999 == next bar open time: 2023-11-27T00:00:00.000 == close pos time: 2023-12-04T00:00:00.000
2024-11-20 23:06:59,991 - DEBUG - sorted_long_factors: shape: (188, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT      ┆ -1.827826    ┆ 0    ┆ 187          │
│ BTCDOMUSDT   ┆ -1.768215    ┆ 1    ┆ 186          │
│ AXSUSDT      ┆ -1.750526    ┆ 2    ┆ 185          │
│ SEIUSDT      ┆ -1.677692    ┆ 3    ┆ 184          │
│ MASKUSDT     ┆ -1.603827    ┆ 4    ┆ 183          │
│ APEUSDT      ┆ -1.51714     ┆ 5    ┆ 182          │
│ YFIUSDT      ┆ -1.514397    ┆ 6    ┆ 181          │
│ ENJUSDT      ┆ -1.490448    ┆ 7    ┆ 180          │
│ ATOMUSDT     ┆ -1.475736    ┆ 8    ┆ 179          │
│ BELUSDT      ┆ -1.456636    ┆ 9    ┆ 178          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TUSDT        ┆ -0.047073    ┆ 178  ┆ 9            │
│ IDEXUSDT     ┆ 0.060089     ┆ 179  ┆ 8            │
│ BALUSDT      ┆ 0.107072     ┆ 180  ┆ 7            │
│ CTKUSDT      ┆ 0.11571      ┆ 181  ┆ 6            │
│ DENTUSDT     ┆ 0.14054      ┆ 182  ┆ 5            │
│ BLUEBIRDUSDT ┆ 0.173474     ┆ 183  ┆ 4            │
│ CKBUSDT      ┆ 0.234192     ┆ 184  ┆ 3            │
│ DGBUSDT      ┆ 0.409655     ┆ 185  ┆ 2            │
│ CVXUSDT      ┆ 1.05961      ┆ 186  ┆ 1            │
│ DEFIUSDT     ┆ 2.371589     ┆ 187  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:00,001 - INFO - cur close time: 2023-11-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:00,001 - DEBUG - mean expected ret (mean factor): -0.7576152669381783
2024-11-20 23:07:00,006 - DEBUG - begin to update pos: =========
2024-11-20 23:07:00,006 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,006 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0322      ┆ 0.10002     ┆ 0.0011153   ┆ … ┆ 0.02121 ┆ null   ┆ null    ┆ 0.4006  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,027 - DEBUG - update position: 2023-11-26T23:59:59.999 === diff_trading_value: 257731.24626425572 == cash: 148184.1633514982 
2024-11-20 23:07:00,031 - INFO - pnl: 2023-11-26T23:59:59.999 148184.1633514982 === 1.610%
2024-11-20 23:07:00,039 - DEBUG - cur time: 2023-11-27T23:59:59.999 == next bar open time: 2023-11-28T00:00:00.000 == close pos time: 2023-12-05T00:00:00.000
2024-11-20 23:07:00,044 - INFO - pnl: 2023-11-27T23:59:59.999 146943.03395012626 === -0.838%
2024-11-20 23:07:00,055 - DEBUG - cur time: 2023-11-28T23:59:59.999 == next bar open time: 2023-11-29T00:00:00.000 == close pos time: 2023-12-06T00:00:00.000
2024-11-20 23:07:00,060 - INFO - pnl: 2023-11-28T23:59:59.999 146058.89453056513 === -0.602%
2024-11-20 23:07:00,070 - DEBUG - cur time: 2023-11-29T23:59:59.999 == next bar open time: 2023-11-30T00:00:00.000 == close pos time: 2023-12-07T00:00:00.000
2024-11-20 23:07:00,073 - INFO - pnl: 2023-11-29T23:59:59.999 147687.74934005388 === 1.115%
2024-11-20 23:07:00,080 - DEBUG - cur time: 2023-11-30T23:59:59.999 == next bar open time: 2023-12-01T00:00:00.000 == close pos time: 2023-12-08T00:00:00.000
2024-11-20 23:07:00,083 - INFO - pnl: 2023-11-30T23:59:59.999 149977.3298178867 === 1.550%
2024-11-20 23:07:00,089 - DEBUG - cur time: 2023-12-01T23:59:59.999 == next bar open time: 2023-12-02T00:00:00.000 == close pos time: 2023-12-09T00:00:00.000
2024-11-20 23:07:00,092 - INFO - pnl: 2023-12-01T23:59:59.999 149059.93339234576 === -0.612%
2024-11-20 23:07:00,098 - DEBUG - cur time: 2023-12-02T23:59:59.999 == next bar open time: 2023-12-03T00:00:00.000 == close pos time: 2023-12-10T00:00:00.000
2024-11-20 23:07:00,101 - INFO - pnl: 2023-12-02T23:59:59.999 150178.26517105065 === 0.750%
2024-11-20 23:07:00,107 - DEBUG - cur time: 2023-12-03T23:59:59.999 == next bar open time: 2023-12-04T00:00:00.000 == close pos time: 2023-12-11T00:00:00.000
2024-11-20 23:07:00,119 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MDTUSDT      ┆ -1.989982    ┆ 0    ┆ 188          │
│ EGLDUSDT     ┆ -1.811801    ┆ 1    ┆ 187          │
│ AXSUSDT      ┆ -1.804187    ┆ 2    ┆ 186          │
│ NEOUSDT      ┆ -1.794313    ┆ 3    ┆ 185          │
│ SNXUSDT      ┆ -1.777113    ┆ 4    ┆ 184          │
│ STXUSDT      ┆ -1.752881    ┆ 5    ┆ 183          │
│ WLDUSDT      ┆ -1.706792    ┆ 6    ┆ 182          │
│ YFIUSDT      ┆ -1.684615    ┆ 7    ┆ 181          │
│ IDUSDT       ┆ -1.59753     ┆ 8    ┆ 180          │
│ CYBERUSDT    ┆ -1.535587    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TUSDT        ┆ 0.092788     ┆ 179  ┆ 9            │
│ BALUSDT      ┆ 0.178263     ┆ 180  ┆ 8            │
│ ATAUSDT      ┆ 0.270929     ┆ 181  ┆ 7            │
│ DGBUSDT      ┆ 0.311336     ┆ 182  ┆ 6            │
│ AAVEUSDT     ┆ 0.343029     ┆ 183  ┆ 5            │
│ GMXUSDT      ┆ 0.424983     ┆ 184  ┆ 4            │
│ CKBUSDT      ┆ 0.661955     ┆ 185  ┆ 3            │
│ CVXUSDT      ┆ 1.234006     ┆ 186  ┆ 2            │
│ DEFIUSDT     ┆ 2.26283      ┆ 187  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.300705     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:00,130 - WARNING - 2023-12-03T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:00,130 - INFO - cur close time: 2023-12-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:00,130 - DEBUG - mean expected ret (mean factor): -0.7574950853607108
2024-11-20 23:07:00,135 - DEBUG - begin to update pos: =========
2024-11-20 23:07:00,136 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,136 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03367     ┆ 0.19713     ┆ 0.0012074   ┆ … ┆ 0.02235 ┆ null   ┆ null    ┆ 0.4048  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,145 - DEBUG - update position: 2023-12-03T23:59:59.999 === diff_trading_value: 254214.92068752155 == cash: 149700.9428845603 
2024-11-20 23:07:00,146 - INFO - pnl: 2023-12-03T23:59:59.999 149700.9428845603 === -0.318%
2024-11-20 23:07:00,153 - DEBUG - cur time: 2023-12-04T23:59:59.999 == next bar open time: 2023-12-05T00:00:00.000 == close pos time: 2023-12-12T00:00:00.000
2024-11-20 23:07:00,155 - INFO - pnl: 2023-12-04T23:59:59.999 148797.0356407644 === -0.604%
2024-11-20 23:07:00,160 - DEBUG - cur time: 2023-12-05T23:59:59.999 == next bar open time: 2023-12-06T00:00:00.000 == close pos time: 2023-12-13T00:00:00.000
2024-11-20 23:07:00,161 - INFO - pnl: 2023-12-05T23:59:59.999 148927.594265695 === 0.088%
2024-11-20 23:07:00,167 - DEBUG - cur time: 2023-12-06T23:59:59.999 == next bar open time: 2023-12-07T00:00:00.000 == close pos time: 2023-12-14T00:00:00.000
2024-11-20 23:07:00,170 - INFO - pnl: 2023-12-06T23:59:59.999 153041.50622934825 === 2.762%
2024-11-20 23:07:00,175 - DEBUG - cur time: 2023-12-07T23:59:59.999 == next bar open time: 2023-12-08T00:00:00.000 == close pos time: 2023-12-15T00:00:00.000
2024-11-20 23:07:00,177 - INFO - pnl: 2023-12-07T23:59:59.999 153333.8673287851 === 0.191%
2024-11-20 23:07:00,182 - DEBUG - cur time: 2023-12-08T23:59:59.999 == next bar open time: 2023-12-09T00:00:00.000 == close pos time: 2023-12-16T00:00:00.000
2024-11-20 23:07:00,186 - INFO - pnl: 2023-12-08T23:59:59.999 152803.78922506212 === -0.346%
2024-11-20 23:07:00,189 - DEBUG - cur time: 2023-12-09T23:59:59.999 == next bar open time: 2023-12-10T00:00:00.000 == close pos time: 2023-12-17T00:00:00.000
2024-11-20 23:07:00,191 - INFO - pnl: 2023-12-09T23:59:59.999 152408.67392957286 === -0.259%
2024-11-20 23:07:00,196 - DEBUG - cur time: 2023-12-10T23:59:59.999 == next bar open time: 2023-12-11T00:00:00.000 == close pos time: 2023-12-18T00:00:00.000
2024-11-20 23:07:00,206 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ATOMUSDT     ┆ -1.890435    ┆ 0    ┆ 188          │
│ CYBERUSDT    ┆ -1.79954     ┆ 1    ┆ 187          │
│ SNXUSDT      ┆ -1.766148    ┆ 2    ┆ 186          │
│ STORJUSDT    ┆ -1.744556    ┆ 3    ┆ 185          │
│ MDTUSDT      ┆ -1.705459    ┆ 4    ┆ 184          │
│ WLDUSDT      ┆ -1.664125    ┆ 5    ┆ 183          │
│ APTUSDT      ┆ -1.64758     ┆ 6    ┆ 182          │
│ NEOUSDT      ┆ -1.616462    ┆ 7    ┆ 181          │
│ APEUSDT      ┆ -1.605427    ┆ 8    ┆ 180          │
│ EGLDUSDT     ┆ -1.572433    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RVNUSDT      ┆ -0.10089     ┆ 179  ┆ 9            │
│ CELRUSDT     ┆ 0.010622     ┆ 180  ┆ 8            │
│ ATAUSDT      ┆ 0.052484     ┆ 181  ┆ 7            │
│ UNFIUSDT     ┆ 0.177156     ┆ 182  ┆ 6            │
│ CVXUSDT      ┆ 0.289008     ┆ 183  ┆ 5            │
│ BTCDOMUSDT   ┆ 0.323043     ┆ 184  ┆ 4            │
│ CKBUSDT      ┆ 0.490625     ┆ 185  ┆ 3            │
│ DGBUSDT      ┆ 0.616604     ┆ 186  ┆ 2            │
│ DEFIUSDT     ┆ 1.158        ┆ 187  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.515113     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:00,215 - WARNING - 2023-12-10T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:00,215 - INFO - cur close time: 2023-12-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:00,216 - DEBUG - mean expected ret (mean factor): -0.7678799657982794
2024-11-20 23:07:00,220 - DEBUG - begin to update pos: =========
2024-11-20 23:07:00,221 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,221 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0407      ┆ 0.20079     ┆ 0.0016055   ┆ … ┆ 0.02452 ┆ null   ┆ null    ┆ 0.4213  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,229 - DEBUG - update position: 2023-12-10T23:59:59.999 === diff_trading_value: 201587.40487161395 == cash: 149565.43921377993 
2024-11-20 23:07:00,230 - INFO - pnl: 2023-12-10T23:59:59.999 149565.43921377993 === -1.866%
2024-11-20 23:07:00,236 - DEBUG - cur time: 2023-12-11T23:59:59.999 == next bar open time: 2023-12-12T00:00:00.000 == close pos time: 2023-12-19T00:00:00.000
2024-11-20 23:07:00,239 - INFO - pnl: 2023-12-11T23:59:59.999 149052.83145732144 === -0.343%
2024-11-20 23:07:00,244 - DEBUG - cur time: 2023-12-12T23:59:59.999 == next bar open time: 2023-12-13T00:00:00.000 == close pos time: 2023-12-20T00:00:00.000
2024-11-20 23:07:00,246 - INFO - pnl: 2023-12-12T23:59:59.999 145328.80843520106 === -2.498%
2024-11-20 23:07:00,251 - DEBUG - cur time: 2023-12-13T23:59:59.999 == next bar open time: 2023-12-14T00:00:00.000 == close pos time: 2023-12-21T00:00:00.000
2024-11-20 23:07:00,253 - INFO - pnl: 2023-12-13T23:59:59.999 143639.43760997447 === -1.162%
2024-11-20 23:07:00,257 - DEBUG - cur time: 2023-12-14T23:59:59.999 == next bar open time: 2023-12-15T00:00:00.000 == close pos time: 2023-12-22T00:00:00.000
2024-11-20 23:07:00,259 - INFO - pnl: 2023-12-14T23:59:59.999 144297.15349892783 === 0.458%
2024-11-20 23:07:00,269 - DEBUG - cur time: 2023-12-15T23:59:59.999 == next bar open time: 2023-12-16T00:00:00.000 == close pos time: 2023-12-23T00:00:00.000
2024-11-20 23:07:00,271 - INFO - pnl: 2023-12-15T23:59:59.999 144462.16174413823 === 0.114%
2024-11-20 23:07:00,279 - DEBUG - cur time: 2023-12-16T23:59:59.999 == next bar open time: 2023-12-17T00:00:00.000 == close pos time: 2023-12-24T00:00:00.000
2024-11-20 23:07:00,281 - INFO - pnl: 2023-12-16T23:59:59.999 140409.1805776389 === -2.806%
2024-11-20 23:07:00,289 - DEBUG - cur time: 2023-12-17T23:59:59.999 == next bar open time: 2023-12-18T00:00:00.000 == close pos time: 2023-12-25T00:00:00.000
2024-11-20 23:07:00,301 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT      ┆ -1.699961    ┆ 0    ┆ 188          │
│ NMRUSDT      ┆ -1.587377    ┆ 1    ┆ 187          │
│ WAVESUSDT    ┆ -1.519998    ┆ 2    ┆ 186          │
│ EGLDUSDT     ┆ -1.466913    ┆ 3    ┆ 185          │
│ UNIUSDT      ┆ -1.457185    ┆ 4    ┆ 184          │
│ LPTUSDT      ┆ -1.440549    ┆ 5    ┆ 183          │
│ BLURUSDT     ┆ -1.404657    ┆ 6    ┆ 182          │
│ SANDUSDT     ┆ -1.388217    ┆ 7    ┆ 181          │
│ QTUMUSDT     ┆ -1.380935    ┆ 8    ┆ 180          │
│ ARKMUSDT     ┆ -1.351084    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SPELLUSDT    ┆ -0.035256    ┆ 179  ┆ 9            │
│ IDEXUSDT     ┆ 0.026311     ┆ 180  ┆ 8            │
│ TRUUSDT      ┆ 0.044094     ┆ 181  ┆ 7            │
│ DODOXUSDT    ┆ 0.061223     ┆ 182  ┆ 6            │
│ XVGUSDT      ┆ 0.069301     ┆ 183  ┆ 5            │
│ CVXUSDT      ┆ 0.191263     ┆ 184  ┆ 4            │
│ DGBUSDT      ┆ 0.34367      ┆ 185  ┆ 3            │
│ CKBUSDT      ┆ 0.685388     ┆ 186  ┆ 2            │
│ DEFIUSDT     ┆ 1.000835     ┆ 187  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.739413     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:00,315 - INFO - cur close time: 2023-12-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:00,316 - DEBUG - mean expected ret (mean factor): -0.7624645175169492
2024-11-20 23:07:00,323 - DEBUG - begin to update pos: =========
2024-11-20 23:07:00,323 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,324 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03617     ┆ 0.1621      ┆ 0.0013373   ┆ … ┆ 0.0231  ┆ null   ┆ null    ┆ 0.3728  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,335 - DEBUG - update position: 2023-12-17T23:59:59.999 === diff_trading_value: 287969.13767544646 == cash: 137181.09131643857 
2024-11-20 23:07:00,338 - INFO - pnl: 2023-12-17T23:59:59.999 137181.09131643857 === -2.299%
2024-11-20 23:07:00,343 - DEBUG - cur time: 2023-12-18T23:59:59.999 == next bar open time: 2023-12-19T00:00:00.000 == close pos time: 2023-12-26T00:00:00.000
2024-11-20 23:07:00,345 - INFO - pnl: 2023-12-18T23:59:59.999 140920.43846885656 === 2.726%
2024-11-20 23:07:00,350 - DEBUG - cur time: 2023-12-19T23:59:59.999 == next bar open time: 2023-12-20T00:00:00.000 == close pos time: 2023-12-27T00:00:00.000
2024-11-20 23:07:00,353 - INFO - pnl: 2023-12-19T23:59:59.999 138110.57632703322 === -1.994%
2024-11-20 23:07:00,358 - DEBUG - cur time: 2023-12-20T23:59:59.999 == next bar open time: 2023-12-21T00:00:00.000 == close pos time: 2023-12-28T00:00:00.000
2024-11-20 23:07:00,359 - INFO - pnl: 2023-12-20T23:59:59.999 136987.46710767297 === -0.813%
2024-11-20 23:07:00,363 - DEBUG - cur time: 2023-12-21T23:59:59.999 == next bar open time: 2023-12-22T00:00:00.000 == close pos time: 2023-12-29T00:00:00.000
2024-11-20 23:07:00,364 - INFO - pnl: 2023-12-21T23:59:59.999 137374.92139920543 === 0.283%
2024-11-20 23:07:00,371 - DEBUG - cur time: 2023-12-22T23:59:59.999 == next bar open time: 2023-12-23T00:00:00.000 == close pos time: 2023-12-30T00:00:00.000
2024-11-20 23:07:00,373 - INFO - pnl: 2023-12-22T23:59:59.999 140476.9643355699 === 2.258%
2024-11-20 23:07:00,383 - DEBUG - cur time: 2023-12-23T23:59:59.999 == next bar open time: 2023-12-24T00:00:00.000 == close pos time: 2023-12-31T00:00:00.000
2024-11-20 23:07:00,387 - INFO - pnl: 2023-12-23T23:59:59.999 141886.34886417742 === 1.003%
2024-11-20 23:07:00,394 - DEBUG - cur time: 2023-12-24T23:59:59.999 == next bar open time: 2023-12-25T00:00:00.000 == close pos time: 2024-01-01T00:00:00.000
2024-11-20 23:07:00,405 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -1.839206    ┆ 0    ┆ 188          │
│ EGLDUSDT     ┆ -1.749103    ┆ 1    ┆ 187          │
│ RUNEUSDT     ┆ -1.702874    ┆ 2    ┆ 186          │
│ UNIUSDT      ┆ -1.605673    ┆ 3    ┆ 185          │
│ CYBERUSDT    ┆ -1.58546     ┆ 4    ┆ 184          │
│ OPUSDT       ┆ -1.485912    ┆ 5    ┆ 183          │
│ XVSUSDT      ┆ -1.483855    ┆ 6    ┆ 182          │
│ AAVEUSDT     ┆ -1.436526    ┆ 7    ┆ 181          │
│ SANDUSDT     ┆ -1.4306      ┆ 8    ┆ 180          │
│ AXSUSDT      ┆ -1.428799    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ZECUSDT      ┆ 0.029851     ┆ 179  ┆ 9            │
│ ZENUSDT      ┆ 0.085381     ┆ 180  ┆ 8            │
│ DUSKUSDT     ┆ 0.142099     ┆ 181  ┆ 7            │
│ YFIUSDT      ┆ 0.148054     ┆ 182  ┆ 6            │
│ BTCDOMUSDT   ┆ 0.224291     ┆ 183  ┆ 5            │
│ CKBUSDT      ┆ 0.261397     ┆ 184  ┆ 4            │
│ DEFIUSDT     ┆ 0.330662     ┆ 185  ┆ 3            │
│ DGBUSDT      ┆ 0.401936     ┆ 186  ┆ 2            │
│ CVXUSDT      ┆ 0.55386      ┆ 187  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.995645     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:00,413 - WARNING - 2023-12-24T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:00,414 - INFO - cur close time: 2023-12-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:00,414 - DEBUG - mean expected ret (mean factor): -0.7746751483223971
2024-11-20 23:07:00,420 - DEBUG - begin to update pos: =========
2024-11-20 23:07:00,420 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,420 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03521     ┆ 0.15627     ┆ 0.0013746   ┆ … ┆ 0.02656 ┆ null   ┆ null    ┆ 0.3575  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,429 - DEBUG - update position: 2023-12-24T23:59:59.999 === diff_trading_value: 239008.996605862 == cash: 139809.89016748217 
2024-11-20 23:07:00,432 - INFO - pnl: 2023-12-24T23:59:59.999 139809.89016748217 === -1.463%
2024-11-20 23:07:00,439 - DEBUG - cur time: 2023-12-25T23:59:59.999 == next bar open time: 2023-12-26T00:00:00.000 == close pos time: 2024-01-02T00:00:00.000
2024-11-20 23:07:00,443 - INFO - pnl: 2023-12-25T23:59:59.999 138984.02838170403 === -0.591%
2024-11-20 23:07:00,450 - DEBUG - cur time: 2023-12-26T23:59:59.999 == next bar open time: 2023-12-27T00:00:00.000 == close pos time: 2024-01-03T00:00:00.000
2024-11-20 23:07:00,454 - INFO - pnl: 2023-12-26T23:59:59.999 142369.2513760573 === 2.436%
2024-11-20 23:07:00,459 - DEBUG - cur time: 2023-12-27T23:59:59.999 == next bar open time: 2023-12-28T00:00:00.000 == close pos time: 2024-01-04T00:00:00.000
2024-11-20 23:07:00,462 - INFO - pnl: 2023-12-27T23:59:59.999 142960.48722735123 === 0.415%
2024-11-20 23:07:00,466 - DEBUG - cur time: 2023-12-28T23:59:59.999 == next bar open time: 2023-12-29T00:00:00.000 == close pos time: 2024-01-05T00:00:00.000
2024-11-20 23:07:00,468 - INFO - pnl: 2023-12-28T23:59:59.999 142641.59043934886 === -0.223%
2024-11-20 23:07:00,471 - DEBUG - cur time: 2023-12-29T23:59:59.999 == next bar open time: 2023-12-30T00:00:00.000 == close pos time: 2024-01-06T00:00:00.000
2024-11-20 23:07:00,475 - INFO - pnl: 2023-12-29T23:59:59.999 140664.84715251907 === -1.386%
2024-11-20 23:07:00,479 - DEBUG - cur time: 2023-12-30T23:59:59.999 == next bar open time: 2023-12-31T00:00:00.000 == close pos time: 2024-01-07T00:00:00.000
2024-11-20 23:07:00,481 - INFO - pnl: 2023-12-30T23:59:59.999 142037.0218378675 === 0.975%
2024-11-20 23:07:00,486 - DEBUG - cur time: 2023-12-31T23:59:59.999 == next bar open time: 2024-01-01T00:00:00.000 == close pos time: 2024-01-08T00:00:00.000
2024-11-20 23:07:00,496 - DEBUG - sorted_long_factors: shape: (191, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ NMRUSDT      ┆ -2.027838    ┆ 0    ┆ 190          │
│ HOOKUSDT     ┆ -1.809712    ┆ 1    ┆ 189          │
│ GMTUSDT      ┆ -1.752564    ┆ 2    ┆ 188          │
│ FILUSDT      ┆ -1.737414    ┆ 3    ┆ 187          │
│ TRBUSDT      ┆ -1.701418    ┆ 4    ┆ 186          │
│ UNFIUSDT     ┆ -1.561193    ┆ 5    ┆ 185          │
│ CYBERUSDT    ┆ -1.504415    ┆ 6    ┆ 184          │
│ SANDUSDT     ┆ -1.48547     ┆ 7    ┆ 183          │
│ MASKUSDT     ┆ -1.456285    ┆ 8    ┆ 182          │
│ WLDUSDT      ┆ -1.44801     ┆ 9    ┆ 181          │
│ …            ┆ …            ┆ …    ┆ …            │
│ STGUSDT      ┆ -0.03997     ┆ 181  ┆ 9            │
│ FOOTBALLUSDT ┆ -0.024215    ┆ 182  ┆ 8            │
│ CTKUSDT      ┆ 0.005231     ┆ 183  ┆ 7            │
│ DGBUSDT      ┆ 0.186914     ┆ 184  ┆ 6            │
│ BTCDOMUSDT   ┆ 0.196285     ┆ 185  ┆ 5            │
│ CKBUSDT      ┆ 0.225243     ┆ 186  ┆ 4            │
│ NKNUSDT      ┆ 0.257197     ┆ 187  ┆ 3            │
│ CVXUSDT      ┆ 0.382122     ┆ 188  ┆ 2            │
│ COMBOUSDT    ┆ 0.538325     ┆ 189  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.077806     ┆ 190  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:00,505 - WARNING - 2023-12-31T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:00,505 - INFO - cur close time: 2023-12-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:00,505 - DEBUG - mean expected ret (mean factor): -0.7888612884083199
2024-11-20 23:07:00,511 - DEBUG - begin to update pos: =========
2024-11-20 23:07:00,511 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,511 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.035       ┆ 0.13877     ┆ 0.0012956   ┆ … ┆ 0.0248  ┆ null   ┆ null    ┆ 0.3721  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,520 - DEBUG - update position: 2023-12-31T23:59:59.999 === diff_trading_value: 284713.8617264067 == cash: 141388.4714089978 
2024-11-20 23:07:00,521 - INFO - pnl: 2023-12-31T23:59:59.999 141388.4714089978 === -0.457%
2024-11-20 23:07:00,527 - DEBUG - cur time: 2024-01-01T23:59:59.999 == next bar open time: 2024-01-02T00:00:00.000 == close pos time: 2024-01-09T00:00:00.000
2024-11-20 23:07:00,529 - INFO - pnl: 2024-01-01T23:59:59.999 140416.91087723465 === -0.687%
2024-11-20 23:07:00,533 - DEBUG - cur time: 2024-01-02T23:59:59.999 == next bar open time: 2024-01-03T00:00:00.000 == close pos time: 2024-01-10T00:00:00.000
2024-11-20 23:07:00,536 - INFO - pnl: 2024-01-02T23:59:59.999 140758.11068594447 === 0.243%
2024-11-20 23:07:00,542 - DEBUG - cur time: 2024-01-03T23:59:59.999 == next bar open time: 2024-01-04T00:00:00.000 == close pos time: 2024-01-11T00:00:00.000
2024-11-20 23:07:00,544 - INFO - pnl: 2024-01-03T23:59:59.999 147930.18056837603 === 5.095%
2024-11-20 23:07:00,550 - DEBUG - cur time: 2024-01-04T23:59:59.999 == next bar open time: 2024-01-05T00:00:00.000 == close pos time: 2024-01-12T00:00:00.000
2024-11-20 23:07:00,552 - INFO - pnl: 2024-01-04T23:59:59.999 147981.840583686 === 0.035%
2024-11-20 23:07:00,556 - DEBUG - cur time: 2024-01-05T23:59:59.999 == next bar open time: 2024-01-06T00:00:00.000 == close pos time: 2024-01-13T00:00:00.000
2024-11-20 23:07:00,558 - INFO - pnl: 2024-01-05T23:59:59.999 149048.60400899584 === 0.721%
2024-11-20 23:07:00,562 - DEBUG - cur time: 2024-01-06T23:59:59.999 == next bar open time: 2024-01-07T00:00:00.000 == close pos time: 2024-01-14T00:00:00.000
2024-11-20 23:07:00,564 - INFO - pnl: 2024-01-06T23:59:59.999 143541.09576807515 === -3.695%
2024-11-20 23:07:00,569 - DEBUG - cur time: 2024-01-07T23:59:59.999 == next bar open time: 2024-01-08T00:00:00.000 == close pos time: 2024-01-15T00:00:00.000
2024-11-20 23:07:00,581 - DEBUG - sorted_long_factors: shape: (193, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CYBERUSDT    ┆ -1.894737    ┆ 0    ┆ 192          │
│ YGGUSDT      ┆ -1.714967    ┆ 1    ┆ 191          │
│ WLDUSDT      ┆ -1.689973    ┆ 2    ┆ 190          │
│ MKRUSDT      ┆ -1.639696    ┆ 3    ┆ 189          │
│ GMTUSDT      ┆ -1.566088    ┆ 4    ┆ 188          │
│ STXUSDT      ┆ -1.557147    ┆ 5    ┆ 187          │
│ SSVUSDT      ┆ -1.547123    ┆ 6    ┆ 186          │
│ FILUSDT      ┆ -1.506959    ┆ 7    ┆ 185          │
│ PENDLEUSDT   ┆ -1.493193    ┆ 8    ┆ 184          │
│ OXTUSDT      ┆ -1.478628    ┆ 9    ┆ 183          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TLMUSDT      ┆ 0.092731     ┆ 183  ┆ 9            │
│ DEFIUSDT     ┆ 0.134227     ┆ 184  ┆ 8            │
│ ALICEUSDT    ┆ 0.195333     ┆ 185  ┆ 7            │
│ CTKUSDT      ┆ 0.201647     ┆ 186  ┆ 6            │
│ DGBUSDT      ┆ 0.251037     ┆ 187  ┆ 5            │
│ IDEXUSDT     ┆ 0.279394     ┆ 188  ┆ 4            │
│ CVXUSDT      ┆ 0.382848     ┆ 189  ┆ 3            │
│ DARUSDT      ┆ 0.444745     ┆ 190  ┆ 2            │
│ CKBUSDT      ┆ 0.692101     ┆ 191  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.256052     ┆ 192  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:00,589 - WARNING - 2024-01-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:00,589 - INFO - cur close time: 2024-01-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:00,589 - DEBUG - mean expected ret (mean factor): -0.7544034475979984
2024-11-20 23:07:00,593 - DEBUG - begin to update pos: =========
2024-11-20 23:07:00,594 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,594 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02914     ┆ 0.11238     ┆ 0.0011126   ┆ … ┆ 0.02114 ┆ null   ┆ null    ┆ 0.3094  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,601 - DEBUG - update position: 2024-01-07T23:59:59.999 === diff_trading_value: 211989.17366968456 == cash: 144035.27486760536 
2024-11-20 23:07:00,603 - INFO - pnl: 2024-01-07T23:59:59.999 144035.27486760536 === 0.344%
2024-11-20 23:07:00,607 - DEBUG - cur time: 2024-01-08T23:59:59.999 == next bar open time: 2024-01-09T00:00:00.000 == close pos time: 2024-01-16T00:00:00.000
2024-11-20 23:07:00,608 - INFO - pnl: 2024-01-08T23:59:59.999 144522.98523191203 === 0.339%
2024-11-20 23:07:00,612 - DEBUG - cur time: 2024-01-09T23:59:59.999 == next bar open time: 2024-01-10T00:00:00.000 == close pos time: 2024-01-17T00:00:00.000
2024-11-20 23:07:00,613 - INFO - pnl: 2024-01-09T23:59:59.999 145343.07052048127 === 0.567%
2024-11-20 23:07:00,619 - DEBUG - cur time: 2024-01-10T23:59:59.999 == next bar open time: 2024-01-11T00:00:00.000 == close pos time: 2024-01-18T00:00:00.000
2024-11-20 23:07:00,621 - INFO - pnl: 2024-01-10T23:59:59.999 144414.24575361435 === -0.639%
2024-11-20 23:07:00,630 - DEBUG - cur time: 2024-01-11T23:59:59.999 == next bar open time: 2024-01-12T00:00:00.000 == close pos time: 2024-01-19T00:00:00.000
2024-11-20 23:07:00,632 - INFO - pnl: 2024-01-11T23:59:59.999 141804.64889088043 === -1.807%
2024-11-20 23:07:00,641 - DEBUG - cur time: 2024-01-12T23:59:59.999 == next bar open time: 2024-01-13T00:00:00.000 == close pos time: 2024-01-20T00:00:00.000
2024-11-20 23:07:00,646 - INFO - pnl: 2024-01-12T23:59:59.999 139926.83099458014 === -1.324%
2024-11-20 23:07:00,655 - DEBUG - cur time: 2024-01-13T23:59:59.999 == next bar open time: 2024-01-14T00:00:00.000 == close pos time: 2024-01-21T00:00:00.000
2024-11-20 23:07:00,657 - INFO - pnl: 2024-01-13T23:59:59.999 141544.5583028957 === 1.156%
2024-11-20 23:07:00,663 - DEBUG - cur time: 2024-01-14T23:59:59.999 == next bar open time: 2024-01-15T00:00:00.000 == close pos time: 2024-01-22T00:00:00.000
2024-11-20 23:07:00,675 - DEBUG - sorted_long_factors: shape: (193, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT      ┆ -2.075079    ┆ 0    ┆ 192          │
│ CFXUSDT      ┆ -1.779616    ┆ 1    ┆ 191          │
│ BTCDOMUSDT   ┆ -1.765638    ┆ 2    ┆ 190          │
│ YGGUSDT      ┆ -1.679122    ┆ 3    ┆ 189          │
│ LPTUSDT      ┆ -1.678348    ┆ 4    ┆ 188          │
│ DYDXUSDT     ┆ -1.674365    ┆ 5    ┆ 187          │
│ ENSUSDT      ┆ -1.628109    ┆ 6    ┆ 186          │
│ LQTYUSDT     ┆ -1.567282    ┆ 7    ┆ 185          │
│ COMPUSDT     ┆ -1.502627    ┆ 8    ┆ 184          │
│ USDCUSDT     ┆ -1.489497    ┆ 9    ┆ 183          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ZECUSDT      ┆ 0.238484     ┆ 183  ┆ 9            │
│ DARUSDT      ┆ 0.277105     ┆ 184  ┆ 8            │
│ IDEXUSDT     ┆ 0.2975       ┆ 185  ┆ 7            │
│ CTKUSDT      ┆ 0.314106     ┆ 186  ┆ 6            │
│ DGBUSDT      ┆ 0.36292      ┆ 187  ┆ 5            │
│ CKBUSDT      ┆ 0.388132     ┆ 188  ┆ 4            │
│ COMBOUSDT    ┆ 0.54362      ┆ 189  ┆ 3            │
│ DODOXUSDT    ┆ 0.687114     ┆ 190  ┆ 2            │
│ DEFIUSDT     ┆ 0.944445     ┆ 191  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.014646     ┆ 192  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:00,689 - WARNING - 2024-01-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:00,689 - INFO - cur close time: 2024-01-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:00,689 - DEBUG - mean expected ret (mean factor): -0.730576897646098
2024-11-20 23:07:00,695 - DEBUG - begin to update pos: =========
2024-11-20 23:07:00,695 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,696 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03001     ┆ 0.11872     ┆ 0.001194    ┆ … ┆ 0.02128 ┆ null   ┆ null    ┆ 0.331   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,706 - DEBUG - update position: 2024-01-14T23:59:59.999 === diff_trading_value: 258894.6139216412 == cash: 141762.45592875534 
2024-11-20 23:07:00,710 - INFO - pnl: 2024-01-14T23:59:59.999 141762.45592875534 === 0.154%
2024-11-20 23:07:00,716 - DEBUG - cur time: 2024-01-15T23:59:59.999 == next bar open time: 2024-01-16T00:00:00.000 == close pos time: 2024-01-23T00:00:00.000
2024-11-20 23:07:00,720 - INFO - pnl: 2024-01-15T23:59:59.999 142867.7193348503 === 0.780%
2024-11-20 23:07:00,724 - DEBUG - cur time: 2024-01-16T23:59:59.999 == next bar open time: 2024-01-17T00:00:00.000 == close pos time: 2024-01-24T00:00:00.000
2024-11-20 23:07:00,727 - INFO - pnl: 2024-01-16T23:59:59.999 144610.66235079317 === 1.220%
2024-11-20 23:07:00,731 - DEBUG - cur time: 2024-01-17T23:59:59.999 == next bar open time: 2024-01-18T00:00:00.000 == close pos time: 2024-01-25T00:00:00.000
2024-11-20 23:07:00,736 - INFO - pnl: 2024-01-17T23:59:59.999 141552.43150194982 === -2.115%
2024-11-20 23:07:00,743 - DEBUG - cur time: 2024-01-18T23:59:59.999 == next bar open time: 2024-01-19T00:00:00.000 == close pos time: 2024-01-26T00:00:00.000
2024-11-20 23:07:00,747 - INFO - pnl: 2024-01-18T23:59:59.999 140761.79900539044 === -0.559%
2024-11-20 23:07:00,754 - DEBUG - cur time: 2024-01-19T23:59:59.999 == next bar open time: 2024-01-20T00:00:00.000 == close pos time: 2024-01-27T00:00:00.000
2024-11-20 23:07:00,758 - INFO - pnl: 2024-01-19T23:59:59.999 144976.7073753498 === 2.994%
2024-11-20 23:07:00,767 - DEBUG - cur time: 2024-01-20T23:59:59.999 == next bar open time: 2024-01-21T00:00:00.000 == close pos time: 2024-01-28T00:00:00.000
2024-11-20 23:07:00,773 - INFO - pnl: 2024-01-20T23:59:59.999 148617.61787429068 === 2.511%
2024-11-20 23:07:00,781 - DEBUG - cur time: 2024-01-21T23:59:59.999 == next bar open time: 2024-01-22T00:00:00.000 == close pos time: 2024-01-29T00:00:00.000
2024-11-20 23:07:00,797 - DEBUG - sorted_long_factors: shape: (196, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT   ┆ -2.131243    ┆ 0    ┆ 195          │
│ APEUSDT      ┆ -2.013552    ┆ 1    ┆ 194          │
│ MASKUSDT     ┆ -1.706948    ┆ 2    ┆ 193          │
│ WLDUSDT      ┆ -1.633069    ┆ 3    ┆ 192          │
│ INJUSDT      ┆ -1.545569    ┆ 4    ┆ 191          │
│ CFXUSDT      ┆ -1.535272    ┆ 5    ┆ 190          │
│ SEIUSDT      ┆ -1.533532    ┆ 6    ┆ 189          │
│ TRBUSDT      ┆ -1.490332    ┆ 7    ┆ 188          │
│ XMRUSDT      ┆ -1.477281    ┆ 8    ┆ 187          │
│ ASTRUSDT     ┆ -1.476105    ┆ 9    ┆ 186          │
│ …            ┆ …            ┆ …    ┆ …            │
│ PHBUSDT      ┆ 0.126012     ┆ 186  ┆ 9            │
│ BALUSDT      ┆ 0.166957     ┆ 187  ┆ 8            │
│ CKBUSDT      ┆ 0.264209     ┆ 188  ┆ 7            │
│ CTKUSDT      ┆ 0.273817     ┆ 189  ┆ 6            │
│ TRUUSDT      ┆ 0.301609     ┆ 190  ┆ 5            │
│ DODOXUSDT    ┆ 0.528399     ┆ 191  ┆ 4            │
│ TLMUSDT      ┆ 0.537864     ┆ 192  ┆ 3            │
│ DEFIUSDT     ┆ 0.678007     ┆ 193  ┆ 2            │
│ DGBUSDT      ┆ 0.788333     ┆ 194  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.338398     ┆ 195  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:00,809 - INFO - cur close time: 2024-01-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:00,809 - DEBUG - mean expected ret (mean factor): -0.7494471514591281
2024-11-20 23:07:00,814 - DEBUG - begin to update pos: =========
2024-11-20 23:07:00,815 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,815 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03112     ┆ 0.1084      ┆ 0.0011232   ┆ … ┆ 0.02161 ┆ null   ┆ null    ┆ 0.3186  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,824 - DEBUG - update position: 2024-01-21T23:59:59.999 === diff_trading_value: 245868.56478693284 == cash: 150023.99780640125 
2024-11-20 23:07:00,827 - INFO - pnl: 2024-01-21T23:59:59.999 150023.99780640125 === 0.946%
2024-11-20 23:07:00,832 - DEBUG - cur time: 2024-01-22T23:59:59.999 == next bar open time: 2024-01-23T00:00:00.000 == close pos time: 2024-01-30T00:00:00.000
2024-11-20 23:07:00,838 - INFO - pnl: 2024-01-22T23:59:59.999 150769.0596416748 === 0.497%
2024-11-20 23:07:00,846 - DEBUG - cur time: 2024-01-23T23:59:59.999 == next bar open time: 2024-01-24T00:00:00.000 == close pos time: 2024-01-31T00:00:00.000
2024-11-20 23:07:00,849 - INFO - pnl: 2024-01-23T23:59:59.999 148689.07672206787 === -1.380%
2024-11-20 23:07:00,863 - DEBUG - cur time: 2024-01-24T23:59:59.999 == next bar open time: 2024-01-25T00:00:00.000 == close pos time: 2024-02-01T00:00:00.000
2024-11-20 23:07:00,867 - INFO - pnl: 2024-01-24T23:59:59.999 148928.54078443747 === 0.161%
2024-11-20 23:07:00,873 - DEBUG - cur time: 2024-01-25T23:59:59.999 == next bar open time: 2024-01-26T00:00:00.000 == close pos time: 2024-02-02T00:00:00.000
2024-11-20 23:07:00,874 - INFO - pnl: 2024-01-25T23:59:59.999 149531.25325332565 === 0.405%
2024-11-20 23:07:00,881 - DEBUG - cur time: 2024-01-26T23:59:59.999 == next bar open time: 2024-01-27T00:00:00.000 == close pos time: 2024-02-03T00:00:00.000
2024-11-20 23:07:00,884 - INFO - pnl: 2024-01-26T23:59:59.999 146451.22711290367 === -2.060%
2024-11-20 23:07:00,891 - DEBUG - cur time: 2024-01-27T23:59:59.999 == next bar open time: 2024-01-28T00:00:00.000 == close pos time: 2024-02-04T00:00:00.000
2024-11-20 23:07:00,894 - INFO - pnl: 2024-01-27T23:59:59.999 147262.09085779474 === 0.554%
2024-11-20 23:07:00,900 - DEBUG - cur time: 2024-01-28T23:59:59.999 == next bar open time: 2024-01-29T00:00:00.000 == close pos time: 2024-02-05T00:00:00.000
2024-11-20 23:07:00,916 - DEBUG - sorted_long_factors: shape: (200, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CFXUSDT      ┆ -1.690584    ┆ 0    ┆ 199          │
│ OMGUSDT      ┆ -1.631778    ┆ 1    ┆ 198          │
│ MAGICUSDT    ┆ -1.568233    ┆ 2    ┆ 197          │
│ AMBUSDT      ┆ -1.565892    ┆ 3    ┆ 196          │
│ NMRUSDT      ┆ -1.509258    ┆ 4    ┆ 195          │
│ LOOMUSDT     ┆ -1.505255    ┆ 5    ┆ 194          │
│ BONDUSDT     ┆ -1.502248    ┆ 6    ┆ 193          │
│ STRAXUSDT    ┆ -1.501139    ┆ 7    ┆ 192          │
│ ARKUSDT      ┆ -1.485969    ┆ 8    ┆ 191          │
│ CYBERUSDT    ┆ -1.483737    ┆ 9    ┆ 190          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TRUUSDT      ┆ -0.039043    ┆ 190  ┆ 9            │
│ TLMUSDT      ┆ -0.032631    ┆ 191  ┆ 8            │
│ ENSUSDT      ┆ -0.009836    ┆ 192  ┆ 7            │
│ CVXUSDT      ┆ 0.081018     ┆ 193  ┆ 6            │
│ QNTUSDT      ┆ 0.129194     ┆ 194  ┆ 5            │
│ CKBUSDT      ┆ 0.145381     ┆ 195  ┆ 4            │
│ DGBUSDT      ┆ 0.198481     ┆ 196  ┆ 3            │
│ DEFIUSDT     ┆ 0.442953     ┆ 197  ┆ 2            │
│ DODOXUSDT    ┆ 1.065104     ┆ 198  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.072681     ┆ 199  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:00,924 - INFO - cur close time: 2024-01-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:00,925 - DEBUG - mean expected ret (mean factor): -0.779157048941104
2024-11-20 23:07:00,930 - DEBUG - begin to update pos: =========
2024-11-20 23:07:00,930 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,930 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0285      ┆ 0.09909     ┆ 0.0010658   ┆ … ┆ 0.02042 ┆ null   ┆ null    ┆ 0.3481  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:00,937 - DEBUG - update position: 2024-01-28T23:59:59.999 === diff_trading_value: 280283.6344421765 == cash: 145260.68778533803 
2024-11-20 23:07:00,938 - INFO - pnl: 2024-01-28T23:59:59.999 145260.68778533803 === -1.359%
2024-11-20 23:07:00,941 - DEBUG - cur time: 2024-01-29T23:59:59.999 == next bar open time: 2024-01-30T00:00:00.000 == close pos time: 2024-02-06T00:00:00.000
2024-11-20 23:07:00,944 - INFO - pnl: 2024-01-29T23:59:59.999 145232.75934499354 === -0.019%
2024-11-20 23:07:00,949 - DEBUG - cur time: 2024-01-30T23:59:59.999 == next bar open time: 2024-01-31T00:00:00.000 == close pos time: 2024-02-07T00:00:00.000
2024-11-20 23:07:00,951 - INFO - pnl: 2024-01-30T23:59:59.999 145038.77369168994 === -0.134%
2024-11-20 23:07:00,954 - DEBUG - cur time: 2024-01-31T23:59:59.999 == next bar open time: 2024-02-01T00:00:00.000 == close pos time: 2024-02-08T00:00:00.000
2024-11-20 23:07:00,956 - INFO - pnl: 2024-01-31T23:59:59.999 146392.48188696522 === 0.933%
2024-11-20 23:07:00,960 - DEBUG - cur time: 2024-02-01T23:59:59.999 == next bar open time: 2024-02-02T00:00:00.000 == close pos time: 2024-02-09T00:00:00.000
2024-11-20 23:07:00,963 - INFO - pnl: 2024-02-01T23:59:59.999 145797.38642130172 === -0.407%
2024-11-20 23:07:00,968 - DEBUG - cur time: 2024-02-02T23:59:59.999 == next bar open time: 2024-02-03T00:00:00.000 == close pos time: 2024-02-10T00:00:00.000
2024-11-20 23:07:00,971 - INFO - pnl: 2024-02-02T23:59:59.999 143841.6822196567 === -1.341%
2024-11-20 23:07:00,974 - DEBUG - cur time: 2024-02-03T23:59:59.999 == next bar open time: 2024-02-04T00:00:00.000 == close pos time: 2024-02-11T00:00:00.000
2024-11-20 23:07:00,977 - INFO - pnl: 2024-02-03T23:59:59.999 144558.61329346726 === 0.498%
2024-11-20 23:07:00,983 - DEBUG - cur time: 2024-02-04T23:59:59.999 == next bar open time: 2024-02-05T00:00:00.000 == close pos time: 2024-02-12T00:00:00.000
2024-11-20 23:07:00,993 - DEBUG - sorted_long_factors: shape: (204, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XMRUSDT      ┆ -1.93098     ┆ 0    ┆ 203          │
│ WLDUSDT      ┆ -1.89104     ┆ 1    ┆ 202          │
│ OPUSDT       ┆ -1.87528     ┆ 2    ┆ 201          │
│ GASUSDT      ┆ -1.630957    ┆ 3    ┆ 200          │
│ BSVUSDT      ┆ -1.62416     ┆ 4    ┆ 199          │
│ STRAXUSDT    ┆ -1.556967    ┆ 5    ┆ 198          │
│ UMAUSDT      ┆ -1.524276    ┆ 6    ┆ 197          │
│ EGLDUSDT     ┆ -1.500948    ┆ 7    ┆ 196          │
│ SEIUSDT      ┆ -1.469098    ┆ 8    ┆ 195          │
│ INJUSDT      ┆ -1.454377    ┆ 9    ┆ 194          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BTCDOMUSDT   ┆ -0.067718    ┆ 194  ┆ 9            │
│ TRUUSDT      ┆ 0.062575     ┆ 195  ┆ 8            │
│ BELUSDT      ┆ 0.083114     ┆ 196  ┆ 7            │
│ QNTUSDT      ┆ 0.214888     ┆ 197  ┆ 6            │
│ BICOUSDT     ┆ 0.242874     ┆ 198  ┆ 5            │
│ TLMUSDT      ┆ 0.273858     ┆ 199  ┆ 4            │
│ DGBUSDT      ┆ 0.297523     ┆ 200  ┆ 3            │
│ IDEXUSDT     ┆ 0.304256     ┆ 201  ┆ 2            │
│ DODOXUSDT    ┆ 0.799072     ┆ 202  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.274161     ┆ 203  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:01,002 - INFO - cur close time: 2024-02-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:01,002 - DEBUG - mean expected ret (mean factor): -0.7781498495688601
2024-11-20 23:07:01,007 - DEBUG - begin to update pos: =========
2024-11-20 23:07:01,008 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,008 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02732     ┆ 0.10432     ┆ 0.0008881   ┆ … ┆ 0.01977 ┆ null   ┆ null    ┆ 0.3119  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,014 - DEBUG - update position: 2024-02-04T23:59:59.999 === diff_trading_value: 265953.39435873873 == cash: 142923.27060856222 
2024-11-20 23:07:01,016 - INFO - pnl: 2024-02-04T23:59:59.999 142923.27060856222 === -1.131%
2024-11-20 23:07:01,020 - DEBUG - cur time: 2024-02-05T23:59:59.999 == next bar open time: 2024-02-06T00:00:00.000 == close pos time: 2024-02-13T00:00:00.000
2024-11-20 23:07:01,022 - INFO - pnl: 2024-02-05T23:59:59.999 142459.98153519738 === -0.324%
2024-11-20 23:07:01,026 - DEBUG - cur time: 2024-02-06T23:59:59.999 == next bar open time: 2024-02-07T00:00:00.000 == close pos time: 2024-02-14T00:00:00.000
2024-11-20 23:07:01,027 - INFO - pnl: 2024-02-06T23:59:59.999 146423.84581479823 === 2.782%
2024-11-20 23:07:01,033 - DEBUG - cur time: 2024-02-07T23:59:59.999 == next bar open time: 2024-02-08T00:00:00.000 == close pos time: 2024-02-15T00:00:00.000
2024-11-20 23:07:01,035 - INFO - pnl: 2024-02-07T23:59:59.999 149546.32123387 === 2.132%
2024-11-20 23:07:01,039 - DEBUG - cur time: 2024-02-08T23:59:59.999 == next bar open time: 2024-02-09T00:00:00.000 == close pos time: 2024-02-16T00:00:00.000
2024-11-20 23:07:01,041 - INFO - pnl: 2024-02-08T23:59:59.999 150671.6919244179 === 0.753%
2024-11-20 23:07:01,048 - DEBUG - cur time: 2024-02-09T23:59:59.999 == next bar open time: 2024-02-10T00:00:00.000 == close pos time: 2024-02-17T00:00:00.000
2024-11-20 23:07:01,051 - INFO - pnl: 2024-02-09T23:59:59.999 152120.914569686 === 0.962%
2024-11-20 23:07:01,056 - DEBUG - cur time: 2024-02-10T23:59:59.999 == next bar open time: 2024-02-11T00:00:00.000 == close pos time: 2024-02-18T00:00:00.000
2024-11-20 23:07:01,058 - INFO - pnl: 2024-02-10T23:59:59.999 153318.629900399 === 0.787%
2024-11-20 23:07:01,064 - DEBUG - cur time: 2024-02-11T23:59:59.999 == next bar open time: 2024-02-12T00:00:00.000 == close pos time: 2024-02-19T00:00:00.000
2024-11-20 23:07:01,075 - DEBUG - sorted_long_factors: shape: (209, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ UMAUSDT      ┆ -1.896054    ┆ 0    ┆ 208          │
│ NEARUSDT     ┆ -1.841663    ┆ 1    ┆ 207          │
│ OPUSDT       ┆ -1.782923    ┆ 2    ┆ 206          │
│ RUNEUSDT     ┆ -1.776142    ┆ 3    ┆ 205          │
│ BSVUSDT      ┆ -1.730612    ┆ 4    ┆ 204          │
│ MASKUSDT     ┆ -1.697771    ┆ 5    ┆ 203          │
│ GASUSDT      ┆ -1.666236    ┆ 6    ┆ 202          │
│ INJUSDT      ┆ -1.630029    ┆ 7    ┆ 201          │
│ TIAUSDT      ┆ -1.562572    ┆ 8    ┆ 200          │
│ NMRUSDT      ┆ -1.535808    ┆ 9    ┆ 199          │
│ …            ┆ …            ┆ …    ┆ …            │
│ KEYUSDT      ┆ 0.208963     ┆ 199  ┆ 9            │
│ ATAUSDT      ┆ 0.254643     ┆ 200  ┆ 8            │
│ TRUUSDT      ┆ 0.348373     ┆ 201  ┆ 7            │
│ ARUSDT       ┆ 0.507837     ┆ 202  ┆ 6            │
│ XVGUSDT      ┆ 0.513827     ┆ 203  ┆ 5            │
│ DEFIUSDT     ┆ 0.561243     ┆ 204  ┆ 4            │
│ DODOXUSDT    ┆ 0.624564     ┆ 205  ┆ 3            │
│ DGBUSDT      ┆ 0.887974     ┆ 206  ┆ 2            │
│ COMBOUSDT    ┆ 0.940162     ┆ 207  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.21081      ┆ 208  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:01,083 - WARNING - 2024-02-11T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:01,083 - INFO - cur close time: 2024-02-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:01,084 - DEBUG - mean expected ret (mean factor): -0.7463222552100561
2024-11-20 23:07:01,088 - DEBUG - begin to update pos: =========
2024-11-20 23:07:01,089 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,089 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03086     ┆ 0.1139      ┆ 0.0010054   ┆ … ┆ 0.02104 ┆ null   ┆ null    ┆ 0.3196  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,101 - DEBUG - update position: 2024-02-11T23:59:59.999 === diff_trading_value: 221440.3800943934 == cash: 151099.32797056963 
2024-11-20 23:07:01,103 - INFO - pnl: 2024-02-11T23:59:59.999 151099.32797056963 === -1.448%
2024-11-20 23:07:01,109 - DEBUG - cur time: 2024-02-12T23:59:59.999 == next bar open time: 2024-02-13T00:00:00.000 == close pos time: 2024-02-20T00:00:00.000
2024-11-20 23:07:01,111 - INFO - pnl: 2024-02-12T23:59:59.999 150101.72891138843 === -0.660%
2024-11-20 23:07:01,118 - DEBUG - cur time: 2024-02-13T23:59:59.999 == next bar open time: 2024-02-14T00:00:00.000 == close pos time: 2024-02-21T00:00:00.000
2024-11-20 23:07:01,120 - INFO - pnl: 2024-02-13T23:59:59.999 155075.61728097755 === 3.314%
2024-11-20 23:07:01,124 - DEBUG - cur time: 2024-02-14T23:59:59.999 == next bar open time: 2024-02-15T00:00:00.000 == close pos time: 2024-02-22T00:00:00.000
2024-11-20 23:07:01,126 - INFO - pnl: 2024-02-14T23:59:59.999 156862.90216481296 === 1.153%
2024-11-20 23:07:01,130 - DEBUG - cur time: 2024-02-15T23:59:59.999 == next bar open time: 2024-02-16T00:00:00.000 == close pos time: 2024-02-23T00:00:00.000
2024-11-20 23:07:01,131 - INFO - pnl: 2024-02-15T23:59:59.999 160377.4498439305 === 2.241%
2024-11-20 23:07:01,136 - DEBUG - cur time: 2024-02-16T23:59:59.999 == next bar open time: 2024-02-17T00:00:00.000 == close pos time: 2024-02-24T00:00:00.000
2024-11-20 23:07:01,138 - INFO - pnl: 2024-02-16T23:59:59.999 162228.67374716053 === 1.154%
2024-11-20 23:07:01,142 - DEBUG - cur time: 2024-02-17T23:59:59.999 == next bar open time: 2024-02-18T00:00:00.000 == close pos time: 2024-02-25T00:00:00.000
2024-11-20 23:07:01,143 - INFO - pnl: 2024-02-17T23:59:59.999 162839.431710143 === 0.376%
2024-11-20 23:07:01,147 - DEBUG - cur time: 2024-02-18T23:59:59.999 == next bar open time: 2024-02-19T00:00:00.000 == close pos time: 2024-02-26T00:00:00.000
2024-11-20 23:07:01,159 - DEBUG - sorted_long_factors: shape: (215, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -1.768831    ┆ 0    ┆ 214          │
│ MKRUSDT      ┆ -1.759085    ┆ 1    ┆ 213          │
│ CYBERUSDT    ┆ -1.68928     ┆ 2    ┆ 212          │
│ GASUSDT      ┆ -1.686279    ┆ 3    ┆ 211          │
│ FILUSDT      ┆ -1.628905    ┆ 4    ┆ 210          │
│ NMRUSDT      ┆ -1.58306     ┆ 5    ┆ 209          │
│ TRBUSDT      ┆ -1.55745     ┆ 6    ┆ 208          │
│ OPUSDT       ┆ -1.538327    ┆ 7    ┆ 207          │
│ SEIUSDT      ┆ -1.537879    ┆ 8    ┆ 206          │
│ NEOUSDT      ┆ -1.537006    ┆ 9    ┆ 205          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CELRUSDT     ┆ -0.050411    ┆ 205  ┆ 9            │
│ REEFUSDT     ┆ -0.037411    ┆ 206  ┆ 8            │
│ ATAUSDT      ┆ -0.030391    ┆ 207  ┆ 7            │
│ CVXUSDT      ┆ 0.018078     ┆ 208  ┆ 6            │
│ XVGUSDT      ┆ 0.12428      ┆ 209  ┆ 5            │
│ TLMUSDT      ┆ 0.135944     ┆ 210  ┆ 4            │
│ COMBOUSDT    ┆ 0.378147     ┆ 211  ┆ 3            │
│ DGBUSDT      ┆ 0.54957      ┆ 212  ┆ 2            │
│ DEFIUSDT     ┆ 1.238339     ┆ 213  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.072799     ┆ 214  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:01,167 - WARNING - 2024-02-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:01,167 - INFO - cur close time: 2024-02-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:01,168 - DEBUG - mean expected ret (mean factor): -0.7864625079649206
2024-11-20 23:07:01,174 - DEBUG - begin to update pos: =========
2024-11-20 23:07:01,175 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,176 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03398     ┆ 0.12999     ┆ 0.0012256   ┆ … ┆ 0.02371 ┆ null   ┆ null    ┆ 0.3557  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,196 - DEBUG - update position: 2024-02-18T23:59:59.999 === diff_trading_value: 248767.81441524584 == cash: 161851.83751636822 
2024-11-20 23:07:01,199 - INFO - pnl: 2024-02-18T23:59:59.999 161851.83751636822 === -0.606%
2024-11-20 23:07:01,206 - DEBUG - cur time: 2024-02-19T23:59:59.999 == next bar open time: 2024-02-20T00:00:00.000 == close pos time: 2024-02-27T00:00:00.000
2024-11-20 23:07:01,208 - INFO - pnl: 2024-02-19T23:59:59.999 161041.53656198943 === -0.501%
2024-11-20 23:07:01,215 - DEBUG - cur time: 2024-02-20T23:59:59.999 == next bar open time: 2024-02-21T00:00:00.000 == close pos time: 2024-02-28T00:00:00.000
2024-11-20 23:07:01,218 - INFO - pnl: 2024-02-20T23:59:59.999 161253.94334195965 === 0.132%
2024-11-20 23:07:01,224 - DEBUG - cur time: 2024-02-21T23:59:59.999 == next bar open time: 2024-02-22T00:00:00.000 == close pos time: 2024-02-29T00:00:00.000
2024-11-20 23:07:01,228 - INFO - pnl: 2024-02-21T23:59:59.999 163215.33690289443 === 1.216%
2024-11-20 23:07:01,239 - DEBUG - cur time: 2024-02-22T23:59:59.999 == next bar open time: 2024-02-23T00:00:00.000 == close pos time: 2024-03-01T00:00:00.000
2024-11-20 23:07:01,243 - INFO - pnl: 2024-02-22T23:59:59.999 168706.3856190845 === 3.364%
2024-11-20 23:07:01,255 - DEBUG - cur time: 2024-02-23T23:59:59.999 == next bar open time: 2024-02-24T00:00:00.000 == close pos time: 2024-03-02T00:00:00.000
2024-11-20 23:07:01,258 - INFO - pnl: 2024-02-23T23:59:59.999 168854.47258859218 === 0.088%
2024-11-20 23:07:01,264 - DEBUG - cur time: 2024-02-24T23:59:59.999 == next bar open time: 2024-02-25T00:00:00.000 == close pos time: 2024-03-03T00:00:00.000
2024-11-20 23:07:01,265 - INFO - pnl: 2024-02-24T23:59:59.999 172286.52395761586 === 2.033%
2024-11-20 23:07:01,273 - DEBUG - cur time: 2024-02-25T23:59:59.999 == next bar open time: 2024-02-26T00:00:00.000 == close pos time: 2024-03-04T00:00:00.000
2024-11-20 23:07:01,286 - DEBUG - sorted_long_factors: shape: (218, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ENSUSDT      ┆ -1.872207    ┆ 0    ┆ 217          │
│ OPUSDT       ┆ -1.851899    ┆ 1    ┆ 216          │
│ APTUSDT      ┆ -1.825279    ┆ 2    ┆ 215          │
│ TRBUSDT      ┆ -1.788764    ┆ 3    ┆ 214          │
│ TIAUSDT      ┆ -1.762772    ┆ 4    ┆ 213          │
│ DOTUSDT      ┆ -1.716087    ┆ 5    ┆ 212          │
│ ORDIUSDT     ┆ -1.680266    ┆ 6    ┆ 211          │
│ UNFIUSDT     ┆ -1.623093    ┆ 7    ┆ 210          │
│ CYBERUSDT    ┆ -1.621661    ┆ 8    ┆ 209          │
│ GASUSDT      ┆ -1.5714      ┆ 9    ┆ 208          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ 0.108072     ┆ 208  ┆ 9            │
│ AGLDUSDT     ┆ 0.110951     ┆ 209  ┆ 8            │
│ BICOUSDT     ┆ 0.210153     ┆ 210  ┆ 7            │
│ TLMUSDT      ┆ 0.228714     ┆ 211  ┆ 6            │
│ COMBOUSDT    ┆ 0.399893     ┆ 212  ┆ 5            │
│ DEFIUSDT     ┆ 0.674246     ┆ 213  ┆ 4            │
│ DGBUSDT      ┆ 0.735427     ┆ 214  ┆ 3            │
│ XVGUSDT      ┆ 0.853117     ┆ 215  ┆ 2            │
│ BTCDOMUSDT   ┆ 0.995314     ┆ 216  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.576189     ┆ 217  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:01,293 - WARNING - 2024-02-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:01,293 - INFO - cur close time: 2024-02-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:01,293 - DEBUG - mean expected ret (mean factor): -0.770564190776685
2024-11-20 23:07:01,299 - DEBUG - begin to update pos: =========
2024-11-20 23:07:01,300 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,301 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03675     ┆ 0.13118     ┆ 0.0013779   ┆ … ┆ 0.02576 ┆ null   ┆ null    ┆ 0.3717  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,307 - DEBUG - update position: 2024-02-25T23:59:59.999 === diff_trading_value: 252314.69231852287 == cash: 179473.06258735186 
2024-11-20 23:07:01,312 - INFO - pnl: 2024-02-25T23:59:59.999 179473.06258735186 === 4.171%
2024-11-20 23:07:01,319 - DEBUG - cur time: 2024-02-26T23:59:59.999 == next bar open time: 2024-02-27T00:00:00.000 == close pos time: 2024-03-05T00:00:00.000
2024-11-20 23:07:01,321 - INFO - pnl: 2024-02-26T23:59:59.999 184860.29720313242 === 3.002%
2024-11-20 23:07:01,328 - DEBUG - cur time: 2024-02-27T23:59:59.999 == next bar open time: 2024-02-28T00:00:00.000 == close pos time: 2024-03-06T00:00:00.000
2024-11-20 23:07:01,330 - INFO - pnl: 2024-02-27T23:59:59.999 184635.30020778414 === -0.122%
2024-11-20 23:07:01,337 - DEBUG - cur time: 2024-02-28T23:59:59.999 == next bar open time: 2024-02-29T00:00:00.000 == close pos time: 2024-03-07T00:00:00.000
2024-11-20 23:07:01,339 - INFO - pnl: 2024-02-28T23:59:59.999 183721.03943744203 === -0.495%
2024-11-20 23:07:01,344 - DEBUG - cur time: 2024-02-29T23:59:59.999 == next bar open time: 2024-03-01T00:00:00.000 == close pos time: 2024-03-08T00:00:00.000
2024-11-20 23:07:01,346 - INFO - pnl: 2024-02-29T23:59:59.999 185619.75322413965 === 1.033%
2024-11-20 23:07:01,350 - DEBUG - cur time: 2024-03-01T23:59:59.999 == next bar open time: 2024-03-02T00:00:00.000 == close pos time: 2024-03-09T00:00:00.000
2024-11-20 23:07:01,352 - INFO - pnl: 2024-03-01T23:59:59.999 189661.73965604202 === 2.178%
2024-11-20 23:07:01,359 - DEBUG - cur time: 2024-03-02T23:59:59.999 == next bar open time: 2024-03-03T00:00:00.000 == close pos time: 2024-03-10T00:00:00.000
2024-11-20 23:07:01,363 - INFO - pnl: 2024-03-02T23:59:59.999 189544.3265981245 === -0.062%
2024-11-20 23:07:01,375 - DEBUG - cur time: 2024-03-03T23:59:59.999 == next bar open time: 2024-03-04T00:00:00.000 == close pos time: 2024-03-11T00:00:00.000
2024-11-20 23:07:01,400 - DEBUG - sorted_long_factors: shape: (222, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT     ┆ -2.108991    ┆ 0    ┆ 221          │
│ ARBUSDT      ┆ -1.818141    ┆ 1    ┆ 220          │
│ IMXUSDT      ┆ -1.799389    ┆ 2    ┆ 219          │
│ SSVUSDT      ┆ -1.732208    ┆ 3    ┆ 218          │
│ BNBUSDT      ┆ -1.731267    ┆ 4    ┆ 217          │
│ STXUSDT      ┆ -1.662163    ┆ 5    ┆ 216          │
│ OPUSDT       ┆ -1.627009    ┆ 6    ┆ 215          │
│ EGLDUSDT     ┆ -1.60256     ┆ 7    ┆ 214          │
│ WLDUSDT      ┆ -1.602174    ┆ 8    ┆ 213          │
│ ICPUSDT      ┆ -1.59598     ┆ 9    ┆ 212          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CELOUSDT     ┆ -0.145622    ┆ 212  ┆ 9            │
│ REEFUSDT     ┆ -0.107154    ┆ 213  ┆ 8            │
│ DGBUSDT      ┆ -0.002148    ┆ 214  ┆ 7            │
│ BALUSDT      ┆ 0.089757     ┆ 215  ┆ 6            │
│ DODOXUSDT    ┆ 0.097057     ┆ 216  ┆ 5            │
│ CTKUSDT      ┆ 0.219924     ┆ 217  ┆ 4            │
│ OXTUSDT      ┆ 0.401834     ┆ 218  ┆ 3            │
│ FOOTBALLUSDT ┆ 1.2696       ┆ 219  ┆ 2            │
│ DEFIUSDT     ┆ 1.797282     ┆ 220  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.888431     ┆ 221  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:01,407 - WARNING - 2024-03-03T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:01,407 - INFO - cur close time: 2024-03-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:01,408 - DEBUG - mean expected ret (mean factor): -0.7647521629701777
2024-11-20 23:07:01,412 - DEBUG - begin to update pos: =========
2024-11-20 23:07:01,413 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,413 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.027227    ┆ 0.14651     ┆ 0.18078     ┆ 0.0059289   ┆ … ┆ 0.03028 ┆ null   ┆ null    ┆ 0.4202  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,421 - DEBUG - update position: 2024-03-03T23:59:59.999 === diff_trading_value: 284771.42774696404 == cash: 191586.49176381994 
2024-11-20 23:07:01,422 - INFO - pnl: 2024-03-03T23:59:59.999 191586.49176381994 === 1.077%
2024-11-20 23:07:01,427 - DEBUG - cur time: 2024-03-04T23:59:59.999 == next bar open time: 2024-03-05T00:00:00.000 == close pos time: 2024-03-12T00:00:00.000
2024-11-20 23:07:01,430 - INFO - pnl: 2024-03-04T23:59:59.999 194632.1635528455 === 1.590%
2024-11-20 23:07:01,436 - DEBUG - cur time: 2024-03-05T23:59:59.999 == next bar open time: 2024-03-06T00:00:00.000 == close pos time: 2024-03-13T00:00:00.000
2024-11-20 23:07:01,439 - INFO - pnl: 2024-03-05T23:59:59.999 190944.90430744103 === -1.894%
2024-11-20 23:07:01,444 - DEBUG - cur time: 2024-03-06T23:59:59.999 == next bar open time: 2024-03-07T00:00:00.000 == close pos time: 2024-03-14T00:00:00.000
2024-11-20 23:07:01,447 - INFO - pnl: 2024-03-06T23:59:59.999 194914.26702566122 === 2.079%
2024-11-20 23:07:01,451 - DEBUG - cur time: 2024-03-07T23:59:59.999 == next bar open time: 2024-03-08T00:00:00.000 == close pos time: 2024-03-15T00:00:00.000
2024-11-20 23:07:01,455 - INFO - pnl: 2024-03-07T23:59:59.999 194964.64003287285 === 0.026%
2024-11-20 23:07:01,460 - DEBUG - cur time: 2024-03-08T23:59:59.999 == next bar open time: 2024-03-09T00:00:00.000 == close pos time: 2024-03-16T00:00:00.000
2024-11-20 23:07:01,462 - INFO - pnl: 2024-03-08T23:59:59.999 195411.87466801645 === 0.229%
2024-11-20 23:07:01,466 - DEBUG - cur time: 2024-03-09T23:59:59.999 == next bar open time: 2024-03-10T00:00:00.000 == close pos time: 2024-03-17T00:00:00.000
2024-11-20 23:07:01,468 - INFO - pnl: 2024-03-09T23:59:59.999 191766.80585045545 === -1.865%
2024-11-20 23:07:01,473 - DEBUG - cur time: 2024-03-10T23:59:59.999 == next bar open time: 2024-03-11T00:00:00.000 == close pos time: 2024-03-18T00:00:00.000
2024-11-20 23:07:01,483 - DEBUG - sorted_long_factors: shape: (225, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT     ┆ -2.159133    ┆ 0    ┆ 224          │
│ STXUSDT      ┆ -1.844824    ┆ 1    ┆ 223          │
│ GASUSDT      ┆ -1.73298     ┆ 2    ┆ 222          │
│ CAKEUSDT     ┆ -1.657493    ┆ 3    ┆ 221          │
│ APEUSDT      ┆ -1.619315    ┆ 4    ┆ 220          │
│ AXSUSDT      ┆ -1.616854    ┆ 5    ┆ 219          │
│ XMRUSDT      ┆ -1.604958    ┆ 6    ┆ 218          │
│ MEMEUSDT     ┆ -1.47691     ┆ 7    ┆ 217          │
│ MATICUSDT    ┆ -1.412741    ┆ 8    ┆ 216          │
│ POLYXUSDT    ┆ -1.370126    ┆ 9    ┆ 215          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BALUSDT      ┆ 0.00937      ┆ 215  ┆ 9            │
│ DGBUSDT      ┆ 0.013864     ┆ 216  ┆ 8            │
│ CELOUSDT     ┆ 0.037093     ┆ 217  ┆ 7            │
│ COMBOUSDT    ┆ 0.053647     ┆ 218  ┆ 6            │
│ DODOXUSDT    ┆ 0.14029      ┆ 219  ┆ 5            │
│ FOOTBALLUSDT ┆ 0.149056     ┆ 220  ┆ 4            │
│ ARUSDT       ┆ 0.235865     ┆ 221  ┆ 3            │
│ IDEXUSDT     ┆ 0.711707     ┆ 222  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.846617     ┆ 223  ┆ 1            │
│ DEFIUSDT     ┆ 1.920949     ┆ 224  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:01,491 - WARNING - 2024-03-10T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:01,491 - INFO - cur close time: 2024-03-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:01,491 - DEBUG - mean expected ret (mean factor): -0.7754984234348025
2024-11-20 23:07:01,496 - DEBUG - begin to update pos: =========
2024-11-20 23:07:01,497 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,497 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.031026    ┆ 0.27274     ┆ 0.18821     ┆ 0.0085492   ┆ … ┆ 0.03609 ┆ null   ┆ null    ┆ 0.8006  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,509 - DEBUG - update position: 2024-03-10T23:59:59.999 === diff_trading_value: 267387.80992852437 == cash: 193688.2911054248 
2024-11-20 23:07:01,511 - INFO - pnl: 2024-03-10T23:59:59.999 193688.2911054248 === 1.002%
2024-11-20 23:07:01,516 - DEBUG - cur time: 2024-03-11T23:59:59.999 == next bar open time: 2024-03-12T00:00:00.000 == close pos time: 2024-03-19T00:00:00.000
2024-11-20 23:07:01,519 - INFO - pnl: 2024-03-11T23:59:59.999 197614.53383033274 === 2.027%
2024-11-20 23:07:01,521 - DEBUG - cur time: 2024-03-12T23:59:59.999 == next bar open time: 2024-03-13T00:00:00.000 == close pos time: 2024-03-20T00:00:00.000
2024-11-20 23:07:01,523 - INFO - pnl: 2024-03-12T23:59:59.999 198159.80992613768 === 0.276%
2024-11-20 23:07:01,528 - DEBUG - cur time: 2024-03-13T23:59:59.999 == next bar open time: 2024-03-14T00:00:00.000 == close pos time: 2024-03-21T00:00:00.000
2024-11-20 23:07:01,530 - INFO - pnl: 2024-03-13T23:59:59.999 194938.55332321837 === -1.626%
2024-11-20 23:07:01,535 - DEBUG - cur time: 2024-03-14T23:59:59.999 == next bar open time: 2024-03-15T00:00:00.000 == close pos time: 2024-03-22T00:00:00.000
2024-11-20 23:07:01,537 - INFO - pnl: 2024-03-14T23:59:59.999 196854.44772948395 === 0.983%
2024-11-20 23:07:01,539 - DEBUG - cur time: 2024-03-15T23:59:59.999 == next bar open time: 2024-03-16T00:00:00.000 == close pos time: 2024-03-23T00:00:00.000
2024-11-20 23:07:01,541 - INFO - pnl: 2024-03-15T23:59:59.999 197021.1332824136 === 0.085%
2024-11-20 23:07:01,545 - DEBUG - cur time: 2024-03-16T23:59:59.999 == next bar open time: 2024-03-17T00:00:00.000 == close pos time: 2024-03-24T00:00:00.000
2024-11-20 23:07:01,547 - INFO - pnl: 2024-03-16T23:59:59.999 197534.5816324177 === 0.261%
2024-11-20 23:07:01,551 - DEBUG - cur time: 2024-03-17T23:59:59.999 == next bar open time: 2024-03-18T00:00:00.000 == close pos time: 2024-03-25T00:00:00.000
2024-11-20 23:07:01,561 - DEBUG - sorted_long_factors: shape: (225, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ GASUSDT      ┆ -2.093753    ┆ 0    ┆ 224          │
│ EGLDUSDT     ┆ -1.92913     ┆ 1    ┆ 223          │
│ ORDIUSDT     ┆ -1.867353    ┆ 2    ┆ 222          │
│ APTUSDT      ┆ -1.824671    ┆ 3    ┆ 221          │
│ TIAUSDT      ┆ -1.70238     ┆ 4    ┆ 220          │
│ INJUSDT      ┆ -1.699891    ┆ 5    ┆ 219          │
│ NEARUSDT     ┆ -1.646387    ┆ 6    ┆ 218          │
│ ENSUSDT      ┆ -1.601196    ┆ 7    ┆ 217          │
│ DOTUSDT      ┆ -1.572745    ┆ 8    ┆ 216          │
│ TRBUSDT      ┆ -1.571078    ┆ 9    ┆ 215          │
│ …            ┆ …            ┆ …    ┆ …            │
│ XVGUSDT      ┆ 0.072545     ┆ 215  ┆ 9            │
│ SNTUSDT      ┆ 0.073632     ┆ 216  ┆ 8            │
│ OXTUSDT      ┆ 0.102889     ┆ 217  ┆ 7            │
│ DGBUSDT      ┆ 0.126971     ┆ 218  ┆ 6            │
│ COMBOUSDT    ┆ 0.142837     ┆ 219  ┆ 5            │
│ TRUUSDT      ┆ 0.234347     ┆ 220  ┆ 4            │
│ ANTUSDT      ┆ 0.571255     ┆ 221  ┆ 3            │
│ IDEXUSDT     ┆ 0.828077     ┆ 222  ┆ 2            │
│ DEFIUSDT     ┆ 1.192503     ┆ 223  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.360016     ┆ 224  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:01,570 - WARNING - 2024-03-17T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:01,570 - INFO - cur close time: 2024-03-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:01,570 - DEBUG - mean expected ret (mean factor): -0.7631257101719072
2024-11-20 23:07:01,575 - DEBUG - begin to update pos: =========
2024-11-20 23:07:01,576 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,576 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028136    ┆ 0.22336     ┆ 0.14948     ┆ 0.0078508   ┆ … ┆ 0.03397 ┆ null   ┆ null    ┆ 1.3121  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,583 - DEBUG - update position: 2024-03-17T23:59:59.999 === diff_trading_value: 270240.1871059607 == cash: 201435.92349472822 
2024-11-20 23:07:01,584 - INFO - pnl: 2024-03-17T23:59:59.999 201435.92349472822 === 1.975%
2024-11-20 23:07:01,588 - DEBUG - cur time: 2024-03-18T23:59:59.999 == next bar open time: 2024-03-19T00:00:00.000 == close pos time: 2024-03-26T00:00:00.000
2024-11-20 23:07:01,590 - INFO - pnl: 2024-03-18T23:59:59.999 200537.3718995376 === -0.446%
2024-11-20 23:07:01,594 - DEBUG - cur time: 2024-03-19T23:59:59.999 == next bar open time: 2024-03-20T00:00:00.000 == close pos time: 2024-03-27T00:00:00.000
2024-11-20 23:07:01,596 - INFO - pnl: 2024-03-19T23:59:59.999 192466.41991992743 === -4.025%
2024-11-20 23:07:01,599 - DEBUG - cur time: 2024-03-20T23:59:59.999 == next bar open time: 2024-03-21T00:00:00.000 == close pos time: 2024-03-28T00:00:00.000
2024-11-20 23:07:01,600 - INFO - pnl: 2024-03-20T23:59:59.999 196530.68770300163 === 2.112%
2024-11-20 23:07:01,603 - DEBUG - cur time: 2024-03-21T23:59:59.999 == next bar open time: 2024-03-22T00:00:00.000 == close pos time: 2024-03-29T00:00:00.000
2024-11-20 23:07:01,605 - INFO - pnl: 2024-03-21T23:59:59.999 201625.21241621018 === 2.592%
2024-11-20 23:07:01,608 - DEBUG - cur time: 2024-03-22T23:59:59.999 == next bar open time: 2024-03-23T00:00:00.000 == close pos time: 2024-03-30T00:00:00.000
2024-11-20 23:07:01,611 - INFO - pnl: 2024-03-22T23:59:59.999 201614.86147644653 === -0.005%
2024-11-20 23:07:01,615 - DEBUG - cur time: 2024-03-23T23:59:59.999 == next bar open time: 2024-03-24T00:00:00.000 == close pos time: 2024-03-31T00:00:00.000
2024-11-20 23:07:01,618 - INFO - pnl: 2024-03-23T23:59:59.999 202509.47528582983 === 0.444%
2024-11-20 23:07:01,622 - DEBUG - cur time: 2024-03-24T23:59:59.999 == next bar open time: 2024-03-25T00:00:00.000 == close pos time: 2024-04-01T00:00:00.000
2024-11-20 23:07:01,631 - DEBUG - sorted_long_factors: shape: (225, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ JTOUSDT    ┆ -2.220909    ┆ 0    ┆ 224          │
│ ILVUSDT    ┆ -2.07095     ┆ 1    ┆ 223          │
│ DOTUSDT    ┆ -2.052954    ┆ 2    ┆ 222          │
│ MASKUSDT   ┆ -1.98079     ┆ 3    ┆ 221          │
│ BSVUSDT    ┆ -1.949793    ┆ 4    ┆ 220          │
│ BONDUSDT   ┆ -1.901908    ┆ 5    ┆ 219          │
│ BTCDOMUSDT ┆ -1.794021    ┆ 6    ┆ 218          │
│ INJUSDT    ┆ -1.793785    ┆ 7    ┆ 217          │
│ GASUSDT    ┆ -1.743202    ┆ 8    ┆ 216          │
│ TIAUSDT    ┆ -1.690537    ┆ 9    ┆ 215          │
│ …          ┆ …            ┆ …    ┆ …            │
│ IDEXUSDT   ┆ 0.183566     ┆ 215  ┆ 9            │
│ TRUUSDT    ┆ 0.232371     ┆ 216  ┆ 8            │
│ DENTUSDT   ┆ 0.244507     ┆ 217  ┆ 7            │
│ COMBOUSDT  ┆ 0.279976     ┆ 218  ┆ 6            │
│ DGBUSDT    ┆ 0.348094     ┆ 219  ┆ 5            │
│ DODOXUSDT  ┆ 0.376877     ┆ 220  ┆ 4            │
│ ANTUSDT    ┆ 0.459747     ┆ 221  ┆ 3            │
│ XVGUSDT    ┆ 0.535681     ┆ 222  ┆ 2            │
│ OXTUSDT    ┆ 1.03339      ┆ 223  ┆ 1            │
│ DEFIUSDT   ┆ 1.139688     ┆ 224  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:01,643 - INFO - cur close time: 2024-03-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:01,644 - DEBUG - mean expected ret (mean factor): -0.7803581757489564
2024-11-20 23:07:01,648 - DEBUG - begin to update pos: =========
2024-11-20 23:07:01,648 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,649 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024122    ┆ 0.2401      ┆ 0.16102     ┆ 0.0078187   ┆ … ┆ 0.03398 ┆ null   ┆ null    ┆ 0.9208  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,655 - DEBUG - update position: 2024-03-24T23:59:59.999 === diff_trading_value: 224199.28654934786 == cash: 204994.38515750266 
2024-11-20 23:07:01,656 - INFO - pnl: 2024-03-24T23:59:59.999 204994.38515750266 === 1.227%
2024-11-20 23:07:01,660 - DEBUG - cur time: 2024-03-25T23:59:59.999 == next bar open time: 2024-03-26T00:00:00.000 == close pos time: 2024-04-02T00:00:00.000
2024-11-20 23:07:01,662 - INFO - pnl: 2024-03-25T23:59:59.999 190763.8872812636 === -6.942%
2024-11-20 23:07:01,665 - DEBUG - cur time: 2024-03-26T23:59:59.999 == next bar open time: 2024-03-27T00:00:00.000 == close pos time: 2024-04-03T00:00:00.000
2024-11-20 23:07:01,666 - INFO - pnl: 2024-03-26T23:59:59.999 193580.65117818225 === 1.477%
2024-11-20 23:07:01,670 - DEBUG - cur time: 2024-03-27T23:59:59.999 == next bar open time: 2024-03-28T00:00:00.000 == close pos time: 2024-04-04T00:00:00.000
2024-11-20 23:07:01,671 - INFO - pnl: 2024-03-27T23:59:59.999 191517.87072770047 === -1.066%
2024-11-20 23:07:01,674 - DEBUG - cur time: 2024-03-28T23:59:59.999 == next bar open time: 2024-03-29T00:00:00.000 == close pos time: 2024-04-05T00:00:00.000
2024-11-20 23:07:01,676 - INFO - pnl: 2024-03-28T23:59:59.999 191358.1379230112 === -0.083%
2024-11-20 23:07:01,679 - DEBUG - cur time: 2024-03-29T23:59:59.999 == next bar open time: 2024-03-30T00:00:00.000 == close pos time: 2024-04-06T00:00:00.000
2024-11-20 23:07:01,680 - INFO - pnl: 2024-03-29T23:59:59.999 192687.6649184305 === 0.695%
2024-11-20 23:07:01,683 - DEBUG - cur time: 2024-03-30T23:59:59.999 == next bar open time: 2024-03-31T00:00:00.000 == close pos time: 2024-04-07T00:00:00.000
2024-11-20 23:07:01,684 - INFO - pnl: 2024-03-30T23:59:59.999 194037.96760533447 === 0.701%
2024-11-20 23:07:01,688 - DEBUG - cur time: 2024-03-31T23:59:59.999 == next bar open time: 2024-04-01T00:00:00.000 == close pos time: 2024-04-08T00:00:00.000
2024-11-20 23:07:01,698 - DEBUG - sorted_long_factors: shape: (225, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BONDUSDT  ┆ -2.374187    ┆ 0    ┆ 224          │
│ ORDIUSDT  ┆ -2.196148    ┆ 1    ┆ 223          │
│ MASKUSDT  ┆ -2.157632    ┆ 2    ┆ 222          │
│ ACEUSDT   ┆ -1.941971    ┆ 3    ┆ 221          │
│ MKRUSDT   ┆ -1.891572    ┆ 4    ┆ 220          │
│ IDUSDT    ┆ -1.707183    ┆ 5    ┆ 219          │
│ CYBERUSDT ┆ -1.660661    ┆ 6    ┆ 218          │
│ FILUSDT   ┆ -1.638158    ┆ 7    ┆ 217          │
│ NEARUSDT  ┆ -1.594809    ┆ 8    ┆ 216          │
│ ILVUSDT   ┆ -1.584572    ┆ 9    ┆ 215          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CELRUSDT  ┆ 0.180193     ┆ 215  ┆ 9            │
│ SNTUSDT   ┆ 0.18555      ┆ 216  ┆ 8            │
│ HFTUSDT   ┆ 0.191685     ┆ 217  ┆ 7            │
│ AGLDUSDT  ┆ 0.201699     ┆ 218  ┆ 6            │
│ ALPHAUSDT ┆ 0.217869     ┆ 219  ┆ 5            │
│ BNTUSDT   ┆ 0.245723     ┆ 220  ┆ 4            │
│ SFPUSDT   ┆ 0.491637     ┆ 221  ┆ 3            │
│ DENTUSDT  ┆ 0.611155     ┆ 222  ┆ 2            │
│ OXTUSDT   ┆ 1.045064     ┆ 223  ┆ 1            │
│ DEFIUSDT  ┆ 3.322648     ┆ 224  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:01,704 - WARNING - 2024-03-31T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:01,704 - INFO - cur close time: 2024-03-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:01,705 - DEBUG - mean expected ret (mean factor): -0.7627599169215133
2024-11-20 23:07:01,709 - DEBUG - begin to update pos: =========
2024-11-20 23:07:01,710 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,710 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028121    ┆ 0.24849     ┆ 0.15902     ┆ 0.0088038   ┆ … ┆ 0.03896 ┆ null   ┆ null    ┆ 0.7617  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,719 - DEBUG - update position: 2024-03-31T23:59:59.999 === diff_trading_value: 275766.3831941916 == cash: 189705.89077079282 
2024-11-20 23:07:01,720 - INFO - pnl: 2024-03-31T23:59:59.999 189705.89077079282 === -2.233%
2024-11-20 23:07:01,723 - DEBUG - cur time: 2024-04-01T23:59:59.999 == next bar open time: 2024-04-02T00:00:00.000 == close pos time: 2024-04-09T00:00:00.000
2024-11-20 23:07:01,725 - INFO - pnl: 2024-04-01T23:59:59.999 189414.81893638766 === -0.153%
2024-11-20 23:07:01,730 - DEBUG - cur time: 2024-04-02T23:59:59.999 == next bar open time: 2024-04-03T00:00:00.000 == close pos time: 2024-04-10T00:00:00.000
2024-11-20 23:07:01,732 - INFO - pnl: 2024-04-02T23:59:59.999 188782.6238577548 === -0.334%
2024-11-20 23:07:01,736 - DEBUG - cur time: 2024-04-03T23:59:59.999 == next bar open time: 2024-04-04T00:00:00.000 == close pos time: 2024-04-11T00:00:00.000
2024-11-20 23:07:01,737 - INFO - pnl: 2024-04-03T23:59:59.999 189890.43917269306 === 0.587%
2024-11-20 23:07:01,741 - DEBUG - cur time: 2024-04-04T23:59:59.999 == next bar open time: 2024-04-05T00:00:00.000 == close pos time: 2024-04-12T00:00:00.000
2024-11-20 23:07:01,744 - INFO - pnl: 2024-04-04T23:59:59.999 188524.3566526397 === -0.719%
2024-11-20 23:07:01,748 - DEBUG - cur time: 2024-04-05T23:59:59.999 == next bar open time: 2024-04-06T00:00:00.000 == close pos time: 2024-04-13T00:00:00.000
2024-11-20 23:07:01,749 - INFO - pnl: 2024-04-05T23:59:59.999 187348.67178613204 === -0.624%
2024-11-20 23:07:01,753 - DEBUG - cur time: 2024-04-06T23:59:59.999 == next bar open time: 2024-04-07T00:00:00.000 == close pos time: 2024-04-14T00:00:00.000
2024-11-20 23:07:01,755 - INFO - pnl: 2024-04-06T23:59:59.999 187340.63501219888 === -0.004%
2024-11-20 23:07:01,759 - DEBUG - cur time: 2024-04-07T23:59:59.999 == next bar open time: 2024-04-08T00:00:00.000 == close pos time: 2024-04-15T00:00:00.000
2024-11-20 23:07:01,769 - DEBUG - sorted_long_factors: shape: (227, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT    ┆ -2.201714    ┆ 0    ┆ 226          │
│ ORDIUSDT    ┆ -2.096334    ┆ 1    ┆ 225          │
│ ILVUSDT     ┆ -2.070688    ┆ 2    ┆ 224          │
│ TRBUSDT     ┆ -2.062854    ┆ 3    ┆ 223          │
│ AUCTIONUSDT ┆ -2.016574    ┆ 4    ┆ 222          │
│ TIAUSDT     ┆ -1.831969    ┆ 5    ┆ 221          │
│ FILUSDT     ┆ -1.740762    ┆ 6    ┆ 220          │
│ AAVEUSDT    ┆ -1.735687    ┆ 7    ┆ 219          │
│ ICPUSDT     ┆ -1.727155    ┆ 8    ┆ 218          │
│ APTUSDT     ┆ -1.677156    ┆ 9    ┆ 217          │
│ …           ┆ …            ┆ …    ┆ …            │
│ RUNEUSDT    ┆ 0.186783     ┆ 217  ┆ 9            │
│ SNTUSDT     ┆ 0.193205     ┆ 218  ┆ 8            │
│ TLMUSDT     ┆ 0.323345     ┆ 219  ┆ 7            │
│ XMRUSDT     ┆ 0.328701     ┆ 220  ┆ 6            │
│ SFPUSDT     ┆ 0.335487     ┆ 221  ┆ 5            │
│ DENTUSDT    ┆ 0.34579      ┆ 222  ┆ 4            │
│ DODOXUSDT   ┆ 0.573155     ┆ 223  ┆ 3            │
│ CVXUSDT     ┆ 0.589352     ┆ 224  ┆ 2            │
│ OXTUSDT     ┆ 0.74957      ┆ 225  ┆ 1            │
│ DEFIUSDT    ┆ 1.56761      ┆ 226  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:01,776 - WARNING - 2024-04-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:01,776 - INFO - cur close time: 2024-04-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:01,776 - DEBUG - mean expected ret (mean factor): -0.7840946013483525
2024-11-20 23:07:01,781 - DEBUG - begin to update pos: =========
2024-11-20 23:07:01,781 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,782 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023528    ┆ 0.20562     ┆ 0.13404     ┆ 0.0074516   ┆ … ┆ 0.03349 ┆ null   ┆ null    ┆ 0.6931  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,791 - DEBUG - update position: 2024-04-07T23:59:59.999 === diff_trading_value: 221091.95096033902 == cash: 188562.17012033708 
2024-11-20 23:07:01,793 - INFO - pnl: 2024-04-07T23:59:59.999 188562.17012033708 === 0.652%
2024-11-20 23:07:01,798 - DEBUG - cur time: 2024-04-08T23:59:59.999 == next bar open time: 2024-04-09T00:00:00.000 == close pos time: 2024-04-16T00:00:00.000
2024-11-20 23:07:01,800 - INFO - pnl: 2024-04-08T23:59:59.999 191687.3089511387 === 1.657%
2024-11-20 23:07:01,804 - DEBUG - cur time: 2024-04-09T23:59:59.999 == next bar open time: 2024-04-10T00:00:00.000 == close pos time: 2024-04-17T00:00:00.000
2024-11-20 23:07:01,806 - INFO - pnl: 2024-04-09T23:59:59.999 193686.6980951001 === 1.043%
2024-11-20 23:07:01,813 - DEBUG - cur time: 2024-04-10T23:59:59.999 == next bar open time: 2024-04-11T00:00:00.000 == close pos time: 2024-04-18T00:00:00.000
2024-11-20 23:07:01,815 - INFO - pnl: 2024-04-10T23:59:59.999 193401.65659933042 === -0.147%
2024-11-20 23:07:01,821 - DEBUG - cur time: 2024-04-11T23:59:59.999 == next bar open time: 2024-04-12T00:00:00.000 == close pos time: 2024-04-19T00:00:00.000
2024-11-20 23:07:01,825 - INFO - pnl: 2024-04-11T23:59:59.999 194759.7007286948 === 0.702%
2024-11-20 23:07:01,832 - DEBUG - cur time: 2024-04-12T23:59:59.999 == next bar open time: 2024-04-13T00:00:00.000 == close pos time: 2024-04-20T00:00:00.000
2024-11-20 23:07:01,835 - INFO - pnl: 2024-04-12T23:59:59.999 194956.98015681247 === 0.101%
2024-11-20 23:07:01,845 - DEBUG - cur time: 2024-04-13T23:59:59.999 == next bar open time: 2024-04-14T00:00:00.000 == close pos time: 2024-04-21T00:00:00.000
2024-11-20 23:07:01,849 - INFO - pnl: 2024-04-13T23:59:59.999 193355.516466159 === -0.821%
2024-11-20 23:07:01,860 - DEBUG - cur time: 2024-04-14T23:59:59.999 == next bar open time: 2024-04-15T00:00:00.000 == close pos time: 2024-04-22T00:00:00.000
2024-11-20 23:07:01,871 - DEBUG - sorted_long_factors: shape: (227, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ONTUSDT      ┆ -1.902512    ┆ 0    ┆ 226          │
│ BNBUSDT      ┆ -1.817074    ┆ 1    ┆ 225          │
│ NEOUSDT      ┆ -1.781066    ┆ 2    ┆ 224          │
│ AUCTIONUSDT  ┆ -1.73315     ┆ 3    ┆ 223          │
│ QTUMUSDT     ┆ -1.723132    ┆ 4    ┆ 222          │
│ GASUSDT      ┆ -1.70093     ┆ 5    ┆ 221          │
│ GALUSDT      ┆ -1.659818    ┆ 6    ┆ 220          │
│ BSVUSDT      ┆ -1.547664    ┆ 7    ┆ 219          │
│ 1000SATSUSDT ┆ -1.531123    ┆ 8    ┆ 218          │
│ FTMUSDT      ┆ -1.52097     ┆ 9    ┆ 217          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RADUSDT      ┆ 0.099739     ┆ 217  ┆ 9            │
│ LITUSDT      ┆ 0.114399     ┆ 218  ┆ 8            │
│ IDEXUSDT     ┆ 0.162707     ┆ 219  ┆ 7            │
│ HFTUSDT      ┆ 0.172746     ┆ 220  ┆ 6            │
│ NMRUSDT      ┆ 0.176376     ┆ 221  ┆ 5            │
│ GTCUSDT      ┆ 0.181849     ┆ 222  ┆ 4            │
│ DODOXUSDT    ┆ 0.415364     ┆ 223  ┆ 3            │
│ COMBOUSDT    ┆ 0.495922     ┆ 224  ┆ 2            │
│ CVXUSDT      ┆ 0.506663     ┆ 225  ┆ 1            │
│ DEFIUSDT     ┆ 2.588871     ┆ 226  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:01,881 - WARNING - 2024-04-14T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:01,881 - INFO - cur close time: 2024-04-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:01,881 - DEBUG - mean expected ret (mean factor): -0.7806071712469387
2024-11-20 23:07:01,887 - DEBUG - begin to update pos: =========
2024-11-20 23:07:01,887 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,887 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.01624     ┆ 0.15035     ┆ 0.1028      ┆ 0.0054318   ┆ … ┆ 0.0251  ┆ null   ┆ null    ┆ 0.5007  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,895 - DEBUG - update position: 2024-04-14T23:59:59.999 === diff_trading_value: 276558.08945186937 == cash: 194460.00473642393 
2024-11-20 23:07:01,897 - INFO - pnl: 2024-04-14T23:59:59.999 194460.00473642393 === 0.571%
2024-11-20 23:07:01,904 - DEBUG - cur time: 2024-04-15T23:59:59.999 == next bar open time: 2024-04-16T00:00:00.000 == close pos time: 2024-04-23T00:00:00.000
2024-11-20 23:07:01,908 - INFO - pnl: 2024-04-15T23:59:59.999 193356.06007054256 === -0.568%
2024-11-20 23:07:01,916 - DEBUG - cur time: 2024-04-16T23:59:59.999 == next bar open time: 2024-04-17T00:00:00.000 == close pos time: 2024-04-24T00:00:00.000
2024-11-20 23:07:01,921 - INFO - pnl: 2024-04-16T23:59:59.999 195716.7626117953 === 1.221%
2024-11-20 23:07:01,928 - DEBUG - cur time: 2024-04-17T23:59:59.999 == next bar open time: 2024-04-18T00:00:00.000 == close pos time: 2024-04-25T00:00:00.000
2024-11-20 23:07:01,930 - INFO - pnl: 2024-04-17T23:59:59.999 199313.73556022678 === 1.838%
2024-11-20 23:07:01,937 - DEBUG - cur time: 2024-04-18T23:59:59.999 == next bar open time: 2024-04-19T00:00:00.000 == close pos time: 2024-04-26T00:00:00.000
2024-11-20 23:07:01,940 - INFO - pnl: 2024-04-18T23:59:59.999 198018.2200691778 === -0.650%
2024-11-20 23:07:01,946 - DEBUG - cur time: 2024-04-19T23:59:59.999 == next bar open time: 2024-04-20T00:00:00.000 == close pos time: 2024-04-27T00:00:00.000
2024-11-20 23:07:01,948 - INFO - pnl: 2024-04-19T23:59:59.999 196351.69260528276 === -0.842%
2024-11-20 23:07:01,954 - DEBUG - cur time: 2024-04-20T23:59:59.999 == next bar open time: 2024-04-21T00:00:00.000 == close pos time: 2024-04-28T00:00:00.000
2024-11-20 23:07:01,956 - INFO - pnl: 2024-04-20T23:59:59.999 196562.23094238315 === 0.107%
2024-11-20 23:07:01,963 - DEBUG - cur time: 2024-04-21T23:59:59.999 == next bar open time: 2024-04-22T00:00:00.000 == close pos time: 2024-04-29T00:00:00.000
2024-11-20 23:07:01,973 - DEBUG - sorted_long_factors: shape: (229, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ GASUSDT    ┆ -2.089818    ┆ 0    ┆ 228          │
│ JTOUSDT    ┆ -2.087533    ┆ 1    ┆ 227          │
│ CAKEUSDT   ┆ -1.978793    ┆ 2    ┆ 226          │
│ ONTUSDT    ┆ -1.85142     ┆ 3    ┆ 225          │
│ BNBUSDT    ┆ -1.851251    ┆ 4    ┆ 224          │
│ HIGHUSDT   ┆ -1.827792    ┆ 5    ┆ 223          │
│ BTCDOMUSDT ┆ -1.82283     ┆ 6    ┆ 222          │
│ QTUMUSDT   ┆ -1.651987    ┆ 7    ┆ 221          │
│ NEOUSDT    ┆ -1.603389    ┆ 8    ┆ 220          │
│ BELUSDT    ┆ -1.523573    ┆ 9    ┆ 219          │
│ …          ┆ …            ┆ …    ┆ …            │
│ RADUSDT    ┆ -0.004356    ┆ 219  ┆ 9            │
│ IDEXUSDT   ┆ 0.026268     ┆ 220  ┆ 8            │
│ COMBOUSDT  ┆ 0.03782      ┆ 221  ┆ 7            │
│ DUSKUSDT   ┆ 0.076038     ┆ 222  ┆ 6            │
│ MKRUSDT    ┆ 0.098007     ┆ 223  ┆ 5            │
│ OXTUSDT    ┆ 0.217607     ┆ 224  ┆ 4            │
│ NMRUSDT    ┆ 0.239615     ┆ 225  ┆ 3            │
│ CVXUSDT    ┆ 0.309248     ┆ 226  ┆ 2            │
│ DODOXUSDT  ┆ 0.523972     ┆ 227  ┆ 1            │
│ DEFIUSDT   ┆ 2.536206     ┆ 228  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:01,984 - WARNING - 2024-04-21T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:01,985 - INFO - cur close time: 2024-04-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:01,985 - DEBUG - mean expected ret (mean factor): -0.7788476990711136
2024-11-20 23:07:01,990 - DEBUG - begin to update pos: =========
2024-11-20 23:07:01,990 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:01,991 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.020833    ┆ 0.17043     ┆ 0.10808     ┆ 0.0059511   ┆ … ┆ 0.02585 ┆ null   ┆ null    ┆ 0.5497  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,000 - DEBUG - update position: 2024-04-21T23:59:59.999 === diff_trading_value: 153228.83688479228 == cash: 194031.31247564295 
2024-11-20 23:07:02,002 - INFO - pnl: 2024-04-21T23:59:59.999 194031.31247564295 === -1.288%
2024-11-20 23:07:02,006 - DEBUG - cur time: 2024-04-22T23:59:59.999 == next bar open time: 2024-04-23T00:00:00.000 == close pos time: 2024-04-30T00:00:00.000
2024-11-20 23:07:02,010 - INFO - pnl: 2024-04-22T23:59:59.999 193586.66094294083 === -0.229%
2024-11-20 23:07:02,013 - DEBUG - cur time: 2024-04-23T23:59:59.999 == next bar open time: 2024-04-24T00:00:00.000 == close pos time: 2024-05-01T00:00:00.000
2024-11-20 23:07:02,015 - INFO - pnl: 2024-04-23T23:59:59.999 196310.19036289424 === 1.407%
2024-11-20 23:07:02,021 - DEBUG - cur time: 2024-04-24T23:59:59.999 == next bar open time: 2024-04-25T00:00:00.000 == close pos time: 2024-05-02T00:00:00.000
2024-11-20 23:07:02,025 - INFO - pnl: 2024-04-24T23:59:59.999 192259.69646475493 === -2.063%
2024-11-20 23:07:02,030 - DEBUG - cur time: 2024-04-25T23:59:59.999 == next bar open time: 2024-04-26T00:00:00.000 == close pos time: 2024-05-03T00:00:00.000
2024-11-20 23:07:02,032 - INFO - pnl: 2024-04-25T23:59:59.999 192070.6858417479 === -0.098%
2024-11-20 23:07:02,037 - DEBUG - cur time: 2024-04-26T23:59:59.999 == next bar open time: 2024-04-27T00:00:00.000 == close pos time: 2024-05-04T00:00:00.000
2024-11-20 23:07:02,039 - INFO - pnl: 2024-04-26T23:59:59.999 188755.28181064603 === -1.726%
2024-11-20 23:07:02,046 - DEBUG - cur time: 2024-04-27T23:59:59.999 == next bar open time: 2024-04-28T00:00:00.000 == close pos time: 2024-05-05T00:00:00.000
2024-11-20 23:07:02,049 - INFO - pnl: 2024-04-27T23:59:59.999 190195.31852373714 === 0.763%
2024-11-20 23:07:02,056 - DEBUG - cur time: 2024-04-28T23:59:59.999 == next bar open time: 2024-04-29T00:00:00.000 == close pos time: 2024-05-06T00:00:00.000
2024-11-20 23:07:02,066 - DEBUG - sorted_long_factors: shape: (231, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ NEOUSDT  ┆ -2.181537    ┆ 0    ┆ 230          │
│ SSVUSDT  ┆ -2.119123    ┆ 1    ┆ 229          │
│ ATAUSDT  ┆ -2.070613    ┆ 2    ┆ 228          │
│ TIAUSDT  ┆ -1.927162    ┆ 3    ┆ 227          │
│ BNBUSDT  ┆ -1.916963    ┆ 4    ┆ 226          │
│ WIFUSDT  ┆ -1.888881    ┆ 5    ┆ 225          │
│ XMRUSDT  ┆ -1.875544    ┆ 6    ┆ 224          │
│ JTOUSDT  ┆ -1.813969    ┆ 7    ┆ 223          │
│ SEIUSDT  ┆ -1.803813    ┆ 8    ┆ 222          │
│ ONTUSDT  ┆ -1.802595    ┆ 9    ┆ 221          │
│ …        ┆ …            ┆ …    ┆ …            │
│ GLMRUSDT ┆ 0.199877     ┆ 221  ┆ 9            │
│ AGLDUSDT ┆ 0.219397     ┆ 222  ┆ 8            │
│ MDTUSDT  ┆ 0.231093     ┆ 223  ┆ 7            │
│ PERPUSDT ┆ 0.238304     ┆ 224  ┆ 6            │
│ NMRUSDT  ┆ 0.260353     ┆ 225  ┆ 5            │
│ ZENUSDT  ┆ 0.386903     ┆ 226  ┆ 4            │
│ CVXUSDT  ┆ 0.498526     ┆ 227  ┆ 3            │
│ OXTUSDT  ┆ 0.671833     ┆ 228  ┆ 2            │
│ RADUSDT  ┆ 0.676798     ┆ 229  ┆ 1            │
│ DEFIUSDT ┆ 3.213845     ┆ 230  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:02,076 - WARNING - 2024-04-28T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:02,077 - INFO - cur close time: 2024-04-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:02,077 - DEBUG - mean expected ret (mean factor): -0.7601880309185561
2024-11-20 23:07:02,082 - DEBUG - begin to update pos: =========
2024-11-20 23:07:02,082 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,083 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025099    ┆ 0.17015     ┆ 0.10564     ┆ 0.0072219   ┆ … ┆ 0.02448 ┆ null   ┆ null    ┆ 0.4991  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,090 - DEBUG - update position: 2024-04-28T23:59:59.999 === diff_trading_value: 224754.94876203692 == cash: 189713.55257808793 
2024-11-20 23:07:02,092 - INFO - pnl: 2024-04-28T23:59:59.999 189713.55257808793 === -0.253%
2024-11-20 23:07:02,099 - DEBUG - cur time: 2024-04-29T23:59:59.999 == next bar open time: 2024-04-30T00:00:00.000 == close pos time: 2024-05-07T00:00:00.000
2024-11-20 23:07:02,101 - INFO - pnl: 2024-04-29T23:59:59.999 187717.93860705575 === -1.052%
2024-11-20 23:07:02,106 - DEBUG - cur time: 2024-04-30T23:59:59.999 == next bar open time: 2024-05-01T00:00:00.000 == close pos time: 2024-05-08T00:00:00.000
2024-11-20 23:07:02,109 - INFO - pnl: 2024-04-30T23:59:59.999 189688.52483787716 === 1.050%
2024-11-20 23:07:02,115 - DEBUG - cur time: 2024-05-01T23:59:59.999 == next bar open time: 2024-05-02T00:00:00.000 == close pos time: 2024-05-09T00:00:00.000
2024-11-20 23:07:02,118 - INFO - pnl: 2024-05-01T23:59:59.999 190999.1086729241 === 0.691%
2024-11-20 23:07:02,122 - DEBUG - cur time: 2024-05-02T23:59:59.999 == next bar open time: 2024-05-03T00:00:00.000 == close pos time: 2024-05-10T00:00:00.000
2024-11-20 23:07:02,124 - INFO - pnl: 2024-05-02T23:59:59.999 192444.51734773198 === 0.757%
2024-11-20 23:07:02,128 - DEBUG - cur time: 2024-05-03T23:59:59.999 == next bar open time: 2024-05-04T00:00:00.000 == close pos time: 2024-05-11T00:00:00.000
2024-11-20 23:07:02,130 - INFO - pnl: 2024-05-03T23:59:59.999 193919.27760350582 === 0.766%
2024-11-20 23:07:02,135 - DEBUG - cur time: 2024-05-04T23:59:59.999 == next bar open time: 2024-05-05T00:00:00.000 == close pos time: 2024-05-12T00:00:00.000
2024-11-20 23:07:02,138 - INFO - pnl: 2024-05-04T23:59:59.999 192048.74283040006 === -0.965%
2024-11-20 23:07:02,143 - DEBUG - cur time: 2024-05-05T23:59:59.999 == next bar open time: 2024-05-06T00:00:00.000 == close pos time: 2024-05-13T00:00:00.000
2024-11-20 23:07:02,154 - DEBUG - sorted_long_factors: shape: (234, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ NEOUSDT   ┆ -2.136695    ┆ 0    ┆ 233          │
│ WAVESUSDT ┆ -2.102433    ┆ 1    ┆ 232          │
│ GASUSDT   ┆ -1.920358    ┆ 2    ┆ 231          │
│ ONGUSDT   ┆ -1.875628    ┆ 3    ┆ 230          │
│ SSVUSDT   ┆ -1.803693    ┆ 4    ┆ 229          │
│ ENSUSDT   ┆ -1.667266    ┆ 5    ┆ 228          │
│ ACEUSDT   ┆ -1.666577    ┆ 6    ┆ 227          │
│ JTOUSDT   ┆ -1.622685    ┆ 7    ┆ 226          │
│ POWRUSDT  ┆ -1.618443    ┆ 8    ┆ 225          │
│ HBARUSDT  ┆ -1.604421    ┆ 9    ┆ 224          │
│ …         ┆ …            ┆ …    ┆ …            │
│ OXTUSDT   ┆ 0.071404     ┆ 224  ┆ 9            │
│ CVXUSDT   ┆ 0.093072     ┆ 225  ┆ 8            │
│ PERPUSDT  ┆ 0.115469     ┆ 226  ┆ 7            │
│ ZENUSDT   ┆ 0.12494      ┆ 227  ┆ 6            │
│ HFTUSDT   ┆ 0.142605     ┆ 228  ┆ 5            │
│ QNTUSDT   ┆ 0.15246      ┆ 229  ┆ 4            │
│ C98USDT   ┆ 0.152939     ┆ 230  ┆ 3            │
│ AGLDUSDT  ┆ 0.307482     ┆ 231  ┆ 2            │
│ XVSUSDT   ┆ 0.455625     ┆ 232  ┆ 1            │
│ DEFIUSDT  ┆ 3.435568     ┆ 233  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:02,162 - INFO - cur close time: 2024-05-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:02,163 - DEBUG - mean expected ret (mean factor): -0.7629757857398722
2024-11-20 23:07:02,167 - DEBUG - begin to update pos: =========
2024-11-20 23:07:02,167 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,168 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.02635     ┆ 0.1877      ┆ 0.11295     ┆ 0.0085313   ┆ … ┆ 0.02479 ┆ null   ┆ null    ┆ 0.5037  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,178 - DEBUG - update position: 2024-05-05T23:59:59.999 === diff_trading_value: 217877.13531545 == cash: 192891.3456908753 
2024-11-20 23:07:02,180 - INFO - pnl: 2024-05-05T23:59:59.999 192891.3456908753 === 0.439%
2024-11-20 23:07:02,186 - DEBUG - cur time: 2024-05-06T23:59:59.999 == next bar open time: 2024-05-07T00:00:00.000 == close pos time: 2024-05-14T00:00:00.000
2024-11-20 23:07:02,188 - INFO - pnl: 2024-05-06T23:59:59.999 191958.60305310186 === -0.484%
2024-11-20 23:07:02,193 - DEBUG - cur time: 2024-05-07T23:59:59.999 == next bar open time: 2024-05-08T00:00:00.000 == close pos time: 2024-05-15T00:00:00.000
2024-11-20 23:07:02,195 - INFO - pnl: 2024-05-07T23:59:59.999 186677.9538575921 === -2.751%
2024-11-20 23:07:02,201 - DEBUG - cur time: 2024-05-08T23:59:59.999 == next bar open time: 2024-05-09T00:00:00.000 == close pos time: 2024-05-16T00:00:00.000
2024-11-20 23:07:02,203 - INFO - pnl: 2024-05-08T23:59:59.999 177635.50409692607 === -4.844%
2024-11-20 23:07:02,206 - DEBUG - cur time: 2024-05-09T23:59:59.999 == next bar open time: 2024-05-10T00:00:00.000 == close pos time: 2024-05-17T00:00:00.000
2024-11-20 23:07:02,209 - INFO - pnl: 2024-05-09T23:59:59.999 174261.4578129141 === -1.899%
2024-11-20 23:07:02,214 - DEBUG - cur time: 2024-05-10T23:59:59.999 == next bar open time: 2024-05-11T00:00:00.000 == close pos time: 2024-05-18T00:00:00.000
2024-11-20 23:07:02,217 - INFO - pnl: 2024-05-10T23:59:59.999 175147.3170141377 === 0.508%
2024-11-20 23:07:02,223 - DEBUG - cur time: 2024-05-11T23:59:59.999 == next bar open time: 2024-05-12T00:00:00.000 == close pos time: 2024-05-19T00:00:00.000
2024-11-20 23:07:02,224 - INFO - pnl: 2024-05-11T23:59:59.999 174763.55766890864 === -0.219%
2024-11-20 23:07:02,230 - DEBUG - cur time: 2024-05-12T23:59:59.999 == next bar open time: 2024-05-13T00:00:00.000 == close pos time: 2024-05-20T00:00:00.000
2024-11-20 23:07:02,240 - DEBUG - sorted_long_factors: shape: (226, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TIAUSDT   ┆ -2.386541    ┆ 0    ┆ 225          │
│ SUIUSDT   ┆ -2.054808    ┆ 1    ┆ 224          │
│ USDCUSDT  ┆ -1.864885    ┆ 2    ┆ 223          │
│ WLDUSDT   ┆ -1.85031     ┆ 3    ┆ 222          │
│ JUPUSDT   ┆ -1.816353    ┆ 4    ┆ 221          │
│ POWRUSDT  ┆ -1.799996    ┆ 5    ┆ 220          │
│ ORDIUSDT  ┆ -1.771514    ┆ 6    ┆ 219          │
│ LSKUSDT   ┆ -1.73965     ┆ 7    ┆ 218          │
│ SUPERUSDT ┆ -1.729045    ┆ 8    ┆ 217          │
│ NEOUSDT   ┆ -1.719923    ┆ 9    ┆ 216          │
│ …         ┆ …            ┆ …    ┆ …            │
│ OGNUSDT   ┆ 0.132203     ┆ 216  ┆ 9            │
│ IOTXUSDT  ┆ 0.142439     ┆ 217  ┆ 8            │
│ TLMUSDT   ┆ 0.146098     ┆ 218  ┆ 7            │
│ AGLDUSDT  ┆ 0.155156     ┆ 219  ┆ 6            │
│ KLAYUSDT  ┆ 0.160541     ┆ 220  ┆ 5            │
│ C98USDT   ┆ 0.165129     ┆ 221  ┆ 4            │
│ ETHWUSDT  ┆ 0.282289     ┆ 222  ┆ 3            │
│ DENTUSDT  ┆ 0.28511      ┆ 223  ┆ 2            │
│ DODOXUSDT ┆ 0.558176     ┆ 224  ┆ 1            │
│ DEFIUSDT  ┆ 0.881307     ┆ 225  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:02,254 - WARNING - 2024-05-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:02,254 - INFO - cur close time: 2024-05-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:02,254 - DEBUG - mean expected ret (mean factor): -0.7862844368165711
2024-11-20 23:07:02,259 - DEBUG - begin to update pos: =========
2024-11-20 23:07:02,260 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,260 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022745    ┆ 0.16922     ┆ 0.10434     ┆ 0.008745    ┆ … ┆ 0.02266 ┆ null   ┆ null    ┆ 0.4515  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,268 - DEBUG - update position: 2024-05-12T23:59:59.999 === diff_trading_value: 266876.4065698288 == cash: 173509.4514783349 
2024-11-20 23:07:02,270 - INFO - pnl: 2024-05-12T23:59:59.999 173509.4514783349 === -0.718%
2024-11-20 23:07:02,278 - DEBUG - cur time: 2024-05-13T23:59:59.999 == next bar open time: 2024-05-14T00:00:00.000 == close pos time: 2024-05-21T00:00:00.000
2024-11-20 23:07:02,280 - INFO - pnl: 2024-05-13T23:59:59.999 174336.76208468026 === 0.477%
2024-11-20 23:07:02,284 - DEBUG - cur time: 2024-05-14T23:59:59.999 == next bar open time: 2024-05-15T00:00:00.000 == close pos time: 2024-05-22T00:00:00.000
2024-11-20 23:07:02,286 - INFO - pnl: 2024-05-14T23:59:59.999 175943.79672100634 === 0.922%
2024-11-20 23:07:02,291 - DEBUG - cur time: 2024-05-15T23:59:59.999 == next bar open time: 2024-05-16T00:00:00.000 == close pos time: 2024-05-23T00:00:00.000
2024-11-20 23:07:02,293 - INFO - pnl: 2024-05-15T23:59:59.999 176645.6575731142 === 0.399%
2024-11-20 23:07:02,298 - DEBUG - cur time: 2024-05-16T23:59:59.999 == next bar open time: 2024-05-17T00:00:00.000 == close pos time: 2024-05-24T00:00:00.000
2024-11-20 23:07:02,300 - INFO - pnl: 2024-05-16T23:59:59.999 177085.43434585544 === 0.249%
2024-11-20 23:07:02,303 - DEBUG - cur time: 2024-05-17T23:59:59.999 == next bar open time: 2024-05-18T00:00:00.000 == close pos time: 2024-05-25T00:00:00.000
2024-11-20 23:07:02,305 - INFO - pnl: 2024-05-17T23:59:59.999 176330.7749436661 === -0.426%
2024-11-20 23:07:02,310 - DEBUG - cur time: 2024-05-18T23:59:59.999 == next bar open time: 2024-05-19T00:00:00.000 == close pos time: 2024-05-26T00:00:00.000
2024-11-20 23:07:02,311 - INFO - pnl: 2024-05-18T23:59:59.999 176586.96232715133 === 0.145%
2024-11-20 23:07:02,317 - DEBUG - cur time: 2024-05-19T23:59:59.999 == next bar open time: 2024-05-20T00:00:00.000 == close pos time: 2024-05-27T00:00:00.000
2024-11-20 23:07:02,328 - DEBUG - sorted_long_factors: shape: (229, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT   ┆ -1.987192    ┆ 0    ┆ 228          │
│ MOVRUSDT     ┆ -1.909554    ┆ 1    ┆ 227          │
│ RNDRUSDT     ┆ -1.865491    ┆ 2    ┆ 226          │
│ ARKUSDT      ┆ -1.8401      ┆ 3    ┆ 225          │
│ ORDIUSDT     ┆ -1.810021    ┆ 4    ┆ 224          │
│ LSKUSDT      ┆ -1.784132    ┆ 5    ┆ 223          │
│ WLDUSDT      ┆ -1.739382    ┆ 6    ┆ 222          │
│ USDCUSDT     ┆ -1.71253     ┆ 7    ┆ 221          │
│ 1000SATSUSDT ┆ -1.673894    ┆ 8    ┆ 220          │
│ ONDOUSDT     ┆ -1.645974    ┆ 9    ┆ 219          │
│ …            ┆ …            ┆ …    ┆ …            │
│ KEYUSDT      ┆ 0.132859     ┆ 219  ┆ 9            │
│ OXTUSDT      ┆ 0.144599     ┆ 220  ┆ 8            │
│ DASHUSDT     ┆ 0.165002     ┆ 221  ┆ 7            │
│ TLMUSDT      ┆ 0.185454     ┆ 222  ┆ 6            │
│ LITUSDT      ┆ 0.23502      ┆ 223  ┆ 5            │
│ DARUSDT      ┆ 0.275763     ┆ 224  ┆ 4            │
│ JOEUSDT      ┆ 0.332924     ┆ 225  ┆ 3            │
│ OGNUSDT      ┆ 0.47751      ┆ 226  ┆ 2            │
│ DODOXUSDT    ┆ 1.064712     ┆ 227  ┆ 1            │
│ DEFIUSDT     ┆ 1.533485     ┆ 228  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:02,336 - INFO - cur close time: 2024-05-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:02,336 - DEBUG - mean expected ret (mean factor): -0.7897411976932031
2024-11-20 23:07:02,341 - DEBUG - begin to update pos: =========
2024-11-20 23:07:02,341 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,341 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025167    ┆ 0.19269     ┆ 0.10372     ┆ 0.0091465   ┆ … ┆ 0.02257 ┆ null   ┆ null    ┆ 0.5538  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,348 - DEBUG - update position: 2024-05-19T23:59:59.999 === diff_trading_value: 228176.92441894964 == cash: 176569.2616935485 
2024-11-20 23:07:02,349 - INFO - pnl: 2024-05-19T23:59:59.999 176569.2616935485 === -0.010%
2024-11-20 23:07:02,354 - DEBUG - cur time: 2024-05-20T23:59:59.999 == next bar open time: 2024-05-21T00:00:00.000 == close pos time: 2024-05-28T00:00:00.000
2024-11-20 23:07:02,356 - INFO - pnl: 2024-05-20T23:59:59.999 181204.13923261728 === 2.625%
2024-11-20 23:07:02,364 - DEBUG - cur time: 2024-05-21T23:59:59.999 == next bar open time: 2024-05-22T00:00:00.000 == close pos time: 2024-05-29T00:00:00.000
2024-11-20 23:07:02,367 - INFO - pnl: 2024-05-21T23:59:59.999 182089.2472292066 === 0.488%
2024-11-20 23:07:02,377 - DEBUG - cur time: 2024-05-22T23:59:59.999 == next bar open time: 2024-05-23T00:00:00.000 == close pos time: 2024-05-30T00:00:00.000
2024-11-20 23:07:02,382 - INFO - pnl: 2024-05-22T23:59:59.999 183382.82766449006 === 0.710%
2024-11-20 23:07:02,390 - DEBUG - cur time: 2024-05-23T23:59:59.999 == next bar open time: 2024-05-24T00:00:00.000 == close pos time: 2024-05-31T00:00:00.000
2024-11-20 23:07:02,395 - INFO - pnl: 2024-05-23T23:59:59.999 184296.85991486005 === 0.498%
2024-11-20 23:07:02,403 - DEBUG - cur time: 2024-05-24T23:59:59.999 == next bar open time: 2024-05-25T00:00:00.000 == close pos time: 2024-06-01T00:00:00.000
2024-11-20 23:07:02,405 - INFO - pnl: 2024-05-24T23:59:59.999 186175.66425243297 === 1.019%
2024-11-20 23:07:02,415 - DEBUG - cur time: 2024-05-25T23:59:59.999 == next bar open time: 2024-05-26T00:00:00.000 == close pos time: 2024-06-02T00:00:00.000
2024-11-20 23:07:02,420 - INFO - pnl: 2024-05-25T23:59:59.999 185028.37420214515 === -0.616%
2024-11-20 23:07:02,434 - DEBUG - cur time: 2024-05-26T23:59:59.999 == next bar open time: 2024-05-27T00:00:00.000 == close pos time: 2024-06-03T00:00:00.000
2024-11-20 23:07:02,472 - DEBUG - sorted_long_factors: shape: (230, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TIAUSDT   ┆ -1.932864    ┆ 0    ┆ 229          │
│ DYMUSDT   ┆ -1.783877    ┆ 1    ┆ 228          │
│ COMPUSDT  ┆ -1.755124    ┆ 2    ┆ 227          │
│ CYBERUSDT ┆ -1.733703    ┆ 3    ┆ 226          │
│ LSKUSDT   ┆ -1.717883    ┆ 4    ┆ 225          │
│ RNDRUSDT  ┆ -1.694839    ┆ 5    ┆ 224          │
│ ORDIUSDT  ┆ -1.660935    ┆ 6    ┆ 223          │
│ ALTUSDT   ┆ -1.658949    ┆ 7    ┆ 222          │
│ ONDOUSDT  ┆ -1.652165    ┆ 8    ┆ 221          │
│ JTOUSDT   ┆ -1.629616    ┆ 9    ┆ 220          │
│ …         ┆ …            ┆ …    ┆ …            │
│ WAXPUSDT  ┆ 0.0889       ┆ 220  ┆ 9            │
│ DENTUSDT  ┆ 0.111623     ┆ 221  ┆ 8            │
│ KEYUSDT   ┆ 0.112566     ┆ 222  ┆ 7            │
│ JOEUSDT   ┆ 0.136597     ┆ 223  ┆ 6            │
│ TLMUSDT   ┆ 0.198491     ┆ 224  ┆ 5            │
│ STEEMUSDT ┆ 0.283336     ┆ 225  ┆ 4            │
│ COMBOUSDT ┆ 0.337555     ┆ 226  ┆ 3            │
│ DODOXUSDT ┆ 0.476008     ┆ 227  ┆ 2            │
│ OXTUSDT   ┆ 0.498396     ┆ 228  ┆ 1            │
│ DEFIUSDT  ┆ 3.234283     ┆ 229  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:02,492 - WARNING - 2024-05-26T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:02,493 - INFO - cur close time: 2024-05-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:02,493 - DEBUG - mean expected ret (mean factor): -0.7615069170320179
2024-11-20 23:07:02,508 - DEBUG - begin to update pos: =========
2024-11-20 23:07:02,509 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,510 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.033942    ┆ 0.22587     ┆ 0.11158     ┆ 0.0160314   ┆ … ┆ 0.024   ┆ null   ┆ null    ┆ 0.5494  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,534 - DEBUG - update position: 2024-05-26T23:59:59.999 === diff_trading_value: 215863.51952517167 == cash: 183211.2545530967 
2024-11-20 23:07:02,538 - INFO - pnl: 2024-05-26T23:59:59.999 183211.2545530967 === -0.982%
2024-11-20 23:07:02,546 - DEBUG - cur time: 2024-05-27T23:59:59.999 == next bar open time: 2024-05-28T00:00:00.000 == close pos time: 2024-06-04T00:00:00.000
2024-11-20 23:07:02,549 - INFO - pnl: 2024-05-27T23:59:59.999 185411.12815574784 === 1.201%
2024-11-20 23:07:02,556 - DEBUG - cur time: 2024-05-28T23:59:59.999 == next bar open time: 2024-05-29T00:00:00.000 == close pos time: 2024-06-05T00:00:00.000
2024-11-20 23:07:02,560 - INFO - pnl: 2024-05-28T23:59:59.999 185619.1953400007 === 0.112%
2024-11-20 23:07:02,568 - DEBUG - cur time: 2024-05-29T23:59:59.999 == next bar open time: 2024-05-30T00:00:00.000 == close pos time: 2024-06-06T00:00:00.000
2024-11-20 23:07:02,571 - INFO - pnl: 2024-05-29T23:59:59.999 187176.5703222002 === 0.839%
2024-11-20 23:07:02,580 - DEBUG - cur time: 2024-05-30T23:59:59.999 == next bar open time: 2024-05-31T00:00:00.000 == close pos time: 2024-06-07T00:00:00.000
2024-11-20 23:07:02,586 - INFO - pnl: 2024-05-30T23:59:59.999 184128.36962561205 === -1.629%
2024-11-20 23:07:02,594 - DEBUG - cur time: 2024-05-31T23:59:59.999 == next bar open time: 2024-06-01T00:00:00.000 == close pos time: 2024-06-08T00:00:00.000
2024-11-20 23:07:02,597 - INFO - pnl: 2024-05-31T23:59:59.999 185350.67473837757 === 0.664%
2024-11-20 23:07:02,604 - DEBUG - cur time: 2024-06-01T23:59:59.999 == next bar open time: 2024-06-02T00:00:00.000 == close pos time: 2024-06-09T00:00:00.000
2024-11-20 23:07:02,607 - INFO - pnl: 2024-06-01T23:59:59.999 183084.77026620955 === -1.222%
2024-11-20 23:07:02,613 - DEBUG - cur time: 2024-06-02T23:59:59.999 == next bar open time: 2024-06-03T00:00:00.000 == close pos time: 2024-06-10T00:00:00.000
2024-11-20 23:07:02,630 - DEBUG - sorted_long_factors: shape: (234, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ACEUSDT   ┆ -1.916006    ┆ 0    ┆ 233          │
│ OMUSDT    ┆ -1.90061     ┆ 1    ┆ 232          │
│ STRKUSDT  ┆ -1.836387    ┆ 2    ┆ 231          │
│ RNDRUSDT  ┆ -1.814684    ┆ 3    ┆ 230          │
│ JTOUSDT   ┆ -1.800652    ┆ 4    ┆ 229          │
│ WIFUSDT   ┆ -1.7837      ┆ 5    ┆ 228          │
│ PIXELUSDT ┆ -1.731072    ┆ 6    ┆ 227          │
│ OPUSDT    ┆ -1.701172    ┆ 7    ┆ 226          │
│ TIAUSDT   ┆ -1.600426    ┆ 8    ┆ 225          │
│ INJUSDT   ┆ -1.580266    ┆ 9    ┆ 224          │
│ …         ┆ …            ┆ …    ┆ …            │
│ DODOXUSDT ┆ 0.025828     ┆ 224  ┆ 9            │
│ CELRUSDT  ┆ 0.034708     ┆ 225  ┆ 8            │
│ LPTUSDT   ┆ 0.058132     ┆ 226  ┆ 7            │
│ RVNUSDT   ┆ 0.068522     ┆ 227  ┆ 6            │
│ FLMUSDT   ┆ 0.093285     ┆ 228  ┆ 5            │
│ BANDUSDT  ┆ 0.110132     ┆ 229  ┆ 4            │
│ NMRUSDT   ┆ 0.168649     ┆ 230  ┆ 3            │
│ LITUSDT   ┆ 0.19967      ┆ 231  ┆ 2            │
│ OXTUSDT   ┆ 0.30575      ┆ 232  ┆ 1            │
│ DEFIUSDT  ┆ 3.384553     ┆ 233  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:02,646 - WARNING - 2024-06-02T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:02,646 - INFO - cur close time: 2024-06-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:02,647 - DEBUG - mean expected ret (mean factor): -0.7839968570038656
2024-11-20 23:07:02,658 - DEBUG - begin to update pos: =========
2024-11-20 23:07:02,659 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,659 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.03171     ┆ 0.24391     ┆ 0.11652     ┆ 0.0146338   ┆ … ┆ 0.02313 ┆ null   ┆ null    ┆ 0.5087  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,668 - DEBUG - update position: 2024-06-02T23:59:59.999 === diff_trading_value: 296586.6449644579 == cash: 181311.0107727967 
2024-11-20 23:07:02,669 - INFO - pnl: 2024-06-02T23:59:59.999 181311.0107727967 === -0.969%
2024-11-20 23:07:02,672 - DEBUG - cur time: 2024-06-03T23:59:59.999 == next bar open time: 2024-06-04T00:00:00.000 == close pos time: 2024-06-11T00:00:00.000
2024-11-20 23:07:02,673 - INFO - pnl: 2024-06-03T23:59:59.999 181946.26230530784 === 0.350%
2024-11-20 23:07:02,677 - DEBUG - cur time: 2024-06-04T23:59:59.999 == next bar open time: 2024-06-05T00:00:00.000 == close pos time: 2024-06-12T00:00:00.000
2024-11-20 23:07:02,679 - INFO - pnl: 2024-06-04T23:59:59.999 183835.8822760978 === 1.039%
2024-11-20 23:07:02,681 - DEBUG - cur time: 2024-06-05T23:59:59.999 == next bar open time: 2024-06-06T00:00:00.000 == close pos time: 2024-06-13T00:00:00.000
2024-11-20 23:07:02,684 - INFO - pnl: 2024-06-05T23:59:59.999 182282.1575486537 === -0.845%
2024-11-20 23:07:02,688 - DEBUG - cur time: 2024-06-06T23:59:59.999 == next bar open time: 2024-06-07T00:00:00.000 == close pos time: 2024-06-14T00:00:00.000
2024-11-20 23:07:02,690 - INFO - pnl: 2024-06-06T23:59:59.999 182451.85941843144 === 0.093%
2024-11-20 23:07:02,694 - DEBUG - cur time: 2024-06-07T23:59:59.999 == next bar open time: 2024-06-08T00:00:00.000 == close pos time: 2024-06-15T00:00:00.000
2024-11-20 23:07:02,696 - INFO - pnl: 2024-06-07T23:59:59.999 182224.13225849337 === -0.125%
2024-11-20 23:07:02,701 - DEBUG - cur time: 2024-06-08T23:59:59.999 == next bar open time: 2024-06-09T00:00:00.000 == close pos time: 2024-06-16T00:00:00.000
2024-11-20 23:07:02,703 - INFO - pnl: 2024-06-08T23:59:59.999 182702.6986508778 === 0.263%
2024-11-20 23:07:02,707 - DEBUG - cur time: 2024-06-09T23:59:59.999 == next bar open time: 2024-06-10T00:00:00.000 == close pos time: 2024-06-17T00:00:00.000
2024-11-20 23:07:02,718 - DEBUG - sorted_long_factors: shape: (234, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ MOVRUSDT   ┆ -2.222784    ┆ 0    ┆ 233          │
│ ACEUSDT    ┆ -1.970649    ┆ 1    ┆ 232          │
│ UMAUSDT    ┆ -1.938967    ┆ 2    ┆ 231          │
│ INJUSDT    ┆ -1.856168    ┆ 3    ┆ 230          │
│ WIFUSDT    ┆ -1.807205    ┆ 4    ┆ 229          │
│ STRKUSDT   ┆ -1.73149     ┆ 5    ┆ 228          │
│ JTOUSDT    ┆ -1.723921    ┆ 6    ┆ 227          │
│ XAIUSDT    ┆ -1.645352    ┆ 7    ┆ 226          │
│ PORTALUSDT ┆ -1.641616    ┆ 8    ┆ 225          │
│ MANTAUSDT  ┆ -1.599369    ┆ 9    ┆ 224          │
│ …          ┆ …            ┆ …    ┆ …            │
│ REEFUSDT   ┆ 0.087573     ┆ 224  ┆ 9            │
│ BALUSDT    ┆ 0.101455     ┆ 225  ┆ 8            │
│ DODOXUSDT  ┆ 0.234851     ┆ 226  ┆ 7            │
│ ORBSUSDT   ┆ 0.254225     ┆ 227  ┆ 6            │
│ DENTUSDT   ┆ 0.260109     ┆ 228  ┆ 5            │
│ ZENUSDT    ┆ 0.28382      ┆ 229  ┆ 4            │
│ SKLUSDT    ┆ 0.427847     ┆ 230  ┆ 3            │
│ NMRUSDT    ┆ 0.739483     ┆ 231  ┆ 2            │
│ OXTUSDT    ┆ 0.949296     ┆ 232  ┆ 1            │
│ DEFIUSDT   ┆ 1.804521     ┆ 233  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:02,725 - WARNING - 2024-06-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:02,725 - INFO - cur close time: 2024-06-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:02,725 - DEBUG - mean expected ret (mean factor): -0.7819438937227569
2024-11-20 23:07:02,730 - DEBUG - begin to update pos: =========
2024-11-20 23:07:02,730 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,731 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028586    ┆ 0.27953     ┆ 0.10827     ┆ 0.0127501   ┆ … ┆ 0.02152 ┆ null   ┆ null    ┆ 0.4631  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,738 - DEBUG - update position: 2024-06-09T23:59:59.999 === diff_trading_value: 222302.44789329218 == cash: 181036.53227065518 
2024-11-20 23:07:02,739 - INFO - pnl: 2024-06-09T23:59:59.999 181036.53227065518 === -0.912%
2024-11-20 23:07:02,744 - DEBUG - cur time: 2024-06-10T23:59:59.999 == next bar open time: 2024-06-11T00:00:00.000 == close pos time: 2024-06-18T00:00:00.000
2024-11-20 23:07:02,747 - INFO - pnl: 2024-06-10T23:59:59.999 183183.94268668775 === 1.186%
2024-11-20 23:07:02,750 - DEBUG - cur time: 2024-06-11T23:59:59.999 == next bar open time: 2024-06-12T00:00:00.000 == close pos time: 2024-06-19T00:00:00.000
2024-11-20 23:07:02,752 - INFO - pnl: 2024-06-11T23:59:59.999 185316.185136389 === 1.164%
2024-11-20 23:07:02,755 - DEBUG - cur time: 2024-06-12T23:59:59.999 == next bar open time: 2024-06-13T00:00:00.000 == close pos time: 2024-06-20T00:00:00.000
2024-11-20 23:07:02,757 - INFO - pnl: 2024-06-12T23:59:59.999 182598.89607547803 === -1.466%
2024-11-20 23:07:02,760 - DEBUG - cur time: 2024-06-13T23:59:59.999 == next bar open time: 2024-06-14T00:00:00.000 == close pos time: 2024-06-21T00:00:00.000
2024-11-20 23:07:02,763 - INFO - pnl: 2024-06-13T23:59:59.999 184859.91397296533 === 1.238%
2024-11-20 23:07:02,767 - DEBUG - cur time: 2024-06-14T23:59:59.999 == next bar open time: 2024-06-15T00:00:00.000 == close pos time: 2024-06-22T00:00:00.000
2024-11-20 23:07:02,769 - INFO - pnl: 2024-06-14T23:59:59.999 186699.99680355008 === 0.995%
2024-11-20 23:07:02,773 - DEBUG - cur time: 2024-06-15T23:59:59.999 == next bar open time: 2024-06-16T00:00:00.000 == close pos time: 2024-06-23T00:00:00.000
2024-11-20 23:07:02,775 - INFO - pnl: 2024-06-15T23:59:59.999 187003.20603085923 === 0.162%
2024-11-20 23:07:02,780 - DEBUG - cur time: 2024-06-16T23:59:59.999 == next bar open time: 2024-06-17T00:00:00.000 == close pos time: 2024-06-24T00:00:00.000
2024-11-20 23:07:02,791 - DEBUG - sorted_long_factors: shape: (237, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT    ┆ -2.023143    ┆ 0    ┆ 236          │
│ MOVRUSDT    ┆ -1.965735    ┆ 1    ┆ 235          │
│ TONUSDT     ┆ -1.905602    ┆ 2    ┆ 234          │
│ ACEUSDT     ┆ -1.894762    ┆ 3    ┆ 233          │
│ UMAUSDT     ┆ -1.833243    ┆ 4    ┆ 232          │
│ ZETAUSDT    ┆ -1.779347    ┆ 5    ┆ 231          │
│ XAIUSDT     ┆ -1.744318    ┆ 6    ┆ 230          │
│ PORTALUSDT  ┆ -1.737158    ┆ 7    ┆ 229          │
│ FILUSDT     ┆ -1.681379    ┆ 8    ┆ 228          │
│ UNIUSDT     ┆ -1.667456    ┆ 9    ┆ 227          │
│ …           ┆ …            ┆ …    ┆ …            │
│ DENTUSDT    ┆ 0.184981     ┆ 227  ┆ 9            │
│ STMXUSDT    ┆ 0.21749      ┆ 228  ┆ 8            │
│ OXTUSDT     ┆ 0.248614     ┆ 229  ┆ 7            │
│ ORBSUSDT    ┆ 0.256058     ┆ 230  ┆ 6            │
│ 1000XECUSDT ┆ 0.271664     ┆ 231  ┆ 5            │
│ HFTUSDT     ┆ 0.287623     ┆ 232  ┆ 4            │
│ AMBUSDT     ┆ 0.336179     ┆ 233  ┆ 3            │
│ NKNUSDT     ┆ 0.353119     ┆ 234  ┆ 2            │
│ DODOXUSDT   ┆ 0.933966     ┆ 235  ┆ 1            │
│ DEFIUSDT    ┆ 1.481907     ┆ 236  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:02,799 - WARNING - 2024-06-16T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:02,799 - INFO - cur close time: 2024-06-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:02,799 - DEBUG - mean expected ret (mean factor): -0.7975605198444619
2024-11-20 23:07:02,804 - DEBUG - begin to update pos: =========
2024-11-20 23:07:02,804 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,805 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025232    ┆ 0.20674     ┆ 0.1044      ┆ 0.0123048   ┆ … ┆ 0.01968 ┆ null   ┆ null    ┆ 0.4144  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,811 - DEBUG - update position: 2024-06-16T23:59:59.999 === diff_trading_value: 201725.00133015876 == cash: 185156.52453756862 
2024-11-20 23:07:02,813 - INFO - pnl: 2024-06-16T23:59:59.999 185156.52453756862 === -0.988%
2024-11-20 23:07:02,816 - DEBUG - cur time: 2024-06-17T23:59:59.999 == next bar open time: 2024-06-18T00:00:00.000 == close pos time: 2024-06-25T00:00:00.000
2024-11-20 23:07:02,817 - INFO - pnl: 2024-06-17T23:59:59.999 184519.78381783774 === -0.344%
2024-11-20 23:07:02,821 - DEBUG - cur time: 2024-06-18T23:59:59.999 == next bar open time: 2024-06-19T00:00:00.000 == close pos time: 2024-06-26T00:00:00.000
2024-11-20 23:07:02,823 - INFO - pnl: 2024-06-18T23:59:59.999 186504.95912113992 === 1.076%
2024-11-20 23:07:02,827 - DEBUG - cur time: 2024-06-19T23:59:59.999 == next bar open time: 2024-06-20T00:00:00.000 == close pos time: 2024-06-27T00:00:00.000
2024-11-20 23:07:02,828 - INFO - pnl: 2024-06-19T23:59:59.999 187051.8927441408 === 0.293%
2024-11-20 23:07:02,832 - DEBUG - cur time: 2024-06-20T23:59:59.999 == next bar open time: 2024-06-21T00:00:00.000 == close pos time: 2024-06-28T00:00:00.000
2024-11-20 23:07:02,834 - INFO - pnl: 2024-06-20T23:59:59.999 187178.5256055295 === 0.068%
2024-11-20 23:07:02,839 - DEBUG - cur time: 2024-06-21T23:59:59.999 == next bar open time: 2024-06-22T00:00:00.000 == close pos time: 2024-06-29T00:00:00.000
2024-11-20 23:07:02,842 - INFO - pnl: 2024-06-21T23:59:59.999 187074.58789575682 === -0.056%
2024-11-20 23:07:02,846 - DEBUG - cur time: 2024-06-22T23:59:59.999 == next bar open time: 2024-06-23T00:00:00.000 == close pos time: 2024-06-30T00:00:00.000
2024-11-20 23:07:02,849 - INFO - pnl: 2024-06-22T23:59:59.999 186955.49020299243 === -0.064%
2024-11-20 23:07:02,853 - DEBUG - cur time: 2024-06-23T23:59:59.999 == next bar open time: 2024-06-24T00:00:00.000 == close pos time: 2024-07-01T00:00:00.000
2024-11-20 23:07:02,864 - DEBUG - sorted_long_factors: shape: (238, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT     ┆ -2.244262    ┆ 0    ┆ 237          │
│ TONUSDT     ┆ -2.005375    ┆ 1    ┆ 236          │
│ AUCTIONUSDT ┆ -1.984924    ┆ 2    ┆ 235          │
│ FXSUSDT     ┆ -1.873429    ┆ 3    ┆ 234          │
│ BTCDOMUSDT  ┆ -1.835024    ┆ 4    ┆ 233          │
│ HIGHUSDT    ┆ -1.62487     ┆ 5    ┆ 232          │
│ API3USDT    ┆ -1.529416    ┆ 6    ┆ 231          │
│ PEOPLEUSDT  ┆ -1.527992    ┆ 7    ┆ 230          │
│ ONDOUSDT    ┆ -1.513819    ┆ 8    ┆ 229          │
│ STRKUSDT    ┆ -1.494349    ┆ 9    ┆ 228          │
│ …           ┆ …            ┆ …    ┆ …            │
│ ETHWUSDT    ┆ 0.034642     ┆ 228  ┆ 9            │
│ NKNUSDT     ┆ 0.052945     ┆ 229  ┆ 8            │
│ BONDUSDT    ┆ 0.225254     ┆ 230  ┆ 7            │
│ ILVUSDT     ┆ 0.312496     ┆ 231  ┆ 6            │
│ DARUSDT     ┆ 0.314903     ┆ 232  ┆ 5            │
│ JOEUSDT     ┆ 0.453249     ┆ 233  ┆ 4            │
│ DODOXUSDT   ┆ 0.459846     ┆ 234  ┆ 3            │
│ NMRUSDT     ┆ 0.595764     ┆ 235  ┆ 2            │
│ OXTUSDT     ┆ 0.642392     ┆ 236  ┆ 1            │
│ DEFIUSDT    ┆ 2.205897     ┆ 237  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:02,871 - WARNING - 2024-06-23T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:02,871 - INFO - cur close time: 2024-06-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:02,871 - DEBUG - mean expected ret (mean factor): -0.79161957142397
2024-11-20 23:07:02,876 - DEBUG - begin to update pos: =========
2024-11-20 23:07:02,877 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,877 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.019947    ┆ 0.1587      ┆ 0.07494     ┆ 0.0109078   ┆ … ┆ 0.01692 ┆ null   ┆ null    ┆ 0.3477  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,885 - DEBUG - update position: 2024-06-23T23:59:59.999 === diff_trading_value: 271515.9441116209 == cash: 186693.60597905144 
2024-11-20 23:07:02,887 - INFO - pnl: 2024-06-23T23:59:59.999 186693.60597905144 === -0.140%
2024-11-20 23:07:02,893 - DEBUG - cur time: 2024-06-24T23:59:59.999 == next bar open time: 2024-06-25T00:00:00.000 == close pos time: 2024-07-02T00:00:00.000
2024-11-20 23:07:02,895 - INFO - pnl: 2024-06-24T23:59:59.999 186201.99366702922 === -0.263%
2024-11-20 23:07:02,899 - DEBUG - cur time: 2024-06-25T23:59:59.999 == next bar open time: 2024-06-26T00:00:00.000 == close pos time: 2024-07-03T00:00:00.000
2024-11-20 23:07:02,903 - INFO - pnl: 2024-06-25T23:59:59.999 186420.15243752947 === 0.117%
2024-11-20 23:07:02,909 - DEBUG - cur time: 2024-06-26T23:59:59.999 == next bar open time: 2024-06-27T00:00:00.000 == close pos time: 2024-07-04T00:00:00.000
2024-11-20 23:07:02,911 - INFO - pnl: 2024-06-26T23:59:59.999 186843.5541968054 === 0.227%
2024-11-20 23:07:02,919 - DEBUG - cur time: 2024-06-27T23:59:59.999 == next bar open time: 2024-06-28T00:00:00.000 == close pos time: 2024-07-05T00:00:00.000
2024-11-20 23:07:02,921 - INFO - pnl: 2024-06-27T23:59:59.999 188910.1385983663 === 1.106%
2024-11-20 23:07:02,929 - DEBUG - cur time: 2024-06-28T23:59:59.999 == next bar open time: 2024-06-29T00:00:00.000 == close pos time: 2024-07-06T00:00:00.000
2024-11-20 23:07:02,930 - INFO - pnl: 2024-06-28T23:59:59.999 190581.75217647638 === 0.885%
2024-11-20 23:07:02,940 - DEBUG - cur time: 2024-06-29T23:59:59.999 == next bar open time: 2024-06-30T00:00:00.000 == close pos time: 2024-07-07T00:00:00.000
2024-11-20 23:07:02,945 - INFO - pnl: 2024-06-29T23:59:59.999 188227.46110534403 === -1.235%
2024-11-20 23:07:02,954 - DEBUG - cur time: 2024-06-30T23:59:59.999 == next bar open time: 2024-07-01T00:00:00.000 == close pos time: 2024-07-08T00:00:00.000
2024-11-20 23:07:02,969 - DEBUG - sorted_long_factors: shape: (240, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT      ┆ -2.224775    ┆ 0    ┆ 239          │
│ MANTAUSDT    ┆ -2.207098    ┆ 1    ┆ 238          │
│ LSKUSDT      ┆ -2.179654    ┆ 2    ┆ 237          │
│ GASUSDT      ┆ -2.098111    ┆ 3    ┆ 236          │
│ JUPUSDT      ┆ -1.900917    ┆ 4    ┆ 235          │
│ BAKEUSDT     ┆ -1.840661    ┆ 5    ┆ 234          │
│ 1000LUNCUSDT ┆ -1.777505    ┆ 6    ┆ 233          │
│ TONUSDT      ┆ -1.75814     ┆ 7    ┆ 232          │
│ HIGHUSDT     ┆ -1.736307    ┆ 8    ┆ 231          │
│ NEARUSDT     ┆ -1.715248    ┆ 9    ┆ 230          │
│ …            ┆ …            ┆ …    ┆ …            │
│ XVGUSDT      ┆ 0.127118     ┆ 230  ┆ 9            │
│ DENTUSDT     ┆ 0.145338     ┆ 231  ┆ 8            │
│ DASHUSDT     ┆ 0.163711     ┆ 232  ┆ 7            │
│ KLAYUSDT     ┆ 0.241505     ┆ 233  ┆ 6            │
│ PERPUSDT     ┆ 0.311291     ┆ 234  ┆ 5            │
│ HFTUSDT      ┆ 0.48909      ┆ 235  ┆ 4            │
│ DARUSDT      ┆ 0.599641     ┆ 236  ┆ 3            │
│ DODOXUSDT    ┆ 0.614949     ┆ 237  ┆ 2            │
│ OXTUSDT      ┆ 1.141322     ┆ 238  ┆ 1            │
│ DEFIUSDT     ┆ 1.360364     ┆ 239  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:02,981 - WARNING - 2024-06-30T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:02,982 - INFO - cur close time: 2024-06-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:02,982 - DEBUG - mean expected ret (mean factor): -0.7799907839864998
2024-11-20 23:07:02,989 - DEBUG - begin to update pos: =========
2024-11-20 23:07:02,993 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:02,994 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022638    ┆ 0.17173     ┆ 0.08239     ┆ 0.0119226   ┆ … ┆ 0.0178  ┆ null   ┆ null    ┆ 0.3683  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,002 - DEBUG - update position: 2024-06-30T23:59:59.999 === diff_trading_value: 259567.78333615843 == cash: 190634.37420979323 
2024-11-20 23:07:03,003 - INFO - pnl: 2024-06-30T23:59:59.999 190634.37420979323 === 1.279%
2024-11-20 23:07:03,008 - DEBUG - cur time: 2024-07-01T23:59:59.999 == next bar open time: 2024-07-02T00:00:00.000 == close pos time: 2024-07-09T00:00:00.000
2024-11-20 23:07:03,009 - INFO - pnl: 2024-07-01T23:59:59.999 189243.56063848885 === -0.730%
2024-11-20 23:07:03,013 - DEBUG - cur time: 2024-07-02T23:59:59.999 == next bar open time: 2024-07-03T00:00:00.000 == close pos time: 2024-07-10T00:00:00.000
2024-11-20 23:07:03,014 - INFO - pnl: 2024-07-02T23:59:59.999 188097.04913393653 === -0.606%
2024-11-20 23:07:03,020 - DEBUG - cur time: 2024-07-03T23:59:59.999 == next bar open time: 2024-07-04T00:00:00.000 == close pos time: 2024-07-11T00:00:00.000
2024-11-20 23:07:03,021 - INFO - pnl: 2024-07-03T23:59:59.999 190053.3455686839 === 1.040%
2024-11-20 23:07:03,027 - DEBUG - cur time: 2024-07-04T23:59:59.999 == next bar open time: 2024-07-05T00:00:00.000 == close pos time: 2024-07-12T00:00:00.000
2024-11-20 23:07:03,029 - INFO - pnl: 2024-07-04T23:59:59.999 190104.76330761972 === 0.027%
2024-11-20 23:07:03,036 - DEBUG - cur time: 2024-07-05T23:59:59.999 == next bar open time: 2024-07-06T00:00:00.000 == close pos time: 2024-07-13T00:00:00.000
2024-11-20 23:07:03,038 - INFO - pnl: 2024-07-05T23:59:59.999 192844.79114186854 === 1.441%
2024-11-20 23:07:03,045 - DEBUG - cur time: 2024-07-06T23:59:59.999 == next bar open time: 2024-07-07T00:00:00.000 == close pos time: 2024-07-14T00:00:00.000
2024-11-20 23:07:03,047 - INFO - pnl: 2024-07-06T23:59:59.999 189553.65404772467 === -1.707%
2024-11-20 23:07:03,053 - DEBUG - cur time: 2024-07-07T23:59:59.999 == next bar open time: 2024-07-08T00:00:00.000 == close pos time: 2024-07-15T00:00:00.000
2024-11-20 23:07:03,066 - DEBUG - sorted_long_factors: shape: (239, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ OMUSDT     ┆ -2.12877     ┆ 0    ┆ 238          │
│ BTCDOMUSDT ┆ -2.048158    ┆ 1    ┆ 237          │
│ LSKUSDT    ┆ -2.043416    ┆ 2    ┆ 236          │
│ LDOUSDT    ┆ -1.927937    ┆ 3    ┆ 235          │
│ JUPUSDT    ┆ -1.838958    ┆ 4    ┆ 234          │
│ TONUSDT    ┆ -1.705748    ┆ 5    ┆ 233          │
│ TRXUSDT    ┆ -1.702976    ┆ 6    ┆ 232          │
│ GASUSDT    ┆ -1.697483    ┆ 7    ┆ 231          │
│ ZENUSDT    ┆ -1.669876    ┆ 8    ┆ 230          │
│ EGLDUSDT   ┆ -1.661975    ┆ 9    ┆ 229          │
│ …          ┆ …            ┆ …    ┆ …            │
│ HIGHUSDT   ┆ 0.044684     ┆ 229  ┆ 9            │
│ GMXUSDT    ┆ 0.045291     ┆ 230  ┆ 8            │
│ TIAUSDT    ┆ 0.04597      ┆ 231  ┆ 7            │
│ ACEUSDT    ┆ 0.066009     ┆ 232  ┆ 6            │
│ BADGERUSDT ┆ 0.07132      ┆ 233  ┆ 5            │
│ SUPERUSDT  ┆ 0.163121     ┆ 234  ┆ 4            │
│ STEEMUSDT  ┆ 0.166646     ┆ 235  ┆ 3            │
│ OXTUSDT    ┆ 0.861533     ┆ 236  ┆ 2            │
│ DODOXUSDT  ┆ 0.8853       ┆ 237  ┆ 1            │
│ DEFIUSDT   ┆ 1.702886     ┆ 238  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:03,073 - WARNING - 2024-07-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:03,073 - INFO - cur close time: 2024-07-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:03,074 - DEBUG - mean expected ret (mean factor): -0.7915977177327672
2024-11-20 23:07:03,078 - DEBUG - begin to update pos: =========
2024-11-20 23:07:03,079 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,079 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.021079    ┆ 0.13602     ┆ 0.068       ┆ 0.0084052   ┆ … ┆ 0.01447 ┆ null   ┆ null    ┆ 0.2923  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,086 - DEBUG - update position: 2024-07-07T23:59:59.999 === diff_trading_value: 231330.84157753346 == cash: 190066.34356441908 
2024-11-20 23:07:03,088 - INFO - pnl: 2024-07-07T23:59:59.999 190066.34356441908 === 0.270%
2024-11-20 23:07:03,092 - DEBUG - cur time: 2024-07-08T23:59:59.999 == next bar open time: 2024-07-09T00:00:00.000 == close pos time: 2024-07-16T00:00:00.000
2024-11-20 23:07:03,094 - INFO - pnl: 2024-07-08T23:59:59.999 190724.06799067528 === 0.346%
2024-11-20 23:07:03,101 - DEBUG - cur time: 2024-07-09T23:59:59.999 == next bar open time: 2024-07-10T00:00:00.000 == close pos time: 2024-07-17T00:00:00.000
2024-11-20 23:07:03,104 - INFO - pnl: 2024-07-09T23:59:59.999 188641.82402304275 === -1.092%
2024-11-20 23:07:03,111 - DEBUG - cur time: 2024-07-10T23:59:59.999 == next bar open time: 2024-07-11T00:00:00.000 == close pos time: 2024-07-18T00:00:00.000
2024-11-20 23:07:03,113 - INFO - pnl: 2024-07-10T23:59:59.999 188434.66661217005 === -0.110%
2024-11-20 23:07:03,118 - DEBUG - cur time: 2024-07-11T23:59:59.999 == next bar open time: 2024-07-12T00:00:00.000 == close pos time: 2024-07-19T00:00:00.000
2024-11-20 23:07:03,120 - INFO - pnl: 2024-07-11T23:59:59.999 186684.72927960881 === -0.929%
2024-11-20 23:07:03,126 - DEBUG - cur time: 2024-07-12T23:59:59.999 == next bar open time: 2024-07-13T00:00:00.000 == close pos time: 2024-07-20T00:00:00.000
2024-11-20 23:07:03,128 - INFO - pnl: 2024-07-12T23:59:59.999 188880.0461025868 === 1.176%
2024-11-20 23:07:03,133 - DEBUG - cur time: 2024-07-13T23:59:59.999 == next bar open time: 2024-07-14T00:00:00.000 == close pos time: 2024-07-21T00:00:00.000
2024-11-20 23:07:03,136 - INFO - pnl: 2024-07-13T23:59:59.999 187186.25759912582 === -0.897%
2024-11-20 23:07:03,141 - DEBUG - cur time: 2024-07-14T23:59:59.999 == next bar open time: 2024-07-15T00:00:00.000 == close pos time: 2024-07-22T00:00:00.000
2024-11-20 23:07:03,154 - DEBUG - sorted_long_factors: shape: (240, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ WIFUSDT    ┆ -2.139941    ┆ 0    ┆ 239          │
│ OMUSDT     ┆ -2.112525    ┆ 1    ┆ 238          │
│ ONDOUSDT   ┆ -2.033958    ┆ 2    ┆ 237          │
│ DYMUSDT    ┆ -1.935007    ┆ 3    ┆ 236          │
│ WLDUSDT    ┆ -1.908929    ┆ 4    ┆ 235          │
│ BTCDOMUSDT ┆ -1.884238    ┆ 5    ┆ 234          │
│ TONUSDT    ┆ -1.850086    ┆ 6    ┆ 233          │
│ ETHFIUSDT  ┆ -1.807321    ┆ 7    ┆ 232          │
│ MAVIAUSDT  ┆ -1.725152    ┆ 8    ┆ 231          │
│ MKRUSDT    ┆ -1.717869    ┆ 9    ┆ 230          │
│ …          ┆ …            ┆ …    ┆ …            │
│ HFTUSDT    ┆ 0.151065     ┆ 230  ┆ 9            │
│ UMAUSDT    ┆ 0.153528     ┆ 231  ┆ 8            │
│ RLCUSDT    ┆ 0.169245     ┆ 232  ┆ 7            │
│ AGLDUSDT   ┆ 0.17702      ┆ 233  ┆ 6            │
│ STEEMUSDT  ┆ 0.177435     ┆ 234  ┆ 5            │
│ ORBSUSDT   ┆ 0.267454     ┆ 235  ┆ 4            │
│ XVGUSDT    ┆ 0.273178     ┆ 236  ┆ 3            │
│ GMXUSDT    ┆ 0.282184     ┆ 237  ┆ 2            │
│ DODOXUSDT  ┆ 0.892022     ┆ 238  ┆ 1            │
│ DEFIUSDT   ┆ 1.581659     ┆ 239  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:03,163 - WARNING - 2024-07-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:03,163 - INFO - cur close time: 2024-07-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:03,163 - DEBUG - mean expected ret (mean factor): -0.7932342167031441
2024-11-20 23:07:03,169 - DEBUG - begin to update pos: =========
2024-11-20 23:07:03,169 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,169 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024009    ┆ 0.1516      ┆ 0.07485     ┆ 0.0091994   ┆ … ┆ 0.0164  ┆ null   ┆ null    ┆ 0.3291  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,179 - DEBUG - update position: 2024-07-14T23:59:59.999 === diff_trading_value: 291113.43264899263 == cash: 190252.8724315407 
2024-11-20 23:07:03,181 - INFO - pnl: 2024-07-14T23:59:59.999 190252.8724315407 === 1.638%
2024-11-20 23:07:03,187 - DEBUG - cur time: 2024-07-15T23:59:59.999 == next bar open time: 2024-07-16T00:00:00.000 == close pos time: 2024-07-23T00:00:00.000
2024-11-20 23:07:03,188 - INFO - pnl: 2024-07-15T23:59:59.999 182808.28324503286 === -3.913%
2024-11-20 23:07:03,193 - DEBUG - cur time: 2024-07-16T23:59:59.999 == next bar open time: 2024-07-17T00:00:00.000 == close pos time: 2024-07-24T00:00:00.000
2024-11-20 23:07:03,195 - INFO - pnl: 2024-07-16T23:59:59.999 178246.65437503575 === -2.495%
2024-11-20 23:07:03,199 - DEBUG - cur time: 2024-07-17T23:59:59.999 == next bar open time: 2024-07-18T00:00:00.000 == close pos time: 2024-07-25T00:00:00.000
2024-11-20 23:07:03,201 - INFO - pnl: 2024-07-17T23:59:59.999 176921.89014106776 === -0.743%
2024-11-20 23:07:03,205 - DEBUG - cur time: 2024-07-18T23:59:59.999 == next bar open time: 2024-07-19T00:00:00.000 == close pos time: 2024-07-26T00:00:00.000
2024-11-20 23:07:03,207 - INFO - pnl: 2024-07-18T23:59:59.999 174057.40474644667 === -1.619%
2024-11-20 23:07:03,211 - DEBUG - cur time: 2024-07-19T23:59:59.999 == next bar open time: 2024-07-20T00:00:00.000 == close pos time: 2024-07-27T00:00:00.000
2024-11-20 23:07:03,212 - INFO - pnl: 2024-07-19T23:59:59.999 177832.6036680446 === 2.169%
2024-11-20 23:07:03,216 - DEBUG - cur time: 2024-07-20T23:59:59.999 == next bar open time: 2024-07-21T00:00:00.000 == close pos time: 2024-07-28T00:00:00.000
2024-11-20 23:07:03,218 - INFO - pnl: 2024-07-20T23:59:59.999 178138.2148464795 === 0.172%
2024-11-20 23:07:03,223 - DEBUG - cur time: 2024-07-21T23:59:59.999 == next bar open time: 2024-07-22T00:00:00.000 == close pos time: 2024-07-29T00:00:00.000
2024-11-20 23:07:03,233 - DEBUG - sorted_long_factors: shape: (243, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ TONUSDT    ┆ -1.980064    ┆ 0    ┆ 242          │
│ JUPUSDT    ┆ -1.969324    ┆ 1    ┆ 241          │
│ ETHFIUSDT  ┆ -1.882365    ┆ 2    ┆ 240          │
│ STRKUSDT   ┆ -1.839332    ┆ 3    ┆ 239          │
│ PIXELUSDT  ┆ -1.733073    ┆ 4    ┆ 238          │
│ TAOUSDT    ┆ -1.695559    ┆ 5    ┆ 237          │
│ XAIUSDT    ┆ -1.682881    ┆ 6    ┆ 236          │
│ ZETAUSDT   ┆ -1.682557    ┆ 7    ┆ 235          │
│ MANTAUSDT  ┆ -1.677285    ┆ 8    ┆ 234          │
│ PORTALUSDT ┆ -1.671775    ┆ 9    ┆ 233          │
│ …          ┆ …            ┆ …    ┆ …            │
│ AMBUSDT    ┆ 0.058435     ┆ 233  ┆ 9            │
│ LQTYUSDT   ┆ 0.088823     ┆ 234  ┆ 8            │
│ STORJUSDT  ┆ 0.092153     ┆ 235  ┆ 7            │
│ NKNUSDT    ┆ 0.111142     ┆ 236  ┆ 6            │
│ BNTUSDT    ┆ 0.173599     ┆ 237  ┆ 5            │
│ ORBSUSDT   ┆ 0.185312     ┆ 238  ┆ 4            │
│ ETHWUSDT   ┆ 0.269151     ┆ 239  ┆ 3            │
│ HFTUSDT    ┆ 0.549972     ┆ 240  ┆ 2            │
│ DODOXUSDT  ┆ 0.775947     ┆ 241  ┆ 1            │
│ DEFIUSDT   ┆ 1.691976     ┆ 242  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:03,241 - WARNING - 2024-07-21T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:03,241 - INFO - cur close time: 2024-07-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:03,242 - DEBUG - mean expected ret (mean factor): -0.8047064892029141
2024-11-20 23:07:03,247 - DEBUG - begin to update pos: =========
2024-11-20 23:07:03,247 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,247 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.032466    ┆ 0.20574     ┆ 0.09096     ┆ 0.0124954   ┆ … ┆ 0.0181  ┆ null   ┆ null    ┆ 0.3929  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,254 - DEBUG - update position: 2024-07-21T23:59:59.999 === diff_trading_value: 300505.2824651557 == cash: 180392.4178783411 
2024-11-20 23:07:03,257 - INFO - pnl: 2024-07-21T23:59:59.999 180392.4178783411 === 1.265%
2024-11-20 23:07:03,263 - DEBUG - cur time: 2024-07-22T23:59:59.999 == next bar open time: 2024-07-23T00:00:00.000 == close pos time: 2024-07-30T00:00:00.000
2024-11-20 23:07:03,265 - INFO - pnl: 2024-07-22T23:59:59.999 181051.41127488378 === 0.365%
2024-11-20 23:07:03,271 - DEBUG - cur time: 2024-07-23T23:59:59.999 == next bar open time: 2024-07-24T00:00:00.000 == close pos time: 2024-07-31T00:00:00.000
2024-11-20 23:07:03,272 - INFO - pnl: 2024-07-23T23:59:59.999 181571.1475880715 === 0.287%
2024-11-20 23:07:03,276 - DEBUG - cur time: 2024-07-24T23:59:59.999 == next bar open time: 2024-07-25T00:00:00.000 == close pos time: 2024-08-01T00:00:00.000
2024-11-20 23:07:03,278 - INFO - pnl: 2024-07-24T23:59:59.999 182696.49485378788 === 0.620%
2024-11-20 23:07:03,282 - DEBUG - cur time: 2024-07-25T23:59:59.999 == next bar open time: 2024-07-26T00:00:00.000 == close pos time: 2024-08-02T00:00:00.000
2024-11-20 23:07:03,283 - INFO - pnl: 2024-07-25T23:59:59.999 183509.6104741015 === 0.445%
2024-11-20 23:07:03,289 - DEBUG - cur time: 2024-07-26T23:59:59.999 == next bar open time: 2024-07-27T00:00:00.000 == close pos time: 2024-08-03T00:00:00.000
2024-11-20 23:07:03,291 - INFO - pnl: 2024-07-26T23:59:59.999 183224.2907812936 === -0.155%
2024-11-20 23:07:03,296 - DEBUG - cur time: 2024-07-27T23:59:59.999 == next bar open time: 2024-07-28T00:00:00.000 == close pos time: 2024-08-04T00:00:00.000
2024-11-20 23:07:03,298 - INFO - pnl: 2024-07-27T23:59:59.999 184930.25805042373 === 0.931%
2024-11-20 23:07:03,303 - DEBUG - cur time: 2024-07-28T23:59:59.999 == next bar open time: 2024-07-29T00:00:00.000 == close pos time: 2024-08-05T00:00:00.000
2024-11-20 23:07:03,317 - DEBUG - sorted_long_factors: shape: (244, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ XMRUSDT   ┆ -2.397628    ┆ 0    ┆ 243          │
│ JUPUSDT   ┆ -1.97561     ┆ 1    ┆ 242          │
│ ETHFIUSDT ┆ -1.941806    ┆ 2    ┆ 241          │
│ OMUSDT    ┆ -1.873583    ┆ 3    ┆ 240          │
│ WLDUSDT   ┆ -1.757648    ┆ 4    ┆ 239          │
│ TIAUSDT   ┆ -1.71931     ┆ 5    ┆ 238          │
│ TNSRUSDT  ┆ -1.694784    ┆ 6    ┆ 237          │
│ WUSDT     ┆ -1.689041    ┆ 7    ┆ 236          │
│ STRKUSDT  ┆ -1.684277    ┆ 8    ┆ 235          │
│ ONDOUSDT  ┆ -1.657661    ┆ 9    ┆ 234          │
│ …         ┆ …            ┆ …    ┆ …            │
│ RLCUSDT   ┆ 0.05291      ┆ 234  ┆ 9            │
│ ATAUSDT   ┆ 0.135241     ┆ 235  ┆ 8            │
│ ALPHAUSDT ┆ 0.14506      ┆ 236  ┆ 7            │
│ PERPUSDT  ┆ 0.171105     ┆ 237  ┆ 6            │
│ XVGUSDT   ┆ 0.368882     ┆ 238  ┆ 5            │
│ LQTYUSDT  ┆ 0.379672     ┆ 239  ┆ 4            │
│ BICOUSDT  ┆ 0.588725     ┆ 240  ┆ 3            │
│ DODOXUSDT ┆ 0.729593     ┆ 241  ┆ 2            │
│ NMRUSDT   ┆ 0.782022     ┆ 242  ┆ 1            │
│ DEFIUSDT  ┆ 1.446345     ┆ 243  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:03,324 - WARNING - 2024-07-28T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:03,324 - INFO - cur close time: 2024-07-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:03,324 - DEBUG - mean expected ret (mean factor): -0.7996316833186428
2024-11-20 23:07:03,329 - DEBUG - begin to update pos: =========
2024-11-20 23:07:03,329 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,330 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.027994    ┆ 0.17274     ┆ 0.0828      ┆ 0.0117397   ┆ … ┆ 0.01711 ┆ null   ┆ null    ┆ 0.3751  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,337 - DEBUG - update position: 2024-07-28T23:59:59.999 === diff_trading_value: 264085.79374629003 == cash: 185540.07228447867 
2024-11-20 23:07:03,338 - INFO - pnl: 2024-07-28T23:59:59.999 185540.07228447867 === 0.330%
2024-11-20 23:07:03,342 - DEBUG - cur time: 2024-07-29T23:59:59.999 == next bar open time: 2024-07-30T00:00:00.000 == close pos time: 2024-08-06T00:00:00.000
2024-11-20 23:07:03,344 - INFO - pnl: 2024-07-29T23:59:59.999 187531.85451062693 === 1.074%
2024-11-20 23:07:03,348 - DEBUG - cur time: 2024-07-30T23:59:59.999 == next bar open time: 2024-07-31T00:00:00.000 == close pos time: 2024-08-07T00:00:00.000
2024-11-20 23:07:03,350 - INFO - pnl: 2024-07-30T23:59:59.999 187107.5415694379 === -0.226%
2024-11-20 23:07:03,356 - DEBUG - cur time: 2024-07-31T23:59:59.999 == next bar open time: 2024-08-01T00:00:00.000 == close pos time: 2024-08-08T00:00:00.000
2024-11-20 23:07:03,360 - INFO - pnl: 2024-07-31T23:59:59.999 187819.05344049312 === 0.380%
2024-11-20 23:07:03,366 - DEBUG - cur time: 2024-08-01T23:59:59.999 == next bar open time: 2024-08-02T00:00:00.000 == close pos time: 2024-08-09T00:00:00.000
2024-11-20 23:07:03,371 - INFO - pnl: 2024-08-01T23:59:59.999 186682.4816456378 === -0.605%
2024-11-20 23:07:03,378 - DEBUG - cur time: 2024-08-02T23:59:59.999 == next bar open time: 2024-08-03T00:00:00.000 == close pos time: 2024-08-10T00:00:00.000
2024-11-20 23:07:03,380 - INFO - pnl: 2024-08-02T23:59:59.999 186663.17392261646 === -0.010%
2024-11-20 23:07:03,389 - DEBUG - cur time: 2024-08-03T23:59:59.999 == next bar open time: 2024-08-04T00:00:00.000 == close pos time: 2024-08-11T00:00:00.000
2024-11-20 23:07:03,393 - INFO - pnl: 2024-08-03T23:59:59.999 187911.36191360923 === 0.669%
2024-11-20 23:07:03,397 - DEBUG - cur time: 2024-08-04T23:59:59.999 == next bar open time: 2024-08-05T00:00:00.000 == close pos time: 2024-08-12T00:00:00.000
2024-11-20 23:07:03,410 - DEBUG - sorted_long_factors: shape: (244, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ AAVEUSDT  ┆ -1.907246    ┆ 0    ┆ 243          │
│ TONUSDT   ┆ -1.840129    ┆ 1    ┆ 242          │
│ JUPUSDT   ┆ -1.79546     ┆ 2    ┆ 241          │
│ MAVIAUSDT ┆ -1.792558    ┆ 3    ┆ 240          │
│ BOMEUSDT  ┆ -1.719608    ┆ 4    ┆ 239          │
│ SAGAUSDT  ┆ -1.712237    ┆ 5    ┆ 238          │
│ USDCUSDT  ┆ -1.663841    ┆ 6    ┆ 237          │
│ TRBUSDT   ┆ -1.660013    ┆ 7    ┆ 236          │
│ OMUSDT    ┆ -1.648179    ┆ 8    ┆ 235          │
│ AMBUSDT   ┆ -1.593976    ┆ 9    ┆ 234          │
│ …         ┆ …            ┆ …    ┆ …            │
│ PERPUSDT  ┆ 0.203678     ┆ 234  ┆ 9            │
│ BICOUSDT  ┆ 0.21116      ┆ 235  ┆ 8            │
│ BELUSDT   ┆ 0.230466     ┆ 236  ┆ 7            │
│ JOEUSDT   ┆ 0.247361     ┆ 237  ┆ 6            │
│ ATAUSDT   ┆ 0.257311     ┆ 238  ┆ 5            │
│ MOVRUSDT  ┆ 0.365068     ┆ 239  ┆ 4            │
│ BNTUSDT   ┆ 0.376838     ┆ 240  ┆ 3            │
│ AGLDUSDT  ┆ 0.424384     ┆ 241  ┆ 2            │
│ ETHWUSDT  ┆ 0.559841     ┆ 242  ┆ 1            │
│ DEFIUSDT  ┆ 1.792639     ┆ 243  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:03,421 - WARNING - 2024-08-04T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:03,421 - INFO - cur close time: 2024-08-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:03,421 - DEBUG - mean expected ret (mean factor): -0.8017600230374541
2024-11-20 23:07:03,427 - DEBUG - begin to update pos: =========
2024-11-20 23:07:03,427 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,427 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.019815    ┆ 0.12196     ┆ 0.06636     ┆ 0.0080937   ┆ … ┆ 0.01351 ┆ null   ┆ null    ┆ 0.2881  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,438 - DEBUG - update position: 2024-08-04T23:59:59.999 === diff_trading_value: 260429.54973217504 == cash: 187080.93662376734 
2024-11-20 23:07:03,440 - INFO - pnl: 2024-08-04T23:59:59.999 187080.93662376734 === -0.442%
2024-11-20 23:07:03,446 - DEBUG - cur time: 2024-08-05T23:59:59.999 == next bar open time: 2024-08-06T00:00:00.000 == close pos time: 2024-08-13T00:00:00.000
2024-11-20 23:07:03,450 - INFO - pnl: 2024-08-05T23:59:59.999 187583.0537072536 === 0.268%
2024-11-20 23:07:03,457 - DEBUG - cur time: 2024-08-06T23:59:59.999 == next bar open time: 2024-08-07T00:00:00.000 == close pos time: 2024-08-14T00:00:00.000
2024-11-20 23:07:03,460 - INFO - pnl: 2024-08-06T23:59:59.999 182427.37774898822 === -2.748%
2024-11-20 23:07:03,466 - DEBUG - cur time: 2024-08-07T23:59:59.999 == next bar open time: 2024-08-08T00:00:00.000 == close pos time: 2024-08-15T00:00:00.000
2024-11-20 23:07:03,470 - INFO - pnl: 2024-08-07T23:59:59.999 183935.73984848766 === 0.827%
2024-11-20 23:07:03,479 - DEBUG - cur time: 2024-08-08T23:59:59.999 == next bar open time: 2024-08-09T00:00:00.000 == close pos time: 2024-08-16T00:00:00.000
2024-11-20 23:07:03,482 - INFO - pnl: 2024-08-08T23:59:59.999 182260.5668095341 === -0.911%
2024-11-20 23:07:03,487 - DEBUG - cur time: 2024-08-09T23:59:59.999 == next bar open time: 2024-08-10T00:00:00.000 == close pos time: 2024-08-17T00:00:00.000
2024-11-20 23:07:03,491 - INFO - pnl: 2024-08-09T23:59:59.999 182608.34232363434 === 0.191%
2024-11-20 23:07:03,499 - DEBUG - cur time: 2024-08-10T23:59:59.999 == next bar open time: 2024-08-11T00:00:00.000 == close pos time: 2024-08-18T00:00:00.000
2024-11-20 23:07:03,501 - INFO - pnl: 2024-08-10T23:59:59.999 182832.96027484443 === 0.123%
2024-11-20 23:07:03,505 - DEBUG - cur time: 2024-08-11T23:59:59.999 == next bar open time: 2024-08-12T00:00:00.000 == close pos time: 2024-08-19T00:00:00.000
2024-11-20 23:07:03,523 - DEBUG - sorted_long_factors: shape: (245, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ FXSUSDT    ┆ -2.45686     ┆ 0    ┆ 244          │
│ GLMUSDT    ┆ -2.351197    ┆ 1    ┆ 243          │
│ BTCDOMUSDT ┆ -2.324289    ┆ 2    ┆ 242          │
│ ACEUSDT    ┆ -2.264954    ┆ 3    ┆ 241          │
│ ZETAUSDT   ┆ -2.187049    ┆ 4    ┆ 240          │
│ TONUSDT    ┆ -2.075253    ┆ 5    ┆ 239          │
│ USDCUSDT   ┆ -2.043773    ┆ 6    ┆ 238          │
│ AAVEUSDT   ┆ -1.971203    ┆ 7    ┆ 237          │
│ TRXUSDT    ┆ -1.96796     ┆ 8    ┆ 236          │
│ STMXUSDT   ┆ -1.847956    ┆ 9    ┆ 235          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BNTUSDT    ┆ 0.145421     ┆ 235  ┆ 9            │
│ NMRUSDT    ┆ 0.245357     ┆ 236  ┆ 8            │
│ PERPUSDT   ┆ 0.265918     ┆ 237  ┆ 7            │
│ ETHWUSDT   ┆ 0.347193     ┆ 238  ┆ 6            │
│ MOVRUSDT   ┆ 0.375468     ┆ 239  ┆ 5            │
│ NTRNUSDT   ┆ 0.410914     ┆ 240  ┆ 4            │
│ AGLDUSDT   ┆ 0.531134     ┆ 241  ┆ 3            │
│ DODOXUSDT  ┆ 0.568964     ┆ 242  ┆ 2            │
│ JOEUSDT    ┆ 0.573786     ┆ 243  ┆ 1            │
│ DEFIUSDT   ┆ 1.646392     ┆ 244  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:03,538 - WARNING - 2024-08-11T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:03,538 - INFO - cur close time: 2024-08-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:03,539 - DEBUG - mean expected ret (mean factor): -0.8099727511706051
2024-11-20 23:07:03,545 - DEBUG - begin to update pos: =========
2024-11-20 23:07:03,545 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,546 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.018804    ┆ 0.11733     ┆ 0.0773      ┆ 0.007718    ┆ … ┆ 0.01333 ┆ null   ┆ null    ┆ 0.2927  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,558 - DEBUG - update position: 2024-08-11T23:59:59.999 === diff_trading_value: 237618.28654909862 == cash: 184557.66505644462 
2024-11-20 23:07:03,560 - INFO - pnl: 2024-08-11T23:59:59.999 184557.66505644462 === 0.943%
2024-11-20 23:07:03,566 - DEBUG - cur time: 2024-08-12T23:59:59.999 == next bar open time: 2024-08-13T00:00:00.000 == close pos time: 2024-08-20T00:00:00.000
2024-11-20 23:07:03,570 - INFO - pnl: 2024-08-12T23:59:59.999 187685.32249476417 === 1.695%
2024-11-20 23:07:03,579 - DEBUG - cur time: 2024-08-13T23:59:59.999 == next bar open time: 2024-08-14T00:00:00.000 == close pos time: 2024-08-21T00:00:00.000
2024-11-20 23:07:03,582 - INFO - pnl: 2024-08-13T23:59:59.999 188302.3326939948 === 0.329%
2024-11-20 23:07:03,588 - DEBUG - cur time: 2024-08-14T23:59:59.999 == next bar open time: 2024-08-15T00:00:00.000 == close pos time: 2024-08-22T00:00:00.000
2024-11-20 23:07:03,590 - INFO - pnl: 2024-08-14T23:59:59.999 185422.50160973403 === -1.529%
2024-11-20 23:07:03,597 - DEBUG - cur time: 2024-08-15T23:59:59.999 == next bar open time: 2024-08-16T00:00:00.000 == close pos time: 2024-08-23T00:00:00.000
2024-11-20 23:07:03,599 - INFO - pnl: 2024-08-15T23:59:59.999 183556.95329035557 === -1.006%
2024-11-20 23:07:03,605 - DEBUG - cur time: 2024-08-16T23:59:59.999 == next bar open time: 2024-08-17T00:00:00.000 == close pos time: 2024-08-24T00:00:00.000
2024-11-20 23:07:03,608 - INFO - pnl: 2024-08-16T23:59:59.999 183241.93127858776 === -0.172%
2024-11-20 23:07:03,613 - DEBUG - cur time: 2024-08-17T23:59:59.999 == next bar open time: 2024-08-18T00:00:00.000 == close pos time: 2024-08-25T00:00:00.000
2024-11-20 23:07:03,614 - INFO - pnl: 2024-08-17T23:59:59.999 185855.4557913624 === 1.426%
2024-11-20 23:07:03,619 - DEBUG - cur time: 2024-08-18T23:59:59.999 == next bar open time: 2024-08-19T00:00:00.000 == close pos time: 2024-08-26T00:00:00.000
2024-11-20 23:07:03,630 - DEBUG - sorted_long_factors: shape: (245, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ AAVEUSDT    ┆ -2.147882    ┆ 0    ┆ 244          │
│ TONUSDT     ┆ -2.131845    ┆ 1    ┆ 243          │
│ AUCTIONUSDT ┆ -1.989735    ┆ 2    ┆ 242          │
│ PENDLEUSDT  ┆ -1.85426     ┆ 3    ┆ 241          │
│ GMXUSDT     ┆ -1.73745     ┆ 4    ┆ 240          │
│ ALICEUSDT   ┆ -1.728004    ┆ 5    ┆ 239          │
│ APTUSDT     ┆ -1.667092    ┆ 6    ┆ 238          │
│ AEVOUSDT    ┆ -1.6644      ┆ 7    ┆ 237          │
│ DYMUSDT     ┆ -1.642548    ┆ 8    ┆ 236          │
│ ORDIUSDT    ┆ -1.619175    ┆ 9    ┆ 235          │
│ …           ┆ …            ┆ …    ┆ …            │
│ OMGUSDT     ┆ 0.039927     ┆ 235  ┆ 9            │
│ HFTUSDT     ┆ 0.10585      ┆ 236  ┆ 8            │
│ DODOXUSDT   ┆ 0.179999     ┆ 237  ┆ 7            │
│ AGLDUSDT    ┆ 0.227358     ┆ 238  ┆ 6            │
│ OXTUSDT     ┆ 0.378749     ┆ 239  ┆ 5            │
│ ATAUSDT     ┆ 0.391342     ┆ 240  ┆ 4            │
│ RLCUSDT     ┆ 0.397161     ┆ 241  ┆ 3            │
│ NKNUSDT     ┆ 0.433307     ┆ 242  ┆ 2            │
│ JOEUSDT     ┆ 0.882774     ┆ 243  ┆ 1            │
│ DEFIUSDT    ┆ 1.529778     ┆ 244  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:03,638 - WARNING - 2024-08-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:03,639 - INFO - cur close time: 2024-08-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:03,639 - DEBUG - mean expected ret (mean factor): -0.800585168560512
2024-11-20 23:07:03,643 - DEBUG - begin to update pos: =========
2024-11-20 23:07:03,645 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,645 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.017652    ┆ 0.11428     ┆ 0.07724     ┆ 0.0072881   ┆ … ┆ 0.01335 ┆ null   ┆ null    ┆ 0.3017  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,651 - DEBUG - update position: 2024-08-18T23:59:59.999 === diff_trading_value: 259162.38460569264 == cash: 188024.7618547957 
2024-11-20 23:07:03,652 - INFO - pnl: 2024-08-18T23:59:59.999 188024.7618547957 === 1.167%
2024-11-20 23:07:03,656 - DEBUG - cur time: 2024-08-19T23:59:59.999 == next bar open time: 2024-08-20T00:00:00.000 == close pos time: 2024-08-27T00:00:00.000
2024-11-20 23:07:03,658 - INFO - pnl: 2024-08-19T23:59:59.999 189250.8187783738 === 0.652%
2024-11-20 23:07:03,662 - DEBUG - cur time: 2024-08-20T23:59:59.999 == next bar open time: 2024-08-21T00:00:00.000 == close pos time: 2024-08-28T00:00:00.000
2024-11-20 23:07:03,665 - INFO - pnl: 2024-08-20T23:59:59.999 187727.38071028478 === -0.805%
2024-11-20 23:07:03,670 - DEBUG - cur time: 2024-08-21T23:59:59.999 == next bar open time: 2024-08-22T00:00:00.000 == close pos time: 2024-08-29T00:00:00.000
2024-11-20 23:07:03,672 - INFO - pnl: 2024-08-21T23:59:59.999 188273.23915563524 === 0.291%
2024-11-20 23:07:03,676 - DEBUG - cur time: 2024-08-22T23:59:59.999 == next bar open time: 2024-08-23T00:00:00.000 == close pos time: 2024-08-30T00:00:00.000
2024-11-20 23:07:03,678 - INFO - pnl: 2024-08-22T23:59:59.999 192679.92776713351 === 2.341%
2024-11-20 23:07:03,683 - DEBUG - cur time: 2024-08-23T23:59:59.999 == next bar open time: 2024-08-24T00:00:00.000 == close pos time: 2024-08-31T00:00:00.000
2024-11-20 23:07:03,685 - INFO - pnl: 2024-08-23T23:59:59.999 192365.55930503493 === -0.163%
2024-11-20 23:07:03,689 - DEBUG - cur time: 2024-08-24T23:59:59.999 == next bar open time: 2024-08-25T00:00:00.000 == close pos time: 2024-09-01T00:00:00.000
2024-11-20 23:07:03,692 - INFO - pnl: 2024-08-24T23:59:59.999 192587.26564095737 === 0.115%
2024-11-20 23:07:03,696 - DEBUG - cur time: 2024-08-25T23:59:59.999 == next bar open time: 2024-08-26T00:00:00.000 == close pos time: 2024-09-02T00:00:00.000
2024-11-20 23:07:03,708 - DEBUG - sorted_long_factors: shape: (247, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TAOUSDT      ┆ -1.934405    ┆ 0    ┆ 246          │
│ AUCTIONUSDT  ┆ -1.878312    ┆ 1    ┆ 245          │
│ ETHFIUSDT    ┆ -1.558349    ┆ 2    ┆ 244          │
│ NOTUSDT      ┆ -1.55546     ┆ 3    ┆ 243          │
│ GMXUSDT      ┆ -1.551092    ┆ 4    ┆ 242          │
│ ATOMUSDT     ┆ -1.539538    ┆ 5    ┆ 241          │
│ 1000LUNCUSDT ┆ -1.536703    ┆ 6    ┆ 240          │
│ ICPUSDT      ┆ -1.532048    ┆ 7    ┆ 239          │
│ DOTUSDT      ┆ -1.516723    ┆ 8    ┆ 238          │
│ LUNA2USDT    ┆ -1.512298    ┆ 9    ┆ 237          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BICOUSDT     ┆ -0.031465    ┆ 237  ┆ 9            │
│ PERPUSDT     ┆ -0.014298    ┆ 238  ┆ 8            │
│ XVGUSDT      ┆ 0.084808     ┆ 239  ┆ 7            │
│ OMGUSDT      ┆ 0.14773      ┆ 240  ┆ 6            │
│ AGLDUSDT     ┆ 0.256131     ┆ 241  ┆ 5            │
│ STEEMUSDT    ┆ 0.341805     ┆ 242  ┆ 4            │
│ OXTUSDT      ┆ 0.426989     ┆ 243  ┆ 3            │
│ ETHWUSDT     ┆ 0.616986     ┆ 244  ┆ 2            │
│ HFTUSDT      ┆ 0.766161     ┆ 245  ┆ 1            │
│ DEFIUSDT     ┆ 1.515688     ┆ 246  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:03,718 - WARNING - 2024-08-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:03,718 - INFO - cur close time: 2024-08-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:03,718 - DEBUG - mean expected ret (mean factor): -0.7860248759920421
2024-11-20 23:07:03,723 - DEBUG - begin to update pos: =========
2024-11-20 23:07:03,723 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,724 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.021019    ┆ 0.15013     ┆ 0.09276     ┆ 0.0091358   ┆ … ┆ 0.01543 ┆ null   ┆ null    ┆ 0.3416  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,735 - DEBUG - update position: 2024-08-25T23:59:59.999 === diff_trading_value: 307294.24884564977 == cash: 192155.47741948988 
2024-11-20 23:07:03,736 - INFO - pnl: 2024-08-25T23:59:59.999 192155.47741948988 === -0.224%
2024-11-20 23:07:03,741 - DEBUG - cur time: 2024-08-26T23:59:59.999 == next bar open time: 2024-08-27T00:00:00.000 == close pos time: 2024-09-03T00:00:00.000
2024-11-20 23:07:03,743 - INFO - pnl: 2024-08-26T23:59:59.999 192716.95035965834 === 0.292%
2024-11-20 23:07:03,746 - DEBUG - cur time: 2024-08-27T23:59:59.999 == next bar open time: 2024-08-28T00:00:00.000 == close pos time: 2024-09-04T00:00:00.000
2024-11-20 23:07:03,748 - INFO - pnl: 2024-08-27T23:59:59.999 191421.32046450698 === -0.672%
2024-11-20 23:07:03,755 - DEBUG - cur time: 2024-08-28T23:59:59.999 == next bar open time: 2024-08-29T00:00:00.000 == close pos time: 2024-09-05T00:00:00.000
2024-11-20 23:07:03,757 - INFO - pnl: 2024-08-28T23:59:59.999 190958.40195145324 === -0.242%
2024-11-20 23:07:03,762 - DEBUG - cur time: 2024-08-29T23:59:59.999 == next bar open time: 2024-08-30T00:00:00.000 == close pos time: 2024-09-06T00:00:00.000
2024-11-20 23:07:03,763 - INFO - pnl: 2024-08-29T23:59:59.999 191158.92487710333 === 0.105%
2024-11-20 23:07:03,766 - DEBUG - cur time: 2024-08-30T23:59:59.999 == next bar open time: 2024-08-31T00:00:00.000 == close pos time: 2024-09-07T00:00:00.000
2024-11-20 23:07:03,768 - INFO - pnl: 2024-08-30T23:59:59.999 191833.7504669335 === 0.353%
2024-11-20 23:07:03,772 - DEBUG - cur time: 2024-08-31T23:59:59.999 == next bar open time: 2024-09-01T00:00:00.000 == close pos time: 2024-09-08T00:00:00.000
2024-11-20 23:07:03,773 - INFO - pnl: 2024-08-31T23:59:59.999 191612.67503849012 === -0.115%
2024-11-20 23:07:03,778 - DEBUG - cur time: 2024-09-01T23:59:59.999 == next bar open time: 2024-09-02T00:00:00.000 == close pos time: 2024-09-09T00:00:00.000
2024-11-20 23:07:03,789 - DEBUG - sorted_long_factors: shape: (246, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ AUCTIONUSDT ┆ -2.06294     ┆ 0    ┆ 245          │
│ TONUSDT     ┆ -1.830145    ┆ 1    ┆ 244          │
│ ETHFIUSDT   ┆ -1.798839    ┆ 2    ┆ 243          │
│ BTCDOMUSDT  ┆ -1.791413    ┆ 3    ┆ 242          │
│ GMXUSDT     ┆ -1.774569    ┆ 4    ┆ 241          │
│ XMRUSDT     ┆ -1.755901    ┆ 5    ┆ 240          │
│ TAOUSDT     ┆ -1.715368    ┆ 6    ┆ 239          │
│ BONDUSDT    ┆ -1.707181    ┆ 7    ┆ 238          │
│ OMNIUSDT    ┆ -1.628011    ┆ 8    ┆ 237          │
│ ZECUSDT     ┆ -1.620502    ┆ 9    ┆ 236          │
│ …           ┆ …            ┆ …    ┆ …            │
│ BLZUSDT     ┆ 0.079858     ┆ 236  ┆ 9            │
│ OMGUSDT     ┆ 0.201451     ┆ 237  ┆ 8            │
│ PERPUSDT    ┆ 0.268732     ┆ 238  ┆ 7            │
│ AGLDUSDT    ┆ 0.356929     ┆ 239  ┆ 6            │
│ WAXPUSDT    ┆ 0.383993     ┆ 240  ┆ 5            │
│ OXTUSDT     ┆ 0.475232     ┆ 241  ┆ 4            │
│ XVGUSDT     ┆ 0.636162     ┆ 242  ┆ 3            │
│ STEEMUSDT   ┆ 0.650817     ┆ 243  ┆ 2            │
│ ETHWUSDT    ┆ 1.146215     ┆ 244  ┆ 1            │
│ DEFIUSDT    ┆ 1.605066     ┆ 245  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:03,798 - WARNING - 2024-09-01T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:03,798 - INFO - cur close time: 2024-09-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:03,798 - DEBUG - mean expected ret (mean factor): -0.7733835504671634
2024-11-20 23:07:03,803 - DEBUG - begin to update pos: =========
2024-11-20 23:07:03,804 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,804 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.016452    ┆ 0.11649     ┆ 0.07377     ┆ 0.00713     ┆ … ┆ 0.01282 ┆ null   ┆ null    ┆ 0.276   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,811 - DEBUG - update position: 2024-09-01T23:59:59.999 === diff_trading_value: 194607.07518019516 == cash: 191867.46401459893 
2024-11-20 23:07:03,813 - INFO - pnl: 2024-09-01T23:59:59.999 191867.46401459893 === 0.133%
2024-11-20 23:07:03,819 - DEBUG - cur time: 2024-09-02T23:59:59.999 == next bar open time: 2024-09-03T00:00:00.000 == close pos time: 2024-09-10T00:00:00.000
2024-11-20 23:07:03,821 - INFO - pnl: 2024-09-02T23:59:59.999 194808.18827238676 === 1.533%
2024-11-20 23:07:03,828 - DEBUG - cur time: 2024-09-03T23:59:59.999 == next bar open time: 2024-09-04T00:00:00.000 == close pos time: 2024-09-11T00:00:00.000
2024-11-20 23:07:03,831 - INFO - pnl: 2024-09-03T23:59:59.999 194650.37499223382 === -0.081%
2024-11-20 23:07:03,843 - DEBUG - cur time: 2024-09-04T23:59:59.999 == next bar open time: 2024-09-05T00:00:00.000 == close pos time: 2024-09-12T00:00:00.000
2024-11-20 23:07:03,847 - INFO - pnl: 2024-09-04T23:59:59.999 196333.46185706154 === 0.865%
2024-11-20 23:07:03,853 - DEBUG - cur time: 2024-09-05T23:59:59.999 == next bar open time: 2024-09-06T00:00:00.000 == close pos time: 2024-09-13T00:00:00.000
2024-11-20 23:07:03,856 - INFO - pnl: 2024-09-05T23:59:59.999 194410.67836735275 === -0.979%
2024-11-20 23:07:03,861 - DEBUG - cur time: 2024-09-06T23:59:59.999 == next bar open time: 2024-09-07T00:00:00.000 == close pos time: 2024-09-14T00:00:00.000
2024-11-20 23:07:03,864 - INFO - pnl: 2024-09-06T23:59:59.999 194859.23116718352 === 0.231%
2024-11-20 23:07:03,871 - DEBUG - cur time: 2024-09-07T23:59:59.999 == next bar open time: 2024-09-08T00:00:00.000 == close pos time: 2024-09-15T00:00:00.000
2024-11-20 23:07:03,872 - INFO - pnl: 2024-09-07T23:59:59.999 195317.49507440085 === 0.235%
2024-11-20 23:07:03,878 - DEBUG - cur time: 2024-09-08T23:59:59.999 == next bar open time: 2024-09-09T00:00:00.000 == close pos time: 2024-09-16T00:00:00.000
2024-11-20 23:07:03,892 - DEBUG - sorted_long_factors: shape: (247, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT       ┆ -2.040009    ┆ 0    ┆ 246          │
│ AAVEUSDT      ┆ -1.960441    ┆ 1    ┆ 245          │
│ XMRUSDT       ┆ -1.954865    ┆ 2    ┆ 244          │
│ FETUSDT       ┆ -1.742867    ┆ 3    ┆ 243          │
│ APTUSDT       ┆ -1.688894    ┆ 4    ┆ 242          │
│ NEOUSDT       ┆ -1.685754    ┆ 5    ┆ 241          │
│ BTCDOMUSDT    ┆ -1.65314     ┆ 6    ┆ 240          │
│ IMXUSDT       ┆ -1.632654    ┆ 7    ┆ 239          │
│ 1000FLOKIUSDT ┆ -1.626888    ┆ 8    ┆ 238          │
│ SUPERUSDT     ┆ -1.624484    ┆ 9    ┆ 237          │
│ …             ┆ …            ┆ …    ┆ …            │
│ BALUSDT       ┆ 0.234317     ┆ 237  ┆ 9            │
│ MAVIAUSDT     ┆ 0.265617     ┆ 238  ┆ 8            │
│ XVGUSDT       ┆ 0.290462     ┆ 239  ┆ 7            │
│ LSKUSDT       ┆ 0.319545     ┆ 240  ┆ 6            │
│ NTRNUSDT      ┆ 0.334948     ┆ 241  ┆ 5            │
│ DODOXUSDT     ┆ 0.552921     ┆ 242  ┆ 4            │
│ HFTUSDT       ┆ 0.580163     ┆ 243  ┆ 3            │
│ STEEMUSDT     ┆ 1.025358     ┆ 244  ┆ 2            │
│ ETHWUSDT      ┆ 1.167551     ┆ 245  ┆ 1            │
│ DEFIUSDT      ┆ 1.4123       ┆ 246  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:03,905 - INFO - cur close time: 2024-09-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:03,906 - DEBUG - mean expected ret (mean factor): -0.7660519845077174
2024-11-20 23:07:03,914 - DEBUG - begin to update pos: =========
2024-11-20 23:07:03,914 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,915 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.016409    ┆ 0.12338     ┆ 0.07689     ┆ 0.0070704   ┆ … ┆ 0.01286 ┆ null   ┆ null    ┆ 0.2719  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:03,933 - DEBUG - update position: 2024-09-08T23:59:59.999 === diff_trading_value: 260641.72710191834 == cash: 196095.975976849 
2024-11-20 23:07:03,937 - INFO - pnl: 2024-09-08T23:59:59.999 196095.975976849 === 0.399%
2024-11-20 23:07:03,941 - DEBUG - cur time: 2024-09-09T23:59:59.999 == next bar open time: 2024-09-10T00:00:00.000 == close pos time: 2024-09-17T00:00:00.000
2024-11-20 23:07:03,946 - INFO - pnl: 2024-09-09T23:59:59.999 196134.04600821226 === 0.019%
2024-11-20 23:07:03,952 - DEBUG - cur time: 2024-09-10T23:59:59.999 == next bar open time: 2024-09-11T00:00:00.000 == close pos time: 2024-09-18T00:00:00.000
2024-11-20 23:07:03,955 - INFO - pnl: 2024-09-10T23:59:59.999 192865.29326469533 === -1.667%
2024-11-20 23:07:03,961 - DEBUG - cur time: 2024-09-11T23:59:59.999 == next bar open time: 2024-09-12T00:00:00.000 == close pos time: 2024-09-19T00:00:00.000
2024-11-20 23:07:03,964 - INFO - pnl: 2024-09-11T23:59:59.999 192054.5734183442 === -0.420%
2024-11-20 23:07:03,969 - DEBUG - cur time: 2024-09-12T23:59:59.999 == next bar open time: 2024-09-13T00:00:00.000 == close pos time: 2024-09-20T00:00:00.000
2024-11-20 23:07:03,972 - INFO - pnl: 2024-09-12T23:59:59.999 195541.17939020172 === 1.815%
2024-11-20 23:07:03,978 - DEBUG - cur time: 2024-09-13T23:59:59.999 == next bar open time: 2024-09-14T00:00:00.000 == close pos time: 2024-09-21T00:00:00.000
2024-11-20 23:07:03,981 - INFO - pnl: 2024-09-13T23:59:59.999 195977.1587971084 === 0.223%
2024-11-20 23:07:03,989 - DEBUG - cur time: 2024-09-14T23:59:59.999 == next bar open time: 2024-09-15T00:00:00.000 == close pos time: 2024-09-22T00:00:00.000
2024-11-20 23:07:03,993 - INFO - pnl: 2024-09-14T23:59:59.999 196033.29794044554 === 0.029%
2024-11-20 23:07:03,996 - DEBUG - cur time: 2024-09-15T23:59:59.999 == next bar open time: 2024-09-16T00:00:00.000 == close pos time: 2024-09-23T00:00:00.000
2024-11-20 23:07:04,011 - DEBUG - sorted_long_factors: shape: (247, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BONDUSDT     ┆ -2.384131    ┆ 0    ┆ 246          │
│ TIAUSDT      ┆ -1.962199    ┆ 1    ┆ 245          │
│ XMRUSDT      ┆ -1.796316    ┆ 2    ┆ 244          │
│ AAVEUSDT     ┆ -1.751477    ┆ 3    ┆ 243          │
│ 1000LUNCUSDT ┆ -1.596645    ┆ 4    ┆ 242          │
│ FETUSDT      ┆ -1.578689    ┆ 5    ┆ 241          │
│ YFIUSDT      ┆ -1.560504    ┆ 6    ┆ 240          │
│ PENDLEUSDT   ┆ -1.552498    ┆ 7    ┆ 239          │
│ BOMEUSDT     ┆ -1.547632    ┆ 8    ┆ 238          │
│ TURBOUSDT    ┆ -1.547094    ┆ 9    ┆ 237          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BADGERUSDT   ┆ 0.162478     ┆ 237  ┆ 9            │
│ STEEMUSDT    ┆ 0.306669     ┆ 238  ┆ 8            │
│ MAVIAUSDT    ┆ 0.335064     ┆ 239  ┆ 7            │
│ BNTUSDT      ┆ 0.338389     ┆ 240  ┆ 6            │
│ FXSUSDT      ┆ 0.417983     ┆ 241  ┆ 5            │
│ BICOUSDT     ┆ 0.477462     ┆ 242  ┆ 4            │
│ COMBOUSDT    ┆ 0.502512     ┆ 243  ┆ 3            │
│ HFTUSDT      ┆ 0.575164     ┆ 244  ┆ 2            │
│ ETHWUSDT     ┆ 0.812434     ┆ 245  ┆ 1            │
│ DEFIUSDT     ┆ 1.40486      ┆ 246  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:04,024 - WARNING - 2024-09-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:04,024 - INFO - cur close time: 2024-09-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:04,024 - DEBUG - mean expected ret (mean factor): -0.7739532497101292
2024-11-20 23:07:04,030 - DEBUG - begin to update pos: =========
2024-11-20 23:07:04,030 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,031 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.016444    ┆ 0.12035     ┆ 0.08259     ┆ 0.0073499   ┆ … ┆ 0.01326 ┆ null   ┆ null    ┆ 0.2852  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,042 - DEBUG - update position: 2024-09-15T23:59:59.999 === diff_trading_value: 215131.16829560368 == cash: 194283.98747186922 
2024-11-20 23:07:04,043 - INFO - pnl: 2024-09-15T23:59:59.999 194283.98747186922 === -0.892%
2024-11-20 23:07:04,048 - DEBUG - cur time: 2024-09-16T23:59:59.999 == next bar open time: 2024-09-17T00:00:00.000 == close pos time: 2024-09-24T00:00:00.000
2024-11-20 23:07:04,050 - INFO - pnl: 2024-09-16T23:59:59.999 190800.4132681616 === -1.793%
2024-11-20 23:07:04,055 - DEBUG - cur time: 2024-09-17T23:59:59.999 == next bar open time: 2024-09-18T00:00:00.000 == close pos time: 2024-09-25T00:00:00.000
2024-11-20 23:07:04,057 - INFO - pnl: 2024-09-17T23:59:59.999 190380.7604151113 === -0.220%
2024-11-20 23:07:04,062 - DEBUG - cur time: 2024-09-18T23:59:59.999 == next bar open time: 2024-09-19T00:00:00.000 == close pos time: 2024-09-26T00:00:00.000
2024-11-20 23:07:04,063 - INFO - pnl: 2024-09-18T23:59:59.999 191851.47135973736 === 0.773%
2024-11-20 23:07:04,068 - DEBUG - cur time: 2024-09-19T23:59:59.999 == next bar open time: 2024-09-20T00:00:00.000 == close pos time: 2024-09-27T00:00:00.000
2024-11-20 23:07:04,070 - INFO - pnl: 2024-09-19T23:59:59.999 187858.81171446052 === -2.081%
2024-11-20 23:07:04,074 - DEBUG - cur time: 2024-09-20T23:59:59.999 == next bar open time: 2024-09-21T00:00:00.000 == close pos time: 2024-09-28T00:00:00.000
2024-11-20 23:07:04,076 - INFO - pnl: 2024-09-20T23:59:59.999 192395.3431452917 === 2.415%
2024-11-20 23:07:04,081 - DEBUG - cur time: 2024-09-21T23:59:59.999 == next bar open time: 2024-09-22T00:00:00.000 == close pos time: 2024-09-29T00:00:00.000
2024-11-20 23:07:04,083 - INFO - pnl: 2024-09-21T23:59:59.999 198019.5510889587 === 2.923%
2024-11-20 23:07:04,088 - DEBUG - cur time: 2024-09-22T23:59:59.999 == next bar open time: 2024-09-23T00:00:00.000 == close pos time: 2024-09-30T00:00:00.000
2024-11-20 23:07:04,098 - DEBUG - sorted_long_factors: shape: (248, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TAOUSDT      ┆ -2.237433    ┆ 0    ┆ 247          │
│ ETHFIUSDT    ┆ -1.900673    ┆ 1    ┆ 246          │
│ BTCDOMUSDT   ┆ -1.788625    ┆ 2    ┆ 245          │
│ PENDLEUSDT   ┆ -1.720064    ┆ 3    ┆ 244          │
│ IOUSDT       ┆ -1.603482    ┆ 4    ┆ 243          │
│ OMNIUSDT     ┆ -1.568752    ┆ 5    ┆ 242          │
│ ENSUSDT      ┆ -1.563477    ┆ 6    ┆ 241          │
│ NOTUSDT      ┆ -1.536107    ┆ 7    ┆ 240          │
│ WUSDT        ┆ -1.505187    ┆ 8    ┆ 239          │
│ 1000LUNCUSDT ┆ -1.472727    ┆ 9    ┆ 238          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RONINUSDT    ┆ 0.092242     ┆ 238  ┆ 9            │
│ DENTUSDT     ┆ 0.159096     ┆ 239  ┆ 8            │
│ ILVUSDT      ┆ 0.204841     ┆ 240  ┆ 7            │
│ FXSUSDT      ┆ 0.295407     ┆ 241  ┆ 6            │
│ CELRUSDT     ┆ 0.349192     ┆ 242  ┆ 5            │
│ BNTUSDT      ┆ 0.572883     ┆ 243  ┆ 4            │
│ BICOUSDT     ┆ 0.611215     ┆ 244  ┆ 3            │
│ COMBOUSDT    ┆ 0.617515     ┆ 245  ┆ 2            │
│ OXTUSDT      ┆ 0.644037     ┆ 246  ┆ 1            │
│ DEFIUSDT     ┆ 2.695374     ┆ 247  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:04,109 - WARNING - 2024-09-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:04,109 - INFO - cur close time: 2024-09-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:04,109 - DEBUG - mean expected ret (mean factor): -0.7575622653927421
2024-11-20 23:07:04,114 - DEBUG - begin to update pos: =========
2024-11-20 23:07:04,115 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,115 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.0171      ┆ 0.13003     ┆ 0.08428     ┆ 0.0080046   ┆ … ┆ 0.01492 ┆ null   ┆ null    ┆ 0.3236  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,123 - DEBUG - update position: 2024-09-22T23:59:59.999 === diff_trading_value: 266372.34739720315 == cash: 196331.20388347894 
2024-11-20 23:07:04,125 - INFO - pnl: 2024-09-22T23:59:59.999 196331.20388347894 === -0.853%
2024-11-20 23:07:04,129 - DEBUG - cur time: 2024-09-23T23:59:59.999 == next bar open time: 2024-09-24T00:00:00.000 == close pos time: 2024-10-01T00:00:00.000
2024-11-20 23:07:04,131 - INFO - pnl: 2024-09-23T23:59:59.999 195746.11929105013 === -0.298%
2024-11-20 23:07:04,137 - DEBUG - cur time: 2024-09-24T23:59:59.999 == next bar open time: 2024-09-25T00:00:00.000 == close pos time: 2024-10-02T00:00:00.000
2024-11-20 23:07:04,139 - INFO - pnl: 2024-09-24T23:59:59.999 196015.9838436878 === 0.138%
2024-11-20 23:07:04,142 - DEBUG - cur time: 2024-09-25T23:59:59.999 == next bar open time: 2024-09-26T00:00:00.000 == close pos time: 2024-10-03T00:00:00.000
2024-11-20 23:07:04,144 - INFO - pnl: 2024-09-25T23:59:59.999 194122.210033497 === -0.966%
2024-11-20 23:07:04,148 - DEBUG - cur time: 2024-09-26T23:59:59.999 == next bar open time: 2024-09-27T00:00:00.000 == close pos time: 2024-10-04T00:00:00.000
2024-11-20 23:07:04,151 - INFO - pnl: 2024-09-26T23:59:59.999 192349.3947852724 === -0.913%
2024-11-20 23:07:04,157 - DEBUG - cur time: 2024-09-27T23:59:59.999 == next bar open time: 2024-09-28T00:00:00.000 == close pos time: 2024-10-05T00:00:00.000
2024-11-20 23:07:04,159 - INFO - pnl: 2024-09-27T23:59:59.999 190115.95420691904 === -1.161%
2024-11-20 23:07:04,163 - DEBUG - cur time: 2024-09-28T23:59:59.999 == next bar open time: 2024-09-29T00:00:00.000 == close pos time: 2024-10-06T00:00:00.000
2024-11-20 23:07:04,164 - INFO - pnl: 2024-09-28T23:59:59.999 193464.82193732166 === 1.761%
2024-11-20 23:07:04,168 - DEBUG - cur time: 2024-09-29T23:59:59.999 == next bar open time: 2024-09-30T00:00:00.000 == close pos time: 2024-10-07T00:00:00.000
2024-11-20 23:07:04,180 - DEBUG - sorted_long_factors: shape: (252, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ SAGAUSDT  ┆ -2.01202     ┆ 0    ┆ 251          │
│ ETHFIUSDT ┆ -1.879177    ┆ 1    ┆ 250          │
│ TAOUSDT   ┆ -1.785559    ┆ 2    ┆ 249          │
│ WUSDT     ┆ -1.754292    ┆ 3    ┆ 248          │
│ ZROUSDT   ┆ -1.637938    ┆ 4    ┆ 247          │
│ TRBUSDT   ┆ -1.543043    ┆ 5    ┆ 246          │
│ BNBUSDT   ┆ -1.529678    ┆ 6    ┆ 245          │
│ JTOUSDT   ┆ -1.508106    ┆ 7    ┆ 244          │
│ TIAUSDT   ┆ -1.500721    ┆ 8    ┆ 243          │
│ INJUSDT   ┆ -1.482198    ┆ 9    ┆ 242          │
│ …         ┆ …            ┆ …    ┆ …            │
│ DUSKUSDT  ┆ 0.05316      ┆ 242  ┆ 9            │
│ LSKUSDT   ┆ 0.065238     ┆ 243  ┆ 8            │
│ JOEUSDT   ┆ 0.090163     ┆ 244  ┆ 7            │
│ CELRUSDT  ┆ 0.123463     ┆ 245  ┆ 6            │
│ STEEMUSDT ┆ 0.159822     ┆ 246  ┆ 5            │
│ COMBOUSDT ┆ 0.21787      ┆ 247  ┆ 4            │
│ XVGUSDT   ┆ 0.256552     ┆ 248  ┆ 3            │
│ BICOUSDT  ┆ 0.352105     ┆ 249  ┆ 2            │
│ HFTUSDT   ┆ 0.620544     ┆ 250  ┆ 1            │
│ DEFIUSDT  ┆ 2.041332     ┆ 251  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:04,188 - WARNING - 2024-09-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:04,188 - INFO - cur close time: 2024-09-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:04,189 - DEBUG - mean expected ret (mean factor): -0.7633387397938035
2024-11-20 23:07:04,193 - DEBUG - begin to update pos: =========
2024-11-20 23:07:04,193 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬──────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT  ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---      ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ f64      ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆          ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪══════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ -10000.0 ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴──────────┴─────────┘
2024-11-20 23:07:04,194 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.022926    ┆ 0.16206     ┆ 0.0991      ┆ 0.0112784  ┆ … ┆ 0.01602 ┆ 0.14636 ┆ 5.0065  ┆ 0.3605  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:04,201 - DEBUG - update position: 2024-09-29T23:59:59.999 === diff_trading_value: 258515.13678834477 == cash: 193013.859864492 
2024-11-20 23:07:04,203 - INFO - pnl: 2024-09-29T23:59:59.999 193013.859864492 === -0.233%
2024-11-20 23:07:04,208 - DEBUG - cur time: 2024-09-30T23:59:59.999 == next bar open time: 2024-10-01T00:00:00.000 == close pos time: 2024-10-08T00:00:00.000
2024-11-20 23:07:04,210 - INFO - pnl: 2024-09-30T23:59:59.999 191373.34956710672 === -0.850%
2024-11-20 23:07:04,214 - DEBUG - cur time: 2024-10-01T23:59:59.999 == next bar open time: 2024-10-02T00:00:00.000 == close pos time: 2024-10-09T00:00:00.000
2024-11-20 23:07:04,217 - INFO - pnl: 2024-10-01T23:59:59.999 190044.59217407345 === -0.694%
2024-11-20 23:07:04,221 - DEBUG - cur time: 2024-10-02T23:59:59.999 == next bar open time: 2024-10-03T00:00:00.000 == close pos time: 2024-10-10T00:00:00.000
2024-11-20 23:07:04,225 - INFO - pnl: 2024-10-02T23:59:59.999 188268.15289384665 === -0.935%
2024-11-20 23:07:04,231 - DEBUG - cur time: 2024-10-03T23:59:59.999 == next bar open time: 2024-10-04T00:00:00.000 == close pos time: 2024-10-11T00:00:00.000
2024-11-20 23:07:04,232 - INFO - pnl: 2024-10-03T23:59:59.999 190678.11355575465 === 1.280%
2024-11-20 23:07:04,237 - DEBUG - cur time: 2024-10-04T23:59:59.999 == next bar open time: 2024-10-05T00:00:00.000 == close pos time: 2024-10-12T00:00:00.000
2024-11-20 23:07:04,239 - INFO - pnl: 2024-10-04T23:59:59.999 188370.04836747987 === -1.210%
2024-11-20 23:07:04,244 - DEBUG - cur time: 2024-10-05T23:59:59.999 == next bar open time: 2024-10-06T00:00:00.000 == close pos time: 2024-10-13T00:00:00.000
2024-11-20 23:07:04,246 - INFO - pnl: 2024-10-05T23:59:59.999 188481.21684965788 === 0.059%
2024-11-20 23:07:04,252 - DEBUG - cur time: 2024-10-06T23:59:59.999 == next bar open time: 2024-10-07T00:00:00.000 == close pos time: 2024-10-14T00:00:00.000
2024-11-20 23:07:04,263 - DEBUG - sorted_long_factors: shape: (252, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ SUIUSDT   ┆ -2.036306    ┆ 0    ┆ 251          │
│ UNFIUSDT  ┆ -2.004685    ┆ 1    ┆ 250          │
│ ARUSDT    ┆ -1.992746    ┆ 2    ┆ 249          │
│ SAGAUSDT  ┆ -1.946856    ┆ 3    ┆ 248          │
│ XRPUSDT   ┆ -1.944912    ┆ 4    ┆ 247          │
│ WUSDT     ┆ -1.818025    ┆ 5    ┆ 246          │
│ GASUSDT   ┆ -1.76502     ┆ 6    ┆ 245          │
│ ZROUSDT   ┆ -1.72955     ┆ 7    ┆ 244          │
│ EDUUSDT   ┆ -1.696088    ┆ 8    ┆ 243          │
│ YFIUSDT   ┆ -1.693677    ┆ 9    ┆ 242          │
│ …         ┆ …            ┆ …    ┆ …            │
│ LSKUSDT   ┆ 0.359575     ┆ 242  ┆ 9            │
│ OXTUSDT   ┆ 0.372774     ┆ 243  ┆ 8            │
│ JOEUSDT   ┆ 0.37459      ┆ 244  ┆ 7            │
│ WAXPUSDT  ┆ 0.402085     ┆ 245  ┆ 6            │
│ BNXUSDT   ┆ 0.579121     ┆ 246  ┆ 5            │
│ HFTUSDT   ┆ 0.714954     ┆ 247  ┆ 4            │
│ BICOUSDT  ┆ 0.746186     ┆ 248  ┆ 3            │
│ PERPUSDT  ┆ 0.778367     ┆ 249  ┆ 2            │
│ STEEMUSDT ┆ 0.845036     ┆ 250  ┆ 1            │
│ DEFIUSDT  ┆ 1.754072     ┆ 251  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:04,270 - WARNING - 2024-10-06T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:04,270 - INFO - cur close time: 2024-10-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:04,271 - DEBUG - mean expected ret (mean factor): -0.7741348090320216
2024-11-20 23:07:04,275 - DEBUG - begin to update pos: =========
2024-11-20 23:07:04,275 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬──────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT  ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---      ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ f64      ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆          ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪══════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ -10000.0 ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴──────────┴─────────┘
2024-11-20 23:07:04,275 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.021919    ┆ 0.14036     ┆ 0.08986     ┆ 0.0102306  ┆ … ┆ 0.01448 ┆ 0.12892 ┆ 4.2333  ┆ 0.3238  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:04,283 - DEBUG - update position: 2024-10-06T23:59:59.999 === diff_trading_value: 201936.044362908 == cash: 187897.98136513264 
2024-11-20 23:07:04,285 - INFO - pnl: 2024-10-06T23:59:59.999 187897.98136513264 === -0.309%
2024-11-20 23:07:04,289 - DEBUG - cur time: 2024-10-07T23:59:59.999 == next bar open time: 2024-10-08T00:00:00.000 == close pos time: 2024-10-15T00:00:00.000
2024-11-20 23:07:04,291 - INFO - pnl: 2024-10-07T23:59:59.999 186535.9928246783 === -0.725%
2024-11-20 23:07:04,298 - DEBUG - cur time: 2024-10-08T23:59:59.999 == next bar open time: 2024-10-09T00:00:00.000 == close pos time: 2024-10-16T00:00:00.000
2024-11-20 23:07:04,301 - INFO - pnl: 2024-10-08T23:59:59.999 186235.53686526575 === -0.161%
2024-11-20 23:07:04,306 - DEBUG - cur time: 2024-10-09T23:59:59.999 == next bar open time: 2024-10-10T00:00:00.000 == close pos time: 2024-10-17T00:00:00.000
2024-11-20 23:07:04,308 - INFO - pnl: 2024-10-09T23:59:59.999 185133.881040628 === -0.592%
2024-11-20 23:07:04,313 - DEBUG - cur time: 2024-10-10T23:59:59.999 == next bar open time: 2024-10-11T00:00:00.000 == close pos time: 2024-10-18T00:00:00.000
2024-11-20 23:07:04,315 - INFO - pnl: 2024-10-10T23:59:59.999 186798.63266967965 === 0.899%
2024-11-20 23:07:04,320 - DEBUG - cur time: 2024-10-11T23:59:59.999 == next bar open time: 2024-10-12T00:00:00.000 == close pos time: 2024-10-19T00:00:00.000
2024-11-20 23:07:04,321 - INFO - pnl: 2024-10-11T23:59:59.999 184873.77753140798 === -1.030%
2024-11-20 23:07:04,325 - DEBUG - cur time: 2024-10-12T23:59:59.999 == next bar open time: 2024-10-13T00:00:00.000 == close pos time: 2024-10-20T00:00:00.000
2024-11-20 23:07:04,327 - INFO - pnl: 2024-10-12T23:59:59.999 186098.65862671708 === 0.663%
2024-11-20 23:07:04,331 - DEBUG - cur time: 2024-10-13T23:59:59.999 == next bar open time: 2024-10-14T00:00:00.000 == close pos time: 2024-10-21T00:00:00.000
2024-11-20 23:07:04,343 - DEBUG - sorted_long_factors: shape: (252, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ SUIUSDT    ┆ -1.969509    ┆ 0    ┆ 251          │
│ TIAUSDT    ┆ -1.891308    ┆ 1    ┆ 250          │
│ SEIUSDT    ┆ -1.878576    ┆ 2    ┆ 249          │
│ XRPUSDT    ┆ -1.864552    ┆ 3    ┆ 248          │
│ MINAUSDT   ┆ -1.819893    ┆ 4    ┆ 247          │
│ NEARUSDT   ┆ -1.796559    ┆ 5    ┆ 246          │
│ APTUSDT    ┆ -1.741171    ┆ 6    ┆ 245          │
│ ENAUSDT    ┆ -1.699945    ┆ 7    ┆ 244          │
│ DYDXUSDT   ┆ -1.698939    ┆ 8    ┆ 243          │
│ UNFIUSDT   ┆ -1.686607    ┆ 9    ┆ 242          │
│ …          ┆ …            ┆ …    ┆ …            │
│ DASHUSDT   ┆ 0.107808     ┆ 242  ┆ 9            │
│ BSVUSDT    ┆ 0.186155     ┆ 243  ┆ 8            │
│ DODOXUSDT  ┆ 0.214729     ┆ 244  ┆ 7            │
│ WAXPUSDT   ┆ 0.218042     ┆ 245  ┆ 6            │
│ SKLUSDT    ┆ 0.257803     ┆ 246  ┆ 5            │
│ BADGERUSDT ┆ 0.424475     ┆ 247  ┆ 4            │
│ RONINUSDT  ┆ 0.427474     ┆ 248  ┆ 3            │
│ PERPUSDT   ┆ 0.516751     ┆ 249  ┆ 2            │
│ STEEMUSDT  ┆ 0.858425     ┆ 250  ┆ 1            │
│ DEFIUSDT   ┆ 2.073928     ┆ 251  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:04,350 - WARNING - 2024-10-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:04,350 - INFO - cur close time: 2024-10-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:04,350 - DEBUG - mean expected ret (mean factor): -0.7621390716103345
2024-11-20 23:07:04,355 - DEBUG - begin to update pos: =========
2024-11-20 23:07:04,356 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,356 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.021052    ┆ 0.13662     ┆ 0.08779     ┆ 0.0096963  ┆ … ┆ 0.01481 ┆ 0.13001 ┆ 3.9712  ┆ 0.3246  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:04,363 - DEBUG - update position: 2024-10-13T23:59:59.999 === diff_trading_value: 274503.84507158166 == cash: 185630.3000833821 
2024-11-20 23:07:04,366 - INFO - pnl: 2024-10-13T23:59:59.999 185630.3000833821 === -0.252%
2024-11-20 23:07:04,371 - DEBUG - cur time: 2024-10-14T23:59:59.999 == next bar open time: 2024-10-15T00:00:00.000 == close pos time: 2024-10-22T00:00:00.000
2024-11-20 23:07:04,372 - INFO - pnl: 2024-10-14T23:59:59.999 186733.8838273037 === 0.595%
2024-11-20 23:07:04,380 - DEBUG - cur time: 2024-10-15T23:59:59.999 == next bar open time: 2024-10-16T00:00:00.000 == close pos time: 2024-10-23T00:00:00.000
2024-11-20 23:07:04,382 - INFO - pnl: 2024-10-15T23:59:59.999 186730.26714169435 === -0.002%
2024-11-20 23:07:04,387 - DEBUG - cur time: 2024-10-16T23:59:59.999 == next bar open time: 2024-10-17T00:00:00.000 == close pos time: 2024-10-24T00:00:00.000
2024-11-20 23:07:04,389 - INFO - pnl: 2024-10-16T23:59:59.999 186577.21036564602 === -0.082%
2024-11-20 23:07:04,396 - DEBUG - cur time: 2024-10-17T23:59:59.999 == next bar open time: 2024-10-18T00:00:00.000 == close pos time: 2024-10-25T00:00:00.000
2024-11-20 23:07:04,398 - INFO - pnl: 2024-10-17T23:59:59.999 186754.81909756575 === 0.095%
2024-11-20 23:07:04,405 - DEBUG - cur time: 2024-10-18T23:59:59.999 == next bar open time: 2024-10-19T00:00:00.000 == close pos time: 2024-10-26T00:00:00.000
2024-11-20 23:07:04,407 - INFO - pnl: 2024-10-18T23:59:59.999 186768.61686853663 === 0.007%
2024-11-20 23:07:04,412 - DEBUG - cur time: 2024-10-19T23:59:59.999 == next bar open time: 2024-10-20T00:00:00.000 == close pos time: 2024-10-27T00:00:00.000
2024-11-20 23:07:04,414 - INFO - pnl: 2024-10-19T23:59:59.999 188717.36395264658 === 1.043%
2024-11-20 23:07:04,419 - DEBUG - cur time: 2024-10-20T23:59:59.999 == next bar open time: 2024-10-21T00:00:00.000 == close pos time: 2024-10-28T00:00:00.000
2024-11-20 23:07:04,436 - DEBUG - sorted_long_factors: shape: (251, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ TNSRUSDT   ┆ -1.954583    ┆ 0    ┆ 250          │
│ TAOUSDT    ┆ -1.85433     ┆ 1    ┆ 249          │
│ SAGAUSDT   ┆ -1.725465    ┆ 2    ┆ 248          │
│ IOUSDT     ┆ -1.720052    ┆ 3    ┆ 247          │
│ PENDLEUSDT ┆ -1.701609    ┆ 4    ┆ 246          │
│ TRBUSDT    ┆ -1.691129    ┆ 5    ┆ 245          │
│ ZROUSDT    ┆ -1.668724    ┆ 6    ┆ 244          │
│ ARUSDT     ┆ -1.659795    ┆ 7    ┆ 243          │
│ DOTUSDT    ┆ -1.602048    ┆ 8    ┆ 242          │
│ OMNIUSDT   ┆ -1.597623    ┆ 9    ┆ 241          │
│ …          ┆ …            ┆ …    ┆ …            │
│ JOEUSDT    ┆ 0.138067     ┆ 241  ┆ 9            │
│ BNTUSDT    ┆ 0.147209     ┆ 242  ┆ 8            │
│ WAXPUSDT   ┆ 0.158498     ┆ 243  ┆ 7            │
│ RVNUSDT    ┆ 0.169135     ┆ 244  ┆ 6            │
│ HOTUSDT    ┆ 0.192176     ┆ 245  ┆ 5            │
│ ALPHAUSDT  ┆ 0.192349     ┆ 246  ┆ 4            │
│ LSKUSDT    ┆ 0.284471     ┆ 247  ┆ 3            │
│ NKNUSDT    ┆ 0.344075     ┆ 248  ┆ 2            │
│ STEEMUSDT  ┆ 0.679638     ┆ 249  ┆ 1            │
│ DEFIUSDT   ┆ 2.211278     ┆ 250  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:04,448 - WARNING - 2024-10-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:04,449 - INFO - cur close time: 2024-10-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:04,449 - DEBUG - mean expected ret (mean factor): -0.7862849085060031
2024-11-20 23:07:04,454 - DEBUG - begin to update pos: =========
2024-11-20 23:07:04,455 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬──────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT  ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---      ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ f64      ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆          ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪══════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ -10000.0 ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴──────────┴─────────┘
2024-11-20 23:07:04,455 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.024223    ┆ 0.15754     ┆ 0.09347     ┆ 0.0106932  ┆ … ┆ 0.01612 ┆ 0.14893 ┆ 4.0715  ┆ 0.3553  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:04,463 - DEBUG - update position: 2024-10-20T23:59:59.999 === diff_trading_value: 335528.78183137707 == cash: 187864.99110938166 
2024-11-20 23:07:04,464 - INFO - pnl: 2024-10-20T23:59:59.999 187864.99110938166 === -0.452%
2024-11-20 23:07:04,470 - DEBUG - cur time: 2024-10-21T23:59:59.999 == next bar open time: 2024-10-22T00:00:00.000 == close pos time: 2024-10-29T00:00:00.000
2024-11-20 23:07:04,472 - INFO - pnl: 2024-10-21T23:59:59.999 191255.7266604341 === 1.805%
2024-11-20 23:07:04,476 - DEBUG - cur time: 2024-10-22T23:59:59.999 == next bar open time: 2024-10-23T00:00:00.000 == close pos time: 2024-10-30T00:00:00.000
2024-11-20 23:07:04,478 - INFO - pnl: 2024-10-22T23:59:59.999 192398.48899353234 === 0.598%
2024-11-20 23:07:04,481 - DEBUG - cur time: 2024-10-23T23:59:59.999 == next bar open time: 2024-10-24T00:00:00.000 == close pos time: 2024-10-31T00:00:00.000
2024-11-20 23:07:04,484 - INFO - pnl: 2024-10-23T23:59:59.999 191384.0565679813 === -0.527%
2024-11-20 23:07:04,488 - DEBUG - cur time: 2024-10-24T23:59:59.999 == next bar open time: 2024-10-25T00:00:00.000 == close pos time: 2024-11-01T00:00:00.000
2024-11-20 23:07:04,491 - INFO - pnl: 2024-10-24T23:59:59.999 190958.82241331544 === -0.222%
2024-11-20 23:07:04,495 - DEBUG - cur time: 2024-10-25T23:59:59.999 == next bar open time: 2024-10-26T00:00:00.000 == close pos time: 2024-11-02T00:00:00.000
2024-11-20 23:07:04,496 - INFO - pnl: 2024-10-25T23:59:59.999 191551.7340888728 === 0.310%
2024-11-20 23:07:04,500 - DEBUG - cur time: 2024-10-26T23:59:59.999 == next bar open time: 2024-10-27T00:00:00.000 == close pos time: 2024-11-03T00:00:00.000
2024-11-20 23:07:04,503 - INFO - pnl: 2024-10-26T23:59:59.999 189283.512304309 === -1.184%
2024-11-20 23:07:04,516 - INFO - start get SinglePnl: shape: (126_167, 83)
┌────────────┬───────────┬──────────┬──────────┬───┬───────────┬───────────┬───────────┬───────────┐
│ symbol     ┆ open_time ┆ open     ┆ high     ┆ … ┆ long_valu ┆ short_val ┆ long_valu ┆ short_val │
│ ---        ┆ ---       ┆ ---      ┆ ---      ┆   ┆ e_scale_9 ┆ ue_scale_ ┆ e_scale_1 ┆ ue_scale_ │
│ str        ┆ datetime[ ┆ f64      ┆ f64      ┆   ┆ day       ┆ 9day      ┆ 0day      ┆ 10day     │
│            ┆ ms]       ┆          ┆          ┆   ┆ ---       ┆ ---       ┆ ---       ┆ ---       │
│            ┆           ┆          ┆          ┆   ┆ f64       ┆ f64       ┆ f64       ┆ f64       │
╞════════════╪═══════════╪══════════╪══════════╪═══╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.024872 ┆ 0.02937  ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.024425 ┆ 0.027349 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.027227 ┆ 0.047868 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.03773  ┆ 0.042696 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.030505 ┆ 0.036907 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.029994 ┆ 0.030839 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.027063 ┆ 0.035125 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.031768 ┆ 0.034467 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-1 ┆ 0.0339   ┆ 0.033974 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-1 ┆ 0.031026 ┆ 0.03276  ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ …          ┆ …         ┆ …        ┆ …        ┆ … ┆ …         ┆ …         ┆ …         ┆ …         │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3196   ┆ 0.3373   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3355   ┆ 0.3415   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3359   ┆ 0.3565   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3553   ┆ 0.3881   ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.2       ┆ 0.8       │
│            ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3577   ┆ 0.3581   ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.0       ┆ 1.0       │
│            ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3511   ┆ 0.3547   ┆ … ┆ 0.8       ┆ 1.2       ┆ 1.0       ┆ 1.0       │
│            ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3383   ┆ 0.3548   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3417   ┆ 0.3632   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3194   ┆ 0.3243   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.316    ┆ 0.3317   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
└────────────┴───────────┴──────────┴──────────┴───┴───────────┴───────────┴───────────┴───────────┘
2024-11-20 23:07:04,598 - DEBUG - cur time: 2023-01-09T23:59:59.999 == next bar open time: 2023-01-10T00:00:00.000 == close pos time: 2023-01-17T00:00:00.000
2024-11-20 23:07:04,606 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ICPUSDT      ┆ -1.818383    ┆ 0    ┆ 132          │
│ 1000LUNCUSDT ┆ -1.746331    ┆ 1    ┆ 131          │
│ AXSUSDT      ┆ -1.651649    ┆ 2    ┆ 130          │
│ ATOMUSDT     ┆ -1.63851     ┆ 3    ┆ 129          │
│ XRPUSDT      ┆ -1.623512    ┆ 4    ┆ 128          │
│ CELOUSDT     ┆ -1.622591    ┆ 5    ┆ 127          │
│ APEUSDT      ┆ -1.616645    ┆ 6    ┆ 126          │
│ DOTUSDT      ┆ -1.606537    ┆ 7    ┆ 125          │
│ UNIUSDT      ┆ -1.570727    ┆ 8    ┆ 124          │
│ DASHUSDT     ┆ -1.560216    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DGBUSDT      ┆ -0.060193    ┆ 123  ┆ 9            │
│ CTSIUSDT     ┆ -0.016399    ┆ 124  ┆ 8            │
│ ONEUSDT      ┆ 0.007003     ┆ 125  ┆ 7            │
│ CELRUSDT     ┆ 0.059739     ┆ 126  ┆ 6            │
│ BTCDOMUSDT   ┆ 0.094489     ┆ 127  ┆ 5            │
│ IOTXUSDT     ┆ 0.146635     ┆ 128  ┆ 4            │
│ TOMOUSDT     ┆ 0.194255     ┆ 129  ┆ 3            │
│ DEFIUSDT     ┆ 0.264337     ┆ 130  ┆ 2            │
│ ARPAUSDT     ┆ 0.351865     ┆ 131  ┆ 1            │
│ DUSKUSDT     ┆ 0.581532     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:04,614 - WARNING - 2023-01-09T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:04,614 - INFO - cur close time: 2023-01-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:04,614 - DEBUG - mean expected ret (mean factor): -0.8282597563738919
2024-11-20 23:07:04,620 - DEBUG - begin to update pos: =========
2024-11-20 23:07:04,620 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,621 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1694      ┆ null        ┆ … ┆ 0.0235  ┆ null   ┆ null    ┆ 0.1689  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,628 - DEBUG - update position: 2023-01-09T23:59:59.999 === diff_trading_value: 200000.0 == cash: 99800.0 
2024-11-20 23:07:04,634 - DEBUG - cur time: 2023-01-10T23:59:59.999 == next bar open time: 2023-01-11T00:00:00.000 == close pos time: 2023-01-18T00:00:00.000
2024-11-20 23:07:04,636 - INFO - pnl: 2023-01-10T23:59:59.999 99979.83336253736 === 0.180%
2024-11-20 23:07:04,639 - DEBUG - cur time: 2023-01-11T23:59:59.999 == next bar open time: 2023-01-12T00:00:00.000 == close pos time: 2023-01-19T00:00:00.000
2024-11-20 23:07:04,640 - INFO - pnl: 2023-01-11T23:59:59.999 99220.36195673293 === -0.760%
2024-11-20 23:07:04,644 - DEBUG - cur time: 2023-01-12T23:59:59.999 == next bar open time: 2023-01-13T00:00:00.000 == close pos time: 2023-01-20T00:00:00.000
2024-11-20 23:07:04,647 - INFO - pnl: 2023-01-12T23:59:59.999 99898.53403861226 === 0.684%
2024-11-20 23:07:04,650 - DEBUG - cur time: 2023-01-13T23:59:59.999 == next bar open time: 2023-01-14T00:00:00.000 == close pos time: 2023-01-21T00:00:00.000
2024-11-20 23:07:04,652 - INFO - pnl: 2023-01-13T23:59:59.999 100951.4049551439 === 1.054%
2024-11-20 23:07:04,657 - DEBUG - cur time: 2023-01-14T23:59:59.999 == next bar open time: 2023-01-15T00:00:00.000 == close pos time: 2023-01-22T00:00:00.000
2024-11-20 23:07:04,659 - INFO - pnl: 2023-01-14T23:59:59.999 101619.89904926797 === 0.662%
2024-11-20 23:07:04,662 - DEBUG - cur time: 2023-01-15T23:59:59.999 == next bar open time: 2023-01-16T00:00:00.000 == close pos time: 2023-01-23T00:00:00.000
2024-11-20 23:07:04,664 - INFO - pnl: 2023-01-15T23:59:59.999 102104.44024752668 === 0.477%
2024-11-20 23:07:04,667 - DEBUG - cur time: 2023-01-16T23:59:59.999 == next bar open time: 2023-01-17T00:00:00.000 == close pos time: 2023-01-24T00:00:00.000
2024-11-20 23:07:04,676 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LUNA2USDT    ┆ -1.974091    ┆ 0    ┆ 132          │
│ AAVEUSDT     ┆ -1.805378    ┆ 1    ┆ 131          │
│ ENSUSDT      ┆ -1.779947    ┆ 2    ┆ 130          │
│ MATICUSDT    ┆ -1.769417    ┆ 3    ┆ 129          │
│ ZECUSDT      ┆ -1.742378    ┆ 4    ┆ 128          │
│ CVXUSDT      ┆ -1.651293    ┆ 5    ┆ 127          │
│ 1000LUNCUSDT ┆ -1.631729    ┆ 6    ┆ 126          │
│ ICPUSDT      ┆ -1.600303    ┆ 7    ┆ 125          │
│ BNBUSDT      ┆ -1.596189    ┆ 8    ┆ 124          │
│ DASHUSDT     ┆ -1.542758    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DGBUSDT      ┆ -0.233141    ┆ 123  ┆ 9            │
│ CELRUSDT     ┆ -0.210768    ┆ 124  ┆ 8            │
│ FLMUSDT      ┆ -0.210331    ┆ 125  ┆ 7            │
│ IOTXUSDT     ┆ -0.1523      ┆ 126  ┆ 6            │
│ API3USDT     ┆ -0.098299    ┆ 127  ┆ 5            │
│ IOSTUSDT     ┆ -0.029667    ┆ 128  ┆ 4            │
│ CTSIUSDT     ┆ 0.069688     ┆ 129  ┆ 3            │
│ TOMOUSDT     ┆ 0.083877     ┆ 130  ┆ 2            │
│ ARPAUSDT     ┆ 0.387241     ┆ 131  ┆ 1            │
│ DEFIUSDT     ┆ 0.413129     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:04,686 - WARNING - 2023-01-16T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:04,686 - INFO - cur close time: 2023-01-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:04,686 - DEBUG - mean expected ret (mean factor): -0.8193888131288518
2024-11-20 23:07:04,691 - DEBUG - begin to update pos: =========
2024-11-20 23:07:04,691 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,693 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1773      ┆ null        ┆ … ┆ 0.02733 ┆ null   ┆ null    ┆ 0.2091  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,702 - DEBUG - update position: 2023-01-16T23:59:59.999 === diff_trading_value: 251831.08950472611 == cash: 102935.17536453916 
2024-11-20 23:07:04,704 - INFO - pnl: 2023-01-16T23:59:59.999 102935.17536453916 === 0.814%
2024-11-20 23:07:04,711 - DEBUG - cur time: 2023-01-17T23:59:59.999 == next bar open time: 2023-01-18T00:00:00.000 == close pos time: 2023-01-25T00:00:00.000
2024-11-20 23:07:04,713 - INFO - pnl: 2023-01-17T23:59:59.999 102825.37972852305 === -0.107%
2024-11-20 23:07:04,720 - DEBUG - cur time: 2023-01-18T23:59:59.999 == next bar open time: 2023-01-19T00:00:00.000 == close pos time: 2023-01-26T00:00:00.000
2024-11-20 23:07:04,722 - INFO - pnl: 2023-01-18T23:59:59.999 100070.64336112808 === -2.679%
2024-11-20 23:07:04,727 - DEBUG - cur time: 2023-01-19T23:59:59.999 == next bar open time: 2023-01-20T00:00:00.000 == close pos time: 2023-01-27T00:00:00.000
2024-11-20 23:07:04,729 - INFO - pnl: 2023-01-19T23:59:59.999 98837.45115243769 === -1.232%
2024-11-20 23:07:04,737 - DEBUG - cur time: 2023-01-20T23:59:59.999 == next bar open time: 2023-01-21T00:00:00.000 == close pos time: 2023-01-28T00:00:00.000
2024-11-20 23:07:04,740 - INFO - pnl: 2023-01-20T23:59:59.999 101652.31004140162 === 2.848%
2024-11-20 23:07:04,748 - DEBUG - cur time: 2023-01-21T23:59:59.999 == next bar open time: 2023-01-22T00:00:00.000 == close pos time: 2023-01-29T00:00:00.000
2024-11-20 23:07:04,751 - INFO - pnl: 2023-01-21T23:59:59.999 102264.78190018558 === 0.603%
2024-11-20 23:07:04,755 - DEBUG - cur time: 2023-01-22T23:59:59.999 == next bar open time: 2023-01-23T00:00:00.000 == close pos time: 2023-01-30T00:00:00.000
2024-11-20 23:07:04,758 - INFO - pnl: 2023-01-22T23:59:59.999 104113.88582356204 === 1.808%
2024-11-20 23:07:04,763 - DEBUG - cur time: 2023-01-23T23:59:59.999 == next bar open time: 2023-01-24T00:00:00.000 == close pos time: 2023-01-31T00:00:00.000
2024-11-20 23:07:04,780 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT      ┆ -1.890434    ┆ 0    ┆ 132          │
│ RLCUSDT      ┆ -1.805516    ┆ 1    ┆ 131          │
│ INJUSDT      ┆ -1.802665    ┆ 2    ┆ 130          │
│ LDOUSDT      ┆ -1.77859     ┆ 3    ┆ 129          │
│ APEUSDT      ┆ -1.729414    ┆ 4    ┆ 128          │
│ YFIUSDT      ┆ -1.722545    ┆ 5    ┆ 127          │
│ DOTUSDT      ┆ -1.636284    ┆ 6    ┆ 126          │
│ OCEANUSDT    ┆ -1.601001    ┆ 7    ┆ 125          │
│ KSMUSDT      ┆ -1.589539    ┆ 8    ┆ 124          │
│ 1000LUNCUSDT ┆ -1.553202    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CELRUSDT     ┆ -0.171489    ┆ 123  ┆ 9            │
│ OGNUSDT      ┆ -0.169521    ┆ 124  ┆ 8            │
│ ICXUSDT      ┆ -0.162685    ┆ 125  ┆ 7            │
│ FLMUSDT      ┆ -0.154807    ┆ 126  ┆ 6            │
│ LPTUSDT      ┆ -0.113816    ┆ 127  ┆ 5            │
│ GTCUSDT      ┆ -0.113537    ┆ 128  ┆ 4            │
│ SKLUSDT      ┆ 0.143456     ┆ 129  ┆ 3            │
│ ARPAUSDT     ┆ 0.245138     ┆ 130  ┆ 2            │
│ TOMOUSDT     ┆ 0.707676     ┆ 131  ┆ 1            │
│ DEFIUSDT     ┆ 0.861929     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:04,795 - WARNING - 2023-01-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:04,795 - INFO - cur close time: 2023-01-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:04,795 - DEBUG - mean expected ret (mean factor): -0.8186778133006549
2024-11-20 23:07:04,805 - DEBUG - begin to update pos: =========
2024-11-20 23:07:04,806 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,806 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.179       ┆ null        ┆ … ┆ 0.02866 ┆ null   ┆ null    ┆ 0.2267  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,819 - DEBUG - update position: 2023-01-23T23:59:59.999 === diff_trading_value: 285685.0400215125 == cash: 107278.84545148873 
2024-11-20 23:07:04,821 - INFO - pnl: 2023-01-23T23:59:59.999 107278.84545148873 === 3.040%
2024-11-20 23:07:04,825 - DEBUG - cur time: 2023-01-24T23:59:59.999 == next bar open time: 2023-01-25T00:00:00.000 == close pos time: 2023-02-01T00:00:00.000
2024-11-20 23:07:04,826 - INFO - pnl: 2023-01-24T23:59:59.999 109786.33108048563 === 2.337%
2024-11-20 23:07:04,831 - DEBUG - cur time: 2023-01-25T23:59:59.999 == next bar open time: 2023-01-26T00:00:00.000 == close pos time: 2023-02-02T00:00:00.000
2024-11-20 23:07:04,833 - INFO - pnl: 2023-01-25T23:59:59.999 107350.7847113014 === -2.218%
2024-11-20 23:07:04,836 - DEBUG - cur time: 2023-01-26T23:59:59.999 == next bar open time: 2023-01-27T00:00:00.000 == close pos time: 2023-02-03T00:00:00.000
2024-11-20 23:07:04,839 - INFO - pnl: 2023-01-26T23:59:59.999 107752.5959307796 === 0.374%
2024-11-20 23:07:04,843 - DEBUG - cur time: 2023-01-27T23:59:59.999 == next bar open time: 2023-01-28T00:00:00.000 == close pos time: 2023-02-04T00:00:00.000
2024-11-20 23:07:04,845 - INFO - pnl: 2023-01-27T23:59:59.999 107806.18890291899 === 0.050%
2024-11-20 23:07:04,848 - DEBUG - cur time: 2023-01-28T23:59:59.999 == next bar open time: 2023-01-29T00:00:00.000 == close pos time: 2023-02-05T00:00:00.000
2024-11-20 23:07:04,851 - INFO - pnl: 2023-01-28T23:59:59.999 107364.75725302467 === -0.409%
2024-11-20 23:07:04,854 - DEBUG - cur time: 2023-01-29T23:59:59.999 == next bar open time: 2023-01-30T00:00:00.000 == close pos time: 2023-02-06T00:00:00.000
2024-11-20 23:07:04,856 - INFO - pnl: 2023-01-29T23:59:59.999 108783.56764553727 === 1.321%
2024-11-20 23:07:04,858 - DEBUG - cur time: 2023-01-30T23:59:59.999 == next bar open time: 2023-01-31T00:00:00.000 == close pos time: 2023-02-07T00:00:00.000
2024-11-20 23:07:04,865 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LUNA2USDT    ┆ -1.998825    ┆ 0    ┆ 134          │
│ DASHUSDT     ┆ -1.665617    ┆ 1    ┆ 133          │
│ LDOUSDT      ┆ -1.623185    ┆ 2    ┆ 132          │
│ 1000LUNCUSDT ┆ -1.611874    ┆ 3    ┆ 131          │
│ INJUSDT      ┆ -1.574123    ┆ 4    ┆ 130          │
│ MASKUSDT     ┆ -1.510586    ┆ 5    ┆ 129          │
│ QNTUSDT      ┆ -1.509711    ┆ 6    ┆ 128          │
│ LITUSDT      ┆ -1.494014    ┆ 7    ┆ 127          │
│ WAVESUSDT    ┆ -1.340906    ┆ 8    ┆ 126          │
│ TRXUSDT      ┆ -1.316116    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TRBUSDT      ┆ -0.24097     ┆ 125  ┆ 9            │
│ MKRUSDT      ┆ -0.215033    ┆ 126  ┆ 8            │
│ SKLUSDT      ┆ -0.200702    ┆ 127  ┆ 7            │
│ BLZUSDT      ┆ -0.166783    ┆ 128  ┆ 6            │
│ ONTUSDT      ┆ -0.158517    ┆ 129  ┆ 5            │
│ ARPAUSDT     ┆ -0.092987    ┆ 130  ┆ 4            │
│ EGLDUSDT     ┆ -0.030886    ┆ 131  ┆ 3            │
│ TOMOUSDT     ┆ 0.003183     ┆ 132  ┆ 2            │
│ DGBUSDT      ┆ 0.236652     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 2.758876     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:04,871 - WARNING - 2023-01-30T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:04,871 - INFO - cur close time: 2023-01-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:04,873 - DEBUG - mean expected ret (mean factor): -0.8198093381934028
2024-11-20 23:07:04,878 - DEBUG - begin to update pos: =========
2024-11-20 23:07:04,878 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,878 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1646      ┆ null        ┆ … ┆ 0.02671 ┆ null   ┆ null    ┆ 0.2144  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,884 - DEBUG - update position: 2023-01-30T23:59:59.999 === diff_trading_value: 266463.3430154251 == cash: 107532.28606684874 
2024-11-20 23:07:04,887 - INFO - pnl: 2023-01-30T23:59:59.999 107532.28606684874 === -1.150%
2024-11-20 23:07:04,891 - DEBUG - cur time: 2023-01-31T23:59:59.999 == next bar open time: 2023-02-01T00:00:00.000 == close pos time: 2023-02-08T00:00:00.000
2024-11-20 23:07:04,894 - INFO - pnl: 2023-01-31T23:59:59.999 103270.66634777834 === -3.963%
2024-11-20 23:07:04,900 - DEBUG - cur time: 2023-02-01T23:59:59.999 == next bar open time: 2023-02-02T00:00:00.000 == close pos time: 2023-02-09T00:00:00.000
2024-11-20 23:07:04,902 - INFO - pnl: 2023-02-01T23:59:59.999 101986.84653403329 === -1.243%
2024-11-20 23:07:04,908 - DEBUG - cur time: 2023-02-02T23:59:59.999 == next bar open time: 2023-02-03T00:00:00.000 == close pos time: 2023-02-10T00:00:00.000
2024-11-20 23:07:04,911 - INFO - pnl: 2023-02-02T23:59:59.999 106586.09170467342 === 4.510%
2024-11-20 23:07:04,915 - DEBUG - cur time: 2023-02-03T23:59:59.999 == next bar open time: 2023-02-04T00:00:00.000 == close pos time: 2023-02-11T00:00:00.000
2024-11-20 23:07:04,918 - INFO - pnl: 2023-02-03T23:59:59.999 102921.76842064079 === -3.438%
2024-11-20 23:07:04,922 - DEBUG - cur time: 2023-02-04T23:59:59.999 == next bar open time: 2023-02-05T00:00:00.000 == close pos time: 2023-02-12T00:00:00.000
2024-11-20 23:07:04,924 - INFO - pnl: 2023-02-04T23:59:59.999 106734.42733383455 === 3.704%
2024-11-20 23:07:04,928 - DEBUG - cur time: 2023-02-05T23:59:59.999 == next bar open time: 2023-02-06T00:00:00.000 == close pos time: 2023-02-13T00:00:00.000
2024-11-20 23:07:04,930 - INFO - pnl: 2023-02-05T23:59:59.999 109254.68933514506 === 2.361%
2024-11-20 23:07:04,933 - DEBUG - cur time: 2023-02-06T23:59:59.999 == next bar open time: 2023-02-07T00:00:00.000 == close pos time: 2023-02-14T00:00:00.000
2024-11-20 23:07:04,941 - DEBUG - sorted_long_factors: shape: (135, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT     ┆ -1.762294    ┆ 0    ┆ 134          │
│ TRBUSDT     ┆ -1.652873    ┆ 1    ┆ 133          │
│ AXSUSDT     ┆ -1.577943    ┆ 2    ┆ 132          │
│ ICPUSDT     ┆ -1.561262    ┆ 3    ┆ 131          │
│ LUNA2USDT   ┆ -1.477706    ┆ 4    ┆ 130          │
│ SNXUSDT     ┆ -1.444808    ┆ 5    ┆ 129          │
│ OCEANUSDT   ┆ -1.444599    ┆ 6    ┆ 128          │
│ MTLUSDT     ┆ -1.440917    ┆ 7    ┆ 127          │
│ MKRUSDT     ┆ -1.389124    ┆ 8    ┆ 126          │
│ STGUSDT     ┆ -1.384438    ┆ 9    ┆ 125          │
│ …           ┆ …            ┆ …    ┆ …            │
│ HNTUSDT     ┆ -0.21958     ┆ 125  ┆ 9            │
│ DUSKUSDT    ┆ -0.185101    ┆ 126  ┆ 8            │
│ 1000XECUSDT ┆ -0.174714    ┆ 127  ┆ 7            │
│ KSMUSDT     ┆ -0.096368    ┆ 128  ┆ 6            │
│ SKLUSDT     ┆ -0.079853    ┆ 129  ┆ 5            │
│ DENTUSDT    ┆ -0.076719    ┆ 130  ┆ 4            │
│ CTSIUSDT    ┆ 0.136235     ┆ 131  ┆ 3            │
│ API3USDT    ┆ 0.137304     ┆ 132  ┆ 2            │
│ DGBUSDT     ┆ 0.581181     ┆ 133  ┆ 1            │
│ DEFIUSDT    ┆ 2.11541      ┆ 134  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:04,947 - WARNING - 2023-02-06T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:04,947 - INFO - cur close time: 2023-02-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:04,947 - DEBUG - mean expected ret (mean factor): -0.8086817028980409
2024-11-20 23:07:04,951 - DEBUG - begin to update pos: =========
2024-11-20 23:07:04,953 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,953 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1818      ┆ null        ┆ … ┆ 0.02966 ┆ null   ┆ null    ┆ 0.2449  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:04,959 - DEBUG - update position: 2023-02-06T23:59:59.999 === diff_trading_value: 317832.12830486393 == cash: 109098.84587870454 
2024-11-20 23:07:04,961 - INFO - pnl: 2023-02-06T23:59:59.999 109098.84587870454 === -0.143%
2024-11-20 23:07:04,963 - DEBUG - cur time: 2023-02-07T23:59:59.999 == next bar open time: 2023-02-08T00:00:00.000 == close pos time: 2023-02-15T00:00:00.000
2024-11-20 23:07:04,965 - INFO - pnl: 2023-02-07T23:59:59.999 111299.78534826178 === 2.017%
2024-11-20 23:07:04,971 - DEBUG - cur time: 2023-02-08T23:59:59.999 == next bar open time: 2023-02-09T00:00:00.000 == close pos time: 2023-02-16T00:00:00.000
2024-11-20 23:07:04,972 - INFO - pnl: 2023-02-08T23:59:59.999 111640.36191297829 === 0.306%
2024-11-20 23:07:04,977 - DEBUG - cur time: 2023-02-09T23:59:59.999 == next bar open time: 2023-02-10T00:00:00.000 == close pos time: 2023-02-17T00:00:00.000
2024-11-20 23:07:04,979 - INFO - pnl: 2023-02-09T23:59:59.999 111959.50724140032 === 0.286%
2024-11-20 23:07:04,984 - DEBUG - cur time: 2023-02-10T23:59:59.999 == next bar open time: 2023-02-11T00:00:00.000 == close pos time: 2023-02-18T00:00:00.000
2024-11-20 23:07:04,987 - INFO - pnl: 2023-02-10T23:59:59.999 115850.63721768835 === 3.475%
2024-11-20 23:07:04,993 - DEBUG - cur time: 2023-02-11T23:59:59.999 == next bar open time: 2023-02-12T00:00:00.000 == close pos time: 2023-02-19T00:00:00.000
2024-11-20 23:07:04,996 - INFO - pnl: 2023-02-11T23:59:59.999 117187.37286998115 === 1.154%
2024-11-20 23:07:05,003 - DEBUG - cur time: 2023-02-12T23:59:59.999 == next bar open time: 2023-02-13T00:00:00.000 == close pos time: 2023-02-20T00:00:00.000
2024-11-20 23:07:05,004 - INFO - pnl: 2023-02-12T23:59:59.999 117547.75422097571 === 0.308%
2024-11-20 23:07:05,010 - DEBUG - cur time: 2023-02-13T23:59:59.999 == next bar open time: 2023-02-14T00:00:00.000 == close pos time: 2023-02-21T00:00:00.000
2024-11-20 23:07:05,020 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ NEARUSDT     ┆ -1.711493    ┆ 0    ┆ 135          │
│ TRXUSDT      ┆ -1.708477    ┆ 1    ┆ 134          │
│ LDOUSDT      ┆ -1.69343     ┆ 2    ┆ 133          │
│ AXSUSDT      ┆ -1.634155    ┆ 3    ┆ 132          │
│ STORJUSDT    ┆ -1.517468    ┆ 4    ┆ 131          │
│ INJUSDT      ┆ -1.44791     ┆ 5    ┆ 130          │
│ STGUSDT      ┆ -1.438259    ┆ 6    ┆ 129          │
│ ATOMUSDT     ┆ -1.421907    ┆ 7    ┆ 128          │
│ FOOTBALLUSDT ┆ -1.411336    ┆ 8    ┆ 127          │
│ ZILUSDT      ┆ -1.400189    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOTXUSDT     ┆ -0.225659    ┆ 126  ┆ 9            │
│ CELRUSDT     ┆ -0.139336    ┆ 127  ┆ 8            │
│ DENTUSDT     ┆ -0.067501    ┆ 128  ┆ 7            │
│ NKNUSDT      ┆ -0.060195    ┆ 129  ┆ 6            │
│ BELUSDT      ┆ -0.00633     ┆ 130  ┆ 5            │
│ LINAUSDT     ┆ 0.116371     ┆ 131  ┆ 4            │
│ ANTUSDT      ┆ 0.381482     ┆ 132  ┆ 3            │
│ DGBUSDT      ┆ 0.753151     ┆ 133  ┆ 2            │
│ DEFIUSDT     ┆ 0.806652     ┆ 134  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.00975      ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:05,030 - WARNING - 2023-02-13T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:05,030 - INFO - cur close time: 2023-02-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:05,030 - DEBUG - mean expected ret (mean factor): -0.8009982343080185
2024-11-20 23:07:05,037 - DEBUG - begin to update pos: =========
2024-11-20 23:07:05,038 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,038 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1697      ┆ null        ┆ … ┆ 0.02913 ┆ null   ┆ null    ┆ 0.2244  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,049 - DEBUG - update position: 2023-02-13T23:59:59.999 === diff_trading_value: 269215.8888928245 == cash: 114777.304246581 
2024-11-20 23:07:05,052 - INFO - pnl: 2023-02-13T23:59:59.999 114777.304246581 === -2.357%
2024-11-20 23:07:05,057 - DEBUG - cur time: 2023-02-14T23:59:59.999 == next bar open time: 2023-02-15T00:00:00.000 == close pos time: 2023-02-22T00:00:00.000
2024-11-20 23:07:05,058 - INFO - pnl: 2023-02-14T23:59:59.999 115394.73663145711 === 0.538%
2024-11-20 23:07:05,063 - DEBUG - cur time: 2023-02-15T23:59:59.999 == next bar open time: 2023-02-16T00:00:00.000 == close pos time: 2023-02-23T00:00:00.000
2024-11-20 23:07:05,064 - INFO - pnl: 2023-02-15T23:59:59.999 113392.84712643884 === -1.735%
2024-11-20 23:07:05,068 - DEBUG - cur time: 2023-02-16T23:59:59.999 == next bar open time: 2023-02-17T00:00:00.000 == close pos time: 2023-02-24T00:00:00.000
2024-11-20 23:07:05,070 - INFO - pnl: 2023-02-16T23:59:59.999 112327.0013312668 === -0.940%
2024-11-20 23:07:05,073 - DEBUG - cur time: 2023-02-17T23:59:59.999 == next bar open time: 2023-02-18T00:00:00.000 == close pos time: 2023-02-25T00:00:00.000
2024-11-20 23:07:05,076 - INFO - pnl: 2023-02-17T23:59:59.999 111169.2126705045 === -1.031%
2024-11-20 23:07:05,081 - DEBUG - cur time: 2023-02-18T23:59:59.999 == next bar open time: 2023-02-19T00:00:00.000 == close pos time: 2023-02-26T00:00:00.000
2024-11-20 23:07:05,085 - INFO - pnl: 2023-02-18T23:59:59.999 108109.62934117673 === -2.752%
2024-11-20 23:07:05,090 - DEBUG - cur time: 2023-02-19T23:59:59.999 == next bar open time: 2023-02-20T00:00:00.000 == close pos time: 2023-02-27T00:00:00.000
2024-11-20 23:07:05,093 - INFO - pnl: 2023-02-19T23:59:59.999 112220.59596425758 === 3.803%
2024-11-20 23:07:05,098 - DEBUG - cur time: 2023-02-20T23:59:59.999 == next bar open time: 2023-02-21T00:00:00.000 == close pos time: 2023-02-28T00:00:00.000
2024-11-20 23:07:05,112 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ COMPUSDT     ┆ -1.821255    ┆ 0    ┆ 135          │
│ APTUSDT      ┆ -1.624814    ┆ 1    ┆ 134          │
│ UNFIUSDT     ┆ -1.607529    ┆ 2    ┆ 133          │
│ INJUSDT      ┆ -1.606402    ┆ 3    ┆ 132          │
│ LUNA2USDT    ┆ -1.606116    ┆ 4    ┆ 131          │
│ SANDUSDT     ┆ -1.535012    ┆ 5    ┆ 130          │
│ 1000LUNCUSDT ┆ -1.533414    ┆ 6    ┆ 129          │
│ NEARUSDT     ┆ -1.492561    ┆ 7    ┆ 128          │
│ ZECUSDT      ┆ -1.469666    ┆ 8    ┆ 127          │
│ ENSUSDT      ┆ -1.458368    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CELRUSDT     ┆ -0.178199    ┆ 126  ┆ 9            │
│ CTSIUSDT     ┆ -0.168374    ┆ 127  ┆ 8            │
│ IOSTUSDT     ┆ -0.07234     ┆ 128  ┆ 7            │
│ IOTXUSDT     ┆ -0.070948    ┆ 129  ┆ 6            │
│ XEMUSDT      ┆ -0.047404    ┆ 130  ┆ 5            │
│ ANTUSDT      ┆ -0.027715    ┆ 131  ┆ 4            │
│ DGBUSDT      ┆ 0.32519      ┆ 132  ┆ 3            │
│ 1000XECUSDT  ┆ 0.526439     ┆ 133  ┆ 2            │
│ DEFIUSDT     ┆ 1.03364      ┆ 134  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.404709     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:05,120 - WARNING - 2023-02-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:05,120 - INFO - cur close time: 2023-02-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:05,121 - DEBUG - mean expected ret (mean factor): -0.7899092305493971
2024-11-20 23:07:05,127 - DEBUG - begin to update pos: =========
2024-11-20 23:07:05,127 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,127 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1704      ┆ null        ┆ … ┆ 0.03432 ┆ null   ┆ null    ┆ 0.2761  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,140 - DEBUG - update position: 2023-02-20T23:59:59.999 === diff_trading_value: 316460.26066703507 == cash: 118050.35302874612 
2024-11-20 23:07:05,141 - INFO - pnl: 2023-02-20T23:59:59.999 118050.35302874612 === 5.195%
2024-11-20 23:07:05,147 - DEBUG - cur time: 2023-02-21T23:59:59.999 == next bar open time: 2023-02-22T00:00:00.000 == close pos time: 2023-03-01T00:00:00.000
2024-11-20 23:07:05,149 - INFO - pnl: 2023-02-21T23:59:59.999 121013.95619919896 === 2.510%
2024-11-20 23:07:05,154 - DEBUG - cur time: 2023-02-22T23:59:59.999 == next bar open time: 2023-02-23T00:00:00.000 == close pos time: 2023-03-02T00:00:00.000
2024-11-20 23:07:05,156 - INFO - pnl: 2023-02-22T23:59:59.999 121659.34233988149 === 0.533%
2024-11-20 23:07:05,160 - DEBUG - cur time: 2023-02-23T23:59:59.999 == next bar open time: 2023-02-24T00:00:00.000 == close pos time: 2023-03-03T00:00:00.000
2024-11-20 23:07:05,163 - INFO - pnl: 2023-02-23T23:59:59.999 121617.9314804154 === -0.034%
2024-11-20 23:07:05,168 - DEBUG - cur time: 2023-02-24T23:59:59.999 == next bar open time: 2023-02-25T00:00:00.000 == close pos time: 2023-03-04T00:00:00.000
2024-11-20 23:07:05,170 - INFO - pnl: 2023-02-24T23:59:59.999 120859.89741970188 === -0.623%
2024-11-20 23:07:05,173 - DEBUG - cur time: 2023-02-25T23:59:59.999 == next bar open time: 2023-02-26T00:00:00.000 == close pos time: 2023-03-05T00:00:00.000
2024-11-20 23:07:05,176 - INFO - pnl: 2023-02-25T23:59:59.999 121794.62539126832 === 0.773%
2024-11-20 23:07:05,183 - DEBUG - cur time: 2023-02-26T23:59:59.999 == next bar open time: 2023-02-27T00:00:00.000 == close pos time: 2023-03-06T00:00:00.000
2024-11-20 23:07:05,186 - INFO - pnl: 2023-02-26T23:59:59.999 120056.68120945385 === -1.427%
2024-11-20 23:07:05,190 - DEBUG - cur time: 2023-02-27T23:59:59.999 == next bar open time: 2023-02-28T00:00:00.000 == close pos time: 2023-03-07T00:00:00.000
2024-11-20 23:07:05,199 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MKRUSDT      ┆ -1.604603    ┆ 0    ┆ 135          │
│ STGUSDT      ┆ -1.511871    ┆ 1    ┆ 134          │
│ LDOUSDT      ┆ -1.494995    ┆ 2    ┆ 133          │
│ XMRUSDT      ┆ -1.446391    ┆ 3    ┆ 132          │
│ 1000LUNCUSDT ┆ -1.445654    ┆ 4    ┆ 131          │
│ LUNA2USDT    ┆ -1.432844    ┆ 5    ┆ 130          │
│ ZECUSDT      ┆ -1.422515    ┆ 6    ┆ 129          │
│ IMXUSDT      ┆ -1.419626    ┆ 7    ┆ 128          │
│ GTCUSDT      ┆ -1.377884    ┆ 8    ┆ 127          │
│ AXSUSDT      ┆ -1.346965    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BATUSDT      ┆ -0.292321    ┆ 126  ┆ 9            │
│ LPTUSDT      ┆ -0.236833    ┆ 127  ┆ 8            │
│ LINAUSDT     ┆ -0.226838    ┆ 128  ┆ 7            │
│ 1000XECUSDT  ┆ -0.131841    ┆ 129  ┆ 6            │
│ COTIUSDT     ┆ 0.034315     ┆ 130  ┆ 5            │
│ ANTUSDT      ┆ 0.238076     ┆ 131  ┆ 4            │
│ DARUSDT      ┆ 0.31391      ┆ 132  ┆ 3            │
│ API3USDT     ┆ 0.529136     ┆ 133  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.157365     ┆ 134  ┆ 1            │
│ DEFIUSDT     ┆ 1.194144     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:05,208 - WARNING - 2023-02-27T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:05,208 - INFO - cur close time: 2023-02-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:05,208 - DEBUG - mean expected ret (mean factor): -0.7861573965597518
2024-11-20 23:07:05,213 - DEBUG - begin to update pos: =========
2024-11-20 23:07:05,213 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,214 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1614      ┆ null        ┆ … ┆ 0.03241 ┆ null   ┆ null    ┆ 0.2614  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,221 - DEBUG - update position: 2023-02-27T23:59:59.999 === diff_trading_value: 218426.80463331525 == cash: 122301.48340241493 
2024-11-20 23:07:05,223 - INFO - pnl: 2023-02-27T23:59:59.999 122301.48340241493 === 1.870%
2024-11-20 23:07:05,227 - DEBUG - cur time: 2023-02-28T23:59:59.999 == next bar open time: 2023-03-01T00:00:00.000 == close pos time: 2023-03-08T00:00:00.000
2024-11-20 23:07:05,229 - INFO - pnl: 2023-02-28T23:59:59.999 119413.82059299338 === -2.361%
2024-11-20 23:07:05,233 - DEBUG - cur time: 2023-03-01T23:59:59.999 == next bar open time: 2023-03-02T00:00:00.000 == close pos time: 2023-03-09T00:00:00.000
2024-11-20 23:07:05,235 - INFO - pnl: 2023-03-01T23:59:59.999 120818.20586871807 === 1.176%
2024-11-20 23:07:05,239 - DEBUG - cur time: 2023-03-02T23:59:59.999 == next bar open time: 2023-03-03T00:00:00.000 == close pos time: 2023-03-10T00:00:00.000
2024-11-20 23:07:05,241 - INFO - pnl: 2023-03-02T23:59:59.999 120635.65516978124 === -0.151%
2024-11-20 23:07:05,246 - DEBUG - cur time: 2023-03-03T23:59:59.999 == next bar open time: 2023-03-04T00:00:00.000 == close pos time: 2023-03-11T00:00:00.000
2024-11-20 23:07:05,248 - INFO - pnl: 2023-03-03T23:59:59.999 119796.96432978162 === -0.695%
2024-11-20 23:07:05,252 - DEBUG - cur time: 2023-03-04T23:59:59.999 == next bar open time: 2023-03-05T00:00:00.000 == close pos time: 2023-03-12T00:00:00.000
2024-11-20 23:07:05,254 - INFO - pnl: 2023-03-04T23:59:59.999 120377.70506143494 === 0.485%
2024-11-20 23:07:05,259 - DEBUG - cur time: 2023-03-05T23:59:59.999 == next bar open time: 2023-03-06T00:00:00.000 == close pos time: 2023-03-13T00:00:00.000
2024-11-20 23:07:05,260 - INFO - pnl: 2023-03-05T23:59:59.999 118719.81166865444 === -1.377%
2024-11-20 23:07:05,265 - DEBUG - cur time: 2023-03-06T23:59:59.999 == next bar open time: 2023-03-07T00:00:00.000 == close pos time: 2023-03-14T00:00:00.000
2024-11-20 23:07:05,274 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -2.085048    ┆ 0    ┆ 135          │
│ BALUSDT      ┆ -1.982653    ┆ 1    ┆ 134          │
│ LUNA2USDT    ┆ -1.902603    ┆ 2    ┆ 133          │
│ OPUSDT       ┆ -1.874602    ┆ 3    ┆ 132          │
│ QNTUSDT      ┆ -1.675928    ┆ 4    ┆ 131          │
│ DYDXUSDT     ┆ -1.674092    ┆ 5    ┆ 130          │
│ APTUSDT      ┆ -1.641331    ┆ 6    ┆ 129          │
│ BTCDOMUSDT   ┆ -1.597058    ┆ 7    ┆ 128          │
│ SNXUSDT      ┆ -1.564082    ┆ 8    ┆ 127          │
│ IMXUSDT      ┆ -1.514476    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ARPAUSDT     ┆ 0.147229     ┆ 126  ┆ 9            │
│ HNTUSDT      ┆ 0.167866     ┆ 127  ┆ 8            │
│ DASHUSDT     ┆ 0.217906     ┆ 128  ┆ 7            │
│ CTKUSDT      ┆ 0.231056     ┆ 129  ┆ 6            │
│ 1000XECUSDT  ┆ 0.243267     ┆ 130  ┆ 5            │
│ DARUSDT      ┆ 0.281772     ┆ 131  ┆ 4            │
│ DGBUSDT      ┆ 0.429063     ┆ 132  ┆ 3            │
│ CTSIUSDT     ┆ 0.537644     ┆ 133  ┆ 2            │
│ DEFIUSDT     ┆ 0.792503     ┆ 134  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.829647     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:05,281 - WARNING - 2023-03-06T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:05,281 - INFO - cur close time: 2023-03-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:05,281 - DEBUG - mean expected ret (mean factor): -0.7492849163953949
2024-11-20 23:07:05,287 - DEBUG - begin to update pos: =========
2024-11-20 23:07:05,287 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,287 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.146       ┆ null        ┆ … ┆ 0.02741 ┆ null   ┆ null    ┆ 0.2398  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,294 - DEBUG - update position: 2023-03-06T23:59:59.999 === diff_trading_value: 224544.82094234574 == cash: 119077.16932877727 
2024-11-20 23:07:05,296 - INFO - pnl: 2023-03-06T23:59:59.999 119077.16932877727 === 0.301%
2024-11-20 23:07:05,301 - DEBUG - cur time: 2023-03-07T23:59:59.999 == next bar open time: 2023-03-08T00:00:00.000 == close pos time: 2023-03-15T00:00:00.000
2024-11-20 23:07:05,303 - INFO - pnl: 2023-03-07T23:59:59.999 119473.63811867146 === 0.333%
2024-11-20 23:07:05,310 - DEBUG - cur time: 2023-03-08T23:59:59.999 == next bar open time: 2023-03-09T00:00:00.000 == close pos time: 2023-03-16T00:00:00.000
2024-11-20 23:07:05,313 - INFO - pnl: 2023-03-08T23:59:59.999 120549.09013017642 === 0.900%
2024-11-20 23:07:05,319 - DEBUG - cur time: 2023-03-09T23:59:59.999 == next bar open time: 2023-03-10T00:00:00.000 == close pos time: 2023-03-17T00:00:00.000
2024-11-20 23:07:05,321 - INFO - pnl: 2023-03-09T23:59:59.999 117102.84213593083 === -2.859%
2024-11-20 23:07:05,326 - DEBUG - cur time: 2023-03-10T23:59:59.999 == next bar open time: 2023-03-11T00:00:00.000 == close pos time: 2023-03-18T00:00:00.000
2024-11-20 23:07:05,328 - INFO - pnl: 2023-03-10T23:59:59.999 119088.03736657804 === 1.695%
2024-11-20 23:07:05,332 - DEBUG - cur time: 2023-03-11T23:59:59.999 == next bar open time: 2023-03-12T00:00:00.000 == close pos time: 2023-03-19T00:00:00.000
2024-11-20 23:07:05,332 - INFO - pnl: 2023-03-11T23:59:59.999 119772.9956655167 === 0.575%
2024-11-20 23:07:05,339 - DEBUG - cur time: 2023-03-12T23:59:59.999 == next bar open time: 2023-03-13T00:00:00.000 == close pos time: 2023-03-20T00:00:00.000
2024-11-20 23:07:05,341 - INFO - pnl: 2023-03-12T23:59:59.999 117560.33680122289 === -1.847%
2024-11-20 23:07:05,347 - DEBUG - cur time: 2023-03-13T23:59:59.999 == next bar open time: 2023-03-14T00:00:00.000 == close pos time: 2023-03-21T00:00:00.000
2024-11-20 23:07:05,357 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ NEOUSDT      ┆ -2.054827    ┆ 0    ┆ 135          │
│ XRPUSDT      ┆ -2.000812    ┆ 1    ┆ 134          │
│ MASKUSDT     ┆ -1.976751    ┆ 2    ┆ 133          │
│ 1000SHIBUSDT ┆ -1.824469    ┆ 3    ┆ 132          │
│ APTUSDT      ┆ -1.785327    ┆ 4    ┆ 131          │
│ EOSUSDT      ┆ -1.779231    ┆ 5    ┆ 130          │
│ 1000LUNCUSDT ┆ -1.750347    ┆ 6    ┆ 129          │
│ BNBUSDT      ┆ -1.735905    ┆ 7    ┆ 128          │
│ KAVAUSDT     ┆ -1.6987      ┆ 8    ┆ 127          │
│ LDOUSDT      ┆ -1.584038    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ C98USDT      ┆ -0.010928    ┆ 126  ┆ 9            │
│ DGBUSDT      ┆ 0.11556      ┆ 127  ┆ 8            │
│ DASHUSDT     ┆ 0.151168     ┆ 128  ┆ 7            │
│ TRBUSDT      ┆ 0.177747     ┆ 129  ┆ 6            │
│ 1000XECUSDT  ┆ 0.273441     ┆ 130  ┆ 5            │
│ LPTUSDT      ┆ 0.414235     ┆ 131  ┆ 4            │
│ HNTUSDT      ┆ 0.532094     ┆ 132  ┆ 3            │
│ CTSIUSDT     ┆ 0.546719     ┆ 133  ┆ 2            │
│ ARPAUSDT     ┆ 0.612411     ┆ 134  ┆ 1            │
│ DEFIUSDT     ┆ 1.355485     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:05,367 - WARNING - 2023-03-13T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:05,367 - INFO - cur close time: 2023-03-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:05,367 - DEBUG - mean expected ret (mean factor): -0.7549694860076338
2024-11-20 23:07:05,371 - DEBUG - begin to update pos: =========
2024-11-20 23:07:05,373 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,373 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1319      ┆ null        ┆ … ┆ 0.0262  ┆ null   ┆ null    ┆ 0.225   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,380 - DEBUG - update position: 2023-03-13T23:59:59.999 === diff_trading_value: 243934.59635467367 == cash: 117691.06102049715 
2024-11-20 23:07:05,381 - INFO - pnl: 2023-03-13T23:59:59.999 112691.06102049715 === -4.142%
2024-11-20 23:07:05,385 - DEBUG - cur time: 2023-03-14T23:59:59.999 == next bar open time: 2023-03-15T00:00:00.000 == close pos time: 2023-03-22T00:00:00.000
2024-11-20 23:07:05,387 - INFO - pnl: 2023-03-14T23:59:59.999 113303.84117637182 === 0.544%
2024-11-20 23:07:05,390 - DEBUG - cur time: 2023-03-15T23:59:59.999 == next bar open time: 2023-03-16T00:00:00.000 == close pos time: 2023-03-23T00:00:00.000
2024-11-20 23:07:05,392 - INFO - pnl: 2023-03-15T23:59:59.999 111567.82579367122 === -1.532%
2024-11-20 23:07:05,396 - DEBUG - cur time: 2023-03-16T23:59:59.999 == next bar open time: 2023-03-17T00:00:00.000 == close pos time: 2023-03-24T00:00:00.000
2024-11-20 23:07:05,397 - INFO - pnl: 2023-03-16T23:59:59.999 111924.3443062724 === 0.320%
2024-11-20 23:07:05,403 - DEBUG - cur time: 2023-03-17T23:59:59.999 == next bar open time: 2023-03-18T00:00:00.000 == close pos time: 2023-03-25T00:00:00.000
2024-11-20 23:07:05,405 - INFO - pnl: 2023-03-17T23:59:59.999 111720.505875044 === -0.182%
2024-11-20 23:07:05,410 - DEBUG - cur time: 2023-03-18T23:59:59.999 == next bar open time: 2023-03-19T00:00:00.000 == close pos time: 2023-03-26T00:00:00.000
2024-11-20 23:07:05,411 - INFO - pnl: 2023-03-18T23:59:59.999 109721.22680365799 === -1.790%
2024-11-20 23:07:05,416 - DEBUG - cur time: 2023-03-19T23:59:59.999 == next bar open time: 2023-03-20T00:00:00.000 == close pos time: 2023-03-27T00:00:00.000
2024-11-20 23:07:05,419 - INFO - pnl: 2023-03-19T23:59:59.999 110705.11613684017 === 0.897%
2024-11-20 23:07:05,423 - DEBUG - cur time: 2023-03-20T23:59:59.999 == next bar open time: 2023-03-21T00:00:00.000 == close pos time: 2023-03-28T00:00:00.000
2024-11-20 23:07:05,439 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LUNA2USDT    ┆ -1.692384    ┆ 0    ┆ 134          │
│ AXSUSDT      ┆ -1.669955    ┆ 1    ┆ 133          │
│ 1000LUNCUSDT ┆ -1.665106    ┆ 2    ┆ 132          │
│ LDOUSDT      ┆ -1.6524      ┆ 3    ┆ 131          │
│ 1000SHIBUSDT ┆ -1.576801    ┆ 4    ┆ 130          │
│ EGLDUSDT     ┆ -1.535202    ┆ 5    ┆ 129          │
│ XLMUSDT      ┆ -1.526869    ┆ 6    ┆ 128          │
│ GMTUSDT      ┆ -1.508402    ┆ 7    ┆ 127          │
│ GTCUSDT      ┆ -1.47097     ┆ 8    ┆ 126          │
│ EOSUSDT      ┆ -1.460005    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BLZUSDT      ┆ -0.148727    ┆ 125  ┆ 9            │
│ SPELLUSDT    ┆ -0.069376    ┆ 126  ┆ 8            │
│ OGNUSDT      ┆ -0.04865     ┆ 127  ┆ 7            │
│ XMRUSDT      ┆ 0.03077      ┆ 128  ┆ 6            │
│ 1000XECUSDT  ┆ 0.076871     ┆ 129  ┆ 5            │
│ DASHUSDT     ┆ 0.080699     ┆ 130  ┆ 4            │
│ DGBUSDT      ┆ 0.098202     ┆ 131  ┆ 3            │
│ IOTXUSDT     ┆ 0.230954     ┆ 132  ┆ 2            │
│ INJUSDT      ┆ 0.314373     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 0.976194     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:05,458 - WARNING - 2023-03-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:05,458 - INFO - cur close time: 2023-03-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:05,459 - DEBUG - mean expected ret (mean factor): -0.7767714315387498
2024-11-20 23:07:05,465 - DEBUG - begin to update pos: =========
2024-11-20 23:07:05,466 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,466 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1265      ┆ null        ┆ … ┆ 0.02762 ┆ null   ┆ null    ┆ 0.2338  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,473 - DEBUG - update position: 2023-03-20T23:59:59.999 === diff_trading_value: 242069.1838840065 == cash: 110895.0545167389 
2024-11-20 23:07:05,475 - INFO - pnl: 2023-03-20T23:59:59.999 110895.0545167389 === 0.172%
2024-11-20 23:07:05,480 - DEBUG - cur time: 2023-03-21T23:59:59.999 == next bar open time: 2023-03-22T00:00:00.000 == close pos time: 2023-03-29T00:00:00.000
2024-11-20 23:07:05,481 - INFO - pnl: 2023-03-21T23:59:59.999 110716.43560606886 === -0.161%
2024-11-20 23:07:05,489 - DEBUG - cur time: 2023-03-22T23:59:59.999 == next bar open time: 2023-03-23T00:00:00.000 == close pos time: 2023-03-30T00:00:00.000
2024-11-20 23:07:05,491 - INFO - pnl: 2023-03-22T23:59:59.999 108863.25635000401 === -1.674%
2024-11-20 23:07:05,495 - DEBUG - cur time: 2023-03-23T23:59:59.999 == next bar open time: 2023-03-24T00:00:00.000 == close pos time: 2023-03-31T00:00:00.000
2024-11-20 23:07:05,497 - INFO - pnl: 2023-03-23T23:59:59.999 111794.73666628163 === 2.693%
2024-11-20 23:07:05,504 - DEBUG - cur time: 2023-03-24T23:59:59.999 == next bar open time: 2023-03-25T00:00:00.000 == close pos time: 2023-04-01T00:00:00.000
2024-11-20 23:07:05,507 - INFO - pnl: 2023-03-24T23:59:59.999 112285.6149460683 === 0.439%
2024-11-20 23:07:05,516 - DEBUG - cur time: 2023-03-25T23:59:59.999 == next bar open time: 2023-03-26T00:00:00.000 == close pos time: 2023-04-02T00:00:00.000
2024-11-20 23:07:05,519 - INFO - pnl: 2023-03-25T23:59:59.999 109739.83568397426 === -2.267%
2024-11-20 23:07:05,522 - DEBUG - cur time: 2023-03-26T23:59:59.999 == next bar open time: 2023-03-27T00:00:00.000 == close pos time: 2023-04-03T00:00:00.000
2024-11-20 23:07:05,524 - INFO - pnl: 2023-03-26T23:59:59.999 109942.78029489417 === 0.185%
2024-11-20 23:07:05,530 - DEBUG - cur time: 2023-03-27T23:59:59.999 == next bar open time: 2023-03-28T00:00:00.000 == close pos time: 2023-04-04T00:00:00.000
2024-11-20 23:07:05,540 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MKRUSDT      ┆ -2.162832    ┆ 0    ┆ 134          │
│ APTUSDT      ┆ -1.874152    ┆ 1    ┆ 133          │
│ ATOMUSDT     ┆ -1.757566    ┆ 2    ┆ 132          │
│ EGLDUSDT     ┆ -1.610072    ┆ 3    ┆ 131          │
│ GTCUSDT      ┆ -1.588717    ┆ 4    ┆ 130          │
│ BTCDOMUSDT   ┆ -1.588438    ┆ 5    ┆ 129          │
│ FILUSDT      ┆ -1.583544    ┆ 6    ┆ 128          │
│ NEOUSDT      ┆ -1.560894    ┆ 7    ┆ 127          │
│ AXSUSDT      ┆ -1.508545    ┆ 8    ┆ 126          │
│ UNIUSDT      ┆ -1.45132     ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ -0.069331    ┆ 125  ┆ 9            │
│ INJUSDT      ┆ -0.025964    ┆ 126  ┆ 8            │
│ BAKEUSDT     ┆ 0.023616     ┆ 127  ┆ 7            │
│ SFPUSDT      ┆ 0.063154     ┆ 128  ┆ 6            │
│ OGNUSDT      ┆ 0.076871     ┆ 129  ┆ 5            │
│ 1000XECUSDT  ┆ 0.197473     ┆ 130  ┆ 4            │
│ BLUEBIRDUSDT ┆ 0.29859      ┆ 131  ┆ 3            │
│ DGBUSDT      ┆ 0.404408     ┆ 132  ┆ 2            │
│ DEFIUSDT     ┆ 0.59679      ┆ 133  ┆ 1            │
│ SPELLUSDT    ┆ 0.645902     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:05,551 - WARNING - 2023-03-27T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:05,551 - INFO - cur close time: 2023-03-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:05,551 - DEBUG - mean expected ret (mean factor): -0.7375097933499282
2024-11-20 23:07:05,557 - DEBUG - begin to update pos: =========
2024-11-20 23:07:05,558 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,558 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1204      ┆ null        ┆ … ┆ 0.02594 ┆ null   ┆ null    ┆ 0.2154  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,568 - DEBUG - update position: 2023-03-27T23:59:59.999 === diff_trading_value: 221304.07346957715 == cash: 110129.22249645622 
2024-11-20 23:07:05,570 - INFO - pnl: 2023-03-27T23:59:59.999 110129.22249645622 === 0.170%
2024-11-20 23:07:05,575 - DEBUG - cur time: 2023-03-28T23:59:59.999 == next bar open time: 2023-03-29T00:00:00.000 == close pos time: 2023-04-05T00:00:00.000
2024-11-20 23:07:05,578 - INFO - pnl: 2023-03-28T23:59:59.999 112076.08412767493 === 1.768%
2024-11-20 23:07:05,583 - DEBUG - cur time: 2023-03-29T23:59:59.999 == next bar open time: 2023-03-30T00:00:00.000 == close pos time: 2023-04-06T00:00:00.000
2024-11-20 23:07:05,584 - INFO - pnl: 2023-03-29T23:59:59.999 114848.18959656294 === 2.473%
2024-11-20 23:07:05,588 - DEBUG - cur time: 2023-03-30T23:59:59.999 == next bar open time: 2023-03-31T00:00:00.000 == close pos time: 2023-04-07T00:00:00.000
2024-11-20 23:07:05,590 - INFO - pnl: 2023-03-30T23:59:59.999 118213.70566255249 === 2.930%
2024-11-20 23:07:05,597 - DEBUG - cur time: 2023-03-31T23:59:59.999 == next bar open time: 2023-04-01T00:00:00.000 == close pos time: 2023-04-08T00:00:00.000
2024-11-20 23:07:05,599 - INFO - pnl: 2023-03-31T23:59:59.999 120176.63153673595 === 1.660%
2024-11-20 23:07:05,604 - DEBUG - cur time: 2023-04-01T23:59:59.999 == next bar open time: 2023-04-02T00:00:00.000 == close pos time: 2023-04-09T00:00:00.000
2024-11-20 23:07:05,606 - INFO - pnl: 2023-04-01T23:59:59.999 121363.54628491518 === 0.988%
2024-11-20 23:07:05,613 - DEBUG - cur time: 2023-04-02T23:59:59.999 == next bar open time: 2023-04-03T00:00:00.000 == close pos time: 2023-04-10T00:00:00.000
2024-11-20 23:07:05,615 - INFO - pnl: 2023-04-02T23:59:59.999 120258.45768178153 === -0.911%
2024-11-20 23:07:05,621 - DEBUG - cur time: 2023-04-03T23:59:59.999 == next bar open time: 2023-04-04T00:00:00.000 == close pos time: 2023-04-11T00:00:00.000
2024-11-20 23:07:05,631 - DEBUG - sorted_long_factors: shape: (135, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ GTCUSDT     ┆ -2.055576    ┆ 0    ┆ 134          │
│ APTUSDT     ┆ -1.802089    ┆ 1    ┆ 133          │
│ INJUSDT     ┆ -1.77649     ┆ 2    ┆ 132          │
│ RLCUSDT     ┆ -1.691512    ┆ 3    ┆ 131          │
│ OMGUSDT     ┆ -1.575066    ┆ 4    ┆ 130          │
│ MASKUSDT    ┆ -1.524024    ┆ 5    ┆ 129          │
│ XMRUSDT     ┆ -1.414363    ┆ 6    ┆ 128          │
│ DOTUSDT     ┆ -1.362756    ┆ 7    ┆ 127          │
│ APEUSDT     ┆ -1.326381    ┆ 8    ┆ 126          │
│ ATOMUSDT    ┆ -1.306215    ┆ 9    ┆ 125          │
│ …           ┆ …            ┆ …    ┆ …            │
│ 1000XECUSDT ┆ 0.018145     ┆ 125  ┆ 9            │
│ ENSUSDT     ┆ 0.031729     ┆ 126  ┆ 8            │
│ ARUSDT      ┆ 0.045692     ┆ 127  ┆ 7            │
│ KSMUSDT     ┆ 0.068375     ┆ 128  ┆ 6            │
│ IOTAUSDT    ┆ 0.069578     ┆ 129  ┆ 5            │
│ CTKUSDT     ┆ 0.085387     ┆ 130  ┆ 4            │
│ FLMUSDT     ┆ 0.105049     ┆ 131  ┆ 3            │
│ BAKEUSDT    ┆ 0.12891      ┆ 132  ┆ 2            │
│ TRBUSDT     ┆ 0.385136     ┆ 133  ┆ 1            │
│ DEFIUSDT    ┆ 0.704395     ┆ 134  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:05,645 - WARNING - 2023-04-03T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:05,645 - INFO - cur close time: 2023-04-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:05,645 - DEBUG - mean expected ret (mean factor): -0.7408411373610906
2024-11-20 23:07:05,651 - DEBUG - begin to update pos: =========
2024-11-20 23:07:05,652 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,652 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1216      ┆ null        ┆ … ┆ 0.02952 ┆ null   ┆ null    ┆ 0.2914  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,663 - DEBUG - update position: 2023-04-03T23:59:59.999 === diff_trading_value: 294919.76853452605 == cash: 123230.56769925484 
2024-11-20 23:07:05,665 - INFO - pnl: 2023-04-03T23:59:59.999 123230.56769925484 === 2.471%
2024-11-20 23:07:05,671 - DEBUG - cur time: 2023-04-04T23:59:59.999 == next bar open time: 2023-04-05T00:00:00.000 == close pos time: 2023-04-12T00:00:00.000
2024-11-20 23:07:05,673 - INFO - pnl: 2023-04-04T23:59:59.999 126137.42083509374 === 2.359%
2024-11-20 23:07:05,678 - DEBUG - cur time: 2023-04-05T23:59:59.999 == next bar open time: 2023-04-06T00:00:00.000 == close pos time: 2023-04-13T00:00:00.000
2024-11-20 23:07:05,679 - INFO - pnl: 2023-04-05T23:59:59.999 126062.63515123731 === -0.059%
2024-11-20 23:07:05,685 - DEBUG - cur time: 2023-04-06T23:59:59.999 == next bar open time: 2023-04-07T00:00:00.000 == close pos time: 2023-04-14T00:00:00.000
2024-11-20 23:07:05,687 - INFO - pnl: 2023-04-06T23:59:59.999 126030.17001853327 === -0.026%
2024-11-20 23:07:05,691 - DEBUG - cur time: 2023-04-07T23:59:59.999 == next bar open time: 2023-04-08T00:00:00.000 == close pos time: 2023-04-15T00:00:00.000
2024-11-20 23:07:05,693 - INFO - pnl: 2023-04-07T23:59:59.999 126481.21663674683 === 0.358%
2024-11-20 23:07:05,698 - DEBUG - cur time: 2023-04-08T23:59:59.999 == next bar open time: 2023-04-09T00:00:00.000 == close pos time: 2023-04-16T00:00:00.000
2024-11-20 23:07:05,700 - INFO - pnl: 2023-04-08T23:59:59.999 126860.72620442977 === 0.300%
2024-11-20 23:07:05,704 - DEBUG - cur time: 2023-04-09T23:59:59.999 == next bar open time: 2023-04-10T00:00:00.000 == close pos time: 2023-04-17T00:00:00.000
2024-11-20 23:07:05,706 - INFO - pnl: 2023-04-09T23:59:59.999 126514.20448825182 === -0.273%
2024-11-20 23:07:05,711 - DEBUG - cur time: 2023-04-10T23:59:59.999 == next bar open time: 2023-04-11T00:00:00.000 == close pos time: 2023-04-18T00:00:00.000
2024-11-20 23:07:05,725 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -2.077288    ┆ 0    ┆ 134          │
│ FOOTBALLUSDT ┆ -1.890594    ┆ 1    ┆ 133          │
│ NEOUSDT      ┆ -1.797174    ┆ 2    ┆ 132          │
│ MASKUSDT     ┆ -1.709788    ┆ 3    ┆ 131          │
│ QTUMUSDT     ┆ -1.674012    ┆ 4    ┆ 130          │
│ MKRUSDT      ┆ -1.654927    ┆ 5    ┆ 129          │
│ BANDUSDT     ┆ -1.62767     ┆ 6    ┆ 128          │
│ OMGUSDT      ┆ -1.62003     ┆ 7    ┆ 127          │
│ XRPUSDT      ┆ -1.549543    ┆ 8    ┆ 126          │
│ AXSUSDT      ┆ -1.511585    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DARUSDT      ┆ -0.126996    ┆ 125  ┆ 9            │
│ KSMUSDT      ┆ -0.062548    ┆ 126  ┆ 8            │
│ BLZUSDT      ┆ 0.040211     ┆ 127  ┆ 7            │
│ ONEUSDT      ┆ 0.133914     ┆ 128  ┆ 6            │
│ SKLUSDT      ┆ 0.19187      ┆ 129  ┆ 5            │
│ DENTUSDT     ┆ 0.298621     ┆ 130  ┆ 4            │
│ DGBUSDT      ┆ 0.357664     ┆ 131  ┆ 3            │
│ CTKUSDT      ┆ 0.413559     ┆ 132  ┆ 2            │
│ CVXUSDT      ┆ 0.681447     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 0.892896     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:05,733 - WARNING - 2023-04-10T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:05,733 - INFO - cur close time: 2023-04-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:05,733 - DEBUG - mean expected ret (mean factor): -0.783387149885747
2024-11-20 23:07:05,738 - DEBUG - begin to update pos: =========
2024-11-20 23:07:05,738 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,739 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1251      ┆ null        ┆ … ┆ 0.0297  ┆ null   ┆ null    ┆ 0.2885  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,747 - DEBUG - update position: 2023-04-10T23:59:59.999 === diff_trading_value: 266885.94658665214 == cash: 126485.10128364792 
2024-11-20 23:07:05,749 - INFO - pnl: 2023-04-10T23:59:59.999 126485.10128364792 === -0.023%
2024-11-20 23:07:05,756 - DEBUG - cur time: 2023-04-11T23:59:59.999 == next bar open time: 2023-04-12T00:00:00.000 == close pos time: 2023-04-19T00:00:00.000
2024-11-20 23:07:05,761 - INFO - pnl: 2023-04-11T23:59:59.999 125348.90798000229 === -0.898%
2024-11-20 23:07:05,769 - DEBUG - cur time: 2023-04-12T23:59:59.999 == next bar open time: 2023-04-13T00:00:00.000 == close pos time: 2023-04-20T00:00:00.000
2024-11-20 23:07:05,774 - INFO - pnl: 2023-04-12T23:59:59.999 127574.3949261436 === 1.775%
2024-11-20 23:07:05,784 - DEBUG - cur time: 2023-04-13T23:59:59.999 == next bar open time: 2023-04-14T00:00:00.000 == close pos time: 2023-04-21T00:00:00.000
2024-11-20 23:07:05,789 - INFO - pnl: 2023-04-13T23:59:59.999 127456.77913042853 === -0.092%
2024-11-20 23:07:05,800 - DEBUG - cur time: 2023-04-14T23:59:59.999 == next bar open time: 2023-04-15T00:00:00.000 == close pos time: 2023-04-22T00:00:00.000
2024-11-20 23:07:05,803 - INFO - pnl: 2023-04-14T23:59:59.999 127368.03596300917 === -0.070%
2024-11-20 23:07:05,813 - DEBUG - cur time: 2023-04-15T23:59:59.999 == next bar open time: 2023-04-16T00:00:00.000 == close pos time: 2023-04-23T00:00:00.000
2024-11-20 23:07:05,815 - INFO - pnl: 2023-04-15T23:59:59.999 127954.21102686059 === 0.460%
2024-11-20 23:07:05,820 - DEBUG - cur time: 2023-04-16T23:59:59.999 == next bar open time: 2023-04-17T00:00:00.000 == close pos time: 2023-04-24T00:00:00.000
2024-11-20 23:07:05,823 - INFO - pnl: 2023-04-16T23:59:59.999 128777.98579466494 === 0.644%
2024-11-20 23:07:05,832 - DEBUG - cur time: 2023-04-17T23:59:59.999 == next bar open time: 2023-04-18T00:00:00.000 == close pos time: 2023-04-25T00:00:00.000
2024-11-20 23:07:05,851 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AXSUSDT      ┆ -1.92915     ┆ 0    ┆ 134          │
│ DYDXUSDT     ┆ -1.663174    ┆ 1    ┆ 133          │
│ DOGEUSDT     ┆ -1.592541    ┆ 2    ┆ 132          │
│ NEOUSDT      ┆ -1.577491    ┆ 3    ┆ 131          │
│ OMGUSDT      ┆ -1.572076    ┆ 4    ┆ 130          │
│ APTUSDT      ┆ -1.515339    ┆ 5    ┆ 129          │
│ FOOTBALLUSDT ┆ -1.479125    ┆ 6    ┆ 128          │
│ BNBUSDT      ┆ -1.444821    ┆ 7    ┆ 127          │
│ MKRUSDT      ┆ -1.401881    ┆ 8    ┆ 126          │
│ SANDUSDT     ┆ -1.376373    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ALPHAUSDT    ┆ -0.163508    ┆ 125  ┆ 9            │
│ CTKUSDT      ┆ -0.156701    ┆ 126  ┆ 8            │
│ IOTXUSDT     ┆ -0.146731    ┆ 127  ┆ 7            │
│ GTCUSDT      ┆ -0.143115    ┆ 128  ┆ 6            │
│ DGBUSDT      ┆ -0.070868    ┆ 129  ┆ 5            │
│ BLUEBIRDUSDT ┆ -0.029725    ┆ 130  ┆ 4            │
│ BLZUSDT      ┆ -0.008795    ┆ 131  ┆ 3            │
│ CVXUSDT      ┆ 0.265911     ┆ 132  ┆ 2            │
│ LPTUSDT      ┆ 0.348973     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 1.917926     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:05,867 - WARNING - 2023-04-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:05,867 - INFO - cur close time: 2023-04-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:05,868 - DEBUG - mean expected ret (mean factor): -0.7723502650754485
2024-11-20 23:07:05,878 - DEBUG - begin to update pos: =========
2024-11-20 23:07:05,879 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,879 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1243      ┆ null        ┆ … ┆ 0.03162 ┆ null   ┆ null    ┆ 0.2932  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,889 - DEBUG - update position: 2023-04-17T23:59:59.999 === diff_trading_value: 177732.69743009424 == cash: 127761.7968500589 
2024-11-20 23:07:05,891 - INFO - pnl: 2023-04-17T23:59:59.999 127761.7968500589 === -0.789%
2024-11-20 23:07:05,899 - DEBUG - cur time: 2023-04-18T23:59:59.999 == next bar open time: 2023-04-19T00:00:00.000 == close pos time: 2023-04-26T00:00:00.000
2024-11-20 23:07:05,903 - INFO - pnl: 2023-04-18T23:59:59.999 127613.51916410557 === -0.116%
2024-11-20 23:07:05,910 - DEBUG - cur time: 2023-04-19T23:59:59.999 == next bar open time: 2023-04-20T00:00:00.000 == close pos time: 2023-04-27T00:00:00.000
2024-11-20 23:07:05,916 - INFO - pnl: 2023-04-19T23:59:59.999 127515.648514842 === -0.077%
2024-11-20 23:07:05,923 - DEBUG - cur time: 2023-04-20T23:59:59.999 == next bar open time: 2023-04-21T00:00:00.000 == close pos time: 2023-04-28T00:00:00.000
2024-11-20 23:07:05,928 - INFO - pnl: 2023-04-20T23:59:59.999 126250.51531666014 === -0.992%
2024-11-20 23:07:05,935 - DEBUG - cur time: 2023-04-21T23:59:59.999 == next bar open time: 2023-04-22T00:00:00.000 == close pos time: 2023-04-29T00:00:00.000
2024-11-20 23:07:05,939 - INFO - pnl: 2023-04-21T23:59:59.999 126398.22396172835 === 0.117%
2024-11-20 23:07:05,944 - DEBUG - cur time: 2023-04-22T23:59:59.999 == next bar open time: 2023-04-23T00:00:00.000 == close pos time: 2023-04-30T00:00:00.000
2024-11-20 23:07:05,948 - INFO - pnl: 2023-04-22T23:59:59.999 126572.22239489786 === 0.138%
2024-11-20 23:07:05,955 - DEBUG - cur time: 2023-04-23T23:59:59.999 == next bar open time: 2023-04-24T00:00:00.000 == close pos time: 2023-05-01T00:00:00.000
2024-11-20 23:07:05,959 - INFO - pnl: 2023-04-23T23:59:59.999 126710.56299903797 === 0.109%
2024-11-20 23:07:05,966 - DEBUG - cur time: 2023-04-24T23:59:59.999 == next bar open time: 2023-04-25T00:00:00.000 == close pos time: 2023-05-02T00:00:00.000
2024-11-20 23:07:05,979 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ UNFIUSDT ┆ -1.753352    ┆ 0    ┆ 134          │
│ AXSUSDT  ┆ -1.706993    ┆ 1    ┆ 133          │
│ COMPUSDT ┆ -1.635907    ┆ 2    ┆ 132          │
│ EGLDUSDT ┆ -1.632044    ┆ 3    ┆ 131          │
│ AAVEUSDT ┆ -1.562469    ┆ 4    ┆ 130          │
│ FILUSDT  ┆ -1.516519    ┆ 5    ┆ 129          │
│ DOTUSDT  ┆ -1.512326    ┆ 6    ┆ 128          │
│ ATOMUSDT ┆ -1.500439    ┆ 7    ┆ 127          │
│ DYDXUSDT ┆ -1.488996    ┆ 8    ┆ 126          │
│ SANDUSDT ┆ -1.478487    ┆ 9    ┆ 125          │
│ …        ┆ …            ┆ …    ┆ …            │
│ DARUSDT  ┆ -0.244592    ┆ 125  ┆ 9            │
│ BLZUSDT  ┆ -0.2211      ┆ 126  ┆ 8            │
│ ANTUSDT  ┆ -0.181578    ┆ 127  ┆ 7            │
│ GTCUSDT  ┆ -0.170501    ┆ 128  ┆ 6            │
│ SXPUSDT  ┆ -0.129834    ┆ 129  ┆ 5            │
│ API3USDT ┆ -0.066438    ┆ 130  ┆ 4            │
│ BAKEUSDT ┆ -0.059623    ┆ 131  ┆ 3            │
│ ICXUSDT  ┆ -0.015776    ┆ 132  ┆ 2            │
│ CVXUSDT  ┆ 0.262444     ┆ 133  ┆ 1            │
│ DEFIUSDT ┆ 1.351818     ┆ 134  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:05,990 - WARNING - 2023-04-24T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:05,990 - INFO - cur close time: 2023-04-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:05,990 - DEBUG - mean expected ret (mean factor): -0.7791647117763033
2024-11-20 23:07:05,998 - DEBUG - begin to update pos: =========
2024-11-20 23:07:05,998 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:05,999 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1106      ┆ null        ┆ … ┆ 0.03106 ┆ null   ┆ null    ┆ 0.2576  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,011 - DEBUG - update position: 2023-04-24T23:59:59.999 === diff_trading_value: 209830.3243796244 == cash: 126163.0327072171 
2024-11-20 23:07:06,014 - INFO - pnl: 2023-04-24T23:59:59.999 126163.0327072171 === -0.432%
2024-11-20 23:07:06,019 - DEBUG - cur time: 2023-04-25T23:59:59.999 == next bar open time: 2023-04-26T00:00:00.000 == close pos time: 2023-05-03T00:00:00.000
2024-11-20 23:07:06,022 - INFO - pnl: 2023-04-25T23:59:59.999 126545.83420154476 === 0.303%
2024-11-20 23:07:06,027 - DEBUG - cur time: 2023-04-26T23:59:59.999 == next bar open time: 2023-04-27T00:00:00.000 == close pos time: 2023-05-04T00:00:00.000
2024-11-20 23:07:06,029 - INFO - pnl: 2023-04-26T23:59:59.999 126438.4547765719 === -0.085%
2024-11-20 23:07:06,035 - DEBUG - cur time: 2023-04-27T23:59:59.999 == next bar open time: 2023-04-28T00:00:00.000 == close pos time: 2023-05-05T00:00:00.000
2024-11-20 23:07:06,037 - INFO - pnl: 2023-04-27T23:59:59.999 125768.19134381885 === -0.530%
2024-11-20 23:07:06,042 - DEBUG - cur time: 2023-04-28T23:59:59.999 == next bar open time: 2023-04-29T00:00:00.000 == close pos time: 2023-05-06T00:00:00.000
2024-11-20 23:07:06,045 - INFO - pnl: 2023-04-28T23:59:59.999 123841.7169582776 === -1.532%
2024-11-20 23:07:06,049 - DEBUG - cur time: 2023-04-29T23:59:59.999 == next bar open time: 2023-04-30T00:00:00.000 == close pos time: 2023-05-07T00:00:00.000
2024-11-20 23:07:06,052 - INFO - pnl: 2023-04-29T23:59:59.999 123972.32386370143 === 0.105%
2024-11-20 23:07:06,055 - DEBUG - cur time: 2023-04-30T23:59:59.999 == next bar open time: 2023-05-01T00:00:00.000 == close pos time: 2023-05-08T00:00:00.000
2024-11-20 23:07:06,057 - INFO - pnl: 2023-04-30T23:59:59.999 123635.19590510457 === -0.272%
2024-11-20 23:07:06,062 - DEBUG - cur time: 2023-05-01T23:59:59.999 == next bar open time: 2023-05-02T00:00:00.000 == close pos time: 2023-05-09T00:00:00.000
2024-11-20 23:07:06,071 - DEBUG - sorted_long_factors: shape: (137, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ FXSUSDT     ┆ -1.80383     ┆ 0    ┆ 136          │
│ APTUSDT     ┆ -1.707089    ┆ 1    ┆ 135          │
│ SNXUSDT     ┆ -1.541503    ┆ 2    ┆ 134          │
│ WAVESUSDT   ┆ -1.415313    ┆ 3    ┆ 133          │
│ UNFIUSDT    ┆ -1.402297    ┆ 4    ┆ 132          │
│ DOTUSDT     ┆ -1.39279     ┆ 5    ┆ 131          │
│ BANDUSDT    ┆ -1.382804    ┆ 6    ┆ 130          │
│ MKRUSDT     ┆ -1.375776    ┆ 7    ┆ 129          │
│ DOGEUSDT    ┆ -1.351508    ┆ 8    ┆ 128          │
│ CHZUSDT     ┆ -1.348582    ┆ 9    ┆ 127          │
│ …           ┆ …            ┆ …    ┆ …            │
│ BTCDOMUSDT  ┆ -0.215705    ┆ 127  ┆ 9            │
│ KNCUSDT     ┆ -0.171488    ┆ 128  ┆ 8            │
│ BAKEUSDT    ┆ -0.147463    ┆ 129  ┆ 7            │
│ OGNUSDT     ┆ -0.146579    ┆ 130  ┆ 6            │
│ 1INCHUSDT   ┆ -0.107538    ┆ 131  ┆ 5            │
│ 1000XECUSDT ┆ -0.099433    ┆ 132  ┆ 4            │
│ CVXUSDT     ┆ 0.046665     ┆ 133  ┆ 3            │
│ BLZUSDT     ┆ 0.093689     ┆ 134  ┆ 2            │
│ DGBUSDT     ┆ 0.264513     ┆ 135  ┆ 1            │
│ DEFIUSDT    ┆ 1.201563     ┆ 136  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:06,084 - INFO - cur close time: 2023-05-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:06,085 - DEBUG - mean expected ret (mean factor): -0.7684028456132067
2024-11-20 23:07:06,094 - DEBUG - begin to update pos: =========
2024-11-20 23:07:06,094 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,094 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1052      ┆ null        ┆ … ┆ 0.02698 ┆ null   ┆ null    ┆ 0.2469  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,106 - DEBUG - update position: 2023-05-01T23:59:59.999 === diff_trading_value: 261719.66937468556 == cash: 123583.08493168833 
2024-11-20 23:07:06,107 - INFO - pnl: 2023-05-01T23:59:59.999 123583.08493168833 === -0.042%
2024-11-20 23:07:06,114 - DEBUG - cur time: 2023-05-02T23:59:59.999 == next bar open time: 2023-05-03T00:00:00.000 == close pos time: 2023-05-10T00:00:00.000
2024-11-20 23:07:06,116 - INFO - pnl: 2023-05-02T23:59:59.999 123653.08319197214 === 0.057%
2024-11-20 23:07:06,120 - DEBUG - cur time: 2023-05-03T23:59:59.999 == next bar open time: 2023-05-04T00:00:00.000 == close pos time: 2023-05-11T00:00:00.000
2024-11-20 23:07:06,123 - INFO - pnl: 2023-05-03T23:59:59.999 123370.56126867684 === -0.228%
2024-11-20 23:07:06,127 - DEBUG - cur time: 2023-05-04T23:59:59.999 == next bar open time: 2023-05-05T00:00:00.000 == close pos time: 2023-05-12T00:00:00.000
2024-11-20 23:07:06,129 - INFO - pnl: 2023-05-04T23:59:59.999 123502.27679403475 === 0.107%
2024-11-20 23:07:06,133 - DEBUG - cur time: 2023-05-05T23:59:59.999 == next bar open time: 2023-05-06T00:00:00.000 == close pos time: 2023-05-13T00:00:00.000
2024-11-20 23:07:06,136 - INFO - pnl: 2023-05-05T23:59:59.999 122589.93272395185 === -0.739%
2024-11-20 23:07:06,139 - DEBUG - cur time: 2023-05-06T23:59:59.999 == next bar open time: 2023-05-07T00:00:00.000 == close pos time: 2023-05-14T00:00:00.000
2024-11-20 23:07:06,141 - INFO - pnl: 2023-05-06T23:59:59.999 123616.31044250909 === 0.837%
2024-11-20 23:07:06,145 - DEBUG - cur time: 2023-05-07T23:59:59.999 == next bar open time: 2023-05-08T00:00:00.000 == close pos time: 2023-05-15T00:00:00.000
2024-11-20 23:07:06,146 - INFO - pnl: 2023-05-07T23:59:59.999 122560.67689396115 === -0.854%
2024-11-20 23:07:06,154 - DEBUG - cur time: 2023-05-08T23:59:59.999 == next bar open time: 2023-05-09T00:00:00.000 == close pos time: 2023-05-16T00:00:00.000
2024-11-20 23:07:06,167 - DEBUG - sorted_long_factors: shape: (139, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ICPUSDT      ┆ -1.788023    ┆ 0    ┆ 138          │
│ FOOTBALLUSDT ┆ -1.561905    ┆ 1    ┆ 137          │
│ MTLUSDT      ┆ -1.531808    ┆ 2    ┆ 136          │
│ APTUSDT      ┆ -1.514952    ┆ 3    ┆ 135          │
│ CHZUSDT      ┆ -1.463158    ┆ 4    ┆ 134          │
│ HBARUSDT     ┆ -1.391512    ┆ 5    ┆ 133          │
│ 1000SHIBUSDT ┆ -1.381352    ┆ 6    ┆ 132          │
│ HOOKUSDT     ┆ -1.3635      ┆ 7    ┆ 131          │
│ STMXUSDT     ┆ -1.353369    ┆ 8    ┆ 130          │
│ ZILUSDT      ┆ -1.347374    ┆ 9    ┆ 129          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BLZUSDT      ┆ -0.219713    ┆ 129  ┆ 9            │
│ DGBUSDT      ┆ -0.177232    ┆ 130  ┆ 8            │
│ TRBUSDT      ┆ -0.133406    ┆ 131  ┆ 7            │
│ OGNUSDT      ┆ -0.126474    ┆ 132  ┆ 6            │
│ SKLUSDT      ┆ -0.118136    ┆ 133  ┆ 5            │
│ ZENUSDT      ┆ -0.034824    ┆ 134  ┆ 4            │
│ LPTUSDT      ┆ -0.00407     ┆ 135  ┆ 3            │
│ BAKEUSDT     ┆ 0.180627     ┆ 136  ┆ 2            │
│ CVXUSDT      ┆ 0.276886     ┆ 137  ┆ 1            │
│ DEFIUSDT     ┆ 1.2634       ┆ 138  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:06,177 - WARNING - 2023-05-08T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:06,177 - INFO - cur close time: 2023-05-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:06,178 - DEBUG - mean expected ret (mean factor): -0.7712802502140202
2024-11-20 23:07:06,186 - DEBUG - begin to update pos: =========
2024-11-20 23:07:06,187 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬──────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT  ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---      ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64      ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆          ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪══════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ -10000.0 ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴──────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,187 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0843      ┆ null        ┆ … ┆ 0.02381 ┆ null   ┆ null    ┆ 0.2149  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,196 - DEBUG - update position: 2023-05-08T23:59:59.999 === diff_trading_value: 264096.74844963354 == cash: 123692.44506846595 
2024-11-20 23:07:06,198 - INFO - pnl: 2023-05-08T23:59:59.999 123692.44506846595 === 0.923%
2024-11-20 23:07:06,203 - DEBUG - cur time: 2023-05-09T23:59:59.999 == next bar open time: 2023-05-10T00:00:00.000 == close pos time: 2023-05-17T00:00:00.000
2024-11-20 23:07:06,205 - INFO - pnl: 2023-05-09T23:59:59.999 124590.28075629314 === 0.726%
2024-11-20 23:07:06,210 - DEBUG - cur time: 2023-05-10T23:59:59.999 == next bar open time: 2023-05-11T00:00:00.000 == close pos time: 2023-05-18T00:00:00.000
2024-11-20 23:07:06,213 - INFO - pnl: 2023-05-10T23:59:59.999 126654.59954532672 === 1.657%
2024-11-20 23:07:06,217 - DEBUG - cur time: 2023-05-11T23:59:59.999 == next bar open time: 2023-05-12T00:00:00.000 == close pos time: 2023-05-19T00:00:00.000
2024-11-20 23:07:06,219 - INFO - pnl: 2023-05-11T23:59:59.999 126306.54167484015 === -0.275%
2024-11-20 23:07:06,223 - DEBUG - cur time: 2023-05-12T23:59:59.999 == next bar open time: 2023-05-13T00:00:00.000 == close pos time: 2023-05-20T00:00:00.000
2024-11-20 23:07:06,226 - INFO - pnl: 2023-05-12T23:59:59.999 126862.49417548948 === 0.440%
2024-11-20 23:07:06,231 - DEBUG - cur time: 2023-05-13T23:59:59.999 == next bar open time: 2023-05-14T00:00:00.000 == close pos time: 2023-05-21T00:00:00.000
2024-11-20 23:07:06,234 - INFO - pnl: 2023-05-13T23:59:59.999 126335.26841368063 === -0.416%
2024-11-20 23:07:06,238 - DEBUG - cur time: 2023-05-14T23:59:59.999 == next bar open time: 2023-05-15T00:00:00.000 == close pos time: 2023-05-22T00:00:00.000
2024-11-20 23:07:06,240 - INFO - pnl: 2023-05-14T23:59:59.999 126254.27780064629 === -0.064%
2024-11-20 23:07:06,248 - DEBUG - cur time: 2023-05-15T23:59:59.999 == next bar open time: 2023-05-16T00:00:00.000 == close pos time: 2023-05-23T00:00:00.000
2024-11-20 23:07:06,258 - DEBUG - sorted_long_factors: shape: (141, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ZECUSDT      ┆ -1.791412    ┆ 0    ┆ 140          │
│ RLCUSDT      ┆ -1.751608    ┆ 1    ┆ 139          │
│ MTLUSDT      ┆ -1.739634    ┆ 2    ┆ 138          │
│ FETUSDT      ┆ -1.639779    ┆ 3    ┆ 137          │
│ FTMUSDT      ┆ -1.559004    ┆ 4    ┆ 136          │
│ APTUSDT      ┆ -1.522531    ┆ 5    ┆ 135          │
│ BTCDOMUSDT   ┆ -1.520241    ┆ 6    ┆ 134          │
│ BELUSDT      ┆ -1.496594    ┆ 7    ┆ 133          │
│ KSMUSDT      ┆ -1.451949    ┆ 8    ┆ 132          │
│ FILUSDT      ┆ -1.438836    ┆ 9    ┆ 131          │
│ …            ┆ …            ┆ …    ┆ …            │
│ 1000XECUSDT  ┆ 0.022658     ┆ 131  ┆ 9            │
│ DEFIUSDT     ┆ 0.106964     ┆ 132  ┆ 8            │
│ BLZUSDT      ┆ 0.145607     ┆ 133  ┆ 7            │
│ DGBUSDT      ┆ 0.155933     ┆ 134  ┆ 6            │
│ DUSKUSDT     ┆ 0.195747     ┆ 135  ┆ 5            │
│ FOOTBALLUSDT ┆ 0.231639     ┆ 136  ┆ 4            │
│ BAKEUSDT     ┆ 0.266592     ┆ 137  ┆ 3            │
│ DARUSDT      ┆ 0.308124     ┆ 138  ┆ 2            │
│ LPTUSDT      ┆ 0.314431     ┆ 139  ┆ 1            │
│ CVXUSDT      ┆ 0.48393      ┆ 140  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:06,268 - INFO - cur close time: 2023-05-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:06,268 - DEBUG - mean expected ret (mean factor): -0.7666986165616969
2024-11-20 23:07:06,274 - DEBUG - begin to update pos: =========
2024-11-20 23:07:06,274 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,274 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0897      ┆ null        ┆ … ┆ 0.0241  ┆ null   ┆ null    ┆ 0.2223  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,285 - DEBUG - update position: 2023-05-15T23:59:59.999 === diff_trading_value: 271240.3255658164 == cash: 127056.48647053784 
2024-11-20 23:07:06,287 - INFO - pnl: 2023-05-15T23:59:59.999 127056.48647053784 === 0.635%
2024-11-20 23:07:06,290 - DEBUG - cur time: 2023-05-16T23:59:59.999 == next bar open time: 2023-05-17T00:00:00.000 == close pos time: 2023-05-24T00:00:00.000
2024-11-20 23:07:06,292 - INFO - pnl: 2023-05-16T23:59:59.999 127963.77958911387 === 0.714%
2024-11-20 23:07:06,296 - DEBUG - cur time: 2023-05-17T23:59:59.999 == next bar open time: 2023-05-18T00:00:00.000 == close pos time: 2023-05-25T00:00:00.000
2024-11-20 23:07:06,297 - INFO - pnl: 2023-05-17T23:59:59.999 128300.71110972593 === 0.263%
2024-11-20 23:07:06,304 - DEBUG - cur time: 2023-05-18T23:59:59.999 == next bar open time: 2023-05-19T00:00:00.000 == close pos time: 2023-05-26T00:00:00.000
2024-11-20 23:07:06,306 - INFO - pnl: 2023-05-18T23:59:59.999 128389.79089912487 === 0.069%
2024-11-20 23:07:06,311 - DEBUG - cur time: 2023-05-19T23:59:59.999 == next bar open time: 2023-05-20T00:00:00.000 == close pos time: 2023-05-27T00:00:00.000
2024-11-20 23:07:06,314 - INFO - pnl: 2023-05-19T23:59:59.999 128372.87063376159 === -0.013%
2024-11-20 23:07:06,318 - DEBUG - cur time: 2023-05-20T23:59:59.999 == next bar open time: 2023-05-21T00:00:00.000 == close pos time: 2023-05-28T00:00:00.000
2024-11-20 23:07:06,320 - INFO - pnl: 2023-05-20T23:59:59.999 128599.2064441404 === 0.176%
2024-11-20 23:07:06,323 - DEBUG - cur time: 2023-05-21T23:59:59.999 == next bar open time: 2023-05-22T00:00:00.000 == close pos time: 2023-05-29T00:00:00.000
2024-11-20 23:07:06,325 - INFO - pnl: 2023-05-21T23:59:59.999 128333.76025537518 === -0.206%
2024-11-20 23:07:06,329 - DEBUG - cur time: 2023-05-22T23:59:59.999 == next bar open time: 2023-05-23T00:00:00.000 == close pos time: 2023-05-30T00:00:00.000
2024-11-20 23:07:06,338 - DEBUG - sorted_long_factors: shape: (143, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT   ┆ -1.735669    ┆ 0    ┆ 142          │
│ MKRUSDT   ┆ -1.664995    ┆ 1    ┆ 141          │
│ CRVUSDT   ┆ -1.628091    ┆ 2    ┆ 140          │
│ BELUSDT   ┆ -1.614903    ┆ 3    ┆ 139          │
│ ATOMUSDT  ┆ -1.552188    ┆ 4    ┆ 138          │
│ APTUSDT   ┆ -1.545677    ┆ 5    ┆ 137          │
│ AXSUSDT   ┆ -1.542018    ┆ 6    ┆ 136          │
│ HOOKUSDT  ┆ -1.504316    ┆ 7    ┆ 135          │
│ INJUSDT   ┆ -1.495804    ┆ 8    ┆ 134          │
│ FILUSDT   ┆ -1.469909    ┆ 9    ┆ 133          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CTKUSDT   ┆ -0.051453    ┆ 133  ┆ 9            │
│ DEFIUSDT  ┆ -0.017311    ┆ 134  ┆ 8            │
│ BAKEUSDT  ┆ 0.065343     ┆ 135  ┆ 7            │
│ SPELLUSDT ┆ 0.091267     ┆ 136  ┆ 6            │
│ API3USDT  ┆ 0.170301     ┆ 137  ┆ 5            │
│ GALUSDT   ┆ 0.207052     ┆ 138  ┆ 4            │
│ BLZUSDT   ┆ 0.271633     ┆ 139  ┆ 3            │
│ IOTXUSDT  ┆ 0.28642      ┆ 140  ┆ 2            │
│ ATAUSDT   ┆ 0.358299     ┆ 141  ┆ 1            │
│ LPTUSDT   ┆ 0.447754     ┆ 142  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:06,346 - INFO - cur close time: 2023-05-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:06,346 - DEBUG - mean expected ret (mean factor): -0.7888549008283423
2024-11-20 23:07:06,353 - DEBUG - begin to update pos: =========
2024-11-20 23:07:06,353 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,353 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0877      ┆ null        ┆ … ┆ 0.02345 ┆ null   ┆ null    ┆ 0.2203  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,361 - DEBUG - update position: 2023-05-22T23:59:59.999 === diff_trading_value: 211798.7125813185 == cash: 128792.88142848114 
2024-11-20 23:07:06,362 - INFO - pnl: 2023-05-22T23:59:59.999 128792.88142848114 === 0.358%
2024-11-20 23:07:06,366 - DEBUG - cur time: 2023-05-23T23:59:59.999 == next bar open time: 2023-05-24T00:00:00.000 == close pos time: 2023-05-31T00:00:00.000
2024-11-20 23:07:06,368 - INFO - pnl: 2023-05-23T23:59:59.999 129123.69135475566 === 0.257%
2024-11-20 23:07:06,374 - DEBUG - cur time: 2023-05-24T23:59:59.999 == next bar open time: 2023-05-25T00:00:00.000 == close pos time: 2023-06-01T00:00:00.000
2024-11-20 23:07:06,376 - INFO - pnl: 2023-05-24T23:59:59.999 128281.96858224488 === -0.652%
2024-11-20 23:07:06,380 - DEBUG - cur time: 2023-05-25T23:59:59.999 == next bar open time: 2023-05-26T00:00:00.000 == close pos time: 2023-06-02T00:00:00.000
2024-11-20 23:07:06,381 - INFO - pnl: 2023-05-25T23:59:59.999 127760.35786556477 === -0.407%
2024-11-20 23:07:06,385 - DEBUG - cur time: 2023-05-26T23:59:59.999 == next bar open time: 2023-05-27T00:00:00.000 == close pos time: 2023-06-03T00:00:00.000
2024-11-20 23:07:06,387 - INFO - pnl: 2023-05-26T23:59:59.999 128215.34809884906 === 0.356%
2024-11-20 23:07:06,390 - DEBUG - cur time: 2023-05-27T23:59:59.999 == next bar open time: 2023-05-28T00:00:00.000 == close pos time: 2023-06-04T00:00:00.000
2024-11-20 23:07:06,392 - INFO - pnl: 2023-05-27T23:59:59.999 126910.92888498452 === -1.017%
2024-11-20 23:07:06,395 - DEBUG - cur time: 2023-05-28T23:59:59.999 == next bar open time: 2023-05-29T00:00:00.000 == close pos time: 2023-06-05T00:00:00.000
2024-11-20 23:07:06,397 - INFO - pnl: 2023-05-28T23:59:59.999 126099.0227553095 === -0.640%
2024-11-20 23:07:06,400 - DEBUG - cur time: 2023-05-29T23:59:59.999 == next bar open time: 2023-05-30T00:00:00.000 == close pos time: 2023-06-06T00:00:00.000
2024-11-20 23:07:06,409 - DEBUG - sorted_long_factors: shape: (147, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ INJUSDT      ┆ -1.810446    ┆ 0    ┆ 146          │
│ CTSIUSDT     ┆ -1.758065    ┆ 1    ┆ 145          │
│ LITUSDT      ┆ -1.600441    ┆ 2    ┆ 144          │
│ MAGICUSDT    ┆ -1.576912    ┆ 3    ┆ 143          │
│ BELUSDT      ┆ -1.562775    ┆ 4    ┆ 142          │
│ FXSUSDT      ┆ -1.506854    ┆ 5    ┆ 141          │
│ HOOKUSDT     ┆ -1.460602    ┆ 6    ┆ 140          │
│ CRVUSDT      ┆ -1.457991    ┆ 7    ┆ 139          │
│ RNDRUSDT     ┆ -1.452898    ┆ 8    ┆ 138          │
│ NKNUSDT      ┆ -1.390679    ┆ 9    ┆ 137          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOTXUSDT     ┆ -0.074995    ┆ 137  ┆ 9            │
│ BLZUSDT      ┆ -0.055634    ┆ 138  ┆ 8            │
│ ZECUSDT      ┆ -0.049084    ┆ 139  ┆ 7            │
│ SPELLUSDT    ┆ 0.019006     ┆ 140  ┆ 6            │
│ ATAUSDT      ┆ 0.021802     ┆ 141  ┆ 5            │
│ GALUSDT      ┆ 0.061361     ┆ 142  ┆ 4            │
│ RVNUSDT      ┆ 0.09609      ┆ 143  ┆ 3            │
│ CVXUSDT      ┆ 0.227726     ┆ 144  ┆ 2            │
│ DEFIUSDT     ┆ 0.608665     ┆ 145  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.697303     ┆ 146  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:06,416 - WARNING - 2023-05-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:06,416 - INFO - cur close time: 2023-05-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:06,416 - DEBUG - mean expected ret (mean factor): -0.7772675352574082
2024-11-20 23:07:06,421 - DEBUG - begin to update pos: =========
2024-11-20 23:07:06,421 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,421 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0869      ┆ null        ┆ … ┆ 0.02358 ┆ null   ┆ null    ┆ 0.2256  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,429 - DEBUG - update position: 2023-05-29T23:59:59.999 === diff_trading_value: 237788.71281245473 == cash: 124029.17514892019 
2024-11-20 23:07:06,431 - INFO - pnl: 2023-05-29T23:59:59.999 124029.17514892019 === -1.641%
2024-11-20 23:07:06,435 - DEBUG - cur time: 2023-05-30T23:59:59.999 == next bar open time: 2023-05-31T00:00:00.000 == close pos time: 2023-06-07T00:00:00.000
2024-11-20 23:07:06,437 - INFO - pnl: 2023-05-30T23:59:59.999 123920.9877751735 === -0.087%
2024-11-20 23:07:06,441 - DEBUG - cur time: 2023-05-31T23:59:59.999 == next bar open time: 2023-06-01T00:00:00.000 == close pos time: 2023-06-08T00:00:00.000
2024-11-20 23:07:06,443 - INFO - pnl: 2023-05-31T23:59:59.999 124689.77081768647 === 0.620%
2024-11-20 23:07:06,447 - DEBUG - cur time: 2023-06-01T23:59:59.999 == next bar open time: 2023-06-02T00:00:00.000 == close pos time: 2023-06-09T00:00:00.000
2024-11-20 23:07:06,448 - INFO - pnl: 2023-06-01T23:59:59.999 123888.91388780947 === -0.642%
2024-11-20 23:07:06,453 - DEBUG - cur time: 2023-06-02T23:59:59.999 == next bar open time: 2023-06-03T00:00:00.000 == close pos time: 2023-06-10T00:00:00.000
2024-11-20 23:07:06,455 - INFO - pnl: 2023-06-02T23:59:59.999 121004.18043729736 === -2.328%
2024-11-20 23:07:06,459 - DEBUG - cur time: 2023-06-03T23:59:59.999 == next bar open time: 2023-06-04T00:00:00.000 == close pos time: 2023-06-11T00:00:00.000
2024-11-20 23:07:06,461 - INFO - pnl: 2023-06-03T23:59:59.999 121547.55910598916 === 0.449%
2024-11-20 23:07:06,467 - DEBUG - cur time: 2023-06-04T23:59:59.999 == next bar open time: 2023-06-05T00:00:00.000 == close pos time: 2023-06-12T00:00:00.000
2024-11-20 23:07:06,469 - INFO - pnl: 2023-06-04T23:59:59.999 122467.85400885365 === 0.757%
2024-11-20 23:07:06,474 - DEBUG - cur time: 2023-06-05T23:59:59.999 == next bar open time: 2023-06-06T00:00:00.000 == close pos time: 2023-06-13T00:00:00.000
2024-11-20 23:07:06,483 - DEBUG - sorted_long_factors: shape: (152, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MKRUSDT      ┆ -1.765592    ┆ 0    ┆ 151          │
│ HIGHUSDT     ┆ -1.725351    ┆ 1    ┆ 150          │
│ KSMUSDT      ┆ -1.675236    ┆ 2    ┆ 149          │
│ APTUSDT      ┆ -1.608048    ┆ 3    ┆ 148          │
│ BNXUSDT      ┆ -1.52262     ┆ 4    ┆ 147          │
│ STXUSDT      ┆ -1.473384    ┆ 5    ┆ 146          │
│ RNDRUSDT     ┆ -1.446713    ┆ 6    ┆ 145          │
│ AGIXUSDT     ┆ -1.43632     ┆ 7    ┆ 144          │
│ MANAUSDT     ┆ -1.392708    ┆ 8    ┆ 143          │
│ SSVUSDT      ┆ -1.355619    ┆ 9    ┆ 142          │
│ …            ┆ …            ┆ …    ┆ …            │
│ LRCUSDT      ┆ -0.182358    ┆ 142  ┆ 9            │
│ COMPUSDT     ┆ -0.146782    ┆ 143  ┆ 8            │
│ LPTUSDT      ┆ -0.120269    ┆ 144  ┆ 7            │
│ ARUSDT       ┆ -0.118008    ┆ 145  ┆ 6            │
│ ATAUSDT      ┆ -0.113024    ┆ 146  ┆ 5            │
│ BAKEUSDT     ┆ -0.063829    ┆ 147  ┆ 4            │
│ ZENUSDT      ┆ 0.174958     ┆ 148  ┆ 3            │
│ CVXUSDT      ┆ 0.200658     ┆ 149  ┆ 2            │
│ DEFIUSDT     ┆ 1.271857     ┆ 150  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.272972     ┆ 151  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:06,490 - WARNING - 2023-06-05T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:06,490 - INFO - cur close time: 2023-06-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:06,491 - DEBUG - mean expected ret (mean factor): -0.7980933607799207
2024-11-20 23:07:06,495 - DEBUG - begin to update pos: =========
2024-11-20 23:07:06,495 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,495 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09179     ┆ null        ┆ … ┆ 0.02131 ┆ null   ┆ null    ┆ 0.2045  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,505 - DEBUG - update position: 2023-06-05T23:59:59.999 === diff_trading_value: 271859.1747094257 == cash: 125105.24869691717 
2024-11-20 23:07:06,508 - INFO - pnl: 2023-06-05T23:59:59.999 125105.24869691717 === 2.154%
2024-11-20 23:07:06,517 - DEBUG - cur time: 2023-06-06T23:59:59.999 == next bar open time: 2023-06-07T00:00:00.000 == close pos time: 2023-06-14T00:00:00.000
2024-11-20 23:07:06,521 - INFO - pnl: 2023-06-06T23:59:59.999 125503.87977824041 === 0.319%
2024-11-20 23:07:06,529 - DEBUG - cur time: 2023-06-07T23:59:59.999 == next bar open time: 2023-06-08T00:00:00.000 == close pos time: 2023-06-15T00:00:00.000
2024-11-20 23:07:06,532 - INFO - pnl: 2023-06-07T23:59:59.999 125756.76526751928 === 0.201%
2024-11-20 23:07:06,538 - DEBUG - cur time: 2023-06-08T23:59:59.999 == next bar open time: 2023-06-09T00:00:00.000 == close pos time: 2023-06-16T00:00:00.000
2024-11-20 23:07:06,541 - INFO - pnl: 2023-06-08T23:59:59.999 126478.36076237669 === 0.574%
2024-11-20 23:07:06,548 - DEBUG - cur time: 2023-06-09T23:59:59.999 == next bar open time: 2023-06-10T00:00:00.000 == close pos time: 2023-06-17T00:00:00.000
2024-11-20 23:07:06,551 - INFO - pnl: 2023-06-09T23:59:59.999 126979.83414826046 === 0.396%
2024-11-20 23:07:06,559 - DEBUG - cur time: 2023-06-10T23:59:59.999 == next bar open time: 2023-06-11T00:00:00.000 == close pos time: 2023-06-18T00:00:00.000
2024-11-20 23:07:06,563 - INFO - pnl: 2023-06-10T23:59:59.999 127712.7733567037 === 0.577%
2024-11-20 23:07:06,571 - DEBUG - cur time: 2023-06-11T23:59:59.999 == next bar open time: 2023-06-12T00:00:00.000 == close pos time: 2023-06-19T00:00:00.000
2024-11-20 23:07:06,574 - INFO - pnl: 2023-06-11T23:59:59.999 127992.05836074568 === 0.219%
2024-11-20 23:07:06,584 - DEBUG - cur time: 2023-06-12T23:59:59.999 == next bar open time: 2023-06-13T00:00:00.000 == close pos time: 2023-06-20T00:00:00.000
2024-11-20 23:07:06,601 - DEBUG - sorted_long_factors: shape: (153, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MTLUSDT      ┆ -2.00615     ┆ 0    ┆ 152          │
│ TOMOUSDT     ┆ -1.853147    ┆ 1    ┆ 151          │
│ HIGHUSDT     ┆ -1.752251    ┆ 2    ┆ 150          │
│ RNDRUSDT     ┆ -1.551411    ┆ 3    ┆ 149          │
│ CFXUSDT      ┆ -1.545626    ┆ 4    ┆ 148          │
│ KAVAUSDT     ┆ -1.517554    ┆ 5    ┆ 147          │
│ DYDXUSDT     ┆ -1.503656    ┆ 6    ┆ 146          │
│ LUNA2USDT    ┆ -1.486271    ┆ 7    ┆ 145          │
│ BTCDOMUSDT   ┆ -1.47291     ┆ 8    ┆ 144          │
│ XRPUSDT      ┆ -1.456735    ┆ 9    ┆ 143          │
│ …            ┆ …            ┆ …    ┆ …            │
│ QNTUSDT      ┆ -0.070947    ┆ 143  ┆ 9            │
│ GTCUSDT      ┆ -0.062965    ┆ 144  ┆ 8            │
│ GALUSDT      ┆ -0.029252    ┆ 145  ┆ 7            │
│ 1000XECUSDT  ┆ -0.013996    ┆ 146  ┆ 6            │
│ FLMUSDT      ┆ -0.001535    ┆ 147  ┆ 5            │
│ ZENUSDT      ┆ 0.001537     ┆ 148  ┆ 4            │
│ ATAUSDT      ┆ 0.16464      ┆ 149  ┆ 3            │
│ CVXUSDT      ┆ 0.34062      ┆ 150  ┆ 2            │
│ DEFIUSDT     ┆ 0.704886     ┆ 151  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.887086     ┆ 152  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:06,614 - WARNING - 2023-06-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:06,615 - INFO - cur close time: 2023-06-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:06,615 - DEBUG - mean expected ret (mean factor): -0.7990433409455486
2024-11-20 23:07:06,624 - DEBUG - begin to update pos: =========
2024-11-20 23:07:06,625 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,625 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08876     ┆ null        ┆ … ┆ 0.01739 ┆ null   ┆ null    ┆ 0.1719  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,639 - DEBUG - update position: 2023-06-12T23:59:59.999 === diff_trading_value: 265529.086618707 == cash: 128729.72707303904 
2024-11-20 23:07:06,641 - INFO - pnl: 2023-06-12T23:59:59.999 128729.72707303904 === 0.576%
2024-11-20 23:07:06,646 - DEBUG - cur time: 2023-06-13T23:59:59.999 == next bar open time: 2023-06-14T00:00:00.000 == close pos time: 2023-06-21T00:00:00.000
2024-11-20 23:07:06,648 - INFO - pnl: 2023-06-13T23:59:59.999 130008.64243202463 === 0.993%
2024-11-20 23:07:06,654 - DEBUG - cur time: 2023-06-14T23:59:59.999 == next bar open time: 2023-06-15T00:00:00.000 == close pos time: 2023-06-22T00:00:00.000
2024-11-20 23:07:06,656 - INFO - pnl: 2023-06-14T23:59:59.999 129120.38764931442 === -0.683%
2024-11-20 23:07:06,661 - DEBUG - cur time: 2023-06-15T23:59:59.999 == next bar open time: 2023-06-16T00:00:00.000 == close pos time: 2023-06-23T00:00:00.000
2024-11-20 23:07:06,663 - INFO - pnl: 2023-06-15T23:59:59.999 128730.78785479214 === -0.302%
2024-11-20 23:07:06,668 - DEBUG - cur time: 2023-06-16T23:59:59.999 == next bar open time: 2023-06-17T00:00:00.000 == close pos time: 2023-06-24T00:00:00.000
2024-11-20 23:07:06,670 - INFO - pnl: 2023-06-16T23:59:59.999 129179.45904403609 === 0.349%
2024-11-20 23:07:06,675 - DEBUG - cur time: 2023-06-17T23:59:59.999 == next bar open time: 2023-06-18T00:00:00.000 == close pos time: 2023-06-25T00:00:00.000
2024-11-20 23:07:06,678 - INFO - pnl: 2023-06-17T23:59:59.999 129460.51941633831 === 0.218%
2024-11-20 23:07:06,682 - DEBUG - cur time: 2023-06-18T23:59:59.999 == next bar open time: 2023-06-19T00:00:00.000 == close pos time: 2023-06-26T00:00:00.000
2024-11-20 23:07:06,684 - INFO - pnl: 2023-06-18T23:59:59.999 130777.06030260792 === 1.017%
2024-11-20 23:07:06,688 - DEBUG - cur time: 2023-06-19T23:59:59.999 == next bar open time: 2023-06-20T00:00:00.000 == close pos time: 2023-06-27T00:00:00.000
2024-11-20 23:07:06,703 - DEBUG - sorted_long_factors: shape: (156, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ RNDRUSDT    ┆ -1.751919    ┆ 0    ┆ 155          │
│ MASKUSDT    ┆ -1.665438    ┆ 1    ┆ 154          │
│ MAGICUSDT   ┆ -1.659991    ┆ 2    ┆ 153          │
│ HIGHUSDT    ┆ -1.658236    ┆ 3    ┆ 152          │
│ CFXUSDT     ┆ -1.626054    ┆ 4    ┆ 151          │
│ HOOKUSDT    ┆ -1.611703    ┆ 5    ┆ 150          │
│ OPUSDT      ┆ -1.583183    ┆ 6    ┆ 149          │
│ EOSUSDT     ┆ -1.567205    ┆ 7    ┆ 148          │
│ AXSUSDT     ┆ -1.563257    ┆ 8    ┆ 147          │
│ DASHUSDT    ┆ -1.546271    ┆ 9    ┆ 146          │
│ …           ┆ …            ┆ …    ┆ …            │
│ FLMUSDT     ┆ -0.020488    ┆ 146  ┆ 9            │
│ ONEUSDT     ┆ -0.008748    ┆ 147  ┆ 8            │
│ RSRUSDT     ┆ 0.013465     ┆ 148  ┆ 7            │
│ SPELLUSDT   ┆ 0.105974     ┆ 149  ┆ 6            │
│ BTCDOMUSDT  ┆ 0.1081       ┆ 150  ┆ 5            │
│ REEFUSDT    ┆ 0.135588     ┆ 151  ┆ 4            │
│ CVXUSDT     ┆ 0.18767      ┆ 152  ┆ 3            │
│ 1000XECUSDT ┆ 0.189765     ┆ 153  ┆ 2            │
│ DGBUSDT     ┆ 0.37969      ┆ 154  ┆ 1            │
│ ATAUSDT     ┆ 0.401831     ┆ 155  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:06,710 - INFO - cur close time: 2023-06-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:06,711 - DEBUG - mean expected ret (mean factor): -0.8172762453398882
2024-11-20 23:07:06,717 - DEBUG - begin to update pos: =========
2024-11-20 23:07:06,717 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,718 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09012     ┆ null        ┆ … ┆ 0.01735 ┆ null   ┆ null    ┆ 0.178   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,726 - DEBUG - update position: 2023-06-19T23:59:59.999 === diff_trading_value: 252011.27276899148 == cash: 130937.9402743351 
2024-11-20 23:07:06,727 - INFO - pnl: 2023-06-19T23:59:59.999 130937.9402743351 === 0.123%
2024-11-20 23:07:06,731 - DEBUG - cur time: 2023-06-20T23:59:59.999 == next bar open time: 2023-06-21T00:00:00.000 == close pos time: 2023-06-28T00:00:00.000
2024-11-20 23:07:06,734 - INFO - pnl: 2023-06-20T23:59:59.999 128407.365011559 === -1.933%
2024-11-20 23:07:06,740 - DEBUG - cur time: 2023-06-21T23:59:59.999 == next bar open time: 2023-06-22T00:00:00.000 == close pos time: 2023-06-29T00:00:00.000
2024-11-20 23:07:06,743 - INFO - pnl: 2023-06-21T23:59:59.999 128985.36143134128 === 0.450%
2024-11-20 23:07:06,747 - DEBUG - cur time: 2023-06-22T23:59:59.999 == next bar open time: 2023-06-23T00:00:00.000 == close pos time: 2023-06-30T00:00:00.000
2024-11-20 23:07:06,750 - INFO - pnl: 2023-06-22T23:59:59.999 128600.69614928603 === -0.298%
2024-11-20 23:07:06,755 - DEBUG - cur time: 2023-06-23T23:59:59.999 == next bar open time: 2023-06-24T00:00:00.000 == close pos time: 2023-07-01T00:00:00.000
2024-11-20 23:07:06,757 - INFO - pnl: 2023-06-23T23:59:59.999 129762.95673919213 === 0.904%
2024-11-20 23:07:06,761 - DEBUG - cur time: 2023-06-24T23:59:59.999 == next bar open time: 2023-06-25T00:00:00.000 == close pos time: 2023-07-02T00:00:00.000
2024-11-20 23:07:06,763 - INFO - pnl: 2023-06-24T23:59:59.999 132084.65171159146 === 1.789%
2024-11-20 23:07:06,766 - DEBUG - cur time: 2023-06-25T23:59:59.999 == next bar open time: 2023-06-26T00:00:00.000 == close pos time: 2023-07-03T00:00:00.000
2024-11-20 23:07:06,770 - INFO - pnl: 2023-06-25T23:59:59.999 132615.40435479916 === 0.402%
2024-11-20 23:07:06,775 - DEBUG - cur time: 2023-06-26T23:59:59.999 == next bar open time: 2023-06-27T00:00:00.000 == close pos time: 2023-07-04T00:00:00.000
2024-11-20 23:07:06,788 - DEBUG - sorted_long_factors: shape: (157, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -1.763952    ┆ 0    ┆ 156          │
│ RNDRUSDT     ┆ -1.586733    ┆ 1    ┆ 155          │
│ BNBUSDT      ┆ -1.582283    ┆ 2    ┆ 154          │
│ AGIXUSDT     ┆ -1.574077    ┆ 3    ┆ 153          │
│ FILUSDT      ┆ -1.533819    ┆ 4    ┆ 152          │
│ NEARUSDT     ┆ -1.502201    ┆ 5    ┆ 151          │
│ MAGICUSDT    ┆ -1.498935    ┆ 6    ┆ 150          │
│ FETUSDT      ┆ -1.426124    ┆ 7    ┆ 149          │
│ MINAUSDT     ┆ -1.425541    ┆ 8    ┆ 148          │
│ DYDXUSDT     ┆ -1.415979    ┆ 9    ┆ 147          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ATAUSDT      ┆ -0.173664    ┆ 147  ┆ 9            │
│ REEFUSDT     ┆ -0.173036    ┆ 148  ┆ 8            │
│ GTCUSDT      ┆ -0.166449    ┆ 149  ┆ 7            │
│ IOTXUSDT     ┆ -0.023348    ┆ 150  ┆ 6            │
│ DGBUSDT      ┆ -0.009795    ┆ 151  ┆ 5            │
│ IOSTUSDT     ┆ -0.00975     ┆ 152  ┆ 4            │
│ DARUSDT      ┆ 0.237645     ┆ 153  ┆ 3            │
│ CTKUSDT      ┆ 0.262886     ┆ 154  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.465204     ┆ 155  ┆ 1            │
│ DEFIUSDT     ┆ 0.4657       ┆ 156  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:06,798 - WARNING - 2023-06-26T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:06,798 - INFO - cur close time: 2023-06-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:06,798 - DEBUG - mean expected ret (mean factor): -0.814680461362212
2024-11-20 23:07:06,803 - DEBUG - begin to update pos: =========
2024-11-20 23:07:06,804 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,804 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09221     ┆ null        ┆ … ┆ 0.02036 ┆ null   ┆ null    ┆ 0.213   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,812 - DEBUG - update position: 2023-06-26T23:59:59.999 === diff_trading_value: 284576.13568646356 == cash: 130522.06381192971 
2024-11-20 23:07:06,814 - INFO - pnl: 2023-06-26T23:59:59.999 130522.06381192971 === -1.579%
2024-11-20 23:07:06,819 - DEBUG - cur time: 2023-06-27T23:59:59.999 == next bar open time: 2023-06-28T00:00:00.000 == close pos time: 2023-07-05T00:00:00.000
2024-11-20 23:07:06,821 - INFO - pnl: 2023-06-27T23:59:59.999 129790.88578847672 === -0.560%
2024-11-20 23:07:06,827 - DEBUG - cur time: 2023-06-28T23:59:59.999 == next bar open time: 2023-06-29T00:00:00.000 == close pos time: 2023-07-06T00:00:00.000
2024-11-20 23:07:06,830 - INFO - pnl: 2023-06-28T23:59:59.999 130221.880083806 === 0.332%
2024-11-20 23:07:06,835 - DEBUG - cur time: 2023-06-29T23:59:59.999 == next bar open time: 2023-06-30T00:00:00.000 == close pos time: 2023-07-07T00:00:00.000
2024-11-20 23:07:06,839 - INFO - pnl: 2023-06-29T23:59:59.999 130042.50677813112 === -0.138%
2024-11-20 23:07:06,845 - DEBUG - cur time: 2023-06-30T23:59:59.999 == next bar open time: 2023-07-01T00:00:00.000 == close pos time: 2023-07-08T00:00:00.000
2024-11-20 23:07:06,847 - INFO - pnl: 2023-06-30T23:59:59.999 136219.5200369401 === 4.750%
2024-11-20 23:07:06,852 - DEBUG - cur time: 2023-07-01T23:59:59.999 == next bar open time: 2023-07-02T00:00:00.000 == close pos time: 2023-07-09T00:00:00.000
2024-11-20 23:07:06,854 - INFO - pnl: 2023-07-01T23:59:59.999 133918.48998035415 === -1.689%
2024-11-20 23:07:06,859 - DEBUG - cur time: 2023-07-02T23:59:59.999 == next bar open time: 2023-07-03T00:00:00.000 == close pos time: 2023-07-10T00:00:00.000
2024-11-20 23:07:06,861 - INFO - pnl: 2023-07-02T23:59:59.999 134895.35145425337 === 0.729%
2024-11-20 23:07:06,867 - DEBUG - cur time: 2023-07-03T23:59:59.999 == next bar open time: 2023-07-04T00:00:00.000 == close pos time: 2023-07-11T00:00:00.000
2024-11-20 23:07:06,876 - DEBUG - sorted_long_factors: shape: (159, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MAGICUSDT    ┆ -1.829677    ┆ 0    ┆ 158          │
│ HOOKUSDT     ┆ -1.816298    ┆ 1    ┆ 157          │
│ ARBUSDT      ┆ -1.795714    ┆ 2    ┆ 156          │
│ AXSUSDT      ┆ -1.630316    ┆ 3    ┆ 155          │
│ AAVEUSDT     ┆ -1.611984    ┆ 4    ┆ 154          │
│ APEUSDT      ┆ -1.595435    ┆ 5    ┆ 153          │
│ YFIUSDT      ┆ -1.548249    ┆ 6    ┆ 152          │
│ CFXUSDT      ┆ -1.518647    ┆ 7    ┆ 151          │
│ SSVUSDT      ┆ -1.516093    ┆ 8    ┆ 150          │
│ MASKUSDT     ┆ -1.472158    ┆ 9    ┆ 149          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ -0.039275    ┆ 149  ┆ 9            │
│ API3USDT     ┆ 0.000533     ┆ 150  ┆ 8            │
│ ATAUSDT      ┆ 0.004599     ┆ 151  ┆ 7            │
│ SPELLUSDT    ┆ 0.028452     ┆ 152  ┆ 6            │
│ PERPUSDT     ┆ 0.109281     ┆ 153  ┆ 5            │
│ IOTXUSDT     ┆ 0.252089     ┆ 154  ┆ 4            │
│ DARUSDT      ┆ 0.341395     ┆ 155  ┆ 3            │
│ CTKUSDT      ┆ 0.483755     ┆ 156  ┆ 2            │
│ DEFIUSDT     ┆ 0.618087     ┆ 157  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.048398     ┆ 158  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:06,885 - WARNING - 2023-07-03T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:06,885 - INFO - cur close time: 2023-07-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:06,885 - DEBUG - mean expected ret (mean factor): -0.8264394211248969
2024-11-20 23:07:06,890 - DEBUG - begin to update pos: =========
2024-11-20 23:07:06,890 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,891 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08793     ┆ null        ┆ … ┆ 0.02214 ┆ null   ┆ null    ┆ 0.2183  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,899 - DEBUG - update position: 2023-07-03T23:59:59.999 === diff_trading_value: 236879.39334899 == cash: 134070.41499897363 
2024-11-20 23:07:06,901 - INFO - pnl: 2023-07-03T23:59:59.999 134070.41499897363 === -0.612%
2024-11-20 23:07:06,906 - DEBUG - cur time: 2023-07-04T23:59:59.999 == next bar open time: 2023-07-05T00:00:00.000 == close pos time: 2023-07-12T00:00:00.000
2024-11-20 23:07:06,908 - INFO - pnl: 2023-07-04T23:59:59.999 135219.0013577268 === 0.857%
2024-11-20 23:07:06,913 - DEBUG - cur time: 2023-07-05T23:59:59.999 == next bar open time: 2023-07-06T00:00:00.000 == close pos time: 2023-07-13T00:00:00.000
2024-11-20 23:07:06,916 - INFO - pnl: 2023-07-05T23:59:59.999 134454.15602409025 === -0.566%
2024-11-20 23:07:06,924 - DEBUG - cur time: 2023-07-06T23:59:59.999 == next bar open time: 2023-07-07T00:00:00.000 == close pos time: 2023-07-14T00:00:00.000
2024-11-20 23:07:06,927 - INFO - pnl: 2023-07-06T23:59:59.999 135403.14911408682 === 0.706%
2024-11-20 23:07:06,936 - DEBUG - cur time: 2023-07-07T23:59:59.999 == next bar open time: 2023-07-08T00:00:00.000 == close pos time: 2023-07-15T00:00:00.000
2024-11-20 23:07:06,938 - INFO - pnl: 2023-07-07T23:59:59.999 134099.55239257673 === -0.963%
2024-11-20 23:07:06,945 - DEBUG - cur time: 2023-07-08T23:59:59.999 == next bar open time: 2023-07-09T00:00:00.000 == close pos time: 2023-07-16T00:00:00.000
2024-11-20 23:07:06,947 - INFO - pnl: 2023-07-08T23:59:59.999 132884.2048291696 === -0.906%
2024-11-20 23:07:06,951 - DEBUG - cur time: 2023-07-09T23:59:59.999 == next bar open time: 2023-07-10T00:00:00.000 == close pos time: 2023-07-17T00:00:00.000
2024-11-20 23:07:06,954 - INFO - pnl: 2023-07-09T23:59:59.999 132791.5497467634 === -0.070%
2024-11-20 23:07:06,958 - DEBUG - cur time: 2023-07-10T23:59:59.999 == next bar open time: 2023-07-11T00:00:00.000 == close pos time: 2023-07-18T00:00:00.000
2024-11-20 23:07:06,969 - DEBUG - sorted_long_factors: shape: (163, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -1.836607    ┆ 0    ┆ 162          │
│ SSVUSDT      ┆ -1.652289    ┆ 1    ┆ 161          │
│ MTLUSDT      ┆ -1.622196    ┆ 2    ┆ 160          │
│ HOOKUSDT     ┆ -1.599837    ┆ 3    ┆ 159          │
│ RNDRUSDT     ┆ -1.581154    ┆ 4    ┆ 158          │
│ STXUSDT      ┆ -1.581114    ┆ 5    ┆ 157          │
│ WAVESUSDT    ┆ -1.532762    ┆ 6    ┆ 156          │
│ ARUSDT       ┆ -1.484821    ┆ 7    ┆ 155          │
│ QTUMUSDT     ┆ -1.478161    ┆ 8    ┆ 154          │
│ YFIUSDT      ┆ -1.457448    ┆ 9    ┆ 153          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CKBUSDT      ┆ 0.019446     ┆ 153  ┆ 9            │
│ IOTXUSDT     ┆ 0.085138     ┆ 154  ┆ 8            │
│ DEFIUSDT     ┆ 0.13728      ┆ 155  ┆ 7            │
│ LEVERUSDT    ┆ 0.145908     ┆ 156  ┆ 6            │
│ BAKEUSDT     ┆ 0.146505     ┆ 157  ┆ 5            │
│ PERPUSDT     ┆ 0.187514     ┆ 158  ┆ 4            │
│ CHRUSDT      ┆ 0.335867     ┆ 159  ┆ 3            │
│ GTCUSDT      ┆ 0.462805     ┆ 160  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.763163     ┆ 161  ┆ 1            │
│ CTKUSDT      ┆ 0.918681     ┆ 162  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:06,979 - WARNING - 2023-07-10T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:06,979 - INFO - cur close time: 2023-07-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:06,979 - DEBUG - mean expected ret (mean factor): -0.8150567715296401
2024-11-20 23:07:06,986 - DEBUG - begin to update pos: =========
2024-11-20 23:07:06,986 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,986 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08308     ┆ null        ┆ … ┆ 0.02026 ┆ null   ┆ null    ┆ 0.2035  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:06,994 - DEBUG - update position: 2023-07-10T23:59:59.999 === diff_trading_value: 184045.14744494233 == cash: 134133.14691265833 
2024-11-20 23:07:06,996 - INFO - pnl: 2023-07-10T23:59:59.999 134133.14691265833 === 1.010%
2024-11-20 23:07:07,000 - DEBUG - cur time: 2023-07-11T23:59:59.999 == next bar open time: 2023-07-12T00:00:00.000 == close pos time: 2023-07-19T00:00:00.000
2024-11-20 23:07:07,001 - INFO - pnl: 2023-07-11T23:59:59.999 134294.47883211737 === 0.120%
2024-11-20 23:07:07,004 - DEBUG - cur time: 2023-07-12T23:59:59.999 == next bar open time: 2023-07-13T00:00:00.000 == close pos time: 2023-07-20T00:00:00.000
2024-11-20 23:07:07,006 - INFO - pnl: 2023-07-12T23:59:59.999 135157.4411797007 === 0.643%
2024-11-20 23:07:07,009 - DEBUG - cur time: 2023-07-13T23:59:59.999 == next bar open time: 2023-07-14T00:00:00.000 == close pos time: 2023-07-21T00:00:00.000
2024-11-20 23:07:07,011 - INFO - pnl: 2023-07-13T23:59:59.999 138514.01818948778 === 2.483%
2024-11-20 23:07:07,016 - DEBUG - cur time: 2023-07-14T23:59:59.999 == next bar open time: 2023-07-15T00:00:00.000 == close pos time: 2023-07-22T00:00:00.000
2024-11-20 23:07:07,018 - INFO - pnl: 2023-07-14T23:59:59.999 140105.5636012946 === 1.149%
2024-11-20 23:07:07,021 - DEBUG - cur time: 2023-07-15T23:59:59.999 == next bar open time: 2023-07-16T00:00:00.000 == close pos time: 2023-07-23T00:00:00.000
2024-11-20 23:07:07,023 - INFO - pnl: 2023-07-15T23:59:59.999 139596.50608336928 === -0.363%
2024-11-20 23:07:07,026 - DEBUG - cur time: 2023-07-16T23:59:59.999 == next bar open time: 2023-07-17T00:00:00.000 == close pos time: 2023-07-24T00:00:00.000
2024-11-20 23:07:07,028 - INFO - pnl: 2023-07-16T23:59:59.999 139119.86978066812 === -0.341%
2024-11-20 23:07:07,031 - DEBUG - cur time: 2023-07-17T23:59:59.999 == next bar open time: 2023-07-18T00:00:00.000 == close pos time: 2023-07-25T00:00:00.000
2024-11-20 23:07:07,043 - DEBUG - sorted_long_factors: shape: (165, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ARBUSDT      ┆ -1.881788    ┆ 0    ┆ 164          │
│ STXUSDT      ┆ -1.868954    ┆ 1    ┆ 163          │
│ LQTYUSDT     ┆ -1.832106    ┆ 2    ┆ 162          │
│ SSVUSDT      ┆ -1.802353    ┆ 3    ┆ 161          │
│ WAVESUSDT    ┆ -1.629977    ┆ 4    ┆ 160          │
│ RNDRUSDT     ┆ -1.588227    ┆ 5    ┆ 159          │
│ YFIUSDT      ┆ -1.576734    ┆ 6    ┆ 158          │
│ APTUSDT      ┆ -1.568056    ┆ 7    ┆ 157          │
│ ZRXUSDT      ┆ -1.513937    ┆ 8    ┆ 156          │
│ ICXUSDT      ┆ -1.507165    ┆ 9    ┆ 155          │
│ …            ┆ …            ┆ …    ┆ …            │
│ GTCUSDT      ┆ 0.18408      ┆ 155  ┆ 9            │
│ DARUSDT      ┆ 0.202333     ┆ 156  ┆ 8            │
│ CHRUSDT      ┆ 0.218797     ┆ 157  ┆ 7            │
│ LPTUSDT      ┆ 0.255763     ┆ 158  ┆ 6            │
│ CTKUSDT      ┆ 0.285758     ┆ 159  ┆ 5            │
│ TLMUSDT      ┆ 0.285805     ┆ 160  ┆ 4            │
│ REEFUSDT     ┆ 0.318795     ┆ 161  ┆ 3            │
│ OGNUSDT      ┆ 0.403231     ┆ 162  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.500087     ┆ 163  ┆ 1            │
│ IOTXUSDT     ┆ 0.591408     ┆ 164  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:07,052 - INFO - cur close time: 2023-07-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:07,052 - DEBUG - mean expected ret (mean factor): -0.8207898294108873
2024-11-20 23:07:07,057 - DEBUG - begin to update pos: =========
2024-11-20 23:07:07,058 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬─────────┬──────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT  │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---      │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64      │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆         ┆          │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪═════════╪══════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ -10000.0 │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴─────────┴──────────┘
2024-11-20 23:07:07,058 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0916      ┆ null        ┆ … ┆ 0.02236 ┆ null   ┆ null    ┆ 0.2222  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,064 - DEBUG - update position: 2023-07-17T23:59:59.999 === diff_trading_value: 135844.11394443174 == cash: 139379.17852645594 
2024-11-20 23:07:07,066 - INFO - pnl: 2023-07-17T23:59:59.999 139379.17852645594 === 0.186%
2024-11-20 23:07:07,070 - DEBUG - cur time: 2023-07-18T23:59:59.999 == next bar open time: 2023-07-19T00:00:00.000 == close pos time: 2023-07-26T00:00:00.000
2024-11-20 23:07:07,072 - INFO - pnl: 2023-07-18T23:59:59.999 139538.69320389637 === 0.114%
2024-11-20 23:07:07,075 - DEBUG - cur time: 2023-07-19T23:59:59.999 == next bar open time: 2023-07-20T00:00:00.000 == close pos time: 2023-07-27T00:00:00.000
2024-11-20 23:07:07,077 - INFO - pnl: 2023-07-19T23:59:59.999 139725.21567796796 === 0.134%
2024-11-20 23:07:07,081 - DEBUG - cur time: 2023-07-20T23:59:59.999 == next bar open time: 2023-07-21T00:00:00.000 == close pos time: 2023-07-28T00:00:00.000
2024-11-20 23:07:07,084 - INFO - pnl: 2023-07-20T23:59:59.999 141635.7619702947 === 1.367%
2024-11-20 23:07:07,088 - DEBUG - cur time: 2023-07-21T23:59:59.999 == next bar open time: 2023-07-22T00:00:00.000 == close pos time: 2023-07-29T00:00:00.000
2024-11-20 23:07:07,092 - INFO - pnl: 2023-07-21T23:59:59.999 141171.80745051318 === -0.328%
2024-11-20 23:07:07,096 - DEBUG - cur time: 2023-07-22T23:59:59.999 == next bar open time: 2023-07-23T00:00:00.000 == close pos time: 2023-07-30T00:00:00.000
2024-11-20 23:07:07,098 - INFO - pnl: 2023-07-22T23:59:59.999 140173.66704696135 === -0.707%
2024-11-20 23:07:07,103 - DEBUG - cur time: 2023-07-23T23:59:59.999 == next bar open time: 2023-07-24T00:00:00.000 == close pos time: 2023-07-31T00:00:00.000
2024-11-20 23:07:07,105 - INFO - pnl: 2023-07-23T23:59:59.999 144077.51867308753 === 2.785%
2024-11-20 23:07:07,109 - DEBUG - cur time: 2023-07-24T23:59:59.999 == next bar open time: 2023-07-25T00:00:00.000 == close pos time: 2023-08-01T00:00:00.000
2024-11-20 23:07:07,118 - DEBUG - sorted_long_factors: shape: (166, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ARBUSDT   ┆ -1.795915    ┆ 0    ┆ 165          │
│ STXUSDT   ┆ -1.782493    ┆ 1    ┆ 164          │
│ CFXUSDT   ┆ -1.735988    ┆ 2    ┆ 163          │
│ BELUSDT   ┆ -1.70712     ┆ 3    ┆ 162          │
│ TOMOUSDT  ┆ -1.688862    ┆ 4    ┆ 161          │
│ WAVESUSDT ┆ -1.644411    ┆ 5    ┆ 160          │
│ FETUSDT   ┆ -1.628385    ┆ 6    ┆ 159          │
│ RDNTUSDT  ┆ -1.615233    ┆ 7    ┆ 158          │
│ ZENUSDT   ┆ -1.574596    ┆ 8    ┆ 157          │
│ USDCUSDT  ┆ -1.517803    ┆ 9    ┆ 156          │
│ …         ┆ …            ┆ …    ┆ …            │
│ SKLUSDT   ┆ 0.052545     ┆ 156  ┆ 9            │
│ GTCUSDT   ┆ 0.06779      ┆ 157  ┆ 8            │
│ RVNUSDT   ┆ 0.121107     ┆ 158  ┆ 7            │
│ LEVERUSDT ┆ 0.25511      ┆ 159  ┆ 6            │
│ CTKUSDT   ┆ 0.276276     ┆ 160  ┆ 5            │
│ TLMUSDT   ┆ 0.360705     ┆ 161  ┆ 4            │
│ CVXUSDT   ┆ 0.397617     ┆ 162  ┆ 3            │
│ PERPUSDT  ┆ 0.447306     ┆ 163  ┆ 2            │
│ SPELLUSDT ┆ 0.489399     ┆ 164  ┆ 1            │
│ LPTUSDT   ┆ 0.679018     ┆ 165  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:07,126 - WARNING - 2023-07-24T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:07,126 - INFO - cur close time: 2023-07-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:07,127 - DEBUG - mean expected ret (mean factor): -0.8053389240778248
2024-11-20 23:07:07,131 - DEBUG - begin to update pos: =========
2024-11-20 23:07:07,132 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,132 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08187     ┆ null        ┆ … ┆ 0.02072 ┆ null   ┆ null    ┆ 0.2065  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,140 - DEBUG - update position: 2023-07-24T23:59:59.999 === diff_trading_value: 218104.65967947475 == cash: 142021.563642058 
2024-11-20 23:07:07,143 - INFO - pnl: 2023-07-24T23:59:59.999 142021.563642058 === -1.427%
2024-11-20 23:07:07,152 - DEBUG - cur time: 2023-07-25T23:59:59.999 == next bar open time: 2023-07-26T00:00:00.000 == close pos time: 2023-08-02T00:00:00.000
2024-11-20 23:07:07,158 - INFO - pnl: 2023-07-25T23:59:59.999 141375.1247759791 === -0.455%
2024-11-20 23:07:07,169 - DEBUG - cur time: 2023-07-26T23:59:59.999 == next bar open time: 2023-07-27T00:00:00.000 == close pos time: 2023-08-03T00:00:00.000
2024-11-20 23:07:07,173 - INFO - pnl: 2023-07-26T23:59:59.999 141144.12255767678 === -0.163%
2024-11-20 23:07:07,190 - DEBUG - cur time: 2023-07-27T23:59:59.999 == next bar open time: 2023-07-28T00:00:00.000 == close pos time: 2023-08-04T00:00:00.000
2024-11-20 23:07:07,198 - INFO - pnl: 2023-07-27T23:59:59.999 141854.99394549604 === 0.504%
2024-11-20 23:07:07,209 - DEBUG - cur time: 2023-07-28T23:59:59.999 == next bar open time: 2023-07-29T00:00:00.000 == close pos time: 2023-08-05T00:00:00.000
2024-11-20 23:07:07,214 - INFO - pnl: 2023-07-28T23:59:59.999 142088.5417161133 === 0.165%
2024-11-20 23:07:07,222 - DEBUG - cur time: 2023-07-29T23:59:59.999 == next bar open time: 2023-07-30T00:00:00.000 == close pos time: 2023-08-06T00:00:00.000
2024-11-20 23:07:07,227 - INFO - pnl: 2023-07-29T23:59:59.999 140799.0876760418 === -0.908%
2024-11-20 23:07:07,240 - DEBUG - cur time: 2023-07-30T23:59:59.999 == next bar open time: 2023-07-31T00:00:00.000 == close pos time: 2023-08-07T00:00:00.000
2024-11-20 23:07:07,244 - INFO - pnl: 2023-07-30T23:59:59.999 139508.67467363892 === -0.916%
2024-11-20 23:07:07,256 - DEBUG - cur time: 2023-07-31T23:59:59.999 == next bar open time: 2023-08-01T00:00:00.000 == close pos time: 2023-08-08T00:00:00.000
2024-11-20 23:07:07,271 - DEBUG - sorted_long_factors: shape: (166, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ UNIUSDT      ┆ -1.836054    ┆ 0    ┆ 165          │
│ IDUSDT       ┆ -1.813116    ┆ 1    ┆ 164          │
│ IMXUSDT      ┆ -1.742306    ┆ 2    ┆ 163          │
│ APTUSDT      ┆ -1.69032     ┆ 3    ┆ 162          │
│ ARBUSDT      ┆ -1.668036    ┆ 4    ┆ 161          │
│ NEOUSDT      ┆ -1.573808    ┆ 5    ┆ 160          │
│ ZECUSDT      ┆ -1.570918    ┆ 6    ┆ 159          │
│ HIGHUSDT     ┆ -1.530305    ┆ 7    ┆ 158          │
│ DYDXUSDT     ┆ -1.522999    ┆ 8    ┆ 157          │
│ WAVESUSDT    ┆ -1.522841    ┆ 9    ┆ 156          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TLMUSDT      ┆ 0.054947     ┆ 156  ┆ 9            │
│ LPTUSDT      ┆ 0.099019     ┆ 157  ┆ 8            │
│ RVNUSDT      ┆ 0.139594     ┆ 158  ┆ 7            │
│ CHRUSDT      ┆ 0.145237     ┆ 159  ┆ 6            │
│ CVXUSDT      ┆ 0.151663     ┆ 160  ┆ 5            │
│ BLUEBIRDUSDT ┆ 0.327767     ┆ 161  ┆ 4            │
│ BLZUSDT      ┆ 0.453486     ┆ 162  ┆ 3            │
│ IOTXUSDT     ┆ 0.54285      ┆ 163  ┆ 2            │
│ CTKUSDT      ┆ 0.776048     ┆ 164  ┆ 1            │
│ DEFIUSDT     ┆ 1.261005     ┆ 165  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:07,281 - INFO - cur close time: 2023-07-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:07,281 - DEBUG - mean expected ret (mean factor): -0.7871516725600123
2024-11-20 23:07:07,286 - DEBUG - begin to update pos: =========
2024-11-20 23:07:07,286 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,287 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08044     ┆ null        ┆ … ┆ 0.02084 ┆ null   ┆ null    ┆ 0.2154  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,297 - DEBUG - update position: 2023-07-31T23:59:59.999 === diff_trading_value: 234456.09521783591 == cash: 139342.74169096525 
2024-11-20 23:07:07,299 - INFO - pnl: 2023-07-31T23:59:59.999 139342.74169096525 === -0.119%
2024-11-20 23:07:07,303 - DEBUG - cur time: 2023-08-01T23:59:59.999 == next bar open time: 2023-08-02T00:00:00.000 == close pos time: 2023-08-09T00:00:00.000
2024-11-20 23:07:07,305 - INFO - pnl: 2023-08-01T23:59:59.999 140507.140175589 === 0.836%
2024-11-20 23:07:07,311 - DEBUG - cur time: 2023-08-02T23:59:59.999 == next bar open time: 2023-08-03T00:00:00.000 == close pos time: 2023-08-10T00:00:00.000
2024-11-20 23:07:07,314 - INFO - pnl: 2023-08-02T23:59:59.999 140782.32534568355 === 0.196%
2024-11-20 23:07:07,318 - DEBUG - cur time: 2023-08-03T23:59:59.999 == next bar open time: 2023-08-04T00:00:00.000 == close pos time: 2023-08-11T00:00:00.000
2024-11-20 23:07:07,320 - INFO - pnl: 2023-08-03T23:59:59.999 141302.25136839005 === 0.369%
2024-11-20 23:07:07,323 - DEBUG - cur time: 2023-08-04T23:59:59.999 == next bar open time: 2023-08-05T00:00:00.000 == close pos time: 2023-08-12T00:00:00.000
2024-11-20 23:07:07,324 - INFO - pnl: 2023-08-04T23:59:59.999 141275.62912230915 === -0.019%
2024-11-20 23:07:07,328 - DEBUG - cur time: 2023-08-05T23:59:59.999 == next bar open time: 2023-08-06T00:00:00.000 == close pos time: 2023-08-13T00:00:00.000
2024-11-20 23:07:07,329 - INFO - pnl: 2023-08-05T23:59:59.999 140396.94515416175 === -0.622%
2024-11-20 23:07:07,333 - DEBUG - cur time: 2023-08-06T23:59:59.999 == next bar open time: 2023-08-07T00:00:00.000 == close pos time: 2023-08-14T00:00:00.000
2024-11-20 23:07:07,335 - INFO - pnl: 2023-08-06T23:59:59.999 142936.94017393672 === 1.809%
2024-11-20 23:07:07,338 - DEBUG - cur time: 2023-08-07T23:59:59.999 == next bar open time: 2023-08-08T00:00:00.000 == close pos time: 2023-08-15T00:00:00.000
2024-11-20 23:07:07,345 - DEBUG - sorted_long_factors: shape: (167, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MAGICUSDT    ┆ -1.744074    ┆ 0    ┆ 166          │
│ BNBUSDT      ┆ -1.680386    ┆ 1    ┆ 165          │
│ USDCUSDT     ┆ -1.616809    ┆ 2    ┆ 164          │
│ UNIUSDT      ┆ -1.616409    ┆ 3    ┆ 163          │
│ HIGHUSDT     ┆ -1.569741    ┆ 4    ┆ 162          │
│ SSVUSDT      ┆ -1.538516    ┆ 5    ┆ 161          │
│ CFXUSDT      ┆ -1.508717    ┆ 6    ┆ 160          │
│ NEOUSDT      ┆ -1.478986    ┆ 7    ┆ 159          │
│ WAVESUSDT    ┆ -1.459622    ┆ 8    ┆ 158          │
│ ASTRUSDT     ┆ -1.413265    ┆ 9    ┆ 157          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ATAUSDT      ┆ -0.219319    ┆ 157  ┆ 9            │
│ LEVERUSDT    ┆ -0.174365    ┆ 158  ┆ 8            │
│ FXSUSDT      ┆ -0.134057    ┆ 159  ┆ 7            │
│ SNXUSDT      ┆ -0.110673    ┆ 160  ┆ 6            │
│ KSMUSDT      ┆ 0.028079     ┆ 161  ┆ 5            │
│ CTKUSDT      ┆ 0.394913     ┆ 162  ┆ 4            │
│ DEFIUSDT     ┆ 0.545445     ┆ 163  ┆ 3            │
│ BLZUSDT      ┆ 0.617311     ┆ 164  ┆ 2            │
│ IOTXUSDT     ┆ 0.647824     ┆ 165  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.654231     ┆ 166  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:07,353 - INFO - cur close time: 2023-08-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:07,353 - DEBUG - mean expected ret (mean factor): -0.815141151267104
2024-11-20 23:07:07,358 - DEBUG - begin to update pos: =========
2024-11-20 23:07:07,359 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,359 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.07753     ┆ null        ┆ … ┆ 0.02001 ┆ null   ┆ null    ┆ 0.2168  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,367 - DEBUG - update position: 2023-08-07T23:59:59.999 === diff_trading_value: 208259.64857287914 == cash: 143134.2845978864 
2024-11-20 23:07:07,368 - INFO - pnl: 2023-08-07T23:59:59.999 143134.2845978864 === 0.138%
2024-11-20 23:07:07,372 - DEBUG - cur time: 2023-08-08T23:59:59.999 == next bar open time: 2023-08-09T00:00:00.000 == close pos time: 2023-08-16T00:00:00.000
2024-11-20 23:07:07,374 - INFO - pnl: 2023-08-08T23:59:59.999 144474.4204490388 === 0.936%
2024-11-20 23:07:07,378 - DEBUG - cur time: 2023-08-09T23:59:59.999 == next bar open time: 2023-08-10T00:00:00.000 == close pos time: 2023-08-17T00:00:00.000
2024-11-20 23:07:07,380 - INFO - pnl: 2023-08-09T23:59:59.999 143821.77454154348 === -0.452%
2024-11-20 23:07:07,383 - DEBUG - cur time: 2023-08-10T23:59:59.999 == next bar open time: 2023-08-11T00:00:00.000 == close pos time: 2023-08-18T00:00:00.000
2024-11-20 23:07:07,384 - INFO - pnl: 2023-08-10T23:59:59.999 143090.52384529228 === -0.508%
2024-11-20 23:07:07,388 - DEBUG - cur time: 2023-08-11T23:59:59.999 == next bar open time: 2023-08-12T00:00:00.000 == close pos time: 2023-08-19T00:00:00.000
2024-11-20 23:07:07,389 - INFO - pnl: 2023-08-11T23:59:59.999 142877.58755730573 === -0.149%
2024-11-20 23:07:07,393 - DEBUG - cur time: 2023-08-12T23:59:59.999 == next bar open time: 2023-08-13T00:00:00.000 == close pos time: 2023-08-20T00:00:00.000
2024-11-20 23:07:07,395 - INFO - pnl: 2023-08-12T23:59:59.999 143755.5287703232 === 0.614%
2024-11-20 23:07:07,398 - DEBUG - cur time: 2023-08-13T23:59:59.999 == next bar open time: 2023-08-14T00:00:00.000 == close pos time: 2023-08-21T00:00:00.000
2024-11-20 23:07:07,400 - INFO - pnl: 2023-08-13T23:59:59.999 148616.21143150842 === 3.381%
2024-11-20 23:07:07,404 - DEBUG - cur time: 2023-08-14T23:59:59.999 == next bar open time: 2023-08-15T00:00:00.000 == close pos time: 2023-08-22T00:00:00.000
2024-11-20 23:07:07,412 - DEBUG - sorted_long_factors: shape: (171, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ STXUSDT      ┆ -1.737124    ┆ 0    ┆ 170          │
│ BNBUSDT      ┆ -1.725931    ┆ 1    ┆ 169          │
│ QNTUSDT      ┆ -1.680986    ┆ 2    ┆ 168          │
│ BLURUSDT     ┆ -1.61033     ┆ 3    ┆ 167          │
│ RNDRUSDT     ┆ -1.609787    ┆ 4    ┆ 166          │
│ COMPUSDT     ┆ -1.606197    ┆ 5    ┆ 165          │
│ APEUSDT      ┆ -1.584026    ┆ 6    ┆ 164          │
│ HIGHUSDT     ┆ -1.566356    ┆ 7    ┆ 163          │
│ LPTUSDT      ┆ -1.525455    ┆ 8    ┆ 162          │
│ SUIUSDT      ┆ -1.513067    ┆ 9    ┆ 161          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CHRUSDT      ┆ -0.078108    ┆ 161  ┆ 9            │
│ IDEXUSDT     ┆ -0.064651    ┆ 162  ┆ 8            │
│ DEFIUSDT     ┆ -0.020628    ┆ 163  ┆ 7            │
│ DENTUSDT     ┆ -0.019514    ┆ 164  ┆ 6            │
│ SKLUSDT      ┆ 0.081694     ┆ 165  ┆ 5            │
│ ARUSDT       ┆ 0.10621      ┆ 166  ┆ 4            │
│ ICXUSDT      ┆ 0.162466     ┆ 167  ┆ 3            │
│ CTKUSDT      ┆ 0.267885     ┆ 168  ┆ 2            │
│ IOTXUSDT     ┆ 0.274705     ┆ 169  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.924743     ┆ 170  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:07,421 - WARNING - 2023-08-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:07,422 - INFO - cur close time: 2023-08-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:07,422 - DEBUG - mean expected ret (mean factor): -0.8288147250947673
2024-11-20 23:07:07,426 - DEBUG - begin to update pos: =========
2024-11-20 23:07:07,427 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,427 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02384     ┆ 0.07926     ┆ 0.0014048   ┆ … ┆ 0.02019 ┆ null   ┆ null    ┆ 0.2252  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,436 - DEBUG - update position: 2023-08-14T23:59:59.999 === diff_trading_value: 292500.1262786347 == cash: 147438.36327612188 
2024-11-20 23:07:07,438 - INFO - pnl: 2023-08-14T23:59:59.999 147438.36327612188 === -0.793%
2024-11-20 23:07:07,444 - DEBUG - cur time: 2023-08-15T23:59:59.999 == next bar open time: 2023-08-16T00:00:00.000 == close pos time: 2023-08-23T00:00:00.000
2024-11-20 23:07:07,446 - INFO - pnl: 2023-08-15T23:59:59.999 147511.40430948662 === 0.050%
2024-11-20 23:07:07,452 - DEBUG - cur time: 2023-08-16T23:59:59.999 == next bar open time: 2023-08-17T00:00:00.000 == close pos time: 2023-08-24T00:00:00.000
2024-11-20 23:07:07,454 - INFO - pnl: 2023-08-16T23:59:59.999 146696.30144517918 === -0.553%
2024-11-20 23:07:07,460 - DEBUG - cur time: 2023-08-17T23:59:59.999 == next bar open time: 2023-08-18T00:00:00.000 == close pos time: 2023-08-25T00:00:00.000
2024-11-20 23:07:07,461 - INFO - pnl: 2023-08-17T23:59:59.999 146284.4436206977 === -0.281%
2024-11-20 23:07:07,467 - DEBUG - cur time: 2023-08-18T23:59:59.999 == next bar open time: 2023-08-19T00:00:00.000 == close pos time: 2023-08-26T00:00:00.000
2024-11-20 23:07:07,470 - INFO - pnl: 2023-08-18T23:59:59.999 146011.74692406348 === -0.186%
2024-11-20 23:07:07,475 - DEBUG - cur time: 2023-08-19T23:59:59.999 == next bar open time: 2023-08-20T00:00:00.000 == close pos time: 2023-08-27T00:00:00.000
2024-11-20 23:07:07,477 - INFO - pnl: 2023-08-19T23:59:59.999 145392.91988884777 === -0.424%
2024-11-20 23:07:07,482 - DEBUG - cur time: 2023-08-20T23:59:59.999 == next bar open time: 2023-08-21T00:00:00.000 == close pos time: 2023-08-28T00:00:00.000
2024-11-20 23:07:07,484 - INFO - pnl: 2023-08-20T23:59:59.999 146047.3615938168 === 0.450%
2024-11-20 23:07:07,489 - DEBUG - cur time: 2023-08-21T23:59:59.999 == next bar open time: 2023-08-22T00:00:00.000 == close pos time: 2023-08-29T00:00:00.000
2024-11-20 23:07:07,500 - DEBUG - sorted_long_factors: shape: (174, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT   ┆ -2.076465    ┆ 0    ┆ 173          │
│ UNFIUSDT     ┆ -1.917584    ┆ 1    ┆ 172          │
│ LEVERUSDT    ┆ -1.805349    ┆ 2    ┆ 171          │
│ KNCUSDT      ┆ -1.707133    ┆ 3    ┆ 170          │
│ HIGHUSDT     ┆ -1.622318    ┆ 4    ┆ 169          │
│ PHBUSDT      ┆ -1.616035    ┆ 5    ┆ 168          │
│ USDCUSDT     ┆ -1.590121    ┆ 6    ┆ 167          │
│ FXSUSDT      ┆ -1.576273    ┆ 7    ┆ 166          │
│ APEUSDT      ┆ -1.499425    ┆ 8    ┆ 165          │
│ GTCUSDT      ┆ -1.487961    ┆ 9    ┆ 164          │
│ …            ┆ …            ┆ …    ┆ …            │
│ QNTUSDT      ┆ -0.094531    ┆ 164  ┆ 9            │
│ ENSUSDT      ┆ -0.088222    ┆ 165  ┆ 8            │
│ XVSUSDT      ┆ -0.075063    ┆ 166  ┆ 7            │
│ FOOTBALLUSDT ┆ -0.040705    ┆ 167  ┆ 6            │
│ SPELLUSDT    ┆ 0.079435     ┆ 168  ┆ 5            │
│ ARUSDT       ┆ 0.219792     ┆ 169  ┆ 4            │
│ IDEXUSDT     ┆ 0.30065      ┆ 170  ┆ 3            │
│ CTKUSDT      ┆ 0.406882     ┆ 171  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.611315     ┆ 172  ┆ 1            │
│ DEFIUSDT     ┆ 1.106967     ┆ 173  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:07,511 - WARNING - 2023-08-21T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:07,513 - INFO - cur close time: 2023-08-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:07,513 - DEBUG - mean expected ret (mean factor): -0.8209438031086974
2024-11-20 23:07:07,518 - DEBUG - begin to update pos: =========
2024-11-20 23:07:07,519 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,519 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01838     ┆ 0.06528     ┆ 0.0010857   ┆ … ┆ 0.01662 ┆ null   ┆ null    ┆ 0.174   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,527 - DEBUG - update position: 2023-08-21T23:59:59.999 === diff_trading_value: 259706.00218779055 == cash: 146211.64279783895 
2024-11-20 23:07:07,529 - INFO - pnl: 2023-08-21T23:59:59.999 146211.64279783895 === 0.112%
2024-11-20 23:07:07,534 - DEBUG - cur time: 2023-08-22T23:59:59.999 == next bar open time: 2023-08-23T00:00:00.000 == close pos time: 2023-08-30T00:00:00.000
2024-11-20 23:07:07,536 - INFO - pnl: 2023-08-22T23:59:59.999 144726.27630011295 === -1.016%
2024-11-20 23:07:07,540 - DEBUG - cur time: 2023-08-23T23:59:59.999 == next bar open time: 2023-08-24T00:00:00.000 == close pos time: 2023-08-31T00:00:00.000
2024-11-20 23:07:07,541 - INFO - pnl: 2023-08-23T23:59:59.999 145035.18690769983 === 0.213%
2024-11-20 23:07:07,545 - DEBUG - cur time: 2023-08-24T23:59:59.999 == next bar open time: 2023-08-25T00:00:00.000 == close pos time: 2023-09-01T00:00:00.000
2024-11-20 23:07:07,547 - INFO - pnl: 2023-08-24T23:59:59.999 143581.82365799608 === -1.002%
2024-11-20 23:07:07,551 - DEBUG - cur time: 2023-08-25T23:59:59.999 == next bar open time: 2023-08-26T00:00:00.000 == close pos time: 2023-09-02T00:00:00.000
2024-11-20 23:07:07,552 - INFO - pnl: 2023-08-25T23:59:59.999 146082.08944014547 === 1.741%
2024-11-20 23:07:07,558 - DEBUG - cur time: 2023-08-26T23:59:59.999 == next bar open time: 2023-08-27T00:00:00.000 == close pos time: 2023-09-03T00:00:00.000
2024-11-20 23:07:07,560 - INFO - pnl: 2023-08-26T23:59:59.999 145135.2099157942 === -0.648%
2024-11-20 23:07:07,565 - DEBUG - cur time: 2023-08-27T23:59:59.999 == next bar open time: 2023-08-28T00:00:00.000 == close pos time: 2023-09-04T00:00:00.000
2024-11-20 23:07:07,568 - INFO - pnl: 2023-08-27T23:59:59.999 144739.50470719973 === -0.273%
2024-11-20 23:07:07,571 - DEBUG - cur time: 2023-08-28T23:59:59.999 == next bar open time: 2023-08-29T00:00:00.000 == close pos time: 2023-09-05T00:00:00.000
2024-11-20 23:07:07,587 - DEBUG - sorted_long_factors: shape: (174, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ COMPUSDT  ┆ -1.645561    ┆ 0    ┆ 173          │
│ AGIXUSDT  ┆ -1.59524     ┆ 1    ┆ 172          │
│ PHBUSDT   ┆ -1.587998    ┆ 2    ┆ 171          │
│ BLURUSDT  ┆ -1.574393    ┆ 3    ┆ 170          │
│ USDCUSDT  ┆ -1.549435    ┆ 4    ┆ 169          │
│ RNDRUSDT  ┆ -1.541254    ┆ 5    ┆ 168          │
│ LEVERUSDT ┆ -1.480962    ┆ 6    ┆ 167          │
│ XRPUSDT   ┆ -1.428551    ┆ 7    ┆ 166          │
│ GTCUSDT   ┆ -1.428436    ┆ 8    ┆ 165          │
│ WAVESUSDT ┆ -1.395609    ┆ 9    ┆ 164          │
│ …         ┆ …            ┆ …    ┆ …            │
│ COTIUSDT  ┆ -0.155161    ┆ 164  ┆ 9            │
│ DEFIUSDT  ┆ -0.101204    ┆ 165  ┆ 8            │
│ ENSUSDT   ┆ -0.099076    ┆ 166  ┆ 7            │
│ DGBUSDT   ┆ -0.024255    ┆ 167  ┆ 6            │
│ BALUSDT   ┆ 0.174882     ┆ 168  ┆ 5            │
│ IDEXUSDT  ┆ 0.275367     ┆ 169  ┆ 4            │
│ CKBUSDT   ┆ 0.371598     ┆ 170  ┆ 3            │
│ TUSDT     ┆ 0.475063     ┆ 171  ┆ 2            │
│ XVSUSDT   ┆ 0.48127      ┆ 172  ┆ 1            │
│ CTKUSDT   ┆ 0.573701     ┆ 173  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:07,594 - INFO - cur close time: 2023-08-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:07,594 - DEBUG - mean expected ret (mean factor): -0.817028684812132
2024-11-20 23:07:07,599 - DEBUG - begin to update pos: =========
2024-11-20 23:07:07,599 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,599 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01758     ┆ 0.06274     ┆ 0.0008576   ┆ … ┆ 0.01672 ┆ null   ┆ null    ┆ 0.1712  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,609 - DEBUG - update position: 2023-08-28T23:59:59.999 === diff_trading_value: 214376.76762643148 == cash: 142243.75014509613 
2024-11-20 23:07:07,611 - INFO - pnl: 2023-08-28T23:59:59.999 142243.75014509613 === -1.724%
2024-11-20 23:07:07,619 - DEBUG - cur time: 2023-08-29T23:59:59.999 == next bar open time: 2023-08-30T00:00:00.000 == close pos time: 2023-09-06T00:00:00.000
2024-11-20 23:07:07,622 - INFO - pnl: 2023-08-29T23:59:59.999 143509.59893072586 === 0.890%
2024-11-20 23:07:07,625 - DEBUG - cur time: 2023-08-30T23:59:59.999 == next bar open time: 2023-08-31T00:00:00.000 == close pos time: 2023-09-07T00:00:00.000
2024-11-20 23:07:07,627 - INFO - pnl: 2023-08-30T23:59:59.999 142943.15457347373 === -0.395%
2024-11-20 23:07:07,631 - DEBUG - cur time: 2023-08-31T23:59:59.999 == next bar open time: 2023-09-01T00:00:00.000 == close pos time: 2023-09-08T00:00:00.000
2024-11-20 23:07:07,634 - INFO - pnl: 2023-08-31T23:59:59.999 143692.08595652488 === 0.524%
2024-11-20 23:07:07,640 - DEBUG - cur time: 2023-09-01T23:59:59.999 == next bar open time: 2023-09-02T00:00:00.000 == close pos time: 2023-09-09T00:00:00.000
2024-11-20 23:07:07,643 - INFO - pnl: 2023-09-01T23:59:59.999 143645.71693462663 === -0.032%
2024-11-20 23:07:07,650 - DEBUG - cur time: 2023-09-02T23:59:59.999 == next bar open time: 2023-09-03T00:00:00.000 == close pos time: 2023-09-10T00:00:00.000
2024-11-20 23:07:07,653 - INFO - pnl: 2023-09-02T23:59:59.999 143761.47112293734 === 0.081%
2024-11-20 23:07:07,657 - DEBUG - cur time: 2023-09-03T23:59:59.999 == next bar open time: 2023-09-04T00:00:00.000 == close pos time: 2023-09-11T00:00:00.000
2024-11-20 23:07:07,659 - INFO - pnl: 2023-09-03T23:59:59.999 143171.40822387167 === -0.410%
2024-11-20 23:07:07,663 - DEBUG - cur time: 2023-09-04T23:59:59.999 == next bar open time: 2023-09-05T00:00:00.000 == close pos time: 2023-09-12T00:00:00.000
2024-11-20 23:07:07,674 - DEBUG - sorted_long_factors: shape: (175, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RADUSDT      ┆ -1.76191     ┆ 0    ┆ 174          │
│ XMRUSDT      ┆ -1.705939    ┆ 1    ┆ 173          │
│ USDCUSDT     ┆ -1.696895    ┆ 2    ┆ 172          │
│ SUIUSDT      ┆ -1.65999     ┆ 3    ┆ 171          │
│ EOSUSDT      ┆ -1.642782    ┆ 4    ┆ 170          │
│ DOTUSDT      ┆ -1.640986    ┆ 5    ┆ 169          │
│ LPTUSDT      ┆ -1.628311    ┆ 6    ┆ 168          │
│ DYDXUSDT     ┆ -1.603742    ┆ 7    ┆ 167          │
│ EGLDUSDT     ┆ -1.579717    ┆ 8    ┆ 166          │
│ ADAUSDT      ┆ -1.537396    ┆ 9    ┆ 165          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DGBUSDT      ┆ 0.072341     ┆ 165  ┆ 9            │
│ HOTUSDT      ┆ 0.078858     ┆ 166  ┆ 8            │
│ CELRUSDT     ┆ 0.082029     ┆ 167  ┆ 7            │
│ BNXUSDT      ┆ 0.189173     ┆ 168  ┆ 6            │
│ ICXUSDT      ┆ 0.291479     ┆ 169  ┆ 5            │
│ IOTXUSDT     ┆ 0.375998     ┆ 170  ┆ 4            │
│ TUSDT        ┆ 0.446303     ┆ 171  ┆ 3            │
│ SPELLUSDT    ┆ 0.450584     ┆ 172  ┆ 2            │
│ CKBUSDT      ┆ 0.576675     ┆ 173  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.579004     ┆ 174  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:07,683 - WARNING - 2023-09-04T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:07,683 - INFO - cur close time: 2023-09-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:07,683 - DEBUG - mean expected ret (mean factor): -0.7915316695066992
2024-11-20 23:07:07,688 - DEBUG - begin to update pos: =========
2024-11-20 23:07:07,689 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,689 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01694     ┆ 0.0612      ┆ 0.0007977   ┆ … ┆ 0.01609 ┆ null   ┆ null    ┆ 0.1687  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,698 - DEBUG - update position: 2023-09-04T23:59:59.999 === diff_trading_value: 302728.0507536048 == cash: 141939.4861144339 
2024-11-20 23:07:07,699 - INFO - pnl: 2023-09-04T23:59:59.999 141939.4861144339 === -0.860%
2024-11-20 23:07:07,705 - DEBUG - cur time: 2023-09-05T23:59:59.999 == next bar open time: 2023-09-06T00:00:00.000 == close pos time: 2023-09-13T00:00:00.000
2024-11-20 23:07:07,707 - INFO - pnl: 2023-09-05T23:59:59.999 145084.38702955845 === 2.216%
2024-11-20 23:07:07,714 - DEBUG - cur time: 2023-09-06T23:59:59.999 == next bar open time: 2023-09-07T00:00:00.000 == close pos time: 2023-09-14T00:00:00.000
2024-11-20 23:07:07,719 - INFO - pnl: 2023-09-06T23:59:59.999 146897.49006259834 === 1.250%
2024-11-20 23:07:07,730 - DEBUG - cur time: 2023-09-07T23:59:59.999 == next bar open time: 2023-09-08T00:00:00.000 == close pos time: 2023-09-15T00:00:00.000
2024-11-20 23:07:07,733 - INFO - pnl: 2023-09-07T23:59:59.999 148098.54059245624 === 0.818%
2024-11-20 23:07:07,740 - DEBUG - cur time: 2023-09-08T23:59:59.999 == next bar open time: 2023-09-09T00:00:00.000 == close pos time: 2023-09-16T00:00:00.000
2024-11-20 23:07:07,742 - INFO - pnl: 2023-09-08T23:59:59.999 148758.57513797103 === 0.446%
2024-11-20 23:07:07,750 - DEBUG - cur time: 2023-09-09T23:59:59.999 == next bar open time: 2023-09-10T00:00:00.000 == close pos time: 2023-09-17T00:00:00.000
2024-11-20 23:07:07,752 - INFO - pnl: 2023-09-09T23:59:59.999 149977.74061753522 === 0.820%
2024-11-20 23:07:07,757 - DEBUG - cur time: 2023-09-10T23:59:59.999 == next bar open time: 2023-09-11T00:00:00.000 == close pos time: 2023-09-18T00:00:00.000
2024-11-20 23:07:07,761 - INFO - pnl: 2023-09-10T23:59:59.999 148291.5896193996 === -1.124%
2024-11-20 23:07:07,768 - DEBUG - cur time: 2023-09-11T23:59:59.999 == next bar open time: 2023-09-12T00:00:00.000 == close pos time: 2023-09-19T00:00:00.000
2024-11-20 23:07:07,780 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WAVESUSDT    ┆ -1.741149    ┆ 0    ┆ 175          │
│ XVSUSDT      ┆ -1.655256    ┆ 1    ┆ 174          │
│ USDCUSDT     ┆ -1.644472    ┆ 2    ┆ 173          │
│ 1000PEPEUSDT ┆ -1.61838     ┆ 3    ┆ 172          │
│ EDUUSDT      ┆ -1.542404    ┆ 4    ┆ 171          │
│ MTLUSDT      ┆ -1.533344    ┆ 5    ┆ 170          │
│ RADUSDT      ┆ -1.477928    ┆ 6    ┆ 169          │
│ PERPUSDT     ┆ -1.465368    ┆ 7    ┆ 168          │
│ SUIUSDT      ┆ -1.402428    ┆ 8    ┆ 167          │
│ UMAUSDT      ┆ -1.401492    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ KSMUSDT      ┆ -0.011941    ┆ 166  ┆ 9            │
│ FXSUSDT      ┆ -0.001353    ┆ 167  ┆ 8            │
│ SPELLUSDT    ┆ 0.037873     ┆ 168  ┆ 7            │
│ CVXUSDT      ┆ 0.069282     ┆ 169  ┆ 6            │
│ BALUSDT      ┆ 0.092966     ┆ 170  ┆ 5            │
│ RVNUSDT      ┆ 0.126604     ┆ 171  ┆ 4            │
│ CKBUSDT      ┆ 0.316909     ┆ 172  ┆ 3            │
│ DGBUSDT      ┆ 0.390579     ┆ 173  ┆ 2            │
│ DEFIUSDT     ┆ 1.188612     ┆ 174  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.325526     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:07,788 - WARNING - 2023-09-11T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:07,789 - INFO - cur close time: 2023-09-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:07,789 - DEBUG - mean expected ret (mean factor): -0.7925274184357282
2024-11-20 23:07:07,794 - DEBUG - begin to update pos: =========
2024-11-20 23:07:07,795 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,795 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01554     ┆ 0.05689     ┆ 0.0006688   ┆ … ┆ 0.01504 ┆ null   ┆ null    ┆ 0.1581  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,802 - DEBUG - update position: 2023-09-11T23:59:59.999 === diff_trading_value: 246760.97145290175 == cash: 147198.19912405018 
2024-11-20 23:07:07,803 - INFO - pnl: 2023-09-11T23:59:59.999 147198.19912405018 === -0.737%
2024-11-20 23:07:07,806 - DEBUG - cur time: 2023-09-12T23:59:59.999 == next bar open time: 2023-09-13T00:00:00.000 == close pos time: 2023-09-20T00:00:00.000
2024-11-20 23:07:07,809 - INFO - pnl: 2023-09-12T23:59:59.999 149592.78434406093 === 1.627%
2024-11-20 23:07:07,814 - DEBUG - cur time: 2023-09-13T23:59:59.999 == next bar open time: 2023-09-14T00:00:00.000 == close pos time: 2023-09-21T00:00:00.000
2024-11-20 23:07:07,816 - INFO - pnl: 2023-09-13T23:59:59.999 149201.56503003306 === -0.262%
2024-11-20 23:07:07,822 - DEBUG - cur time: 2023-09-14T23:59:59.999 == next bar open time: 2023-09-15T00:00:00.000 == close pos time: 2023-09-22T00:00:00.000
2024-11-20 23:07:07,824 - INFO - pnl: 2023-09-14T23:59:59.999 150363.74384266586 === 0.779%
2024-11-20 23:07:07,828 - DEBUG - cur time: 2023-09-15T23:59:59.999 == next bar open time: 2023-09-16T00:00:00.000 == close pos time: 2023-09-23T00:00:00.000
2024-11-20 23:07:07,830 - INFO - pnl: 2023-09-15T23:59:59.999 152835.1183459419 === 1.644%
2024-11-20 23:07:07,833 - DEBUG - cur time: 2023-09-16T23:59:59.999 == next bar open time: 2023-09-17T00:00:00.000 == close pos time: 2023-09-24T00:00:00.000
2024-11-20 23:07:07,835 - INFO - pnl: 2023-09-16T23:59:59.999 153389.08374836037 === 0.362%
2024-11-20 23:07:07,841 - DEBUG - cur time: 2023-09-17T23:59:59.999 == next bar open time: 2023-09-18T00:00:00.000 == close pos time: 2023-09-25T00:00:00.000
2024-11-20 23:07:07,845 - INFO - pnl: 2023-09-17T23:59:59.999 153547.34947489807 === 0.103%
2024-11-20 23:07:07,851 - DEBUG - cur time: 2023-09-18T23:59:59.999 == next bar open time: 2023-09-19T00:00:00.000 == close pos time: 2023-09-26T00:00:00.000
2024-11-20 23:07:07,862 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT      ┆ -2.020324    ┆ 0    ┆ 175          │
│ WAVESUSDT    ┆ -1.791157    ┆ 1    ┆ 174          │
│ RADUSDT      ┆ -1.768742    ┆ 2    ┆ 173          │
│ EDUUSDT      ┆ -1.761038    ┆ 3    ┆ 172          │
│ FOOTBALLUSDT ┆ -1.712886    ┆ 4    ┆ 171          │
│ AAVEUSDT     ┆ -1.707047    ┆ 5    ┆ 170          │
│ MTLUSDT      ┆ -1.678172    ┆ 6    ┆ 169          │
│ PERPUSDT     ┆ -1.664183    ┆ 7    ┆ 168          │
│ IDUSDT       ┆ -1.586258    ┆ 8    ┆ 167          │
│ XLMUSDT      ┆ -1.579523    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CTKUSDT      ┆ -0.030934    ┆ 166  ┆ 9            │
│ ICXUSDT      ┆ 0.00088      ┆ 167  ┆ 8            │
│ BATUSDT      ┆ 0.006896     ┆ 168  ┆ 7            │
│ RVNUSDT      ┆ 0.036095     ┆ 169  ┆ 6            │
│ FXSUSDT      ┆ 0.091128     ┆ 170  ┆ 5            │
│ TUSDT        ┆ 0.197915     ┆ 171  ┆ 4            │
│ CKBUSDT      ┆ 0.241109     ┆ 172  ┆ 3            │
│ DGBUSDT      ┆ 0.42262      ┆ 173  ┆ 2            │
│ DEFIUSDT     ┆ 0.845374     ┆ 174  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.0391       ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:07,875 - WARNING - 2023-09-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:07,875 - INFO - cur close time: 2023-09-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:07,876 - DEBUG - mean expected ret (mean factor): -0.7927216282103546
2024-11-20 23:07:07,882 - DEBUG - begin to update pos: =========
2024-11-20 23:07:07,882 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,882 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01571     ┆ 0.05708     ┆ 0.0006263   ┆ … ┆ 0.01612 ┆ null   ┆ null    ┆ 0.1799  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,893 - DEBUG - update position: 2023-09-18T23:59:59.999 === diff_trading_value: 221633.1080018049 == cash: 153886.9031671867 
2024-11-20 23:07:07,895 - INFO - pnl: 2023-09-18T23:59:59.999 153886.9031671867 === 0.221%
2024-11-20 23:07:07,902 - DEBUG - cur time: 2023-09-19T23:59:59.999 == next bar open time: 2023-09-20T00:00:00.000 == close pos time: 2023-09-27T00:00:00.000
2024-11-20 23:07:07,904 - INFO - pnl: 2023-09-19T23:59:59.999 150776.6778070285 === -2.021%
2024-11-20 23:07:07,911 - DEBUG - cur time: 2023-09-20T23:59:59.999 == next bar open time: 2023-09-21T00:00:00.000 == close pos time: 2023-09-28T00:00:00.000
2024-11-20 23:07:07,913 - INFO - pnl: 2023-09-20T23:59:59.999 149980.63751621035 === -0.528%
2024-11-20 23:07:07,922 - DEBUG - cur time: 2023-09-21T23:59:59.999 == next bar open time: 2023-09-22T00:00:00.000 == close pos time: 2023-09-29T00:00:00.000
2024-11-20 23:07:07,925 - INFO - pnl: 2023-09-21T23:59:59.999 152868.94198672945 === 1.926%
2024-11-20 23:07:07,930 - DEBUG - cur time: 2023-09-22T23:59:59.999 == next bar open time: 2023-09-23T00:00:00.000 == close pos time: 2023-09-30T00:00:00.000
2024-11-20 23:07:07,934 - INFO - pnl: 2023-09-22T23:59:59.999 152894.85830118431 === 0.017%
2024-11-20 23:07:07,944 - DEBUG - cur time: 2023-09-23T23:59:59.999 == next bar open time: 2023-09-24T00:00:00.000 == close pos time: 2023-10-01T00:00:00.000
2024-11-20 23:07:07,949 - INFO - pnl: 2023-09-23T23:59:59.999 152624.28972518435 === -0.177%
2024-11-20 23:07:07,959 - DEBUG - cur time: 2023-09-24T23:59:59.999 == next bar open time: 2023-09-25T00:00:00.000 == close pos time: 2023-10-02T00:00:00.000
2024-11-20 23:07:07,964 - INFO - pnl: 2023-09-24T23:59:59.999 151859.5028296161 === -0.501%
2024-11-20 23:07:07,969 - DEBUG - cur time: 2023-09-25T23:59:59.999 == next bar open time: 2023-09-26T00:00:00.000 == close pos time: 2023-10-03T00:00:00.000
2024-11-20 23:07:07,981 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XVSUSDT      ┆ -1.938894    ┆ 0    ┆ 175          │
│ SUIUSDT      ┆ -1.829574    ┆ 1    ┆ 174          │
│ UNFIUSDT     ┆ -1.774111    ┆ 2    ┆ 173          │
│ MTLUSDT      ┆ -1.697815    ┆ 3    ┆ 172          │
│ LPTUSDT      ┆ -1.668167    ┆ 4    ┆ 171          │
│ MASKUSDT     ┆ -1.635381    ┆ 5    ┆ 170          │
│ IDUSDT       ┆ -1.595426    ┆ 6    ┆ 169          │
│ FILUSDT      ┆ -1.554421    ┆ 7    ┆ 168          │
│ MKRUSDT      ┆ -1.540224    ┆ 8    ┆ 167          │
│ ONTUSDT      ┆ -1.525       ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RSRUSDT      ┆ -0.011651    ┆ 166  ┆ 9            │
│ KLAYUSDT     ┆ 0.012454     ┆ 167  ┆ 8            │
│ TLMUSDT      ┆ 0.080096     ┆ 168  ┆ 7            │
│ IOTXUSDT     ┆ 0.13304      ┆ 169  ┆ 6            │
│ TUSDT        ┆ 0.149821     ┆ 170  ┆ 5            │
│ IOSTUSDT     ┆ 0.170583     ┆ 171  ┆ 4            │
│ CKBUSDT      ┆ 0.421463     ┆ 172  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.433133     ┆ 173  ┆ 2            │
│ DGBUSDT      ┆ 0.783519     ┆ 174  ┆ 1            │
│ DEFIUSDT     ┆ 1.29128      ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:07,991 - WARNING - 2023-09-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:07,991 - INFO - cur close time: 2023-09-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:07,992 - DEBUG - mean expected ret (mean factor): -0.7938063352546856
2024-11-20 23:07:07,997 - DEBUG - begin to update pos: =========
2024-11-20 23:07:07,997 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:07,998 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01575     ┆ 0.06027     ┆ 0.0007104   ┆ … ┆ 0.01689 ┆ null   ┆ null    ┆ 0.1831  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,004 - DEBUG - update position: 2023-09-25T23:59:59.999 === diff_trading_value: 244650.0156577628 == cash: 152434.05247390774 
2024-11-20 23:07:08,007 - INFO - pnl: 2023-09-25T23:59:59.999 152434.05247390774 === 0.378%
2024-11-20 23:07:08,012 - DEBUG - cur time: 2023-09-26T23:59:59.999 == next bar open time: 2023-09-27T00:00:00.000 == close pos time: 2023-10-04T00:00:00.000
2024-11-20 23:07:08,015 - INFO - pnl: 2023-09-26T23:59:59.999 152260.03438891395 === -0.114%
2024-11-20 23:07:08,020 - DEBUG - cur time: 2023-09-27T23:59:59.999 == next bar open time: 2023-09-28T00:00:00.000 == close pos time: 2023-10-05T00:00:00.000
2024-11-20 23:07:08,021 - INFO - pnl: 2023-09-27T23:59:59.999 152619.2008505196 === 0.236%
2024-11-20 23:07:08,026 - DEBUG - cur time: 2023-09-28T23:59:59.999 == next bar open time: 2023-09-29T00:00:00.000 == close pos time: 2023-10-06T00:00:00.000
2024-11-20 23:07:08,028 - INFO - pnl: 2023-09-28T23:59:59.999 152988.38905790792 === 0.242%
2024-11-20 23:07:08,034 - DEBUG - cur time: 2023-09-29T23:59:59.999 == next bar open time: 2023-09-30T00:00:00.000 == close pos time: 2023-10-07T00:00:00.000
2024-11-20 23:07:08,039 - INFO - pnl: 2023-09-29T23:59:59.999 152567.2492235117 === -0.275%
2024-11-20 23:07:08,046 - DEBUG - cur time: 2023-09-30T23:59:59.999 == next bar open time: 2023-10-01T00:00:00.000 == close pos time: 2023-10-08T00:00:00.000
2024-11-20 23:07:08,048 - INFO - pnl: 2023-09-30T23:59:59.999 153098.89900033 === 0.348%
2024-11-20 23:07:08,058 - DEBUG - cur time: 2023-10-01T23:59:59.999 == next bar open time: 2023-10-02T00:00:00.000 == close pos time: 2023-10-09T00:00:00.000
2024-11-20 23:07:08,061 - INFO - pnl: 2023-10-01T23:59:59.999 151742.88670110947 === -0.886%
2024-11-20 23:07:08,069 - DEBUG - cur time: 2023-10-02T23:59:59.999 == next bar open time: 2023-10-03T00:00:00.000 == close pos time: 2023-10-10T00:00:00.000
2024-11-20 23:07:08,081 - DEBUG - sorted_long_factors: shape: (177, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TOMOUSDT     ┆ -1.927774    ┆ 0    ┆ 176          │
│ ARBUSDT      ┆ -1.651945    ┆ 1    ┆ 175          │
│ XVSUSDT      ┆ -1.59367     ┆ 2    ┆ 174          │
│ DOTUSDT      ┆ -1.570276    ┆ 3    ┆ 173          │
│ MASKUSDT     ┆ -1.553156    ┆ 4    ┆ 172          │
│ AMBUSDT      ┆ -1.508982    ┆ 5    ┆ 171          │
│ SUIUSDT      ┆ -1.492375    ┆ 6    ┆ 170          │
│ JOEUSDT      ┆ -1.478875    ┆ 7    ┆ 169          │
│ APTUSDT      ┆ -1.448468    ┆ 8    ┆ 168          │
│ DYDXUSDT     ┆ -1.444523    ┆ 9    ┆ 167          │
│ …            ┆ …            ┆ …    ┆ …            │
│ QNTUSDT      ┆ 0.06976      ┆ 167  ┆ 9            │
│ CKBUSDT      ┆ 0.113164     ┆ 168  ┆ 8            │
│ DENTUSDT     ┆ 0.159664     ┆ 169  ┆ 7            │
│ SKLUSDT      ┆ 0.176501     ┆ 170  ┆ 6            │
│ CVXUSDT      ┆ 0.406116     ┆ 171  ┆ 5            │
│ DGBUSDT      ┆ 0.446935     ┆ 172  ┆ 4            │
│ CTKUSDT      ┆ 0.506615     ┆ 173  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.55885      ┆ 174  ┆ 2            │
│ DEFIUSDT     ┆ 0.599451     ┆ 175  ┆ 1            │
│ BNXUSDT      ┆ 1.123571     ┆ 176  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:08,089 - WARNING - 2023-10-02T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:08,089 - INFO - cur close time: 2023-10-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:08,090 - DEBUG - mean expected ret (mean factor): -0.7947977771841355
2024-11-20 23:07:08,095 - DEBUG - begin to update pos: =========
2024-11-20 23:07:08,096 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,096 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01898     ┆ 0.06151     ┆ 0.0007428   ┆ … ┆ 0.01718 ┆ null   ┆ null    ┆ 0.1901  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,104 - DEBUG - update position: 2023-10-02T23:59:59.999 === diff_trading_value: 258010.00873084227 == cash: 149697.01580121057 
2024-11-20 23:07:08,105 - INFO - pnl: 2023-10-02T23:59:59.999 149697.01580121057 === -1.348%
2024-11-20 23:07:08,110 - DEBUG - cur time: 2023-10-03T23:59:59.999 == next bar open time: 2023-10-04T00:00:00.000 == close pos time: 2023-10-11T00:00:00.000
2024-11-20 23:07:08,113 - INFO - pnl: 2023-10-03T23:59:59.999 150725.95585194492 === 0.687%
2024-11-20 23:07:08,119 - DEBUG - cur time: 2023-10-04T23:59:59.999 == next bar open time: 2023-10-05T00:00:00.000 == close pos time: 2023-10-12T00:00:00.000
2024-11-20 23:07:08,121 - INFO - pnl: 2023-10-04T23:59:59.999 151039.55100326875 === 0.208%
2024-11-20 23:07:08,127 - DEBUG - cur time: 2023-10-05T23:59:59.999 == next bar open time: 2023-10-06T00:00:00.000 == close pos time: 2023-10-13T00:00:00.000
2024-11-20 23:07:08,129 - INFO - pnl: 2023-10-05T23:59:59.999 150918.16718050148 === -0.080%
2024-11-20 23:07:08,132 - DEBUG - cur time: 2023-10-06T23:59:59.999 == next bar open time: 2023-10-07T00:00:00.000 == close pos time: 2023-10-14T00:00:00.000
2024-11-20 23:07:08,135 - INFO - pnl: 2023-10-06T23:59:59.999 151139.20838174908 === 0.146%
2024-11-20 23:07:08,141 - DEBUG - cur time: 2023-10-07T23:59:59.999 == next bar open time: 2023-10-08T00:00:00.000 == close pos time: 2023-10-15T00:00:00.000
2024-11-20 23:07:08,144 - INFO - pnl: 2023-10-07T23:59:59.999 150673.27629235043 === -0.308%
2024-11-20 23:07:08,148 - DEBUG - cur time: 2023-10-08T23:59:59.999 == next bar open time: 2023-10-09T00:00:00.000 == close pos time: 2023-10-16T00:00:00.000
2024-11-20 23:07:08,150 - INFO - pnl: 2023-10-08T23:59:59.999 152639.99735149162 === 1.305%
2024-11-20 23:07:08,155 - DEBUG - cur time: 2023-10-09T23:59:59.999 == next bar open time: 2023-10-10T00:00:00.000 == close pos time: 2023-10-17T00:00:00.000
2024-11-20 23:07:08,166 - DEBUG - sorted_long_factors: shape: (179, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XVSUSDT      ┆ -1.811423    ┆ 0    ┆ 178          │
│ MASKUSDT     ┆ -1.752787    ┆ 1    ┆ 177          │
│ XMRUSDT      ┆ -1.643325    ┆ 2    ┆ 176          │
│ SUIUSDT      ┆ -1.628171    ┆ 3    ┆ 175          │
│ AMBUSDT      ┆ -1.626199    ┆ 4    ┆ 174          │
│ DYDXUSDT     ┆ -1.618131    ┆ 5    ┆ 173          │
│ STORJUSDT    ┆ -1.576711    ┆ 6    ┆ 172          │
│ JOEUSDT      ┆ -1.544321    ┆ 7    ┆ 171          │
│ FILUSDT      ┆ -1.523271    ┆ 8    ┆ 170          │
│ ATOMUSDT     ┆ -1.483705    ┆ 9    ┆ 169          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ASTRUSDT     ┆ 0.04819      ┆ 169  ┆ 9            │
│ ZECUSDT      ┆ 0.05472      ┆ 170  ┆ 8            │
│ RSRUSDT      ┆ 0.059829     ┆ 171  ┆ 7            │
│ DARUSDT      ┆ 0.067261     ┆ 172  ┆ 6            │
│ CTKUSDT      ┆ 0.309765     ┆ 173  ┆ 5            │
│ DGBUSDT      ┆ 0.326037     ┆ 174  ┆ 4            │
│ SKLUSDT      ┆ 0.395446     ┆ 175  ┆ 3            │
│ CKBUSDT      ┆ 0.470449     ┆ 176  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.775235     ┆ 177  ┆ 1            │
│ DEFIUSDT     ┆ 1.026933     ┆ 178  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:08,181 - WARNING - 2023-10-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:08,181 - INFO - cur close time: 2023-10-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:08,182 - DEBUG - mean expected ret (mean factor): -0.7919499422659881
2024-11-20 23:07:08,187 - DEBUG - begin to update pos: =========
2024-11-20 23:07:08,188 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,188 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.017       ┆ 0.05581     ┆ 0.0006649   ┆ … ┆ 0.01607 ┆ null   ┆ null    ┆ 0.1955  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,197 - DEBUG - update position: 2023-10-09T23:59:59.999 === diff_trading_value: 136698.24131795153 == cash: 151942.35475420256 
2024-11-20 23:07:08,199 - INFO - pnl: 2023-10-09T23:59:59.999 151942.35475420256 === -0.457%
2024-11-20 23:07:08,204 - DEBUG - cur time: 2023-10-10T23:59:59.999 == next bar open time: 2023-10-11T00:00:00.000 == close pos time: 2023-10-18T00:00:00.000
2024-11-20 23:07:08,205 - INFO - pnl: 2023-10-10T23:59:59.999 155469.73410623905 === 2.322%
2024-11-20 23:07:08,210 - DEBUG - cur time: 2023-10-11T23:59:59.999 == next bar open time: 2023-10-12T00:00:00.000 == close pos time: 2023-10-19T00:00:00.000
2024-11-20 23:07:08,213 - INFO - pnl: 2023-10-11T23:59:59.999 155579.50447852246 === 0.071%
2024-11-20 23:07:08,220 - DEBUG - cur time: 2023-10-12T23:59:59.999 == next bar open time: 2023-10-13T00:00:00.000 == close pos time: 2023-10-20T00:00:00.000
2024-11-20 23:07:08,222 - INFO - pnl: 2023-10-12T23:59:59.999 156071.74549136386 === 0.316%
2024-11-20 23:07:08,231 - DEBUG - cur time: 2023-10-13T23:59:59.999 == next bar open time: 2023-10-14T00:00:00.000 == close pos time: 2023-10-21T00:00:00.000
2024-11-20 23:07:08,233 - INFO - pnl: 2023-10-13T23:59:59.999 156511.09176190288 === 0.282%
2024-11-20 23:07:08,240 - DEBUG - cur time: 2023-10-14T23:59:59.999 == next bar open time: 2023-10-15T00:00:00.000 == close pos time: 2023-10-22T00:00:00.000
2024-11-20 23:07:08,246 - INFO - pnl: 2023-10-14T23:59:59.999 156721.8848158481 === 0.135%
2024-11-20 23:07:08,253 - DEBUG - cur time: 2023-10-15T23:59:59.999 == next bar open time: 2023-10-16T00:00:00.000 == close pos time: 2023-10-23T00:00:00.000
2024-11-20 23:07:08,255 - INFO - pnl: 2023-10-15T23:59:59.999 157295.4518949288 === 0.366%
2024-11-20 23:07:08,262 - DEBUG - cur time: 2023-10-16T23:59:59.999 == next bar open time: 2023-10-17T00:00:00.000 == close pos time: 2023-10-24T00:00:00.000
2024-11-20 23:07:08,274 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -1.880652    ┆ 0    ┆ 179          │
│ TRBUSDT      ┆ -1.818766    ┆ 1    ┆ 178          │
│ FILUSDT      ┆ -1.723001    ┆ 2    ┆ 177          │
│ XVSUSDT      ┆ -1.691845    ┆ 3    ┆ 176          │
│ SUIUSDT      ┆ -1.639321    ┆ 4    ┆ 175          │
│ EGLDUSDT     ┆ -1.628603    ┆ 5    ┆ 174          │
│ DYDXUSDT     ┆ -1.59887     ┆ 6    ┆ 173          │
│ RNDRUSDT     ┆ -1.585787    ┆ 7    ┆ 172          │
│ LPTUSDT      ┆ -1.520118    ┆ 8    ┆ 171          │
│ FTMUSDT      ┆ -1.485473    ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CELRUSDT     ┆ 0.030921     ┆ 170  ┆ 9            │
│ DEFIUSDT     ┆ 0.162083     ┆ 171  ┆ 8            │
│ DENTUSDT     ┆ 0.210633     ┆ 172  ┆ 7            │
│ SKLUSDT      ┆ 0.219301     ┆ 173  ┆ 6            │
│ RVNUSDT      ┆ 0.345922     ┆ 174  ┆ 5            │
│ CVXUSDT      ┆ 0.373181     ┆ 175  ┆ 4            │
│ CKBUSDT      ┆ 0.503331     ┆ 176  ┆ 3            │
│ DGBUSDT      ┆ 0.508511     ┆ 177  ┆ 2            │
│ TLMUSDT      ┆ 0.694017     ┆ 178  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.959528     ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:08,288 - INFO - cur close time: 2023-10-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:08,288 - DEBUG - mean expected ret (mean factor): -0.7934848084428215
2024-11-20 23:07:08,294 - DEBUG - begin to update pos: =========
2024-11-20 23:07:08,294 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,295 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01835     ┆ 0.05785     ┆ 0.0006733   ┆ … ┆ 0.01672 ┆ null   ┆ null    ┆ 0.2385  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,305 - DEBUG - update position: 2023-10-16T23:59:59.999 === diff_trading_value: 170516.4964656423 == cash: 157927.43636413658 
2024-11-20 23:07:08,309 - INFO - pnl: 2023-10-16T23:59:59.999 157927.43636413658 === 0.402%
2024-11-20 23:07:08,316 - DEBUG - cur time: 2023-10-17T23:59:59.999 == next bar open time: 2023-10-18T00:00:00.000 == close pos time: 2023-10-25T00:00:00.000
2024-11-20 23:07:08,320 - INFO - pnl: 2023-10-17T23:59:59.999 157936.41114912773 === 0.006%
2024-11-20 23:07:08,324 - DEBUG - cur time: 2023-10-18T23:59:59.999 == next bar open time: 2023-10-19T00:00:00.000 == close pos time: 2023-10-26T00:00:00.000
2024-11-20 23:07:08,326 - INFO - pnl: 2023-10-18T23:59:59.999 156296.58863323933 === -1.038%
2024-11-20 23:07:08,331 - DEBUG - cur time: 2023-10-19T23:59:59.999 == next bar open time: 2023-10-20T00:00:00.000 == close pos time: 2023-10-27T00:00:00.000
2024-11-20 23:07:08,332 - INFO - pnl: 2023-10-19T23:59:59.999 156301.36489703125 === 0.003%
2024-11-20 23:07:08,338 - DEBUG - cur time: 2023-10-20T23:59:59.999 == next bar open time: 2023-10-21T00:00:00.000 == close pos time: 2023-10-28T00:00:00.000
2024-11-20 23:07:08,340 - INFO - pnl: 2023-10-20T23:59:59.999 153964.84503197996 === -1.495%
2024-11-20 23:07:08,345 - DEBUG - cur time: 2023-10-21T23:59:59.999 == next bar open time: 2023-10-22T00:00:00.000 == close pos time: 2023-10-29T00:00:00.000
2024-11-20 23:07:08,346 - INFO - pnl: 2023-10-21T23:59:59.999 154507.23637029305 === 0.352%
2024-11-20 23:07:08,350 - DEBUG - cur time: 2023-10-22T23:59:59.999 == next bar open time: 2023-10-23T00:00:00.000 == close pos time: 2023-10-30T00:00:00.000
2024-11-20 23:07:08,353 - INFO - pnl: 2023-10-22T23:59:59.999 154448.53486793838 === -0.038%
2024-11-20 23:07:08,362 - DEBUG - cur time: 2023-10-23T23:59:59.999 == next bar open time: 2023-10-24T00:00:00.000 == close pos time: 2023-10-31T00:00:00.000
2024-11-20 23:07:08,382 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ KNCUSDT      ┆ -1.956685    ┆ 0    ┆ 179          │
│ APEUSDT      ┆ -1.743854    ┆ 1    ┆ 178          │
│ UNFIUSDT     ┆ -1.700488    ┆ 2    ┆ 177          │
│ DYDXUSDT     ┆ -1.658764    ┆ 3    ┆ 176          │
│ UMAUSDT      ┆ -1.620886    ┆ 4    ┆ 175          │
│ MKRUSDT      ┆ -1.609959    ┆ 5    ┆ 174          │
│ OPUSDT       ┆ -1.570853    ┆ 6    ┆ 173          │
│ BNBUSDT      ┆ -1.553373    ┆ 7    ┆ 172          │
│ XVSUSDT      ┆ -1.5471      ┆ 8    ┆ 171          │
│ TRBUSDT      ┆ -1.529168    ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ASTRUSDT     ┆ 0.090058     ┆ 170  ┆ 9            │
│ COMBOUSDT    ┆ 0.133329     ┆ 171  ┆ 8            │
│ RVNUSDT      ┆ 0.147546     ┆ 172  ┆ 7            │
│ SKLUSDT      ┆ 0.159784     ┆ 173  ┆ 6            │
│ DGBUSDT      ┆ 0.2334       ┆ 174  ┆ 5            │
│ TLMUSDT      ┆ 0.264959     ┆ 175  ┆ 4            │
│ CKBUSDT      ┆ 0.333071     ┆ 176  ┆ 3            │
│ CTKUSDT      ┆ 0.407247     ┆ 177  ┆ 2            │
│ DEFIUSDT     ┆ 0.657665     ┆ 178  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.209853     ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:08,394 - WARNING - 2023-10-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:08,394 - INFO - cur close time: 2023-10-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:08,394 - DEBUG - mean expected ret (mean factor): -0.7787393699973566
2024-11-20 23:07:08,401 - DEBUG - begin to update pos: =========
2024-11-20 23:07:08,401 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,402 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02764     ┆ 0.06031     ┆ 0.0010051   ┆ … ┆ 0.0183  ┆ null   ┆ null    ┆ 0.23    │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,412 - DEBUG - update position: 2023-10-23T23:59:59.999 === diff_trading_value: 232078.04725179198 == cash: 149655.46796054597 
2024-11-20 23:07:08,414 - INFO - pnl: 2023-10-23T23:59:59.999 149655.46796054597 === -3.103%
2024-11-20 23:07:08,418 - DEBUG - cur time: 2023-10-24T23:59:59.999 == next bar open time: 2023-10-25T00:00:00.000 == close pos time: 2023-11-01T00:00:00.000
2024-11-20 23:07:08,421 - INFO - pnl: 2023-10-24T23:59:59.999 146984.14322891954 === -1.785%
2024-11-20 23:07:08,429 - DEBUG - cur time: 2023-10-25T23:59:59.999 == next bar open time: 2023-10-26T00:00:00.000 == close pos time: 2023-11-02T00:00:00.000
2024-11-20 23:07:08,434 - INFO - pnl: 2023-10-25T23:59:59.999 144020.79172484495 === -2.016%
2024-11-20 23:07:08,442 - DEBUG - cur time: 2023-10-26T23:59:59.999 == next bar open time: 2023-10-27T00:00:00.000 == close pos time: 2023-11-03T00:00:00.000
2024-11-20 23:07:08,448 - INFO - pnl: 2023-10-26T23:59:59.999 146190.05193816495 === 1.506%
2024-11-20 23:07:08,458 - DEBUG - cur time: 2023-10-27T23:59:59.999 == next bar open time: 2023-10-28T00:00:00.000 == close pos time: 2023-11-04T00:00:00.000
2024-11-20 23:07:08,463 - INFO - pnl: 2023-10-27T23:59:59.999 145104.7621273261 === -0.742%
2024-11-20 23:07:08,472 - DEBUG - cur time: 2023-10-28T23:59:59.999 == next bar open time: 2023-10-29T00:00:00.000 == close pos time: 2023-11-05T00:00:00.000
2024-11-20 23:07:08,475 - INFO - pnl: 2023-10-28T23:59:59.999 145634.33468533118 === 0.365%
2024-11-20 23:07:08,481 - DEBUG - cur time: 2023-10-29T23:59:59.999 == next bar open time: 2023-10-30T00:00:00.000 == close pos time: 2023-11-06T00:00:00.000
2024-11-20 23:07:08,486 - INFO - pnl: 2023-10-29T23:59:59.999 145820.64604735776 === 0.128%
2024-11-20 23:07:08,494 - DEBUG - cur time: 2023-10-30T23:59:59.999 == next bar open time: 2023-10-31T00:00:00.000 == close pos time: 2023-11-07T00:00:00.000
2024-11-20 23:07:08,509 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AXSUSDT      ┆ -1.687809    ┆ 0    ┆ 179          │
│ BLURUSDT     ┆ -1.681273    ┆ 1    ┆ 178          │
│ UNIUSDT      ┆ -1.634994    ┆ 2    ┆ 177          │
│ MKRUSDT      ┆ -1.630464    ┆ 3    ┆ 176          │
│ BNBUSDT      ┆ -1.620673    ┆ 4    ┆ 175          │
│ LQTYUSDT     ┆ -1.615487    ┆ 5    ┆ 174          │
│ STORJUSDT    ┆ -1.605378    ┆ 6    ┆ 173          │
│ WAVESUSDT    ┆ -1.569837    ┆ 7    ┆ 172          │
│ MASKUSDT     ┆ -1.554816    ┆ 8    ┆ 171          │
│ MAVUSDT      ┆ -1.548788    ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SKLUSDT      ┆ -0.050561    ┆ 170  ┆ 9            │
│ DARUSDT      ┆ 0.053803     ┆ 171  ┆ 8            │
│ QNTUSDT      ┆ 0.068305     ┆ 172  ┆ 7            │
│ DGBUSDT      ┆ 0.182981     ┆ 173  ┆ 6            │
│ CVXUSDT      ┆ 0.218516     ┆ 174  ┆ 5            │
│ CTKUSDT      ┆ 0.283741     ┆ 175  ┆ 4            │
│ RVNUSDT      ┆ 0.302195     ┆ 176  ┆ 3            │
│ CKBUSDT      ┆ 0.877578     ┆ 177  ┆ 2            │
│ DEFIUSDT     ┆ 1.055176     ┆ 178  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.102601     ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:08,521 - WARNING - 2023-10-30T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:08,521 - INFO - cur close time: 2023-10-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:08,521 - DEBUG - mean expected ret (mean factor): -0.7640189568974655
2024-11-20 23:07:08,528 - DEBUG - begin to update pos: =========
2024-11-20 23:07:08,528 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,529 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03597     ┆ 0.06531     ┆ 0.0011725   ┆ … ┆ 0.01934 ┆ null   ┆ null    ┆ 0.2658  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,538 - DEBUG - update position: 2023-10-30T23:59:59.999 === diff_trading_value: 274833.49901691114 == cash: 146253.78290498198 
2024-11-20 23:07:08,539 - INFO - pnl: 2023-10-30T23:59:59.999 146253.78290498198 === 0.297%
2024-11-20 23:07:08,546 - DEBUG - cur time: 2023-10-31T23:59:59.999 == next bar open time: 2023-11-01T00:00:00.000 == close pos time: 2023-11-08T00:00:00.000
2024-11-20 23:07:08,548 - INFO - pnl: 2023-10-31T23:59:59.999 147140.01108997554 === 0.606%
2024-11-20 23:07:08,553 - DEBUG - cur time: 2023-11-01T23:59:59.999 == next bar open time: 2023-11-02T00:00:00.000 == close pos time: 2023-11-09T00:00:00.000
2024-11-20 23:07:08,556 - INFO - pnl: 2023-11-01T23:59:59.999 147376.2415840605 === 0.161%
2024-11-20 23:07:08,561 - DEBUG - cur time: 2023-11-02T23:59:59.999 == next bar open time: 2023-11-03T00:00:00.000 == close pos time: 2023-11-10T00:00:00.000
2024-11-20 23:07:08,564 - INFO - pnl: 2023-11-02T23:59:59.999 145125.5579834489 === -1.527%
2024-11-20 23:07:08,571 - DEBUG - cur time: 2023-11-03T23:59:59.999 == next bar open time: 2023-11-04T00:00:00.000 == close pos time: 2023-11-11T00:00:00.000
2024-11-20 23:07:08,574 - INFO - pnl: 2023-11-03T23:59:59.999 145910.68580854317 === 0.541%
2024-11-20 23:07:08,581 - DEBUG - cur time: 2023-11-04T23:59:59.999 == next bar open time: 2023-11-05T00:00:00.000 == close pos time: 2023-11-12T00:00:00.000
2024-11-20 23:07:08,585 - INFO - pnl: 2023-11-04T23:59:59.999 145783.59997500028 === -0.087%
2024-11-20 23:07:08,593 - DEBUG - cur time: 2023-11-05T23:59:59.999 == next bar open time: 2023-11-06T00:00:00.000 == close pos time: 2023-11-13T00:00:00.000
2024-11-20 23:07:08,598 - INFO - pnl: 2023-11-05T23:59:59.999 147741.54931099896 === 1.343%
2024-11-20 23:07:08,604 - DEBUG - cur time: 2023-11-06T23:59:59.999 == next bar open time: 2023-11-07T00:00:00.000 == close pos time: 2023-11-14T00:00:00.000
2024-11-20 23:07:08,613 - DEBUG - sorted_long_factors: shape: (183, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT      ┆ -1.866197    ┆ 0    ┆ 182          │
│ RNDRUSDT     ┆ -1.777888    ┆ 1    ┆ 181          │
│ OPUSDT       ┆ -1.737565    ┆ 2    ┆ 180          │
│ DASHUSDT     ┆ -1.721285    ┆ 3    ┆ 179          │
│ YFIUSDT      ┆ -1.649483    ┆ 4    ┆ 178          │
│ COMPUSDT     ┆ -1.58597     ┆ 5    ┆ 177          │
│ FILUSDT      ┆ -1.584592    ┆ 6    ┆ 176          │
│ XRPUSDT      ┆ -1.495855    ┆ 7    ┆ 175          │
│ BNBUSDT      ┆ -1.48606     ┆ 8    ┆ 174          │
│ SUIUSDT      ┆ -1.485517    ┆ 9    ┆ 173          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOTXUSDT     ┆ 0.12699      ┆ 173  ┆ 9            │
│ DGBUSDT      ┆ 0.172122     ┆ 174  ┆ 8            │
│ CVXUSDT      ┆ 0.207866     ┆ 175  ┆ 7            │
│ TLMUSDT      ┆ 0.218862     ┆ 176  ┆ 6            │
│ RVNUSDT      ┆ 0.231092     ┆ 177  ┆ 5            │
│ DENTUSDT     ┆ 0.423793     ┆ 178  ┆ 4            │
│ BTCDOMUSDT   ┆ 0.449276     ┆ 179  ┆ 3            │
│ CKBUSDT      ┆ 0.69458      ┆ 180  ┆ 2            │
│ DEFIUSDT     ┆ 1.272147     ┆ 181  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.395186     ┆ 182  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:08,623 - WARNING - 2023-11-06T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:08,623 - INFO - cur close time: 2023-11-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:08,624 - DEBUG - mean expected ret (mean factor): -0.7787227015722483
2024-11-20 23:07:08,631 - DEBUG - begin to update pos: =========
2024-11-20 23:07:08,631 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,631 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03143     ┆ 0.06807     ┆ 0.0012085   ┆ … ┆ 0.02109 ┆ null   ┆ null    ┆ 0.2727  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,647 - DEBUG - update position: 2023-11-06T23:59:59.999 === diff_trading_value: 252332.58492972667 == cash: 148278.05888931316 
2024-11-20 23:07:08,651 - INFO - pnl: 2023-11-06T23:59:59.999 148278.05888931316 === 0.363%
2024-11-20 23:07:08,659 - DEBUG - cur time: 2023-11-07T23:59:59.999 == next bar open time: 2023-11-08T00:00:00.000 == close pos time: 2023-11-15T00:00:00.000
2024-11-20 23:07:08,663 - INFO - pnl: 2023-11-07T23:59:59.999 147713.20006382454 === -0.381%
2024-11-20 23:07:08,669 - DEBUG - cur time: 2023-11-08T23:59:59.999 == next bar open time: 2023-11-09T00:00:00.000 == close pos time: 2023-11-16T00:00:00.000
2024-11-20 23:07:08,671 - INFO - pnl: 2023-11-08T23:59:59.999 149894.0618339079 === 1.476%
2024-11-20 23:07:08,678 - DEBUG - cur time: 2023-11-09T23:59:59.999 == next bar open time: 2023-11-10T00:00:00.000 == close pos time: 2023-11-17T00:00:00.000
2024-11-20 23:07:08,680 - INFO - pnl: 2023-11-09T23:59:59.999 148265.3465511056 === -1.087%
2024-11-20 23:07:08,687 - DEBUG - cur time: 2023-11-10T23:59:59.999 == next bar open time: 2023-11-11T00:00:00.000 == close pos time: 2023-11-18T00:00:00.000
2024-11-20 23:07:08,689 - INFO - pnl: 2023-11-10T23:59:59.999 147068.72967222662 === -0.807%
2024-11-20 23:07:08,697 - DEBUG - cur time: 2023-11-11T23:59:59.999 == next bar open time: 2023-11-12T00:00:00.000 == close pos time: 2023-11-19T00:00:00.000
2024-11-20 23:07:08,699 - INFO - pnl: 2023-11-11T23:59:59.999 145746.64206644514 === -0.899%
2024-11-20 23:07:08,705 - DEBUG - cur time: 2023-11-12T23:59:59.999 == next bar open time: 2023-11-13T00:00:00.000 == close pos time: 2023-11-20T00:00:00.000
2024-11-20 23:07:08,708 - INFO - pnl: 2023-11-12T23:59:59.999 144219.19850574364 === -1.048%
2024-11-20 23:07:08,715 - DEBUG - cur time: 2023-11-13T23:59:59.999 == next bar open time: 2023-11-14T00:00:00.000 == close pos time: 2023-11-21T00:00:00.000
2024-11-20 23:07:08,726 - DEBUG - sorted_long_factors: shape: (183, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT      ┆ -1.71921     ┆ 0    ┆ 182          │
│ MKRUSDT      ┆ -1.610033    ┆ 1    ┆ 181          │
│ FILUSDT      ┆ -1.60619     ┆ 2    ┆ 180          │
│ ARKMUSDT     ┆ -1.578527    ┆ 3    ┆ 179          │
│ UNFIUSDT     ┆ -1.519392    ┆ 4    ┆ 178          │
│ XRPUSDT      ┆ -1.456756    ┆ 5    ┆ 177          │
│ ATOMUSDT     ┆ -1.429267    ┆ 6    ┆ 176          │
│ MATICUSDT    ┆ -1.341499    ┆ 7    ┆ 175          │
│ FXSUSDT      ┆ -1.340523    ┆ 8    ┆ 174          │
│ APTUSDT      ┆ -1.315603    ┆ 9    ┆ 173          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ALPHAUSDT    ┆ -0.137669    ┆ 173  ┆ 9            │
│ BALUSDT      ┆ -0.119037    ┆ 174  ┆ 8            │
│ ATAUSDT      ┆ -0.04795     ┆ 175  ┆ 7            │
│ CVXUSDT      ┆ -0.046653    ┆ 176  ┆ 6            │
│ CKBUSDT      ┆ 0.022605     ┆ 177  ┆ 5            │
│ TRUUSDT      ┆ 0.084618     ┆ 178  ┆ 4            │
│ OMGUSDT      ┆ 0.107259     ┆ 179  ┆ 3            │
│ DGBUSDT      ┆ 0.163419     ┆ 180  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.086008     ┆ 181  ┆ 1            │
│ DEFIUSDT     ┆ 1.712092     ┆ 182  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:08,740 - WARNING - 2023-11-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:08,740 - INFO - cur close time: 2023-11-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:08,740 - DEBUG - mean expected ret (mean factor): -0.7630095285512525
2024-11-20 23:07:08,745 - DEBUG - begin to update pos: =========
2024-11-20 23:07:08,746 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,746 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03386     ┆ 0.07848     ┆ 0.0011635   ┆ … ┆ 0.02181 ┆ null   ┆ null    ┆ 0.5166  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,757 - DEBUG - update position: 2023-11-13T23:59:59.999 === diff_trading_value: 225125.21896484095 == cash: 137940.88384452506 
2024-11-20 23:07:08,759 - INFO - pnl: 2023-11-13T23:59:59.999 137940.88384452506 === -4.353%
2024-11-20 23:07:08,764 - DEBUG - cur time: 2023-11-14T23:59:59.999 == next bar open time: 2023-11-15T00:00:00.000 == close pos time: 2023-11-22T00:00:00.000
2024-11-20 23:07:08,767 - INFO - pnl: 2023-11-14T23:59:59.999 136475.23467204045 === -1.063%
2024-11-20 23:07:08,771 - DEBUG - cur time: 2023-11-15T23:59:59.999 == next bar open time: 2023-11-16T00:00:00.000 == close pos time: 2023-11-23T00:00:00.000
2024-11-20 23:07:08,775 - INFO - pnl: 2023-11-15T23:59:59.999 136400.50043093288 === -0.055%
2024-11-20 23:07:08,783 - DEBUG - cur time: 2023-11-16T23:59:59.999 == next bar open time: 2023-11-17T00:00:00.000 == close pos time: 2023-11-24T00:00:00.000
2024-11-20 23:07:08,785 - INFO - pnl: 2023-11-16T23:59:59.999 138851.8384350648 === 1.797%
2024-11-20 23:07:08,790 - DEBUG - cur time: 2023-11-17T23:59:59.999 == next bar open time: 2023-11-18T00:00:00.000 == close pos time: 2023-11-25T00:00:00.000
2024-11-20 23:07:08,791 - INFO - pnl: 2023-11-17T23:59:59.999 141278.0115180098 === 1.747%
2024-11-20 23:07:08,797 - DEBUG - cur time: 2023-11-18T23:59:59.999 == next bar open time: 2023-11-19T00:00:00.000 == close pos time: 2023-11-26T00:00:00.000
2024-11-20 23:07:08,799 - INFO - pnl: 2023-11-18T23:59:59.999 140347.04945640953 === -0.659%
2024-11-20 23:07:08,803 - DEBUG - cur time: 2023-11-19T23:59:59.999 == next bar open time: 2023-11-20T00:00:00.000 == close pos time: 2023-11-27T00:00:00.000
2024-11-20 23:07:08,805 - INFO - pnl: 2023-11-19T23:59:59.999 140479.4368096595 === 0.094%
2024-11-20 23:07:08,811 - DEBUG - cur time: 2023-11-20T23:59:59.999 == next bar open time: 2023-11-21T00:00:00.000 == close pos time: 2023-11-28T00:00:00.000
2024-11-20 23:07:08,824 - DEBUG - sorted_long_factors: shape: (187, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNTUSDT      ┆ -2.048259    ┆ 0    ┆ 186          │
│ BNBUSDT      ┆ -1.903873    ┆ 1    ┆ 185          │
│ MKRUSDT      ┆ -1.8308      ┆ 2    ┆ 184          │
│ BTCDOMUSDT   ┆ -1.769438    ┆ 3    ┆ 183          │
│ NMRUSDT      ┆ -1.681309    ┆ 4    ┆ 182          │
│ ARKMUSDT     ┆ -1.641118    ┆ 5    ┆ 181          │
│ YFIUSDT      ┆ -1.567817    ┆ 6    ┆ 180          │
│ MASKUSDT     ┆ -1.564762    ┆ 7    ┆ 179          │
│ FETUSDT      ┆ -1.526631    ┆ 8    ┆ 178          │
│ XRPUSDT      ┆ -1.486174    ┆ 9    ┆ 177          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ 0.019559     ┆ 177  ┆ 9            │
│ DENTUSDT     ┆ 0.028525     ┆ 178  ┆ 8            │
│ TRUUSDT      ┆ 0.034421     ┆ 179  ┆ 7            │
│ TLMUSDT      ┆ 0.060222     ┆ 180  ┆ 6            │
│ CTSIUSDT     ┆ 0.077224     ┆ 181  ┆ 5            │
│ CTKUSDT      ┆ 0.120433     ┆ 182  ┆ 4            │
│ CVXUSDT      ┆ 0.132744     ┆ 183  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.625074     ┆ 184  ┆ 2            │
│ IDEXUSDT     ┆ 1.025301     ┆ 185  ┆ 1            │
│ DEFIUSDT     ┆ 1.753907     ┆ 186  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:08,836 - INFO - cur close time: 2023-11-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:08,836 - DEBUG - mean expected ret (mean factor): -0.772055636641747
2024-11-20 23:07:08,841 - DEBUG - begin to update pos: =========
2024-11-20 23:07:08,841 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,841 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03097     ┆ 0.07556     ┆ 0.0011312   ┆ … ┆ 0.0221  ┆ null   ┆ null    ┆ 0.3963  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,849 - DEBUG - update position: 2023-11-20T23:59:59.999 === diff_trading_value: 237521.4138935054 == cash: 144514.7847001349 
2024-11-20 23:07:08,850 - INFO - pnl: 2023-11-20T23:59:59.999 144514.7847001349 === 2.873%
2024-11-20 23:07:08,855 - DEBUG - cur time: 2023-11-21T23:59:59.999 == next bar open time: 2023-11-22T00:00:00.000 == close pos time: 2023-11-29T00:00:00.000
2024-11-20 23:07:08,856 - INFO - pnl: 2023-11-21T23:59:59.999 142490.95262562798 === -1.400%
2024-11-20 23:07:08,861 - DEBUG - cur time: 2023-11-22T23:59:59.999 == next bar open time: 2023-11-23T00:00:00.000 == close pos time: 2023-11-30T00:00:00.000
2024-11-20 23:07:08,863 - INFO - pnl: 2023-11-22T23:59:59.999 142892.77682289356 === 0.282%
2024-11-20 23:07:08,869 - DEBUG - cur time: 2023-11-23T23:59:59.999 == next bar open time: 2023-11-24T00:00:00.000 == close pos time: 2023-12-01T00:00:00.000
2024-11-20 23:07:08,871 - INFO - pnl: 2023-11-23T23:59:59.999 145005.55634955163 === 1.479%
2024-11-20 23:07:08,875 - DEBUG - cur time: 2023-11-24T23:59:59.999 == next bar open time: 2023-11-25T00:00:00.000 == close pos time: 2023-12-02T00:00:00.000
2024-11-20 23:07:08,877 - INFO - pnl: 2023-11-24T23:59:59.999 146301.238847926 === 0.894%
2024-11-20 23:07:08,881 - DEBUG - cur time: 2023-11-25T23:59:59.999 == next bar open time: 2023-11-26T00:00:00.000 == close pos time: 2023-12-03T00:00:00.000
2024-11-20 23:07:08,882 - INFO - pnl: 2023-11-25T23:59:59.999 146500.22505833028 === 0.136%
2024-11-20 23:07:08,887 - DEBUG - cur time: 2023-11-26T23:59:59.999 == next bar open time: 2023-11-27T00:00:00.000 == close pos time: 2023-12-04T00:00:00.000
2024-11-20 23:07:08,888 - INFO - pnl: 2023-11-26T23:59:59.999 149602.6874061446 === 2.118%
2024-11-20 23:07:08,893 - DEBUG - cur time: 2023-11-27T23:59:59.999 == next bar open time: 2023-11-28T00:00:00.000 == close pos time: 2023-12-05T00:00:00.000
2024-11-20 23:07:08,904 - DEBUG - sorted_long_factors: shape: (188, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ YFIUSDT      ┆ -1.933854    ┆ 0    ┆ 187          │
│ BNBUSDT      ┆ -1.847052    ┆ 1    ┆ 186          │
│ BTCDOMUSDT   ┆ -1.73436     ┆ 2    ┆ 185          │
│ SUSHIUSDT    ┆ -1.727481    ┆ 3    ┆ 184          │
│ AXSUSDT      ┆ -1.72057     ┆ 4    ┆ 183          │
│ XVSUSDT      ┆ -1.693716    ┆ 5    ┆ 182          │
│ SEIUSDT      ┆ -1.632538    ┆ 6    ┆ 181          │
│ NEARUSDT     ┆ -1.570171    ┆ 7    ┆ 180          │
│ COMBOUSDT    ┆ -1.503285    ┆ 8    ┆ 179          │
│ APEUSDT      ┆ -1.479137    ┆ 9    ┆ 178          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TUSDT        ┆ -0.024729    ┆ 178  ┆ 9            │
│ BLUEBIRDUSDT ┆ -0.008825    ┆ 179  ┆ 8            │
│ IDEXUSDT     ┆ 0.022204     ┆ 180  ┆ 7            │
│ DENTUSDT     ┆ 0.029345     ┆ 181  ┆ 6            │
│ GMXUSDT      ┆ 0.048985     ┆ 182  ┆ 5            │
│ BALUSDT      ┆ 0.255033     ┆ 183  ┆ 4            │
│ DGBUSDT      ┆ 0.279078     ┆ 184  ┆ 3            │
│ CKBUSDT      ┆ 0.380464     ┆ 185  ┆ 2            │
│ CVXUSDT      ┆ 1.225209     ┆ 186  ┆ 1            │
│ DEFIUSDT     ┆ 2.633894     ┆ 187  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:08,914 - INFO - cur close time: 2023-11-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:08,915 - DEBUG - mean expected ret (mean factor): -0.761069322219342
2024-11-20 23:07:08,920 - DEBUG - begin to update pos: =========
2024-11-20 23:07:08,920 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,921 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03142     ┆ 0.10141     ┆ 0.0010831   ┆ … ┆ 0.02067 ┆ null   ┆ null    ┆ 0.3913  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,928 - DEBUG - update position: 2023-11-27T23:59:59.999 === diff_trading_value: 255589.90758928354 == cash: 148453.5596349451 
2024-11-20 23:07:08,930 - INFO - pnl: 2023-11-27T23:59:59.999 148453.5596349451 === -0.768%
2024-11-20 23:07:08,933 - DEBUG - cur time: 2023-11-28T23:59:59.999 == next bar open time: 2023-11-29T00:00:00.000 == close pos time: 2023-12-06T00:00:00.000
2024-11-20 23:07:08,935 - INFO - pnl: 2023-11-28T23:59:59.999 148742.38281316985 === 0.195%
2024-11-20 23:07:08,940 - DEBUG - cur time: 2023-11-29T23:59:59.999 == next bar open time: 2023-11-30T00:00:00.000 == close pos time: 2023-12-07T00:00:00.000
2024-11-20 23:07:08,941 - INFO - pnl: 2023-11-29T23:59:59.999 151079.5874621004 === 1.571%
2024-11-20 23:07:08,946 - DEBUG - cur time: 2023-11-30T23:59:59.999 == next bar open time: 2023-12-01T00:00:00.000 == close pos time: 2023-12-08T00:00:00.000
2024-11-20 23:07:08,947 - INFO - pnl: 2023-11-30T23:59:59.999 151686.06205299386 === 0.401%
2024-11-20 23:07:08,951 - DEBUG - cur time: 2023-12-01T23:59:59.999 == next bar open time: 2023-12-02T00:00:00.000 == close pos time: 2023-12-09T00:00:00.000
2024-11-20 23:07:08,954 - INFO - pnl: 2023-12-01T23:59:59.999 151701.90785546202 === 0.010%
2024-11-20 23:07:08,959 - DEBUG - cur time: 2023-12-02T23:59:59.999 == next bar open time: 2023-12-03T00:00:00.000 == close pos time: 2023-12-10T00:00:00.000
2024-11-20 23:07:08,961 - INFO - pnl: 2023-12-02T23:59:59.999 151582.4629997797 === -0.079%
2024-11-20 23:07:08,965 - DEBUG - cur time: 2023-12-03T23:59:59.999 == next bar open time: 2023-12-04T00:00:00.000 == close pos time: 2023-12-11T00:00:00.000
2024-11-20 23:07:08,967 - INFO - pnl: 2023-12-03T23:59:59.999 149320.14021113297 === -1.492%
2024-11-20 23:07:08,971 - DEBUG - cur time: 2023-12-04T23:59:59.999 == next bar open time: 2023-12-05T00:00:00.000 == close pos time: 2023-12-12T00:00:00.000
2024-11-20 23:07:08,984 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ EGLDUSDT     ┆ -1.907988    ┆ 0    ┆ 188          │
│ WLDUSDT      ┆ -1.73317     ┆ 1    ┆ 187          │
│ MDTUSDT      ┆ -1.710356    ┆ 2    ┆ 186          │
│ YFIUSDT      ┆ -1.697494    ┆ 3    ┆ 185          │
│ CYBERUSDT    ┆ -1.67078     ┆ 4    ┆ 184          │
│ BNBUSDT      ┆ -1.531977    ┆ 5    ┆ 183          │
│ ATOMUSDT     ┆ -1.527672    ┆ 6    ┆ 182          │
│ UNIUSDT      ┆ -1.516966    ┆ 7    ┆ 181          │
│ HOOKUSDT     ┆ -1.515479    ┆ 8    ┆ 180          │
│ AXSUSDT      ┆ -1.486573    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ GMXUSDT      ┆ 0.046425     ┆ 179  ┆ 9            │
│ FOOTBALLUSDT ┆ 0.084378     ┆ 180  ┆ 8            │
│ ATAUSDT      ┆ 0.119627     ┆ 181  ┆ 7            │
│ TUSDT        ┆ 0.186113     ┆ 182  ┆ 6            │
│ IDEXUSDT     ┆ 0.33587      ┆ 183  ┆ 5            │
│ CVXUSDT      ┆ 0.381242     ┆ 184  ┆ 4            │
│ DGBUSDT      ┆ 0.630817     ┆ 185  ┆ 3            │
│ CKBUSDT      ┆ 0.762258     ┆ 186  ┆ 2            │
│ DEFIUSDT     ┆ 0.883652     ┆ 187  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.062663     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:08,991 - WARNING - 2023-12-04T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:08,992 - INFO - cur close time: 2023-12-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:08,992 - DEBUG - mean expected ret (mean factor): -0.7688810575392362
2024-11-20 23:07:08,997 - DEBUG - begin to update pos: =========
2024-11-20 23:07:08,997 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:08,998 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0374      ┆ 0.25792     ┆ 0.0013954   ┆ … ┆ 0.02263 ┆ null   ┆ null    ┆ 0.4152  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,004 - DEBUG - update position: 2023-12-04T23:59:59.999 === diff_trading_value: 232751.08603017047 == cash: 152308.4156504057 
2024-11-20 23:07:09,006 - INFO - pnl: 2023-12-04T23:59:59.999 152308.4156504057 === 2.001%
2024-11-20 23:07:09,011 - DEBUG - cur time: 2023-12-05T23:59:59.999 == next bar open time: 2023-12-06T00:00:00.000 == close pos time: 2023-12-13T00:00:00.000
2024-11-20 23:07:09,012 - INFO - pnl: 2023-12-05T23:59:59.999 152686.92092578273 === 0.249%
2024-11-20 23:07:09,016 - DEBUG - cur time: 2023-12-06T23:59:59.999 == next bar open time: 2023-12-07T00:00:00.000 == close pos time: 2023-12-14T00:00:00.000
2024-11-20 23:07:09,018 - INFO - pnl: 2023-12-06T23:59:59.999 154918.37200757742 === 1.461%
2024-11-20 23:07:09,023 - DEBUG - cur time: 2023-12-07T23:59:59.999 == next bar open time: 2023-12-08T00:00:00.000 == close pos time: 2023-12-15T00:00:00.000
2024-11-20 23:07:09,024 - INFO - pnl: 2023-12-07T23:59:59.999 153881.34776880514 === -0.669%
2024-11-20 23:07:09,030 - DEBUG - cur time: 2023-12-08T23:59:59.999 == next bar open time: 2023-12-09T00:00:00.000 == close pos time: 2023-12-16T00:00:00.000
2024-11-20 23:07:09,034 - INFO - pnl: 2023-12-08T23:59:59.999 153677.70433719404 === -0.132%
2024-11-20 23:07:09,044 - DEBUG - cur time: 2023-12-09T23:59:59.999 == next bar open time: 2023-12-10T00:00:00.000 == close pos time: 2023-12-17T00:00:00.000
2024-11-20 23:07:09,050 - INFO - pnl: 2023-12-09T23:59:59.999 152278.71931337015 === -0.910%
2024-11-20 23:07:09,061 - DEBUG - cur time: 2023-12-10T23:59:59.999 == next bar open time: 2023-12-11T00:00:00.000 == close pos time: 2023-12-18T00:00:00.000
2024-11-20 23:07:09,066 - INFO - pnl: 2023-12-10T23:59:59.999 150795.1830417427 === -0.974%
2024-11-20 23:07:09,073 - DEBUG - cur time: 2023-12-11T23:59:59.999 == next bar open time: 2023-12-12T00:00:00.000 == close pos time: 2023-12-19T00:00:00.000
2024-11-20 23:07:09,083 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SNXUSDT      ┆ -1.826539    ┆ 0    ┆ 188          │
│ WLDUSDT      ┆ -1.641387    ┆ 1    ┆ 187          │
│ ATOMUSDT     ┆ -1.59761     ┆ 2    ┆ 186          │
│ STORJUSDT    ┆ -1.586845    ┆ 3    ┆ 185          │
│ BNBUSDT      ┆ -1.574947    ┆ 4    ┆ 184          │
│ EOSUSDT      ┆ -1.564414    ┆ 5    ┆ 183          │
│ INJUSDT      ┆ -1.518735    ┆ 6    ┆ 182          │
│ SANDUSDT     ┆ -1.474318    ┆ 7    ┆ 181          │
│ RNDRUSDT     ┆ -1.447348    ┆ 8    ┆ 180          │
│ UNIUSDT      ┆ -1.441497    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DUSKUSDT     ┆ -0.089998    ┆ 179  ┆ 9            │
│ UNFIUSDT     ┆ -0.023943    ┆ 180  ┆ 8            │
│ MKRUSDT      ┆ 0.004423     ┆ 181  ┆ 7            │
│ TRUUSDT      ┆ 0.03798      ┆ 182  ┆ 6            │
│ ARUSDT       ┆ 0.056153     ┆ 183  ┆ 5            │
│ DGBUSDT      ┆ 0.138454     ┆ 184  ┆ 4            │
│ CVXUSDT      ┆ 0.282521     ┆ 185  ┆ 3            │
│ CKBUSDT      ┆ 0.445611     ┆ 186  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.210028     ┆ 187  ┆ 1            │
│ DEFIUSDT     ┆ 1.597444     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:09,091 - WARNING - 2023-12-11T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:09,091 - INFO - cur close time: 2023-12-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:09,091 - DEBUG - mean expected ret (mean factor): -0.7738865498298227
2024-11-20 23:07:09,096 - DEBUG - begin to update pos: =========
2024-11-20 23:07:09,096 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,097 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03695     ┆ 0.17706     ┆ 0.0014128   ┆ … ┆ 0.02241 ┆ null   ┆ null    ┆ 0.3798  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,109 - DEBUG - update position: 2023-12-11T23:59:59.999 === diff_trading_value: 245099.1269766878 == cash: 151056.1915434648 
2024-11-20 23:07:09,110 - INFO - pnl: 2023-12-11T23:59:59.999 151056.1915434648 === 0.173%
2024-11-20 23:07:09,115 - DEBUG - cur time: 2023-12-12T23:59:59.999 == next bar open time: 2023-12-13T00:00:00.000 == close pos time: 2023-12-20T00:00:00.000
2024-11-20 23:07:09,117 - INFO - pnl: 2023-12-12T23:59:59.999 148444.64085099375 === -1.729%
2024-11-20 23:07:09,122 - DEBUG - cur time: 2023-12-13T23:59:59.999 == next bar open time: 2023-12-14T00:00:00.000 == close pos time: 2023-12-21T00:00:00.000
2024-11-20 23:07:09,124 - INFO - pnl: 2023-12-13T23:59:59.999 146373.03105950804 === -1.396%
2024-11-20 23:07:09,129 - DEBUG - cur time: 2023-12-14T23:59:59.999 == next bar open time: 2023-12-15T00:00:00.000 == close pos time: 2023-12-22T00:00:00.000
2024-11-20 23:07:09,131 - INFO - pnl: 2023-12-14T23:59:59.999 145642.62588684715 === -0.499%
2024-11-20 23:07:09,138 - DEBUG - cur time: 2023-12-15T23:59:59.999 == next bar open time: 2023-12-16T00:00:00.000 == close pos time: 2023-12-23T00:00:00.000
2024-11-20 23:07:09,141 - INFO - pnl: 2023-12-15T23:59:59.999 145578.98939204204 === -0.044%
2024-11-20 23:07:09,145 - DEBUG - cur time: 2023-12-16T23:59:59.999 == next bar open time: 2023-12-17T00:00:00.000 == close pos time: 2023-12-24T00:00:00.000
2024-11-20 23:07:09,147 - INFO - pnl: 2023-12-16T23:59:59.999 141991.63023817283 === -2.464%
2024-11-20 23:07:09,151 - DEBUG - cur time: 2023-12-17T23:59:59.999 == next bar open time: 2023-12-18T00:00:00.000 == close pos time: 2023-12-25T00:00:00.000
2024-11-20 23:07:09,154 - INFO - pnl: 2023-12-17T23:59:59.999 137634.10355500615 === -3.069%
2024-11-20 23:07:09,160 - DEBUG - cur time: 2023-12-18T23:59:59.999 == next bar open time: 2023-12-19T00:00:00.000 == close pos time: 2023-12-26T00:00:00.000
2024-11-20 23:07:09,174 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XVSUSDT      ┆ -1.759696    ┆ 0    ┆ 188          │
│ FILUSDT      ┆ -1.734299    ┆ 1    ┆ 187          │
│ BNBUSDT      ┆ -1.585034    ┆ 2    ┆ 186          │
│ RUNEUSDT     ┆ -1.514051    ┆ 3    ┆ 185          │
│ STXUSDT      ┆ -1.449919    ┆ 4    ┆ 184          │
│ BTCDOMUSDT   ┆ -1.448659    ┆ 5    ┆ 183          │
│ MASKUSDT     ┆ -1.435379    ┆ 6    ┆ 182          │
│ SANDUSDT     ┆ -1.396598    ┆ 7    ┆ 181          │
│ DOTUSDT      ┆ -1.386498    ┆ 8    ┆ 180          │
│ NEARUSDT     ┆ -1.363549    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DODOXUSDT    ┆ 0.05301      ┆ 179  ┆ 9            │
│ XVGUSDT      ┆ 0.116595     ┆ 180  ┆ 8            │
│ TRUUSDT      ┆ 0.130621     ┆ 181  ┆ 7            │
│ IDEXUSDT     ┆ 0.149212     ┆ 182  ┆ 6            │
│ DUSKUSDT     ┆ 0.184215     ┆ 183  ┆ 5            │
│ CVXUSDT      ┆ 0.248024     ┆ 184  ┆ 4            │
│ DGBUSDT      ┆ 0.358067     ┆ 185  ┆ 3            │
│ CKBUSDT      ┆ 0.822862     ┆ 186  ┆ 2            │
│ DEFIUSDT     ┆ 0.900928     ┆ 187  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.302948     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:09,185 - WARNING - 2023-12-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:09,185 - INFO - cur close time: 2023-12-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:09,185 - DEBUG - mean expected ret (mean factor): -0.7644380466887415
2024-11-20 23:07:09,190 - DEBUG - begin to update pos: =========
2024-11-20 23:07:09,191 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,191 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03529     ┆ 0.15132     ┆ 0.0013067   ┆ … ┆ 0.02259 ┆ null   ┆ null    ┆ 0.3685  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,198 - DEBUG - update position: 2023-12-18T23:59:59.999 === diff_trading_value: 282053.78492973564 == cash: 134755.92171809878 
2024-11-20 23:07:09,200 - INFO - pnl: 2023-12-18T23:59:59.999 134755.92171809878 === -2.091%
2024-11-20 23:07:09,205 - DEBUG - cur time: 2023-12-19T23:59:59.999 == next bar open time: 2023-12-20T00:00:00.000 == close pos time: 2023-12-27T00:00:00.000
2024-11-20 23:07:09,207 - INFO - pnl: 2023-12-19T23:59:59.999 133209.6136887491 === -1.147%
2024-11-20 23:07:09,213 - DEBUG - cur time: 2023-12-20T23:59:59.999 == next bar open time: 2023-12-21T00:00:00.000 == close pos time: 2023-12-28T00:00:00.000
2024-11-20 23:07:09,217 - INFO - pnl: 2023-12-20T23:59:59.999 132165.80782295743 === -0.784%
2024-11-20 23:07:09,222 - DEBUG - cur time: 2023-12-21T23:59:59.999 == next bar open time: 2023-12-22T00:00:00.000 == close pos time: 2023-12-29T00:00:00.000
2024-11-20 23:07:09,225 - INFO - pnl: 2023-12-21T23:59:59.999 128025.69181042678 === -3.133%
2024-11-20 23:07:09,230 - DEBUG - cur time: 2023-12-22T23:59:59.999 == next bar open time: 2023-12-23T00:00:00.000 == close pos time: 2023-12-30T00:00:00.000
2024-11-20 23:07:09,233 - INFO - pnl: 2023-12-22T23:59:59.999 134516.06733151997 === 5.070%
2024-11-20 23:07:09,238 - DEBUG - cur time: 2023-12-23T23:59:59.999 == next bar open time: 2023-12-24T00:00:00.000 == close pos time: 2023-12-31T00:00:00.000
2024-11-20 23:07:09,240 - INFO - pnl: 2023-12-23T23:59:59.999 131372.29236883856 === -2.337%
2024-11-20 23:07:09,248 - DEBUG - cur time: 2023-12-24T23:59:59.999 == next bar open time: 2023-12-25T00:00:00.000 == close pos time: 2024-01-01T00:00:00.000
2024-11-20 23:07:09,251 - INFO - pnl: 2023-12-24T23:59:59.999 133880.18843046547 === 1.909%
2024-11-20 23:07:09,261 - DEBUG - cur time: 2023-12-25T23:59:59.999 == next bar open time: 2023-12-26T00:00:00.000 == close pos time: 2024-01-02T00:00:00.000
2024-11-20 23:07:09,271 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CYBERUSDT    ┆ -1.967561    ┆ 0    ┆ 188          │
│ COMPUSDT     ┆ -1.838145    ┆ 1    ┆ 187          │
│ EGLDUSDT     ┆ -1.787502    ┆ 2    ┆ 186          │
│ APTUSDT      ┆ -1.623608    ┆ 3    ┆ 185          │
│ UNIUSDT      ┆ -1.594597    ┆ 4    ┆ 184          │
│ ATOMUSDT     ┆ -1.57295     ┆ 5    ┆ 183          │
│ WLDUSDT      ┆ -1.536643    ┆ 6    ┆ 182          │
│ DOTUSDT      ┆ -1.532421    ┆ 7    ┆ 181          │
│ SANDUSDT     ┆ -1.519074    ┆ 8    ┆ 180          │
│ KSMUSDT      ┆ -1.518569    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ KEYUSDT      ┆ 0.076233     ┆ 179  ┆ 9            │
│ DUSKUSDT     ┆ 0.114086     ┆ 180  ┆ 8            │
│ COTIUSDT     ┆ 0.128565     ┆ 181  ┆ 7            │
│ TLMUSDT      ┆ 0.22099      ┆ 182  ┆ 6            │
│ DEFIUSDT     ┆ 0.225912     ┆ 183  ┆ 5            │
│ BTCDOMUSDT   ┆ 0.40714      ┆ 184  ┆ 4            │
│ CKBUSDT      ┆ 0.419481     ┆ 185  ┆ 3            │
│ CVXUSDT      ┆ 0.448979     ┆ 186  ┆ 2            │
│ DGBUSDT      ┆ 0.625912     ┆ 187  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.847091     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:09,281 - WARNING - 2023-12-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:09,281 - INFO - cur close time: 2023-12-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:09,281 - DEBUG - mean expected ret (mean factor): -0.7786945091645753
2024-11-20 23:07:09,286 - DEBUG - begin to update pos: =========
2024-11-20 23:07:09,287 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,287 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03741     ┆ 0.15954     ┆ 0.0014078   ┆ … ┆ 0.02671 ┆ null   ┆ null    ┆ 0.368   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,299 - DEBUG - update position: 2023-12-25T23:59:59.999 === diff_trading_value: 249616.54924872305 == cash: 130386.37828910197 
2024-11-20 23:07:09,303 - INFO - pnl: 2023-12-25T23:59:59.999 130386.37828910197 === -2.610%
2024-11-20 23:07:09,309 - DEBUG - cur time: 2023-12-26T23:59:59.999 == next bar open time: 2023-12-27T00:00:00.000 == close pos time: 2024-01-03T00:00:00.000
2024-11-20 23:07:09,314 - INFO - pnl: 2023-12-26T23:59:59.999 134076.31383128118 === 2.830%
2024-11-20 23:07:09,321 - DEBUG - cur time: 2023-12-27T23:59:59.999 == next bar open time: 2023-12-28T00:00:00.000 == close pos time: 2024-01-04T00:00:00.000
2024-11-20 23:07:09,325 - INFO - pnl: 2023-12-27T23:59:59.999 136729.329835524 === 1.979%
2024-11-20 23:07:09,331 - DEBUG - cur time: 2023-12-28T23:59:59.999 == next bar open time: 2023-12-29T00:00:00.000 == close pos time: 2024-01-05T00:00:00.000
2024-11-20 23:07:09,334 - INFO - pnl: 2023-12-28T23:59:59.999 135867.03679688007 === -0.631%
2024-11-20 23:07:09,340 - DEBUG - cur time: 2023-12-29T23:59:59.999 == next bar open time: 2023-12-30T00:00:00.000 == close pos time: 2024-01-06T00:00:00.000
2024-11-20 23:07:09,344 - INFO - pnl: 2023-12-29T23:59:59.999 135723.45275051676 === -0.106%
2024-11-20 23:07:09,351 - DEBUG - cur time: 2023-12-30T23:59:59.999 == next bar open time: 2023-12-31T00:00:00.000 == close pos time: 2024-01-07T00:00:00.000
2024-11-20 23:07:09,354 - INFO - pnl: 2023-12-30T23:59:59.999 135341.25005601638 === -0.282%
2024-11-20 23:07:09,361 - DEBUG - cur time: 2023-12-31T23:59:59.999 == next bar open time: 2024-01-01T00:00:00.000 == close pos time: 2024-01-08T00:00:00.000
2024-11-20 23:07:09,366 - INFO - pnl: 2023-12-31T23:59:59.999 136229.60723405366 === 0.656%
2024-11-20 23:07:09,375 - DEBUG - cur time: 2024-01-01T23:59:59.999 == next bar open time: 2024-01-02T00:00:00.000 == close pos time: 2024-01-09T00:00:00.000
2024-11-20 23:07:09,395 - DEBUG - sorted_long_factors: shape: (191, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ NMRUSDT      ┆ -1.91492     ┆ 0    ┆ 190          │
│ CYBERUSDT    ┆ -1.685037    ┆ 1    ┆ 189          │
│ DYDXUSDT     ┆ -1.677241    ┆ 2    ┆ 188          │
│ INJUSDT      ┆ -1.626762    ┆ 3    ┆ 187          │
│ RNDRUSDT     ┆ -1.610167    ┆ 4    ┆ 186          │
│ UNFIUSDT     ┆ -1.605897    ┆ 5    ┆ 185          │
│ AAVEUSDT     ┆ -1.600376    ┆ 6    ┆ 184          │
│ RUNEUSDT     ┆ -1.590155    ┆ 7    ┆ 183          │
│ STORJUSDT    ┆ -1.582542    ┆ 8    ┆ 182          │
│ ATOMUSDT     ┆ -1.574699    ┆ 9    ┆ 181          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TLMUSDT      ┆ 0.052591     ┆ 181  ┆ 9            │
│ SPELLUSDT    ┆ 0.093235     ┆ 182  ┆ 8            │
│ BTCDOMUSDT   ┆ 0.15101      ┆ 183  ┆ 7            │
│ RVNUSDT      ┆ 0.15274      ┆ 184  ┆ 6            │
│ COMBOUSDT    ┆ 0.279796     ┆ 185  ┆ 5            │
│ DGBUSDT      ┆ 0.322604     ┆ 186  ┆ 4            │
│ NKNUSDT      ┆ 0.334767     ┆ 187  ┆ 3            │
│ TUSDT        ┆ 0.341741     ┆ 188  ┆ 2            │
│ CKBUSDT      ┆ 0.430164     ┆ 189  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.243966     ┆ 190  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:09,409 - INFO - cur close time: 2024-01-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:09,410 - DEBUG - mean expected ret (mean factor): -0.7965631985899068
2024-11-20 23:07:09,415 - DEBUG - begin to update pos: =========
2024-11-20 23:07:09,415 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,415 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03669     ┆ 0.14458     ┆ 0.0014067   ┆ … ┆ 0.02563 ┆ null   ┆ null    ┆ 0.3743  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,426 - DEBUG - update position: 2024-01-01T23:59:59.999 === diff_trading_value: 253828.169835965 == cash: 134307.079960678 
2024-11-20 23:07:09,428 - INFO - pnl: 2024-01-01T23:59:59.999 134307.079960678 === -1.411%
2024-11-20 23:07:09,437 - DEBUG - cur time: 2024-01-02T23:59:59.999 == next bar open time: 2024-01-03T00:00:00.000 == close pos time: 2024-01-10T00:00:00.000
2024-11-20 23:07:09,441 - INFO - pnl: 2024-01-02T23:59:59.999 133929.99935780326 === -0.281%
2024-11-20 23:07:09,455 - DEBUG - cur time: 2024-01-03T23:59:59.999 == next bar open time: 2024-01-04T00:00:00.000 == close pos time: 2024-01-11T00:00:00.000
2024-11-20 23:07:09,461 - INFO - pnl: 2024-01-03T23:59:59.999 134560.7987200905 === 0.471%
2024-11-20 23:07:09,471 - DEBUG - cur time: 2024-01-04T23:59:59.999 == next bar open time: 2024-01-05T00:00:00.000 == close pos time: 2024-01-12T00:00:00.000
2024-11-20 23:07:09,473 - INFO - pnl: 2024-01-04T23:59:59.999 133920.52811165823 === -0.476%
2024-11-20 23:07:09,490 - DEBUG - cur time: 2024-01-05T23:59:59.999 == next bar open time: 2024-01-06T00:00:00.000 == close pos time: 2024-01-13T00:00:00.000
2024-11-20 23:07:09,494 - INFO - pnl: 2024-01-05T23:59:59.999 134637.12265411823 === 0.535%
2024-11-20 23:07:09,505 - DEBUG - cur time: 2024-01-06T23:59:59.999 == next bar open time: 2024-01-07T00:00:00.000 == close pos time: 2024-01-14T00:00:00.000
2024-11-20 23:07:09,510 - INFO - pnl: 2024-01-06T23:59:59.999 133521.42840439585 === -0.829%
2024-11-20 23:07:09,516 - DEBUG - cur time: 2024-01-07T23:59:59.999 == next bar open time: 2024-01-08T00:00:00.000 == close pos time: 2024-01-15T00:00:00.000
2024-11-20 23:07:09,520 - INFO - pnl: 2024-01-07T23:59:59.999 134366.30862873787 === 0.633%
2024-11-20 23:07:09,528 - DEBUG - cur time: 2024-01-08T23:59:59.999 == next bar open time: 2024-01-09T00:00:00.000 == close pos time: 2024-01-16T00:00:00.000
2024-11-20 23:07:09,546 - DEBUG - sorted_long_factors: shape: (193, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CYBERUSDT    ┆ -2.164349    ┆ 0    ┆ 192          │
│ TRBUSDT      ┆ -1.984104    ┆ 1    ┆ 191          │
│ WLDUSDT      ┆ -1.867554    ┆ 2    ┆ 190          │
│ FILUSDT      ┆ -1.862365    ┆ 3    ┆ 189          │
│ BNBUSDT      ┆ -1.828937    ┆ 4    ┆ 188          │
│ YGGUSDT      ┆ -1.824137    ┆ 5    ┆ 187          │
│ MKRUSDT      ┆ -1.79054     ┆ 6    ┆ 186          │
│ SUIUSDT      ┆ -1.698535    ┆ 7    ┆ 185          │
│ GMXUSDT      ┆ -1.662838    ┆ 8    ┆ 184          │
│ ARBUSDT      ┆ -1.659398    ┆ 9    ┆ 183          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ALICEUSDT    ┆ 0.198147     ┆ 183  ┆ 9            │
│ TLMUSDT      ┆ 0.214508     ┆ 184  ┆ 8            │
│ CVXUSDT      ┆ 0.234694     ┆ 185  ┆ 7            │
│ SPELLUSDT    ┆ 0.261405     ┆ 186  ┆ 6            │
│ KLAYUSDT     ┆ 0.325862     ┆ 187  ┆ 5            │
│ IDEXUSDT     ┆ 0.530373     ┆ 188  ┆ 4            │
│ DARUSDT      ┆ 0.544689     ┆ 189  ┆ 3            │
│ DGBUSDT      ┆ 0.642026     ┆ 190  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.675726     ┆ 191  ┆ 1            │
│ CKBUSDT      ┆ 0.968891     ┆ 192  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:09,562 - WARNING - 2024-01-08T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:09,562 - INFO - cur close time: 2024-01-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:09,563 - DEBUG - mean expected ret (mean factor): -0.7614829924171121
2024-11-20 23:07:09,571 - DEBUG - begin to update pos: =========
2024-11-20 23:07:09,573 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,574 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03049     ┆ 0.12337     ┆ 0.0011943   ┆ … ┆ 0.02205 ┆ null   ┆ null    ┆ 0.3236  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,591 - DEBUG - update position: 2024-01-08T23:59:59.999 === diff_trading_value: 249326.7278452895 == cash: 134371.69745005947 
2024-11-20 23:07:09,594 - INFO - pnl: 2024-01-08T23:59:59.999 134371.69745005947 === 0.004%
2024-11-20 23:07:09,600 - DEBUG - cur time: 2024-01-09T23:59:59.999 == next bar open time: 2024-01-10T00:00:00.000 == close pos time: 2024-01-17T00:00:00.000
2024-11-20 23:07:09,603 - INFO - pnl: 2024-01-09T23:59:59.999 133755.34762125218 === -0.459%
2024-11-20 23:07:09,609 - DEBUG - cur time: 2024-01-10T23:59:59.999 == next bar open time: 2024-01-11T00:00:00.000 == close pos time: 2024-01-18T00:00:00.000
2024-11-20 23:07:09,612 - INFO - pnl: 2024-01-10T23:59:59.999 134206.32362113026 === 0.337%
2024-11-20 23:07:09,617 - DEBUG - cur time: 2024-01-11T23:59:59.999 == next bar open time: 2024-01-12T00:00:00.000 == close pos time: 2024-01-19T00:00:00.000
2024-11-20 23:07:09,619 - INFO - pnl: 2024-01-11T23:59:59.999 130419.14022338207 === -2.822%
2024-11-20 23:07:09,625 - DEBUG - cur time: 2024-01-12T23:59:59.999 == next bar open time: 2024-01-13T00:00:00.000 == close pos time: 2024-01-20T00:00:00.000
2024-11-20 23:07:09,628 - INFO - pnl: 2024-01-12T23:59:59.999 126115.53166582451 === -3.300%
2024-11-20 23:07:09,633 - DEBUG - cur time: 2024-01-13T23:59:59.999 == next bar open time: 2024-01-14T00:00:00.000 == close pos time: 2024-01-21T00:00:00.000
2024-11-20 23:07:09,637 - INFO - pnl: 2024-01-13T23:59:59.999 126314.92321656378 === 0.158%
2024-11-20 23:07:09,641 - DEBUG - cur time: 2024-01-14T23:59:59.999 == next bar open time: 2024-01-15T00:00:00.000 == close pos time: 2024-01-22T00:00:00.000
2024-11-20 23:07:09,643 - INFO - pnl: 2024-01-14T23:59:59.999 126620.69857834026 === 0.242%
2024-11-20 23:07:09,646 - DEBUG - cur time: 2024-01-15T23:59:59.999 == next bar open time: 2024-01-16T00:00:00.000 == close pos time: 2024-01-23T00:00:00.000
2024-11-20 23:07:09,655 - DEBUG - sorted_long_factors: shape: (193, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT      ┆ -2.312862    ┆ 0    ┆ 192          │
│ WLDUSDT      ┆ -1.956318    ┆ 1    ┆ 191          │
│ BTCDOMUSDT   ┆ -1.944068    ┆ 2    ┆ 190          │
│ INJUSDT      ┆ -1.77785     ┆ 3    ┆ 189          │
│ BNBUSDT      ┆ -1.776998    ┆ 4    ┆ 188          │
│ AXSUSDT      ┆ -1.729495    ┆ 5    ┆ 187          │
│ LDOUSDT      ┆ -1.715687    ┆ 6    ┆ 186          │
│ CYBERUSDT    ┆ -1.687063    ┆ 7    ┆ 185          │
│ GMTUSDT      ┆ -1.677626    ┆ 8    ┆ 184          │
│ JOEUSDT      ┆ -1.674324    ┆ 9    ┆ 183          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COTIUSDT     ┆ 0.408133     ┆ 183  ┆ 9            │
│ TLMUSDT      ┆ 0.420676     ┆ 184  ┆ 8            │
│ SPELLUSDT    ┆ 0.537246     ┆ 185  ┆ 7            │
│ CKBUSDT      ┆ 0.635829     ┆ 186  ┆ 6            │
│ IDEXUSDT     ┆ 0.667853     ┆ 187  ┆ 5            │
│ COMBOUSDT    ┆ 0.673411     ┆ 188  ┆ 4            │
│ DODOXUSDT    ┆ 0.686371     ┆ 189  ┆ 3            │
│ DEFIUSDT     ┆ 0.687903     ┆ 190  ┆ 2            │
│ DGBUSDT      ┆ 0.691026     ┆ 191  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.114229     ┆ 192  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:09,663 - WARNING - 2024-01-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:09,663 - INFO - cur close time: 2024-01-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:09,664 - DEBUG - mean expected ret (mean factor): -0.7332545048647413
2024-11-20 23:07:09,668 - DEBUG - begin to update pos: =========
2024-11-20 23:07:09,669 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,669 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03071     ┆ 0.12262     ┆ 0.0012045   ┆ … ┆ 0.02171 ┆ null   ┆ null    ┆ 0.3376  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,675 - DEBUG - update position: 2024-01-15T23:59:59.999 === diff_trading_value: 235139.90403957298 == cash: 122497.6437356849 
2024-11-20 23:07:09,676 - INFO - pnl: 2024-01-15T23:59:59.999 122497.6437356849 === -3.256%
2024-11-20 23:07:09,680 - DEBUG - cur time: 2024-01-16T23:59:59.999 == next bar open time: 2024-01-17T00:00:00.000 == close pos time: 2024-01-24T00:00:00.000
2024-11-20 23:07:09,681 - INFO - pnl: 2024-01-16T23:59:59.999 123208.47123958507 === 0.580%
2024-11-20 23:07:09,686 - DEBUG - cur time: 2024-01-17T23:59:59.999 == next bar open time: 2024-01-18T00:00:00.000 == close pos time: 2024-01-25T00:00:00.000
2024-11-20 23:07:09,688 - INFO - pnl: 2024-01-17T23:59:59.999 122074.22749400044 === -0.921%
2024-11-20 23:07:09,692 - DEBUG - cur time: 2024-01-18T23:59:59.999 == next bar open time: 2024-01-19T00:00:00.000 == close pos time: 2024-01-26T00:00:00.000
2024-11-20 23:07:09,695 - INFO - pnl: 2024-01-18T23:59:59.999 122772.22009394031 === 0.572%
2024-11-20 23:07:09,700 - DEBUG - cur time: 2024-01-19T23:59:59.999 == next bar open time: 2024-01-20T00:00:00.000 == close pos time: 2024-01-27T00:00:00.000
2024-11-20 23:07:09,702 - INFO - pnl: 2024-01-19T23:59:59.999 123678.35329876104 === 0.738%
2024-11-20 23:07:09,706 - DEBUG - cur time: 2024-01-20T23:59:59.999 == next bar open time: 2024-01-21T00:00:00.000 == close pos time: 2024-01-28T00:00:00.000
2024-11-20 23:07:09,709 - INFO - pnl: 2024-01-20T23:59:59.999 125645.6359174152 === 1.591%
2024-11-20 23:07:09,713 - DEBUG - cur time: 2024-01-21T23:59:59.999 == next bar open time: 2024-01-22T00:00:00.000 == close pos time: 2024-01-29T00:00:00.000
2024-11-20 23:07:09,715 - INFO - pnl: 2024-01-21T23:59:59.999 125776.23930246591 === 0.104%
2024-11-20 23:07:09,719 - DEBUG - cur time: 2024-01-22T23:59:59.999 == next bar open time: 2024-01-23T00:00:00.000 == close pos time: 2024-01-30T00:00:00.000
2024-11-20 23:07:09,728 - DEBUG - sorted_long_factors: shape: (196, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT   ┆ -1.844581    ┆ 0    ┆ 195          │
│ CFXUSDT      ┆ -1.7404      ┆ 1    ┆ 194          │
│ APEUSDT      ┆ -1.59776     ┆ 2    ┆ 193          │
│ ARKMUSDT     ┆ -1.472249    ┆ 3    ┆ 192          │
│ ASTRUSDT     ┆ -1.41913     ┆ 4    ┆ 191          │
│ LOOMUSDT     ┆ -1.418122    ┆ 5    ┆ 190          │
│ SEIUSDT      ┆ -1.406479    ┆ 6    ┆ 189          │
│ TRBUSDT      ┆ -1.390452    ┆ 7    ┆ 188          │
│ PENDLEUSDT   ┆ -1.382325    ┆ 8    ┆ 187          │
│ BLURUSDT     ┆ -1.379351    ┆ 9    ┆ 186          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ANTUSDT      ┆ 0.081102     ┆ 186  ┆ 9            │
│ TRUUSDT      ┆ 0.130538     ┆ 187  ┆ 8            │
│ SFPUSDT      ┆ 0.194199     ┆ 188  ┆ 7            │
│ DODOXUSDT    ┆ 0.33165      ┆ 189  ┆ 6            │
│ TLMUSDT      ┆ 0.337768     ┆ 190  ┆ 5            │
│ DASHUSDT     ┆ 0.378113     ┆ 191  ┆ 4            │
│ CTKUSDT      ┆ 0.382047     ┆ 192  ┆ 3            │
│ DGBUSDT      ┆ 0.525105     ┆ 193  ┆ 2            │
│ DEFIUSDT     ┆ 0.541394     ┆ 194  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.237221     ┆ 195  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:09,738 - WARNING - 2024-01-22T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:09,738 - INFO - cur close time: 2024-01-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:09,738 - DEBUG - mean expected ret (mean factor): -0.7499603066095967
2024-11-20 23:07:09,744 - DEBUG - begin to update pos: =========
2024-11-20 23:07:09,744 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,744 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02888     ┆ 0.09774     ┆ 0.0010547   ┆ … ┆ 0.02031 ┆ null   ┆ null    ┆ 0.2996  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,751 - DEBUG - update position: 2024-01-22T23:59:59.999 === diff_trading_value: 230903.7204624693 == cash: 125203.11249429357 
2024-11-20 23:07:09,752 - INFO - pnl: 2024-01-22T23:59:59.999 125203.11249429357 === -0.456%
2024-11-20 23:07:09,755 - DEBUG - cur time: 2024-01-23T23:59:59.999 == next bar open time: 2024-01-24T00:00:00.000 == close pos time: 2024-01-31T00:00:00.000
2024-11-20 23:07:09,758 - INFO - pnl: 2024-01-23T23:59:59.999 121230.44975384387 === -3.173%
2024-11-20 23:07:09,762 - DEBUG - cur time: 2024-01-24T23:59:59.999 == next bar open time: 2024-01-25T00:00:00.000 == close pos time: 2024-02-01T00:00:00.000
2024-11-20 23:07:09,764 - INFO - pnl: 2024-01-24T23:59:59.999 120118.61114289882 === -0.917%
2024-11-20 23:07:09,769 - DEBUG - cur time: 2024-01-25T23:59:59.999 == next bar open time: 2024-01-26T00:00:00.000 == close pos time: 2024-02-02T00:00:00.000
2024-11-20 23:07:09,771 - INFO - pnl: 2024-01-25T23:59:59.999 121856.06516053101 === 1.446%
2024-11-20 23:07:09,777 - DEBUG - cur time: 2024-01-26T23:59:59.999 == next bar open time: 2024-01-27T00:00:00.000 == close pos time: 2024-02-03T00:00:00.000
2024-11-20 23:07:09,780 - INFO - pnl: 2024-01-26T23:59:59.999 118342.33766261075 === -2.884%
2024-11-20 23:07:09,784 - DEBUG - cur time: 2024-01-27T23:59:59.999 == next bar open time: 2024-01-28T00:00:00.000 == close pos time: 2024-02-04T00:00:00.000
2024-11-20 23:07:09,786 - INFO - pnl: 2024-01-27T23:59:59.999 120165.18129906205 === 1.540%
2024-11-20 23:07:09,789 - DEBUG - cur time: 2024-01-28T23:59:59.999 == next bar open time: 2024-01-29T00:00:00.000 == close pos time: 2024-02-05T00:00:00.000
2024-11-20 23:07:09,791 - INFO - pnl: 2024-01-28T23:59:59.999 119659.90877297356 === -0.420%
2024-11-20 23:07:09,795 - DEBUG - cur time: 2024-01-29T23:59:59.999 == next bar open time: 2024-01-30T00:00:00.000 == close pos time: 2024-02-06T00:00:00.000
2024-11-20 23:07:09,809 - DEBUG - sorted_long_factors: shape: (201, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ OMGUSDT      ┆ -1.78638     ┆ 0    ┆ 200          │
│ BANDUSDT     ┆ -1.753068    ┆ 1    ┆ 199          │
│ XMRUSDT      ┆ -1.663535    ┆ 2    ┆ 198          │
│ BONDUSDT     ┆ -1.625964    ┆ 3    ┆ 197          │
│ NMRUSDT      ┆ -1.554165    ┆ 4    ┆ 196          │
│ ARUSDT       ┆ -1.548714    ┆ 5    ┆ 195          │
│ INJUSDT      ┆ -1.522363    ┆ 6    ┆ 194          │
│ CFXUSDT      ┆ -1.516779    ┆ 7    ┆ 193          │
│ COMPUSDT     ┆ -1.508435    ┆ 8    ┆ 192          │
│ ARKUSDT      ┆ -1.502611    ┆ 9    ┆ 191          │
│ …            ┆ …            ┆ …    ┆ …            │
│ QNTUSDT      ┆ 0.03027      ┆ 191  ┆ 9            │
│ RVNUSDT      ┆ 0.058337     ┆ 192  ┆ 8            │
│ TLMUSDT      ┆ 0.073091     ┆ 193  ┆ 7            │
│ TRUUSDT      ┆ 0.083414     ┆ 194  ┆ 6            │
│ KEYUSDT      ┆ 0.26317      ┆ 195  ┆ 5            │
│ CKBUSDT      ┆ 0.337085     ┆ 196  ┆ 4            │
│ DEFIUSDT     ┆ 0.537299     ┆ 197  ┆ 3            │
│ DGBUSDT      ┆ 0.575683     ┆ 198  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.112196     ┆ 199  ┆ 1            │
│ DODOXUSDT    ┆ 1.112301     ┆ 200  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:09,818 - WARNING - 2024-01-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:09,819 - INFO - cur close time: 2024-01-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:09,819 - DEBUG - mean expected ret (mean factor): -0.7758379543536524
2024-11-20 23:07:09,824 - DEBUG - begin to update pos: =========
2024-11-20 23:07:09,824 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,824 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02917     ┆ 0.10114     ┆ 0.0010647   ┆ … ┆ 0.02086 ┆ null   ┆ null    ┆ 0.3465  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,834 - DEBUG - update position: 2024-01-29T23:59:59.999 === diff_trading_value: 296080.64757148514 == cash: 116727.89311791933 
2024-11-20 23:07:09,837 - INFO - pnl: 2024-01-29T23:59:59.999 116727.89311791933 === -2.450%
2024-11-20 23:07:09,842 - DEBUG - cur time: 2024-01-30T23:59:59.999 == next bar open time: 2024-01-31T00:00:00.000 == close pos time: 2024-02-07T00:00:00.000
2024-11-20 23:07:09,845 - INFO - pnl: 2024-01-30T23:59:59.999 117854.41031597498 === 0.965%
2024-11-20 23:07:09,854 - DEBUG - cur time: 2024-01-31T23:59:59.999 == next bar open time: 2024-02-01T00:00:00.000 == close pos time: 2024-02-08T00:00:00.000
2024-11-20 23:07:09,856 - INFO - pnl: 2024-01-31T23:59:59.999 118332.8150448751 === 0.406%
2024-11-20 23:07:09,861 - DEBUG - cur time: 2024-02-01T23:59:59.999 == next bar open time: 2024-02-02T00:00:00.000 == close pos time: 2024-02-09T00:00:00.000
2024-11-20 23:07:09,863 - INFO - pnl: 2024-02-01T23:59:59.999 118281.36074401253 === -0.043%
2024-11-20 23:07:09,870 - DEBUG - cur time: 2024-02-02T23:59:59.999 == next bar open time: 2024-02-03T00:00:00.000 == close pos time: 2024-02-10T00:00:00.000
2024-11-20 23:07:09,872 - INFO - pnl: 2024-02-02T23:59:59.999 116280.28149844095 === -1.692%
2024-11-20 23:07:09,884 - DEBUG - cur time: 2024-02-03T23:59:59.999 == next bar open time: 2024-02-04T00:00:00.000 == close pos time: 2024-02-11T00:00:00.000
2024-11-20 23:07:09,887 - INFO - pnl: 2024-02-03T23:59:59.999 116552.80129634196 === 0.234%
2024-11-20 23:07:09,894 - DEBUG - cur time: 2024-02-04T23:59:59.999 == next bar open time: 2024-02-05T00:00:00.000 == close pos time: 2024-02-12T00:00:00.000
2024-11-20 23:07:09,897 - INFO - pnl: 2024-02-04T23:59:59.999 114639.77439719505 === -1.641%
2024-11-20 23:07:09,902 - DEBUG - cur time: 2024-02-05T23:59:59.999 == next bar open time: 2024-02-06T00:00:00.000 == close pos time: 2024-02-13T00:00:00.000
2024-11-20 23:07:09,914 - DEBUG - sorted_long_factors: shape: (205, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT      ┆ -2.104006    ┆ 0    ┆ 204          │
│ UMAUSDT      ┆ -2.083374    ┆ 1    ┆ 203          │
│ OPUSDT       ┆ -2.030087    ┆ 2    ┆ 202          │
│ TRBUSDT      ┆ -1.729828    ┆ 3    ┆ 201          │
│ BSVUSDT      ┆ -1.700423    ┆ 4    ┆ 200          │
│ RLCUSDT      ┆ -1.698043    ┆ 5    ┆ 199          │
│ GASUSDT      ┆ -1.696978    ┆ 6    ┆ 198          │
│ NMRUSDT      ┆ -1.646143    ┆ 7    ┆ 197          │
│ INJUSDT      ┆ -1.601621    ┆ 8    ┆ 196          │
│ XEMUSDT      ┆ -1.596831    ┆ 9    ┆ 195          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RVNUSDT      ┆ 0.188104     ┆ 195  ┆ 9            │
│ TRUUSDT      ┆ 0.198995     ┆ 196  ┆ 8            │
│ KEYUSDT      ┆ 0.206739     ┆ 197  ┆ 7            │
│ BELUSDT      ┆ 0.229803     ┆ 198  ┆ 6            │
│ TLMUSDT      ┆ 0.290452     ┆ 199  ┆ 5            │
│ BICOUSDT     ┆ 0.486041     ┆ 200  ┆ 4            │
│ DGBUSDT      ┆ 0.614593     ┆ 201  ┆ 3            │
│ IDEXUSDT     ┆ 0.621516     ┆ 202  ┆ 2            │
│ DODOXUSDT    ┆ 1.039302     ┆ 203  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.336755     ┆ 204  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:09,924 - WARNING - 2024-02-05T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:09,924 - INFO - cur close time: 2024-02-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:09,924 - DEBUG - mean expected ret (mean factor): -0.7803300299737382
2024-11-20 23:07:09,930 - DEBUG - begin to update pos: =========
2024-11-20 23:07:09,931 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,931 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02742     ┆ 0.11086     ┆ 0.0008981   ┆ … ┆ 0.01984 ┆ null   ┆ null    ┆ 0.3135  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:09,937 - DEBUG - update position: 2024-02-05T23:59:59.999 === diff_trading_value: 236017.4748765524 == cash: 114777.27136644778 
2024-11-20 23:07:09,938 - INFO - pnl: 2024-02-05T23:59:59.999 114777.27136644778 === 0.120%
2024-11-20 23:07:09,943 - DEBUG - cur time: 2024-02-06T23:59:59.999 == next bar open time: 2024-02-07T00:00:00.000 == close pos time: 2024-02-14T00:00:00.000
2024-11-20 23:07:09,945 - INFO - pnl: 2024-02-06T23:59:59.999 116455.76178896238 === 1.462%
2024-11-20 23:07:09,948 - DEBUG - cur time: 2024-02-07T23:59:59.999 == next bar open time: 2024-02-08T00:00:00.000 == close pos time: 2024-02-15T00:00:00.000
2024-11-20 23:07:09,951 - INFO - pnl: 2024-02-07T23:59:59.999 117029.2162486594 === 0.492%
2024-11-20 23:07:09,955 - DEBUG - cur time: 2024-02-08T23:59:59.999 == next bar open time: 2024-02-09T00:00:00.000 == close pos time: 2024-02-16T00:00:00.000
2024-11-20 23:07:09,957 - INFO - pnl: 2024-02-08T23:59:59.999 118226.0763227827 === 1.023%
2024-11-20 23:07:09,963 - DEBUG - cur time: 2024-02-09T23:59:59.999 == next bar open time: 2024-02-10T00:00:00.000 == close pos time: 2024-02-17T00:00:00.000
2024-11-20 23:07:09,966 - INFO - pnl: 2024-02-09T23:59:59.999 119388.12838687307 === 0.983%
2024-11-20 23:07:09,971 - DEBUG - cur time: 2024-02-10T23:59:59.999 == next bar open time: 2024-02-11T00:00:00.000 == close pos time: 2024-02-18T00:00:00.000
2024-11-20 23:07:09,974 - INFO - pnl: 2024-02-10T23:59:59.999 120265.83534864696 === 0.735%
2024-11-20 23:07:09,982 - DEBUG - cur time: 2024-02-11T23:59:59.999 == next bar open time: 2024-02-12T00:00:00.000 == close pos time: 2024-02-19T00:00:00.000
2024-11-20 23:07:09,987 - INFO - pnl: 2024-02-11T23:59:59.999 119125.28421251159 === -0.948%
2024-11-20 23:07:09,993 - DEBUG - cur time: 2024-02-12T23:59:59.999 == next bar open time: 2024-02-13T00:00:00.000 == close pos time: 2024-02-20T00:00:00.000
2024-11-20 23:07:10,005 - DEBUG - sorted_long_factors: shape: (212, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ NMRUSDT      ┆ -1.951909    ┆ 0    ┆ 211          │
│ MASKUSDT     ┆ -1.856536    ┆ 1    ┆ 210          │
│ BSVUSDT      ┆ -1.851232    ┆ 2    ┆ 209          │
│ INJUSDT      ┆ -1.704591    ┆ 3    ┆ 208          │
│ WLDUSDT      ┆ -1.65308     ┆ 4    ┆ 207          │
│ DOTUSDT      ┆ -1.645666    ┆ 5    ┆ 206          │
│ APTUSDT      ┆ -1.644769    ┆ 6    ┆ 205          │
│ FILUSDT      ┆ -1.642343    ┆ 7    ┆ 204          │
│ DYDXUSDT     ┆ -1.637758    ┆ 8    ┆ 203          │
│ TIAUSDT      ┆ -1.614365    ┆ 9    ┆ 202          │
│ …            ┆ …            ┆ …    ┆ …            │
│ KEYUSDT      ┆ 0.289781     ┆ 202  ┆ 9            │
│ NKNUSDT      ┆ 0.306423     ┆ 203  ┆ 8            │
│ DENTUSDT     ┆ 0.354623     ┆ 204  ┆ 7            │
│ ATAUSDT      ┆ 0.531267     ┆ 205  ┆ 6            │
│ COMBOUSDT    ┆ 0.806035     ┆ 206  ┆ 5            │
│ DODOXUSDT    ┆ 0.821061     ┆ 207  ┆ 4            │
│ DEFIUSDT     ┆ 0.892374     ┆ 208  ┆ 3            │
│ XVGUSDT      ┆ 0.945031     ┆ 209  ┆ 2            │
│ DGBUSDT      ┆ 1.033392     ┆ 210  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.232516     ┆ 211  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:10,014 - WARNING - 2024-02-12T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:10,014 - INFO - cur close time: 2024-02-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:10,015 - DEBUG - mean expected ret (mean factor): -0.7600946625476801
2024-11-20 23:07:10,020 - DEBUG - begin to update pos: =========
2024-11-20 23:07:10,021 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,021 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03205     ┆ 0.11723     ┆ 0.0010807   ┆ … ┆ 0.02153 ┆ null   ┆ null    ┆ 0.3284  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,030 - DEBUG - update position: 2024-02-12T23:59:59.999 === diff_trading_value: 224384.78017163867 == cash: 117075.63444665974 
2024-11-20 23:07:10,031 - INFO - pnl: 2024-02-12T23:59:59.999 117075.63444665974 === -1.721%
2024-11-20 23:07:10,039 - DEBUG - cur time: 2024-02-13T23:59:59.999 == next bar open time: 2024-02-14T00:00:00.000 == close pos time: 2024-02-21T00:00:00.000
2024-11-20 23:07:10,042 - INFO - pnl: 2024-02-13T23:59:59.999 119122.61698498885 === 1.748%
2024-11-20 23:07:10,051 - DEBUG - cur time: 2024-02-14T23:59:59.999 == next bar open time: 2024-02-15T00:00:00.000 == close pos time: 2024-02-22T00:00:00.000
2024-11-20 23:07:10,055 - INFO - pnl: 2024-02-14T23:59:59.999 121469.58317343952 === 1.970%
2024-11-20 23:07:10,061 - DEBUG - cur time: 2024-02-15T23:59:59.999 == next bar open time: 2024-02-16T00:00:00.000 == close pos time: 2024-02-23T00:00:00.000
2024-11-20 23:07:10,064 - INFO - pnl: 2024-02-15T23:59:59.999 123524.70784668083 === 1.692%
2024-11-20 23:07:10,071 - DEBUG - cur time: 2024-02-16T23:59:59.999 == next bar open time: 2024-02-17T00:00:00.000 == close pos time: 2024-02-24T00:00:00.000
2024-11-20 23:07:10,073 - INFO - pnl: 2024-02-16T23:59:59.999 120496.3566638412 === -2.452%
2024-11-20 23:07:10,079 - DEBUG - cur time: 2024-02-17T23:59:59.999 == next bar open time: 2024-02-18T00:00:00.000 == close pos time: 2024-02-25T00:00:00.000
2024-11-20 23:07:10,081 - INFO - pnl: 2024-02-17T23:59:59.999 118190.55025730704 === -1.914%
2024-11-20 23:07:10,086 - DEBUG - cur time: 2024-02-18T23:59:59.999 == next bar open time: 2024-02-19T00:00:00.000 == close pos time: 2024-02-26T00:00:00.000
2024-11-20 23:07:10,089 - INFO - pnl: 2024-02-18T23:59:59.999 113877.03850163388 === -3.650%
2024-11-20 23:07:10,096 - DEBUG - cur time: 2024-02-19T23:59:59.999 == next bar open time: 2024-02-20T00:00:00.000 == close pos time: 2024-02-27T00:00:00.000
2024-11-20 23:07:10,117 - DEBUG - sorted_long_factors: shape: (216, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CYBERUSDT    ┆ -1.838298    ┆ 0    ┆ 215          │
│ ICPUSDT      ┆ -1.751224    ┆ 1    ┆ 214          │
│ BSVUSDT      ┆ -1.687723    ┆ 2    ┆ 213          │
│ OPUSDT       ┆ -1.64053     ┆ 3    ┆ 212          │
│ APTUSDT      ┆ -1.629827    ┆ 4    ┆ 211          │
│ DOTUSDT      ┆ -1.625437    ┆ 5    ┆ 210          │
│ YFIUSDT      ┆ -1.592194    ┆ 6    ┆ 209          │
│ KSMUSDT      ┆ -1.54643     ┆ 7    ┆ 208          │
│ TRBUSDT      ┆ -1.534566    ┆ 8    ┆ 207          │
│ ORDIUSDT     ┆ -1.469906    ┆ 9    ┆ 206          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DENTUSDT     ┆ -0.060694    ┆ 206  ┆ 9            │
│ REEFUSDT     ┆ -0.022911    ┆ 207  ┆ 8            │
│ TLMUSDT      ┆ 0.028038     ┆ 208  ┆ 7            │
│ COMBOUSDT    ┆ 0.081401     ┆ 209  ┆ 6            │
│ XVGUSDT      ┆ 0.103899     ┆ 210  ┆ 5            │
│ CVXUSDT      ┆ 0.106205     ┆ 211  ┆ 4            │
│ ATAUSDT      ┆ 0.164465     ┆ 212  ┆ 3            │
│ DGBUSDT      ┆ 0.469928     ┆ 213  ┆ 2            │
│ DEFIUSDT     ┆ 1.26896      ┆ 214  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.593957     ┆ 215  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:10,134 - WARNING - 2024-02-19T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:10,135 - INFO - cur close time: 2024-02-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:10,135 - DEBUG - mean expected ret (mean factor): -0.7834299632680164
2024-11-20 23:07:10,141 - DEBUG - begin to update pos: =========
2024-11-20 23:07:10,141 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,141 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03532     ┆ 0.12914     ┆ 0.0012316   ┆ … ┆ 0.02434 ┆ null   ┆ null    ┆ 0.3661  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,152 - DEBUG - update position: 2024-02-19T23:59:59.999 === diff_trading_value: 269935.3536936585 == cash: 107722.43860155877 
2024-11-20 23:07:10,154 - INFO - pnl: 2024-02-19T23:59:59.999 107722.43860155877 === -5.405%
2024-11-20 23:07:10,161 - DEBUG - cur time: 2024-02-20T23:59:59.999 == next bar open time: 2024-02-21T00:00:00.000 == close pos time: 2024-02-28T00:00:00.000
2024-11-20 23:07:10,163 - INFO - pnl: 2024-02-20T23:59:59.999 111991.38090704045 === 3.963%
2024-11-20 23:07:10,170 - DEBUG - cur time: 2024-02-21T23:59:59.999 == next bar open time: 2024-02-22T00:00:00.000 == close pos time: 2024-02-29T00:00:00.000
2024-11-20 23:07:10,175 - INFO - pnl: 2024-02-21T23:59:59.999 117124.56298529089 === 4.584%
2024-11-20 23:07:10,186 - DEBUG - cur time: 2024-02-22T23:59:59.999 == next bar open time: 2024-02-23T00:00:00.000 == close pos time: 2024-03-01T00:00:00.000
2024-11-20 23:07:10,189 - INFO - pnl: 2024-02-22T23:59:59.999 119804.95519719437 === 2.288%
2024-11-20 23:07:10,197 - DEBUG - cur time: 2024-02-23T23:59:59.999 == next bar open time: 2024-02-24T00:00:00.000 == close pos time: 2024-03-02T00:00:00.000
2024-11-20 23:07:10,201 - INFO - pnl: 2024-02-23T23:59:59.999 120012.80025574478 === 0.173%
2024-11-20 23:07:10,207 - DEBUG - cur time: 2024-02-24T23:59:59.999 == next bar open time: 2024-02-25T00:00:00.000 == close pos time: 2024-03-03T00:00:00.000
2024-11-20 23:07:10,210 - INFO - pnl: 2024-02-24T23:59:59.999 123127.42617592934 === 2.595%
2024-11-20 23:07:10,214 - DEBUG - cur time: 2024-02-25T23:59:59.999 == next bar open time: 2024-02-26T00:00:00.000 == close pos time: 2024-03-04T00:00:00.000
2024-11-20 23:07:10,216 - INFO - pnl: 2024-02-25T23:59:59.999 126742.25348464085 === 2.936%
2024-11-20 23:07:10,220 - DEBUG - cur time: 2024-02-26T23:59:59.999 == next bar open time: 2024-02-27T00:00:00.000 == close pos time: 2024-03-05T00:00:00.000
2024-11-20 23:07:10,231 - DEBUG - sorted_long_factors: shape: (220, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ APEUSDT       ┆ -1.835295    ┆ 0    ┆ 219          │
│ APTUSDT       ┆ -1.818104    ┆ 1    ┆ 218          │
│ TRBUSDT       ┆ -1.807687    ┆ 2    ┆ 217          │
│ TIAUSDT       ┆ -1.749984    ┆ 3    ┆ 216          │
│ EOSUSDT       ┆ -1.728777    ┆ 4    ┆ 215          │
│ SEIUSDT       ┆ -1.67824     ┆ 5    ┆ 214          │
│ ICPUSDT       ┆ -1.650316    ┆ 6    ┆ 213          │
│ API3USDT      ┆ -1.584157    ┆ 7    ┆ 212          │
│ DOTUSDT       ┆ -1.574829    ┆ 8    ┆ 211          │
│ OPUSDT        ┆ -1.571233    ┆ 9    ┆ 210          │
│ …             ┆ …            ┆ …    ┆ …            │
│ CTKUSDT       ┆ 0.109398     ┆ 210  ┆ 9            │
│ XVGUSDT       ┆ 0.115208     ┆ 211  ┆ 8            │
│ REEFUSDT      ┆ 0.13547      ┆ 212  ┆ 7            │
│ RSRUSDT       ┆ 0.155731     ┆ 213  ┆ 6            │
│ TLMUSDT       ┆ 0.180939     ┆ 214  ┆ 5            │
│ 1000FLOKIUSDT ┆ 0.242411     ┆ 215  ┆ 4            │
│ DGBUSDT       ┆ 0.451355     ┆ 216  ┆ 3            │
│ DEFIUSDT      ┆ 0.935525     ┆ 217  ┆ 2            │
│ BTCDOMUSDT    ┆ 1.070512     ┆ 218  ┆ 1            │
│ BLUEBIRDUSDT  ┆ 2.242152     ┆ 219  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:10,242 - INFO - cur close time: 2024-02-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:10,243 - DEBUG - mean expected ret (mean factor): -0.7695539880705606
2024-11-20 23:07:10,247 - DEBUG - begin to update pos: =========
2024-11-20 23:07:10,248 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 5000.0      ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,248 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.04337     ┆ 0.12922     ┆ 0.00181     ┆ … ┆ 0.02601 ┆ null   ┆ null    ┆ 0.3731  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,258 - DEBUG - update position: 2024-02-26T23:59:59.999 === diff_trading_value: 203554.86989784235 == cash: 129415.24909637611 
2024-11-20 23:07:10,261 - INFO - pnl: 2024-02-26T23:59:59.999 129415.24909637611 === 2.109%
2024-11-20 23:07:10,266 - DEBUG - cur time: 2024-02-27T23:59:59.999 == next bar open time: 2024-02-28T00:00:00.000 == close pos time: 2024-03-06T00:00:00.000
2024-11-20 23:07:10,270 - INFO - pnl: 2024-02-27T23:59:59.999 130645.06026231594 === 0.950%
2024-11-20 23:07:10,274 - DEBUG - cur time: 2024-02-28T23:59:59.999 == next bar open time: 2024-02-29T00:00:00.000 == close pos time: 2024-03-07T00:00:00.000
2024-11-20 23:07:10,277 - INFO - pnl: 2024-02-28T23:59:59.999 133737.36971725884 === 2.367%
2024-11-20 23:07:10,281 - DEBUG - cur time: 2024-02-29T23:59:59.999 == next bar open time: 2024-03-01T00:00:00.000 == close pos time: 2024-03-08T00:00:00.000
2024-11-20 23:07:10,286 - INFO - pnl: 2024-02-29T23:59:59.999 134571.16521883896 === 0.623%
2024-11-20 23:07:10,292 - DEBUG - cur time: 2024-03-01T23:59:59.999 == next bar open time: 2024-03-02T00:00:00.000 == close pos time: 2024-03-09T00:00:00.000
2024-11-20 23:07:10,294 - INFO - pnl: 2024-03-01T23:59:59.999 142521.44484107243 === 5.908%
2024-11-20 23:07:10,300 - DEBUG - cur time: 2024-03-02T23:59:59.999 == next bar open time: 2024-03-03T00:00:00.000 == close pos time: 2024-03-10T00:00:00.000
2024-11-20 23:07:10,302 - INFO - pnl: 2024-03-02T23:59:59.999 147119.80747743504 === 3.226%
2024-11-20 23:07:10,307 - DEBUG - cur time: 2024-03-03T23:59:59.999 == next bar open time: 2024-03-04T00:00:00.000 == close pos time: 2024-03-11T00:00:00.000
2024-11-20 23:07:10,309 - INFO - pnl: 2024-03-03T23:59:59.999 151447.48451049984 === 2.942%
2024-11-20 23:07:10,315 - DEBUG - cur time: 2024-03-04T23:59:59.999 == next bar open time: 2024-03-05T00:00:00.000 == close pos time: 2024-03-12T00:00:00.000
2024-11-20 23:07:10,326 - DEBUG - sorted_long_factors: shape: (222, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT     ┆ -2.131265    ┆ 0    ┆ 221          │
│ ICPUSDT      ┆ -1.861003    ┆ 1    ┆ 220          │
│ MKRUSDT      ┆ -1.857713    ┆ 2    ┆ 219          │
│ BNBUSDT      ┆ -1.835929    ┆ 3    ┆ 218          │
│ AXSUSDT      ┆ -1.758627    ┆ 4    ┆ 217          │
│ BSVUSDT      ┆ -1.634902    ┆ 5    ┆ 216          │
│ GASUSDT      ┆ -1.619248    ┆ 6    ┆ 215          │
│ APEUSDT      ┆ -1.606722    ┆ 7    ┆ 214          │
│ WAVESUSDT    ┆ -1.606205    ┆ 8    ┆ 213          │
│ RUNEUSDT     ┆ -1.599798    ┆ 9    ┆ 212          │
│ …            ┆ …            ┆ …    ┆ …            │
│ MDTUSDT      ┆ -0.069799    ┆ 212  ┆ 9            │
│ DGBUSDT      ┆ 0.034749     ┆ 213  ┆ 8            │
│ BALUSDT      ┆ 0.042123     ┆ 214  ┆ 7            │
│ COMBOUSDT    ┆ 0.066865     ┆ 215  ┆ 6            │
│ CTKUSDT      ┆ 0.070109     ┆ 216  ┆ 5            │
│ DODOXUSDT    ┆ 0.247561     ┆ 217  ┆ 4            │
│ OXTUSDT      ┆ 0.425721     ┆ 218  ┆ 3            │
│ FOOTBALLUSDT ┆ 0.494644     ┆ 219  ┆ 2            │
│ DEFIUSDT     ┆ 1.300824     ┆ 220  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.078761     ┆ 221  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:10,335 - WARNING - 2024-03-04T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:10,335 - INFO - cur close time: 2024-03-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:10,336 - DEBUG - mean expected ret (mean factor): -0.7718658897292998
2024-11-20 23:07:10,340 - DEBUG - begin to update pos: =========
2024-11-20 23:07:10,341 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,341 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.03773     ┆ 0.14442     ┆ 0.18382     ┆ 0.0070293   ┆ … ┆ 0.03231 ┆ null   ┆ null    ┆ 0.4431  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,347 - DEBUG - update position: 2024-03-04T23:59:59.999 === diff_trading_value: 309100.9138429962 == cash: 154253.68763524736 
2024-11-20 23:07:10,348 - INFO - pnl: 2024-03-04T23:59:59.999 154253.68763524736 === 1.853%
2024-11-20 23:07:10,353 - DEBUG - cur time: 2024-03-05T23:59:59.999 == next bar open time: 2024-03-06T00:00:00.000 == close pos time: 2024-03-13T00:00:00.000
2024-11-20 23:07:10,356 - INFO - pnl: 2024-03-05T23:59:59.999 155611.72075978984 === 0.880%
2024-11-20 23:07:10,362 - DEBUG - cur time: 2024-03-06T23:59:59.999 == next bar open time: 2024-03-07T00:00:00.000 == close pos time: 2024-03-14T00:00:00.000
2024-11-20 23:07:10,364 - INFO - pnl: 2024-03-06T23:59:59.999 160298.37700586452 === 3.012%
2024-11-20 23:07:10,371 - DEBUG - cur time: 2024-03-07T23:59:59.999 == next bar open time: 2024-03-08T00:00:00.000 == close pos time: 2024-03-15T00:00:00.000
2024-11-20 23:07:10,373 - INFO - pnl: 2024-03-07T23:59:59.999 158370.69945919947 === -1.203%
2024-11-20 23:07:10,380 - DEBUG - cur time: 2024-03-08T23:59:59.999 == next bar open time: 2024-03-09T00:00:00.000 == close pos time: 2024-03-16T00:00:00.000
2024-11-20 23:07:10,382 - INFO - pnl: 2024-03-08T23:59:59.999 157294.02125321858 === -0.680%
2024-11-20 23:07:10,389 - DEBUG - cur time: 2024-03-09T23:59:59.999 == next bar open time: 2024-03-10T00:00:00.000 == close pos time: 2024-03-17T00:00:00.000
2024-11-20 23:07:10,392 - INFO - pnl: 2024-03-09T23:59:59.999 155038.71259896382 === -1.434%
2024-11-20 23:07:10,397 - DEBUG - cur time: 2024-03-10T23:59:59.999 == next bar open time: 2024-03-11T00:00:00.000 == close pos time: 2024-03-18T00:00:00.000
2024-11-20 23:07:10,400 - INFO - pnl: 2024-03-10T23:59:59.999 151043.15175717807 === -2.577%
2024-11-20 23:07:10,406 - DEBUG - cur time: 2024-03-11T23:59:59.999 == next bar open time: 2024-03-12T00:00:00.000 == close pos time: 2024-03-19T00:00:00.000
2024-11-20 23:07:10,419 - DEBUG - sorted_long_factors: shape: (225, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT     ┆ -2.416292    ┆ 0    ┆ 224          │
│ STXUSDT      ┆ -1.916527    ┆ 1    ┆ 223          │
│ GASUSDT      ┆ -1.838314    ┆ 2    ┆ 222          │
│ CAKEUSDT     ┆ -1.720452    ┆ 3    ┆ 221          │
│ APEUSDT      ┆ -1.648906    ┆ 4    ┆ 220          │
│ WLDUSDT      ┆ -1.604932    ┆ 5    ┆ 219          │
│ POWRUSDT     ┆ -1.592375    ┆ 6    ┆ 218          │
│ TIAUSDT      ┆ -1.573209    ┆ 7    ┆ 217          │
│ MTLUSDT      ┆ -1.504959    ┆ 8    ┆ 216          │
│ EGLDUSDT     ┆ -1.497809    ┆ 9    ┆ 215          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RENUSDT      ┆ -0.032216    ┆ 215  ┆ 9            │
│ ONGUSDT      ┆ -0.008646    ┆ 216  ┆ 8            │
│ BALUSDT      ┆ 0.081236     ┆ 217  ┆ 7            │
│ COMBOUSDT    ┆ 0.08444      ┆ 218  ┆ 6            │
│ DGBUSDT      ┆ 0.10506      ┆ 219  ┆ 5            │
│ AGIXUSDT     ┆ 0.118621     ┆ 220  ┆ 4            │
│ ANTUSDT      ┆ 0.229992     ┆ 221  ┆ 3            │
│ IDEXUSDT     ┆ 0.872828     ┆ 222  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.890026     ┆ 223  ┆ 1            │
│ DEFIUSDT     ┆ 1.957178     ┆ 224  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:10,427 - WARNING - 2024-03-11T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:10,427 - INFO - cur close time: 2024-03-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:10,427 - DEBUG - mean expected ret (mean factor): -0.7768845998983054
2024-11-20 23:07:10,436 - DEBUG - begin to update pos: =========
2024-11-20 23:07:10,437 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,437 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.031094    ┆ 0.29836     ┆ 0.19238     ┆ 0.0090522   ┆ … ┆ 0.03789 ┆ null   ┆ null    ┆ 0.8273  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,452 - DEBUG - update position: 2024-03-11T23:59:59.999 === diff_trading_value: 272485.36339279904 == cash: 153405.17291368695 
2024-11-20 23:07:10,455 - INFO - pnl: 2024-03-11T23:59:59.999 153405.17291368695 === 1.564%
2024-11-20 23:07:10,461 - DEBUG - cur time: 2024-03-12T23:59:59.999 == next bar open time: 2024-03-13T00:00:00.000 == close pos time: 2024-03-20T00:00:00.000
2024-11-20 23:07:10,464 - INFO - pnl: 2024-03-12T23:59:59.999 152028.3969327603 === -0.897%
2024-11-20 23:07:10,472 - DEBUG - cur time: 2024-03-13T23:59:59.999 == next bar open time: 2024-03-14T00:00:00.000 == close pos time: 2024-03-21T00:00:00.000
2024-11-20 23:07:10,475 - INFO - pnl: 2024-03-13T23:59:59.999 152262.72547246533 === 0.154%
2024-11-20 23:07:10,483 - DEBUG - cur time: 2024-03-14T23:59:59.999 == next bar open time: 2024-03-15T00:00:00.000 == close pos time: 2024-03-22T00:00:00.000
2024-11-20 23:07:10,485 - INFO - pnl: 2024-03-14T23:59:59.999 152350.28829578357 === 0.058%
2024-11-20 23:07:10,490 - DEBUG - cur time: 2024-03-15T23:59:59.999 == next bar open time: 2024-03-16T00:00:00.000 == close pos time: 2024-03-23T00:00:00.000
2024-11-20 23:07:10,492 - INFO - pnl: 2024-03-15T23:59:59.999 156606.1957211139 === 2.794%
2024-11-20 23:07:10,498 - DEBUG - cur time: 2024-03-16T23:59:59.999 == next bar open time: 2024-03-17T00:00:00.000 == close pos time: 2024-03-24T00:00:00.000
2024-11-20 23:07:10,499 - INFO - pnl: 2024-03-16T23:59:59.999 155245.54811257898 === -0.869%
2024-11-20 23:07:10,506 - DEBUG - cur time: 2024-03-17T23:59:59.999 == next bar open time: 2024-03-18T00:00:00.000 == close pos time: 2024-03-25T00:00:00.000
2024-11-20 23:07:10,507 - INFO - pnl: 2024-03-17T23:59:59.999 157365.35840194314 === 1.365%
2024-11-20 23:07:10,513 - DEBUG - cur time: 2024-03-18T23:59:59.999 == next bar open time: 2024-03-19T00:00:00.000 == close pos time: 2024-03-26T00:00:00.000
2024-11-20 23:07:10,524 - DEBUG - sorted_long_factors: shape: (226, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ JTOUSDT      ┆ -2.035184    ┆ 0    ┆ 225          │
│ APTUSDT      ┆ -1.860668    ┆ 1    ┆ 224          │
│ GASUSDT      ┆ -1.829254    ┆ 2    ┆ 223          │
│ ORDIUSDT     ┆ -1.489392    ┆ 3    ┆ 222          │
│ BONDUSDT     ┆ -1.483913    ┆ 4    ┆ 221          │
│ TIAUSDT      ┆ -1.474291    ┆ 5    ┆ 220          │
│ EGLDUSDT     ┆ -1.425962    ┆ 6    ┆ 219          │
│ NEARUSDT     ┆ -1.394043    ┆ 7    ┆ 218          │
│ TRBUSDT      ┆ -1.383964    ┆ 8    ┆ 217          │
│ INJUSDT      ┆ -1.357263    ┆ 9    ┆ 216          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SNTUSDT      ┆ -0.097242    ┆ 216  ┆ 9            │
│ DGBUSDT      ┆ -0.056338    ┆ 217  ┆ 8            │
│ BALUSDT      ┆ -0.037422    ┆ 218  ┆ 7            │
│ COMBOUSDT    ┆ 0.001345     ┆ 219  ┆ 6            │
│ CVXUSDT      ┆ 0.011062     ┆ 220  ┆ 5            │
│ IDEXUSDT     ┆ 0.142862     ┆ 221  ┆ 4            │
│ PENDLEUSDT   ┆ 0.216543     ┆ 222  ┆ 3            │
│ ANTUSDT      ┆ 0.705844     ┆ 223  ┆ 2            │
│ DEFIUSDT     ┆ 1.397001     ┆ 224  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.296176     ┆ 225  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:10,531 - WARNING - 2024-03-18T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:10,531 - INFO - cur close time: 2024-03-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:10,531 - DEBUG - mean expected ret (mean factor): -0.777138866513053
2024-11-20 23:07:10,536 - DEBUG - begin to update pos: =========
2024-11-20 23:07:10,536 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,536 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023598    ┆ 0.19294     ┆ 0.14091     ┆ 0.0068171   ┆ … ┆ 0.03181 ┆ null   ┆ null    ┆ 1.1823  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,544 - DEBUG - update position: 2024-03-18T23:59:59.999 === diff_trading_value: 216326.24542432133 == cash: 157801.86748047147 
2024-11-20 23:07:10,545 - INFO - pnl: 2024-03-18T23:59:59.999 157801.86748047147 === 0.277%
2024-11-20 23:07:10,550 - DEBUG - cur time: 2024-03-19T23:59:59.999 == next bar open time: 2024-03-20T00:00:00.000 == close pos time: 2024-03-27T00:00:00.000
2024-11-20 23:07:10,552 - INFO - pnl: 2024-03-19T23:59:59.999 148544.83859029206 === -5.866%
2024-11-20 23:07:10,556 - DEBUG - cur time: 2024-03-20T23:59:59.999 == next bar open time: 2024-03-21T00:00:00.000 == close pos time: 2024-03-28T00:00:00.000
2024-11-20 23:07:10,559 - INFO - pnl: 2024-03-20T23:59:59.999 152359.28932931196 === 2.568%
2024-11-20 23:07:10,566 - DEBUG - cur time: 2024-03-21T23:59:59.999 == next bar open time: 2024-03-22T00:00:00.000 == close pos time: 2024-03-29T00:00:00.000
2024-11-20 23:07:10,569 - INFO - pnl: 2024-03-21T23:59:59.999 155285.6658011401 === 1.921%
2024-11-20 23:07:10,576 - DEBUG - cur time: 2024-03-22T23:59:59.999 == next bar open time: 2024-03-23T00:00:00.000 == close pos time: 2024-03-30T00:00:00.000
2024-11-20 23:07:10,579 - INFO - pnl: 2024-03-22T23:59:59.999 155323.72650967308 === 0.025%
2024-11-20 23:07:10,586 - DEBUG - cur time: 2024-03-23T23:59:59.999 == next bar open time: 2024-03-24T00:00:00.000 == close pos time: 2024-03-31T00:00:00.000
2024-11-20 23:07:10,589 - INFO - pnl: 2024-03-23T23:59:59.999 156859.7941150154 === 0.989%
2024-11-20 23:07:10,593 - DEBUG - cur time: 2024-03-24T23:59:59.999 == next bar open time: 2024-03-25T00:00:00.000 == close pos time: 2024-04-01T00:00:00.000
2024-11-20 23:07:10,596 - INFO - pnl: 2024-03-24T23:59:59.999 158807.41463154773 === 1.242%
2024-11-20 23:07:10,602 - DEBUG - cur time: 2024-03-25T23:59:59.999 == next bar open time: 2024-03-26T00:00:00.000 == close pos time: 2024-04-02T00:00:00.000
2024-11-20 23:07:10,611 - DEBUG - sorted_long_factors: shape: (227, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ JTOUSDT    ┆ -2.352548    ┆ 0    ┆ 226          │
│ MASKUSDT   ┆ -2.084099    ┆ 1    ┆ 225          │
│ BONDUSDT   ┆ -2.02953     ┆ 2    ┆ 224          │
│ INJUSDT    ┆ -1.89362     ┆ 3    ┆ 223          │
│ BTCDOMUSDT ┆ -1.827498    ┆ 4    ┆ 222          │
│ DOTUSDT    ┆ -1.825371    ┆ 5    ┆ 221          │
│ TIAUSDT    ┆ -1.789197    ┆ 6    ┆ 220          │
│ ILVUSDT    ┆ -1.784234    ┆ 7    ┆ 219          │
│ HIFIUSDT   ┆ -1.707245    ┆ 8    ┆ 218          │
│ PYTHUSDT   ┆ -1.647266    ┆ 9    ┆ 217          │
│ …          ┆ …            ┆ …    ┆ …            │
│ FLMUSDT    ┆ -0.003977    ┆ 217  ┆ 9            │
│ ALPHAUSDT  ┆ 0.078761     ┆ 218  ┆ 8            │
│ COMBOUSDT  ┆ 0.092835     ┆ 219  ┆ 7            │
│ DENTUSDT   ┆ 0.158428     ┆ 220  ┆ 6            │
│ DGBUSDT    ┆ 0.163926     ┆ 221  ┆ 5            │
│ XVGUSDT    ┆ 0.226943     ┆ 222  ┆ 4            │
│ DODOXUSDT  ┆ 0.324581     ┆ 223  ┆ 3            │
│ ANTUSDT    ┆ 0.516716     ┆ 224  ┆ 2            │
│ OXTUSDT    ┆ 0.923264     ┆ 225  ┆ 1            │
│ DEFIUSDT   ┆ 1.589972     ┆ 226  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:10,626 - WARNING - 2024-03-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:10,626 - INFO - cur close time: 2024-03-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:10,626 - DEBUG - mean expected ret (mean factor): -0.7915415461857791
2024-11-20 23:07:10,633 - DEBUG - begin to update pos: =========
2024-11-20 23:07:10,633 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,634 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025285    ┆ 0.24101     ┆ 0.16462     ┆ 0.0081028   ┆ … ┆ 0.03599 ┆ null   ┆ null    ┆ 1.0091  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,644 - DEBUG - update position: 2024-03-25T23:59:59.999 === diff_trading_value: 245213.27462652134 == cash: 159614.26862477677 
2024-11-20 23:07:10,647 - INFO - pnl: 2024-03-25T23:59:59.999 144614.26862477677 === -8.937%
2024-11-20 23:07:10,653 - DEBUG - cur time: 2024-03-26T23:59:59.999 == next bar open time: 2024-03-27T00:00:00.000 == close pos time: 2024-04-03T00:00:00.000
2024-11-20 23:07:10,655 - INFO - pnl: 2024-03-26T23:59:59.999 145029.761027658 === 0.287%
2024-11-20 23:07:10,659 - DEBUG - cur time: 2024-03-27T23:59:59.999 == next bar open time: 2024-03-28T00:00:00.000 == close pos time: 2024-04-04T00:00:00.000
2024-11-20 23:07:10,661 - INFO - pnl: 2024-03-27T23:59:59.999 144517.77123028797 === -0.353%
2024-11-20 23:07:10,668 - DEBUG - cur time: 2024-03-28T23:59:59.999 == next bar open time: 2024-03-29T00:00:00.000 == close pos time: 2024-04-05T00:00:00.000
2024-11-20 23:07:10,671 - INFO - pnl: 2024-03-28T23:59:59.999 144465.26449941596 === -0.036%
2024-11-20 23:07:10,677 - DEBUG - cur time: 2024-03-29T23:59:59.999 == next bar open time: 2024-03-30T00:00:00.000 == close pos time: 2024-04-06T00:00:00.000
2024-11-20 23:07:10,680 - INFO - pnl: 2024-03-29T23:59:59.999 145787.5757930514 === 0.915%
2024-11-20 23:07:10,685 - DEBUG - cur time: 2024-03-30T23:59:59.999 == next bar open time: 2024-03-31T00:00:00.000 == close pos time: 2024-04-07T00:00:00.000
2024-11-20 23:07:10,688 - INFO - pnl: 2024-03-30T23:59:59.999 144473.97908903382 === -0.901%
2024-11-20 23:07:10,693 - DEBUG - cur time: 2024-03-31T23:59:59.999 == next bar open time: 2024-04-01T00:00:00.000 == close pos time: 2024-04-08T00:00:00.000
2024-11-20 23:07:10,694 - INFO - pnl: 2024-03-31T23:59:59.999 141749.58291702528 === -1.886%
2024-11-20 23:07:10,700 - DEBUG - cur time: 2024-04-01T23:59:59.999 == next bar open time: 2024-04-02T00:00:00.000 == close pos time: 2024-04-09T00:00:00.000
2024-11-20 23:07:10,712 - DEBUG - sorted_long_factors: shape: (225, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ BONDUSDT    ┆ -1.999332    ┆ 0    ┆ 224          │
│ ORDIUSDT    ┆ -1.92077     ┆ 1    ┆ 223          │
│ MASKUSDT    ┆ -1.877633    ┆ 2    ┆ 222          │
│ AUCTIONUSDT ┆ -1.751514    ┆ 3    ┆ 221          │
│ RNDRUSDT    ┆ -1.698014    ┆ 4    ┆ 220          │
│ WAVESUSDT   ┆ -1.586669    ┆ 5    ┆ 219          │
│ AAVEUSDT    ┆ -1.529592    ┆ 6    ┆ 218          │
│ TRBUSDT     ┆ -1.520991    ┆ 7    ┆ 217          │
│ SUIUSDT     ┆ -1.490807    ┆ 8    ┆ 216          │
│ GASUSDT     ┆ -1.48309     ┆ 9    ┆ 215          │
│ …           ┆ …            ┆ …    ┆ …            │
│ HFTUSDT     ┆ -0.125505    ┆ 215  ┆ 9            │
│ ALPHAUSDT   ┆ -0.026141    ┆ 216  ┆ 8            │
│ XVGUSDT     ┆ 0.009536     ┆ 217  ┆ 7            │
│ AGLDUSDT    ┆ 0.011756     ┆ 218  ┆ 6            │
│ SFPUSDT     ┆ 0.021571     ┆ 219  ┆ 5            │
│ CVXUSDT     ┆ 0.141064     ┆ 220  ┆ 4            │
│ SNTUSDT     ┆ 0.168137     ┆ 221  ┆ 3            │
│ DENTUSDT    ┆ 0.35814      ┆ 222  ┆ 2            │
│ OXTUSDT     ┆ 0.738948     ┆ 223  ┆ 1            │
│ DEFIUSDT    ┆ 2.864556     ┆ 224  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:10,722 - WARNING - 2024-04-01T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:10,722 - INFO - cur close time: 2024-04-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:10,722 - DEBUG - mean expected ret (mean factor): -0.7904184877680934
2024-11-20 23:07:10,727 - DEBUG - begin to update pos: =========
2024-11-20 23:07:10,728 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,728 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025768    ┆ 0.23356     ┆ 0.15012     ┆ 0.0079297   ┆ … ┆ 0.03587 ┆ null   ┆ null    ┆ 0.7095  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,735 - DEBUG - update position: 2024-04-01T23:59:59.999 === diff_trading_value: 244262.5664790803 == cash: 144397.75418551266 
2024-11-20 23:07:10,736 - INFO - pnl: 2024-04-01T23:59:59.999 144397.75418551266 === 1.868%
2024-11-20 23:07:10,741 - DEBUG - cur time: 2024-04-02T23:59:59.999 == next bar open time: 2024-04-03T00:00:00.000 == close pos time: 2024-04-10T00:00:00.000
2024-11-20 23:07:10,743 - INFO - pnl: 2024-04-02T23:59:59.999 147179.01739257821 === 1.926%
2024-11-20 23:07:10,748 - DEBUG - cur time: 2024-04-03T23:59:59.999 == next bar open time: 2024-04-04T00:00:00.000 == close pos time: 2024-04-11T00:00:00.000
2024-11-20 23:07:10,750 - INFO - pnl: 2024-04-03T23:59:59.999 149859.97073090193 === 1.822%
2024-11-20 23:07:10,754 - DEBUG - cur time: 2024-04-04T23:59:59.999 == next bar open time: 2024-04-05T00:00:00.000 == close pos time: 2024-04-12T00:00:00.000
2024-11-20 23:07:10,755 - INFO - pnl: 2024-04-04T23:59:59.999 147912.84812041718 === -1.299%
2024-11-20 23:07:10,761 - DEBUG - cur time: 2024-04-05T23:59:59.999 == next bar open time: 2024-04-06T00:00:00.000 == close pos time: 2024-04-13T00:00:00.000
2024-11-20 23:07:10,764 - INFO - pnl: 2024-04-05T23:59:59.999 147411.2745937513 === -0.339%
2024-11-20 23:07:10,768 - DEBUG - cur time: 2024-04-06T23:59:59.999 == next bar open time: 2024-04-07T00:00:00.000 == close pos time: 2024-04-14T00:00:00.000
2024-11-20 23:07:10,771 - INFO - pnl: 2024-04-06T23:59:59.999 145975.7582842191 === -0.974%
2024-11-20 23:07:10,775 - DEBUG - cur time: 2024-04-07T23:59:59.999 == next bar open time: 2024-04-08T00:00:00.000 == close pos time: 2024-04-15T00:00:00.000
2024-11-20 23:07:10,777 - INFO - pnl: 2024-04-07T23:59:59.999 147333.03269918106 === 0.930%
2024-11-20 23:07:10,785 - DEBUG - cur time: 2024-04-08T23:59:59.999 == next bar open time: 2024-04-09T00:00:00.000 == close pos time: 2024-04-16T00:00:00.000
2024-11-20 23:07:10,795 - DEBUG - sorted_long_factors: shape: (227, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT    ┆ -2.135844    ┆ 0    ┆ 226          │
│ TRBUSDT     ┆ -2.006285    ┆ 1    ┆ 225          │
│ ILVUSDT     ┆ -1.935871    ┆ 2    ┆ 224          │
│ ICPUSDT     ┆ -1.774593    ┆ 3    ┆ 223          │
│ AUCTIONUSDT ┆ -1.774423    ┆ 4    ┆ 222          │
│ WAVESUSDT   ┆ -1.72267     ┆ 5    ┆ 221          │
│ UNIUSDT     ┆ -1.711998    ┆ 6    ┆ 220          │
│ SUIUSDT     ┆ -1.704374    ┆ 7    ┆ 219          │
│ TIAUSDT     ┆ -1.697419    ┆ 8    ┆ 218          │
│ PYTHUSDT    ┆ -1.679546    ┆ 9    ┆ 217          │
│ …           ┆ …            ┆ …    ┆ …            │
│ STPTUSDT    ┆ 0.131998     ┆ 217  ┆ 9            │
│ SNTUSDT     ┆ 0.180879     ┆ 218  ┆ 8            │
│ REEFUSDT    ┆ 0.190444     ┆ 219  ┆ 7            │
│ XMRUSDT     ┆ 0.201379     ┆ 220  ┆ 6            │
│ DENTUSDT    ┆ 0.349165     ┆ 221  ┆ 5            │
│ TLMUSDT     ┆ 0.362019     ┆ 222  ┆ 4            │
│ DODOXUSDT   ┆ 0.404332     ┆ 223  ┆ 3            │
│ OXTUSDT     ┆ 0.426063     ┆ 224  ┆ 2            │
│ CVXUSDT     ┆ 0.560231     ┆ 225  ┆ 1            │
│ DEFIUSDT    ┆ 1.483584     ┆ 226  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:10,805 - INFO - cur close time: 2024-04-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:10,806 - DEBUG - mean expected ret (mean factor): -0.772402621405539
2024-11-20 23:07:10,811 - DEBUG - begin to update pos: =========
2024-11-20 23:07:10,812 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,812 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024465    ┆ 0.21553     ┆ 0.14205     ┆ 0.0077766   ┆ … ┆ 0.03542 ┆ null   ┆ null    ┆ 0.7347  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,824 - DEBUG - update position: 2024-04-08T23:59:59.999 === diff_trading_value: 192318.69895300135 == cash: 149625.2036359018 
2024-11-20 23:07:10,826 - INFO - pnl: 2024-04-08T23:59:59.999 149625.2036359018 === 1.556%
2024-11-20 23:07:10,831 - DEBUG - cur time: 2024-04-09T23:59:59.999 == next bar open time: 2024-04-10T00:00:00.000 == close pos time: 2024-04-17T00:00:00.000
2024-11-20 23:07:10,833 - INFO - pnl: 2024-04-09T23:59:59.999 150886.97552189603 === 0.843%
2024-11-20 23:07:10,840 - DEBUG - cur time: 2024-04-10T23:59:59.999 == next bar open time: 2024-04-11T00:00:00.000 == close pos time: 2024-04-18T00:00:00.000
2024-11-20 23:07:10,844 - INFO - pnl: 2024-04-10T23:59:59.999 151827.51148374105 === 0.623%
2024-11-20 23:07:10,854 - DEBUG - cur time: 2024-04-11T23:59:59.999 == next bar open time: 2024-04-12T00:00:00.000 == close pos time: 2024-04-19T00:00:00.000
2024-11-20 23:07:10,859 - INFO - pnl: 2024-04-11T23:59:59.999 153007.13551473388 === 0.777%
2024-11-20 23:07:10,866 - DEBUG - cur time: 2024-04-12T23:59:59.999 == next bar open time: 2024-04-13T00:00:00.000 == close pos time: 2024-04-20T00:00:00.000
2024-11-20 23:07:10,870 - INFO - pnl: 2024-04-12T23:59:59.999 152040.01710739036 === -0.632%
2024-11-20 23:07:10,874 - DEBUG - cur time: 2024-04-13T23:59:59.999 == next bar open time: 2024-04-14T00:00:00.000 == close pos time: 2024-04-21T00:00:00.000
2024-11-20 23:07:10,878 - INFO - pnl: 2024-04-13T23:59:59.999 149031.07658050765 === -1.979%
2024-11-20 23:07:10,886 - DEBUG - cur time: 2024-04-14T23:59:59.999 == next bar open time: 2024-04-15T00:00:00.000 == close pos time: 2024-04-22T00:00:00.000
2024-11-20 23:07:10,889 - INFO - pnl: 2024-04-14T23:59:59.999 149763.86402260675 === 0.492%
2024-11-20 23:07:10,897 - DEBUG - cur time: 2024-04-15T23:59:59.999 == next bar open time: 2024-04-16T00:00:00.000 == close pos time: 2024-04-23T00:00:00.000
2024-11-20 23:07:10,909 - DEBUG - sorted_long_factors: shape: (227, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ONTUSDT      ┆ -2.185743    ┆ 0    ┆ 226          │
│ GALUSDT      ┆ -1.824647    ┆ 1    ┆ 225          │
│ 1000SATSUSDT ┆ -1.782092    ┆ 2    ┆ 224          │
│ GASUSDT      ┆ -1.748017    ┆ 3    ┆ 223          │
│ ONGUSDT      ┆ -1.729953    ┆ 4    ┆ 222          │
│ ORBSUSDT     ┆ -1.682747    ┆ 5    ┆ 221          │
│ IOSTUSDT     ┆ -1.674108    ┆ 6    ┆ 220          │
│ HIGHUSDT     ┆ -1.63013     ┆ 7    ┆ 219          │
│ JASMYUSDT    ┆ -1.60731     ┆ 8    ┆ 218          │
│ POWRUSDT     ┆ -1.578229    ┆ 9    ┆ 217          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RADUSDT      ┆ 0.079078     ┆ 217  ┆ 9            │
│ LITUSDT      ┆ 0.091435     ┆ 218  ┆ 8            │
│ DODOXUSDT    ┆ 0.141919     ┆ 219  ┆ 7            │
│ RNDRUSDT     ┆ 0.153635     ┆ 220  ┆ 6            │
│ KSMUSDT      ┆ 0.156162     ┆ 221  ┆ 5            │
│ COMBOUSDT    ┆ 0.331595     ┆ 222  ┆ 4            │
│ GTCUSDT      ┆ 0.377071     ┆ 223  ┆ 3            │
│ NMRUSDT      ┆ 0.567794     ┆ 224  ┆ 2            │
│ CVXUSDT      ┆ 0.62849      ┆ 225  ┆ 1            │
│ DEFIUSDT     ┆ 3.070546     ┆ 226  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:10,926 - WARNING - 2024-04-15T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:10,927 - INFO - cur close time: 2024-04-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:10,927 - DEBUG - mean expected ret (mean factor): -0.7904678500598497
2024-11-20 23:07:10,937 - DEBUG - begin to update pos: =========
2024-11-20 23:07:10,938 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,938 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.014665    ┆ 0.1429      ┆ 0.10007     ┆ 0.0050915   ┆ … ┆ 0.02423 ┆ null   ┆ null    ┆ 0.4823  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:10,949 - DEBUG - update position: 2024-04-15T23:59:59.999 === diff_trading_value: 296270.46850316145 == cash: 149677.41917627925 
2024-11-20 23:07:10,952 - INFO - pnl: 2024-04-15T23:59:59.999 149677.41917627925 === -0.058%
2024-11-20 23:07:10,959 - DEBUG - cur time: 2024-04-16T23:59:59.999 == next bar open time: 2024-04-17T00:00:00.000 == close pos time: 2024-04-24T00:00:00.000
2024-11-20 23:07:10,961 - INFO - pnl: 2024-04-16T23:59:59.999 149878.63463578743 === 0.134%
2024-11-20 23:07:10,969 - DEBUG - cur time: 2024-04-17T23:59:59.999 == next bar open time: 2024-04-18T00:00:00.000 == close pos time: 2024-04-25T00:00:00.000
2024-11-20 23:07:10,973 - INFO - pnl: 2024-04-17T23:59:59.999 153336.0987217742 === 2.307%
2024-11-20 23:07:10,979 - DEBUG - cur time: 2024-04-18T23:59:59.999 == next bar open time: 2024-04-19T00:00:00.000 == close pos time: 2024-04-26T00:00:00.000
2024-11-20 23:07:10,981 - INFO - pnl: 2024-04-18T23:59:59.999 150947.7207106562 === -1.558%
2024-11-20 23:07:10,989 - DEBUG - cur time: 2024-04-19T23:59:59.999 == next bar open time: 2024-04-20T00:00:00.000 == close pos time: 2024-04-27T00:00:00.000
2024-11-20 23:07:10,991 - INFO - pnl: 2024-04-19T23:59:59.999 148017.7495242387 === -1.941%
2024-11-20 23:07:11,000 - DEBUG - cur time: 2024-04-20T23:59:59.999 == next bar open time: 2024-04-21T00:00:00.000 == close pos time: 2024-04-28T00:00:00.000
2024-11-20 23:07:11,004 - INFO - pnl: 2024-04-20T23:59:59.999 149029.2765733015 === 0.683%
2024-11-20 23:07:11,010 - DEBUG - cur time: 2024-04-21T23:59:59.999 == next bar open time: 2024-04-22T00:00:00.000 == close pos time: 2024-04-29T00:00:00.000
2024-11-20 23:07:11,012 - INFO - pnl: 2024-04-21T23:59:59.999 144563.67469038078 === -2.996%
2024-11-20 23:07:11,016 - DEBUG - cur time: 2024-04-22T23:59:59.999 == next bar open time: 2024-04-23T00:00:00.000 == close pos time: 2024-04-30T00:00:00.000
2024-11-20 23:07:11,029 - DEBUG - sorted_long_factors: shape: (229, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT   ┆ -1.99502     ┆ 0    ┆ 228          │
│ GASUSDT    ┆ -1.933247    ┆ 1    ┆ 227          │
│ ONTUSDT    ┆ -1.865631    ┆ 2    ┆ 226          │
│ XVSUSDT    ┆ -1.778572    ┆ 3    ┆ 225          │
│ BSVUSDT    ┆ -1.733729    ┆ 4    ┆ 224          │
│ ATOMUSDT   ┆ -1.715398    ┆ 5    ┆ 223          │
│ NEOUSDT    ┆ -1.695851    ┆ 6    ┆ 222          │
│ BTCDOMUSDT ┆ -1.682382    ┆ 7    ┆ 221          │
│ JTOUSDT    ┆ -1.651029    ┆ 8    ┆ 220          │
│ AAVEUSDT   ┆ -1.624729    ┆ 9    ┆ 219          │
│ …          ┆ …            ┆ …    ┆ …            │
│ MDTUSDT    ┆ 0.044838     ┆ 219  ┆ 9            │
│ COMBOUSDT  ┆ 0.050857     ┆ 220  ┆ 8            │
│ RADUSDT    ┆ 0.07175      ┆ 221  ┆ 7            │
│ DUSKUSDT   ┆ 0.076719     ┆ 222  ┆ 6            │
│ TLMUSDT    ┆ 0.105353     ┆ 223  ┆ 5            │
│ CVXUSDT    ┆ 0.131143     ┆ 224  ┆ 4            │
│ NMRUSDT    ┆ 0.177693     ┆ 225  ┆ 3            │
│ IDEXUSDT   ┆ 0.200392     ┆ 226  ┆ 2            │
│ OXTUSDT    ┆ 0.360861     ┆ 227  ┆ 1            │
│ DEFIUSDT   ┆ 2.015651     ┆ 228  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:11,037 - WARNING - 2024-04-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:11,038 - INFO - cur close time: 2024-04-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:11,038 - DEBUG - mean expected ret (mean factor): -0.776978610175279
2024-11-20 23:07:11,044 - DEBUG - begin to update pos: =========
2024-11-20 23:07:11,044 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,045 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.020219    ┆ 0.17626     ┆ 0.11081     ┆ 0.0068702   ┆ … ┆ 0.02659 ┆ null   ┆ null    ┆ 0.5697  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,055 - DEBUG - update position: 2024-04-22T23:59:59.999 === diff_trading_value: 313454.67268949095 == cash: 142501.89551264688 
2024-11-20 23:07:11,057 - INFO - pnl: 2024-04-22T23:59:59.999 142501.89551264688 === -1.426%
2024-11-20 23:07:11,063 - DEBUG - cur time: 2024-04-23T23:59:59.999 == next bar open time: 2024-04-24T00:00:00.000 == close pos time: 2024-05-01T00:00:00.000
2024-11-20 23:07:11,065 - INFO - pnl: 2024-04-23T23:59:59.999 145360.4986090832 === 2.006%
2024-11-20 23:07:11,071 - DEBUG - cur time: 2024-04-24T23:59:59.999 == next bar open time: 2024-04-25T00:00:00.000 == close pos time: 2024-05-02T00:00:00.000
2024-11-20 23:07:11,073 - INFO - pnl: 2024-04-24T23:59:59.999 143925.21144926257 === -0.987%
2024-11-20 23:07:11,078 - DEBUG - cur time: 2024-04-25T23:59:59.999 == next bar open time: 2024-04-26T00:00:00.000 == close pos time: 2024-05-03T00:00:00.000
2024-11-20 23:07:11,080 - INFO - pnl: 2024-04-25T23:59:59.999 144948.43737394677 === 0.711%
2024-11-20 23:07:11,084 - DEBUG - cur time: 2024-04-26T23:59:59.999 == next bar open time: 2024-04-27T00:00:00.000 == close pos time: 2024-05-04T00:00:00.000
2024-11-20 23:07:11,087 - INFO - pnl: 2024-04-26T23:59:59.999 142937.00174803264 === -1.388%
2024-11-20 23:07:11,091 - DEBUG - cur time: 2024-04-27T23:59:59.999 == next bar open time: 2024-04-28T00:00:00.000 == close pos time: 2024-05-05T00:00:00.000
2024-11-20 23:07:11,095 - INFO - pnl: 2024-04-27T23:59:59.999 145225.85059535445 === 1.601%
2024-11-20 23:07:11,101 - DEBUG - cur time: 2024-04-28T23:59:59.999 == next bar open time: 2024-04-29T00:00:00.000 == close pos time: 2024-05-06T00:00:00.000
2024-11-20 23:07:11,103 - INFO - pnl: 2024-04-28T23:59:59.999 144283.39673874664 === -0.649%
2024-11-20 23:07:11,109 - DEBUG - cur time: 2024-04-29T23:59:59.999 == next bar open time: 2024-04-30T00:00:00.000 == close pos time: 2024-05-07T00:00:00.000
2024-11-20 23:07:11,125 - DEBUG - sorted_long_factors: shape: (231, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ NEOUSDT  ┆ -2.126303    ┆ 0    ┆ 230          │
│ WIFUSDT  ┆ -2.051289    ┆ 1    ┆ 229          │
│ TIAUSDT  ┆ -1.897508    ┆ 2    ┆ 228          │
│ JTOUSDT  ┆ -1.783478    ┆ 3    ┆ 227          │
│ XMRUSDT  ┆ -1.74063     ┆ 4    ┆ 226          │
│ SSVUSDT  ┆ -1.734845    ┆ 5    ┆ 225          │
│ ORDIUSDT ┆ -1.708151    ┆ 6    ┆ 224          │
│ BNXUSDT  ┆ -1.680066    ┆ 7    ┆ 223          │
│ ATAUSDT  ┆ -1.677693    ┆ 8    ┆ 222          │
│ ENSUSDT  ┆ -1.673562    ┆ 9    ┆ 221          │
│ …        ┆ …            ┆ …    ┆ …            │
│ NMRUSDT  ┆ 0.088386     ┆ 221  ┆ 9            │
│ DUSKUSDT ┆ 0.110217     ┆ 222  ┆ 8            │
│ IDEXUSDT ┆ 0.166327     ┆ 223  ┆ 7            │
│ GLMRUSDT ┆ 0.16906      ┆ 224  ┆ 6            │
│ CVXUSDT  ┆ 0.287036     ┆ 225  ┆ 5            │
│ RADUSDT  ┆ 0.306291     ┆ 226  ┆ 4            │
│ TLMUSDT  ┆ 0.329597     ┆ 227  ┆ 3            │
│ MDTUSDT  ┆ 0.458102     ┆ 228  ┆ 2            │
│ OXTUSDT  ┆ 0.755228     ┆ 229  ┆ 1            │
│ DEFIUSDT ┆ 2.499978     ┆ 230  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:11,140 - WARNING - 2024-04-29T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:11,140 - INFO - cur close time: 2024-04-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:11,141 - DEBUG - mean expected ret (mean factor): -0.7732163059337936
2024-11-20 23:07:11,150 - DEBUG - begin to update pos: =========
2024-11-20 23:07:11,151 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,151 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025473    ┆ 0.16975     ┆ 0.10454     ┆ 0.0073586   ┆ … ┆ 0.0242  ┆ null   ┆ null    ┆ 0.4966  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,165 - DEBUG - update position: 2024-04-29T23:59:59.999 === diff_trading_value: 248509.04631830513 == cash: 141228.48164532465 
2024-11-20 23:07:11,169 - INFO - pnl: 2024-04-29T23:59:59.999 141228.48164532465 === -2.117%
2024-11-20 23:07:11,179 - DEBUG - cur time: 2024-04-30T23:59:59.999 == next bar open time: 2024-05-01T00:00:00.000 == close pos time: 2024-05-08T00:00:00.000
2024-11-20 23:07:11,183 - INFO - pnl: 2024-04-30T23:59:59.999 144001.56442957674 === 1.964%
2024-11-20 23:07:11,189 - DEBUG - cur time: 2024-05-01T23:59:59.999 == next bar open time: 2024-05-02T00:00:00.000 == close pos time: 2024-05-09T00:00:00.000
2024-11-20 23:07:11,191 - INFO - pnl: 2024-05-01T23:59:59.999 143488.36594698456 === -0.356%
2024-11-20 23:07:11,198 - DEBUG - cur time: 2024-05-02T23:59:59.999 == next bar open time: 2024-05-03T00:00:00.000 == close pos time: 2024-05-10T00:00:00.000
2024-11-20 23:07:11,201 - INFO - pnl: 2024-05-02T23:59:59.999 145052.9304106325 === 1.090%
2024-11-20 23:07:11,206 - DEBUG - cur time: 2024-05-03T23:59:59.999 == next bar open time: 2024-05-04T00:00:00.000 == close pos time: 2024-05-11T00:00:00.000
2024-11-20 23:07:11,208 - INFO - pnl: 2024-05-03T23:59:59.999 145629.53254640286 === 0.398%
2024-11-20 23:07:11,213 - DEBUG - cur time: 2024-05-04T23:59:59.999 == next bar open time: 2024-05-05T00:00:00.000 == close pos time: 2024-05-12T00:00:00.000
2024-11-20 23:07:11,216 - INFO - pnl: 2024-05-04T23:59:59.999 144586.92612884252 === -0.716%
2024-11-20 23:07:11,222 - DEBUG - cur time: 2024-05-05T23:59:59.999 == next bar open time: 2024-05-06T00:00:00.000 == close pos time: 2024-05-13T00:00:00.000
2024-11-20 23:07:11,225 - INFO - pnl: 2024-05-05T23:59:59.999 145897.98567477855 === 0.907%
2024-11-20 23:07:11,233 - DEBUG - cur time: 2024-05-06T23:59:59.999 == next bar open time: 2024-05-07T00:00:00.000 == close pos time: 2024-05-14T00:00:00.000
2024-11-20 23:07:11,257 - DEBUG - sorted_long_factors: shape: (234, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WAVESUSDT    ┆ -1.960761    ┆ 0    ┆ 233          │
│ GASUSDT      ┆ -1.915474    ┆ 1    ┆ 232          │
│ RNDRUSDT     ┆ -1.908811    ┆ 2    ┆ 231          │
│ LPTUSDT      ┆ -1.766632    ┆ 3    ┆ 230          │
│ USDCUSDT     ┆ -1.73883     ┆ 4    ┆ 229          │
│ WLDUSDT      ┆ -1.704481    ┆ 5    ┆ 228          │
│ NEOUSDT      ┆ -1.673672    ┆ 6    ┆ 227          │
│ POWRUSDT     ┆ -1.672866    ┆ 7    ┆ 226          │
│ AIUSDT       ┆ -1.63889     ┆ 8    ┆ 225          │
│ 1000SATSUSDT ┆ -1.62371     ┆ 9    ┆ 224          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COMPUSDT     ┆ -0.017467    ┆ 224  ┆ 9            │
│ CVXUSDT      ┆ -0.009653    ┆ 225  ┆ 8            │
│ BSVUSDT      ┆ 0.003279     ┆ 226  ┆ 7            │
│ PERPUSDT     ┆ 0.182152     ┆ 227  ┆ 6            │
│ HFTUSDT      ┆ 0.19577      ┆ 228  ┆ 5            │
│ QNTUSDT      ┆ 0.32804      ┆ 229  ┆ 4            │
│ GMXUSDT      ┆ 0.345318     ┆ 230  ┆ 3            │
│ AGLDUSDT     ┆ 0.345734     ┆ 231  ┆ 2            │
│ XVSUSDT      ┆ 0.364115     ┆ 232  ┆ 1            │
│ DEFIUSDT     ┆ 2.880064     ┆ 233  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:11,273 - INFO - cur close time: 2024-05-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:11,273 - DEBUG - mean expected ret (mean factor): -0.772944390057034
2024-11-20 23:07:11,282 - DEBUG - begin to update pos: =========
2024-11-20 23:07:11,283 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,283 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024929    ┆ 0.17924     ┆ 0.10732     ┆ 0.0083491   ┆ … ┆ 0.02408 ┆ null   ┆ null    ┆ 0.4872  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,297 - DEBUG - update position: 2024-05-06T23:59:59.999 === diff_trading_value: 323659.8872652451 == cash: 144914.91452724175 
2024-11-20 23:07:11,299 - INFO - pnl: 2024-05-06T23:59:59.999 144914.91452724175 === -0.674%
2024-11-20 23:07:11,304 - DEBUG - cur time: 2024-05-07T23:59:59.999 == next bar open time: 2024-05-08T00:00:00.000 == close pos time: 2024-05-15T00:00:00.000
2024-11-20 23:07:11,306 - INFO - pnl: 2024-05-07T23:59:59.999 138694.74082844018 === -4.292%
2024-11-20 23:07:11,310 - DEBUG - cur time: 2024-05-08T23:59:59.999 == next bar open time: 2024-05-09T00:00:00.000 == close pos time: 2024-05-16T00:00:00.000
2024-11-20 23:07:11,314 - INFO - pnl: 2024-05-08T23:59:59.999 143934.79499766006 === 3.778%
2024-11-20 23:07:11,320 - DEBUG - cur time: 2024-05-09T23:59:59.999 == next bar open time: 2024-05-10T00:00:00.000 == close pos time: 2024-05-17T00:00:00.000
2024-11-20 23:07:11,321 - INFO - pnl: 2024-05-09T23:59:59.999 141704.77746808983 === -1.549%
2024-11-20 23:07:11,326 - DEBUG - cur time: 2024-05-10T23:59:59.999 == next bar open time: 2024-05-11T00:00:00.000 == close pos time: 2024-05-18T00:00:00.000
2024-11-20 23:07:11,328 - INFO - pnl: 2024-05-10T23:59:59.999 139921.90642542823 === -1.258%
2024-11-20 23:07:11,332 - DEBUG - cur time: 2024-05-11T23:59:59.999 == next bar open time: 2024-05-12T00:00:00.000 == close pos time: 2024-05-19T00:00:00.000
2024-11-20 23:07:11,336 - INFO - pnl: 2024-05-11T23:59:59.999 137281.27599741047 === -1.887%
2024-11-20 23:07:11,341 - DEBUG - cur time: 2024-05-12T23:59:59.999 == next bar open time: 2024-05-13T00:00:00.000 == close pos time: 2024-05-20T00:00:00.000
2024-11-20 23:07:11,344 - INFO - pnl: 2024-05-12T23:59:59.999 136047.6527420813 === -0.899%
2024-11-20 23:07:11,348 - DEBUG - cur time: 2024-05-13T23:59:59.999 == next bar open time: 2024-05-14T00:00:00.000 == close pos time: 2024-05-21T00:00:00.000
2024-11-20 23:07:11,358 - DEBUG - sorted_long_factors: shape: (227, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TIAUSDT   ┆ -2.140212    ┆ 0    ┆ 226          │
│ JTOUSDT   ┆ -1.94103     ┆ 1    ┆ 225          │
│ JUPUSDT   ┆ -1.930749    ┆ 2    ┆ 224          │
│ LSKUSDT   ┆ -1.891571    ┆ 3    ┆ 223          │
│ WIFUSDT   ┆ -1.881592    ┆ 4    ┆ 222          │
│ USDCUSDT  ┆ -1.814016    ┆ 5    ┆ 221          │
│ SUPERUSDT ┆ -1.719355    ┆ 6    ┆ 220          │
│ NEARUSDT  ┆ -1.705447    ┆ 7    ┆ 219          │
│ BNXUSDT   ┆ -1.686621    ┆ 8    ┆ 218          │
│ SUIUSDT   ┆ -1.62829     ┆ 9    ┆ 217          │
│ …         ┆ …            ┆ …    ┆ …            │
│ DENTUSDT  ┆ 0.099232     ┆ 217  ┆ 9            │
│ TLMUSDT   ┆ 0.100292     ┆ 218  ┆ 8            │
│ HFTUSDT   ┆ 0.104687     ┆ 219  ┆ 7            │
│ AGLDUSDT  ┆ 0.111925     ┆ 220  ┆ 6            │
│ IOTXUSDT  ┆ 0.184443     ┆ 221  ┆ 5            │
│ C98USDT   ┆ 0.223791     ┆ 222  ┆ 4            │
│ OGNUSDT   ┆ 0.401211     ┆ 223  ┆ 3            │
│ ETHWUSDT  ┆ 0.413469     ┆ 224  ┆ 2            │
│ DODOXUSDT ┆ 0.57831      ┆ 225  ┆ 1            │
│ DEFIUSDT  ┆ 0.997637     ┆ 226  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:11,366 - WARNING - 2024-05-13T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:11,366 - INFO - cur close time: 2024-05-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:11,367 - DEBUG - mean expected ret (mean factor): -0.7921901401268752
2024-11-20 23:07:11,374 - DEBUG - begin to update pos: =========
2024-11-20 23:07:11,375 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,375 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023299    ┆ 0.18328     ┆ 0.10478     ┆ 0.0099128   ┆ … ┆ 0.02236 ┆ null   ┆ null    ┆ 0.4518  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,383 - DEBUG - update position: 2024-05-13T23:59:59.999 === diff_trading_value: 323837.9017203099 == cash: 135410.6448060706 
2024-11-20 23:07:11,385 - INFO - pnl: 2024-05-13T23:59:59.999 135410.6448060706 === -0.468%
2024-11-20 23:07:11,388 - DEBUG - cur time: 2024-05-14T23:59:59.999 == next bar open time: 2024-05-15T00:00:00.000 == close pos time: 2024-05-22T00:00:00.000
2024-11-20 23:07:11,390 - INFO - pnl: 2024-05-14T23:59:59.999 136349.53377201737 === 0.693%
2024-11-20 23:07:11,393 - DEBUG - cur time: 2024-05-15T23:59:59.999 == next bar open time: 2024-05-16T00:00:00.000 == close pos time: 2024-05-23T00:00:00.000
2024-11-20 23:07:11,395 - INFO - pnl: 2024-05-15T23:59:59.999 135324.08789821365 === -0.752%
2024-11-20 23:07:11,398 - DEBUG - cur time: 2024-05-16T23:59:59.999 == next bar open time: 2024-05-17T00:00:00.000 == close pos time: 2024-05-24T00:00:00.000
2024-11-20 23:07:11,400 - INFO - pnl: 2024-05-16T23:59:59.999 134062.43149347042 === -0.932%
2024-11-20 23:07:11,404 - DEBUG - cur time: 2024-05-17T23:59:59.999 == next bar open time: 2024-05-18T00:00:00.000 == close pos time: 2024-05-25T00:00:00.000
2024-11-20 23:07:11,406 - INFO - pnl: 2024-05-17T23:59:59.999 134665.0440031801 === 0.450%
2024-11-20 23:07:11,409 - DEBUG - cur time: 2024-05-18T23:59:59.999 == next bar open time: 2024-05-19T00:00:00.000 == close pos time: 2024-05-26T00:00:00.000
2024-11-20 23:07:11,410 - INFO - pnl: 2024-05-18T23:59:59.999 136888.30973841363 === 1.651%
2024-11-20 23:07:11,413 - DEBUG - cur time: 2024-05-19T23:59:59.999 == next bar open time: 2024-05-20T00:00:00.000 == close pos time: 2024-05-27T00:00:00.000
2024-11-20 23:07:11,414 - INFO - pnl: 2024-05-19T23:59:59.999 135032.85012442977 === -1.355%
2024-11-20 23:07:11,418 - DEBUG - cur time: 2024-05-20T23:59:59.999 == next bar open time: 2024-05-21T00:00:00.000 == close pos time: 2024-05-28T00:00:00.000
2024-11-20 23:07:11,429 - DEBUG - sorted_long_factors: shape: (229, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT    ┆ -2.126124    ┆ 0    ┆ 228          │
│ MOVRUSDT   ┆ -2.060138    ┆ 1    ┆ 227          │
│ ORDIUSDT   ┆ -2.020212    ┆ 2    ┆ 226          │
│ TRBUSDT    ┆ -1.972711    ┆ 3    ┆ 225          │
│ BTCDOMUSDT ┆ -1.971723    ┆ 4    ┆ 224          │
│ RNDRUSDT   ┆ -1.939862    ┆ 5    ┆ 223          │
│ ONDOUSDT   ┆ -1.90228     ┆ 6    ┆ 222          │
│ UMAUSDT    ┆ -1.891024    ┆ 7    ┆ 221          │
│ LSKUSDT    ┆ -1.889088    ┆ 8    ┆ 220          │
│ JUPUSDT    ┆ -1.887688    ┆ 9    ┆ 219          │
│ …          ┆ …            ┆ …    ┆ …            │
│ AMBUSDT    ┆ 0.200386     ┆ 219  ┆ 9            │
│ JOEUSDT    ┆ 0.20251      ┆ 220  ┆ 8            │
│ MAVUSDT    ┆ 0.216447     ┆ 221  ┆ 7            │
│ OXTUSDT    ┆ 0.266806     ┆ 222  ┆ 6            │
│ GTCUSDT    ┆ 0.280107     ┆ 223  ┆ 5            │
│ OGNUSDT    ┆ 0.439573     ┆ 224  ┆ 4            │
│ TLMUSDT    ┆ 0.483196     ┆ 225  ┆ 3            │
│ DARUSDT    ┆ 0.497314     ┆ 226  ┆ 2            │
│ DEFIUSDT   ┆ 1.438627     ┆ 227  ┆ 1            │
│ DODOXUSDT  ┆ 1.725278     ┆ 228  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:11,437 - WARNING - 2024-05-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:11,437 - INFO - cur close time: 2024-05-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:11,438 - DEBUG - mean expected ret (mean factor): -0.7759764611363164
2024-11-20 23:07:11,446 - DEBUG - begin to update pos: =========
2024-11-20 23:07:11,446 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,446 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.030523    ┆ 0.21523     ┆ 0.11112     ┆ 0.0114216   ┆ … ┆ 0.02465 ┆ null   ┆ null    ┆ 0.5811  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,454 - DEBUG - update position: 2024-05-20T23:59:59.999 === diff_trading_value: 283269.5799788806 == cash: 138117.154917126 
2024-11-20 23:07:11,456 - INFO - pnl: 2024-05-20T23:59:59.999 138117.154917126 === 2.284%
2024-11-20 23:07:11,461 - DEBUG - cur time: 2024-05-21T23:59:59.999 == next bar open time: 2024-05-22T00:00:00.000 == close pos time: 2024-05-29T00:00:00.000
2024-11-20 23:07:11,463 - INFO - pnl: 2024-05-21T23:59:59.999 140604.10307916914 === 1.801%
2024-11-20 23:07:11,467 - DEBUG - cur time: 2024-05-22T23:59:59.999 == next bar open time: 2024-05-23T00:00:00.000 == close pos time: 2024-05-30T00:00:00.000
2024-11-20 23:07:11,469 - INFO - pnl: 2024-05-22T23:59:59.999 141369.31914540858 === 0.544%
2024-11-20 23:07:11,472 - DEBUG - cur time: 2024-05-23T23:59:59.999 == next bar open time: 2024-05-24T00:00:00.000 == close pos time: 2024-05-31T00:00:00.000
2024-11-20 23:07:11,475 - INFO - pnl: 2024-05-23T23:59:59.999 142405.60963272623 === 0.733%
2024-11-20 23:07:11,478 - DEBUG - cur time: 2024-05-24T23:59:59.999 == next bar open time: 2024-05-25T00:00:00.000 == close pos time: 2024-06-01T00:00:00.000
2024-11-20 23:07:11,480 - INFO - pnl: 2024-05-24T23:59:59.999 144534.9837111959 === 1.495%
2024-11-20 23:07:11,485 - DEBUG - cur time: 2024-05-25T23:59:59.999 == next bar open time: 2024-05-26T00:00:00.000 == close pos time: 2024-06-02T00:00:00.000
2024-11-20 23:07:11,487 - INFO - pnl: 2024-05-25T23:59:59.999 143793.11534833495 === -0.513%
2024-11-20 23:07:11,491 - DEBUG - cur time: 2024-05-26T23:59:59.999 == next bar open time: 2024-05-27T00:00:00.000 == close pos time: 2024-06-03T00:00:00.000
2024-11-20 23:07:11,493 - INFO - pnl: 2024-05-26T23:59:59.999 143154.74962121947 === -0.444%
2024-11-20 23:07:11,499 - DEBUG - cur time: 2024-05-27T23:59:59.999 == next bar open time: 2024-05-28T00:00:00.000 == close pos time: 2024-06-04T00:00:00.000
2024-11-20 23:07:11,514 - DEBUG - sorted_long_factors: shape: (230, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ JTOUSDT   ┆ -2.084253    ┆ 0    ┆ 229          │
│ RNDRUSDT  ┆ -2.070565    ┆ 1    ┆ 228          │
│ TRBUSDT   ┆ -1.992101    ┆ 2    ┆ 227          │
│ BNBUSDT   ┆ -1.968117    ┆ 3    ┆ 226          │
│ ARUSDT    ┆ -1.92421     ┆ 4    ┆ 225          │
│ TIAUSDT   ┆ -1.912839    ┆ 5    ┆ 224          │
│ JUPUSDT   ┆ -1.853261    ┆ 6    ┆ 223          │
│ DYMUSDT   ┆ -1.813606    ┆ 7    ┆ 222          │
│ FETUSDT   ┆ -1.791654    ┆ 8    ┆ 221          │
│ ORDIUSDT  ┆ -1.747482    ┆ 9    ┆ 220          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ORBSUSDT  ┆ 0.2413       ┆ 220  ┆ 9            │
│ IOSTUSDT  ┆ 0.282633     ┆ 221  ┆ 8            │
│ KEYUSDT   ┆ 0.287328     ┆ 222  ┆ 7            │
│ STEEMUSDT ┆ 0.290603     ┆ 223  ┆ 6            │
│ COMBOUSDT ┆ 0.363491     ┆ 224  ┆ 5            │
│ TLMUSDT   ┆ 0.381316     ┆ 225  ┆ 4            │
│ DENTUSDT  ┆ 0.387153     ┆ 226  ┆ 3            │
│ OXTUSDT   ┆ 0.612128     ┆ 227  ┆ 2            │
│ DODOXUSDT ┆ 0.636565     ┆ 228  ┆ 1            │
│ DEFIUSDT  ┆ 2.787147     ┆ 229  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:11,521 - INFO - cur close time: 2024-05-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:11,521 - DEBUG - mean expected ret (mean factor): -0.7665291537971314
2024-11-20 23:07:11,528 - DEBUG - begin to update pos: =========
2024-11-20 23:07:11,529 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,529 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.039223    ┆ 0.27812     ┆ 0.11594     ┆ 0.0167246   ┆ … ┆ 0.02505 ┆ null   ┆ null    ┆ 0.5595  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,538 - DEBUG - update position: 2024-05-27T23:59:59.999 === diff_trading_value: 237818.75138306932 == cash: 144716.80818580228 
2024-11-20 23:07:11,540 - INFO - pnl: 2024-05-27T23:59:59.999 144716.80818580228 === 1.091%
2024-11-20 23:07:11,547 - DEBUG - cur time: 2024-05-28T23:59:59.999 == next bar open time: 2024-05-29T00:00:00.000 == close pos time: 2024-06-05T00:00:00.000
2024-11-20 23:07:11,549 - INFO - pnl: 2024-05-28T23:59:59.999 145019.54551102358 === 0.209%
2024-11-20 23:07:11,557 - DEBUG - cur time: 2024-05-29T23:59:59.999 == next bar open time: 2024-05-30T00:00:00.000 == close pos time: 2024-06-06T00:00:00.000
2024-11-20 23:07:11,560 - INFO - pnl: 2024-05-29T23:59:59.999 144706.62159664783 === -0.216%
2024-11-20 23:07:11,563 - DEBUG - cur time: 2024-05-30T23:59:59.999 == next bar open time: 2024-05-31T00:00:00.000 == close pos time: 2024-06-07T00:00:00.000
2024-11-20 23:07:11,565 - INFO - pnl: 2024-05-30T23:59:59.999 141154.07859410887 === -2.455%
2024-11-20 23:07:11,575 - DEBUG - cur time: 2024-05-31T23:59:59.999 == next bar open time: 2024-06-01T00:00:00.000 == close pos time: 2024-06-08T00:00:00.000
2024-11-20 23:07:11,580 - INFO - pnl: 2024-05-31T23:59:59.999 142507.26643460293 === 0.959%
2024-11-20 23:07:11,588 - DEBUG - cur time: 2024-06-01T23:59:59.999 == next bar open time: 2024-06-02T00:00:00.000 == close pos time: 2024-06-09T00:00:00.000
2024-11-20 23:07:11,594 - INFO - pnl: 2024-06-01T23:59:59.999 141820.62558662944 === -0.482%
2024-11-20 23:07:11,602 - DEBUG - cur time: 2024-06-02T23:59:59.999 == next bar open time: 2024-06-03T00:00:00.000 == close pos time: 2024-06-10T00:00:00.000
2024-11-20 23:07:11,606 - INFO - pnl: 2024-06-02T23:59:59.999 141384.48577570636 === -0.308%
2024-11-20 23:07:11,618 - DEBUG - cur time: 2024-06-03T23:59:59.999 == next bar open time: 2024-06-04T00:00:00.000 == close pos time: 2024-06-11T00:00:00.000
2024-11-20 23:07:11,636 - DEBUG - sorted_long_factors: shape: (234, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ RNDRUSDT   ┆ -2.126145    ┆ 0    ┆ 233          │
│ JTOUSDT    ┆ -2.021796    ┆ 1    ┆ 232          │
│ ACEUSDT    ┆ -2.011825    ┆ 2    ┆ 231          │
│ OMUSDT     ┆ -1.942112    ┆ 3    ┆ 230          │
│ WIFUSDT    ┆ -1.840954    ┆ 4    ┆ 229          │
│ OPUSDT     ┆ -1.799046    ┆ 5    ┆ 228          │
│ BNBUSDT    ┆ -1.78976     ┆ 6    ┆ 227          │
│ INJUSDT    ┆ -1.720942    ┆ 7    ┆ 226          │
│ TRBUSDT    ┆ -1.71324     ┆ 8    ┆ 225          │
│ MASKUSDT   ┆ -1.625243    ┆ 9    ┆ 224          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BTCDOMUSDT ┆ 0.028117     ┆ 224  ┆ 9            │
│ ORBSUSDT   ┆ 0.114248     ┆ 225  ┆ 8            │
│ FLMUSDT    ┆ 0.12078      ┆ 226  ┆ 7            │
│ DODOXUSDT  ┆ 0.144568     ┆ 227  ┆ 6            │
│ NMRUSDT    ┆ 0.154364     ┆ 228  ┆ 5            │
│ COTIUSDT   ┆ 0.188028     ┆ 229  ┆ 4            │
│ RVNUSDT    ┆ 0.225232     ┆ 230  ┆ 3            │
│ ICXUSDT    ┆ 0.426356     ┆ 231  ┆ 2            │
│ OXTUSDT    ┆ 0.587259     ┆ 232  ┆ 1            │
│ DEFIUSDT   ┆ 2.45315      ┆ 233  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:11,647 - INFO - cur close time: 2024-06-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:11,648 - DEBUG - mean expected ret (mean factor): -0.7890169251750901
2024-11-20 23:07:11,655 - DEBUG - begin to update pos: =========
2024-11-20 23:07:11,655 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,656 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.032016    ┆ 0.26834     ┆ 0.11868     ┆ 0.0144511   ┆ … ┆ 0.02317 ┆ null   ┆ null    ┆ 0.5037  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,668 - DEBUG - update position: 2024-06-03T23:59:59.999 === diff_trading_value: 236350.1946402159 == cash: 144105.76336701165 
2024-11-20 23:07:11,671 - INFO - pnl: 2024-06-03T23:59:59.999 144105.76336701165 === 1.925%
2024-11-20 23:07:11,676 - DEBUG - cur time: 2024-06-04T23:59:59.999 == next bar open time: 2024-06-05T00:00:00.000 == close pos time: 2024-06-12T00:00:00.000
2024-11-20 23:07:11,678 - INFO - pnl: 2024-06-04T23:59:59.999 145005.1796809454 === 0.624%
2024-11-20 23:07:11,684 - DEBUG - cur time: 2024-06-05T23:59:59.999 == next bar open time: 2024-06-06T00:00:00.000 == close pos time: 2024-06-13T00:00:00.000
2024-11-20 23:07:11,688 - INFO - pnl: 2024-06-05T23:59:59.999 144001.10617403925 === -0.692%
2024-11-20 23:07:11,695 - DEBUG - cur time: 2024-06-06T23:59:59.999 == next bar open time: 2024-06-07T00:00:00.000 == close pos time: 2024-06-14T00:00:00.000
2024-11-20 23:07:11,698 - INFO - pnl: 2024-06-06T23:59:59.999 142453.90265376074 === -1.074%
2024-11-20 23:07:11,707 - DEBUG - cur time: 2024-06-07T23:59:59.999 == next bar open time: 2024-06-08T00:00:00.000 == close pos time: 2024-06-15T00:00:00.000
2024-11-20 23:07:11,711 - INFO - pnl: 2024-06-07T23:59:59.999 142833.14153808623 === 0.266%
2024-11-20 23:07:11,719 - DEBUG - cur time: 2024-06-08T23:59:59.999 == next bar open time: 2024-06-09T00:00:00.000 == close pos time: 2024-06-16T00:00:00.000
2024-11-20 23:07:11,721 - INFO - pnl: 2024-06-08T23:59:59.999 140465.4618294877 === -1.658%
2024-11-20 23:07:11,726 - DEBUG - cur time: 2024-06-09T23:59:59.999 == next bar open time: 2024-06-10T00:00:00.000 == close pos time: 2024-06-17T00:00:00.000
2024-11-20 23:07:11,728 - INFO - pnl: 2024-06-09T23:59:59.999 138457.01271662884 === -1.430%
2024-11-20 23:07:11,731 - DEBUG - cur time: 2024-06-10T23:59:59.999 == next bar open time: 2024-06-11T00:00:00.000 == close pos time: 2024-06-18T00:00:00.000
2024-11-20 23:07:11,744 - DEBUG - sorted_long_factors: shape: (236, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ACEUSDT     ┆ -1.818825    ┆ 0    ┆ 235          │
│ MOVRUSDT    ┆ -1.798736    ┆ 1    ┆ 234          │
│ TONUSDT     ┆ -1.774252    ┆ 2    ┆ 233          │
│ INJUSDT     ┆ -1.735699    ┆ 3    ┆ 232          │
│ AUCTIONUSDT ┆ -1.694892    ┆ 4    ┆ 231          │
│ FILUSDT     ┆ -1.587233    ┆ 5    ┆ 230          │
│ WIFUSDT     ┆ -1.580988    ┆ 6    ┆ 229          │
│ XAIUSDT     ┆ -1.536993    ┆ 7    ┆ 228          │
│ STRKUSDT    ┆ -1.524817    ┆ 8    ┆ 227          │
│ LPTUSDT     ┆ -1.523585    ┆ 9    ┆ 226          │
│ …           ┆ …            ┆ …    ┆ …            │
│ STMXUSDT    ┆ -0.099496    ┆ 226  ┆ 9            │
│ DENTUSDT    ┆ -0.019519    ┆ 227  ┆ 8            │
│ ZENUSDT     ┆ 0.035968     ┆ 228  ┆ 7            │
│ CHRUSDT     ┆ 0.051619     ┆ 229  ┆ 6            │
│ BALUSDT     ┆ 0.094689     ┆ 230  ┆ 5            │
│ SKLUSDT     ┆ 0.199618     ┆ 231  ┆ 4            │
│ DODOXUSDT   ┆ 0.207447     ┆ 232  ┆ 3            │
│ OXTUSDT     ┆ 0.790532     ┆ 233  ┆ 2            │
│ NMRUSDT     ┆ 1.165778     ┆ 234  ┆ 1            │
│ DEFIUSDT    ┆ 1.894555     ┆ 235  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:11,754 - WARNING - 2024-06-10T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:11,754 - INFO - cur close time: 2024-06-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:11,754 - DEBUG - mean expected ret (mean factor): -0.79272293277988
2024-11-20 23:07:11,760 - DEBUG - begin to update pos: =========
2024-11-20 23:07:11,760 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,760 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.027093    ┆ 0.26492     ┆ 0.10634     ┆ 0.0120847   ┆ … ┆ 0.02117 ┆ null   ┆ null    ┆ 0.4554  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,767 - DEBUG - update position: 2024-06-10T23:59:59.999 === diff_trading_value: 243363.86442118004 == cash: 138707.71278312177 
2024-11-20 23:07:11,769 - INFO - pnl: 2024-06-10T23:59:59.999 138707.71278312177 === 0.181%
2024-11-20 23:07:11,773 - DEBUG - cur time: 2024-06-11T23:59:59.999 == next bar open time: 2024-06-12T00:00:00.000 == close pos time: 2024-06-19T00:00:00.000
2024-11-20 23:07:11,777 - INFO - pnl: 2024-06-11T23:59:59.999 140777.90269244625 === 1.492%
2024-11-20 23:07:11,783 - DEBUG - cur time: 2024-06-12T23:59:59.999 == next bar open time: 2024-06-13T00:00:00.000 == close pos time: 2024-06-20T00:00:00.000
2024-11-20 23:07:11,786 - INFO - pnl: 2024-06-12T23:59:59.999 136085.9139858436 === -3.333%
2024-11-20 23:07:11,791 - DEBUG - cur time: 2024-06-13T23:59:59.999 == next bar open time: 2024-06-14T00:00:00.000 == close pos time: 2024-06-21T00:00:00.000
2024-11-20 23:07:11,796 - INFO - pnl: 2024-06-13T23:59:59.999 136606.61945242883 === 0.383%
2024-11-20 23:07:11,801 - DEBUG - cur time: 2024-06-14T23:59:59.999 == next bar open time: 2024-06-15T00:00:00.000 == close pos time: 2024-06-22T00:00:00.000
2024-11-20 23:07:11,803 - INFO - pnl: 2024-06-14T23:59:59.999 137986.8542682133 === 1.010%
2024-11-20 23:07:11,811 - DEBUG - cur time: 2024-06-15T23:59:59.999 == next bar open time: 2024-06-16T00:00:00.000 == close pos time: 2024-06-23T00:00:00.000
2024-11-20 23:07:11,813 - INFO - pnl: 2024-06-15T23:59:59.999 138169.67154252375 === 0.132%
2024-11-20 23:07:11,820 - DEBUG - cur time: 2024-06-16T23:59:59.999 == next bar open time: 2024-06-17T00:00:00.000 == close pos time: 2024-06-24T00:00:00.000
2024-11-20 23:07:11,822 - INFO - pnl: 2024-06-16T23:59:59.999 137712.2622597767 === -0.331%
2024-11-20 23:07:11,829 - DEBUG - cur time: 2024-06-17T23:59:59.999 == next bar open time: 2024-06-18T00:00:00.000 == close pos time: 2024-06-25T00:00:00.000
2024-11-20 23:07:11,854 - DEBUG - sorted_long_factors: shape: (237, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ OMUSDT      ┆ -1.914914    ┆ 0    ┆ 236          │
│ TONUSDT     ┆ -1.914524    ┆ 1    ┆ 235          │
│ MOVRUSDT    ┆ -1.882415    ┆ 2    ┆ 234          │
│ ORDIUSDT    ┆ -1.80308     ┆ 3    ┆ 233          │
│ AUCTIONUSDT ┆ -1.734399    ┆ 4    ┆ 232          │
│ MAVIAUSDT   ┆ -1.730569    ┆ 5    ┆ 231          │
│ ZETAUSDT    ┆ -1.71921     ┆ 6    ┆ 230          │
│ ONDOUSDT    ┆ -1.718566    ┆ 7    ┆ 229          │
│ SUIUSDT     ┆ -1.684512    ┆ 8    ┆ 228          │
│ TRBUSDT     ┆ -1.624511    ┆ 9    ┆ 227          │
│ …           ┆ …            ┆ …    ┆ …            │
│ PERPUSDT    ┆ -0.051601    ┆ 227  ┆ 9            │
│ 1000XECUSDT ┆ -0.003105    ┆ 228  ┆ 8            │
│ NMRUSDT     ┆ 0.018519     ┆ 229  ┆ 7            │
│ AMBUSDT     ┆ 0.045766     ┆ 230  ┆ 6            │
│ JOEUSDT     ┆ 0.077963     ┆ 231  ┆ 5            │
│ BONDUSDT    ┆ 0.098542     ┆ 232  ┆ 4            │
│ HFTUSDT     ┆ 0.237645     ┆ 233  ┆ 3            │
│ NKNUSDT     ┆ 0.274373     ┆ 234  ┆ 2            │
│ DODOXUSDT   ┆ 0.68835      ┆ 235  ┆ 1            │
│ DEFIUSDT    ┆ 1.97836      ┆ 236  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:11,870 - WARNING - 2024-06-17T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:11,870 - INFO - cur close time: 2024-06-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:11,872 - DEBUG - mean expected ret (mean factor): -0.8002189443441423
2024-11-20 23:07:11,878 - DEBUG - begin to update pos: =========
2024-11-20 23:07:11,878 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,878 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022957    ┆ 0.18186     ┆ 0.09484     ┆ 0.011162    ┆ … ┆ 0.01793 ┆ null   ┆ null    ┆ 0.3722  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,890 - DEBUG - update position: 2024-06-17T23:59:59.999 === diff_trading_value: 247369.1647887347 == cash: 139048.89678827365 
2024-11-20 23:07:11,892 - INFO - pnl: 2024-06-17T23:59:59.999 139048.89678827365 === 0.971%
2024-11-20 23:07:11,898 - DEBUG - cur time: 2024-06-18T23:59:59.999 == next bar open time: 2024-06-19T00:00:00.000 == close pos time: 2024-06-26T00:00:00.000
2024-11-20 23:07:11,901 - INFO - pnl: 2024-06-18T23:59:59.999 140353.5131802221 === 0.938%
2024-11-20 23:07:11,911 - DEBUG - cur time: 2024-06-19T23:59:59.999 == next bar open time: 2024-06-20T00:00:00.000 == close pos time: 2024-06-27T00:00:00.000
2024-11-20 23:07:11,915 - INFO - pnl: 2024-06-19T23:59:59.999 139323.24100084582 === -0.734%
2024-11-20 23:07:11,924 - DEBUG - cur time: 2024-06-20T23:59:59.999 == next bar open time: 2024-06-21T00:00:00.000 == close pos time: 2024-06-28T00:00:00.000
2024-11-20 23:07:11,929 - INFO - pnl: 2024-06-20T23:59:59.999 138603.98366814974 === -0.516%
2024-11-20 23:07:11,937 - DEBUG - cur time: 2024-06-21T23:59:59.999 == next bar open time: 2024-06-22T00:00:00.000 == close pos time: 2024-06-29T00:00:00.000
2024-11-20 23:07:11,939 - INFO - pnl: 2024-06-21T23:59:59.999 137269.6117763006 === -0.963%
2024-11-20 23:07:11,945 - DEBUG - cur time: 2024-06-22T23:59:59.999 == next bar open time: 2024-06-23T00:00:00.000 == close pos time: 2024-06-30T00:00:00.000
2024-11-20 23:07:11,948 - INFO - pnl: 2024-06-22T23:59:59.999 138280.00785567137 === 0.736%
2024-11-20 23:07:11,951 - DEBUG - cur time: 2024-06-23T23:59:59.999 == next bar open time: 2024-06-24T00:00:00.000 == close pos time: 2024-07-01T00:00:00.000
2024-11-20 23:07:11,954 - INFO - pnl: 2024-06-23T23:59:59.999 138363.65018498845 === 0.060%
2024-11-20 23:07:11,960 - DEBUG - cur time: 2024-06-24T23:59:59.999 == next bar open time: 2024-06-25T00:00:00.000 == close pos time: 2024-07-02T00:00:00.000
2024-11-20 23:07:11,972 - DEBUG - sorted_long_factors: shape: (238, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT     ┆ -2.328818    ┆ 0    ┆ 237          │
│ AUCTIONUSDT ┆ -2.038247    ┆ 1    ┆ 236          │
│ LPTUSDT     ┆ -1.869464    ┆ 2    ┆ 235          │
│ FXSUSDT     ┆ -1.791536    ┆ 3    ┆ 234          │
│ KNCUSDT     ┆ -1.721535    ┆ 4    ┆ 233          │
│ TONUSDT     ┆ -1.670601    ┆ 5    ┆ 232          │
│ ENSUSDT     ┆ -1.660273    ┆ 6    ┆ 231          │
│ HIGHUSDT    ┆ -1.649393    ┆ 7    ┆ 230          │
│ API3USDT    ┆ -1.610209    ┆ 8    ┆ 229          │
│ PEOPLEUSDT  ┆ -1.60983     ┆ 9    ┆ 228          │
│ …           ┆ …            ┆ …    ┆ …            │
│ AMBUSDT     ┆ 0.124897     ┆ 228  ┆ 9            │
│ ETHWUSDT    ┆ 0.159037     ┆ 229  ┆ 8            │
│ BONDUSDT    ┆ 0.187631     ┆ 230  ┆ 7            │
│ BANDUSDT    ┆ 0.33318      ┆ 231  ┆ 6            │
│ NMRUSDT     ┆ 0.407877     ┆ 232  ┆ 5            │
│ DODOXUSDT   ┆ 0.41645      ┆ 233  ┆ 4            │
│ DARUSDT     ┆ 0.42803      ┆ 234  ┆ 3            │
│ JOEUSDT     ┆ 0.636778     ┆ 235  ┆ 2            │
│ OXTUSDT     ┆ 0.702677     ┆ 236  ┆ 1            │
│ DEFIUSDT    ┆ 1.99352      ┆ 237  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:11,982 - WARNING - 2024-06-24T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:11,983 - INFO - cur close time: 2024-06-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:11,983 - DEBUG - mean expected ret (mean factor): -0.7818585492282609
2024-11-20 23:07:11,987 - DEBUG - begin to update pos: =========
2024-11-20 23:07:11,988 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,988 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.021748    ┆ 0.16777     ┆ 0.08155     ┆ 0.0112924   ┆ … ┆ 0.01728 ┆ null   ┆ null    ┆ 0.3606  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:11,997 - DEBUG - update position: 2024-06-24T23:59:59.999 === diff_trading_value: 213018.41645241508 == cash: 136557.6920653684 
2024-11-20 23:07:12,000 - INFO - pnl: 2024-06-24T23:59:59.999 136557.6920653684 === -1.305%
2024-11-20 23:07:12,007 - DEBUG - cur time: 2024-06-25T23:59:59.999 == next bar open time: 2024-06-26T00:00:00.000 == close pos time: 2024-07-03T00:00:00.000
2024-11-20 23:07:12,010 - INFO - pnl: 2024-06-25T23:59:59.999 136058.78662035614 === -0.365%
2024-11-20 23:07:12,016 - DEBUG - cur time: 2024-06-26T23:59:59.999 == next bar open time: 2024-06-27T00:00:00.000 == close pos time: 2024-07-04T00:00:00.000
2024-11-20 23:07:12,018 - INFO - pnl: 2024-06-26T23:59:59.999 136458.2977237749 === 0.294%
2024-11-20 23:07:12,024 - DEBUG - cur time: 2024-06-27T23:59:59.999 == next bar open time: 2024-06-28T00:00:00.000 == close pos time: 2024-07-05T00:00:00.000
2024-11-20 23:07:12,027 - INFO - pnl: 2024-06-27T23:59:59.999 136672.90748501164 === 0.157%
2024-11-20 23:07:12,031 - DEBUG - cur time: 2024-06-28T23:59:59.999 == next bar open time: 2024-06-29T00:00:00.000 == close pos time: 2024-07-06T00:00:00.000
2024-11-20 23:07:12,033 - INFO - pnl: 2024-06-28T23:59:59.999 138125.6367901532 === 1.063%
2024-11-20 23:07:12,038 - DEBUG - cur time: 2024-06-29T23:59:59.999 == next bar open time: 2024-06-30T00:00:00.000 == close pos time: 2024-07-07T00:00:00.000
2024-11-20 23:07:12,040 - INFO - pnl: 2024-06-29T23:59:59.999 136686.04678110435 === -1.042%
2024-11-20 23:07:12,049 - DEBUG - cur time: 2024-06-30T23:59:59.999 == next bar open time: 2024-07-01T00:00:00.000 == close pos time: 2024-07-08T00:00:00.000
2024-11-20 23:07:12,051 - INFO - pnl: 2024-06-30T23:59:59.999 137950.64631613798 === 0.925%
2024-11-20 23:07:12,057 - DEBUG - cur time: 2024-07-01T23:59:59.999 == next bar open time: 2024-07-02T00:00:00.000 == close pos time: 2024-07-09T00:00:00.000
2024-11-20 23:07:12,069 - DEBUG - sorted_long_factors: shape: (240, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TONUSDT      ┆ -2.190413    ┆ 0    ┆ 239          │
│ BAKEUSDT     ┆ -2.073425    ┆ 1    ┆ 238          │
│ MANTAUSDT    ┆ -2.012225    ┆ 2    ┆ 237          │
│ LSKUSDT      ┆ -1.992212    ┆ 3    ┆ 236          │
│ JUPUSDT      ┆ -1.949712    ┆ 4    ┆ 235          │
│ ARUSDT       ┆ -1.869464    ┆ 5    ┆ 234          │
│ BTCDOMUSDT   ┆ -1.832019    ┆ 6    ┆ 233          │
│ GASUSDT      ┆ -1.796589    ┆ 7    ┆ 232          │
│ ENSUSDT      ┆ -1.75679     ┆ 8    ┆ 231          │
│ 1000LUNCUSDT ┆ -1.747031    ┆ 9    ┆ 230          │
│ …            ┆ …            ┆ …    ┆ …            │
│ OMGUSDT      ┆ 0.137369     ┆ 230  ┆ 9            │
│ PERPUSDT     ┆ 0.166877     ┆ 231  ┆ 8            │
│ BNTUSDT      ┆ 0.251334     ┆ 232  ┆ 7            │
│ DASHUSDT     ┆ 0.27136      ┆ 233  ┆ 6            │
│ NMRUSDT      ┆ 0.331158     ┆ 234  ┆ 5            │
│ DARUSDT      ┆ 0.349228     ┆ 235  ┆ 4            │
│ DODOXUSDT    ┆ 0.460728     ┆ 236  ┆ 3            │
│ HFTUSDT      ┆ 0.568191     ┆ 237  ┆ 2            │
│ OXTUSDT      ┆ 0.947887     ┆ 238  ┆ 1            │
│ DEFIUSDT     ┆ 1.824793     ┆ 239  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:12,076 - WARNING - 2024-07-01T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:12,076 - INFO - cur close time: 2024-07-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:12,076 - DEBUG - mean expected ret (mean factor): -0.7862258121936956
2024-11-20 23:07:12,081 - DEBUG - begin to update pos: =========
2024-11-20 23:07:12,082 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,083 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025564    ┆ 0.17017     ┆ 0.08077     ┆ 0.0114216   ┆ … ┆ 0.01715 ┆ null   ┆ null    ┆ 0.3567  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,089 - DEBUG - update position: 2024-07-01T23:59:59.999 === diff_trading_value: 264665.4518672181 == cash: 136886.78452911577 
2024-11-20 23:07:12,091 - INFO - pnl: 2024-07-01T23:59:59.999 136886.78452911577 === -0.771%
2024-11-20 23:07:12,097 - DEBUG - cur time: 2024-07-02T23:59:59.999 == next bar open time: 2024-07-03T00:00:00.000 == close pos time: 2024-07-10T00:00:00.000
2024-11-20 23:07:12,099 - INFO - pnl: 2024-07-02T23:59:59.999 135905.26354515005 === -0.717%
2024-11-20 23:07:12,105 - DEBUG - cur time: 2024-07-03T23:59:59.999 == next bar open time: 2024-07-04T00:00:00.000 == close pos time: 2024-07-11T00:00:00.000
2024-11-20 23:07:12,109 - INFO - pnl: 2024-07-03T23:59:59.999 138633.80796775126 === 2.008%
2024-11-20 23:07:12,121 - DEBUG - cur time: 2024-07-04T23:59:59.999 == next bar open time: 2024-07-05T00:00:00.000 == close pos time: 2024-07-12T00:00:00.000
2024-11-20 23:07:12,125 - INFO - pnl: 2024-07-04T23:59:59.999 136673.46007230593 === -1.414%
2024-11-20 23:07:12,136 - DEBUG - cur time: 2024-07-05T23:59:59.999 == next bar open time: 2024-07-06T00:00:00.000 == close pos time: 2024-07-13T00:00:00.000
2024-11-20 23:07:12,143 - INFO - pnl: 2024-07-05T23:59:59.999 136686.9710961221 === 0.010%
2024-11-20 23:07:12,151 - DEBUG - cur time: 2024-07-06T23:59:59.999 == next bar open time: 2024-07-07T00:00:00.000 == close pos time: 2024-07-14T00:00:00.000
2024-11-20 23:07:12,154 - INFO - pnl: 2024-07-06T23:59:59.999 135418.43852487125 === -0.928%
2024-11-20 23:07:12,161 - DEBUG - cur time: 2024-07-07T23:59:59.999 == next bar open time: 2024-07-08T00:00:00.000 == close pos time: 2024-07-15T00:00:00.000
2024-11-20 23:07:12,164 - INFO - pnl: 2024-07-07T23:59:59.999 135230.79225223258 === -0.139%
2024-11-20 23:07:12,172 - DEBUG - cur time: 2024-07-08T23:59:59.999 == next bar open time: 2024-07-09T00:00:00.000 == close pos time: 2024-07-16T00:00:00.000
2024-11-20 23:07:12,188 - DEBUG - sorted_long_factors: shape: (239, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ OMUSDT     ┆ -2.235335    ┆ 0    ┆ 238          │
│ ZENUSDT    ┆ -2.111174    ┆ 1    ┆ 237          │
│ JUPUSDT    ┆ -2.027402    ┆ 2    ┆ 236          │
│ YFIUSDT    ┆ -1.894466    ┆ 3    ┆ 235          │
│ TONUSDT    ┆ -1.86886     ┆ 4    ┆ 234          │
│ EGLDUSDT   ┆ -1.770703    ┆ 5    ┆ 233          │
│ DYMUSDT    ┆ -1.736383    ┆ 6    ┆ 232          │
│ MTLUSDT    ┆ -1.704894    ┆ 7    ┆ 231          │
│ ENSUSDT    ┆ -1.646503    ┆ 8    ┆ 230          │
│ LDOUSDT    ┆ -1.621607    ┆ 9    ┆ 229          │
│ …          ┆ …            ┆ …    ┆ …            │
│ NKNUSDT    ┆ 0.049039     ┆ 229  ┆ 9            │
│ LITUSDT    ┆ 0.050748     ┆ 230  ┆ 8            │
│ AGLDUSDT   ┆ 0.094327     ┆ 231  ┆ 7            │
│ RIFUSDT    ┆ 0.102287     ┆ 232  ┆ 6            │
│ SUPERUSDT  ┆ 0.173948     ┆ 233  ┆ 5            │
│ STEEMUSDT  ┆ 0.260524     ┆ 234  ┆ 4            │
│ BADGERUSDT ┆ 0.261426     ┆ 235  ┆ 3            │
│ DODOXUSDT  ┆ 1.023442     ┆ 236  ┆ 2            │
│ OXTUSDT    ┆ 1.038765     ┆ 237  ┆ 1            │
│ DEFIUSDT   ┆ 1.451427     ┆ 238  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:12,198 - WARNING - 2024-07-08T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:12,198 - INFO - cur close time: 2024-07-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:12,198 - DEBUG - mean expected ret (mean factor): -0.7861631677956075
2024-11-20 23:07:12,206 - DEBUG - begin to update pos: =========
2024-11-20 23:07:12,207 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,207 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023955    ┆ 0.1415      ┆ 0.06933     ┆ 0.0091432   ┆ … ┆ 0.01483 ┆ null   ┆ null    ┆ 0.3012  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,223 - DEBUG - update position: 2024-07-08T23:59:59.999 === diff_trading_value: 242147.47660357883 == cash: 134568.4505097774 
2024-11-20 23:07:12,225 - INFO - pnl: 2024-07-08T23:59:59.999 134568.4505097774 === -0.490%
2024-11-20 23:07:12,233 - DEBUG - cur time: 2024-07-09T23:59:59.999 == next bar open time: 2024-07-10T00:00:00.000 == close pos time: 2024-07-17T00:00:00.000
2024-11-20 23:07:12,236 - INFO - pnl: 2024-07-09T23:59:59.999 131151.2499466184 === -2.539%
2024-11-20 23:07:12,248 - DEBUG - cur time: 2024-07-10T23:59:59.999 == next bar open time: 2024-07-11T00:00:00.000 == close pos time: 2024-07-18T00:00:00.000
2024-11-20 23:07:12,253 - INFO - pnl: 2024-07-10T23:59:59.999 131401.402026808 === 0.191%
2024-11-20 23:07:12,261 - DEBUG - cur time: 2024-07-11T23:59:59.999 == next bar open time: 2024-07-12T00:00:00.000 == close pos time: 2024-07-19T00:00:00.000
2024-11-20 23:07:12,264 - INFO - pnl: 2024-07-11T23:59:59.999 131303.21269503664 === -0.075%
2024-11-20 23:07:12,270 - DEBUG - cur time: 2024-07-12T23:59:59.999 == next bar open time: 2024-07-13T00:00:00.000 == close pos time: 2024-07-20T00:00:00.000
2024-11-20 23:07:12,271 - INFO - pnl: 2024-07-12T23:59:59.999 134281.16662934877 === 2.268%
2024-11-20 23:07:12,277 - DEBUG - cur time: 2024-07-13T23:59:59.999 == next bar open time: 2024-07-14T00:00:00.000 == close pos time: 2024-07-21T00:00:00.000
2024-11-20 23:07:12,279 - INFO - pnl: 2024-07-13T23:59:59.999 134354.52303354943 === 0.055%
2024-11-20 23:07:12,283 - DEBUG - cur time: 2024-07-14T23:59:59.999 == next bar open time: 2024-07-15T00:00:00.000 == close pos time: 2024-07-22T00:00:00.000
2024-11-20 23:07:12,284 - INFO - pnl: 2024-07-14T23:59:59.999 136922.2110228129 === 1.911%
2024-11-20 23:07:12,287 - DEBUG - cur time: 2024-07-15T23:59:59.999 == next bar open time: 2024-07-16T00:00:00.000 == close pos time: 2024-07-23T00:00:00.000
2024-11-20 23:07:12,298 - DEBUG - sorted_long_factors: shape: (240, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TONUSDT   ┆ -1.899753    ┆ 0    ┆ 239          │
│ OMUSDT    ┆ -1.893889    ┆ 1    ┆ 238          │
│ GASUSDT   ┆ -1.826436    ┆ 2    ┆ 237          │
│ ETHFIUSDT ┆ -1.782754    ┆ 3    ┆ 236          │
│ MKRUSDT   ┆ -1.778419    ┆ 4    ┆ 235          │
│ DYMUSDT   ┆ -1.748887    ┆ 5    ┆ 234          │
│ DASHUSDT  ┆ -1.728207    ┆ 6    ┆ 233          │
│ AAVEUSDT  ┆ -1.686749    ┆ 7    ┆ 232          │
│ UNFIUSDT  ┆ -1.628059    ┆ 8    ┆ 231          │
│ WIFUSDT   ┆ -1.62665     ┆ 9    ┆ 230          │
│ …         ┆ …            ┆ …    ┆ …            │
│ STEEMUSDT ┆ 0.146464     ┆ 230  ┆ 9            │
│ TUSDT     ┆ 0.187934     ┆ 231  ┆ 8            │
│ RENUSDT   ┆ 0.226944     ┆ 232  ┆ 7            │
│ HFTUSDT   ┆ 0.258983     ┆ 233  ┆ 6            │
│ XEMUSDT   ┆ 0.308319     ┆ 234  ┆ 5            │
│ XVGUSDT   ┆ 0.388942     ┆ 235  ┆ 4            │
│ BNTUSDT   ┆ 0.447002     ┆ 236  ┆ 3            │
│ ORBSUSDT  ┆ 0.587062     ┆ 237  ┆ 2            │
│ DODOXUSDT ┆ 0.895787     ┆ 238  ┆ 1            │
│ DEFIUSDT  ┆ 1.606983     ┆ 239  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:12,307 - WARNING - 2024-07-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:12,307 - INFO - cur close time: 2024-07-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:12,307 - DEBUG - mean expected ret (mean factor): -0.7972981980590779
2024-11-20 23:07:12,311 - DEBUG - begin to update pos: =========
2024-11-20 23:07:12,311 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,311 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.026677    ┆ 0.18315     ┆ 0.08109     ┆ 0.0113156   ┆ … ┆ 0.01729 ┆ null   ┆ null    ┆ 0.3634  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,321 - DEBUG - update position: 2024-07-15T23:59:59.999 === diff_trading_value: 294375.77530053427 == cash: 136469.85893122214 
2024-11-20 23:07:12,323 - INFO - pnl: 2024-07-15T23:59:59.999 136469.85893122214 === -0.330%
2024-11-20 23:07:12,328 - DEBUG - cur time: 2024-07-16T23:59:59.999 == next bar open time: 2024-07-17T00:00:00.000 == close pos time: 2024-07-24T00:00:00.000
2024-11-20 23:07:12,330 - INFO - pnl: 2024-07-16T23:59:59.999 136478.44369878218 === 0.006%
2024-11-20 23:07:12,335 - DEBUG - cur time: 2024-07-17T23:59:59.999 == next bar open time: 2024-07-18T00:00:00.000 == close pos time: 2024-07-25T00:00:00.000
2024-11-20 23:07:12,339 - INFO - pnl: 2024-07-17T23:59:59.999 134981.51706095514 === -1.097%
2024-11-20 23:07:12,343 - DEBUG - cur time: 2024-07-18T23:59:59.999 == next bar open time: 2024-07-19T00:00:00.000 == close pos time: 2024-07-26T00:00:00.000
2024-11-20 23:07:12,344 - INFO - pnl: 2024-07-18T23:59:59.999 133328.321758169 === -1.225%
2024-11-20 23:07:12,348 - DEBUG - cur time: 2024-07-19T23:59:59.999 == next bar open time: 2024-07-20T00:00:00.000 == close pos time: 2024-07-27T00:00:00.000
2024-11-20 23:07:12,350 - INFO - pnl: 2024-07-19T23:59:59.999 135091.3922924005 === 1.322%
2024-11-20 23:07:12,354 - DEBUG - cur time: 2024-07-20T23:59:59.999 == next bar open time: 2024-07-21T00:00:00.000 == close pos time: 2024-07-28T00:00:00.000
2024-11-20 23:07:12,356 - INFO - pnl: 2024-07-20T23:59:59.999 134917.3780052718 === -0.129%
2024-11-20 23:07:12,359 - DEBUG - cur time: 2024-07-21T23:59:59.999 == next bar open time: 2024-07-22T00:00:00.000 == close pos time: 2024-07-29T00:00:00.000
2024-11-20 23:07:12,361 - INFO - pnl: 2024-07-21T23:59:59.999 136630.9238016456 === 1.270%
2024-11-20 23:07:12,364 - DEBUG - cur time: 2024-07-22T23:59:59.999 == next bar open time: 2024-07-23T00:00:00.000 == close pos time: 2024-07-30T00:00:00.000
2024-11-20 23:07:12,374 - DEBUG - sorted_long_factors: shape: (243, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ STRKUSDT   ┆ -1.7886      ┆ 0    ┆ 242          │
│ JUPUSDT    ┆ -1.699707    ┆ 1    ┆ 241          │
│ TONUSDT    ┆ -1.698148    ┆ 2    ┆ 240          │
│ MANTAUSDT  ┆ -1.674536    ┆ 3    ┆ 239          │
│ ETHFIUSDT  ┆ -1.665042    ┆ 4    ┆ 238          │
│ TIAUSDT    ┆ -1.613947    ┆ 5    ┆ 237          │
│ AEVOUSDT   ┆ -1.609186    ┆ 6    ┆ 236          │
│ PIXELUSDT  ┆ -1.603135    ┆ 7    ┆ 235          │
│ WUSDT      ┆ -1.559169    ┆ 8    ┆ 234          │
│ PORTALUSDT ┆ -1.559057    ┆ 9    ┆ 233          │
│ …          ┆ …            ┆ …    ┆ …            │
│ XVGUSDT    ┆ -0.151       ┆ 233  ┆ 9            │
│ SKLUSDT    ┆ -0.12688     ┆ 234  ┆ 8            │
│ BADGERUSDT ┆ -0.029293    ┆ 235  ┆ 7            │
│ STORJUSDT  ┆ 0.008302     ┆ 236  ┆ 6            │
│ LQTYUSDT   ┆ 0.030247     ┆ 237  ┆ 5            │
│ BNTUSDT    ┆ 0.182365     ┆ 238  ┆ 4            │
│ ETHWUSDT   ┆ 0.397324     ┆ 239  ┆ 3            │
│ ICPUSDT    ┆ 0.43181      ┆ 240  ┆ 2            │
│ DODOXUSDT  ┆ 0.8424       ┆ 241  ┆ 1            │
│ DEFIUSDT   ┆ 2.24647      ┆ 242  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:12,380 - WARNING - 2024-07-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:12,381 - INFO - cur close time: 2024-07-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:12,381 - DEBUG - mean expected ret (mean factor): -0.8059680830360942
2024-11-20 23:07:12,385 - DEBUG - begin to update pos: =========
2024-11-20 23:07:12,385 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,385 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.029975    ┆ 0.19362     ┆ 0.0883      ┆ 0.0118821   ┆ … ┆ 0.01736 ┆ null   ┆ null    ┆ 0.3736  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,391 - DEBUG - update position: 2024-07-22T23:59:59.999 === diff_trading_value: 317985.86050907377 == cash: 136636.59604199164 
2024-11-20 23:07:12,392 - INFO - pnl: 2024-07-22T23:59:59.999 136636.59604199164 === 0.004%
2024-11-20 23:07:12,395 - DEBUG - cur time: 2024-07-23T23:59:59.999 == next bar open time: 2024-07-24T00:00:00.000 == close pos time: 2024-07-31T00:00:00.000
2024-11-20 23:07:12,397 - INFO - pnl: 2024-07-23T23:59:59.999 138343.25120302357 === 1.249%
2024-11-20 23:07:12,400 - DEBUG - cur time: 2024-07-24T23:59:59.999 == next bar open time: 2024-07-25T00:00:00.000 == close pos time: 2024-08-01T00:00:00.000
2024-11-20 23:07:12,401 - INFO - pnl: 2024-07-24T23:59:59.999 140602.9942761612 === 1.633%
2024-11-20 23:07:12,405 - DEBUG - cur time: 2024-07-25T23:59:59.999 == next bar open time: 2024-07-26T00:00:00.000 == close pos time: 2024-08-02T00:00:00.000
2024-11-20 23:07:12,406 - INFO - pnl: 2024-07-25T23:59:59.999 143202.5719120148 === 1.849%
2024-11-20 23:07:12,409 - DEBUG - cur time: 2024-07-26T23:59:59.999 == next bar open time: 2024-07-27T00:00:00.000 == close pos time: 2024-08-03T00:00:00.000
2024-11-20 23:07:12,410 - INFO - pnl: 2024-07-26T23:59:59.999 143443.18048042836 === 0.168%
2024-11-20 23:07:12,414 - DEBUG - cur time: 2024-07-27T23:59:59.999 == next bar open time: 2024-07-28T00:00:00.000 == close pos time: 2024-08-04T00:00:00.000
2024-11-20 23:07:12,415 - INFO - pnl: 2024-07-27T23:59:59.999 144739.31724875534 === 0.904%
2024-11-20 23:07:12,420 - DEBUG - cur time: 2024-07-28T23:59:59.999 == next bar open time: 2024-07-29T00:00:00.000 == close pos time: 2024-08-05T00:00:00.000
2024-11-20 23:07:12,421 - INFO - pnl: 2024-07-28T23:59:59.999 145872.31721316456 === 0.783%
2024-11-20 23:07:12,425 - DEBUG - cur time: 2024-07-29T23:59:59.999 == next bar open time: 2024-07-30T00:00:00.000 == close pos time: 2024-08-06T00:00:00.000
2024-11-20 23:07:12,436 - DEBUG - sorted_long_factors: shape: (244, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ETHFIUSDT ┆ -2.125052    ┆ 0    ┆ 243          │
│ OMUSDT    ┆ -2.105508    ┆ 1    ┆ 242          │
│ JUPUSDT   ┆ -1.891106    ┆ 2    ┆ 241          │
│ ENSUSDT   ┆ -1.786369    ┆ 3    ┆ 240          │
│ MKRUSDT   ┆ -1.783164    ┆ 4    ┆ 239          │
│ XMRUSDT   ┆ -1.774095    ┆ 5    ┆ 238          │
│ STRKUSDT  ┆ -1.766243    ┆ 6    ┆ 237          │
│ TNSRUSDT  ┆ -1.753299    ┆ 7    ┆ 236          │
│ XRPUSDT   ┆ -1.739581    ┆ 8    ┆ 235          │
│ TONUSDT   ┆ -1.734089    ┆ 9    ┆ 234          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ALPHAUSDT ┆ 0.127059     ┆ 234  ┆ 9            │
│ LRCUSDT   ┆ 0.143291     ┆ 235  ┆ 8            │
│ LQTYUSDT  ┆ 0.165794     ┆ 236  ┆ 7            │
│ AGLDUSDT  ┆ 0.206773     ┆ 237  ┆ 6            │
│ ATAUSDT   ┆ 0.300225     ┆ 238  ┆ 5            │
│ DODOXUSDT ┆ 0.316614     ┆ 239  ┆ 4            │
│ COMBOUSDT ┆ 0.383138     ┆ 240  ┆ 3            │
│ XVGUSDT   ┆ 0.463884     ┆ 241  ┆ 2            │
│ BICOUSDT  ┆ 0.640179     ┆ 242  ┆ 1            │
│ DEFIUSDT  ┆ 1.223197     ┆ 243  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:12,446 - INFO - cur close time: 2024-07-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:12,447 - DEBUG - mean expected ret (mean factor): -0.7987404586280709
2024-11-20 23:07:12,455 - DEBUG - begin to update pos: =========
2024-11-20 23:07:12,456 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,456 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.026912    ┆ 0.17203     ┆ 0.08284     ┆ 0.0117892   ┆ … ┆ 0.01715 ┆ null   ┆ null    ┆ 0.3772  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,466 - DEBUG - update position: 2024-07-29T23:59:59.999 === diff_trading_value: 238772.44010947822 == cash: 147749.09008148155 
2024-11-20 23:07:12,469 - INFO - pnl: 2024-07-29T23:59:59.999 147749.09008148155 === 1.287%
2024-11-20 23:07:12,475 - DEBUG - cur time: 2024-07-30T23:59:59.999 == next bar open time: 2024-07-31T00:00:00.000 == close pos time: 2024-08-07T00:00:00.000
2024-11-20 23:07:12,477 - INFO - pnl: 2024-07-30T23:59:59.999 146149.60344843456 === -1.083%
2024-11-20 23:07:12,482 - DEBUG - cur time: 2024-07-31T23:59:59.999 == next bar open time: 2024-08-01T00:00:00.000 == close pos time: 2024-08-08T00:00:00.000
2024-11-20 23:07:12,484 - INFO - pnl: 2024-07-31T23:59:59.999 146264.89384207537 === 0.079%
2024-11-20 23:07:12,488 - DEBUG - cur time: 2024-08-01T23:59:59.999 == next bar open time: 2024-08-02T00:00:00.000 == close pos time: 2024-08-09T00:00:00.000
2024-11-20 23:07:12,489 - INFO - pnl: 2024-08-01T23:59:59.999 146103.47766570433 === -0.110%
2024-11-20 23:07:12,493 - DEBUG - cur time: 2024-08-02T23:59:59.999 == next bar open time: 2024-08-03T00:00:00.000 == close pos time: 2024-08-10T00:00:00.000
2024-11-20 23:07:12,494 - INFO - pnl: 2024-08-02T23:59:59.999 146874.6631936938 === 0.528%
2024-11-20 23:07:12,497 - DEBUG - cur time: 2024-08-03T23:59:59.999 == next bar open time: 2024-08-04T00:00:00.000 == close pos time: 2024-08-11T00:00:00.000
2024-11-20 23:07:12,498 - INFO - pnl: 2024-08-03T23:59:59.999 147102.149166755 === 0.155%
2024-11-20 23:07:12,503 - DEBUG - cur time: 2024-08-04T23:59:59.999 == next bar open time: 2024-08-05T00:00:00.000 == close pos time: 2024-08-12T00:00:00.000
2024-11-20 23:07:12,504 - INFO - pnl: 2024-08-04T23:59:59.999 147038.17416275246 === -0.043%
2024-11-20 23:07:12,509 - DEBUG - cur time: 2024-08-05T23:59:59.999 == next bar open time: 2024-08-06T00:00:00.000 == close pos time: 2024-08-13T00:00:00.000
2024-11-20 23:07:12,518 - DEBUG - sorted_long_factors: shape: (244, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT ┆ -2.013158    ┆ 0    ┆ 243          │
│ USDCUSDT   ┆ -1.816462    ┆ 1    ┆ 242          │
│ BNXUSDT    ┆ -1.745733    ┆ 2    ┆ 241          │
│ BOMEUSDT   ┆ -1.732075    ┆ 3    ┆ 240          │
│ AMBUSDT    ┆ -1.675733    ┆ 4    ┆ 239          │
│ STRKUSDT   ┆ -1.616252    ┆ 5    ┆ 238          │
│ AAVEUSDT   ┆ -1.608545    ┆ 6    ┆ 237          │
│ TONUSDT    ┆ -1.606972    ┆ 7    ┆ 236          │
│ OMUSDT     ┆ -1.601251    ┆ 8    ┆ 235          │
│ WUSDT      ┆ -1.593297    ┆ 9    ┆ 234          │
│ …          ┆ …            ┆ …    ┆ …            │
│ HOOKUSDT   ┆ 0.234107     ┆ 234  ┆ 9            │
│ BELUSDT    ┆ 0.258986     ┆ 235  ┆ 8            │
│ COMBOUSDT  ┆ 0.260372     ┆ 236  ┆ 7            │
│ JOEUSDT    ┆ 0.299083     ┆ 237  ┆ 6            │
│ MOVRUSDT   ┆ 0.316388     ┆ 238  ┆ 5            │
│ BNTUSDT    ┆ 0.382148     ┆ 239  ┆ 4            │
│ HFTUSDT    ┆ 0.385149     ┆ 240  ┆ 3            │
│ AGLDUSDT   ┆ 0.49502      ┆ 241  ┆ 2            │
│ ETHWUSDT   ┆ 0.995423     ┆ 242  ┆ 1            │
│ DEFIUSDT   ┆ 1.597677     ┆ 243  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:12,525 - WARNING - 2024-08-05T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:12,525 - INFO - cur close time: 2024-08-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:12,525 - DEBUG - mean expected ret (mean factor): -0.801272144228325
2024-11-20 23:07:12,530 - DEBUG - begin to update pos: =========
2024-11-20 23:07:12,530 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,530 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.017897    ┆ 0.11013     ┆ 0.06385     ┆ 0.007045    ┆ … ┆ 0.01235 ┆ null   ┆ null    ┆ 0.2606  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,536 - DEBUG - update position: 2024-08-05T23:59:59.999 === diff_trading_value: 232572.04476460975 == cash: 147877.23419582527 
2024-11-20 23:07:12,541 - INFO - pnl: 2024-08-05T23:59:59.999 147877.23419582527 === 0.571%
2024-11-20 23:07:12,548 - DEBUG - cur time: 2024-08-06T23:59:59.999 == next bar open time: 2024-08-07T00:00:00.000 == close pos time: 2024-08-14T00:00:00.000
2024-11-20 23:07:12,550 - INFO - pnl: 2024-08-06T23:59:59.999 146351.40940655634 === -1.032%
2024-11-20 23:07:12,557 - DEBUG - cur time: 2024-08-07T23:59:59.999 == next bar open time: 2024-08-08T00:00:00.000 == close pos time: 2024-08-15T00:00:00.000
2024-11-20 23:07:12,561 - INFO - pnl: 2024-08-07T23:59:59.999 146957.42634564507 === 0.414%
2024-11-20 23:07:12,567 - DEBUG - cur time: 2024-08-08T23:59:59.999 == next bar open time: 2024-08-09T00:00:00.000 == close pos time: 2024-08-16T00:00:00.000
2024-11-20 23:07:12,569 - INFO - pnl: 2024-08-08T23:59:59.999 148556.07931213186 === 1.088%
2024-11-20 23:07:12,578 - DEBUG - cur time: 2024-08-09T23:59:59.999 == next bar open time: 2024-08-10T00:00:00.000 == close pos time: 2024-08-17T00:00:00.000
2024-11-20 23:07:12,579 - INFO - pnl: 2024-08-09T23:59:59.999 148947.7080658193 === 0.264%
2024-11-20 23:07:12,585 - DEBUG - cur time: 2024-08-10T23:59:59.999 == next bar open time: 2024-08-11T00:00:00.000 == close pos time: 2024-08-18T00:00:00.000
2024-11-20 23:07:12,586 - INFO - pnl: 2024-08-10T23:59:59.999 150750.63155346242 === 1.210%
2024-11-20 23:07:12,589 - DEBUG - cur time: 2024-08-11T23:59:59.999 == next bar open time: 2024-08-12T00:00:00.000 == close pos time: 2024-08-19T00:00:00.000
2024-11-20 23:07:12,590 - INFO - pnl: 2024-08-11T23:59:59.999 150976.99904185848 === 0.150%
2024-11-20 23:07:12,593 - DEBUG - cur time: 2024-08-12T23:59:59.999 == next bar open time: 2024-08-13T00:00:00.000 == close pos time: 2024-08-20T00:00:00.000
2024-11-20 23:07:12,601 - DEBUG - sorted_long_factors: shape: (245, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT ┆ -2.465506    ┆ 0    ┆ 244          │
│ SAGAUSDT   ┆ -2.293964    ┆ 1    ┆ 243          │
│ GLMUSDT    ┆ -2.265974    ┆ 2    ┆ 242          │
│ TONUSDT    ┆ -2.2502      ┆ 3    ┆ 241          │
│ ZETAUSDT   ┆ -2.228634    ┆ 4    ┆ 240          │
│ FXSUSDT    ┆ -2.200559    ┆ 5    ┆ 239          │
│ ACEUSDT    ┆ -2.113118    ┆ 6    ┆ 238          │
│ USDCUSDT   ┆ -1.951902    ┆ 7    ┆ 237          │
│ WUSDT      ┆ -1.921063    ┆ 8    ┆ 236          │
│ AEVOUSDT   ┆ -1.908492    ┆ 9    ┆ 235          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BICOUSDT   ┆ 0.214908     ┆ 235  ┆ 9            │
│ PERPUSDT   ┆ 0.251952     ┆ 236  ┆ 8            │
│ OXTUSDT    ┆ 0.261605     ┆ 237  ┆ 7            │
│ NMRUSDT    ┆ 0.319267     ┆ 238  ┆ 6            │
│ NTRNUSDT   ┆ 0.330238     ┆ 239  ┆ 5            │
│ AGLDUSDT   ┆ 0.42959      ┆ 240  ┆ 4            │
│ RLCUSDT    ┆ 0.474165     ┆ 241  ┆ 3            │
│ JOEUSDT    ┆ 0.763213     ┆ 242  ┆ 2            │
│ DODOXUSDT  ┆ 1.23493      ┆ 243  ┆ 1            │
│ DEFIUSDT   ┆ 1.446715     ┆ 244  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:12,609 - WARNING - 2024-08-12T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:12,609 - INFO - cur close time: 2024-08-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:12,610 - DEBUG - mean expected ret (mean factor): -0.8092421558332932
2024-11-20 23:07:12,613 - DEBUG - begin to update pos: =========
2024-11-20 23:07:12,614 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,614 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.019999    ┆ 0.12418     ┆ 0.07915     ┆ 0.0082246   ┆ … ┆ 0.01394 ┆ null   ┆ null    ┆ 0.3102  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,623 - DEBUG - update position: 2024-08-12T23:59:59.999 === diff_trading_value: 219888.41373033455 == cash: 153830.03162312025 
2024-11-20 23:07:12,625 - INFO - pnl: 2024-08-12T23:59:59.999 153830.03162312025 === 1.890%
2024-11-20 23:07:12,631 - DEBUG - cur time: 2024-08-13T23:59:59.999 == next bar open time: 2024-08-14T00:00:00.000 == close pos time: 2024-08-21T00:00:00.000
2024-11-20 23:07:12,633 - INFO - pnl: 2024-08-13T23:59:59.999 154166.38501537213 === 0.219%
2024-11-20 23:07:12,640 - DEBUG - cur time: 2024-08-14T23:59:59.999 == next bar open time: 2024-08-15T00:00:00.000 == close pos time: 2024-08-22T00:00:00.000
2024-11-20 23:07:12,645 - INFO - pnl: 2024-08-14T23:59:59.999 154012.32117668915 === -0.100%
2024-11-20 23:07:12,649 - DEBUG - cur time: 2024-08-15T23:59:59.999 == next bar open time: 2024-08-16T00:00:00.000 == close pos time: 2024-08-23T00:00:00.000
2024-11-20 23:07:12,651 - INFO - pnl: 2024-08-15T23:59:59.999 153984.88564485437 === -0.018%
2024-11-20 23:07:12,662 - DEBUG - cur time: 2024-08-16T23:59:59.999 == next bar open time: 2024-08-17T00:00:00.000 == close pos time: 2024-08-24T00:00:00.000
2024-11-20 23:07:12,666 - INFO - pnl: 2024-08-16T23:59:59.999 154887.31075195863 === 0.586%
2024-11-20 23:07:12,675 - DEBUG - cur time: 2024-08-17T23:59:59.999 == next bar open time: 2024-08-18T00:00:00.000 == close pos time: 2024-08-25T00:00:00.000
2024-11-20 23:07:12,681 - INFO - pnl: 2024-08-17T23:59:59.999 157615.39392832536 === 1.761%
2024-11-20 23:07:12,689 - DEBUG - cur time: 2024-08-18T23:59:59.999 == next bar open time: 2024-08-19T00:00:00.000 == close pos time: 2024-08-26T00:00:00.000
2024-11-20 23:07:12,692 - INFO - pnl: 2024-08-18T23:59:59.999 160511.0478500741 === 1.837%
2024-11-20 23:07:12,699 - DEBUG - cur time: 2024-08-19T23:59:59.999 == next bar open time: 2024-08-20T00:00:00.000 == close pos time: 2024-08-27T00:00:00.000
2024-11-20 23:07:12,721 - DEBUG - sorted_long_factors: shape: (245, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ TONUSDT     ┆ -1.976659    ┆ 0    ┆ 244          │
│ GMXUSDT     ┆ -1.974203    ┆ 1    ┆ 243          │
│ DYMUSDT     ┆ -1.936652    ┆ 2    ┆ 242          │
│ AUCTIONUSDT ┆ -1.931939    ┆ 3    ┆ 241          │
│ AAVEUSDT    ┆ -1.914593    ┆ 4    ┆ 240          │
│ XRPUSDT     ┆ -1.814115    ┆ 5    ┆ 239          │
│ HOOKUSDT    ┆ -1.807047    ┆ 6    ┆ 238          │
│ OMNIUSDT    ┆ -1.7929      ┆ 7    ┆ 237          │
│ SAGAUSDT    ┆ -1.7392      ┆ 8    ┆ 236          │
│ HIGHUSDT    ┆ -1.726816    ┆ 9    ┆ 235          │
│ …           ┆ …            ┆ …    ┆ …            │
│ ONEUSDT     ┆ 0.118087     ┆ 235  ┆ 9            │
│ BNTUSDT     ┆ 0.123699     ┆ 236  ┆ 8            │
│ OMGUSDT     ┆ 0.271949     ┆ 237  ┆ 7            │
│ HFTUSDT     ┆ 0.303192     ┆ 238  ┆ 6            │
│ ILVUSDT     ┆ 0.366398     ┆ 239  ┆ 5            │
│ NKNUSDT     ┆ 0.401277     ┆ 240  ┆ 4            │
│ ETHWUSDT    ┆ 0.412151     ┆ 241  ┆ 3            │
│ OXTUSDT     ┆ 0.474198     ┆ 242  ┆ 2            │
│ JOEUSDT     ┆ 0.806096     ┆ 243  ┆ 1            │
│ DEFIUSDT    ┆ 1.47917      ┆ 244  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:12,735 - INFO - cur close time: 2024-08-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:12,736 - DEBUG - mean expected ret (mean factor): -0.7992957702547567
2024-11-20 23:07:12,743 - DEBUG - begin to update pos: =========
2024-11-20 23:07:12,744 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,744 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.01781     ┆ 0.11642     ┆ 0.07784     ┆ 0.0076796   ┆ … ┆ 0.01368 ┆ null   ┆ null    ┆ 0.3081  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,755 - DEBUG - update position: 2024-08-19T23:59:59.999 === diff_trading_value: 286861.12250601925 == cash: 163500.86771064138 
2024-11-20 23:07:12,756 - INFO - pnl: 2024-08-19T23:59:59.999 163500.86771064138 === 1.863%
2024-11-20 23:07:12,762 - DEBUG - cur time: 2024-08-20T23:59:59.999 == next bar open time: 2024-08-21T00:00:00.000 == close pos time: 2024-08-28T00:00:00.000
2024-11-20 23:07:12,765 - INFO - pnl: 2024-08-20T23:59:59.999 163564.14400042704 === 0.039%
2024-11-20 23:07:12,770 - DEBUG - cur time: 2024-08-21T23:59:59.999 == next bar open time: 2024-08-22T00:00:00.000 == close pos time: 2024-08-29T00:00:00.000
2024-11-20 23:07:12,771 - INFO - pnl: 2024-08-21T23:59:59.999 165730.1447958638 === 1.324%
2024-11-20 23:07:12,778 - DEBUG - cur time: 2024-08-22T23:59:59.999 == next bar open time: 2024-08-23T00:00:00.000 == close pos time: 2024-08-30T00:00:00.000
2024-11-20 23:07:12,781 - INFO - pnl: 2024-08-22T23:59:59.999 169327.65522694998 === 2.171%
2024-11-20 23:07:12,787 - DEBUG - cur time: 2024-08-23T23:59:59.999 == next bar open time: 2024-08-24T00:00:00.000 == close pos time: 2024-08-31T00:00:00.000
2024-11-20 23:07:12,789 - INFO - pnl: 2024-08-23T23:59:59.999 169061.078833493 === -0.157%
2024-11-20 23:07:12,794 - DEBUG - cur time: 2024-08-24T23:59:59.999 == next bar open time: 2024-08-25T00:00:00.000 == close pos time: 2024-09-01T00:00:00.000
2024-11-20 23:07:12,796 - INFO - pnl: 2024-08-24T23:59:59.999 168193.00861756958 === -0.513%
2024-11-20 23:07:12,801 - DEBUG - cur time: 2024-08-25T23:59:59.999 == next bar open time: 2024-08-26T00:00:00.000 == close pos time: 2024-09-02T00:00:00.000
2024-11-20 23:07:12,803 - INFO - pnl: 2024-08-25T23:59:59.999 169247.044112285 === 0.627%
2024-11-20 23:07:12,807 - DEBUG - cur time: 2024-08-26T23:59:59.999 == next bar open time: 2024-08-27T00:00:00.000 == close pos time: 2024-09-03T00:00:00.000
2024-11-20 23:07:12,818 - DEBUG - sorted_long_factors: shape: (247, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ TAOUSDT     ┆ -2.017104    ┆ 0    ┆ 246          │
│ AUCTIONUSDT ┆ -1.957382    ┆ 1    ┆ 245          │
│ XMRUSDT     ┆ -1.939953    ┆ 2    ┆ 244          │
│ GMXUSDT     ┆ -1.720703    ┆ 3    ┆ 243          │
│ DOTUSDT     ┆ -1.717012    ┆ 4    ┆ 242          │
│ ETHFIUSDT   ┆ -1.682359    ┆ 5    ┆ 241          │
│ AEVOUSDT    ┆ -1.655891    ┆ 6    ┆ 240          │
│ ATOMUSDT    ┆ -1.566683    ┆ 7    ┆ 239          │
│ FILUSDT     ┆ -1.503156    ┆ 8    ┆ 238          │
│ BOMEUSDT    ┆ -1.502676    ┆ 9    ┆ 237          │
│ …           ┆ …            ┆ …    ┆ …            │
│ OMGUSDT     ┆ 0.09135      ┆ 237  ┆ 9            │
│ PERPUSDT    ┆ 0.11769      ┆ 238  ┆ 8            │
│ LSKUSDT     ┆ 0.171753     ┆ 239  ┆ 7            │
│ AGLDUSDT    ┆ 0.180157     ┆ 240  ┆ 6            │
│ XVGUSDT     ┆ 0.289061     ┆ 241  ┆ 5            │
│ HFTUSDT     ┆ 0.467689     ┆ 242  ┆ 4            │
│ ETHWUSDT    ┆ 0.592376     ┆ 243  ┆ 3            │
│ OXTUSDT     ┆ 0.629587     ┆ 244  ┆ 2            │
│ STEEMUSDT   ┆ 0.697691     ┆ 245  ┆ 1            │
│ DEFIUSDT    ┆ 1.432973     ┆ 246  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:12,829 - WARNING - 2024-08-26T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:12,830 - INFO - cur close time: 2024-08-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:12,830 - DEBUG - mean expected ret (mean factor): -0.7872441194968873
2024-11-20 23:07:12,834 - DEBUG - begin to update pos: =========
2024-11-20 23:07:12,834 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,835 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.019661    ┆ 0.14812     ┆ 0.08475     ┆ 0.0085181   ┆ … ┆ 0.01439 ┆ null   ┆ null    ┆ 0.3205  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,841 - DEBUG - update position: 2024-08-26T23:59:59.999 === diff_trading_value: 251651.46515248672 == cash: 168937.54438432556 
2024-11-20 23:07:12,844 - INFO - pnl: 2024-08-26T23:59:59.999 168937.54438432556 === -0.183%
2024-11-20 23:07:12,849 - DEBUG - cur time: 2024-08-27T23:59:59.999 == next bar open time: 2024-08-28T00:00:00.000 == close pos time: 2024-09-04T00:00:00.000
2024-11-20 23:07:12,851 - INFO - pnl: 2024-08-27T23:59:59.999 169491.069964955 === 0.328%
2024-11-20 23:07:12,856 - DEBUG - cur time: 2024-08-28T23:59:59.999 == next bar open time: 2024-08-29T00:00:00.000 == close pos time: 2024-09-05T00:00:00.000
2024-11-20 23:07:12,857 - INFO - pnl: 2024-08-28T23:59:59.999 170169.77059342054 === 0.400%
2024-11-20 23:07:12,864 - DEBUG - cur time: 2024-08-29T23:59:59.999 == next bar open time: 2024-08-30T00:00:00.000 == close pos time: 2024-09-06T00:00:00.000
2024-11-20 23:07:12,867 - INFO - pnl: 2024-08-29T23:59:59.999 169786.04205862753 === -0.225%
2024-11-20 23:07:12,873 - DEBUG - cur time: 2024-08-30T23:59:59.999 == next bar open time: 2024-08-31T00:00:00.000 == close pos time: 2024-09-07T00:00:00.000
2024-11-20 23:07:12,874 - INFO - pnl: 2024-08-30T23:59:59.999 168426.79783230796 === -0.801%
2024-11-20 23:07:12,881 - DEBUG - cur time: 2024-08-31T23:59:59.999 == next bar open time: 2024-09-01T00:00:00.000 == close pos time: 2024-09-08T00:00:00.000
2024-11-20 23:07:12,885 - INFO - pnl: 2024-08-31T23:59:59.999 168289.02633496455 === -0.082%
2024-11-20 23:07:12,890 - DEBUG - cur time: 2024-09-01T23:59:59.999 == next bar open time: 2024-09-02T00:00:00.000 == close pos time: 2024-09-09T00:00:00.000
2024-11-20 23:07:12,893 - INFO - pnl: 2024-09-01T23:59:59.999 168483.58610916592 === 0.116%
2024-11-20 23:07:12,900 - DEBUG - cur time: 2024-09-02T23:59:59.999 == next bar open time: 2024-09-03T00:00:00.000 == close pos time: 2024-09-10T00:00:00.000
2024-11-20 23:07:12,914 - DEBUG - sorted_long_factors: shape: (246, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ AUCTIONUSDT ┆ -2.589335    ┆ 0    ┆ 245          │
│ TONUSDT     ┆ -2.303425    ┆ 1    ┆ 244          │
│ GMXUSDT     ┆ -1.972654    ┆ 2    ┆ 243          │
│ ETHFIUSDT   ┆ -1.969207    ┆ 3    ┆ 242          │
│ TAOUSDT     ┆ -1.778774    ┆ 4    ┆ 241          │
│ SAGAUSDT    ┆ -1.774683    ┆ 5    ┆ 240          │
│ YFIUSDT     ┆ -1.710745    ┆ 6    ┆ 239          │
│ CYBERUSDT   ┆ -1.692657    ┆ 7    ┆ 238          │
│ SSVUSDT     ┆ -1.649992    ┆ 8    ┆ 237          │
│ OMNIUSDT    ┆ -1.640497    ┆ 9    ┆ 236          │
│ …           ┆ …            ┆ …    ┆ …            │
│ LSKUSDT     ┆ 0.312602     ┆ 236  ┆ 9            │
│ HFTUSDT     ┆ 0.358972     ┆ 237  ┆ 8            │
│ PERPUSDT    ┆ 0.37965      ┆ 238  ┆ 7            │
│ OMGUSDT     ┆ 0.414544     ┆ 239  ┆ 6            │
│ OXTUSDT     ┆ 0.52972      ┆ 240  ┆ 5            │
│ WAXPUSDT    ┆ 0.555534     ┆ 241  ┆ 4            │
│ XVGUSDT     ┆ 0.684825     ┆ 242  ┆ 3            │
│ STEEMUSDT   ┆ 0.950165     ┆ 243  ┆ 2            │
│ DEFIUSDT    ┆ 1.479836     ┆ 244  ┆ 1            │
│ ETHWUSDT    ┆ 1.550054     ┆ 245  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:12,923 - WARNING - 2024-09-02T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:12,923 - INFO - cur close time: 2024-09-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:12,923 - DEBUG - mean expected ret (mean factor): -0.7677333184302838
2024-11-20 23:07:12,928 - DEBUG - begin to update pos: =========
2024-11-20 23:07:12,928 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,928 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.017506    ┆ 0.12153     ┆ 0.07806     ┆ 0.0076113   ┆ … ┆ 0.01354 ┆ null   ┆ null    ┆ 0.293   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:12,936 - DEBUG - update position: 2024-09-02T23:59:59.999 === diff_trading_value: 192393.20953941048 == cash: 168826.42907215902 
2024-11-20 23:07:12,937 - INFO - pnl: 2024-09-02T23:59:59.999 168826.42907215902 === 0.203%
2024-11-20 23:07:12,941 - DEBUG - cur time: 2024-09-03T23:59:59.999 == next bar open time: 2024-09-04T00:00:00.000 == close pos time: 2024-09-11T00:00:00.000
2024-11-20 23:07:12,943 - INFO - pnl: 2024-09-03T23:59:59.999 171274.51842045892 === 1.450%
2024-11-20 23:07:12,949 - DEBUG - cur time: 2024-09-04T23:59:59.999 == next bar open time: 2024-09-05T00:00:00.000 == close pos time: 2024-09-12T00:00:00.000
2024-11-20 23:07:12,954 - INFO - pnl: 2024-09-04T23:59:59.999 171424.3805759589 === 0.087%
2024-11-20 23:07:12,962 - DEBUG - cur time: 2024-09-05T23:59:59.999 == next bar open time: 2024-09-06T00:00:00.000 == close pos time: 2024-09-13T00:00:00.000
2024-11-20 23:07:12,963 - INFO - pnl: 2024-09-05T23:59:59.999 169600.57118594082 === -1.064%
2024-11-20 23:07:12,971 - DEBUG - cur time: 2024-09-06T23:59:59.999 == next bar open time: 2024-09-07T00:00:00.000 == close pos time: 2024-09-14T00:00:00.000
2024-11-20 23:07:12,976 - INFO - pnl: 2024-09-06T23:59:59.999 169641.43352676122 === 0.024%
2024-11-20 23:07:12,981 - DEBUG - cur time: 2024-09-07T23:59:59.999 == next bar open time: 2024-09-08T00:00:00.000 == close pos time: 2024-09-15T00:00:00.000
2024-11-20 23:07:12,986 - INFO - pnl: 2024-09-07T23:59:59.999 169359.19539776616 === -0.166%
2024-11-20 23:07:12,995 - DEBUG - cur time: 2024-09-08T23:59:59.999 == next bar open time: 2024-09-09T00:00:00.000 == close pos time: 2024-09-16T00:00:00.000
2024-11-20 23:07:12,999 - INFO - pnl: 2024-09-08T23:59:59.999 169394.14598035032 === 0.021%
2024-11-20 23:07:13,004 - DEBUG - cur time: 2024-09-09T23:59:59.999 == next bar open time: 2024-09-10T00:00:00.000 == close pos time: 2024-09-17T00:00:00.000
2024-11-20 23:07:13,018 - DEBUG - sorted_long_factors: shape: (247, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT    ┆ -2.169119    ┆ 0    ┆ 246          │
│ SAGAUSDT      ┆ -1.885059    ┆ 1    ┆ 245          │
│ SUIUSDT       ┆ -1.871617    ┆ 2    ┆ 244          │
│ TRBUSDT       ┆ -1.856805    ┆ 3    ┆ 243          │
│ BONDUSDT      ┆ -1.81601     ┆ 4    ┆ 242          │
│ AAVEUSDT      ┆ -1.773987    ┆ 5    ┆ 241          │
│ FETUSDT       ┆ -1.724528    ┆ 6    ┆ 240          │
│ SFPUSDT       ┆ -1.683545    ┆ 7    ┆ 239          │
│ 1000FLOKIUSDT ┆ -1.673423    ┆ 8    ┆ 238          │
│ IMXUSDT       ┆ -1.647763    ┆ 9    ┆ 237          │
│ …             ┆ …            ┆ …    ┆ …            │
│ XVGUSDT       ┆ 0.270945     ┆ 237  ┆ 9            │
│ LSKUSDT       ┆ 0.363858     ┆ 238  ┆ 8            │
│ BALUSDT       ┆ 0.438961     ┆ 239  ┆ 7            │
│ DODOXUSDT     ┆ 0.466571     ┆ 240  ┆ 6            │
│ NTRNUSDT      ┆ 0.468433     ┆ 241  ┆ 5            │
│ BNTUSDT       ┆ 0.55276      ┆ 242  ┆ 4            │
│ HFTUSDT       ┆ 0.564796     ┆ 243  ┆ 3            │
│ STEEMUSDT     ┆ 0.969542     ┆ 244  ┆ 2            │
│ ETHWUSDT      ┆ 1.04743      ┆ 245  ┆ 1            │
│ DEFIUSDT      ┆ 1.216366     ┆ 246  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:13,030 - WARNING - 2024-09-09T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:13,030 - INFO - cur close time: 2024-09-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:13,030 - DEBUG - mean expected ret (mean factor): -0.7662123162604014
2024-11-20 23:07:13,035 - DEBUG - begin to update pos: =========
2024-11-20 23:07:13,036 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,036 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.017192    ┆ 0.12845     ┆ 0.08126     ┆ 0.0073889   ┆ … ┆ 0.01328 ┆ null   ┆ null    ┆ 0.2836  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,045 - DEBUG - update position: 2024-09-09T23:59:59.999 === diff_trading_value: 281667.38708003575 == cash: 168483.1775159118 
2024-11-20 23:07:13,047 - INFO - pnl: 2024-09-09T23:59:59.999 168483.1775159118 === -0.538%
2024-11-20 23:07:13,053 - DEBUG - cur time: 2024-09-10T23:59:59.999 == next bar open time: 2024-09-11T00:00:00.000 == close pos time: 2024-09-18T00:00:00.000
2024-11-20 23:07:13,056 - INFO - pnl: 2024-09-10T23:59:59.999 168640.52815321888 === 0.093%
2024-11-20 23:07:13,061 - DEBUG - cur time: 2024-09-11T23:59:59.999 == next bar open time: 2024-09-12T00:00:00.000 == close pos time: 2024-09-19T00:00:00.000
2024-11-20 23:07:13,064 - INFO - pnl: 2024-09-11T23:59:59.999 168137.1318053795 === -0.299%
2024-11-20 23:07:13,071 - DEBUG - cur time: 2024-09-12T23:59:59.999 == next bar open time: 2024-09-13T00:00:00.000 == close pos time: 2024-09-20T00:00:00.000
2024-11-20 23:07:13,075 - INFO - pnl: 2024-09-12T23:59:59.999 169893.042341688 === 1.044%
2024-11-20 23:07:13,081 - DEBUG - cur time: 2024-09-13T23:59:59.999 == next bar open time: 2024-09-14T00:00:00.000 == close pos time: 2024-09-21T00:00:00.000
2024-11-20 23:07:13,084 - INFO - pnl: 2024-09-13T23:59:59.999 170244.1988555058 === 0.207%
2024-11-20 23:07:13,095 - DEBUG - cur time: 2024-09-14T23:59:59.999 == next bar open time: 2024-09-15T00:00:00.000 == close pos time: 2024-09-22T00:00:00.000
2024-11-20 23:07:13,099 - INFO - pnl: 2024-09-14T23:59:59.999 168668.5329875981 === -0.926%
2024-11-20 23:07:13,108 - DEBUG - cur time: 2024-09-15T23:59:59.999 == next bar open time: 2024-09-16T00:00:00.000 == close pos time: 2024-09-23T00:00:00.000
2024-11-20 23:07:13,111 - INFO - pnl: 2024-09-15T23:59:59.999 168600.04636354177 === -0.041%
2024-11-20 23:07:13,125 - DEBUG - cur time: 2024-09-16T23:59:59.999 == next bar open time: 2024-09-17T00:00:00.000 == close pos time: 2024-09-24T00:00:00.000
2024-11-20 23:07:13,144 - DEBUG - sorted_long_factors: shape: (247, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ SAGAUSDT   ┆ -1.918621    ┆ 0    ┆ 246          │
│ TIAUSDT    ┆ -1.88111     ┆ 1    ┆ 245          │
│ BONDUSDT   ┆ -1.866682    ┆ 2    ┆ 244          │
│ API3USDT   ┆ -1.714551    ┆ 3    ┆ 243          │
│ XMRUSDT    ┆ -1.686472    ┆ 4    ┆ 242          │
│ BBUSDT     ┆ -1.676959    ┆ 5    ┆ 241          │
│ PENDLEUSDT ┆ -1.670875    ┆ 6    ┆ 240          │
│ XRPUSDT    ┆ -1.667184    ┆ 7    ┆ 239          │
│ ARKMUSDT   ┆ -1.581235    ┆ 8    ┆ 238          │
│ MKRUSDT    ┆ -1.579871    ┆ 9    ┆ 237          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BNTUSDT    ┆ 0.236017     ┆ 237  ┆ 9            │
│ XVGUSDT    ┆ 0.253322     ┆ 238  ┆ 8            │
│ STEEMUSDT  ┆ 0.399212     ┆ 239  ┆ 7            │
│ MAVIAUSDT  ┆ 0.521932     ┆ 240  ┆ 6            │
│ FXSUSDT    ┆ 0.557638     ┆ 241  ┆ 5            │
│ HFTUSDT    ┆ 0.600901     ┆ 242  ┆ 4            │
│ ETHWUSDT   ┆ 0.697734     ┆ 243  ┆ 3            │
│ BICOUSDT   ┆ 0.75107      ┆ 244  ┆ 2            │
│ COMBOUSDT  ┆ 0.801497     ┆ 245  ┆ 1            │
│ DEFIUSDT   ┆ 1.144856     ┆ 246  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:13,161 - INFO - cur close time: 2024-09-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:13,161 - DEBUG - mean expected ret (mean factor): -0.7683304384787125
2024-11-20 23:07:13,168 - DEBUG - begin to update pos: =========
2024-11-20 23:07:13,169 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,170 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.016163    ┆ 0.11881     ┆ 0.08055     ┆ 0.0071946   ┆ … ┆ 0.01307 ┆ null   ┆ null    ┆ 0.2765  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,194 - DEBUG - update position: 2024-09-16T23:59:59.999 === diff_trading_value: 245456.68770214997 == cash: 166938.9644800217 
2024-11-20 23:07:13,199 - INFO - pnl: 2024-09-16T23:59:59.999 166938.9644800217 === -0.985%
2024-11-20 23:07:13,209 - DEBUG - cur time: 2024-09-17T23:59:59.999 == next bar open time: 2024-09-18T00:00:00.000 == close pos time: 2024-09-25T00:00:00.000
2024-11-20 23:07:13,215 - INFO - pnl: 2024-09-17T23:59:59.999 166618.24198584261 === -0.192%
2024-11-20 23:07:13,228 - DEBUG - cur time: 2024-09-18T23:59:59.999 == next bar open time: 2024-09-19T00:00:00.000 == close pos time: 2024-09-26T00:00:00.000
2024-11-20 23:07:13,234 - INFO - pnl: 2024-09-18T23:59:59.999 167895.57274301158 === 0.767%
2024-11-20 23:07:13,242 - DEBUG - cur time: 2024-09-19T23:59:59.999 == next bar open time: 2024-09-20T00:00:00.000 == close pos time: 2024-09-27T00:00:00.000
2024-11-20 23:07:13,246 - INFO - pnl: 2024-09-19T23:59:59.999 167015.9952003393 === -0.524%
2024-11-20 23:07:13,254 - DEBUG - cur time: 2024-09-20T23:59:59.999 == next bar open time: 2024-09-21T00:00:00.000 == close pos time: 2024-09-28T00:00:00.000
2024-11-20 23:07:13,258 - INFO - pnl: 2024-09-20T23:59:59.999 169342.30037712125 === 1.393%
2024-11-20 23:07:13,267 - DEBUG - cur time: 2024-09-21T23:59:59.999 == next bar open time: 2024-09-22T00:00:00.000 == close pos time: 2024-09-29T00:00:00.000
2024-11-20 23:07:13,270 - INFO - pnl: 2024-09-21T23:59:59.999 172834.13907603425 === 2.062%
2024-11-20 23:07:13,279 - DEBUG - cur time: 2024-09-22T23:59:59.999 == next bar open time: 2024-09-23T00:00:00.000 == close pos time: 2024-09-30T00:00:00.000
2024-11-20 23:07:13,283 - INFO - pnl: 2024-09-22T23:59:59.999 172015.1351977173 === -0.474%
2024-11-20 23:07:13,288 - DEBUG - cur time: 2024-09-23T23:59:59.999 == next bar open time: 2024-09-24T00:00:00.000 == close pos time: 2024-10-01T00:00:00.000
2024-11-20 23:07:13,308 - DEBUG - sorted_long_factors: shape: (248, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TAOUSDT   ┆ -2.253383    ┆ 0    ┆ 247          │
│ ETHFIUSDT ┆ -2.108352    ┆ 1    ┆ 246          │
│ IOUSDT    ┆ -1.880989    ┆ 2    ┆ 245          │
│ BNBUSDT   ┆ -1.772698    ┆ 3    ┆ 244          │
│ GASUSDT   ┆ -1.740282    ┆ 4    ┆ 243          │
│ ENSUSDT   ┆ -1.702306    ┆ 5    ┆ 242          │
│ BSVUSDT   ┆ -1.624616    ┆ 6    ┆ 241          │
│ OMNIUSDT  ┆ -1.621004    ┆ 7    ┆ 240          │
│ AAVEUSDT  ┆ -1.619097    ┆ 8    ┆ 239          │
│ YFIUSDT   ┆ -1.585875    ┆ 9    ┆ 238          │
│ …         ┆ …            ┆ …    ┆ …            │
│ FXSUSDT   ┆ 0.164548     ┆ 238  ┆ 9            │
│ BANDUSDT  ┆ 0.261453     ┆ 239  ┆ 8            │
│ DENTUSDT  ┆ 0.370903     ┆ 240  ┆ 7            │
│ CELRUSDT  ┆ 0.408243     ┆ 241  ┆ 6            │
│ XVGUSDT   ┆ 0.411627     ┆ 242  ┆ 5            │
│ BICOUSDT  ┆ 0.482763     ┆ 243  ┆ 4            │
│ BNTUSDT   ┆ 0.592547     ┆ 244  ┆ 3            │
│ OXTUSDT   ┆ 0.626822     ┆ 245  ┆ 2            │
│ COMBOUSDT ┆ 0.763108     ┆ 246  ┆ 1            │
│ DEFIUSDT  ┆ 2.60041      ┆ 247  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:13,318 - WARNING - 2024-09-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:13,318 - INFO - cur close time: 2024-09-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:13,319 - DEBUG - mean expected ret (mean factor): -0.7579426515410409
2024-11-20 23:07:13,324 - DEBUG - begin to update pos: =========
2024-11-20 23:07:13,324 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,324 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.01763     ┆ 0.13403     ┆ 0.0859      ┆ 0.0081274   ┆ … ┆ 0.01544 ┆ null   ┆ null    ┆ 0.3331  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,337 - DEBUG - update position: 2024-09-23T23:59:59.999 === diff_trading_value: 319164.39363365475 == cash: 169150.3725731689 
2024-11-20 23:07:13,339 - INFO - pnl: 2024-09-23T23:59:59.999 169150.3725731689 === -1.665%
2024-11-20 23:07:13,346 - DEBUG - cur time: 2024-09-24T23:59:59.999 == next bar open time: 2024-09-25T00:00:00.000 == close pos time: 2024-10-02T00:00:00.000
2024-11-20 23:07:13,349 - INFO - pnl: 2024-09-24T23:59:59.999 170304.76646058532 === 0.682%
2024-11-20 23:07:13,358 - DEBUG - cur time: 2024-09-25T23:59:59.999 == next bar open time: 2024-09-26T00:00:00.000 == close pos time: 2024-10-03T00:00:00.000
2024-11-20 23:07:13,361 - INFO - pnl: 2024-09-25T23:59:59.999 169432.58666579676 === -0.512%
2024-11-20 23:07:13,368 - DEBUG - cur time: 2024-09-26T23:59:59.999 == next bar open time: 2024-09-27T00:00:00.000 == close pos time: 2024-10-04T00:00:00.000
2024-11-20 23:07:13,370 - INFO - pnl: 2024-09-26T23:59:59.999 169254.86048188776 === -0.105%
2024-11-20 23:07:13,378 - DEBUG - cur time: 2024-09-27T23:59:59.999 == next bar open time: 2024-09-28T00:00:00.000 == close pos time: 2024-10-05T00:00:00.000
2024-11-20 23:07:13,383 - INFO - pnl: 2024-09-27T23:59:59.999 169375.630601879 === 0.071%
2024-11-20 23:07:13,391 - DEBUG - cur time: 2024-09-28T23:59:59.999 == next bar open time: 2024-09-29T00:00:00.000 == close pos time: 2024-10-06T00:00:00.000
2024-11-20 23:07:13,396 - INFO - pnl: 2024-09-28T23:59:59.999 170866.57449962 === 0.880%
2024-11-20 23:07:13,403 - DEBUG - cur time: 2024-09-29T23:59:59.999 == next bar open time: 2024-09-30T00:00:00.000 == close pos time: 2024-10-07T00:00:00.000
2024-11-20 23:07:13,405 - INFO - pnl: 2024-09-29T23:59:59.999 171917.53260603032 === 0.615%
2024-11-20 23:07:13,410 - DEBUG - cur time: 2024-09-30T23:59:59.999 == next bar open time: 2024-10-01T00:00:00.000 == close pos time: 2024-10-08T00:00:00.000
2024-11-20 23:07:13,422 - DEBUG - sorted_long_factors: shape: (252, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ SAGAUSDT   ┆ -1.903105    ┆ 0    ┆ 251          │
│ ETHFIUSDT  ┆ -1.858787    ┆ 1    ┆ 250          │
│ TAOUSDT    ┆ -1.600217    ┆ 2    ┆ 249          │
│ TRBUSDT    ┆ -1.58895     ┆ 3    ┆ 248          │
│ LUNA2USDT  ┆ -1.556046    ┆ 4    ┆ 247          │
│ GASUSDT    ┆ -1.481497    ┆ 5    ┆ 246          │
│ GLMUSDT    ┆ -1.47856     ┆ 6    ┆ 245          │
│ WUSDT      ┆ -1.477714    ┆ 7    ┆ 244          │
│ ZROUSDT    ┆ -1.475128    ┆ 8    ┆ 243          │
│ NEOUSDT    ┆ -1.453723    ┆ 9    ┆ 242          │
│ …          ┆ …            ┆ …    ┆ …            │
│ JOEUSDT    ┆ 0.029863     ┆ 242  ┆ 9            │
│ ICXUSDT    ┆ 0.055579     ┆ 243  ┆ 8            │
│ BADGERUSDT ┆ 0.069653     ┆ 244  ┆ 7            │
│ API3USDT   ┆ 0.099151     ┆ 245  ┆ 6            │
│ LSKUSDT    ┆ 0.12844      ┆ 246  ┆ 5            │
│ BICOUSDT   ┆ 0.173798     ┆ 247  ┆ 4            │
│ PERPUSDT   ┆ 0.190803     ┆ 248  ┆ 3            │
│ XVGUSDT    ┆ 0.364257     ┆ 249  ┆ 2            │
│ HFTUSDT    ┆ 0.587984     ┆ 250  ┆ 1            │
│ DEFIUSDT   ┆ 2.114627     ┆ 251  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:13,433 - WARNING - 2024-09-30T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:13,433 - INFO - cur close time: 2024-09-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:13,433 - DEBUG - mean expected ret (mean factor): -0.7717112662469677
2024-11-20 23:07:13,441 - DEBUG - begin to update pos: =========
2024-11-20 23:07:13,443 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬──────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT  ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---      ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ f64      ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆          ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪══════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ -10000.0 ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴──────────┴─────────┘
2024-11-20 23:07:13,444 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.023804    ┆ 0.15312     ┆ 0.09147     ┆ 0.0104665  ┆ … ┆ 0.01497 ┆ 0.13619 ┆ 4.5636  ┆ 0.3344  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:13,456 - DEBUG - update position: 2024-09-30T23:59:59.999 === diff_trading_value: 235985.88082373096 == cash: 169209.10514892158 
2024-11-20 23:07:13,460 - INFO - pnl: 2024-09-30T23:59:59.999 169209.10514892158 === -1.575%
2024-11-20 23:07:13,466 - DEBUG - cur time: 2024-10-01T23:59:59.999 == next bar open time: 2024-10-02T00:00:00.000 == close pos time: 2024-10-09T00:00:00.000
2024-11-20 23:07:13,469 - INFO - pnl: 2024-10-01T23:59:59.999 167223.819644216 === -1.173%
2024-11-20 23:07:13,480 - DEBUG - cur time: 2024-10-02T23:59:59.999 == next bar open time: 2024-10-03T00:00:00.000 == close pos time: 2024-10-10T00:00:00.000
2024-11-20 23:07:13,483 - INFO - pnl: 2024-10-02T23:59:59.999 165847.3146896111 === -0.823%
2024-11-20 23:07:13,489 - DEBUG - cur time: 2024-10-03T23:59:59.999 == next bar open time: 2024-10-04T00:00:00.000 == close pos time: 2024-10-11T00:00:00.000
2024-11-20 23:07:13,491 - INFO - pnl: 2024-10-03T23:59:59.999 167821.50449062497 === 1.190%
2024-11-20 23:07:13,498 - DEBUG - cur time: 2024-10-04T23:59:59.999 == next bar open time: 2024-10-05T00:00:00.000 == close pos time: 2024-10-12T00:00:00.000
2024-11-20 23:07:13,501 - INFO - pnl: 2024-10-04T23:59:59.999 165636.32511638134 === -1.302%
2024-11-20 23:07:13,509 - DEBUG - cur time: 2024-10-05T23:59:59.999 == next bar open time: 2024-10-06T00:00:00.000 == close pos time: 2024-10-13T00:00:00.000
2024-11-20 23:07:13,511 - INFO - pnl: 2024-10-05T23:59:59.999 165187.87861853398 === -0.271%
2024-11-20 23:07:13,518 - DEBUG - cur time: 2024-10-06T23:59:59.999 == next bar open time: 2024-10-07T00:00:00.000 == close pos time: 2024-10-14T00:00:00.000
2024-11-20 23:07:13,521 - INFO - pnl: 2024-10-06T23:59:59.999 164936.1800948066 === -0.152%
2024-11-20 23:07:13,527 - DEBUG - cur time: 2024-10-07T23:59:59.999 == next bar open time: 2024-10-08T00:00:00.000 == close pos time: 2024-10-15T00:00:00.000
2024-11-20 23:07:13,539 - DEBUG - sorted_long_factors: shape: (252, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ SAGAUSDT  ┆ -1.924836    ┆ 0    ┆ 251          │
│ SUIUSDT   ┆ -1.886488    ┆ 1    ┆ 250          │
│ XRPUSDT   ┆ -1.879626    ┆ 2    ┆ 249          │
│ ARUSDT    ┆ -1.855801    ┆ 3    ┆ 248          │
│ UNFIUSDT  ┆ -1.854207    ┆ 4    ┆ 247          │
│ ETHFIUSDT ┆ -1.692269    ┆ 5    ┆ 246          │
│ REZUSDT   ┆ -1.66141     ┆ 6    ┆ 245          │
│ LUNA2USDT ┆ -1.661359    ┆ 7    ┆ 244          │
│ IOUSDT    ┆ -1.636969    ┆ 8    ┆ 243          │
│ WUSDT     ┆ -1.63207     ┆ 9    ┆ 242          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XMRUSDT   ┆ 0.223428     ┆ 242  ┆ 9            │
│ BNXUSDT   ┆ 0.256001     ┆ 243  ┆ 8            │
│ JOEUSDT   ┆ 0.356443     ┆ 244  ┆ 7            │
│ BICOUSDT  ┆ 0.375532     ┆ 245  ┆ 6            │
│ WAXPUSDT  ┆ 0.380107     ┆ 246  ┆ 5            │
│ HFTUSDT   ┆ 0.496836     ┆ 247  ┆ 4            │
│ LSKUSDT   ┆ 0.539344     ┆ 248  ┆ 3            │
│ PERPUSDT  ┆ 0.618757     ┆ 249  ┆ 2            │
│ STEEMUSDT ┆ 0.862413     ┆ 250  ┆ 1            │
│ DEFIUSDT  ┆ 1.851502     ┆ 251  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:13,547 - WARNING - 2024-10-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:13,547 - INFO - cur close time: 2024-10-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:13,548 - DEBUG - mean expected ret (mean factor): -0.772184546460161
2024-11-20 23:07:13,552 - DEBUG - begin to update pos: =========
2024-11-20 23:07:13,552 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,553 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.02117     ┆ 0.13671     ┆ 0.08839     ┆ 0.0097996  ┆ … ┆ 0.01437 ┆ 0.13094 ┆ 4.223   ┆ 0.3149  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:13,559 - DEBUG - update position: 2024-10-07T23:59:59.999 === diff_trading_value: 183456.34330419748 == cash: 164875.5535070029 
2024-11-20 23:07:13,561 - INFO - pnl: 2024-10-07T23:59:59.999 164875.5535070029 === -0.037%
2024-11-20 23:07:13,566 - DEBUG - cur time: 2024-10-08T23:59:59.999 == next bar open time: 2024-10-09T00:00:00.000 == close pos time: 2024-10-16T00:00:00.000
2024-11-20 23:07:13,567 - INFO - pnl: 2024-10-08T23:59:59.999 165669.90110102206 === 0.482%
2024-11-20 23:07:13,572 - DEBUG - cur time: 2024-10-09T23:59:59.999 == next bar open time: 2024-10-10T00:00:00.000 == close pos time: 2024-10-17T00:00:00.000
2024-11-20 23:07:13,573 - INFO - pnl: 2024-10-09T23:59:59.999 165235.72228700062 === -0.262%
2024-11-20 23:07:13,578 - DEBUG - cur time: 2024-10-10T23:59:59.999 == next bar open time: 2024-10-11T00:00:00.000 == close pos time: 2024-10-18T00:00:00.000
2024-11-20 23:07:13,580 - INFO - pnl: 2024-10-10T23:59:59.999 167475.64960396016 === 1.356%
2024-11-20 23:07:13,585 - DEBUG - cur time: 2024-10-11T23:59:59.999 == next bar open time: 2024-10-12T00:00:00.000 == close pos time: 2024-10-19T00:00:00.000
2024-11-20 23:07:13,588 - INFO - pnl: 2024-10-11T23:59:59.999 163712.55353519754 === -2.247%
2024-11-20 23:07:13,592 - DEBUG - cur time: 2024-10-12T23:59:59.999 == next bar open time: 2024-10-13T00:00:00.000 == close pos time: 2024-10-20T00:00:00.000
2024-11-20 23:07:13,593 - INFO - pnl: 2024-10-12T23:59:59.999 164513.8603798666 === 0.489%
2024-11-20 23:07:13,597 - DEBUG - cur time: 2024-10-13T23:59:59.999 == next bar open time: 2024-10-14T00:00:00.000 == close pos time: 2024-10-21T00:00:00.000
2024-11-20 23:07:13,598 - INFO - pnl: 2024-10-13T23:59:59.999 164336.14660869844 === -0.108%
2024-11-20 23:07:13,602 - DEBUG - cur time: 2024-10-14T23:59:59.999 == next bar open time: 2024-10-15T00:00:00.000 == close pos time: 2024-10-22T00:00:00.000
2024-11-20 23:07:13,610 - DEBUG - sorted_long_factors: shape: (252, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ WUSDT      ┆ -1.990357    ┆ 0    ┆ 251          │
│ ENAUSDT    ┆ -1.851331    ┆ 1    ┆ 250          │
│ SAGAUSDT   ┆ -1.835025    ┆ 2    ┆ 249          │
│ BNBUSDT    ┆ -1.829883    ┆ 3    ┆ 248          │
│ UNFIUSDT   ┆ -1.802865    ┆ 4    ┆ 247          │
│ NEARUSDT   ┆ -1.793287    ┆ 5    ┆ 246          │
│ ARUSDT     ┆ -1.775249    ┆ 6    ┆ 245          │
│ MINAUSDT   ┆ -1.754968    ┆ 7    ┆ 244          │
│ TIAUSDT    ┆ -1.736618    ┆ 8    ┆ 243          │
│ SEIUSDT    ┆ -1.714169    ┆ 9    ┆ 242          │
│ …          ┆ …            ┆ …    ┆ …            │
│ RONINUSDT  ┆ 0.155716     ┆ 242  ┆ 9            │
│ NKNUSDT    ┆ 0.161797     ┆ 243  ┆ 8            │
│ DENTUSDT   ┆ 0.167472     ┆ 244  ┆ 7            │
│ LSKUSDT    ┆ 0.21617      ┆ 245  ┆ 6            │
│ RVNUSDT    ┆ 0.245967     ┆ 246  ┆ 5            │
│ BADGERUSDT ┆ 0.251238     ┆ 247  ┆ 4            │
│ WAXPUSDT   ┆ 0.333651     ┆ 248  ┆ 3            │
│ PERPUSDT   ┆ 0.366455     ┆ 249  ┆ 2            │
│ STEEMUSDT  ┆ 0.883989     ┆ 250  ┆ 1            │
│ DEFIUSDT   ┆ 1.746898     ┆ 251  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:13,615 - WARNING - 2024-10-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:13,616 - INFO - cur close time: 2024-10-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:13,616 - DEBUG - mean expected ret (mean factor): -0.7761704116564735
2024-11-20 23:07:13,620 - DEBUG - begin to update pos: =========
2024-11-20 23:07:13,621 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,621 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.023239    ┆ 0.15276     ┆ 0.09196     ┆ 0.0109079  ┆ … ┆ 0.01545 ┆ 0.13844 ┆ 4.2352  ┆ 0.3354  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:13,626 - DEBUG - update position: 2024-10-14T23:59:59.999 === diff_trading_value: 265830.40992247465 == cash: 162000.33406788125 
2024-11-20 23:07:13,627 - INFO - pnl: 2024-10-14T23:59:59.999 162000.33406788125 === -1.421%
2024-11-20 23:07:13,630 - DEBUG - cur time: 2024-10-15T23:59:59.999 == next bar open time: 2024-10-16T00:00:00.000 == close pos time: 2024-10-23T00:00:00.000
2024-11-20 23:07:13,632 - INFO - pnl: 2024-10-15T23:59:59.999 163643.0617610889 === 1.014%
2024-11-20 23:07:13,636 - DEBUG - cur time: 2024-10-16T23:59:59.999 == next bar open time: 2024-10-17T00:00:00.000 == close pos time: 2024-10-24T00:00:00.000
2024-11-20 23:07:13,638 - INFO - pnl: 2024-10-16T23:59:59.999 164044.68678633205 === 0.245%
2024-11-20 23:07:13,642 - DEBUG - cur time: 2024-10-17T23:59:59.999 == next bar open time: 2024-10-18T00:00:00.000 == close pos time: 2024-10-25T00:00:00.000
2024-11-20 23:07:13,644 - INFO - pnl: 2024-10-17T23:59:59.999 163895.30322767922 === -0.091%
2024-11-20 23:07:13,650 - DEBUG - cur time: 2024-10-18T23:59:59.999 == next bar open time: 2024-10-19T00:00:00.000 == close pos time: 2024-10-26T00:00:00.000
2024-11-20 23:07:13,651 - INFO - pnl: 2024-10-18T23:59:59.999 164149.20164802996 === 0.155%
2024-11-20 23:07:13,654 - DEBUG - cur time: 2024-10-19T23:59:59.999 == next bar open time: 2024-10-20T00:00:00.000 == close pos time: 2024-10-27T00:00:00.000
2024-11-20 23:07:13,655 - INFO - pnl: 2024-10-19T23:59:59.999 166058.58043663861 === 1.163%
2024-11-20 23:07:13,659 - DEBUG - cur time: 2024-10-20T23:59:59.999 == next bar open time: 2024-10-21T00:00:00.000 == close pos time: 2024-10-28T00:00:00.000
2024-11-20 23:07:13,661 - INFO - pnl: 2024-10-20T23:59:59.999 168674.08995831656 === 1.575%
2024-11-20 23:07:13,664 - DEBUG - cur time: 2024-10-21T23:59:59.999 == next bar open time: 2024-10-22T00:00:00.000 == close pos time: 2024-10-29T00:00:00.000
2024-11-20 23:07:13,673 - DEBUG - sorted_long_factors: shape: (251, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ USDCUSDT  ┆ -1.738229    ┆ 0    ┆ 250          │
│ TNSRUSDT  ┆ -1.694368    ┆ 1    ┆ 249          │
│ ATOMUSDT  ┆ -1.66681     ┆ 2    ┆ 248          │
│ ZROUSDT   ┆ -1.662925    ┆ 3    ┆ 247          │
│ TAOUSDT   ┆ -1.654272    ┆ 4    ┆ 246          │
│ SAGAUSDT  ┆ -1.618764    ┆ 5    ┆ 245          │
│ AXSUSDT   ┆ -1.594279    ┆ 6    ┆ 244          │
│ ZETAUSDT  ┆ -1.593454    ┆ 7    ┆ 243          │
│ IOUSDT    ┆ -1.584985    ┆ 8    ┆ 242          │
│ UNIUSDT   ┆ -1.574047    ┆ 9    ┆ 241          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XEMUSDT   ┆ -0.06602     ┆ 241  ┆ 9            │
│ DENTUSDT  ┆ -0.047069    ┆ 242  ┆ 8            │
│ XVGUSDT   ┆ 0.046789     ┆ 243  ┆ 7            │
│ HFTUSDT   ┆ 0.047079     ┆ 244  ┆ 6            │
│ WAXPUSDT  ┆ 0.062146     ┆ 245  ┆ 5            │
│ LSKUSDT   ┆ 0.089681     ┆ 246  ┆ 4            │
│ KSMUSDT   ┆ 0.133011     ┆ 247  ┆ 3            │
│ BNTUSDT   ┆ 0.210293     ┆ 248  ┆ 2            │
│ STEEMUSDT ┆ 0.488023     ┆ 249  ┆ 1            │
│ DEFIUSDT  ┆ 2.638433     ┆ 250  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:13,680 - INFO - cur close time: 2024-10-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:13,681 - DEBUG - mean expected ret (mean factor): -0.7771512344234089
2024-11-20 23:07:13,685 - DEBUG - begin to update pos: =========
2024-11-20 23:07:13,685 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬──────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT  ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---      ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ f64      ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆          ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪══════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ -10000.0 ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴──────────┴─────────┘
2024-11-20 23:07:13,686 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.023386    ┆ 0.15135     ┆ 0.09225     ┆ 0.0101726  ┆ … ┆ 0.01571 ┆ 0.14253 ┆ 3.8533  ┆ 0.3577  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:13,691 - DEBUG - update position: 2024-10-21T23:59:59.999 === diff_trading_value: 309553.57673583657 == cash: 169778.7448340634 
2024-11-20 23:07:13,692 - INFO - pnl: 2024-10-21T23:59:59.999 169778.7448340634 === 0.655%
2024-11-20 23:07:13,695 - DEBUG - cur time: 2024-10-22T23:59:59.999 == next bar open time: 2024-10-23T00:00:00.000 == close pos time: 2024-10-30T00:00:00.000
2024-11-20 23:07:13,696 - INFO - pnl: 2024-10-22T23:59:59.999 169256.43222301823 === -0.308%
2024-11-20 23:07:13,699 - DEBUG - cur time: 2024-10-23T23:59:59.999 == next bar open time: 2024-10-24T00:00:00.000 == close pos time: 2024-10-31T00:00:00.000
2024-11-20 23:07:13,700 - INFO - pnl: 2024-10-23T23:59:59.999 167748.86405215028 === -0.891%
2024-11-20 23:07:13,703 - DEBUG - cur time: 2024-10-24T23:59:59.999 == next bar open time: 2024-10-25T00:00:00.000 == close pos time: 2024-11-01T00:00:00.000
2024-11-20 23:07:13,704 - INFO - pnl: 2024-10-24T23:59:59.999 168203.14016365306 === 0.271%
2024-11-20 23:07:13,707 - DEBUG - cur time: 2024-10-25T23:59:59.999 == next bar open time: 2024-10-26T00:00:00.000 == close pos time: 2024-11-02T00:00:00.000
2024-11-20 23:07:13,708 - INFO - pnl: 2024-10-25T23:59:59.999 167763.39694977182 === -0.261%
2024-11-20 23:07:13,711 - DEBUG - cur time: 2024-10-26T23:59:59.999 == next bar open time: 2024-10-27T00:00:00.000 == close pos time: 2024-11-03T00:00:00.000
2024-11-20 23:07:13,713 - INFO - pnl: 2024-10-26T23:59:59.999 166506.7970700689 === -0.749%
2024-11-20 23:07:13,731 - INFO - start get SinglePnl: shape: (126_034, 83)
┌────────────┬───────────┬──────────┬──────────┬───┬───────────┬───────────┬───────────┬───────────┐
│ symbol     ┆ open_time ┆ open     ┆ high     ┆ … ┆ long_valu ┆ short_val ┆ long_valu ┆ short_val │
│ ---        ┆ ---       ┆ ---      ┆ ---      ┆   ┆ e_scale_9 ┆ ue_scale_ ┆ e_scale_1 ┆ ue_scale_ │
│ str        ┆ datetime[ ┆ f64      ┆ f64      ┆   ┆ day       ┆ 9day      ┆ 0day      ┆ 10day     │
│            ┆ ms]       ┆          ┆          ┆   ┆ ---       ┆ ---       ┆ ---       ┆ ---       │
│            ┆           ┆          ┆          ┆   ┆ f64       ┆ f64       ┆ f64       ┆ f64       │
╞════════════╪═══════════╪══════════╪══════════╪═══╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.024872 ┆ 0.02937  ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.024425 ┆ 0.027349 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.027227 ┆ 0.047868 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.03773  ┆ 0.042696 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.030505 ┆ 0.036907 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.029994 ┆ 0.030839 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.027063 ┆ 0.035125 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.031768 ┆ 0.034467 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-1 ┆ 0.0339   ┆ 0.033974 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-1 ┆ 0.031026 ┆ 0.03276  ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ …          ┆ …         ┆ …        ┆ …        ┆ … ┆ …         ┆ …         ┆ …         ┆ …         │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3196   ┆ 0.3373   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3355   ┆ 0.3415   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3359   ┆ 0.3565   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3553   ┆ 0.3881   ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.2       ┆ 0.8       │
│            ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3577   ┆ 0.3581   ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.0       ┆ 1.0       │
│            ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3511   ┆ 0.3547   ┆ … ┆ 0.8       ┆ 1.2       ┆ 1.0       ┆ 1.0       │
│            ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3383   ┆ 0.3548   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3417   ┆ 0.3632   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3194   ┆ 0.3243   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.316    ┆ 0.3317   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
└────────────┴───────────┴──────────┴──────────┴───┴───────────┴───────────┴───────────┴───────────┘
2024-11-20 23:07:13,800 - DEBUG - cur time: 2023-01-10T23:59:59.999 == next bar open time: 2023-01-11T00:00:00.000 == close pos time: 2023-01-18T00:00:00.000
2024-11-20 23:07:13,806 - DEBUG - sorted_long_factors: shape: (133, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ENSUSDT   ┆ -1.692033    ┆ 0    ┆ 132          │
│ ICPUSDT   ┆ -1.668212    ┆ 1    ┆ 131          │
│ BNBUSDT   ┆ -1.649105    ┆ 2    ┆ 130          │
│ XMRUSDT   ┆ -1.631695    ┆ 3    ┆ 129          │
│ MATICUSDT ┆ -1.624223    ┆ 4    ┆ 128          │
│ APEUSDT   ┆ -1.600655    ┆ 5    ┆ 127          │
│ AAVEUSDT  ┆ -1.595579    ┆ 6    ┆ 126          │
│ SUSHIUSDT ┆ -1.593177    ┆ 7    ┆ 125          │
│ LUNA2USDT ┆ -1.593028    ┆ 8    ┆ 124          │
│ DOTUSDT   ┆ -1.592688    ┆ 9    ┆ 123          │
│ …         ┆ …            ┆ …    ┆ …            │
│ FLMUSDT   ┆ -0.010721    ┆ 123  ┆ 9            │
│ ZENUSDT   ┆ 0.028797     ┆ 124  ┆ 8            │
│ CTSIUSDT  ┆ 0.044567     ┆ 125  ┆ 7            │
│ ONEUSDT   ┆ 0.072716     ┆ 126  ┆ 6            │
│ SKLUSDT   ┆ 0.080638     ┆ 127  ┆ 5            │
│ TOMOUSDT  ┆ 0.259299     ┆ 128  ┆ 4            │
│ CELRUSDT  ┆ 0.272441     ┆ 129  ┆ 3            │
│ ARPAUSDT  ┆ 0.310592     ┆ 130  ┆ 2            │
│ DUSKUSDT  ┆ 0.347469     ┆ 131  ┆ 1            │
│ DEFIUSDT  ┆ 0.365679     ┆ 132  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:13,812 - WARNING - 2023-01-10T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:13,812 - INFO - cur close time: 2023-01-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:13,813 - DEBUG - mean expected ret (mean factor): -0.8253916469847499
2024-11-20 23:07:13,818 - DEBUG - begin to update pos: =========
2024-11-20 23:07:13,818 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,819 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1667      ┆ null        ┆ … ┆ 0.02399 ┆ null   ┆ null    ┆ 0.1738  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,825 - DEBUG - update position: 2023-01-10T23:59:59.999 === diff_trading_value: 200000.0 == cash: 99800.0 
2024-11-20 23:07:13,831 - DEBUG - cur time: 2023-01-11T23:59:59.999 == next bar open time: 2023-01-12T00:00:00.000 == close pos time: 2023-01-19T00:00:00.000
2024-11-20 23:07:13,833 - INFO - pnl: 2023-01-11T23:59:59.999 99216.76098267068 === -0.584%
2024-11-20 23:07:13,836 - DEBUG - cur time: 2023-01-12T23:59:59.999 == next bar open time: 2023-01-13T00:00:00.000 == close pos time: 2023-01-20T00:00:00.000
2024-11-20 23:07:13,838 - INFO - pnl: 2023-01-12T23:59:59.999 100030.88005031268 === 0.821%
2024-11-20 23:07:13,844 - DEBUG - cur time: 2023-01-13T23:59:59.999 == next bar open time: 2023-01-14T00:00:00.000 == close pos time: 2023-01-21T00:00:00.000
2024-11-20 23:07:13,847 - INFO - pnl: 2023-01-13T23:59:59.999 101865.00053841644 === 1.834%
2024-11-20 23:07:13,855 - DEBUG - cur time: 2023-01-14T23:59:59.999 == next bar open time: 2023-01-15T00:00:00.000 == close pos time: 2023-01-22T00:00:00.000
2024-11-20 23:07:13,859 - INFO - pnl: 2023-01-14T23:59:59.999 100539.34117369197 === -1.301%
2024-11-20 23:07:13,867 - DEBUG - cur time: 2023-01-15T23:59:59.999 == next bar open time: 2023-01-16T00:00:00.000 == close pos time: 2023-01-23T00:00:00.000
2024-11-20 23:07:13,869 - INFO - pnl: 2023-01-15T23:59:59.999 99311.20786984763 === -1.222%
2024-11-20 23:07:13,873 - DEBUG - cur time: 2023-01-16T23:59:59.999 == next bar open time: 2023-01-17T00:00:00.000 == close pos time: 2023-01-24T00:00:00.000
2024-11-20 23:07:13,874 - INFO - pnl: 2023-01-16T23:59:59.999 99185.58316354192 === -0.126%
2024-11-20 23:07:13,877 - DEBUG - cur time: 2023-01-17T23:59:59.999 == next bar open time: 2023-01-18T00:00:00.000 == close pos time: 2023-01-25T00:00:00.000
2024-11-20 23:07:13,886 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT      ┆ -1.938059    ┆ 0    ┆ 132          │
│ DASHUSDT     ┆ -1.913878    ┆ 1    ┆ 131          │
│ ZECUSDT      ┆ -1.871802    ┆ 2    ┆ 130          │
│ CVXUSDT      ┆ -1.717741    ┆ 3    ┆ 129          │
│ AAVEUSDT     ┆ -1.710542    ┆ 4    ┆ 128          │
│ UNIUSDT      ┆ -1.628851    ┆ 5    ┆ 127          │
│ 1000LUNCUSDT ┆ -1.580168    ┆ 6    ┆ 126          │
│ ENSUSDT      ┆ -1.571127    ┆ 7    ┆ 125          │
│ ICPUSDT      ┆ -1.562138    ┆ 8    ┆ 124          │
│ LUNA2USDT    ┆ -1.546066    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BALUSDT      ┆ -0.239821    ┆ 123  ┆ 9            │
│ IOTXUSDT     ┆ -0.223802    ┆ 124  ┆ 8            │
│ ANTUSDT      ┆ -0.212496    ┆ 125  ┆ 7            │
│ FLMUSDT      ┆ -0.156396    ┆ 126  ┆ 6            │
│ CTSIUSDT     ┆ -0.070732    ┆ 127  ┆ 5            │
│ API3USDT     ┆ 0.096454     ┆ 128  ┆ 4            │
│ TOMOUSDT     ┆ 0.153317     ┆ 129  ┆ 3            │
│ LPTUSDT      ┆ 0.275386     ┆ 130  ┆ 2            │
│ ARPAUSDT     ┆ 0.313259     ┆ 131  ┆ 1            │
│ DEFIUSDT     ┆ 0.401237     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:13,896 - WARNING - 2023-01-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:13,896 - INFO - cur close time: 2023-01-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:13,896 - DEBUG - mean expected ret (mean factor): -0.8203105825782205
2024-11-20 23:07:13,902 - DEBUG - begin to update pos: =========
2024-11-20 23:07:13,902 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,902 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1745      ┆ null        ┆ … ┆ 0.0272  ┆ null   ┆ null    ┆ 0.2082  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,908 - DEBUG - update position: 2023-01-17T23:59:59.999 === diff_trading_value: 222390.45810476848 == cash: 99212.17520745037 
2024-11-20 23:07:13,909 - INFO - pnl: 2023-01-17T23:59:59.999 99212.17520745037 === 0.027%
2024-11-20 23:07:13,913 - DEBUG - cur time: 2023-01-18T23:59:59.999 == next bar open time: 2023-01-19T00:00:00.000 == close pos time: 2023-01-26T00:00:00.000
2024-11-20 23:07:13,914 - INFO - pnl: 2023-01-18T23:59:59.999 96352.61827325683 === -2.882%
2024-11-20 23:07:13,917 - DEBUG - cur time: 2023-01-19T23:59:59.999 == next bar open time: 2023-01-20T00:00:00.000 == close pos time: 2023-01-27T00:00:00.000
2024-11-20 23:07:13,918 - INFO - pnl: 2023-01-19T23:59:59.999 95299.36529033234 === -1.093%
2024-11-20 23:07:13,921 - DEBUG - cur time: 2023-01-20T23:59:59.999 == next bar open time: 2023-01-21T00:00:00.000 == close pos time: 2023-01-28T00:00:00.000
2024-11-20 23:07:13,923 - INFO - pnl: 2023-01-20T23:59:59.999 98441.54416607649 === 3.297%
2024-11-20 23:07:13,926 - DEBUG - cur time: 2023-01-21T23:59:59.999 == next bar open time: 2023-01-22T00:00:00.000 == close pos time: 2023-01-29T00:00:00.000
2024-11-20 23:07:13,927 - INFO - pnl: 2023-01-21T23:59:59.999 99021.54238586573 === 0.589%
2024-11-20 23:07:13,931 - DEBUG - cur time: 2023-01-22T23:59:59.999 == next bar open time: 2023-01-23T00:00:00.000 == close pos time: 2023-01-30T00:00:00.000
2024-11-20 23:07:13,932 - INFO - pnl: 2023-01-22T23:59:59.999 99856.99797527572 === 0.844%
2024-11-20 23:07:13,935 - DEBUG - cur time: 2023-01-23T23:59:59.999 == next bar open time: 2023-01-24T00:00:00.000 == close pos time: 2023-01-31T00:00:00.000
2024-11-20 23:07:13,937 - INFO - pnl: 2023-01-23T23:59:59.999 103106.36403461556 === 3.254%
2024-11-20 23:07:13,941 - DEBUG - cur time: 2023-01-24T23:59:59.999 == next bar open time: 2023-01-25T00:00:00.000 == close pos time: 2023-02-01T00:00:00.000
2024-11-20 23:07:13,953 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LDOUSDT      ┆ -1.768018    ┆ 0    ┆ 132          │
│ UNFIUSDT     ┆ -1.669222    ┆ 1    ┆ 131          │
│ LUNA2USDT    ┆ -1.633692    ┆ 2    ┆ 130          │
│ OCEANUSDT    ┆ -1.621068    ┆ 3    ┆ 129          │
│ ALPHAUSDT    ┆ -1.618078    ┆ 4    ┆ 128          │
│ LITUSDT      ┆ -1.538258    ┆ 5    ┆ 127          │
│ 1000LUNCUSDT ┆ -1.511007    ┆ 6    ┆ 126          │
│ INJUSDT      ┆ -1.480463    ┆ 7    ┆ 125          │
│ BNBUSDT      ┆ -1.475958    ┆ 8    ┆ 124          │
│ KAVAUSDT     ┆ -1.446431    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BALUSDT      ┆ -0.208878    ┆ 123  ┆ 9            │
│ XMRUSDT      ┆ -0.17131     ┆ 124  ┆ 8            │
│ TOMOUSDT     ┆ -0.171031    ┆ 125  ┆ 7            │
│ ZECUSDT      ┆ -0.07002     ┆ 126  ┆ 6            │
│ SFPUSDT      ┆ -0.052726    ┆ 127  ┆ 5            │
│ QTUMUSDT     ┆ -0.048913    ┆ 128  ┆ 4            │
│ SKLUSDT      ┆ 0.078378     ┆ 129  ┆ 3            │
│ ANTUSDT      ┆ 0.116244     ┆ 130  ┆ 2            │
│ ARPAUSDT     ┆ 0.188386     ┆ 131  ┆ 1            │
│ DEFIUSDT     ┆ 1.251692     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:13,966 - INFO - cur close time: 2023-01-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:13,966 - DEBUG - mean expected ret (mean factor): -0.819129117978035
2024-11-20 23:07:13,975 - DEBUG - begin to update pos: =========
2024-11-20 23:07:13,975 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,976 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.17        ┆ null        ┆ … ┆ 0.027   ┆ null   ┆ null    ┆ 0.2174  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:13,984 - DEBUG - update position: 2023-01-24T23:59:59.999 === diff_trading_value: 236559.58031360508 == cash: 105297.93363191985 
2024-11-20 23:07:13,986 - INFO - pnl: 2023-01-24T23:59:59.999 105297.93363191985 === 2.126%
2024-11-20 23:07:13,989 - DEBUG - cur time: 2023-01-25T23:59:59.999 == next bar open time: 2023-01-26T00:00:00.000 == close pos time: 2023-02-02T00:00:00.000
2024-11-20 23:07:13,991 - INFO - pnl: 2023-01-25T23:59:59.999 104019.6630168188 === -1.214%
2024-11-20 23:07:13,996 - DEBUG - cur time: 2023-01-26T23:59:59.999 == next bar open time: 2023-01-27T00:00:00.000 == close pos time: 2023-02-03T00:00:00.000
2024-11-20 23:07:13,999 - INFO - pnl: 2023-01-26T23:59:59.999 104577.69051892906 === 0.536%
2024-11-20 23:07:14,003 - DEBUG - cur time: 2023-01-27T23:59:59.999 == next bar open time: 2023-01-28T00:00:00.000 == close pos time: 2023-02-04T00:00:00.000
2024-11-20 23:07:14,005 - INFO - pnl: 2023-01-27T23:59:59.999 105732.75899419532 === 1.105%
2024-11-20 23:07:14,008 - DEBUG - cur time: 2023-01-28T23:59:59.999 == next bar open time: 2023-01-29T00:00:00.000 == close pos time: 2023-02-05T00:00:00.000
2024-11-20 23:07:14,010 - INFO - pnl: 2023-01-28T23:59:59.999 106144.23039621994 === 0.389%
2024-11-20 23:07:14,013 - DEBUG - cur time: 2023-01-29T23:59:59.999 == next bar open time: 2023-01-30T00:00:00.000 == close pos time: 2023-02-06T00:00:00.000
2024-11-20 23:07:14,015 - INFO - pnl: 2023-01-29T23:59:59.999 108248.92870850708 === 1.983%
2024-11-20 23:07:14,019 - DEBUG - cur time: 2023-01-30T23:59:59.999 == next bar open time: 2023-01-31T00:00:00.000 == close pos time: 2023-02-07T00:00:00.000
2024-11-20 23:07:14,020 - INFO - pnl: 2023-01-30T23:59:59.999 110062.3717560467 === 1.675%
2024-11-20 23:07:14,024 - DEBUG - cur time: 2023-01-31T23:59:59.999 == next bar open time: 2023-02-01T00:00:00.000 == close pos time: 2023-02-08T00:00:00.000
2024-11-20 23:07:14,036 - DEBUG - sorted_long_factors: shape: (135, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT   ┆ -1.988895    ┆ 0    ┆ 134          │
│ LUNA2USDT ┆ -1.920017    ┆ 1    ┆ 133          │
│ LDOUSDT   ┆ -1.858184    ┆ 2    ┆ 132          │
│ COMPUSDT  ┆ -1.849141    ┆ 3    ┆ 131          │
│ QNTUSDT   ┆ -1.81068     ┆ 4    ┆ 130          │
│ FILUSDT   ┆ -1.769833    ┆ 5    ┆ 129          │
│ AAVEUSDT  ┆ -1.74458     ┆ 6    ┆ 128          │
│ INJUSDT   ┆ -1.682386    ┆ 7    ┆ 127          │
│ WAVESUSDT ┆ -1.624685    ┆ 8    ┆ 126          │
│ DASHUSDT  ┆ -1.612175    ┆ 9    ┆ 125          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CELRUSDT  ┆ -0.09082     ┆ 125  ┆ 9            │
│ API3USDT  ┆ -0.069411    ┆ 126  ┆ 8            │
│ LINAUSDT  ┆ -0.059542    ┆ 127  ┆ 7            │
│ BLZUSDT   ┆ -0.039041    ┆ 128  ┆ 6            │
│ DENTUSDT  ┆ -0.003208    ┆ 129  ┆ 5            │
│ ARPAUSDT  ┆ 0.185226     ┆ 130  ┆ 4            │
│ SKLUSDT   ┆ 0.238616     ┆ 131  ┆ 3            │
│ TOMOUSDT  ┆ 0.251914     ┆ 132  ┆ 2            │
│ DGBUSDT   ┆ 0.521136     ┆ 133  ┆ 1            │
│ DEFIUSDT  ┆ 2.479871     ┆ 134  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:14,046 - WARNING - 2023-01-31T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:14,047 - INFO - cur close time: 2023-01-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:14,047 - DEBUG - mean expected ret (mean factor): -0.8178799922574597
2024-11-20 23:07:14,057 - DEBUG - begin to update pos: =========
2024-11-20 23:07:14,057 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,058 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1715      ┆ null        ┆ … ┆ 0.02694 ┆ null   ┆ null    ┆ 0.2163  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,069 - DEBUG - update position: 2023-01-31T23:59:59.999 === diff_trading_value: 271657.98804169707 == cash: 107282.91130137887 
2024-11-20 23:07:14,070 - INFO - pnl: 2023-01-31T23:59:59.999 107282.91130137887 === -2.525%
2024-11-20 23:07:14,075 - DEBUG - cur time: 2023-02-01T23:59:59.999 == next bar open time: 2023-02-02T00:00:00.000 == close pos time: 2023-02-09T00:00:00.000
2024-11-20 23:07:14,076 - INFO - pnl: 2023-02-01T23:59:59.999 104761.47400804586 === -2.350%
2024-11-20 23:07:14,081 - DEBUG - cur time: 2023-02-02T23:59:59.999 == next bar open time: 2023-02-03T00:00:00.000 == close pos time: 2023-02-10T00:00:00.000
2024-11-20 23:07:14,083 - INFO - pnl: 2023-02-02T23:59:59.999 108366.0528707357 === 3.441%
2024-11-20 23:07:14,087 - DEBUG - cur time: 2023-02-03T23:59:59.999 == next bar open time: 2023-02-04T00:00:00.000 == close pos time: 2023-02-11T00:00:00.000
2024-11-20 23:07:14,088 - INFO - pnl: 2023-02-03T23:59:59.999 108632.87205580778 === 0.246%
2024-11-20 23:07:14,091 - DEBUG - cur time: 2023-02-04T23:59:59.999 == next bar open time: 2023-02-05T00:00:00.000 == close pos time: 2023-02-12T00:00:00.000
2024-11-20 23:07:14,094 - INFO - pnl: 2023-02-04T23:59:59.999 111636.95634679722 === 2.765%
2024-11-20 23:07:14,099 - DEBUG - cur time: 2023-02-05T23:59:59.999 == next bar open time: 2023-02-06T00:00:00.000 == close pos time: 2023-02-13T00:00:00.000
2024-11-20 23:07:14,101 - INFO - pnl: 2023-02-05T23:59:59.999 112828.56327302539 === 1.067%
2024-11-20 23:07:14,104 - DEBUG - cur time: 2023-02-06T23:59:59.999 == next bar open time: 2023-02-07T00:00:00.000 == close pos time: 2023-02-14T00:00:00.000
2024-11-20 23:07:14,105 - INFO - pnl: 2023-02-06T23:59:59.999 112411.73199482664 === -0.369%
2024-11-20 23:07:14,110 - DEBUG - cur time: 2023-02-07T23:59:59.999 == next bar open time: 2023-02-08T00:00:00.000 == close pos time: 2023-02-15T00:00:00.000
2024-11-20 23:07:14,118 - DEBUG - sorted_long_factors: shape: (135, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ APTUSDT   ┆ -1.989708    ┆ 0    ┆ 134          │
│ LDOUSDT   ┆ -1.740658    ┆ 1    ┆ 133          │
│ BNBUSDT   ┆ -1.692919    ┆ 2    ┆ 132          │
│ AXSUSDT   ┆ -1.683909    ┆ 3    ┆ 131          │
│ TRBUSDT   ┆ -1.649956    ┆ 4    ┆ 130          │
│ LUNA2USDT ┆ -1.606734    ┆ 5    ┆ 129          │
│ SNXUSDT   ┆ -1.592562    ┆ 6    ┆ 128          │
│ COMPUSDT  ┆ -1.590555    ┆ 7    ┆ 127          │
│ UNIUSDT   ┆ -1.524581    ┆ 8    ┆ 126          │
│ AAVEUSDT  ┆ -1.523722    ┆ 9    ┆ 125          │
│ …         ┆ …            ┆ …    ┆ …            │
│ OGNUSDT   ┆ -0.105688    ┆ 125  ┆ 9            │
│ DUSKUSDT  ┆ -0.083229    ┆ 126  ┆ 8            │
│ CTSIUSDT  ┆ -0.012311    ┆ 127  ┆ 7            │
│ DENTUSDT  ┆ 0.0442       ┆ 128  ┆ 6            │
│ ARPAUSDT  ┆ 0.056458     ┆ 129  ┆ 5            │
│ API3USDT  ┆ 0.140792     ┆ 130  ┆ 4            │
│ SKLUSDT   ┆ 0.178218     ┆ 131  ┆ 3            │
│ LINAUSDT  ┆ 0.189799     ┆ 132  ┆ 2            │
│ DGBUSDT   ┆ 0.947983     ┆ 133  ┆ 1            │
│ DEFIUSDT  ┆ 1.747547     ┆ 134  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:14,124 - WARNING - 2023-02-07T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:14,124 - INFO - cur close time: 2023-02-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:14,124 - DEBUG - mean expected ret (mean factor): -0.8016110841489972
2024-11-20 23:07:14,128 - DEBUG - begin to update pos: =========
2024-11-20 23:07:14,128 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,129 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1862      ┆ null        ┆ … ┆ 0.03091 ┆ null   ┆ null    ┆ 0.261   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,135 - DEBUG - update position: 2023-02-07T23:59:59.999 === diff_trading_value: 237549.38528155262 == cash: 113366.90050966872 
2024-11-20 23:07:14,136 - INFO - pnl: 2023-02-07T23:59:59.999 113366.90050966872 === 0.850%
2024-11-20 23:07:14,142 - DEBUG - cur time: 2023-02-08T23:59:59.999 == next bar open time: 2023-02-09T00:00:00.000 == close pos time: 2023-02-16T00:00:00.000
2024-11-20 23:07:14,142 - INFO - pnl: 2023-02-08T23:59:59.999 113657.57604781375 === 0.256%
2024-11-20 23:07:14,145 - DEBUG - cur time: 2023-02-09T23:59:59.999 == next bar open time: 2023-02-10T00:00:00.000 == close pos time: 2023-02-17T00:00:00.000
2024-11-20 23:07:14,146 - INFO - pnl: 2023-02-09T23:59:59.999 111774.87187795469 === -1.656%
2024-11-20 23:07:14,149 - DEBUG - cur time: 2023-02-10T23:59:59.999 == next bar open time: 2023-02-11T00:00:00.000 == close pos time: 2023-02-18T00:00:00.000
2024-11-20 23:07:14,150 - INFO - pnl: 2023-02-10T23:59:59.999 115857.15584434324 === 3.652%
2024-11-20 23:07:14,154 - DEBUG - cur time: 2023-02-11T23:59:59.999 == next bar open time: 2023-02-12T00:00:00.000 == close pos time: 2023-02-19T00:00:00.000
2024-11-20 23:07:14,155 - INFO - pnl: 2023-02-11T23:59:59.999 117778.492533077 === 1.658%
2024-11-20 23:07:14,161 - DEBUG - cur time: 2023-02-12T23:59:59.999 == next bar open time: 2023-02-13T00:00:00.000 == close pos time: 2023-02-20T00:00:00.000
2024-11-20 23:07:14,161 - INFO - pnl: 2023-02-12T23:59:59.999 120338.68780551571 === 2.174%
2024-11-20 23:07:14,167 - DEBUG - cur time: 2023-02-13T23:59:59.999 == next bar open time: 2023-02-14T00:00:00.000 == close pos time: 2023-02-21T00:00:00.000
2024-11-20 23:07:14,168 - INFO - pnl: 2023-02-13T23:59:59.999 117229.82028796777 === -2.583%
2024-11-20 23:07:14,172 - DEBUG - cur time: 2023-02-14T23:59:59.999 == next bar open time: 2023-02-15T00:00:00.000 == close pos time: 2023-02-22T00:00:00.000
2024-11-20 23:07:14,181 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LDOUSDT      ┆ -1.950733    ┆ 0    ┆ 135          │
│ AXSUSDT      ┆ -1.934625    ┆ 1    ┆ 134          │
│ ATOMUSDT     ┆ -1.92963     ┆ 2    ┆ 133          │
│ NEARUSDT     ┆ -1.879942    ┆ 3    ┆ 132          │
│ LITUSDT      ┆ -1.68336     ┆ 4    ┆ 131          │
│ FOOTBALLUSDT ┆ -1.634724    ┆ 5    ┆ 130          │
│ STGUSDT      ┆ -1.581742    ┆ 6    ┆ 129          │
│ SNXUSDT      ┆ -1.531392    ┆ 7    ┆ 128          │
│ INJUSDT      ┆ -1.527563    ┆ 8    ┆ 127          │
│ DASHUSDT     ┆ -1.477715    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOTXUSDT     ┆ 0.046415     ┆ 126  ┆ 9            │
│ NKNUSDT      ┆ 0.054184     ┆ 127  ┆ 8            │
│ 1000XECUSDT  ┆ 0.115086     ┆ 128  ┆ 7            │
│ ANTUSDT      ┆ 0.142615     ┆ 129  ┆ 6            │
│ BELUSDT      ┆ 0.164841     ┆ 130  ┆ 5            │
│ DENTUSDT     ┆ 0.413701     ┆ 131  ┆ 4            │
│ LINAUSDT     ┆ 0.475496     ┆ 132  ┆ 3            │
│ DEFIUSDT     ┆ 0.711555     ┆ 133  ┆ 2            │
│ DGBUSDT      ┆ 0.958144     ┆ 134  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.038235     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:14,187 - WARNING - 2023-02-14T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:14,187 - INFO - cur close time: 2023-02-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:14,187 - DEBUG - mean expected ret (mean factor): -0.7953509269627759
2024-11-20 23:07:14,192 - DEBUG - begin to update pos: =========
2024-11-20 23:07:14,192 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,192 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1697      ┆ null        ┆ … ┆ 0.02959 ┆ null   ┆ null    ┆ 0.233   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,199 - DEBUG - update position: 2023-02-14T23:59:59.999 === diff_trading_value: 241713.80834486126 == cash: 117285.28488869478 
2024-11-20 23:07:14,201 - INFO - pnl: 2023-02-14T23:59:59.999 117285.28488869478 === 0.047%
2024-11-20 23:07:14,206 - DEBUG - cur time: 2023-02-15T23:59:59.999 == next bar open time: 2023-02-16T00:00:00.000 == close pos time: 2023-02-23T00:00:00.000
2024-11-20 23:07:14,208 - INFO - pnl: 2023-02-15T23:59:59.999 113291.66378090135 === -3.405%
2024-11-20 23:07:14,212 - DEBUG - cur time: 2023-02-16T23:59:59.999 == next bar open time: 2023-02-17T00:00:00.000 == close pos time: 2023-02-24T00:00:00.000
2024-11-20 23:07:14,213 - INFO - pnl: 2023-02-16T23:59:59.999 113338.93153426636 === 0.042%
2024-11-20 23:07:14,217 - DEBUG - cur time: 2023-02-17T23:59:59.999 == next bar open time: 2023-02-18T00:00:00.000 == close pos time: 2023-02-25T00:00:00.000
2024-11-20 23:07:14,218 - INFO - pnl: 2023-02-17T23:59:59.999 114667.99739389447 === 1.173%
2024-11-20 23:07:14,223 - DEBUG - cur time: 2023-02-18T23:59:59.999 == next bar open time: 2023-02-19T00:00:00.000 == close pos time: 2023-02-26T00:00:00.000
2024-11-20 23:07:14,225 - INFO - pnl: 2023-02-18T23:59:59.999 111841.93104948857 === -2.465%
2024-11-20 23:07:14,228 - DEBUG - cur time: 2023-02-19T23:59:59.999 == next bar open time: 2023-02-20T00:00:00.000 == close pos time: 2023-02-27T00:00:00.000
2024-11-20 23:07:14,230 - INFO - pnl: 2023-02-19T23:59:59.999 115709.85923819021 === 3.458%
2024-11-20 23:07:14,233 - DEBUG - cur time: 2023-02-20T23:59:59.999 == next bar open time: 2023-02-21T00:00:00.000 == close pos time: 2023-02-28T00:00:00.000
2024-11-20 23:07:14,234 - INFO - pnl: 2023-02-20T23:59:59.999 122879.28524399955 === 6.196%
2024-11-20 23:07:14,237 - DEBUG - cur time: 2023-02-21T23:59:59.999 == next bar open time: 2023-02-22T00:00:00.000 == close pos time: 2023-03-01T00:00:00.000
2024-11-20 23:07:14,245 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -1.603588    ┆ 0    ┆ 135          │
│ APTUSDT      ┆ -1.545618    ┆ 1    ┆ 134          │
│ LUNA2USDT    ┆ -1.53194     ┆ 2    ┆ 133          │
│ UNFIUSDT     ┆ -1.53049     ┆ 3    ┆ 132          │
│ INJUSDT      ┆ -1.491392    ┆ 4    ┆ 131          │
│ ZECUSDT      ┆ -1.487994    ┆ 5    ┆ 130          │
│ MKRUSDT      ┆ -1.459221    ┆ 6    ┆ 129          │
│ COMPUSDT     ┆ -1.437142    ┆ 7    ┆ 128          │
│ GTCUSDT      ┆ -1.4311      ┆ 8    ┆ 127          │
│ TRBUSDT      ┆ -1.378414    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ AAVEUSDT     ┆ -0.257736    ┆ 126  ┆ 9            │
│ LINAUSDT     ┆ -0.234033    ┆ 127  ┆ 8            │
│ DGBUSDT      ┆ -0.223287    ┆ 128  ┆ 7            │
│ ZENUSDT      ┆ -0.11067     ┆ 129  ┆ 6            │
│ DASHUSDT     ┆ -0.09791     ┆ 130  ┆ 5            │
│ 1000XECUSDT  ┆ -0.080921    ┆ 131  ┆ 4            │
│ API3USDT     ┆ 0.018163     ┆ 132  ┆ 3            │
│ ANTUSDT      ┆ 0.253778     ┆ 133  ┆ 2            │
│ DEFIUSDT     ┆ 1.49074      ┆ 134  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.588873     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:14,252 - WARNING - 2023-02-21T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:14,252 - INFO - cur close time: 2023-02-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:14,252 - DEBUG - mean expected ret (mean factor): -0.7862683119923586
2024-11-20 23:07:14,259 - DEBUG - begin to update pos: =========
2024-11-20 23:07:14,259 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,260 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.166       ┆ null        ┆ … ┆ 0.03508 ┆ null   ┆ null    ┆ 0.2674  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,271 - DEBUG - update position: 2023-02-21T23:59:59.999 === diff_trading_value: 314459.5608931436 == cash: 128686.996402757 
2024-11-20 23:07:14,275 - INFO - pnl: 2023-02-21T23:59:59.999 128686.996402757 === 4.726%
2024-11-20 23:07:14,280 - DEBUG - cur time: 2023-02-22T23:59:59.999 == next bar open time: 2023-02-23T00:00:00.000 == close pos time: 2023-03-02T00:00:00.000
2024-11-20 23:07:14,282 - INFO - pnl: 2023-02-22T23:59:59.999 129617.35981038609 === 0.723%
2024-11-20 23:07:14,286 - DEBUG - cur time: 2023-02-23T23:59:59.999 == next bar open time: 2023-02-24T00:00:00.000 == close pos time: 2023-03-03T00:00:00.000
2024-11-20 23:07:14,288 - INFO - pnl: 2023-02-23T23:59:59.999 129079.84799018883 === -0.415%
2024-11-20 23:07:14,293 - DEBUG - cur time: 2023-02-24T23:59:59.999 == next bar open time: 2023-02-25T00:00:00.000 == close pos time: 2023-03-04T00:00:00.000
2024-11-20 23:07:14,294 - INFO - pnl: 2023-02-24T23:59:59.999 129250.25596549269 === 0.132%
2024-11-20 23:07:14,299 - DEBUG - cur time: 2023-02-25T23:59:59.999 == next bar open time: 2023-02-26T00:00:00.000 == close pos time: 2023-03-05T00:00:00.000
2024-11-20 23:07:14,300 - INFO - pnl: 2023-02-25T23:59:59.999 130437.2962046536 === 0.918%
2024-11-20 23:07:14,305 - DEBUG - cur time: 2023-02-26T23:59:59.999 == next bar open time: 2023-02-27T00:00:00.000 == close pos time: 2023-03-06T00:00:00.000
2024-11-20 23:07:14,307 - INFO - pnl: 2023-02-26T23:59:59.999 128924.63060083124 === -1.160%
2024-11-20 23:07:14,311 - DEBUG - cur time: 2023-02-27T23:59:59.999 == next bar open time: 2023-02-28T00:00:00.000 == close pos time: 2023-03-07T00:00:00.000
2024-11-20 23:07:14,313 - INFO - pnl: 2023-02-27T23:59:59.999 127974.4243475576 === -0.737%
2024-11-20 23:07:14,317 - DEBUG - cur time: 2023-02-28T23:59:59.999 == next bar open time: 2023-03-01T00:00:00.000 == close pos time: 2023-03-08T00:00:00.000
2024-11-20 23:07:14,324 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XMRUSDT      ┆ -1.741658    ┆ 0    ┆ 135          │
│ BTCDOMUSDT   ┆ -1.485581    ┆ 1    ┆ 134          │
│ 1000LUNCUSDT ┆ -1.469759    ┆ 2    ┆ 133          │
│ UNIUSDT      ┆ -1.454918    ┆ 3    ┆ 132          │
│ LDOUSDT      ┆ -1.44126     ┆ 4    ┆ 131          │
│ INJUSDT      ┆ -1.440414    ┆ 5    ┆ 130          │
│ MKRUSDT      ┆ -1.421741    ┆ 6    ┆ 129          │
│ OPUSDT       ┆ -1.41893     ┆ 7    ┆ 128          │
│ APTUSDT      ┆ -1.376714    ┆ 8    ┆ 127          │
│ MASKUSDT     ┆ -1.304044    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TOMOUSDT     ┆ -0.261038    ┆ 126  ┆ 9            │
│ SPELLUSDT    ┆ -0.243508    ┆ 127  ┆ 8            │
│ ANTUSDT      ┆ -0.071922    ┆ 128  ┆ 7            │
│ COTIUSDT     ┆ 0.009793     ┆ 129  ┆ 6            │
│ 1000XECUSDT  ┆ 0.04126      ┆ 130  ┆ 5            │
│ LPTUSDT      ┆ 0.193651     ┆ 131  ┆ 4            │
│ DARUSDT      ┆ 0.221788     ┆ 132  ┆ 3            │
│ API3USDT     ┆ 0.571166     ┆ 133  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.881068     ┆ 134  ┆ 1            │
│ DEFIUSDT     ┆ 1.242167     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:14,331 - WARNING - 2023-02-28T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:14,331 - INFO - cur close time: 2023-02-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:14,331 - DEBUG - mean expected ret (mean factor): -0.7797254999774604
2024-11-20 23:07:14,336 - DEBUG - begin to update pos: =========
2024-11-20 23:07:14,336 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,336 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1638      ┆ null        ┆ … ┆ 0.03117 ┆ null   ┆ null    ┆ 0.2545  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,341 - DEBUG - update position: 2023-02-28T23:59:59.999 === diff_trading_value: 192432.33655953262 == cash: 126502.81063379486 
2024-11-20 23:07:14,343 - INFO - pnl: 2023-02-28T23:59:59.999 126502.81063379486 === -1.150%
2024-11-20 23:07:14,346 - DEBUG - cur time: 2023-03-01T23:59:59.999 == next bar open time: 2023-03-02T00:00:00.000 == close pos time: 2023-03-09T00:00:00.000
2024-11-20 23:07:14,348 - INFO - pnl: 2023-03-01T23:59:59.999 124759.98565135161 === -1.378%
2024-11-20 23:07:14,351 - DEBUG - cur time: 2023-03-02T23:59:59.999 == next bar open time: 2023-03-03T00:00:00.000 == close pos time: 2023-03-10T00:00:00.000
2024-11-20 23:07:14,352 - INFO - pnl: 2023-03-02T23:59:59.999 124242.6754174988 === -0.415%
2024-11-20 23:07:14,357 - DEBUG - cur time: 2023-03-03T23:59:59.999 == next bar open time: 2023-03-04T00:00:00.000 == close pos time: 2023-03-11T00:00:00.000
2024-11-20 23:07:14,358 - INFO - pnl: 2023-03-03T23:59:59.999 122612.34624266833 === -1.312%
2024-11-20 23:07:14,363 - DEBUG - cur time: 2023-03-04T23:59:59.999 == next bar open time: 2023-03-05T00:00:00.000 == close pos time: 2023-03-12T00:00:00.000
2024-11-20 23:07:14,366 - INFO - pnl: 2023-03-04T23:59:59.999 123457.01655951886 === 0.689%
2024-11-20 23:07:14,371 - DEBUG - cur time: 2023-03-05T23:59:59.999 == next bar open time: 2023-03-06T00:00:00.000 == close pos time: 2023-03-13T00:00:00.000
2024-11-20 23:07:14,373 - INFO - pnl: 2023-03-05T23:59:59.999 120770.61555013686 === -2.176%
2024-11-20 23:07:14,380 - DEBUG - cur time: 2023-03-06T23:59:59.999 == next bar open time: 2023-03-07T00:00:00.000 == close pos time: 2023-03-14T00:00:00.000
2024-11-20 23:07:14,381 - INFO - pnl: 2023-03-06T23:59:59.999 120322.59832624273 === -0.371%
2024-11-20 23:07:14,388 - DEBUG - cur time: 2023-03-07T23:59:59.999 == next bar open time: 2023-03-08T00:00:00.000 == close pos time: 2023-03-15T00:00:00.000
2024-11-20 23:07:14,398 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -2.08042     ┆ 0    ┆ 135          │
│ LUNA2USDT    ┆ -1.948315    ┆ 1    ┆ 134          │
│ MKRUSDT      ┆ -1.790745    ┆ 2    ┆ 133          │
│ BALUSDT      ┆ -1.659162    ┆ 3    ┆ 132          │
│ CRVUSDT      ┆ -1.530498    ┆ 4    ┆ 131          │
│ EOSUSDT      ┆ -1.498077    ┆ 5    ┆ 130          │
│ IMXUSDT      ┆ -1.484269    ┆ 6    ┆ 129          │
│ APTUSDT      ┆ -1.464627    ┆ 7    ┆ 128          │
│ MASKUSDT     ┆ -1.433848    ┆ 8    ┆ 127          │
│ QNTUSDT      ┆ -1.422479    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ NKNUSDT      ┆ 0.020202     ┆ 126  ┆ 9            │
│ DARUSDT      ┆ 0.156098     ┆ 127  ┆ 8            │
│ DGBUSDT      ┆ 0.156337     ┆ 128  ┆ 7            │
│ CTKUSDT      ┆ 0.158561     ┆ 129  ┆ 6            │
│ HNTUSDT      ┆ 0.21202      ┆ 130  ┆ 5            │
│ LPTUSDT      ┆ 0.232999     ┆ 131  ┆ 4            │
│ DASHUSDT     ┆ 0.413693     ┆ 132  ┆ 3            │
│ CTSIUSDT     ┆ 0.422059     ┆ 133  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.494407     ┆ 134  ┆ 1            │
│ DEFIUSDT     ┆ 1.222592     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:14,408 - WARNING - 2023-03-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:14,408 - INFO - cur close time: 2023-03-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:14,409 - DEBUG - mean expected ret (mean factor): -0.7477307801223072
2024-11-20 23:07:14,416 - DEBUG - begin to update pos: =========
2024-11-20 23:07:14,417 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,417 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1419      ┆ null        ┆ … ┆ 0.02663 ┆ null   ┆ null    ┆ 0.2328  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,426 - DEBUG - update position: 2023-03-07T23:59:59.999 === diff_trading_value: 210059.31616669198 == cash: 118862.02423795687 
2024-11-20 23:07:14,428 - INFO - pnl: 2023-03-07T23:59:59.999 118862.02423795687 === -1.214%
2024-11-20 23:07:14,432 - DEBUG - cur time: 2023-03-08T23:59:59.999 == next bar open time: 2023-03-09T00:00:00.000 == close pos time: 2023-03-16T00:00:00.000
2024-11-20 23:07:14,433 - INFO - pnl: 2023-03-08T23:59:59.999 120108.06746725473 === 1.048%
2024-11-20 23:07:14,435 - DEBUG - cur time: 2023-03-09T23:59:59.999 == next bar open time: 2023-03-10T00:00:00.000 == close pos time: 2023-03-17T00:00:00.000
2024-11-20 23:07:14,438 - INFO - pnl: 2023-03-09T23:59:59.999 119269.52459945847 === -0.698%
2024-11-20 23:07:14,441 - DEBUG - cur time: 2023-03-10T23:59:59.999 == next bar open time: 2023-03-11T00:00:00.000 == close pos time: 2023-03-18T00:00:00.000
2024-11-20 23:07:14,444 - INFO - pnl: 2023-03-10T23:59:59.999 120340.44691537102 === 0.898%
2024-11-20 23:07:14,447 - DEBUG - cur time: 2023-03-11T23:59:59.999 == next bar open time: 2023-03-12T00:00:00.000 == close pos time: 2023-03-19T00:00:00.000
2024-11-20 23:07:14,449 - INFO - pnl: 2023-03-11T23:59:59.999 120993.80806567134 === 0.543%
2024-11-20 23:07:14,453 - DEBUG - cur time: 2023-03-12T23:59:59.999 == next bar open time: 2023-03-13T00:00:00.000 == close pos time: 2023-03-20T00:00:00.000
2024-11-20 23:07:14,454 - INFO - pnl: 2023-03-12T23:59:59.999 120321.31552443927 === -0.556%
2024-11-20 23:07:14,458 - DEBUG - cur time: 2023-03-13T23:59:59.999 == next bar open time: 2023-03-14T00:00:00.000 == close pos time: 2023-03-21T00:00:00.000
2024-11-20 23:07:14,459 - INFO - pnl: 2023-03-13T23:59:59.999 117521.98038315911 === -2.327%
2024-11-20 23:07:14,463 - DEBUG - cur time: 2023-03-14T23:59:59.999 == next bar open time: 2023-03-15T00:00:00.000 == close pos time: 2023-03-22T00:00:00.000
2024-11-20 23:07:14,472 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ NEOUSDT      ┆ -2.046394    ┆ 0    ┆ 134          │
│ MASKUSDT     ┆ -2.000879    ┆ 1    ┆ 133          │
│ XRPUSDT      ┆ -1.883158    ┆ 2    ┆ 132          │
│ APTUSDT      ┆ -1.807438    ┆ 3    ┆ 131          │
│ 1000SHIBUSDT ┆ -1.738687    ┆ 4    ┆ 130          │
│ BNBUSDT      ┆ -1.730602    ┆ 5    ┆ 129          │
│ FILUSDT      ┆ -1.654428    ┆ 6    ┆ 128          │
│ 1000LUNCUSDT ┆ -1.601528    ┆ 7    ┆ 127          │
│ KAVAUSDT     ┆ -1.49221     ┆ 8    ┆ 126          │
│ IMXUSDT      ┆ -1.462892    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ APEUSDT      ┆ -0.012458    ┆ 125  ┆ 9            │
│ C98USDT      ┆ 0.068025     ┆ 126  ┆ 8            │
│ MKRUSDT      ┆ 0.07265      ┆ 127  ┆ 7            │
│ TRBUSDT      ┆ 0.088056     ┆ 128  ┆ 6            │
│ DASHUSDT     ┆ 0.151017     ┆ 129  ┆ 5            │
│ DGBUSDT      ┆ 0.205288     ┆ 130  ┆ 4            │
│ 1000XECUSDT  ┆ 0.253702     ┆ 131  ┆ 3            │
│ CTSIUSDT     ┆ 0.621958     ┆ 132  ┆ 2            │
│ ARPAUSDT     ┆ 0.699122     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 0.913617     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:14,481 - WARNING - 2023-03-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:14,481 - INFO - cur close time: 2023-03-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:14,482 - DEBUG - mean expected ret (mean factor): -0.7606089973750944
2024-11-20 23:07:14,487 - DEBUG - begin to update pos: =========
2024-11-20 23:07:14,487 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,488 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.133       ┆ null        ┆ … ┆ 0.02816 ┆ null   ┆ null    ┆ 0.2357  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,495 - DEBUG - update position: 2023-03-14T23:59:59.999 === diff_trading_value: 215310.57655071595 == cash: 117571.94015023994 
2024-11-20 23:07:14,497 - INFO - pnl: 2023-03-14T23:59:59.999 117571.94015023994 === 0.043%
2024-11-20 23:07:14,501 - DEBUG - cur time: 2023-03-15T23:59:59.999 == next bar open time: 2023-03-16T00:00:00.000 == close pos time: 2023-03-23T00:00:00.000
2024-11-20 23:07:14,502 - INFO - pnl: 2023-03-15T23:59:59.999 114524.20793862667 === -2.592%
2024-11-20 23:07:14,506 - DEBUG - cur time: 2023-03-16T23:59:59.999 == next bar open time: 2023-03-17T00:00:00.000 == close pos time: 2023-03-24T00:00:00.000
2024-11-20 23:07:14,508 - INFO - pnl: 2023-03-16T23:59:59.999 114454.80271332897 === -0.061%
2024-11-20 23:07:14,514 - DEBUG - cur time: 2023-03-17T23:59:59.999 == next bar open time: 2023-03-18T00:00:00.000 == close pos time: 2023-03-25T00:00:00.000
2024-11-20 23:07:14,516 - INFO - pnl: 2023-03-17T23:59:59.999 111724.88305513754 === -2.385%
2024-11-20 23:07:14,520 - DEBUG - cur time: 2023-03-18T23:59:59.999 == next bar open time: 2023-03-19T00:00:00.000 == close pos time: 2023-03-26T00:00:00.000
2024-11-20 23:07:14,521 - INFO - pnl: 2023-03-18T23:59:59.999 109685.66476430287 === -1.825%
2024-11-20 23:07:14,524 - DEBUG - cur time: 2023-03-19T23:59:59.999 == next bar open time: 2023-03-20T00:00:00.000 == close pos time: 2023-03-27T00:00:00.000
2024-11-20 23:07:14,526 - INFO - pnl: 2023-03-19T23:59:59.999 109554.73949109067 === -0.119%
2024-11-20 23:07:14,530 - DEBUG - cur time: 2023-03-20T23:59:59.999 == next bar open time: 2023-03-21T00:00:00.000 == close pos time: 2023-03-28T00:00:00.000
2024-11-20 23:07:14,533 - INFO - pnl: 2023-03-20T23:59:59.999 111754.92958179313 === 2.008%
2024-11-20 23:07:14,537 - DEBUG - cur time: 2023-03-21T23:59:59.999 == next bar open time: 2023-03-22T00:00:00.000 == close pos time: 2023-03-29T00:00:00.000
2024-11-20 23:07:14,551 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ATOMUSDT     ┆ -1.886196    ┆ 0    ┆ 134          │
│ APTUSDT      ┆ -1.858268    ┆ 1    ┆ 133          │
│ FILUSDT      ┆ -1.821849    ┆ 2    ┆ 132          │
│ LUNA2USDT    ┆ -1.791382    ┆ 3    ┆ 131          │
│ LDOUSDT      ┆ -1.784845    ┆ 4    ┆ 130          │
│ AXSUSDT      ┆ -1.784071    ┆ 5    ┆ 129          │
│ NEOUSDT      ┆ -1.77314     ┆ 6    ┆ 128          │
│ EGLDUSDT     ┆ -1.654505    ┆ 7    ┆ 127          │
│ 1000LUNCUSDT ┆ -1.606354    ┆ 8    ┆ 126          │
│ YFIUSDT      ┆ -1.449646    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BLZUSDT      ┆ -0.026321    ┆ 125  ┆ 9            │
│ C98USDT      ┆ -0.020654    ┆ 126  ┆ 8            │
│ REEFUSDT     ┆ 0.01676      ┆ 127  ┆ 7            │
│ OGNUSDT      ┆ 0.133308     ┆ 128  ┆ 6            │
│ IOTXUSDT     ┆ 0.228186     ┆ 129  ┆ 5            │
│ SPELLUSDT    ┆ 0.281926     ┆ 130  ┆ 4            │
│ 1000XECUSDT  ┆ 0.371884     ┆ 131  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.387931     ┆ 132  ┆ 2            │
│ DGBUSDT      ┆ 0.482773     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 0.780161     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:14,566 - WARNING - 2023-03-21T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:14,567 - INFO - cur close time: 2023-03-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:14,567 - DEBUG - mean expected ret (mean factor): -0.7609687379430001
2024-11-20 23:07:14,574 - DEBUG - begin to update pos: =========
2024-11-20 23:07:14,574 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,575 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.129       ┆ null        ┆ … ┆ 0.02868 ┆ null   ┆ null    ┆ 0.2378  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,588 - DEBUG - update position: 2023-03-21T23:59:59.999 === diff_trading_value: 233562.9945013624 == cash: 111976.60134731304 
2024-11-20 23:07:14,591 - INFO - pnl: 2023-03-21T23:59:59.999 111976.60134731304 === 0.198%
2024-11-20 23:07:14,600 - DEBUG - cur time: 2023-03-22T23:59:59.999 == next bar open time: 2023-03-23T00:00:00.000 == close pos time: 2023-03-30T00:00:00.000
2024-11-20 23:07:14,604 - INFO - pnl: 2023-03-22T23:59:59.999 109728.86734038798 === -2.007%
2024-11-20 23:07:14,611 - DEBUG - cur time: 2023-03-23T23:59:59.999 == next bar open time: 2023-03-24T00:00:00.000 == close pos time: 2023-03-31T00:00:00.000
2024-11-20 23:07:14,614 - INFO - pnl: 2023-03-23T23:59:59.999 112354.53371985827 === 2.393%
2024-11-20 23:07:14,621 - DEBUG - cur time: 2023-03-24T23:59:59.999 == next bar open time: 2023-03-25T00:00:00.000 == close pos time: 2023-04-01T00:00:00.000
2024-11-20 23:07:14,624 - INFO - pnl: 2023-03-24T23:59:59.999 113374.20270877374 === 0.908%
2024-11-20 23:07:14,630 - DEBUG - cur time: 2023-03-25T23:59:59.999 == next bar open time: 2023-03-26T00:00:00.000 == close pos time: 2023-04-02T00:00:00.000
2024-11-20 23:07:14,633 - INFO - pnl: 2023-03-25T23:59:59.999 112662.82242150012 === -0.627%
2024-11-20 23:07:14,640 - DEBUG - cur time: 2023-03-26T23:59:59.999 == next bar open time: 2023-03-27T00:00:00.000 == close pos time: 2023-04-03T00:00:00.000
2024-11-20 23:07:14,644 - INFO - pnl: 2023-03-26T23:59:59.999 112881.2021249719 === 0.194%
2024-11-20 23:07:14,650 - DEBUG - cur time: 2023-03-27T23:59:59.999 == next bar open time: 2023-03-28T00:00:00.000 == close pos time: 2023-04-04T00:00:00.000
2024-11-20 23:07:14,653 - INFO - pnl: 2023-03-27T23:59:59.999 111082.27545929741 === -1.594%
2024-11-20 23:07:14,659 - DEBUG - cur time: 2023-03-28T23:59:59.999 == next bar open time: 2023-03-29T00:00:00.000 == close pos time: 2023-04-05T00:00:00.000
2024-11-20 23:07:14,674 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -2.050483    ┆ 0    ┆ 134          │
│ FILUSDT      ┆ -2.019158    ┆ 1    ┆ 133          │
│ MKRUSDT      ┆ -1.977844    ┆ 2    ┆ 132          │
│ EGLDUSDT     ┆ -1.852434    ┆ 3    ┆ 131          │
│ DASHUSDT     ┆ -1.744349    ┆ 4    ┆ 130          │
│ ATOMUSDT     ┆ -1.717999    ┆ 5    ┆ 129          │
│ NEOUSDT      ┆ -1.697316    ┆ 6    ┆ 128          │
│ AXSUSDT      ┆ -1.667259    ┆ 7    ┆ 127          │
│ UNIUSDT      ┆ -1.641037    ┆ 8    ┆ 126          │
│ BNBUSDT      ┆ -1.628616    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BAKEUSDT     ┆ 0.16474      ┆ 125  ┆ 9            │
│ IOTXUSDT     ┆ 0.168599     ┆ 126  ┆ 8            │
│ DENTUSDT     ┆ 0.230432     ┆ 127  ┆ 7            │
│ DEFIUSDT     ┆ 0.286658     ┆ 128  ┆ 6            │
│ REEFUSDT     ┆ 0.2915       ┆ 129  ┆ 5            │
│ OGNUSDT      ┆ 0.330509     ┆ 130  ┆ 4            │
│ 1000XECUSDT  ┆ 0.398461     ┆ 131  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.610674     ┆ 132  ┆ 2            │
│ DGBUSDT      ┆ 0.664781     ┆ 133  ┆ 1            │
│ SPELLUSDT    ┆ 0.938542     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:14,683 - WARNING - 2023-03-28T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:14,683 - INFO - cur close time: 2023-03-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:14,683 - DEBUG - mean expected ret (mean factor): -0.7373835602134082
2024-11-20 23:07:14,689 - DEBUG - begin to update pos: =========
2024-11-20 23:07:14,690 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,690 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1214      ┆ null        ┆ … ┆ 0.02727 ┆ null   ┆ null    ┆ 0.2203  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,697 - DEBUG - update position: 2023-03-28T23:59:59.999 === diff_trading_value: 134811.47876670663 == cash: 110593.21343825563 
2024-11-20 23:07:14,699 - INFO - pnl: 2023-03-28T23:59:59.999 110593.21343825563 === -0.440%
2024-11-20 23:07:14,701 - DEBUG - cur time: 2023-03-29T23:59:59.999 == next bar open time: 2023-03-30T00:00:00.000 == close pos time: 2023-04-06T00:00:00.000
2024-11-20 23:07:14,703 - INFO - pnl: 2023-03-29T23:59:59.999 113261.19455658864 === 2.412%
2024-11-20 23:07:14,706 - DEBUG - cur time: 2023-03-30T23:59:59.999 == next bar open time: 2023-03-31T00:00:00.000 == close pos time: 2023-04-07T00:00:00.000
2024-11-20 23:07:14,708 - INFO - pnl: 2023-03-30T23:59:59.999 115787.48765329616 === 2.231%
2024-11-20 23:07:14,711 - DEBUG - cur time: 2023-03-31T23:59:59.999 == next bar open time: 2023-04-01T00:00:00.000 == close pos time: 2023-04-08T00:00:00.000
2024-11-20 23:07:14,713 - INFO - pnl: 2023-03-31T23:59:59.999 117299.78558681533 === 1.306%
2024-11-20 23:07:14,716 - DEBUG - cur time: 2023-04-01T23:59:59.999 == next bar open time: 2023-04-02T00:00:00.000 == close pos time: 2023-04-09T00:00:00.000
2024-11-20 23:07:14,718 - INFO - pnl: 2023-04-01T23:59:59.999 118019.87911121915 === 0.614%
2024-11-20 23:07:14,721 - DEBUG - cur time: 2023-04-02T23:59:59.999 == next bar open time: 2023-04-03T00:00:00.000 == close pos time: 2023-04-10T00:00:00.000
2024-11-20 23:07:14,725 - INFO - pnl: 2023-04-02T23:59:59.999 116419.73512018776 === -1.356%
2024-11-20 23:07:14,728 - DEBUG - cur time: 2023-04-03T23:59:59.999 == next bar open time: 2023-04-04T00:00:00.000 == close pos time: 2023-04-11T00:00:00.000
2024-11-20 23:07:14,730 - INFO - pnl: 2023-04-03T23:59:59.999 118817.6513859473 === 2.060%
2024-11-20 23:07:14,733 - DEBUG - cur time: 2023-04-04T23:59:59.999 == next bar open time: 2023-04-05T00:00:00.000 == close pos time: 2023-04-12T00:00:00.000
2024-11-20 23:07:14,741 - DEBUG - sorted_long_factors: shape: (135, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT     ┆ -2.157719    ┆ 0    ┆ 134          │
│ GTCUSDT     ┆ -1.944078    ┆ 1    ┆ 133          │
│ XMRUSDT     ┆ -1.906054    ┆ 2    ┆ 132          │
│ BNBUSDT     ┆ -1.80548     ┆ 3    ┆ 131          │
│ NEOUSDT     ┆ -1.532106    ┆ 4    ┆ 130          │
│ XRPUSDT     ┆ -1.522989    ┆ 5    ┆ 129          │
│ MTLUSDT     ┆ -1.467602    ┆ 6    ┆ 128          │
│ OMGUSDT     ┆ -1.464241    ┆ 7    ┆ 127          │
│ BALUSDT     ┆ -1.427318    ┆ 8    ┆ 126          │
│ MANAUSDT    ┆ -1.421393    ┆ 9    ┆ 125          │
│ …           ┆ …            ┆ …    ┆ …            │
│ BLZUSDT     ┆ -0.024327    ┆ 125  ┆ 9            │
│ IOTAUSDT    ┆ -0.004547    ┆ 126  ┆ 8            │
│ KSMUSDT     ┆ 0.030137     ┆ 127  ┆ 7            │
│ ENSUSDT     ┆ 0.074374     ┆ 128  ┆ 6            │
│ DGBUSDT     ┆ 0.096042     ┆ 129  ┆ 5            │
│ 1000XECUSDT ┆ 0.098969     ┆ 130  ┆ 4            │
│ FLMUSDT     ┆ 0.104096     ┆ 131  ┆ 3            │
│ CTKUSDT     ┆ 0.145379     ┆ 132  ┆ 2            │
│ TRBUSDT     ┆ 0.511732     ┆ 133  ┆ 1            │
│ DEFIUSDT    ┆ 0.775551     ┆ 134  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:14,748 - WARNING - 2023-04-04T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:14,748 - INFO - cur close time: 2023-04-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:14,749 - DEBUG - mean expected ret (mean factor): -0.7414087390455341
2024-11-20 23:07:14,753 - DEBUG - begin to update pos: =========
2024-11-20 23:07:14,754 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,754 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1235      ┆ null        ┆ … ┆ 0.02972 ┆ null   ┆ null    ┆ 0.3319  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,761 - DEBUG - update position: 2023-04-04T23:59:59.999 === diff_trading_value: 273409.62722107704 == cash: 121149.2225731697 
2024-11-20 23:07:14,763 - INFO - pnl: 2023-04-04T23:59:59.999 121149.2225731697 === 1.962%
2024-11-20 23:07:14,767 - DEBUG - cur time: 2023-04-05T23:59:59.999 == next bar open time: 2023-04-06T00:00:00.000 == close pos time: 2023-04-13T00:00:00.000
2024-11-20 23:07:14,769 - INFO - pnl: 2023-04-05T23:59:59.999 120741.2627433688 === -0.337%
2024-11-20 23:07:14,771 - DEBUG - cur time: 2023-04-06T23:59:59.999 == next bar open time: 2023-04-07T00:00:00.000 == close pos time: 2023-04-14T00:00:00.000
2024-11-20 23:07:14,774 - INFO - pnl: 2023-04-06T23:59:59.999 120429.73177996473 === -0.258%
2024-11-20 23:07:14,777 - DEBUG - cur time: 2023-04-07T23:59:59.999 == next bar open time: 2023-04-08T00:00:00.000 == close pos time: 2023-04-15T00:00:00.000
2024-11-20 23:07:14,780 - INFO - pnl: 2023-04-07T23:59:59.999 119828.23697252746 === -0.499%
2024-11-20 23:07:14,783 - DEBUG - cur time: 2023-04-08T23:59:59.999 == next bar open time: 2023-04-09T00:00:00.000 == close pos time: 2023-04-16T00:00:00.000
2024-11-20 23:07:14,784 - INFO - pnl: 2023-04-08T23:59:59.999 120029.18961065548 === 0.168%
2024-11-20 23:07:14,789 - DEBUG - cur time: 2023-04-09T23:59:59.999 == next bar open time: 2023-04-10T00:00:00.000 == close pos time: 2023-04-17T00:00:00.000
2024-11-20 23:07:14,791 - INFO - pnl: 2023-04-09T23:59:59.999 122050.20511515056 === 1.684%
2024-11-20 23:07:14,794 - DEBUG - cur time: 2023-04-10T23:59:59.999 == next bar open time: 2023-04-11T00:00:00.000 == close pos time: 2023-04-18T00:00:00.000
2024-11-20 23:07:14,796 - INFO - pnl: 2023-04-10T23:59:59.999 121747.2144177437 === -0.248%
2024-11-20 23:07:14,799 - DEBUG - cur time: 2023-04-11T23:59:59.999 == next bar open time: 2023-04-12T00:00:00.000 == close pos time: 2023-04-19T00:00:00.000
2024-11-20 23:07:14,807 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -2.166593    ┆ 0    ┆ 134          │
│ QTUMUSDT     ┆ -1.719503    ┆ 1    ┆ 133          │
│ ATOMUSDT     ┆ -1.642794    ┆ 2    ┆ 132          │
│ BNBUSDT      ┆ -1.615592    ┆ 3    ┆ 131          │
│ XMRUSDT      ┆ -1.595366    ┆ 4    ┆ 130          │
│ MKRUSDT      ┆ -1.518445    ┆ 5    ┆ 129          │
│ NEOUSDT      ┆ -1.496297    ┆ 6    ┆ 128          │
│ AXSUSDT      ┆ -1.455921    ┆ 7    ┆ 127          │
│ FOOTBALLUSDT ┆ -1.447427    ┆ 8    ┆ 126          │
│ INJUSDT      ┆ -1.412735    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ OGNUSDT      ┆ -0.050084    ┆ 125  ┆ 9            │
│ SNXUSDT      ┆ -0.030973    ┆ 126  ┆ 8            │
│ API3USDT     ┆ -0.020936    ┆ 127  ┆ 7            │
│ CVXUSDT      ┆ 0.029166     ┆ 128  ┆ 6            │
│ BLZUSDT      ┆ 0.036564     ┆ 129  ┆ 5            │
│ DGBUSDT      ┆ 0.07732      ┆ 130  ┆ 4            │
│ BALUSDT      ┆ 0.265819     ┆ 131  ┆ 3            │
│ CTKUSDT      ┆ 0.353635     ┆ 132  ┆ 2            │
│ SKLUSDT      ┆ 0.391966     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 1.510166     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:14,814 - WARNING - 2023-04-11T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:14,814 - INFO - cur close time: 2023-04-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:14,814 - DEBUG - mean expected ret (mean factor): -0.793657088690168
2024-11-20 23:07:14,818 - DEBUG - begin to update pos: =========
2024-11-20 23:07:14,819 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,819 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1254      ┆ null        ┆ … ┆ 0.02965 ┆ null   ┆ null    ┆ 0.285   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,827 - DEBUG - update position: 2023-04-11T23:59:59.999 === diff_trading_value: 255042.30134194414 == cash: 120834.78119999765 
2024-11-20 23:07:14,830 - INFO - pnl: 2023-04-11T23:59:59.999 120834.78119999765 === -0.749%
2024-11-20 23:07:14,833 - DEBUG - cur time: 2023-04-12T23:59:59.999 == next bar open time: 2023-04-13T00:00:00.000 == close pos time: 2023-04-20T00:00:00.000
2024-11-20 23:07:14,836 - INFO - pnl: 2023-04-12T23:59:59.999 121545.72526154126 === 0.588%
2024-11-20 23:07:14,843 - DEBUG - cur time: 2023-04-13T23:59:59.999 == next bar open time: 2023-04-14T00:00:00.000 == close pos time: 2023-04-21T00:00:00.000
2024-11-20 23:07:14,844 - INFO - pnl: 2023-04-13T23:59:59.999 121185.57594525654 === -0.296%
2024-11-20 23:07:14,849 - DEBUG - cur time: 2023-04-14T23:59:59.999 == next bar open time: 2023-04-15T00:00:00.000 == close pos time: 2023-04-22T00:00:00.000
2024-11-20 23:07:14,851 - INFO - pnl: 2023-04-14T23:59:59.999 119639.99819942917 === -1.275%
2024-11-20 23:07:14,856 - DEBUG - cur time: 2023-04-15T23:59:59.999 == next bar open time: 2023-04-16T00:00:00.000 == close pos time: 2023-04-23T00:00:00.000
2024-11-20 23:07:14,858 - INFO - pnl: 2023-04-15T23:59:59.999 119194.27649290688 === -0.373%
2024-11-20 23:07:14,862 - DEBUG - cur time: 2023-04-16T23:59:59.999 == next bar open time: 2023-04-17T00:00:00.000 == close pos time: 2023-04-24T00:00:00.000
2024-11-20 23:07:14,864 - INFO - pnl: 2023-04-16T23:59:59.999 118322.58131746446 === -0.731%
2024-11-20 23:07:14,869 - DEBUG - cur time: 2023-04-17T23:59:59.999 == next bar open time: 2023-04-18T00:00:00.000 == close pos time: 2023-04-25T00:00:00.000
2024-11-20 23:07:14,871 - INFO - pnl: 2023-04-17T23:59:59.999 117863.55578503612 === -0.388%
2024-11-20 23:07:14,876 - DEBUG - cur time: 2023-04-18T23:59:59.999 == next bar open time: 2023-04-19T00:00:00.000 == close pos time: 2023-04-26T00:00:00.000
2024-11-20 23:07:14,884 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT      ┆ -2.006591    ┆ 0    ┆ 134          │
│ NEOUSDT      ┆ -1.871434    ┆ 1    ┆ 133          │
│ AXSUSDT      ┆ -1.82084     ┆ 2    ┆ 132          │
│ APTUSDT      ┆ -1.71891     ┆ 3    ┆ 131          │
│ YFIUSDT      ┆ -1.718661    ┆ 4    ┆ 130          │
│ AAVEUSDT     ┆ -1.652128    ┆ 5    ┆ 129          │
│ DASHUSDT     ┆ -1.651612    ┆ 6    ┆ 128          │
│ ATOMUSDT     ┆ -1.631033    ┆ 7    ┆ 127          │
│ DYDXUSDT     ┆ -1.607094    ┆ 8    ┆ 126          │
│ ENSUSDT      ┆ -1.486398    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SKLUSDT      ┆ -0.064462    ┆ 125  ┆ 9            │
│ ALPHAUSDT    ┆ 0.072832     ┆ 126  ┆ 8            │
│ 1000XECUSDT  ┆ 0.093053     ┆ 127  ┆ 7            │
│ LPTUSDT      ┆ 0.17446      ┆ 128  ┆ 6            │
│ BLZUSDT      ┆ 0.182006     ┆ 129  ┆ 5            │
│ IOTXUSDT     ┆ 0.193319     ┆ 130  ┆ 4            │
│ BLUEBIRDUSDT ┆ 0.219351     ┆ 131  ┆ 3            │
│ DGBUSDT      ┆ 0.232174     ┆ 132  ┆ 2            │
│ CVXUSDT      ┆ 0.381459     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 1.376712     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:14,894 - WARNING - 2023-04-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:14,894 - INFO - cur close time: 2023-04-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:14,895 - DEBUG - mean expected ret (mean factor): -0.7748585836362658
2024-11-20 23:07:14,901 - DEBUG - begin to update pos: =========
2024-11-20 23:07:14,901 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,902 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.127       ┆ null        ┆ … ┆ 0.0336  ┆ null   ┆ null    ┆ 0.3051  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:14,911 - DEBUG - update position: 2023-04-18T23:59:59.999 === diff_trading_value: 206512.32821276132 == cash: 119987.76084942844 
2024-11-20 23:07:14,914 - INFO - pnl: 2023-04-18T23:59:59.999 119987.76084942844 === 1.802%
2024-11-20 23:07:14,920 - DEBUG - cur time: 2023-04-19T23:59:59.999 == next bar open time: 2023-04-20T00:00:00.000 == close pos time: 2023-04-27T00:00:00.000
2024-11-20 23:07:14,924 - INFO - pnl: 2023-04-19T23:59:59.999 120344.18143761661 === 0.297%
2024-11-20 23:07:14,931 - DEBUG - cur time: 2023-04-20T23:59:59.999 == next bar open time: 2023-04-21T00:00:00.000 == close pos time: 2023-04-28T00:00:00.000
2024-11-20 23:07:14,933 - INFO - pnl: 2023-04-20T23:59:59.999 118902.00210409671 === -1.198%
2024-11-20 23:07:14,940 - DEBUG - cur time: 2023-04-21T23:59:59.999 == next bar open time: 2023-04-22T00:00:00.000 == close pos time: 2023-04-29T00:00:00.000
2024-11-20 23:07:14,943 - INFO - pnl: 2023-04-21T23:59:59.999 118682.31853775858 === -0.185%
2024-11-20 23:07:14,951 - DEBUG - cur time: 2023-04-22T23:59:59.999 == next bar open time: 2023-04-23T00:00:00.000 == close pos time: 2023-04-30T00:00:00.000
2024-11-20 23:07:14,956 - INFO - pnl: 2023-04-22T23:59:59.999 119231.18038382674 === 0.462%
2024-11-20 23:07:14,964 - DEBUG - cur time: 2023-04-23T23:59:59.999 == next bar open time: 2023-04-24T00:00:00.000 == close pos time: 2023-05-01T00:00:00.000
2024-11-20 23:07:14,968 - INFO - pnl: 2023-04-23T23:59:59.999 118457.388004045 === -0.649%
2024-11-20 23:07:14,976 - DEBUG - cur time: 2023-04-24T23:59:59.999 == next bar open time: 2023-04-25T00:00:00.000 == close pos time: 2023-05-02T00:00:00.000
2024-11-20 23:07:14,980 - INFO - pnl: 2023-04-24T23:59:59.999 118780.57463865934 === 0.273%
2024-11-20 23:07:14,984 - DEBUG - cur time: 2023-04-25T23:59:59.999 == next bar open time: 2023-04-26T00:00:00.000 == close pos time: 2023-05-03T00:00:00.000
2024-11-20 23:07:14,996 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AXSUSDT      ┆ -1.908581    ┆ 0    ┆ 134          │
│ FILUSDT      ┆ -1.759269    ┆ 1    ┆ 133          │
│ ICPUSDT      ┆ -1.755033    ┆ 2    ┆ 132          │
│ AAVEUSDT     ┆ -1.738388    ┆ 3    ┆ 131          │
│ DOTUSDT      ┆ -1.720754    ┆ 4    ┆ 130          │
│ ATOMUSDT     ┆ -1.704634    ┆ 5    ┆ 129          │
│ NEOUSDT      ┆ -1.67243     ┆ 6    ┆ 128          │
│ UNFIUSDT     ┆ -1.662285    ┆ 7    ┆ 127          │
│ EGLDUSDT     ┆ -1.655062    ┆ 8    ┆ 126          │
│ UNIUSDT      ┆ -1.571083    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BLUEBIRDUSDT ┆ -0.143913    ┆ 125  ┆ 9            │
│ GTCUSDT      ┆ -0.13614     ┆ 126  ┆ 8            │
│ DENTUSDT     ┆ -0.122203    ┆ 127  ┆ 7            │
│ DARUSDT      ┆ -0.109925    ┆ 128  ┆ 6            │
│ BAKEUSDT     ┆ -0.080705    ┆ 129  ┆ 5            │
│ CVXUSDT      ┆ -0.071234    ┆ 130  ┆ 4            │
│ BLZUSDT      ┆ -0.021254    ┆ 131  ┆ 3            │
│ SPELLUSDT    ┆ -0.01289     ┆ 132  ┆ 2            │
│ DGBUSDT      ┆ 0.037258     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 1.182426     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:15,002 - WARNING - 2023-04-25T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:15,002 - INFO - cur close time: 2023-04-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:15,003 - DEBUG - mean expected ret (mean factor): -0.7892788436523405
2024-11-20 23:07:15,007 - DEBUG - begin to update pos: =========
2024-11-20 23:07:15,007 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,007 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1112      ┆ null        ┆ … ┆ 0.03018 ┆ null   ┆ null    ┆ 0.2628  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,016 - DEBUG - update position: 2023-04-25T23:59:59.999 === diff_trading_value: 191797.17517882612 == cash: 118862.6374184534 
2024-11-20 23:07:15,017 - INFO - pnl: 2023-04-25T23:59:59.999 118862.6374184534 === 0.069%
2024-11-20 23:07:15,021 - DEBUG - cur time: 2023-04-26T23:59:59.999 == next bar open time: 2023-04-27T00:00:00.000 == close pos time: 2023-05-04T00:00:00.000
2024-11-20 23:07:15,023 - INFO - pnl: 2023-04-26T23:59:59.999 118111.07303572337 === -0.632%
2024-11-20 23:07:15,033 - DEBUG - cur time: 2023-04-27T23:59:59.999 == next bar open time: 2023-04-28T00:00:00.000 == close pos time: 2023-05-05T00:00:00.000
2024-11-20 23:07:15,039 - INFO - pnl: 2023-04-27T23:59:59.999 117098.5120209445 === -0.857%
2024-11-20 23:07:15,048 - DEBUG - cur time: 2023-04-28T23:59:59.999 == next bar open time: 2023-04-29T00:00:00.000 == close pos time: 2023-05-06T00:00:00.000
2024-11-20 23:07:15,050 - INFO - pnl: 2023-04-28T23:59:59.999 114991.39609864005 === -1.799%
2024-11-20 23:07:15,054 - DEBUG - cur time: 2023-04-29T23:59:59.999 == next bar open time: 2023-04-30T00:00:00.000 == close pos time: 2023-05-07T00:00:00.000
2024-11-20 23:07:15,056 - INFO - pnl: 2023-04-29T23:59:59.999 114700.56537400193 === -0.253%
2024-11-20 23:07:15,060 - DEBUG - cur time: 2023-04-30T23:59:59.999 == next bar open time: 2023-05-01T00:00:00.000 == close pos time: 2023-05-08T00:00:00.000
2024-11-20 23:07:15,061 - INFO - pnl: 2023-04-30T23:59:59.999 114207.23120024252 === -0.430%
2024-11-20 23:07:15,068 - DEBUG - cur time: 2023-05-01T23:59:59.999 == next bar open time: 2023-05-02T00:00:00.000 == close pos time: 2023-05-09T00:00:00.000
2024-11-20 23:07:15,072 - INFO - pnl: 2023-05-01T23:59:59.999 114970.0448273514 === 0.668%
2024-11-20 23:07:15,083 - DEBUG - cur time: 2023-05-02T23:59:59.999 == next bar open time: 2023-05-03T00:00:00.000 == close pos time: 2023-05-10T00:00:00.000
2024-11-20 23:07:15,101 - DEBUG - sorted_long_factors: shape: (137, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT     ┆ -2.08286     ┆ 0    ┆ 136          │
│ OPUSDT      ┆ -1.786657    ┆ 1    ┆ 135          │
│ DOTUSDT     ┆ -1.664551    ┆ 2    ┆ 134          │
│ MASKUSDT    ┆ -1.500259    ┆ 3    ┆ 133          │
│ SNXUSDT     ┆ -1.47087     ┆ 4    ┆ 132          │
│ DASHUSDT    ┆ -1.457316    ┆ 5    ┆ 131          │
│ CRVUSDT     ┆ -1.442911    ┆ 6    ┆ 130          │
│ BANDUSDT    ┆ -1.430297    ┆ 7    ┆ 129          │
│ AXSUSDT     ┆ -1.414544    ┆ 8    ┆ 128          │
│ AAVEUSDT    ┆ -1.411274    ┆ 9    ┆ 127          │
│ …           ┆ …            ┆ …    ┆ …            │
│ IOTXUSDT    ┆ -0.041454    ┆ 127  ┆ 9            │
│ OGNUSDT     ┆ -0.037082    ┆ 128  ┆ 8            │
│ ONEUSDT     ┆ -0.029515    ┆ 129  ┆ 7            │
│ KSMUSDT     ┆ -0.001457    ┆ 130  ┆ 6            │
│ SPELLUSDT   ┆ 0.002906     ┆ 131  ┆ 5            │
│ 1000XECUSDT ┆ 0.067235     ┆ 132  ┆ 4            │
│ QTUMUSDT    ┆ 0.092356     ┆ 133  ┆ 3            │
│ BLZUSDT     ┆ 0.121451     ┆ 134  ┆ 2            │
│ DGBUSDT     ┆ 0.594644     ┆ 135  ┆ 1            │
│ DEFIUSDT    ┆ 0.734264     ┆ 136  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:15,119 - WARNING - 2023-05-02T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:15,120 - INFO - cur close time: 2023-05-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:15,121 - DEBUG - mean expected ret (mean factor): -0.7695301176418652
2024-11-20 23:07:15,139 - DEBUG - begin to update pos: =========
2024-11-20 23:07:15,140 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,141 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1064      ┆ null        ┆ … ┆ 0.0272  ┆ null   ┆ null    ┆ 0.2477  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,152 - DEBUG - update position: 2023-05-02T23:59:59.999 === diff_trading_value: 232748.0680373207 == cash: 116253.00964692283 
2024-11-20 23:07:15,157 - INFO - pnl: 2023-05-02T23:59:59.999 116253.00964692283 === 1.116%
2024-11-20 23:07:15,166 - DEBUG - cur time: 2023-05-03T23:59:59.999 == next bar open time: 2023-05-04T00:00:00.000 == close pos time: 2023-05-11T00:00:00.000
2024-11-20 23:07:15,173 - INFO - pnl: 2023-05-03T23:59:59.999 115563.44416575808 === -0.593%
2024-11-20 23:07:15,183 - DEBUG - cur time: 2023-05-04T23:59:59.999 == next bar open time: 2023-05-05T00:00:00.000 == close pos time: 2023-05-12T00:00:00.000
2024-11-20 23:07:15,188 - INFO - pnl: 2023-05-04T23:59:59.999 116182.18630814049 === 0.535%
2024-11-20 23:07:15,197 - DEBUG - cur time: 2023-05-05T23:59:59.999 == next bar open time: 2023-05-06T00:00:00.000 == close pos time: 2023-05-13T00:00:00.000
2024-11-20 23:07:15,200 - INFO - pnl: 2023-05-05T23:59:59.999 116035.73397945726 === -0.126%
2024-11-20 23:07:15,208 - DEBUG - cur time: 2023-05-06T23:59:59.999 == next bar open time: 2023-05-07T00:00:00.000 == close pos time: 2023-05-14T00:00:00.000
2024-11-20 23:07:15,211 - INFO - pnl: 2023-05-06T23:59:59.999 117071.87805813919 === 0.893%
2024-11-20 23:07:15,220 - DEBUG - cur time: 2023-05-07T23:59:59.999 == next bar open time: 2023-05-08T00:00:00.000 == close pos time: 2023-05-15T00:00:00.000
2024-11-20 23:07:15,223 - INFO - pnl: 2023-05-07T23:59:59.999 116468.94394146257 === -0.515%
2024-11-20 23:07:15,228 - DEBUG - cur time: 2023-05-08T23:59:59.999 == next bar open time: 2023-05-09T00:00:00.000 == close pos time: 2023-05-16T00:00:00.000
2024-11-20 23:07:15,231 - INFO - pnl: 2023-05-08T23:59:59.999 116583.76524819007 === 0.099%
2024-11-20 23:07:15,236 - DEBUG - cur time: 2023-05-09T23:59:59.999 == next bar open time: 2023-05-10T00:00:00.000 == close pos time: 2023-05-17T00:00:00.000
2024-11-20 23:07:15,248 - DEBUG - sorted_long_factors: shape: (139, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ EGLDUSDT    ┆ -1.920613    ┆ 0    ┆ 138          │
│ MTLUSDT     ┆ -1.786229    ┆ 1    ┆ 137          │
│ APTUSDT     ┆ -1.625858    ┆ 2    ┆ 136          │
│ ICPUSDT     ┆ -1.61923     ┆ 3    ┆ 135          │
│ OMGUSDT     ┆ -1.424757    ┆ 4    ┆ 134          │
│ WAVESUSDT   ┆ -1.424236    ┆ 5    ┆ 133          │
│ CRVUSDT     ┆ -1.420914    ┆ 6    ┆ 132          │
│ FTMUSDT     ┆ -1.419742    ┆ 7    ┆ 131          │
│ MAGICUSDT   ┆ -1.394847    ┆ 8    ┆ 130          │
│ STGUSDT     ┆ -1.384854    ┆ 9    ┆ 129          │
│ …           ┆ …            ┆ …    ┆ …            │
│ BATUSDT     ┆ -0.204925    ┆ 129  ┆ 9            │
│ ONEUSDT     ┆ -0.203025    ┆ 130  ┆ 8            │
│ OGNUSDT     ┆ -0.097795    ┆ 131  ┆ 7            │
│ SKLUSDT     ┆ 0.016746     ┆ 132  ┆ 6            │
│ DGBUSDT     ┆ 0.04965      ┆ 133  ┆ 5            │
│ 1000XECUSDT ┆ 0.060259     ┆ 134  ┆ 4            │
│ BLZUSDT     ┆ 0.06335      ┆ 135  ┆ 3            │
│ BAKEUSDT    ┆ 0.148244     ┆ 136  ┆ 2            │
│ CVXUSDT     ┆ 0.659192     ┆ 137  ┆ 1            │
│ DEFIUSDT    ┆ 0.686254     ┆ 138  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:15,257 - WARNING - 2023-05-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:15,258 - INFO - cur close time: 2023-05-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:15,258 - DEBUG - mean expected ret (mean factor): -0.7802301842879672
2024-11-20 23:07:15,266 - DEBUG - begin to update pos: =========
2024-11-20 23:07:15,267 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,268 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0891      ┆ null        ┆ … ┆ 0.02394 ┆ null   ┆ null    ┆ 0.2192  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,278 - DEBUG - update position: 2023-05-09T23:59:59.999 === diff_trading_value: 244727.5177409906 == cash: 117002.60307763812 
2024-11-20 23:07:15,279 - INFO - pnl: 2023-05-09T23:59:59.999 117002.60307763812 === 0.359%
2024-11-20 23:07:15,283 - DEBUG - cur time: 2023-05-10T23:59:59.999 == next bar open time: 2023-05-11T00:00:00.000 == close pos time: 2023-05-18T00:00:00.000
2024-11-20 23:07:15,286 - INFO - pnl: 2023-05-10T23:59:59.999 116996.75390756877 === -0.005%
2024-11-20 23:07:15,291 - DEBUG - cur time: 2023-05-11T23:59:59.999 == next bar open time: 2023-05-12T00:00:00.000 == close pos time: 2023-05-19T00:00:00.000
2024-11-20 23:07:15,293 - INFO - pnl: 2023-05-11T23:59:59.999 117526.67867178345 === 0.453%
2024-11-20 23:07:15,297 - DEBUG - cur time: 2023-05-12T23:59:59.999 == next bar open time: 2023-05-13T00:00:00.000 == close pos time: 2023-05-20T00:00:00.000
2024-11-20 23:07:15,300 - INFO - pnl: 2023-05-12T23:59:59.999 118218.95806127093 === 0.589%
2024-11-20 23:07:15,305 - DEBUG - cur time: 2023-05-13T23:59:59.999 == next bar open time: 2023-05-14T00:00:00.000 == close pos time: 2023-05-21T00:00:00.000
2024-11-20 23:07:15,308 - INFO - pnl: 2023-05-13T23:59:59.999 118253.47535012773 === 0.029%
2024-11-20 23:07:15,311 - DEBUG - cur time: 2023-05-14T23:59:59.999 == next bar open time: 2023-05-15T00:00:00.000 == close pos time: 2023-05-22T00:00:00.000
2024-11-20 23:07:15,314 - INFO - pnl: 2023-05-14T23:59:59.999 117595.8980199247 === -0.556%
2024-11-20 23:07:15,319 - DEBUG - cur time: 2023-05-15T23:59:59.999 == next bar open time: 2023-05-16T00:00:00.000 == close pos time: 2023-05-23T00:00:00.000
2024-11-20 23:07:15,319 - INFO - pnl: 2023-05-15T23:59:59.999 117868.13598126474 === 0.232%
2024-11-20 23:07:15,324 - DEBUG - cur time: 2023-05-16T23:59:59.999 == next bar open time: 2023-05-17T00:00:00.000 == close pos time: 2023-05-24T00:00:00.000
2024-11-20 23:07:15,333 - DEBUG - sorted_long_factors: shape: (141, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ZECUSDT      ┆ -1.980329    ┆ 0    ┆ 140          │
│ RLCUSDT      ┆ -1.885609    ┆ 1    ┆ 139          │
│ MTLUSDT      ┆ -1.763941    ┆ 2    ┆ 138          │
│ NEOUSDT      ┆ -1.661296    ┆ 3    ┆ 137          │
│ RNDRUSDT     ┆ -1.651804    ┆ 4    ┆ 136          │
│ BELUSDT      ┆ -1.598556    ┆ 5    ┆ 135          │
│ AAVEUSDT     ┆ -1.542098    ┆ 6    ┆ 134          │
│ MAGICUSDT    ┆ -1.511244    ┆ 7    ┆ 133          │
│ FETUSDT      ┆ -1.490448    ┆ 8    ┆ 132          │
│ LDOUSDT      ┆ -1.47019     ┆ 9    ┆ 131          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DGBUSDT      ┆ 0.111807     ┆ 131  ┆ 9            │
│ 1000XECUSDT  ┆ 0.14124      ┆ 132  ┆ 8            │
│ BLZUSDT      ┆ 0.149247     ┆ 133  ┆ 7            │
│ KLAYUSDT     ┆ 0.149672     ┆ 134  ┆ 6            │
│ DUSKUSDT     ┆ 0.176898     ┆ 135  ┆ 5            │
│ BAKEUSDT     ┆ 0.232167     ┆ 136  ┆ 4            │
│ DARUSDT      ┆ 0.246106     ┆ 137  ┆ 3            │
│ FOOTBALLUSDT ┆ 0.348025     ┆ 138  ┆ 2            │
│ LPTUSDT      ┆ 0.375824     ┆ 139  ┆ 1            │
│ CVXUSDT      ┆ 0.461168     ┆ 140  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:15,340 - INFO - cur close time: 2023-05-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:15,340 - DEBUG - mean expected ret (mean factor): -0.7742909222116964
2024-11-20 23:07:15,346 - DEBUG - begin to update pos: =========
2024-11-20 23:07:15,346 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,346 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0911      ┆ null        ┆ … ┆ 0.02421 ┆ null   ┆ null    ┆ 0.2292  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,353 - DEBUG - update position: 2023-05-16T23:59:59.999 === diff_trading_value: 232479.8931429288 == cash: 118356.24196597512 
2024-11-20 23:07:15,355 - INFO - pnl: 2023-05-16T23:59:59.999 118356.24196597512 === 0.414%
2024-11-20 23:07:15,359 - DEBUG - cur time: 2023-05-17T23:59:59.999 == next bar open time: 2023-05-18T00:00:00.000 == close pos time: 2023-05-25T00:00:00.000
2024-11-20 23:07:15,360 - INFO - pnl: 2023-05-17T23:59:59.999 115531.8554464716 === -2.386%
2024-11-20 23:07:15,364 - DEBUG - cur time: 2023-05-18T23:59:59.999 == next bar open time: 2023-05-19T00:00:00.000 == close pos time: 2023-05-26T00:00:00.000
2024-11-20 23:07:15,366 - INFO - pnl: 2023-05-18T23:59:59.999 115452.50348504185 === -0.069%
2024-11-20 23:07:15,370 - DEBUG - cur time: 2023-05-19T23:59:59.999 == next bar open time: 2023-05-20T00:00:00.000 == close pos time: 2023-05-27T00:00:00.000
2024-11-20 23:07:15,373 - INFO - pnl: 2023-05-19T23:59:59.999 115351.81980655514 === -0.087%
2024-11-20 23:07:15,376 - DEBUG - cur time: 2023-05-20T23:59:59.999 == next bar open time: 2023-05-21T00:00:00.000 == close pos time: 2023-05-28T00:00:00.000
2024-11-20 23:07:15,378 - INFO - pnl: 2023-05-20T23:59:59.999 115826.8917929261 === 0.412%
2024-11-20 23:07:15,382 - DEBUG - cur time: 2023-05-21T23:59:59.999 == next bar open time: 2023-05-22T00:00:00.000 == close pos time: 2023-05-29T00:00:00.000
2024-11-20 23:07:15,384 - INFO - pnl: 2023-05-21T23:59:59.999 115191.81503623197 === -0.548%
2024-11-20 23:07:15,387 - DEBUG - cur time: 2023-05-22T23:59:59.999 == next bar open time: 2023-05-23T00:00:00.000 == close pos time: 2023-05-30T00:00:00.000
2024-11-20 23:07:15,389 - INFO - pnl: 2023-05-22T23:59:59.999 114989.69720298758 === -0.175%
2024-11-20 23:07:15,393 - DEBUG - cur time: 2023-05-23T23:59:59.999 == next bar open time: 2023-05-24T00:00:00.000 == close pos time: 2023-05-31T00:00:00.000
2024-11-20 23:07:15,403 - DEBUG - sorted_long_factors: shape: (143, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT   ┆ -1.916275    ┆ 0    ┆ 142          │
│ INJUSDT   ┆ -1.846691    ┆ 1    ┆ 141          │
│ AXSUSDT   ┆ -1.678125    ┆ 2    ┆ 140          │
│ KAVAUSDT  ┆ -1.651787    ┆ 3    ┆ 139          │
│ RNDRUSDT  ┆ -1.633361    ┆ 4    ┆ 138          │
│ ATOMUSDT  ┆ -1.536704    ┆ 5    ┆ 137          │
│ HOOKUSDT  ┆ -1.532225    ┆ 6    ┆ 136          │
│ RLCUSDT   ┆ -1.522807    ┆ 7    ┆ 135          │
│ FETUSDT   ┆ -1.516125    ┆ 8    ┆ 134          │
│ APTUSDT   ┆ -1.495914    ┆ 9    ┆ 133          │
│ …         ┆ …            ┆ …    ┆ …            │
│ BAKEUSDT  ┆ -0.045624    ┆ 133  ┆ 9            │
│ CVXUSDT   ┆ 0.067056     ┆ 134  ┆ 8            │
│ SKLUSDT   ┆ 0.147363     ┆ 135  ┆ 7            │
│ SPELLUSDT ┆ 0.168381     ┆ 136  ┆ 6            │
│ RVNUSDT   ┆ 0.191482     ┆ 137  ┆ 5            │
│ ATAUSDT   ┆ 0.247678     ┆ 138  ┆ 4            │
│ IOTXUSDT  ┆ 0.29843      ┆ 139  ┆ 3            │
│ API3USDT  ┆ 0.308956     ┆ 140  ┆ 2            │
│ BLZUSDT   ┆ 0.34738      ┆ 141  ┆ 1            │
│ LPTUSDT   ┆ 0.481125     ┆ 142  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:15,409 - WARNING - 2023-05-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:15,409 - INFO - cur close time: 2023-05-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:15,410 - DEBUG - mean expected ret (mean factor): -0.7860665232243591
2024-11-20 23:07:15,415 - DEBUG - begin to update pos: =========
2024-11-20 23:07:15,415 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,416 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0902      ┆ null        ┆ … ┆ 0.02361 ┆ null   ┆ null    ┆ 0.2268  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,424 - DEBUG - update position: 2023-05-23T23:59:59.999 === diff_trading_value: 208995.90676416853 == cash: 113090.36185006934 
2024-11-20 23:07:15,425 - INFO - pnl: 2023-05-23T23:59:59.999 113090.36185006934 === -1.652%
2024-11-20 23:07:15,429 - DEBUG - cur time: 2023-05-24T23:59:59.999 == next bar open time: 2023-05-25T00:00:00.000 == close pos time: 2023-06-01T00:00:00.000
2024-11-20 23:07:15,431 - INFO - pnl: 2023-05-24T23:59:59.999 113906.78478344453 === 0.722%
2024-11-20 23:07:15,435 - DEBUG - cur time: 2023-05-25T23:59:59.999 == next bar open time: 2023-05-26T00:00:00.000 == close pos time: 2023-06-02T00:00:00.000
2024-11-20 23:07:15,437 - INFO - pnl: 2023-05-25T23:59:59.999 113582.66391655205 === -0.285%
2024-11-20 23:07:15,443 - DEBUG - cur time: 2023-05-26T23:59:59.999 == next bar open time: 2023-05-27T00:00:00.000 == close pos time: 2023-06-03T00:00:00.000
2024-11-20 23:07:15,445 - INFO - pnl: 2023-05-26T23:59:59.999 112903.24793404115 === -0.598%
2024-11-20 23:07:15,450 - DEBUG - cur time: 2023-05-27T23:59:59.999 == next bar open time: 2023-05-28T00:00:00.000 == close pos time: 2023-06-04T00:00:00.000
2024-11-20 23:07:15,451 - INFO - pnl: 2023-05-27T23:59:59.999 112657.95681703689 === -0.217%
2024-11-20 23:07:15,454 - DEBUG - cur time: 2023-05-28T23:59:59.999 == next bar open time: 2023-05-29T00:00:00.000 == close pos time: 2023-06-05T00:00:00.000
2024-11-20 23:07:15,457 - INFO - pnl: 2023-05-28T23:59:59.999 111554.39499685066 === -0.980%
2024-11-20 23:07:15,461 - DEBUG - cur time: 2023-05-29T23:59:59.999 == next bar open time: 2023-05-30T00:00:00.000 == close pos time: 2023-06-06T00:00:00.000
2024-11-20 23:07:15,466 - INFO - pnl: 2023-05-29T23:59:59.999 111537.10336517397 === -0.016%
2024-11-20 23:07:15,475 - DEBUG - cur time: 2023-05-30T23:59:59.999 == next bar open time: 2023-05-31T00:00:00.000 == close pos time: 2023-06-07T00:00:00.000
2024-11-20 23:07:15,486 - DEBUG - sorted_long_factors: shape: (147, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ INJUSDT      ┆ -2.045235    ┆ 0    ┆ 146          │
│ MAGICUSDT    ┆ -1.62521     ┆ 1    ┆ 145          │
│ RLCUSDT      ┆ -1.599107    ┆ 2    ┆ 144          │
│ RNDRUSDT     ┆ -1.589653    ┆ 3    ┆ 143          │
│ TOMOUSDT     ┆ -1.578993    ┆ 4    ┆ 142          │
│ FILUSDT      ┆ -1.518221    ┆ 5    ┆ 141          │
│ FETUSDT      ┆ -1.444987    ┆ 6    ┆ 140          │
│ HOOKUSDT     ┆ -1.444503    ┆ 7    ┆ 139          │
│ FXSUSDT      ┆ -1.386883    ┆ 8    ┆ 138          │
│ CTSIUSDT     ┆ -1.381856    ┆ 9    ┆ 137          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ATAUSDT      ┆ -0.12703     ┆ 137  ┆ 9            │
│ AAVEUSDT     ┆ -0.098395    ┆ 138  ┆ 8            │
│ IOTXUSDT     ┆ -0.045198    ┆ 139  ┆ 7            │
│ 1000XECUSDT  ┆ -0.00147     ┆ 140  ┆ 6            │
│ ONEUSDT      ┆ -0.000153    ┆ 141  ┆ 5            │
│ RVNUSDT      ┆ 0.048569     ┆ 142  ┆ 4            │
│ SPELLUSDT    ┆ 0.082854     ┆ 143  ┆ 3            │
│ CVXUSDT      ┆ 0.355532     ┆ 144  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.914359     ┆ 145  ┆ 1            │
│ DEFIUSDT     ┆ 0.939097     ┆ 146  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:15,499 - WARNING - 2023-05-30T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:15,499 - INFO - cur close time: 2023-05-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:15,499 - DEBUG - mean expected ret (mean factor): -0.7789158741650378
2024-11-20 23:07:15,507 - DEBUG - begin to update pos: =========
2024-11-20 23:07:15,507 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,507 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0865      ┆ null        ┆ … ┆ 0.02364 ┆ null   ┆ null    ┆ 0.2299  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,515 - DEBUG - update position: 2023-05-30T23:59:59.999 === diff_trading_value: 175008.71112365258 == cash: 111885.4191773728 
2024-11-20 23:07:15,517 - INFO - pnl: 2023-05-30T23:59:59.999 111885.4191773728 === 0.312%
2024-11-20 23:07:15,520 - DEBUG - cur time: 2023-05-31T23:59:59.999 == next bar open time: 2023-06-01T00:00:00.000 == close pos time: 2023-06-08T00:00:00.000
2024-11-20 23:07:15,521 - INFO - pnl: 2023-05-31T23:59:59.999 113032.5217399216 === 1.025%
2024-11-20 23:07:15,526 - DEBUG - cur time: 2023-06-01T23:59:59.999 == next bar open time: 2023-06-02T00:00:00.000 == close pos time: 2023-06-09T00:00:00.000
2024-11-20 23:07:15,528 - INFO - pnl: 2023-06-01T23:59:59.999 113049.30761920274 === 0.015%
2024-11-20 23:07:15,532 - DEBUG - cur time: 2023-06-02T23:59:59.999 == next bar open time: 2023-06-03T00:00:00.000 == close pos time: 2023-06-10T00:00:00.000
2024-11-20 23:07:15,534 - INFO - pnl: 2023-06-02T23:59:59.999 111323.136380218 === -1.527%
2024-11-20 23:07:15,539 - DEBUG - cur time: 2023-06-03T23:59:59.999 == next bar open time: 2023-06-04T00:00:00.000 == close pos time: 2023-06-11T00:00:00.000
2024-11-20 23:07:15,541 - INFO - pnl: 2023-06-03T23:59:59.999 111966.78190190761 === 0.578%
2024-11-20 23:07:15,546 - DEBUG - cur time: 2023-06-04T23:59:59.999 == next bar open time: 2023-06-05T00:00:00.000 == close pos time: 2023-06-12T00:00:00.000
2024-11-20 23:07:15,549 - INFO - pnl: 2023-06-04T23:59:59.999 112526.52054849634 === 0.500%
2024-11-20 23:07:15,555 - DEBUG - cur time: 2023-06-05T23:59:59.999 == next bar open time: 2023-06-06T00:00:00.000 == close pos time: 2023-06-13T00:00:00.000
2024-11-20 23:07:15,557 - INFO - pnl: 2023-06-05T23:59:59.999 114038.11609267374 === 1.343%
2024-11-20 23:07:15,565 - DEBUG - cur time: 2023-06-06T23:59:59.999 == next bar open time: 2023-06-07T00:00:00.000 == close pos time: 2023-06-14T00:00:00.000
2024-11-20 23:07:15,580 - DEBUG - sorted_long_factors: shape: (152, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MKRUSDT      ┆ -2.187029    ┆ 0    ┆ 151          │
│ APTUSDT      ┆ -1.752969    ┆ 1    ┆ 150          │
│ AGIXUSDT     ┆ -1.693699    ┆ 2    ┆ 149          │
│ PHBUSDT      ┆ -1.645276    ┆ 3    ┆ 148          │
│ KSMUSDT      ┆ -1.629289    ┆ 4    ┆ 147          │
│ SXPUSDT      ┆ -1.502231    ┆ 5    ┆ 146          │
│ HIGHUSDT     ┆ -1.491873    ┆ 6    ┆ 145          │
│ BELUSDT      ┆ -1.482404    ┆ 7    ┆ 144          │
│ FETUSDT      ┆ -1.470057    ┆ 8    ┆ 143          │
│ RNDRUSDT     ┆ -1.467137    ┆ 9    ┆ 142          │
│ …            ┆ …            ┆ …    ┆ …            │
│ LPTUSDT      ┆ -0.091031    ┆ 142  ┆ 9            │
│ LRCUSDT      ┆ -0.081225    ┆ 143  ┆ 8            │
│ SKLUSDT      ┆ -0.060843    ┆ 144  ┆ 7            │
│ BAKEUSDT     ┆ -0.040787    ┆ 145  ┆ 6            │
│ ATAUSDT      ┆ 0.065171     ┆ 146  ┆ 5            │
│ 1000XECUSDT  ┆ 0.130126     ┆ 147  ┆ 4            │
│ ZENUSDT      ┆ 0.216203     ┆ 148  ┆ 3            │
│ CVXUSDT      ┆ 0.452903     ┆ 149  ┆ 2            │
│ DEFIUSDT     ┆ 1.167909     ┆ 150  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.37902      ┆ 151  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:15,594 - WARNING - 2023-06-06T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:15,594 - INFO - cur close time: 2023-06-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:15,594 - DEBUG - mean expected ret (mean factor): -0.805757543460269
2024-11-20 23:07:15,602 - DEBUG - begin to update pos: =========
2024-11-20 23:07:15,603 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,603 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09813     ┆ null        ┆ … ┆ 0.0219  ┆ null   ┆ null    ┆ 0.2095  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,611 - DEBUG - update position: 2023-06-06T23:59:59.999 === diff_trading_value: 256733.77761251442 == cash: 112571.56607021143 
2024-11-20 23:07:15,614 - INFO - pnl: 2023-06-06T23:59:59.999 112571.56607021143 === -1.286%
2024-11-20 23:07:15,617 - DEBUG - cur time: 2023-06-07T23:59:59.999 == next bar open time: 2023-06-08T00:00:00.000 == close pos time: 2023-06-15T00:00:00.000
2024-11-20 23:07:15,619 - INFO - pnl: 2023-06-07T23:59:59.999 113416.34186306376 === 0.750%
2024-11-20 23:07:15,625 - DEBUG - cur time: 2023-06-08T23:59:59.999 == next bar open time: 2023-06-09T00:00:00.000 == close pos time: 2023-06-16T00:00:00.000
2024-11-20 23:07:15,627 - INFO - pnl: 2023-06-08T23:59:59.999 113616.81695802101 === 0.177%
2024-11-20 23:07:15,633 - DEBUG - cur time: 2023-06-09T23:59:59.999 == next bar open time: 2023-06-10T00:00:00.000 == close pos time: 2023-06-17T00:00:00.000
2024-11-20 23:07:15,635 - INFO - pnl: 2023-06-09T23:59:59.999 114346.15042657309 === 0.642%
2024-11-20 23:07:15,641 - DEBUG - cur time: 2023-06-10T23:59:59.999 == next bar open time: 2023-06-11T00:00:00.000 == close pos time: 2023-06-18T00:00:00.000
2024-11-20 23:07:15,644 - INFO - pnl: 2023-06-10T23:59:59.999 114489.16927290059 === 0.125%
2024-11-20 23:07:15,648 - DEBUG - cur time: 2023-06-11T23:59:59.999 == next bar open time: 2023-06-12T00:00:00.000 == close pos time: 2023-06-19T00:00:00.000
2024-11-20 23:07:15,650 - INFO - pnl: 2023-06-11T23:59:59.999 114279.44947587796 === -0.183%
2024-11-20 23:07:15,656 - DEBUG - cur time: 2023-06-12T23:59:59.999 == next bar open time: 2023-06-13T00:00:00.000 == close pos time: 2023-06-20T00:00:00.000
2024-11-20 23:07:15,659 - INFO - pnl: 2023-06-12T23:59:59.999 114475.52670790751 === 0.172%
2024-11-20 23:07:15,663 - DEBUG - cur time: 2023-06-13T23:59:59.999 == next bar open time: 2023-06-14T00:00:00.000 == close pos time: 2023-06-21T00:00:00.000
2024-11-20 23:07:15,678 - DEBUG - sorted_long_factors: shape: (153, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HIGHUSDT     ┆ -2.054288    ┆ 0    ┆ 152          │
│ KAVAUSDT     ┆ -1.806966    ┆ 1    ┆ 151          │
│ RNDRUSDT     ┆ -1.804421    ┆ 2    ┆ 150          │
│ SSVUSDT      ┆ -1.718258    ┆ 3    ┆ 149          │
│ DYDXUSDT     ┆ -1.65799     ┆ 4    ┆ 148          │
│ LUNA2USDT    ┆ -1.656892    ┆ 5    ┆ 147          │
│ WAVESUSDT    ┆ -1.609113    ┆ 6    ┆ 146          │
│ MTLUSDT      ┆ -1.582621    ┆ 7    ┆ 145          │
│ SUSHIUSDT    ┆ -1.497795    ┆ 8    ┆ 144          │
│ STXUSDT      ┆ -1.475134    ┆ 9    ┆ 143          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COMPUSDT     ┆ -0.053089    ┆ 143  ┆ 9            │
│ FLMUSDT      ┆ -0.051887    ┆ 144  ┆ 8            │
│ QNTUSDT      ┆ -0.033933    ┆ 145  ┆ 7            │
│ 1000XECUSDT  ┆ -0.017486    ┆ 146  ┆ 6            │
│ API3USDT     ┆ -0.002379    ┆ 147  ┆ 5            │
│ FOOTBALLUSDT ┆ 0.017025     ┆ 148  ┆ 4            │
│ ATAUSDT      ┆ 0.135365     ┆ 149  ┆ 3            │
│ CVXUSDT      ┆ 0.157085     ┆ 150  ┆ 2            │
│ DEFIUSDT     ┆ 0.682699     ┆ 151  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.789881     ┆ 152  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:15,691 - WARNING - 2023-06-13T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:15,692 - INFO - cur close time: 2023-06-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:15,692 - DEBUG - mean expected ret (mean factor): -0.8054429872617505
2024-11-20 23:07:15,698 - DEBUG - begin to update pos: =========
2024-11-20 23:07:15,699 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,699 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09459     ┆ null        ┆ … ┆ 0.0175  ┆ null   ┆ null    ┆ 0.1744  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,711 - DEBUG - update position: 2023-06-13T23:59:59.999 === diff_trading_value: 257162.79667790222 == cash: 114945.94017167104 
2024-11-20 23:07:15,713 - INFO - pnl: 2023-06-13T23:59:59.999 114945.94017167104 === 0.411%
2024-11-20 23:07:15,718 - DEBUG - cur time: 2023-06-14T23:59:59.999 == next bar open time: 2023-06-15T00:00:00.000 == close pos time: 2023-06-22T00:00:00.000
2024-11-20 23:07:15,720 - INFO - pnl: 2023-06-14T23:59:59.999 114363.34645021644 === -0.507%
2024-11-20 23:07:15,726 - DEBUG - cur time: 2023-06-15T23:59:59.999 == next bar open time: 2023-06-16T00:00:00.000 == close pos time: 2023-06-23T00:00:00.000
2024-11-20 23:07:15,728 - INFO - pnl: 2023-06-15T23:59:59.999 113258.7048807443 === -0.966%
2024-11-20 23:07:15,735 - DEBUG - cur time: 2023-06-16T23:59:59.999 == next bar open time: 2023-06-17T00:00:00.000 == close pos time: 2023-06-24T00:00:00.000
2024-11-20 23:07:15,737 - INFO - pnl: 2023-06-16T23:59:59.999 111362.15595074612 === -1.675%
2024-11-20 23:07:15,742 - DEBUG - cur time: 2023-06-17T23:59:59.999 == next bar open time: 2023-06-18T00:00:00.000 == close pos time: 2023-06-25T00:00:00.000
2024-11-20 23:07:15,746 - INFO - pnl: 2023-06-17T23:59:59.999 111005.14471868925 === -0.321%
2024-11-20 23:07:15,752 - DEBUG - cur time: 2023-06-18T23:59:59.999 == next bar open time: 2023-06-19T00:00:00.000 == close pos time: 2023-06-26T00:00:00.000
2024-11-20 23:07:15,754 - INFO - pnl: 2023-06-18T23:59:59.999 111684.880506265 === 0.612%
2024-11-20 23:07:15,759 - DEBUG - cur time: 2023-06-19T23:59:59.999 == next bar open time: 2023-06-20T00:00:00.000 == close pos time: 2023-06-27T00:00:00.000
2024-11-20 23:07:15,763 - INFO - pnl: 2023-06-19T23:59:59.999 110952.61250245979 === -0.656%
2024-11-20 23:07:15,767 - DEBUG - cur time: 2023-06-20T23:59:59.999 == next bar open time: 2023-06-21T00:00:00.000 == close pos time: 2023-06-28T00:00:00.000
2024-11-20 23:07:15,778 - DEBUG - sorted_long_factors: shape: (156, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ FXSUSDT     ┆ -1.615973    ┆ 0    ┆ 155          │
│ MAGICUSDT   ┆ -1.605031    ┆ 1    ┆ 154          │
│ RNDRUSDT    ┆ -1.591018    ┆ 2    ┆ 153          │
│ XTZUSDT     ┆ -1.587892    ┆ 3    ┆ 152          │
│ KAVAUSDT    ┆ -1.570266    ┆ 4    ┆ 151          │
│ OPUSDT      ┆ -1.562716    ┆ 5    ┆ 150          │
│ SSVUSDT     ┆ -1.535885    ┆ 6    ┆ 149          │
│ APTUSDT     ┆ -1.515617    ┆ 7    ┆ 148          │
│ HOOKUSDT    ┆ -1.511598    ┆ 8    ┆ 147          │
│ CFXUSDT     ┆ -1.511331    ┆ 9    ┆ 146          │
│ …           ┆ …            ┆ …    ┆ …            │
│ PERPUSDT    ┆ -0.052495    ┆ 146  ┆ 9            │
│ BLZUSDT     ┆ -0.040119    ┆ 147  ┆ 8            │
│ BAKEUSDT    ┆ 0.049645     ┆ 148  ┆ 7            │
│ ENSUSDT     ┆ 0.089185     ┆ 149  ┆ 6            │
│ 1000XECUSDT ┆ 0.207982     ┆ 150  ┆ 5            │
│ DGBUSDT     ┆ 0.226562     ┆ 151  ┆ 4            │
│ ATAUSDT     ┆ 0.232766     ┆ 152  ┆ 3            │
│ KSMUSDT     ┆ 0.261698     ┆ 153  ┆ 2            │
│ DEFIUSDT    ┆ 0.493513     ┆ 154  ┆ 1            │
│ CVXUSDT     ┆ 1.081735     ┆ 155  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:15,786 - WARNING - 2023-06-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:15,786 - INFO - cur close time: 2023-06-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:15,786 - DEBUG - mean expected ret (mean factor): -0.8052069306373627
2024-11-20 23:07:15,793 - DEBUG - begin to update pos: =========
2024-11-20 23:07:15,793 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,794 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09125     ┆ null        ┆ … ┆ 0.01823 ┆ null   ┆ null    ┆ 0.184   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,802 - DEBUG - update position: 2023-06-20T23:59:59.999 === diff_trading_value: 275493.3715392578 == cash: 108577.35818521473 
2024-11-20 23:07:15,803 - INFO - pnl: 2023-06-20T23:59:59.999 108577.35818521473 === -2.141%
2024-11-20 23:07:15,807 - DEBUG - cur time: 2023-06-21T23:59:59.999 == next bar open time: 2023-06-22T00:00:00.000 == close pos time: 2023-06-29T00:00:00.000
2024-11-20 23:07:15,809 - INFO - pnl: 2023-06-21T23:59:59.999 107281.37048585249 === -1.194%
2024-11-20 23:07:15,815 - DEBUG - cur time: 2023-06-22T23:59:59.999 == next bar open time: 2023-06-23T00:00:00.000 == close pos time: 2023-06-30T00:00:00.000
2024-11-20 23:07:15,817 - INFO - pnl: 2023-06-22T23:59:59.999 108693.19766931838 === 1.316%
2024-11-20 23:07:15,820 - DEBUG - cur time: 2023-06-23T23:59:59.999 == next bar open time: 2023-06-24T00:00:00.000 == close pos time: 2023-07-01T00:00:00.000
2024-11-20 23:07:15,822 - INFO - pnl: 2023-06-23T23:59:59.999 110695.64285085158 === 1.842%
2024-11-20 23:07:15,825 - DEBUG - cur time: 2023-06-24T23:59:59.999 == next bar open time: 2023-06-25T00:00:00.000 == close pos time: 2023-07-02T00:00:00.000
2024-11-20 23:07:15,827 - INFO - pnl: 2023-06-24T23:59:59.999 113239.34636010966 === 2.298%
2024-11-20 23:07:15,833 - DEBUG - cur time: 2023-06-25T23:59:59.999 == next bar open time: 2023-06-26T00:00:00.000 == close pos time: 2023-07-03T00:00:00.000
2024-11-20 23:07:15,835 - INFO - pnl: 2023-06-25T23:59:59.999 112019.86413566249 === -1.077%
2024-11-20 23:07:15,841 - DEBUG - cur time: 2023-06-26T23:59:59.999 == next bar open time: 2023-06-27T00:00:00.000 == close pos time: 2023-07-04T00:00:00.000
2024-11-20 23:07:15,844 - INFO - pnl: 2023-06-26T23:59:59.999 111701.68438619518 === -0.284%
2024-11-20 23:07:15,849 - DEBUG - cur time: 2023-06-27T23:59:59.999 == next bar open time: 2023-06-28T00:00:00.000 == close pos time: 2023-07-05T00:00:00.000
2024-11-20 23:07:15,858 - DEBUG - sorted_long_factors: shape: (157, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT      ┆ -2.002059    ┆ 0    ┆ 156          │
│ MASKUSDT     ┆ -1.956043    ┆ 1    ┆ 155          │
│ FILUSDT      ┆ -1.774818    ┆ 2    ┆ 154          │
│ RNDRUSDT     ┆ -1.764606    ┆ 3    ┆ 153          │
│ XRPUSDT      ┆ -1.615659    ┆ 4    ┆ 152          │
│ MAGICUSDT    ┆ -1.591043    ┆ 5    ┆ 151          │
│ AGIXUSDT     ┆ -1.55151     ┆ 6    ┆ 150          │
│ AXSUSDT      ┆ -1.542254    ┆ 7    ┆ 149          │
│ XMRUSDT      ┆ -1.515346    ┆ 8    ┆ 148          │
│ AAVEUSDT     ┆ -1.511138    ┆ 9    ┆ 147          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ATAUSDT      ┆ 0.000673     ┆ 147  ┆ 9            │
│ IOTXUSDT     ┆ 0.005378     ┆ 148  ┆ 8            │
│ 1000XECUSDT  ┆ 0.020384     ┆ 149  ┆ 7            │
│ REEFUSDT     ┆ 0.056605     ┆ 150  ┆ 6            │
│ DGBUSDT      ┆ 0.11535      ┆ 151  ┆ 5            │
│ IOSTUSDT     ┆ 0.12575      ┆ 152  ┆ 4            │
│ DEFIUSDT     ┆ 0.198403     ┆ 153  ┆ 3            │
│ CTKUSDT      ┆ 0.276469     ┆ 154  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.409337     ┆ 155  ┆ 1            │
│ DARUSDT      ┆ 0.436715     ┆ 156  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:15,866 - WARNING - 2023-06-27T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:15,866 - INFO - cur close time: 2023-06-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:15,866 - DEBUG - mean expected ret (mean factor): -0.813532892936003
2024-11-20 23:07:15,872 - DEBUG - begin to update pos: =========
2024-11-20 23:07:15,872 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,873 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09142     ┆ null        ┆ … ┆ 0.02054 ┆ null   ┆ null    ┆ 0.2174  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,880 - DEBUG - update position: 2023-06-27T23:59:59.999 === diff_trading_value: 264807.8686288108 == cash: 113312.37879009805 
2024-11-20 23:07:15,881 - INFO - pnl: 2023-06-27T23:59:59.999 113312.37879009805 === 1.442%
2024-11-20 23:07:15,884 - DEBUG - cur time: 2023-06-28T23:59:59.999 == next bar open time: 2023-06-29T00:00:00.000 == close pos time: 2023-07-06T00:00:00.000
2024-11-20 23:07:15,886 - INFO - pnl: 2023-06-28T23:59:59.999 112676.31676155386 === -0.561%
2024-11-20 23:07:15,891 - DEBUG - cur time: 2023-06-29T23:59:59.999 == next bar open time: 2023-06-30T00:00:00.000 == close pos time: 2023-07-07T00:00:00.000
2024-11-20 23:07:15,894 - INFO - pnl: 2023-06-29T23:59:59.999 112388.07774314957 === -0.256%
2024-11-20 23:07:15,899 - DEBUG - cur time: 2023-06-30T23:59:59.999 == next bar open time: 2023-07-01T00:00:00.000 == close pos time: 2023-07-08T00:00:00.000
2024-11-20 23:07:15,901 - INFO - pnl: 2023-06-30T23:59:59.999 118281.81965239684 === 5.244%
2024-11-20 23:07:15,907 - DEBUG - cur time: 2023-07-01T23:59:59.999 == next bar open time: 2023-07-02T00:00:00.000 == close pos time: 2023-07-09T00:00:00.000
2024-11-20 23:07:15,908 - INFO - pnl: 2023-07-01T23:59:59.999 117113.30340953852 === -0.988%
2024-11-20 23:07:15,913 - DEBUG - cur time: 2023-07-02T23:59:59.999 == next bar open time: 2023-07-03T00:00:00.000 == close pos time: 2023-07-10T00:00:00.000
2024-11-20 23:07:15,915 - INFO - pnl: 2023-07-02T23:59:59.999 117764.57735454912 === 0.556%
2024-11-20 23:07:15,918 - DEBUG - cur time: 2023-07-03T23:59:59.999 == next bar open time: 2023-07-04T00:00:00.000 == close pos time: 2023-07-11T00:00:00.000
2024-11-20 23:07:15,919 - INFO - pnl: 2023-07-03T23:59:59.999 117285.861034189 === -0.407%
2024-11-20 23:07:15,923 - DEBUG - cur time: 2023-07-04T23:59:59.999 == next bar open time: 2023-07-05T00:00:00.000 == close pos time: 2023-07-12T00:00:00.000
2024-11-20 23:07:15,933 - DEBUG - sorted_long_factors: shape: (159, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ YFIUSDT      ┆ -1.81985     ┆ 0    ┆ 158          │
│ MAGICUSDT    ┆ -1.779037    ┆ 1    ┆ 157          │
│ APTUSDT      ┆ -1.656529    ┆ 2    ┆ 156          │
│ MKRUSDT      ┆ -1.631856    ┆ 3    ┆ 155          │
│ HIGHUSDT     ┆ -1.609895    ┆ 4    ┆ 154          │
│ ARBUSDT      ┆ -1.603245    ┆ 5    ┆ 153          │
│ HOOKUSDT     ┆ -1.544701    ┆ 6    ┆ 152          │
│ QTUMUSDT     ┆ -1.518129    ┆ 7    ┆ 151          │
│ FXSUSDT      ┆ -1.510768    ┆ 8    ┆ 150          │
│ KAVAUSDT     ┆ -1.491803    ┆ 9    ┆ 149          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ENSUSDT      ┆ -0.160897    ┆ 149  ┆ 9            │
│ XMRUSDT      ┆ -0.15362     ┆ 150  ┆ 8            │
│ BAKEUSDT     ┆ -0.147325    ┆ 151  ┆ 7            │
│ PERPUSDT     ┆ 0.156717     ┆ 152  ┆ 6            │
│ DARUSDT      ┆ 0.179304     ┆ 153  ┆ 5            │
│ IOTXUSDT     ┆ 0.184773     ┆ 154  ┆ 4            │
│ API3USDT     ┆ 0.21732      ┆ 155  ┆ 3            │
│ CTKUSDT      ┆ 0.428405     ┆ 156  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.666983     ┆ 157  ┆ 1            │
│ DEFIUSDT     ┆ 0.934661     ┆ 158  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:15,940 - WARNING - 2023-07-04T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:15,940 - INFO - cur close time: 2023-07-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:15,941 - DEBUG - mean expected ret (mean factor): -0.815257729178394
2024-11-20 23:07:15,945 - DEBUG - begin to update pos: =========
2024-11-20 23:07:15,945 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,946 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08599     ┆ null        ┆ … ┆ 0.02304 ┆ null   ┆ null    ┆ 0.2151  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:15,953 - DEBUG - update position: 2023-07-04T23:59:59.999 === diff_trading_value: 283260.3717020439 == cash: 117562.1120625609 
2024-11-20 23:07:15,955 - INFO - pnl: 2023-07-04T23:59:59.999 117562.1120625609 === 0.236%
2024-11-20 23:07:15,959 - DEBUG - cur time: 2023-07-05T23:59:59.999 == next bar open time: 2023-07-06T00:00:00.000 == close pos time: 2023-07-13T00:00:00.000
2024-11-20 23:07:15,961 - INFO - pnl: 2023-07-05T23:59:59.999 117603.98100531165 === 0.036%
2024-11-20 23:07:15,965 - DEBUG - cur time: 2023-07-06T23:59:59.999 == next bar open time: 2023-07-07T00:00:00.000 == close pos time: 2023-07-14T00:00:00.000
2024-11-20 23:07:15,967 - INFO - pnl: 2023-07-06T23:59:59.999 116423.63344259404 === -1.004%
2024-11-20 23:07:15,971 - DEBUG - cur time: 2023-07-07T23:59:59.999 == next bar open time: 2023-07-08T00:00:00.000 == close pos time: 2023-07-15T00:00:00.000
2024-11-20 23:07:15,973 - INFO - pnl: 2023-07-07T23:59:59.999 115809.08733802069 === -0.528%
2024-11-20 23:07:15,977 - DEBUG - cur time: 2023-07-08T23:59:59.999 == next bar open time: 2023-07-09T00:00:00.000 == close pos time: 2023-07-16T00:00:00.000
2024-11-20 23:07:15,979 - INFO - pnl: 2023-07-08T23:59:59.999 115169.61027551914 === -0.552%
2024-11-20 23:07:15,986 - DEBUG - cur time: 2023-07-09T23:59:59.999 == next bar open time: 2023-07-10T00:00:00.000 == close pos time: 2023-07-17T00:00:00.000
2024-11-20 23:07:15,988 - INFO - pnl: 2023-07-09T23:59:59.999 114981.98604905827 === -0.163%
2024-11-20 23:07:15,995 - DEBUG - cur time: 2023-07-10T23:59:59.999 == next bar open time: 2023-07-11T00:00:00.000 == close pos time: 2023-07-18T00:00:00.000
2024-11-20 23:07:15,998 - INFO - pnl: 2023-07-10T23:59:59.999 115625.50706335936 === 0.560%
2024-11-20 23:07:16,003 - DEBUG - cur time: 2023-07-11T23:59:59.999 == next bar open time: 2023-07-12T00:00:00.000 == close pos time: 2023-07-19T00:00:00.000
2024-11-20 23:07:16,015 - DEBUG - sorted_long_factors: shape: (163, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SSVUSDT      ┆ -1.778462    ┆ 0    ┆ 162          │
│ MTLUSDT      ┆ -1.75934     ┆ 1    ┆ 161          │
│ STXUSDT      ┆ -1.690585    ┆ 2    ┆ 160          │
│ RNDRUSDT     ┆ -1.632264    ┆ 3    ┆ 159          │
│ ANTUSDT      ┆ -1.597532    ┆ 4    ┆ 158          │
│ AAVEUSDT     ┆ -1.596321    ┆ 5    ┆ 157          │
│ CFXUSDT      ┆ -1.55616     ┆ 6    ┆ 156          │
│ HIGHUSDT     ┆ -1.553598    ┆ 7    ┆ 155          │
│ APTUSDT      ┆ -1.548639    ┆ 8    ┆ 154          │
│ DOTUSDT      ┆ -1.510874    ┆ 9    ┆ 153          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ 0.030998     ┆ 153  ┆ 9            │
│ BAKEUSDT     ┆ 0.065395     ┆ 154  ┆ 8            │
│ CKBUSDT      ┆ 0.182713     ┆ 155  ┆ 7            │
│ CHRUSDT      ┆ 0.205483     ┆ 156  ┆ 6            │
│ IOTXUSDT     ┆ 0.208157     ┆ 157  ┆ 5            │
│ LEVERUSDT    ┆ 0.226232     ┆ 158  ┆ 4            │
│ PERPUSDT     ┆ 0.259948     ┆ 159  ┆ 3            │
│ GTCUSDT      ┆ 0.410813     ┆ 160  ┆ 2            │
│ CTKUSDT      ┆ 0.543278     ┆ 161  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.612023     ┆ 162  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:16,072 - WARNING - 2023-07-11T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:16,072 - INFO - cur close time: 2023-07-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:16,073 - DEBUG - mean expected ret (mean factor): -0.8256749931940142
2024-11-20 23:07:16,079 - DEBUG - begin to update pos: =========
2024-11-20 23:07:16,079 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,080 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08308     ┆ null        ┆ … ┆ 0.02099 ┆ null   ┆ null    ┆ 0.2106  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,089 - DEBUG - update position: 2023-07-11T23:59:59.999 === diff_trading_value: 224488.69911130387 == cash: 115173.08202025853 
2024-11-20 23:07:16,090 - INFO - pnl: 2023-07-11T23:59:59.999 115173.08202025853 === -0.391%
2024-11-20 23:07:16,093 - DEBUG - cur time: 2023-07-12T23:59:59.999 == next bar open time: 2023-07-13T00:00:00.000 == close pos time: 2023-07-20T00:00:00.000
2024-11-20 23:07:16,095 - INFO - pnl: 2023-07-12T23:59:59.999 114021.26248563529 === -1.000%
2024-11-20 23:07:16,098 - DEBUG - cur time: 2023-07-13T23:59:59.999 == next bar open time: 2023-07-14T00:00:00.000 == close pos time: 2023-07-21T00:00:00.000
2024-11-20 23:07:16,100 - INFO - pnl: 2023-07-13T23:59:59.999 118393.00521786569 === 3.834%
2024-11-20 23:07:16,103 - DEBUG - cur time: 2023-07-14T23:59:59.999 == next bar open time: 2023-07-15T00:00:00.000 == close pos time: 2023-07-22T00:00:00.000
2024-11-20 23:07:16,105 - INFO - pnl: 2023-07-14T23:59:59.999 118446.26047368962 === 0.045%
2024-11-20 23:07:16,109 - DEBUG - cur time: 2023-07-15T23:59:59.999 == next bar open time: 2023-07-16T00:00:00.000 == close pos time: 2023-07-23T00:00:00.000
2024-11-20 23:07:16,110 - INFO - pnl: 2023-07-15T23:59:59.999 118836.51066048113 === 0.329%
2024-11-20 23:07:16,115 - DEBUG - cur time: 2023-07-16T23:59:59.999 == next bar open time: 2023-07-17T00:00:00.000 == close pos time: 2023-07-24T00:00:00.000
2024-11-20 23:07:16,117 - INFO - pnl: 2023-07-16T23:59:59.999 117661.53634715053 === -0.989%
2024-11-20 23:07:16,120 - DEBUG - cur time: 2023-07-17T23:59:59.999 == next bar open time: 2023-07-18T00:00:00.000 == close pos time: 2023-07-25T00:00:00.000
2024-11-20 23:07:16,123 - INFO - pnl: 2023-07-17T23:59:59.999 118425.8357474731 === 0.650%
2024-11-20 23:07:16,126 - DEBUG - cur time: 2023-07-18T23:59:59.999 == next bar open time: 2023-07-19T00:00:00.000 == close pos time: 2023-07-26T00:00:00.000
2024-11-20 23:07:16,135 - DEBUG - sorted_long_factors: shape: (165, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ STXUSDT      ┆ -2.107755    ┆ 0    ┆ 164          │
│ ARBUSDT      ┆ -1.695489    ┆ 1    ┆ 163          │
│ RNDRUSDT     ┆ -1.66055     ┆ 2    ┆ 162          │
│ LQTYUSDT     ┆ -1.606608    ┆ 3    ┆ 161          │
│ 1INCHUSDT    ┆ -1.520094    ┆ 4    ┆ 160          │
│ UNIUSDT      ┆ -1.505486    ┆ 5    ┆ 159          │
│ SSVUSDT      ┆ -1.498635    ┆ 6    ┆ 158          │
│ APEUSDT      ┆ -1.464446    ┆ 7    ┆ 157          │
│ RDNTUSDT     ┆ -1.462454    ┆ 8    ┆ 156          │
│ TOMOUSDT     ┆ -1.450676    ┆ 9    ┆ 155          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CHRUSDT      ┆ 0.106068     ┆ 155  ┆ 9            │
│ DARUSDT      ┆ 0.11859      ┆ 156  ┆ 8            │
│ LPTUSDT      ┆ 0.164485     ┆ 157  ┆ 7            │
│ REEFUSDT     ┆ 0.167012     ┆ 158  ┆ 6            │
│ OGNUSDT      ┆ 0.218159     ┆ 159  ┆ 5            │
│ IOTXUSDT     ┆ 0.296992     ┆ 160  ┆ 4            │
│ GTCUSDT      ┆ 0.319169     ┆ 161  ┆ 3            │
│ CTKUSDT      ┆ 0.358784     ┆ 162  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.400545     ┆ 163  ┆ 1            │
│ DEFIUSDT     ┆ 0.40104      ┆ 164  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:16,142 - INFO - cur close time: 2023-07-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:16,142 - DEBUG - mean expected ret (mean factor): -0.8153448229649995
2024-11-20 23:07:16,147 - DEBUG - begin to update pos: =========
2024-11-20 23:07:16,147 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,147 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08844     ┆ null        ┆ … ┆ 0.0216  ┆ null   ┆ null    ┆ 0.2117  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,156 - DEBUG - update position: 2023-07-18T23:59:59.999 === diff_trading_value: 193070.5908809745 == cash: 117988.02755589549 
2024-11-20 23:07:16,158 - INFO - pnl: 2023-07-18T23:59:59.999 117988.02755589549 === -0.370%
2024-11-20 23:07:16,163 - DEBUG - cur time: 2023-07-19T23:59:59.999 == next bar open time: 2023-07-20T00:00:00.000 == close pos time: 2023-07-27T00:00:00.000
2024-11-20 23:07:16,165 - INFO - pnl: 2023-07-19T23:59:59.999 118514.46366116771 === 0.446%
2024-11-20 23:07:16,169 - DEBUG - cur time: 2023-07-20T23:59:59.999 == next bar open time: 2023-07-21T00:00:00.000 == close pos time: 2023-07-28T00:00:00.000
2024-11-20 23:07:16,173 - INFO - pnl: 2023-07-20T23:59:59.999 119013.79349844863 === 0.421%
2024-11-20 23:07:16,177 - DEBUG - cur time: 2023-07-21T23:59:59.999 == next bar open time: 2023-07-22T00:00:00.000 == close pos time: 2023-07-29T00:00:00.000
2024-11-20 23:07:16,178 - INFO - pnl: 2023-07-21T23:59:59.999 117975.0041402726 === -0.873%
2024-11-20 23:07:16,182 - DEBUG - cur time: 2023-07-22T23:59:59.999 == next bar open time: 2023-07-23T00:00:00.000 == close pos time: 2023-07-30T00:00:00.000
2024-11-20 23:07:16,184 - INFO - pnl: 2023-07-22T23:59:59.999 117847.8342589577 === -0.108%
2024-11-20 23:07:16,190 - DEBUG - cur time: 2023-07-23T23:59:59.999 == next bar open time: 2023-07-24T00:00:00.000 == close pos time: 2023-07-31T00:00:00.000
2024-11-20 23:07:16,192 - INFO - pnl: 2023-07-23T23:59:59.999 121561.9407839034 === 3.152%
2024-11-20 23:07:16,195 - DEBUG - cur time: 2023-07-24T23:59:59.999 == next bar open time: 2023-07-25T00:00:00.000 == close pos time: 2023-08-01T00:00:00.000
2024-11-20 23:07:16,197 - INFO - pnl: 2023-07-24T23:59:59.999 118705.96586603846 === -2.349%
2024-11-20 23:07:16,201 - DEBUG - cur time: 2023-07-25T23:59:59.999 == next bar open time: 2023-07-26T00:00:00.000 == close pos time: 2023-08-02T00:00:00.000
2024-11-20 23:07:16,210 - DEBUG - sorted_long_factors: shape: (166, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ICPUSDT   ┆ -1.923799    ┆ 0    ┆ 165          │
│ LQTYUSDT  ┆ -1.912268    ┆ 1    ┆ 164          │
│ STXUSDT   ┆ -1.84118     ┆ 2    ┆ 163          │
│ WAVESUSDT ┆ -1.819334    ┆ 3    ┆ 162          │
│ XRPUSDT   ┆ -1.742774    ┆ 4    ┆ 161          │
│ ARBUSDT   ┆ -1.740523    ┆ 5    ┆ 160          │
│ BELUSDT   ┆ -1.731377    ┆ 6    ┆ 159          │
│ XMRUSDT   ┆ -1.652129    ┆ 7    ┆ 158          │
│ UNIUSDT   ┆ -1.611298    ┆ 8    ┆ 157          │
│ MKRUSDT   ┆ -1.545747    ┆ 9    ┆ 156          │
│ …         ┆ …            ┆ …    ┆ …            │
│ LEVERUSDT ┆ 0.135173     ┆ 156  ┆ 9            │
│ LPTUSDT   ┆ 0.154678     ┆ 157  ┆ 8            │
│ CTKUSDT   ┆ 0.261168     ┆ 158  ┆ 7            │
│ SKLUSDT   ┆ 0.327212     ┆ 159  ┆ 6            │
│ GTCUSDT   ┆ 0.357388     ┆ 160  ┆ 5            │
│ TLMUSDT   ┆ 0.360412     ┆ 161  ┆ 4            │
│ RVNUSDT   ┆ 0.365813     ┆ 162  ┆ 3            │
│ PERPUSDT  ┆ 0.433847     ┆ 163  ┆ 2            │
│ CVXUSDT   ┆ 0.440484     ┆ 164  ┆ 1            │
│ SPELLUSDT ┆ 0.543707     ┆ 165  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:16,218 - WARNING - 2023-07-25T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:16,218 - INFO - cur close time: 2023-07-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:16,218 - DEBUG - mean expected ret (mean factor): -0.808144622438793
2024-11-20 23:07:16,226 - DEBUG - begin to update pos: =========
2024-11-20 23:07:16,226 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,226 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08171     ┆ null        ┆ … ┆ 0.02071 ┆ null   ┆ null    ┆ 0.2072  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,233 - DEBUG - update position: 2023-07-25T23:59:59.999 === diff_trading_value: 203736.66767808524 == cash: 117502.61715591849 
2024-11-20 23:07:16,235 - INFO - pnl: 2023-07-25T23:59:59.999 117502.61715591849 === -1.014%
2024-11-20 23:07:16,239 - DEBUG - cur time: 2023-07-26T23:59:59.999 == next bar open time: 2023-07-27T00:00:00.000 == close pos time: 2023-08-03T00:00:00.000
2024-11-20 23:07:16,241 - INFO - pnl: 2023-07-26T23:59:59.999 117900.45962850287 === 0.339%
2024-11-20 23:07:16,247 - DEBUG - cur time: 2023-07-27T23:59:59.999 == next bar open time: 2023-07-28T00:00:00.000 == close pos time: 2023-08-04T00:00:00.000
2024-11-20 23:07:16,249 - INFO - pnl: 2023-07-27T23:59:59.999 118492.94331012461 === 0.503%
2024-11-20 23:07:16,254 - DEBUG - cur time: 2023-07-28T23:59:59.999 == next bar open time: 2023-07-29T00:00:00.000 == close pos time: 2023-08-05T00:00:00.000
2024-11-20 23:07:16,257 - INFO - pnl: 2023-07-28T23:59:59.999 117850.61561599157 === -0.542%
2024-11-20 23:07:16,264 - DEBUG - cur time: 2023-07-29T23:59:59.999 == next bar open time: 2023-07-30T00:00:00.000 == close pos time: 2023-08-06T00:00:00.000
2024-11-20 23:07:16,266 - INFO - pnl: 2023-07-29T23:59:59.999 117305.31122806802 === -0.463%
2024-11-20 23:07:16,270 - DEBUG - cur time: 2023-07-30T23:59:59.999 == next bar open time: 2023-07-31T00:00:00.000 == close pos time: 2023-08-07T00:00:00.000
2024-11-20 23:07:16,273 - INFO - pnl: 2023-07-30T23:59:59.999 115865.52322849885 === -1.227%
2024-11-20 23:07:16,277 - DEBUG - cur time: 2023-07-31T23:59:59.999 == next bar open time: 2023-08-01T00:00:00.000 == close pos time: 2023-08-08T00:00:00.000
2024-11-20 23:07:16,279 - INFO - pnl: 2023-07-31T23:59:59.999 115613.83359823535 === -0.217%
2024-11-20 23:07:16,283 - DEBUG - cur time: 2023-08-01T23:59:59.999 == next bar open time: 2023-08-02T00:00:00.000 == close pos time: 2023-08-09T00:00:00.000
2024-11-20 23:07:16,293 - DEBUG - sorted_long_factors: shape: (166, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ UNIUSDT      ┆ -1.960984    ┆ 0    ┆ 165          │
│ IDUSDT       ┆ -1.839159    ┆ 1    ┆ 164          │
│ ZECUSDT      ┆ -1.753291    ┆ 2    ┆ 163          │
│ WAVESUSDT    ┆ -1.739633    ┆ 3    ┆ 162          │
│ HIGHUSDT     ┆ -1.659489    ┆ 4    ┆ 161          │
│ APTUSDT      ┆ -1.594299    ┆ 5    ┆ 160          │
│ 1INCHUSDT    ┆ -1.563021    ┆ 6    ┆ 159          │
│ RDNTUSDT     ┆ -1.558124    ┆ 7    ┆ 158          │
│ CFXUSDT      ┆ -1.554828    ┆ 8    ┆ 157          │
│ OPUSDT       ┆ -1.528107    ┆ 9    ┆ 156          │
│ …            ┆ …            ┆ …    ┆ …            │
│ HFTUSDT      ┆ 0.077715     ┆ 156  ┆ 9            │
│ RVNUSDT      ┆ 0.09537      ┆ 157  ┆ 8            │
│ CKBUSDT      ┆ 0.159971     ┆ 158  ┆ 7            │
│ CHRUSDT      ┆ 0.189573     ┆ 159  ┆ 6            │
│ CVXUSDT      ┆ 0.330484     ┆ 160  ┆ 5            │
│ BLZUSDT      ┆ 0.434812     ┆ 161  ┆ 4            │
│ BLUEBIRDUSDT ┆ 0.440252     ┆ 162  ┆ 3            │
│ IOTXUSDT     ┆ 0.766884     ┆ 163  ┆ 2            │
│ CTKUSDT      ┆ 0.96624      ┆ 164  ┆ 1            │
│ DEFIUSDT     ┆ 0.987343     ┆ 165  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:16,303 - WARNING - 2023-08-01T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:16,303 - INFO - cur close time: 2023-08-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:16,303 - DEBUG - mean expected ret (mean factor): -0.7913868533596125
2024-11-20 23:07:16,309 - DEBUG - begin to update pos: =========
2024-11-20 23:07:16,309 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,309 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08132     ┆ null        ┆ … ┆ 0.02105 ┆ null   ┆ null    ┆ 0.2214  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,317 - DEBUG - update position: 2023-08-01T23:59:59.999 === diff_trading_value: 239263.96613861725 == cash: 115428.6737796148 
2024-11-20 23:07:16,319 - INFO - pnl: 2023-08-01T23:59:59.999 115428.6737796148 === -0.160%
2024-11-20 23:07:16,322 - DEBUG - cur time: 2023-08-02T23:59:59.999 == next bar open time: 2023-08-03T00:00:00.000 == close pos time: 2023-08-10T00:00:00.000
2024-11-20 23:07:16,324 - INFO - pnl: 2023-08-02T23:59:59.999 114675.52254839582 === -0.652%
2024-11-20 23:07:16,327 - DEBUG - cur time: 2023-08-03T23:59:59.999 == next bar open time: 2023-08-04T00:00:00.000 == close pos time: 2023-08-11T00:00:00.000
2024-11-20 23:07:16,329 - INFO - pnl: 2023-08-03T23:59:59.999 114482.63504693894 === -0.168%
2024-11-20 23:07:16,333 - DEBUG - cur time: 2023-08-04T23:59:59.999 == next bar open time: 2023-08-05T00:00:00.000 == close pos time: 2023-08-12T00:00:00.000
2024-11-20 23:07:16,334 - INFO - pnl: 2023-08-04T23:59:59.999 115369.2618426029 === 0.774%
2024-11-20 23:07:16,337 - DEBUG - cur time: 2023-08-05T23:59:59.999 == next bar open time: 2023-08-06T00:00:00.000 == close pos time: 2023-08-13T00:00:00.000
2024-11-20 23:07:16,338 - INFO - pnl: 2023-08-05T23:59:59.999 115495.8414406666 === 0.110%
2024-11-20 23:07:16,341 - DEBUG - cur time: 2023-08-06T23:59:59.999 == next bar open time: 2023-08-07T00:00:00.000 == close pos time: 2023-08-14T00:00:00.000
2024-11-20 23:07:16,344 - INFO - pnl: 2023-08-06T23:59:59.999 116641.51572133554 === 0.992%
2024-11-20 23:07:16,348 - DEBUG - cur time: 2023-08-07T23:59:59.999 == next bar open time: 2023-08-08T00:00:00.000 == close pos time: 2023-08-15T00:00:00.000
2024-11-20 23:07:16,350 - INFO - pnl: 2023-08-07T23:59:59.999 117217.55867034383 === 0.494%
2024-11-20 23:07:16,353 - DEBUG - cur time: 2023-08-08T23:59:59.999 == next bar open time: 2023-08-09T00:00:00.000 == close pos time: 2023-08-16T00:00:00.000
2024-11-20 23:07:16,366 - DEBUG - sorted_long_factors: shape: (167, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ UNIUSDT      ┆ -2.068808    ┆ 0    ┆ 166          │
│ APEUSDT      ┆ -1.660538    ┆ 1    ┆ 165          │
│ BNBUSDT      ┆ -1.651435    ┆ 2    ┆ 164          │
│ FILUSDT      ┆ -1.644311    ┆ 3    ┆ 163          │
│ NEOUSDT      ┆ -1.637974    ┆ 4    ┆ 162          │
│ GTCUSDT      ┆ -1.611275    ┆ 5    ┆ 161          │
│ XMRUSDT      ┆ -1.6102      ┆ 6    ┆ 160          │
│ HIGHUSDT     ┆ -1.608491    ┆ 7    ┆ 159          │
│ WAVESUSDT    ┆ -1.587593    ┆ 8    ┆ 158          │
│ COMPUSDT     ┆ -1.560279    ┆ 9    ┆ 157          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CKBUSDT      ┆ -0.118242    ┆ 157  ┆ 9            │
│ AMBUSDT      ┆ -0.111477    ┆ 158  ┆ 8            │
│ SKLUSDT      ┆ -0.095963    ┆ 159  ┆ 7            │
│ DUSKUSDT     ┆ 0.034373     ┆ 160  ┆ 6            │
│ KSMUSDT      ┆ 0.103685     ┆ 161  ┆ 5            │
│ DEFIUSDT     ┆ 0.204064     ┆ 162  ┆ 4            │
│ CTKUSDT      ┆ 0.538564     ┆ 163  ┆ 3            │
│ IOTXUSDT     ┆ 0.653294     ┆ 164  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.715644     ┆ 165  ┆ 1            │
│ BLZUSDT      ┆ 0.811124     ┆ 166  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:16,374 - INFO - cur close time: 2023-08-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:16,374 - DEBUG - mean expected ret (mean factor): -0.8228202603198459
2024-11-20 23:07:16,379 - DEBUG - begin to update pos: =========
2024-11-20 23:07:16,380 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,380 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.07815     ┆ null        ┆ … ┆ 0.02014 ┆ null   ┆ null    ┆ 0.2157  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,388 - DEBUG - update position: 2023-08-08T23:59:59.999 === diff_trading_value: 223343.03043392685 == cash: 117555.0105258509 
2024-11-20 23:07:16,390 - INFO - pnl: 2023-08-08T23:59:59.999 117555.0105258509 === 0.288%
2024-11-20 23:07:16,394 - DEBUG - cur time: 2023-08-09T23:59:59.999 == next bar open time: 2023-08-10T00:00:00.000 == close pos time: 2023-08-17T00:00:00.000
2024-11-20 23:07:16,396 - INFO - pnl: 2023-08-09T23:59:59.999 116890.985596857 === -0.565%
2024-11-20 23:07:16,400 - DEBUG - cur time: 2023-08-10T23:59:59.999 == next bar open time: 2023-08-11T00:00:00.000 == close pos time: 2023-08-18T00:00:00.000
2024-11-20 23:07:16,402 - INFO - pnl: 2023-08-10T23:59:59.999 116859.98512139262 === -0.027%
2024-11-20 23:07:16,405 - DEBUG - cur time: 2023-08-11T23:59:59.999 == next bar open time: 2023-08-12T00:00:00.000 == close pos time: 2023-08-19T00:00:00.000
2024-11-20 23:07:16,407 - INFO - pnl: 2023-08-11T23:59:59.999 116857.77820897264 === -0.002%
2024-11-20 23:07:16,411 - DEBUG - cur time: 2023-08-12T23:59:59.999 == next bar open time: 2023-08-13T00:00:00.000 == close pos time: 2023-08-20T00:00:00.000
2024-11-20 23:07:16,413 - INFO - pnl: 2023-08-12T23:59:59.999 116765.64907937392 === -0.079%
2024-11-20 23:07:16,417 - DEBUG - cur time: 2023-08-13T23:59:59.999 == next bar open time: 2023-08-14T00:00:00.000 == close pos time: 2023-08-21T00:00:00.000
2024-11-20 23:07:16,419 - INFO - pnl: 2023-08-13T23:59:59.999 122281.3239978875 === 4.724%
2024-11-20 23:07:16,422 - DEBUG - cur time: 2023-08-14T23:59:59.999 == next bar open time: 2023-08-15T00:00:00.000 == close pos time: 2023-08-22T00:00:00.000
2024-11-20 23:07:16,425 - INFO - pnl: 2023-08-14T23:59:59.999 122496.77885083707 === 0.176%
2024-11-20 23:07:16,428 - DEBUG - cur time: 2023-08-15T23:59:59.999 == next bar open time: 2023-08-16T00:00:00.000 == close pos time: 2023-08-23T00:00:00.000
2024-11-20 23:07:16,440 - DEBUG - sorted_long_factors: shape: (172, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ STXUSDT      ┆ -1.590265    ┆ 0    ┆ 171          │
│ APEUSDT      ┆ -1.528853    ┆ 1    ┆ 170          │
│ HIGHUSDT     ┆ -1.464798    ┆ 2    ┆ 169          │
│ PHBUSDT      ┆ -1.462423    ┆ 3    ┆ 168          │
│ BLURUSDT     ┆ -1.454799    ┆ 4    ┆ 167          │
│ IDUSDT       ┆ -1.445128    ┆ 5    ┆ 166          │
│ CFXUSDT      ┆ -1.426823    ┆ 6    ┆ 165          │
│ SUIUSDT      ┆ -1.393657    ┆ 7    ┆ 164          │
│ USDCUSDT     ┆ -1.370678    ┆ 8    ┆ 163          │
│ ARBUSDT      ┆ -1.362353    ┆ 9    ┆ 162          │
│ …            ┆ …            ┆ …    ┆ …            │
│ FLMUSDT      ┆ -0.266135    ┆ 162  ┆ 9            │
│ JOEUSDT      ┆ -0.223145    ┆ 163  ┆ 8            │
│ IDEXUSDT     ┆ -0.09719     ┆ 164  ┆ 7            │
│ ICXUSDT      ┆ -0.080394    ┆ 165  ┆ 6            │
│ CTKUSDT      ┆ 0.098808     ┆ 166  ┆ 5            │
│ SKLUSDT      ┆ 0.184823     ┆ 167  ┆ 4            │
│ IOTXUSDT     ┆ 0.356474     ┆ 168  ┆ 3            │
│ ARUSDT       ┆ 0.385048     ┆ 169  ┆ 2            │
│ DEFIUSDT     ┆ 0.429649     ┆ 170  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.814841     ┆ 171  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:16,448 - INFO - cur close time: 2023-08-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:16,449 - DEBUG - mean expected ret (mean factor): -0.8249578193198934
2024-11-20 23:07:16,454 - DEBUG - begin to update pos: =========
2024-11-20 23:07:16,454 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,454 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02293     ┆ 0.06981     ┆ 0.0012678   ┆ … ┆ 0.01904 ┆ null   ┆ null    ┆ 0.2105  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,463 - DEBUG - update position: 2023-08-15T23:59:59.999 === diff_trading_value: 289608.8733560908 == cash: 121359.91184904291 
2024-11-20 23:07:16,465 - INFO - pnl: 2023-08-15T23:59:59.999 121359.91184904291 === -0.928%
2024-11-20 23:07:16,468 - DEBUG - cur time: 2023-08-16T23:59:59.999 == next bar open time: 2023-08-17T00:00:00.000 == close pos time: 2023-08-24T00:00:00.000
2024-11-20 23:07:16,469 - INFO - pnl: 2023-08-16T23:59:59.999 121842.40078752553 === 0.398%
2024-11-20 23:07:16,474 - DEBUG - cur time: 2023-08-17T23:59:59.999 == next bar open time: 2023-08-18T00:00:00.000 == close pos time: 2023-08-25T00:00:00.000
2024-11-20 23:07:16,475 - INFO - pnl: 2023-08-17T23:59:59.999 123574.19457004189 === 1.421%
2024-11-20 23:07:16,480 - DEBUG - cur time: 2023-08-18T23:59:59.999 == next bar open time: 2023-08-19T00:00:00.000 == close pos time: 2023-08-26T00:00:00.000
2024-11-20 23:07:16,481 - INFO - pnl: 2023-08-18T23:59:59.999 122637.2348238111 === -0.758%
2024-11-20 23:07:16,486 - DEBUG - cur time: 2023-08-19T23:59:59.999 == next bar open time: 2023-08-20T00:00:00.000 == close pos time: 2023-08-27T00:00:00.000
2024-11-20 23:07:16,488 - INFO - pnl: 2023-08-19T23:59:59.999 121233.99023962636 === -1.144%
2024-11-20 23:07:16,493 - DEBUG - cur time: 2023-08-20T23:59:59.999 == next bar open time: 2023-08-21T00:00:00.000 == close pos time: 2023-08-28T00:00:00.000
2024-11-20 23:07:16,495 - INFO - pnl: 2023-08-20T23:59:59.999 122011.4579643193 === 0.641%
2024-11-20 23:07:16,499 - DEBUG - cur time: 2023-08-21T23:59:59.999 == next bar open time: 2023-08-22T00:00:00.000 == close pos time: 2023-08-29T00:00:00.000
2024-11-20 23:07:16,501 - INFO - pnl: 2023-08-21T23:59:59.999 122320.36719966317 === 0.253%
2024-11-20 23:07:16,507 - DEBUG - cur time: 2023-08-22T23:59:59.999 == next bar open time: 2023-08-23T00:00:00.000 == close pos time: 2023-08-30T00:00:00.000
2024-11-20 23:07:16,517 - DEBUG - sorted_long_factors: shape: (174, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT   ┆ -2.045457    ┆ 0    ┆ 173          │
│ KNCUSDT      ┆ -1.893297    ┆ 1    ┆ 172          │
│ UNFIUSDT     ┆ -1.79767     ┆ 2    ┆ 171          │
│ LEVERUSDT    ┆ -1.778218    ┆ 3    ┆ 170          │
│ USDCUSDT     ┆ -1.748088    ┆ 4    ┆ 169          │
│ HIGHUSDT     ┆ -1.686428    ┆ 5    ┆ 168          │
│ SUSHIUSDT    ┆ -1.624398    ┆ 6    ┆ 167          │
│ PHBUSDT      ┆ -1.613517    ┆ 7    ┆ 166          │
│ C98USDT      ┆ -1.535062    ┆ 8    ┆ 165          │
│ RNDRUSDT     ┆ -1.500145    ┆ 9    ┆ 164          │
│ …            ┆ …            ┆ …    ┆ …            │
│ FOOTBALLUSDT ┆ -0.053981    ┆ 164  ┆ 9            │
│ IOTXUSDT     ┆ -0.051666    ┆ 165  ┆ 8            │
│ XVSUSDT      ┆ -0.039115    ┆ 166  ┆ 7            │
│ TUSDT        ┆ 0.005693     ┆ 167  ┆ 6            │
│ ARUSDT       ┆ 0.035531     ┆ 168  ┆ 5            │
│ SPELLUSDT    ┆ 0.253824     ┆ 169  ┆ 4            │
│ IDEXUSDT     ┆ 0.423031     ┆ 170  ┆ 3            │
│ CTKUSDT      ┆ 0.488207     ┆ 171  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.670488     ┆ 172  ┆ 1            │
│ DEFIUSDT     ┆ 1.111012     ┆ 173  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:16,525 - WARNING - 2023-08-22T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:16,525 - INFO - cur close time: 2023-08-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:16,525 - DEBUG - mean expected ret (mean factor): -0.8311046277723451
2024-11-20 23:07:16,531 - DEBUG - begin to update pos: =========
2024-11-20 23:07:16,531 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,532 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01805     ┆ 0.06441     ┆ 0.0010722   ┆ … ┆ 0.01667 ┆ null   ┆ null    ┆ 0.1733  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,538 - DEBUG - update position: 2023-08-22T23:59:59.999 === diff_trading_value: 224076.91610429436 == cash: 122019.39329751657 
2024-11-20 23:07:16,540 - INFO - pnl: 2023-08-22T23:59:59.999 122019.39329751657 === -0.246%
2024-11-20 23:07:16,543 - DEBUG - cur time: 2023-08-23T23:59:59.999 == next bar open time: 2023-08-24T00:00:00.000 == close pos time: 2023-08-31T00:00:00.000
2024-11-20 23:07:16,545 - INFO - pnl: 2023-08-23T23:59:59.999 122423.15948691551 === 0.331%
2024-11-20 23:07:16,550 - DEBUG - cur time: 2023-08-24T23:59:59.999 == next bar open time: 2023-08-25T00:00:00.000 == close pos time: 2023-09-01T00:00:00.000
2024-11-20 23:07:16,553 - INFO - pnl: 2023-08-24T23:59:59.999 120778.13336523637 === -1.344%
2024-11-20 23:07:16,557 - DEBUG - cur time: 2023-08-25T23:59:59.999 == next bar open time: 2023-08-26T00:00:00.000 == close pos time: 2023-09-02T00:00:00.000
2024-11-20 23:07:16,559 - INFO - pnl: 2023-08-25T23:59:59.999 122968.57985901868 === 1.814%
2024-11-20 23:07:16,562 - DEBUG - cur time: 2023-08-26T23:59:59.999 == next bar open time: 2023-08-27T00:00:00.000 == close pos time: 2023-09-03T00:00:00.000
2024-11-20 23:07:16,564 - INFO - pnl: 2023-08-26T23:59:59.999 121995.26731421753 === -0.792%
2024-11-20 23:07:16,567 - DEBUG - cur time: 2023-08-27T23:59:59.999 == next bar open time: 2023-08-28T00:00:00.000 == close pos time: 2023-09-04T00:00:00.000
2024-11-20 23:07:16,570 - INFO - pnl: 2023-08-27T23:59:59.999 122106.38658157145 === 0.091%
2024-11-20 23:07:16,575 - DEBUG - cur time: 2023-08-28T23:59:59.999 == next bar open time: 2023-08-29T00:00:00.000 == close pos time: 2023-09-05T00:00:00.000
2024-11-20 23:07:16,578 - INFO - pnl: 2023-08-28T23:59:59.999 119938.54620330993 === -1.775%
2024-11-20 23:07:16,582 - DEBUG - cur time: 2023-08-29T23:59:59.999 == next bar open time: 2023-08-30T00:00:00.000 == close pos time: 2023-09-06T00:00:00.000
2024-11-20 23:07:16,592 - DEBUG - sorted_long_factors: shape: (174, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RUNEUSDT     ┆ -1.727165    ┆ 0    ┆ 173          │
│ USDCUSDT     ┆ -1.723028    ┆ 1    ┆ 172          │
│ DOTUSDT      ┆ -1.689751    ┆ 2    ┆ 171          │
│ LEVERUSDT    ┆ -1.638029    ┆ 3    ┆ 170          │
│ SSVUSDT      ┆ -1.589401    ┆ 4    ┆ 169          │
│ DYDXUSDT     ┆ -1.587187    ┆ 5    ┆ 168          │
│ 1000PEPEUSDT ┆ -1.572567    ┆ 6    ┆ 167          │
│ UNFIUSDT     ┆ -1.560872    ┆ 7    ┆ 166          │
│ PHBUSDT      ┆ -1.543047    ┆ 8    ┆ 165          │
│ ZECUSDT      ┆ -1.528299    ┆ 9    ┆ 164          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DEFIUSDT     ┆ 0.023351     ┆ 164  ┆ 9            │
│ PERPUSDT     ┆ 0.062284     ┆ 165  ┆ 8            │
│ RLCUSDT      ┆ 0.073001     ┆ 166  ┆ 7            │
│ BLUEBIRDUSDT ┆ 0.105833     ┆ 167  ┆ 6            │
│ CTKUSDT      ┆ 0.238674     ┆ 168  ┆ 5            │
│ SPELLUSDT    ┆ 0.249583     ┆ 169  ┆ 4            │
│ XVSUSDT      ┆ 0.340498     ┆ 170  ┆ 3            │
│ IDEXUSDT     ┆ 0.341187     ┆ 171  ┆ 2            │
│ CKBUSDT      ┆ 0.471121     ┆ 172  ┆ 1            │
│ TUSDT        ┆ 0.785743     ┆ 173  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:16,605 - WARNING - 2023-08-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:16,605 - INFO - cur close time: 2023-08-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:16,606 - DEBUG - mean expected ret (mean factor): -0.8287795549292265
2024-11-20 23:07:16,611 - DEBUG - begin to update pos: =========
2024-11-20 23:07:16,611 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,611 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01854     ┆ 0.06495     ┆ 0.0008951   ┆ … ┆ 0.0174  ┆ null   ┆ null    ┆ 0.1791  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,618 - DEBUG - update position: 2023-08-29T23:59:59.999 === diff_trading_value: 198776.87392022362 == cash: 120466.709702555 
2024-11-20 23:07:16,620 - INFO - pnl: 2023-08-29T23:59:59.999 120466.709702555 === 0.440%
2024-11-20 23:07:16,624 - DEBUG - cur time: 2023-08-30T23:59:59.999 == next bar open time: 2023-08-31T00:00:00.000 == close pos time: 2023-09-07T00:00:00.000
2024-11-20 23:07:16,627 - INFO - pnl: 2023-08-30T23:59:59.999 118899.20153775279 === -1.301%
2024-11-20 23:07:16,631 - DEBUG - cur time: 2023-08-31T23:59:59.999 == next bar open time: 2023-09-01T00:00:00.000 == close pos time: 2023-09-08T00:00:00.000
2024-11-20 23:07:16,633 - INFO - pnl: 2023-08-31T23:59:59.999 116657.52133863658 === -1.885%
2024-11-20 23:07:16,639 - DEBUG - cur time: 2023-09-01T23:59:59.999 == next bar open time: 2023-09-02T00:00:00.000 == close pos time: 2023-09-09T00:00:00.000
2024-11-20 23:07:16,643 - INFO - pnl: 2023-09-01T23:59:59.999 115953.54636343155 === -0.603%
2024-11-20 23:07:16,648 - DEBUG - cur time: 2023-09-02T23:59:59.999 == next bar open time: 2023-09-03T00:00:00.000 == close pos time: 2023-09-10T00:00:00.000
2024-11-20 23:07:16,650 - INFO - pnl: 2023-09-02T23:59:59.999 117566.09487776532 === 1.391%
2024-11-20 23:07:16,653 - DEBUG - cur time: 2023-09-03T23:59:59.999 == next bar open time: 2023-09-04T00:00:00.000 == close pos time: 2023-09-11T00:00:00.000
2024-11-20 23:07:16,656 - INFO - pnl: 2023-09-03T23:59:59.999 114927.43409851629 === -2.244%
2024-11-20 23:07:16,660 - DEBUG - cur time: 2023-09-04T23:59:59.999 == next bar open time: 2023-09-05T00:00:00.000 == close pos time: 2023-09-12T00:00:00.000
2024-11-20 23:07:16,661 - INFO - pnl: 2023-09-04T23:59:59.999 115581.44711543442 === 0.569%
2024-11-20 23:07:16,665 - DEBUG - cur time: 2023-09-05T23:59:59.999 == next bar open time: 2023-09-06T00:00:00.000 == close pos time: 2023-09-13T00:00:00.000
2024-11-20 23:07:16,676 - DEBUG - sorted_long_factors: shape: (175, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ARBUSDT      ┆ -1.788201    ┆ 0    ┆ 174          │
│ SUIUSDT      ┆ -1.780255    ┆ 1    ┆ 173          │
│ DYDXUSDT     ┆ -1.771697    ┆ 2    ┆ 172          │
│ EGLDUSDT     ┆ -1.754475    ┆ 3    ┆ 171          │
│ EOSUSDT      ┆ -1.718522    ┆ 4    ┆ 170          │
│ ATOMUSDT     ┆ -1.659375    ┆ 5    ┆ 169          │
│ FILUSDT      ┆ -1.649843    ┆ 6    ┆ 168          │
│ DOTUSDT      ┆ -1.648599    ┆ 7    ┆ 167          │
│ ZECUSDT      ┆ -1.632255    ┆ 8    ┆ 166          │
│ RADUSDT      ┆ -1.608477    ┆ 9    ┆ 165          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DGBUSDT      ┆ 0.127971     ┆ 165  ┆ 9            │
│ BALUSDT      ┆ 0.130233     ┆ 166  ┆ 8            │
│ BNXUSDT      ┆ 0.216082     ┆ 167  ┆ 7            │
│ DENTUSDT     ┆ 0.266132     ┆ 168  ┆ 6            │
│ TUSDT        ┆ 0.287143     ┆ 169  ┆ 5            │
│ ICXUSDT      ┆ 0.361069     ┆ 170  ┆ 4            │
│ SPELLUSDT    ┆ 0.475723     ┆ 171  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.530644     ┆ 172  ┆ 2            │
│ IOTXUSDT     ┆ 0.538675     ┆ 173  ┆ 1            │
│ CKBUSDT      ┆ 0.767963     ┆ 174  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:16,686 - WARNING - 2023-09-05T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:16,686 - INFO - cur close time: 2023-09-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:16,687 - DEBUG - mean expected ret (mean factor): -0.795322730804542
2024-11-20 23:07:16,692 - DEBUG - begin to update pos: =========
2024-11-20 23:07:16,692 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,693 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.017       ┆ 0.06047     ┆ 0.0008029   ┆ … ┆ 0.01645 ┆ null   ┆ null    ┆ 0.1774  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,700 - DEBUG - update position: 2023-09-05T23:59:59.999 === diff_trading_value: 241509.64268187864 == cash: 120608.8732627257 
2024-11-20 23:07:16,702 - INFO - pnl: 2023-09-05T23:59:59.999 120608.8732627257 === 4.350%
2024-11-20 23:07:16,706 - DEBUG - cur time: 2023-09-06T23:59:59.999 == next bar open time: 2023-09-07T00:00:00.000 == close pos time: 2023-09-14T00:00:00.000
2024-11-20 23:07:16,708 - INFO - pnl: 2023-09-06T23:59:59.999 122037.6622592685 === 1.185%
2024-11-20 23:07:16,713 - DEBUG - cur time: 2023-09-07T23:59:59.999 == next bar open time: 2023-09-08T00:00:00.000 == close pos time: 2023-09-15T00:00:00.000
2024-11-20 23:07:16,716 - INFO - pnl: 2023-09-07T23:59:59.999 123112.3568829795 === 0.881%
2024-11-20 23:07:16,720 - DEBUG - cur time: 2023-09-08T23:59:59.999 == next bar open time: 2023-09-09T00:00:00.000 == close pos time: 2023-09-16T00:00:00.000
2024-11-20 23:07:16,723 - INFO - pnl: 2023-09-08T23:59:59.999 124034.09298115077 === 0.749%
2024-11-20 23:07:16,727 - DEBUG - cur time: 2023-09-09T23:59:59.999 == next bar open time: 2023-09-10T00:00:00.000 == close pos time: 2023-09-17T00:00:00.000
2024-11-20 23:07:16,730 - INFO - pnl: 2023-09-09T23:59:59.999 124316.57058298413 === 0.228%
2024-11-20 23:07:16,735 - DEBUG - cur time: 2023-09-10T23:59:59.999 == next bar open time: 2023-09-11T00:00:00.000 == close pos time: 2023-09-18T00:00:00.000
2024-11-20 23:07:16,736 - INFO - pnl: 2023-09-10T23:59:59.999 124565.72480336741 === 0.200%
2024-11-20 23:07:16,740 - DEBUG - cur time: 2023-09-11T23:59:59.999 == next bar open time: 2023-09-12T00:00:00.000 == close pos time: 2023-09-19T00:00:00.000
2024-11-20 23:07:16,742 - INFO - pnl: 2023-09-11T23:59:59.999 124181.07437974484 === -0.309%
2024-11-20 23:07:16,745 - DEBUG - cur time: 2023-09-12T23:59:59.999 == next bar open time: 2023-09-13T00:00:00.000 == close pos time: 2023-09-20T00:00:00.000
2024-11-20 23:07:16,755 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ UNFIUSDT     ┆ -1.714286    ┆ 0    ┆ 175          │
│ EDUUSDT      ┆ -1.672406    ┆ 1    ┆ 174          │
│ UMAUSDT      ┆ -1.642032    ┆ 2    ┆ 173          │
│ JOEUSDT      ┆ -1.571935    ┆ 3    ┆ 172          │
│ 1000PEPEUSDT ┆ -1.56558     ┆ 4    ┆ 171          │
│ TRBUSDT      ┆ -1.552889    ┆ 5    ┆ 170          │
│ SUIUSDT      ┆ -1.533786    ┆ 6    ┆ 169          │
│ USDCUSDT     ┆ -1.481004    ┆ 7    ┆ 168          │
│ WAVESUSDT    ┆ -1.444781    ┆ 8    ┆ 167          │
│ ARBUSDT      ┆ -1.439563    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BALUSDT      ┆ -0.153063    ┆ 166  ┆ 9            │
│ RSRUSDT      ┆ -0.146323    ┆ 167  ┆ 8            │
│ FXSUSDT      ┆ -0.144366    ┆ 168  ┆ 7            │
│ ENSUSDT      ┆ 0.030455     ┆ 169  ┆ 6            │
│ CKBUSDT      ┆ 0.163954     ┆ 170  ┆ 5            │
│ CVXUSDT      ┆ 0.195984     ┆ 171  ┆ 4            │
│ RVNUSDT      ┆ 0.338284     ┆ 172  ┆ 3            │
│ DGBUSDT      ┆ 0.432912     ┆ 173  ┆ 2            │
│ DEFIUSDT     ┆ 0.966317     ┆ 174  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.926954     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:16,761 - WARNING - 2023-09-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:16,763 - INFO - cur close time: 2023-09-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:16,763 - DEBUG - mean expected ret (mean factor): -0.8038586140953071
2024-11-20 23:07:16,770 - DEBUG - begin to update pos: =========
2024-11-20 23:07:16,771 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,771 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01568     ┆ 0.05709     ┆ 0.0006714   ┆ … ┆ 0.01521 ┆ null   ┆ null    ┆ 0.1646  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,785 - DEBUG - update position: 2023-09-12T23:59:59.999 === diff_trading_value: 250820.1376422107 == cash: 124656.20721077155 
2024-11-20 23:07:16,787 - INFO - pnl: 2023-09-12T23:59:59.999 124656.20721077155 === 0.383%
2024-11-20 23:07:16,791 - DEBUG - cur time: 2023-09-13T23:59:59.999 == next bar open time: 2023-09-14T00:00:00.000 == close pos time: 2023-09-21T00:00:00.000
2024-11-20 23:07:16,794 - INFO - pnl: 2023-09-13T23:59:59.999 123643.12942458801 === -0.813%
2024-11-20 23:07:16,798 - DEBUG - cur time: 2023-09-14T23:59:59.999 == next bar open time: 2023-09-15T00:00:00.000 == close pos time: 2023-09-22T00:00:00.000
2024-11-20 23:07:16,801 - INFO - pnl: 2023-09-14T23:59:59.999 124094.63519140979 === 0.365%
2024-11-20 23:07:16,804 - DEBUG - cur time: 2023-09-15T23:59:59.999 == next bar open time: 2023-09-16T00:00:00.000 == close pos time: 2023-09-23T00:00:00.000
2024-11-20 23:07:16,807 - INFO - pnl: 2023-09-15T23:59:59.999 124153.75855489078 === 0.048%
2024-11-20 23:07:16,813 - DEBUG - cur time: 2023-09-16T23:59:59.999 == next bar open time: 2023-09-17T00:00:00.000 == close pos time: 2023-09-24T00:00:00.000
2024-11-20 23:07:16,815 - INFO - pnl: 2023-09-16T23:59:59.999 123718.21343036115 === -0.351%
2024-11-20 23:07:16,819 - DEBUG - cur time: 2023-09-17T23:59:59.999 == next bar open time: 2023-09-18T00:00:00.000 == close pos time: 2023-09-25T00:00:00.000
2024-11-20 23:07:16,822 - INFO - pnl: 2023-09-17T23:59:59.999 129812.76733288994 === 4.926%
2024-11-20 23:07:16,827 - DEBUG - cur time: 2023-09-18T23:59:59.999 == next bar open time: 2023-09-19T00:00:00.000 == close pos time: 2023-09-26T00:00:00.000
2024-11-20 23:07:16,829 - INFO - pnl: 2023-09-18T23:59:59.999 129126.8950136533 === -0.528%
2024-11-20 23:07:16,834 - DEBUG - cur time: 2023-09-19T23:59:59.999 == next bar open time: 2023-09-20T00:00:00.000 == close pos time: 2023-09-27T00:00:00.000
2024-11-20 23:07:16,845 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ FOOTBALLUSDT ┆ -2.335287    ┆ 0    ┆ 175          │
│ TRBUSDT      ┆ -2.100566    ┆ 1    ┆ 174          │
│ PERPUSDT     ┆ -2.037275    ┆ 2    ┆ 173          │
│ LPTUSDT      ┆ -1.923066    ┆ 3    ┆ 172          │
│ XVSUSDT      ┆ -1.892407    ┆ 4    ┆ 171          │
│ IDUSDT       ┆ -1.805009    ┆ 5    ┆ 170          │
│ RADUSDT      ┆ -1.708884    ┆ 6    ┆ 169          │
│ UNFIUSDT     ┆ -1.706122    ┆ 7    ┆ 168          │
│ EDUUSDT      ┆ -1.676466    ┆ 8    ┆ 167          │
│ MTLUSDT      ┆ -1.652224    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ICXUSDT      ┆ -0.060697    ┆ 166  ┆ 9            │
│ CTKUSDT      ┆ -0.056651    ┆ 167  ┆ 8            │
│ CVXUSDT      ┆ -0.028633    ┆ 168  ┆ 7            │
│ BATUSDT      ┆ 0.053945     ┆ 169  ┆ 6            │
│ FXSUSDT      ┆ 0.117578     ┆ 170  ┆ 5            │
│ RVNUSDT      ┆ 0.139566     ┆ 171  ┆ 4            │
│ CKBUSDT      ┆ 0.369486     ┆ 172  ┆ 3            │
│ DGBUSDT      ┆ 0.520824     ┆ 173  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.986513     ┆ 174  ┆ 1            │
│ DEFIUSDT     ┆ 1.25131      ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:16,853 - WARNING - 2023-09-19T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:16,853 - INFO - cur close time: 2023-09-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:16,853 - DEBUG - mean expected ret (mean factor): -0.791907259334564
2024-11-20 23:07:16,857 - DEBUG - begin to update pos: =========
2024-11-20 23:07:16,858 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,858 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01594     ┆ 0.05763     ┆ 0.0006425   ┆ … ┆ 0.01644 ┆ null   ┆ null    ┆ 0.1826  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,865 - DEBUG - update position: 2023-09-19T23:59:59.999 === diff_trading_value: 235674.83217678254 == cash: 127008.86063215327 
2024-11-20 23:07:16,866 - INFO - pnl: 2023-09-19T23:59:59.999 127008.86063215327 === -1.640%
2024-11-20 23:07:16,870 - DEBUG - cur time: 2023-09-20T23:59:59.999 == next bar open time: 2023-09-21T00:00:00.000 == close pos time: 2023-09-28T00:00:00.000
2024-11-20 23:07:16,871 - INFO - pnl: 2023-09-20T23:59:59.999 126531.46616625242 === -0.376%
2024-11-20 23:07:16,875 - DEBUG - cur time: 2023-09-21T23:59:59.999 == next bar open time: 2023-09-22T00:00:00.000 == close pos time: 2023-09-29T00:00:00.000
2024-11-20 23:07:16,877 - INFO - pnl: 2023-09-21T23:59:59.999 128222.19964638671 === 1.336%
2024-11-20 23:07:16,881 - DEBUG - cur time: 2023-09-22T23:59:59.999 == next bar open time: 2023-09-23T00:00:00.000 == close pos time: 2023-09-30T00:00:00.000
2024-11-20 23:07:16,882 - INFO - pnl: 2023-09-22T23:59:59.999 128158.56948205443 === -0.050%
2024-11-20 23:07:16,886 - DEBUG - cur time: 2023-09-23T23:59:59.999 == next bar open time: 2023-09-24T00:00:00.000 == close pos time: 2023-10-01T00:00:00.000
2024-11-20 23:07:16,888 - INFO - pnl: 2023-09-23T23:59:59.999 127928.42326550111 === -0.180%
2024-11-20 23:07:16,891 - DEBUG - cur time: 2023-09-24T23:59:59.999 == next bar open time: 2023-09-25T00:00:00.000 == close pos time: 2023-10-02T00:00:00.000
2024-11-20 23:07:16,894 - INFO - pnl: 2023-09-24T23:59:59.999 127769.59448506277 === -0.124%
2024-11-20 23:07:16,898 - DEBUG - cur time: 2023-09-25T23:59:59.999 == next bar open time: 2023-09-26T00:00:00.000 == close pos time: 2023-10-03T00:00:00.000
2024-11-20 23:07:16,901 - INFO - pnl: 2023-09-25T23:59:59.999 128434.740541278 === 0.521%
2024-11-20 23:07:16,903 - DEBUG - cur time: 2023-09-26T23:59:59.999 == next bar open time: 2023-09-27T00:00:00.000 == close pos time: 2023-10-04T00:00:00.000
2024-11-20 23:07:16,915 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MKRUSDT      ┆ -1.806724    ┆ 0    ┆ 175          │
│ ONTUSDT      ┆ -1.710904    ┆ 1    ┆ 174          │
│ XVSUSDT      ┆ -1.671134    ┆ 2    ┆ 173          │
│ LPTUSDT      ┆ -1.610687    ┆ 3    ┆ 172          │
│ ARBUSDT      ┆ -1.59748     ┆ 4    ┆ 171          │
│ SUIUSDT      ┆ -1.576382    ┆ 5    ┆ 170          │
│ TOMOUSDT     ┆ -1.568993    ┆ 6    ┆ 169          │
│ KNCUSDT      ┆ -1.565308    ┆ 7    ┆ 168          │
│ OPUSDT       ┆ -1.556124    ┆ 8    ┆ 167          │
│ IDUSDT       ┆ -1.525273    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ QNTUSDT      ┆ -0.042592    ┆ 166  ┆ 9            │
│ IOTXUSDT     ┆ -0.035619    ┆ 167  ┆ 8            │
│ TLMUSDT      ┆ -0.022957    ┆ 168  ┆ 7            │
│ YFIUSDT      ┆ -0.014558    ┆ 169  ┆ 6            │
│ KSMUSDT      ┆ 0.075909     ┆ 170  ┆ 5            │
│ TUSDT        ┆ 0.080145     ┆ 171  ┆ 4            │
│ CKBUSDT      ┆ 0.124395     ┆ 172  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.470723     ┆ 173  ┆ 2            │
│ DGBUSDT      ┆ 0.961022     ┆ 174  ┆ 1            │
│ DEFIUSDT     ┆ 1.247022     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:16,923 - WARNING - 2023-09-26T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:16,923 - INFO - cur close time: 2023-09-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:16,924 - DEBUG - mean expected ret (mean factor): -0.7962997157988622
2024-11-20 23:07:16,928 - DEBUG - begin to update pos: =========
2024-11-20 23:07:16,928 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,929 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01555     ┆ 0.0619      ┆ 0.0006949   ┆ … ┆ 0.01703 ┆ null   ┆ null    ┆ 0.1826  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:16,937 - DEBUG - update position: 2023-09-26T23:59:59.999 === diff_trading_value: 243113.31715664058 == cash: 126271.4754359978 
2024-11-20 23:07:16,939 - INFO - pnl: 2023-09-26T23:59:59.999 126271.4754359978 === -1.684%
2024-11-20 23:07:16,943 - DEBUG - cur time: 2023-09-27T23:59:59.999 == next bar open time: 2023-09-28T00:00:00.000 == close pos time: 2023-10-05T00:00:00.000
2024-11-20 23:07:16,944 - INFO - pnl: 2023-09-27T23:59:59.999 126140.16133766303 === -0.104%
2024-11-20 23:07:16,948 - DEBUG - cur time: 2023-09-28T23:59:59.999 == next bar open time: 2023-09-29T00:00:00.000 == close pos time: 2023-10-06T00:00:00.000
2024-11-20 23:07:16,951 - INFO - pnl: 2023-09-28T23:59:59.999 125761.94735419087 === -0.300%
2024-11-20 23:07:16,955 - DEBUG - cur time: 2023-09-29T23:59:59.999 == next bar open time: 2023-09-30T00:00:00.000 == close pos time: 2023-10-07T00:00:00.000
2024-11-20 23:07:16,957 - INFO - pnl: 2023-09-29T23:59:59.999 125124.22192497585 === -0.507%
2024-11-20 23:07:16,961 - DEBUG - cur time: 2023-09-30T23:59:59.999 == next bar open time: 2023-10-01T00:00:00.000 == close pos time: 2023-10-08T00:00:00.000
2024-11-20 23:07:16,963 - INFO - pnl: 2023-09-30T23:59:59.999 125374.63959586964 === 0.200%
2024-11-20 23:07:16,970 - DEBUG - cur time: 2023-10-01T23:59:59.999 == next bar open time: 2023-10-02T00:00:00.000 == close pos time: 2023-10-09T00:00:00.000
2024-11-20 23:07:16,973 - INFO - pnl: 2023-10-01T23:59:59.999 124333.26885353672 === -0.831%
2024-11-20 23:07:16,979 - DEBUG - cur time: 2023-10-02T23:59:59.999 == next bar open time: 2023-10-03T00:00:00.000 == close pos time: 2023-10-10T00:00:00.000
2024-11-20 23:07:16,982 - INFO - pnl: 2023-10-02T23:59:59.999 122392.74202974261 === -1.561%
2024-11-20 23:07:16,985 - DEBUG - cur time: 2023-10-03T23:59:59.999 == next bar open time: 2023-10-04T00:00:00.000 == close pos time: 2023-10-11T00:00:00.000
2024-11-20 23:07:16,996 - DEBUG - sorted_long_factors: shape: (177, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -1.733415    ┆ 0    ┆ 176          │
│ XMRUSDT      ┆ -1.651289    ┆ 1    ┆ 175          │
│ TOMOUSDT     ┆ -1.619921    ┆ 2    ┆ 174          │
│ LEVERUSDT    ┆ -1.58301     ┆ 3    ┆ 173          │
│ WAVESUSDT    ┆ -1.527138    ┆ 4    ┆ 172          │
│ AMBUSDT      ┆ -1.522579    ┆ 5    ┆ 171          │
│ SUIUSDT      ┆ -1.489856    ┆ 6    ┆ 170          │
│ XVSUSDT      ┆ -1.484312    ┆ 7    ┆ 169          │
│ DYDXUSDT     ┆ -1.461545    ┆ 8    ┆ 168          │
│ ARBUSDT      ┆ -1.45391     ┆ 9    ┆ 167          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ZENUSDT      ┆ 0.111531     ┆ 167  ┆ 9            │
│ ASTRUSDT     ┆ 0.123889     ┆ 168  ┆ 8            │
│ CVXUSDT      ┆ 0.186273     ┆ 169  ┆ 7            │
│ SKLUSDT      ┆ 0.222643     ┆ 170  ┆ 6            │
│ CKBUSDT      ┆ 0.236157     ┆ 171  ┆ 5            │
│ CTKUSDT      ┆ 0.470294     ┆ 172  ┆ 4            │
│ DGBUSDT      ┆ 0.529228     ┆ 173  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.675603     ┆ 174  ┆ 2            │
│ DEFIUSDT     ┆ 0.700324     ┆ 175  ┆ 1            │
│ BNXUSDT      ┆ 1.168539     ┆ 176  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:17,004 - WARNING - 2023-10-03T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:17,004 - INFO - cur close time: 2023-10-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:17,004 - DEBUG - mean expected ret (mean factor): -0.7909005648551657
2024-11-20 23:07:17,010 - DEBUG - begin to update pos: =========
2024-11-20 23:07:17,010 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,011 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01771     ┆ 0.06003     ┆ 0.0007224   ┆ … ┆ 0.01686 ┆ null   ┆ null    ┆ 0.1853  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,019 - DEBUG - update position: 2023-10-03T23:59:59.999 === diff_trading_value: 215200.7155536099 == cash: 124234.96148382714 
2024-11-20 23:07:17,021 - INFO - pnl: 2023-10-03T23:59:59.999 124234.96148382714 === 1.505%
2024-11-20 23:07:17,028 - DEBUG - cur time: 2023-10-04T23:59:59.999 == next bar open time: 2023-10-05T00:00:00.000 == close pos time: 2023-10-12T00:00:00.000
2024-11-20 23:07:17,031 - INFO - pnl: 2023-10-04T23:59:59.999 127599.70789075708 === 2.708%
2024-11-20 23:07:17,037 - DEBUG - cur time: 2023-10-05T23:59:59.999 == next bar open time: 2023-10-06T00:00:00.000 == close pos time: 2023-10-13T00:00:00.000
2024-11-20 23:07:17,040 - INFO - pnl: 2023-10-05T23:59:59.999 127540.73283623565 === -0.046%
2024-11-20 23:07:17,044 - DEBUG - cur time: 2023-10-06T23:59:59.999 == next bar open time: 2023-10-07T00:00:00.000 == close pos time: 2023-10-14T00:00:00.000
2024-11-20 23:07:17,046 - INFO - pnl: 2023-10-06T23:59:59.999 128146.32354482406 === 0.475%
2024-11-20 23:07:17,050 - DEBUG - cur time: 2023-10-07T23:59:59.999 == next bar open time: 2023-10-08T00:00:00.000 == close pos time: 2023-10-15T00:00:00.000
2024-11-20 23:07:17,052 - INFO - pnl: 2023-10-07T23:59:59.999 127401.30000240215 === -0.581%
2024-11-20 23:07:17,058 - DEBUG - cur time: 2023-10-08T23:59:59.999 == next bar open time: 2023-10-09T00:00:00.000 == close pos time: 2023-10-16T00:00:00.000
2024-11-20 23:07:17,060 - INFO - pnl: 2023-10-08T23:59:59.999 129066.2146373752 === 1.307%
2024-11-20 23:07:17,066 - DEBUG - cur time: 2023-10-09T23:59:59.999 == next bar open time: 2023-10-10T00:00:00.000 == close pos time: 2023-10-17T00:00:00.000
2024-11-20 23:07:17,068 - INFO - pnl: 2023-10-09T23:59:59.999 128081.3768083789 === -0.763%
2024-11-20 23:07:17,073 - DEBUG - cur time: 2023-10-10T23:59:59.999 == next bar open time: 2023-10-11T00:00:00.000 == close pos time: 2023-10-18T00:00:00.000
2024-11-20 23:07:17,082 - DEBUG - sorted_long_factors: shape: (179, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -1.917853    ┆ 0    ┆ 178          │
│ RUNEUSDT     ┆ -1.912599    ┆ 1    ┆ 177          │
│ SUIUSDT      ┆ -1.818063    ┆ 2    ┆ 176          │
│ LDOUSDT      ┆ -1.741753    ┆ 3    ┆ 175          │
│ XVSUSDT      ┆ -1.698468    ┆ 4    ┆ 174          │
│ TOMOUSDT     ┆ -1.66756     ┆ 5    ┆ 173          │
│ GMXUSDT      ┆ -1.60884     ┆ 6    ┆ 172          │
│ MKRUSDT      ┆ -1.580208    ┆ 7    ┆ 171          │
│ LQTYUSDT     ┆ -1.571713    ┆ 8    ┆ 170          │
│ WAVESUSDT    ┆ -1.565519    ┆ 9    ┆ 169          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CELRUSDT     ┆ -0.015368    ┆ 169  ┆ 9            │
│ RVNUSDT      ┆ -0.009906    ┆ 170  ┆ 8            │
│ DARUSDT      ┆ 0.175624     ┆ 171  ┆ 7            │
│ CKBUSDT      ┆ 0.37948      ┆ 172  ┆ 6            │
│ DGBUSDT      ┆ 0.394584     ┆ 173  ┆ 5            │
│ CTKUSDT      ┆ 0.458099     ┆ 174  ┆ 4            │
│ ZENUSDT      ┆ 0.476957     ┆ 175  ┆ 3            │
│ SKLUSDT      ┆ 0.493388     ┆ 176  ┆ 2            │
│ DEFIUSDT     ┆ 0.697336     ┆ 177  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.843941     ┆ 178  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:17,089 - WARNING - 2023-10-10T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:17,090 - INFO - cur close time: 2023-10-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:17,090 - DEBUG - mean expected ret (mean factor): -0.797796786228888
2024-11-20 23:07:17,096 - DEBUG - begin to update pos: =========
2024-11-20 23:07:17,096 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,096 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01721     ┆ 0.05758     ┆ 0.0006452   ┆ … ┆ 0.01601 ┆ null   ┆ null    ┆ 0.1911  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,103 - DEBUG - update position: 2023-10-10T23:59:59.999 === diff_trading_value: 158035.02246684898 == cash: 129881.10328315903 
2024-11-20 23:07:17,105 - INFO - pnl: 2023-10-10T23:59:59.999 129881.10328315903 === 1.405%
2024-11-20 23:07:17,111 - DEBUG - cur time: 2023-10-11T23:59:59.999 == next bar open time: 2023-10-12T00:00:00.000 == close pos time: 2023-10-19T00:00:00.000
2024-11-20 23:07:17,114 - INFO - pnl: 2023-10-11T23:59:59.999 129422.59697554441 === -0.353%
2024-11-20 23:07:17,119 - DEBUG - cur time: 2023-10-12T23:59:59.999 == next bar open time: 2023-10-13T00:00:00.000 == close pos time: 2023-10-20T00:00:00.000
2024-11-20 23:07:17,121 - INFO - pnl: 2023-10-12T23:59:59.999 130990.92184206538 === 1.212%
2024-11-20 23:07:17,125 - DEBUG - cur time: 2023-10-13T23:59:59.999 == next bar open time: 2023-10-14T00:00:00.000 == close pos time: 2023-10-21T00:00:00.000
2024-11-20 23:07:17,127 - INFO - pnl: 2023-10-13T23:59:59.999 130544.9187966716 === -0.340%
2024-11-20 23:07:17,131 - DEBUG - cur time: 2023-10-14T23:59:59.999 == next bar open time: 2023-10-15T00:00:00.000 == close pos time: 2023-10-22T00:00:00.000
2024-11-20 23:07:17,135 - INFO - pnl: 2023-10-14T23:59:59.999 129984.25557256823 === -0.429%
2024-11-20 23:07:17,140 - DEBUG - cur time: 2023-10-15T23:59:59.999 == next bar open time: 2023-10-16T00:00:00.000 == close pos time: 2023-10-23T00:00:00.000
2024-11-20 23:07:17,142 - INFO - pnl: 2023-10-15T23:59:59.999 129386.87629836507 === -0.460%
2024-11-20 23:07:17,146 - DEBUG - cur time: 2023-10-16T23:59:59.999 == next bar open time: 2023-10-17T00:00:00.000 == close pos time: 2023-10-24T00:00:00.000
2024-11-20 23:07:17,149 - INFO - pnl: 2023-10-16T23:59:59.999 131116.01596769624 === 1.336%
2024-11-20 23:07:17,153 - DEBUG - cur time: 2023-10-17T23:59:59.999 == next bar open time: 2023-10-18T00:00:00.000 == close pos time: 2023-10-25T00:00:00.000
2024-11-20 23:07:17,163 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -1.920029    ┆ 0    ┆ 179          │
│ APEUSDT      ┆ -1.831874    ┆ 1    ┆ 178          │
│ TOMOUSDT     ┆ -1.754575    ┆ 2    ┆ 177          │
│ FILUSDT      ┆ -1.59493     ┆ 3    ┆ 176          │
│ XVSUSDT      ┆ -1.572088    ┆ 4    ┆ 175          │
│ RNDRUSDT     ┆ -1.536663    ┆ 5    ┆ 174          │
│ DYDXUSDT     ┆ -1.522435    ┆ 6    ┆ 173          │
│ EGLDUSDT     ┆ -1.497011    ┆ 7    ┆ 172          │
│ API3USDT     ┆ -1.475895    ┆ 8    ┆ 171          │
│ EDUUSDT      ┆ -1.442876    ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ FOOTBALLUSDT ┆ 0.018036     ┆ 170  ┆ 9            │
│ CTKUSDT      ┆ 0.050466     ┆ 171  ┆ 8            │
│ SKLUSDT      ┆ 0.058456     ┆ 172  ┆ 7            │
│ DGBUSDT      ┆ 0.253846     ┆ 173  ┆ 6            │
│ CVXUSDT      ┆ 0.254426     ┆ 174  ┆ 5            │
│ RVNUSDT      ┆ 0.269842     ┆ 175  ┆ 4            │
│ CKBUSDT      ┆ 0.399052     ┆ 176  ┆ 3            │
│ TLMUSDT      ┆ 0.401462     ┆ 177  ┆ 2            │
│ DEFIUSDT     ┆ 0.631126     ┆ 178  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.785492     ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:17,172 - WARNING - 2023-10-17T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:17,172 - INFO - cur close time: 2023-10-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:17,173 - DEBUG - mean expected ret (mean factor): -0.7974749069866393
2024-11-20 23:07:17,176 - DEBUG - begin to update pos: =========
2024-11-20 23:07:17,177 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,177 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01804     ┆ 0.05594     ┆ 0.0006351   ┆ … ┆ 0.01683 ┆ null   ┆ null    ┆ 0.253   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,185 - DEBUG - update position: 2023-10-17T23:59:59.999 === diff_trading_value: 220323.32114126094 == cash: 129902.3357820203 
2024-11-20 23:07:17,186 - INFO - pnl: 2023-10-17T23:59:59.999 129902.3357820203 === -0.926%
2024-11-20 23:07:17,190 - DEBUG - cur time: 2023-10-18T23:59:59.999 == next bar open time: 2023-10-19T00:00:00.000 == close pos time: 2023-10-26T00:00:00.000
2024-11-20 23:07:17,192 - INFO - pnl: 2023-10-18T23:59:59.999 128429.9335294502 === -1.133%
2024-11-20 23:07:17,197 - DEBUG - cur time: 2023-10-19T23:59:59.999 == next bar open time: 2023-10-20T00:00:00.000 == close pos time: 2023-10-27T00:00:00.000
2024-11-20 23:07:17,199 - INFO - pnl: 2023-10-19T23:59:59.999 129045.52037698506 === 0.479%
2024-11-20 23:07:17,203 - DEBUG - cur time: 2023-10-20T23:59:59.999 == next bar open time: 2023-10-21T00:00:00.000 == close pos time: 2023-10-28T00:00:00.000
2024-11-20 23:07:17,205 - INFO - pnl: 2023-10-20T23:59:59.999 128310.05377038378 === -0.570%
2024-11-20 23:07:17,209 - DEBUG - cur time: 2023-10-21T23:59:59.999 == next bar open time: 2023-10-22T00:00:00.000 == close pos time: 2023-10-29T00:00:00.000
2024-11-20 23:07:17,211 - INFO - pnl: 2023-10-21T23:59:59.999 129133.93112600473 === 0.642%
2024-11-20 23:07:17,216 - DEBUG - cur time: 2023-10-22T23:59:59.999 == next bar open time: 2023-10-23T00:00:00.000 == close pos time: 2023-10-30T00:00:00.000
2024-11-20 23:07:17,218 - INFO - pnl: 2023-10-22T23:59:59.999 129243.5504971364 === 0.085%
2024-11-20 23:07:17,223 - DEBUG - cur time: 2023-10-23T23:59:59.999 == next bar open time: 2023-10-24T00:00:00.000 == close pos time: 2023-10-31T00:00:00.000
2024-11-20 23:07:17,225 - INFO - pnl: 2023-10-23T23:59:59.999 128255.25399964323 === -0.765%
2024-11-20 23:07:17,230 - DEBUG - cur time: 2023-10-24T23:59:59.999 == next bar open time: 2023-10-25T00:00:00.000 == close pos time: 2023-11-01T00:00:00.000
2024-11-20 23:07:17,241 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SUIUSDT      ┆ -1.802648    ┆ 0    ┆ 179          │
│ COMPUSDT     ┆ -1.698303    ┆ 1    ┆ 178          │
│ APEUSDT      ┆ -1.640746    ┆ 2    ┆ 177          │
│ BNBUSDT      ┆ -1.612904    ┆ 3    ┆ 176          │
│ DYDXUSDT     ┆ -1.55218     ┆ 4    ┆ 175          │
│ UMAUSDT      ┆ -1.536823    ┆ 5    ┆ 174          │
│ MKRUSDT      ┆ -1.528638    ┆ 6    ┆ 173          │
│ OPUSDT       ┆ -1.523552    ┆ 7    ┆ 172          │
│ XVSUSDT      ┆ -1.521765    ┆ 8    ┆ 171          │
│ ARBUSDT      ┆ -1.515565    ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ONEUSDT      ┆ 0.024628     ┆ 170  ┆ 9            │
│ COMBOUSDT    ┆ 0.035295     ┆ 171  ┆ 8            │
│ CTKUSDT      ┆ 0.065835     ┆ 172  ┆ 7            │
│ RVNUSDT      ┆ 0.203724     ┆ 173  ┆ 6            │
│ SKLUSDT      ┆ 0.208226     ┆ 174  ┆ 5            │
│ DGBUSDT      ┆ 0.250635     ┆ 175  ┆ 4            │
│ TLMUSDT      ┆ 0.337843     ┆ 176  ┆ 3            │
│ CKBUSDT      ┆ 0.3794       ┆ 177  ┆ 2            │
│ DEFIUSDT     ┆ 0.622909     ┆ 178  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.793487     ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:17,256 - WARNING - 2023-10-24T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:17,256 - INFO - cur close time: 2023-10-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:17,256 - DEBUG - mean expected ret (mean factor): -0.7860309534507469
2024-11-20 23:07:17,261 - DEBUG - begin to update pos: =========
2024-11-20 23:07:17,262 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,262 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02566     ┆ 0.06062     ┆ 0.0009253   ┆ … ┆ 0.0184  ┆ null   ┆ null    ┆ 0.2363  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,270 - DEBUG - update position: 2023-10-24T23:59:59.999 === diff_trading_value: 248355.67099027586 == cash: 126286.99481982432 
2024-11-20 23:07:17,271 - INFO - pnl: 2023-10-24T23:59:59.999 126286.99481982432 === -1.535%
2024-11-20 23:07:17,276 - DEBUG - cur time: 2023-10-25T23:59:59.999 == next bar open time: 2023-10-26T00:00:00.000 == close pos time: 2023-11-02T00:00:00.000
2024-11-20 23:07:17,279 - INFO - pnl: 2023-10-25T23:59:59.999 126834.80038221573 === 0.434%
2024-11-20 23:07:17,283 - DEBUG - cur time: 2023-10-26T23:59:59.999 == next bar open time: 2023-10-27T00:00:00.000 == close pos time: 2023-11-03T00:00:00.000
2024-11-20 23:07:17,285 - INFO - pnl: 2023-10-26T23:59:59.999 126356.65273481207 === -0.377%
2024-11-20 23:07:17,290 - DEBUG - cur time: 2023-10-27T23:59:59.999 == next bar open time: 2023-10-28T00:00:00.000 == close pos time: 2023-11-04T00:00:00.000
2024-11-20 23:07:17,292 - INFO - pnl: 2023-10-27T23:59:59.999 125245.99275960795 === -0.879%
2024-11-20 23:07:17,296 - DEBUG - cur time: 2023-10-28T23:59:59.999 == next bar open time: 2023-10-29T00:00:00.000 == close pos time: 2023-11-05T00:00:00.000
2024-11-20 23:07:17,298 - INFO - pnl: 2023-10-28T23:59:59.999 125135.52245935427 === -0.088%
2024-11-20 23:07:17,304 - DEBUG - cur time: 2023-10-29T23:59:59.999 == next bar open time: 2023-10-30T00:00:00.000 == close pos time: 2023-11-06T00:00:00.000
2024-11-20 23:07:17,307 - INFO - pnl: 2023-10-29T23:59:59.999 126973.23428210223 === 1.469%
2024-11-20 23:07:17,314 - DEBUG - cur time: 2023-10-30T23:59:59.999 == next bar open time: 2023-10-31T00:00:00.000 == close pos time: 2023-11-07T00:00:00.000
2024-11-20 23:07:17,317 - INFO - pnl: 2023-10-30T23:59:59.999 128547.083232447 === 1.240%
2024-11-20 23:07:17,323 - DEBUG - cur time: 2023-10-31T23:59:59.999 == next bar open time: 2023-11-01T00:00:00.000 == close pos time: 2023-11-08T00:00:00.000
2024-11-20 23:07:17,332 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ZRXUSDT      ┆ -1.78041     ┆ 0    ┆ 179          │
│ MAVUSDT      ┆ -1.496773    ┆ 1    ┆ 178          │
│ BNBUSDT      ┆ -1.489769    ┆ 2    ┆ 177          │
│ BLZUSDT      ┆ -1.48634     ┆ 3    ┆ 176          │
│ MTLUSDT      ┆ -1.484319    ┆ 4    ┆ 175          │
│ RNDRUSDT     ┆ -1.463192    ┆ 5    ┆ 174          │
│ MKRUSDT      ┆ -1.456876    ┆ 6    ┆ 173          │
│ ARBUSDT      ┆ -1.443696    ┆ 7    ┆ 172          │
│ XRPUSDT      ┆ -1.418185    ┆ 8    ┆ 171          │
│ UNIUSDT      ┆ -1.410358    ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ XVSUSDT      ┆ -0.134188    ┆ 170  ┆ 9            │
│ DGBUSDT      ┆ 0.126031     ┆ 171  ┆ 8            │
│ RVNUSDT      ┆ 0.201994     ┆ 172  ┆ 7            │
│ ALICEUSDT    ┆ 0.24042      ┆ 173  ┆ 6            │
│ CTKUSDT      ┆ 0.262937     ┆ 174  ┆ 5            │
│ CVXUSDT      ┆ 0.274922     ┆ 175  ┆ 4            │
│ QNTUSDT      ┆ 0.294551     ┆ 176  ┆ 3            │
│ CKBUSDT      ┆ 0.913151     ┆ 177  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.997433     ┆ 178  ┆ 1            │
│ DEFIUSDT     ┆ 1.420814     ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:17,340 - WARNING - 2023-10-31T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:17,340 - INFO - cur close time: 2023-10-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:17,340 - DEBUG - mean expected ret (mean factor): -0.7686332095032532
2024-11-20 23:07:17,345 - DEBUG - begin to update pos: =========
2024-11-20 23:07:17,345 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬─────────┬──────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT  │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---      │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64      │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆         ┆          │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪═════════╪══════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ -10000.0 │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴─────────┴──────────┘
2024-11-20 23:07:17,345 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03258     ┆ 0.06379     ┆ 0.0011465   ┆ … ┆ 0.01897 ┆ null   ┆ null    ┆ 0.2807  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,353 - DEBUG - update position: 2023-10-31T23:59:59.999 === diff_trading_value: 256223.23365317163 == cash: 128820.96903717516 
2024-11-20 23:07:17,354 - INFO - pnl: 2023-10-31T23:59:59.999 128820.96903717516 === 0.213%
2024-11-20 23:07:17,360 - DEBUG - cur time: 2023-11-01T23:59:59.999 == next bar open time: 2023-11-02T00:00:00.000 == close pos time: 2023-11-09T00:00:00.000
2024-11-20 23:07:17,361 - INFO - pnl: 2023-11-01T23:59:59.999 130727.96910302603 === 1.480%
2024-11-20 23:07:17,366 - DEBUG - cur time: 2023-11-02T23:59:59.999 == next bar open time: 2023-11-03T00:00:00.000 == close pos time: 2023-11-10T00:00:00.000
2024-11-20 23:07:17,368 - INFO - pnl: 2023-11-02T23:59:59.999 132147.4073496054 === 1.086%
2024-11-20 23:07:17,372 - DEBUG - cur time: 2023-11-03T23:59:59.999 == next bar open time: 2023-11-04T00:00:00.000 == close pos time: 2023-11-11T00:00:00.000
2024-11-20 23:07:17,375 - INFO - pnl: 2023-11-03T23:59:59.999 133355.51291766882 === 0.914%
2024-11-20 23:07:17,381 - DEBUG - cur time: 2023-11-04T23:59:59.999 == next bar open time: 2023-11-05T00:00:00.000 == close pos time: 2023-11-12T00:00:00.000
2024-11-20 23:07:17,383 - INFO - pnl: 2023-11-04T23:59:59.999 132701.69705678645 === -0.490%
2024-11-20 23:07:17,387 - DEBUG - cur time: 2023-11-05T23:59:59.999 == next bar open time: 2023-11-06T00:00:00.000 == close pos time: 2023-11-13T00:00:00.000
2024-11-20 23:07:17,389 - INFO - pnl: 2023-11-05T23:59:59.999 134923.5428263748 === 1.674%
2024-11-20 23:07:17,394 - DEBUG - cur time: 2023-11-06T23:59:59.999 == next bar open time: 2023-11-07T00:00:00.000 == close pos time: 2023-11-14T00:00:00.000
2024-11-20 23:07:17,396 - INFO - pnl: 2023-11-06T23:59:59.999 136717.69935065444 === 1.330%
2024-11-20 23:07:17,400 - DEBUG - cur time: 2023-11-07T23:59:59.999 == next bar open time: 2023-11-08T00:00:00.000 == close pos time: 2023-11-15T00:00:00.000
2024-11-20 23:07:17,409 - DEBUG - sorted_long_factors: shape: (184, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT       ┆ -1.916088    ┆ 0    ┆ 183          │
│ UNFIUSDT      ┆ -1.572048    ┆ 1    ┆ 182          │
│ BNBUSDT       ┆ -1.534788    ┆ 2    ┆ 181          │
│ BLURUSDT      ┆ -1.514862    ┆ 3    ┆ 180          │
│ 1000FLOKIUSDT ┆ -1.481138    ┆ 4    ┆ 179          │
│ EDUUSDT       ┆ -1.453358    ┆ 5    ┆ 178          │
│ 1000PEPEUSDT  ┆ -1.437986    ┆ 6    ┆ 177          │
│ API3USDT      ┆ -1.417627    ┆ 7    ┆ 176          │
│ DASHUSDT      ┆ -1.38832     ┆ 8    ┆ 175          │
│ MATICUSDT     ┆ -1.349918    ┆ 9    ┆ 174          │
│ …             ┆ …            ┆ …    ┆ …            │
│ CTKUSDT       ┆ -0.011003    ┆ 174  ┆ 9            │
│ ATAUSDT       ┆ 0.002707     ┆ 175  ┆ 8            │
│ IOTXUSDT      ┆ 0.005307     ┆ 176  ┆ 7            │
│ DENTUSDT      ┆ 0.037949     ┆ 177  ┆ 6            │
│ QNTUSDT       ┆ 0.04756      ┆ 178  ┆ 5            │
│ RVNUSDT       ┆ 0.116078     ┆ 179  ┆ 4            │
│ CKBUSDT       ┆ 0.33785      ┆ 180  ┆ 3            │
│ BTCDOMUSDT    ┆ 0.352605     ┆ 181  ┆ 2            │
│ BLUEBIRDUSDT  ┆ 1.469943     ┆ 182  ┆ 1            │
│ DEFIUSDT      ┆ 1.752065     ┆ 183  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:17,417 - WARNING - 2023-11-07T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:17,417 - INFO - cur close time: 2023-11-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:17,418 - DEBUG - mean expected ret (mean factor): -0.7705668311623292
2024-11-20 23:07:17,422 - DEBUG - begin to update pos: =========
2024-11-20 23:07:17,423 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,423 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0305      ┆ 0.06633     ┆ 0.0011661   ┆ … ┆ 0.02065 ┆ null   ┆ null    ┆ 0.2797  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,432 - DEBUG - update position: 2023-11-07T23:59:59.999 === diff_trading_value: 288184.8549855463 == cash: 135612.71310069555 
2024-11-20 23:07:17,433 - INFO - pnl: 2023-11-07T23:59:59.999 135612.71310069555 === -0.808%
2024-11-20 23:07:17,438 - DEBUG - cur time: 2023-11-08T23:59:59.999 == next bar open time: 2023-11-09T00:00:00.000 == close pos time: 2023-11-16T00:00:00.000
2024-11-20 23:07:17,442 - INFO - pnl: 2023-11-08T23:59:59.999 138909.08538872504 === 2.431%
2024-11-20 23:07:17,447 - DEBUG - cur time: 2023-11-09T23:59:59.999 == next bar open time: 2023-11-10T00:00:00.000 == close pos time: 2023-11-17T00:00:00.000
2024-11-20 23:07:17,449 - INFO - pnl: 2023-11-09T23:59:59.999 138501.51910912027 === -0.293%
2024-11-20 23:07:17,453 - DEBUG - cur time: 2023-11-10T23:59:59.999 == next bar open time: 2023-11-11T00:00:00.000 == close pos time: 2023-11-18T00:00:00.000
2024-11-20 23:07:17,455 - INFO - pnl: 2023-11-10T23:59:59.999 139582.8763930005 === 0.781%
2024-11-20 23:07:17,459 - DEBUG - cur time: 2023-11-11T23:59:59.999 == next bar open time: 2023-11-12T00:00:00.000 == close pos time: 2023-11-19T00:00:00.000
2024-11-20 23:07:17,462 - INFO - pnl: 2023-11-11T23:59:59.999 141202.08752195037 === 1.160%
2024-11-20 23:07:17,466 - DEBUG - cur time: 2023-11-12T23:59:59.999 == next bar open time: 2023-11-13T00:00:00.000 == close pos time: 2023-11-20T00:00:00.000
2024-11-20 23:07:17,468 - INFO - pnl: 2023-11-12T23:59:59.999 142394.85066729638 === 0.845%
2024-11-20 23:07:17,471 - DEBUG - cur time: 2023-11-13T23:59:59.999 == next bar open time: 2023-11-14T00:00:00.000 == close pos time: 2023-11-21T00:00:00.000
2024-11-20 23:07:17,473 - INFO - pnl: 2023-11-13T23:59:59.999 137220.6819672751 === -3.634%
2024-11-20 23:07:17,477 - DEBUG - cur time: 2023-11-14T23:59:59.999 == next bar open time: 2023-11-15T00:00:00.000 == close pos time: 2023-11-22T00:00:00.000
2024-11-20 23:07:17,486 - DEBUG - sorted_long_factors: shape: (184, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT      ┆ -1.850541    ┆ 0    ┆ 183          │
│ ARKMUSDT     ┆ -1.815191    ┆ 1    ┆ 182          │
│ MKRUSDT      ┆ -1.798579    ┆ 2    ┆ 181          │
│ UNFIUSDT     ┆ -1.7946      ┆ 3    ┆ 180          │
│ WLDUSDT      ┆ -1.573194    ┆ 4    ┆ 179          │
│ YFIUSDT      ┆ -1.560051    ┆ 5    ┆ 178          │
│ COMPUSDT     ┆ -1.553874    ┆ 6    ┆ 177          │
│ MATICUSDT    ┆ -1.531012    ┆ 7    ┆ 176          │
│ BNBUSDT      ┆ -1.491878    ┆ 8    ┆ 175          │
│ LPTUSDT      ┆ -1.465083    ┆ 9    ┆ 174          │
│ …            ┆ …            ┆ …    ┆ …            │
│ GALUSDT      ┆ -0.073081    ┆ 174  ┆ 9            │
│ TLMUSDT      ┆ -0.044473    ┆ 175  ┆ 8            │
│ ATAUSDT      ┆ -0.004544    ┆ 176  ┆ 7            │
│ BALUSDT      ┆ 0.067344     ┆ 177  ┆ 6            │
│ CKBUSDT      ┆ 0.09477      ┆ 178  ┆ 5            │
│ TRUUSDT      ┆ 0.143379     ┆ 179  ┆ 4            │
│ CVXUSDT      ┆ 0.164553     ┆ 180  ┆ 3            │
│ DGBUSDT      ┆ 0.184425     ┆ 181  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.212123     ┆ 182  ┆ 1            │
│ DEFIUSDT     ┆ 1.759883     ┆ 183  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:17,494 - WARNING - 2023-11-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:17,494 - INFO - cur close time: 2023-11-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:17,494 - DEBUG - mean expected ret (mean factor): -0.752441072125303
2024-11-20 23:07:17,499 - DEBUG - begin to update pos: =========
2024-11-20 23:07:17,499 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,500 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03335     ┆ 0.07783     ┆ 0.0011521   ┆ … ┆ 0.02098 ┆ null   ┆ null    ┆ 0.5232  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,507 - DEBUG - update position: 2023-11-14T23:59:59.999 === diff_trading_value: 220432.11001727768 == cash: 135751.15565743018 
2024-11-20 23:07:17,509 - INFO - pnl: 2023-11-14T23:59:59.999 135751.15565743018 === -1.071%
2024-11-20 23:07:17,513 - DEBUG - cur time: 2023-11-15T23:59:59.999 == next bar open time: 2023-11-16T00:00:00.000 == close pos time: 2023-11-23T00:00:00.000
2024-11-20 23:07:17,515 - INFO - pnl: 2023-11-15T23:59:59.999 134835.35255896614 === -0.675%
2024-11-20 23:07:17,518 - DEBUG - cur time: 2023-11-16T23:59:59.999 == next bar open time: 2023-11-17T00:00:00.000 == close pos time: 2023-11-24T00:00:00.000
2024-11-20 23:07:17,519 - INFO - pnl: 2023-11-16T23:59:59.999 134078.36694832402 === -0.561%
2024-11-20 23:07:17,523 - DEBUG - cur time: 2023-11-17T23:59:59.999 == next bar open time: 2023-11-18T00:00:00.000 == close pos time: 2023-11-25T00:00:00.000
2024-11-20 23:07:17,525 - INFO - pnl: 2023-11-17T23:59:59.999 135635.37507502444 === 1.161%
2024-11-20 23:07:17,528 - DEBUG - cur time: 2023-11-18T23:59:59.999 == next bar open time: 2023-11-19T00:00:00.000 == close pos time: 2023-11-26T00:00:00.000
2024-11-20 23:07:17,530 - INFO - pnl: 2023-11-18T23:59:59.999 139012.04012715645 === 2.490%
2024-11-20 23:07:17,535 - DEBUG - cur time: 2023-11-19T23:59:59.999 == next bar open time: 2023-11-20T00:00:00.000 == close pos time: 2023-11-27T00:00:00.000
2024-11-20 23:07:17,537 - INFO - pnl: 2023-11-19T23:59:59.999 140948.7686973523 === 1.393%
2024-11-20 23:07:17,541 - DEBUG - cur time: 2023-11-20T23:59:59.999 == next bar open time: 2023-11-21T00:00:00.000 == close pos time: 2023-11-28T00:00:00.000
2024-11-20 23:07:17,542 - INFO - pnl: 2023-11-20T23:59:59.999 146159.82373002058 === 3.697%
2024-11-20 23:07:17,546 - DEBUG - cur time: 2023-11-21T23:59:59.999 == next bar open time: 2023-11-22T00:00:00.000 == close pos time: 2023-11-29T00:00:00.000
2024-11-20 23:07:17,556 - DEBUG - sorted_long_factors: shape: (187, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNTUSDT      ┆ -2.068116    ┆ 0    ┆ 186          │
│ BNBUSDT      ┆ -1.840023    ┆ 1    ┆ 185          │
│ WLDUSDT      ┆ -1.796417    ┆ 2    ┆ 184          │
│ ARKMUSDT     ┆ -1.641577    ┆ 3    ┆ 183          │
│ APEUSDT      ┆ -1.554058    ┆ 4    ┆ 182          │
│ MASKUSDT     ┆ -1.498444    ┆ 5    ┆ 181          │
│ XRPUSDT      ┆ -1.490216    ┆ 6    ┆ 180          │
│ YFIUSDT      ┆ -1.484693    ┆ 7    ┆ 179          │
│ MKRUSDT      ┆ -1.388221    ┆ 8    ┆ 178          │
│ SUSHIUSDT    ┆ -1.330501    ┆ 9    ┆ 177          │
│ …            ┆ …            ┆ …    ┆ …            │
│ XVGUSDT      ┆ -0.009512    ┆ 177  ┆ 9            │
│ CVXUSDT      ┆ 0.024056     ┆ 178  ┆ 8            │
│ TLMUSDT      ┆ 0.025888     ┆ 179  ┆ 7            │
│ CTSIUSDT     ┆ 0.031867     ┆ 180  ┆ 6            │
│ ATAUSDT      ┆ 0.042666     ┆ 181  ┆ 5            │
│ SPELLUSDT    ┆ 0.123127     ┆ 182  ┆ 4            │
│ CTKUSDT      ┆ 0.260011     ┆ 183  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.296431     ┆ 184  ┆ 2            │
│ IDEXUSDT     ┆ 1.045431     ┆ 185  ┆ 1            │
│ DEFIUSDT     ┆ 1.717748     ┆ 186  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:17,564 - WARNING - 2023-11-21T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:17,564 - INFO - cur close time: 2023-11-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:17,564 - DEBUG - mean expected ret (mean factor): -0.7586149304548948
2024-11-20 23:07:17,569 - DEBUG - begin to update pos: =========
2024-11-20 23:07:17,569 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,570 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02927     ┆ 0.0692      ┆ 0.0010339   ┆ … ┆ 0.01953 ┆ null   ┆ null    ┆ 0.3704  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,583 - DEBUG - update position: 2023-11-21T23:59:59.999 === diff_trading_value: 190271.56642817185 == cash: 142786.10452070742 
2024-11-20 23:07:17,584 - INFO - pnl: 2023-11-21T23:59:59.999 142786.10452070742 === -2.308%
2024-11-20 23:07:17,590 - DEBUG - cur time: 2023-11-22T23:59:59.999 == next bar open time: 2023-11-23T00:00:00.000 == close pos time: 2023-11-30T00:00:00.000
2024-11-20 23:07:17,593 - INFO - pnl: 2023-11-22T23:59:59.999 142277.94683350893 === -0.356%
2024-11-20 23:07:17,597 - DEBUG - cur time: 2023-11-23T23:59:59.999 == next bar open time: 2023-11-24T00:00:00.000 == close pos time: 2023-12-01T00:00:00.000
2024-11-20 23:07:17,599 - INFO - pnl: 2023-11-23T23:59:59.999 143810.59844386345 === 1.077%
2024-11-20 23:07:17,603 - DEBUG - cur time: 2023-11-24T23:59:59.999 == next bar open time: 2023-11-25T00:00:00.000 == close pos time: 2023-12-02T00:00:00.000
2024-11-20 23:07:17,606 - INFO - pnl: 2023-11-24T23:59:59.999 146026.80904222577 === 1.541%
2024-11-20 23:07:17,610 - DEBUG - cur time: 2023-11-25T23:59:59.999 == next bar open time: 2023-11-26T00:00:00.000 == close pos time: 2023-12-03T00:00:00.000
2024-11-20 23:07:17,611 - INFO - pnl: 2023-11-25T23:59:59.999 143703.68244268678 === -1.591%
2024-11-20 23:07:17,618 - DEBUG - cur time: 2023-11-26T23:59:59.999 == next bar open time: 2023-11-27T00:00:00.000 == close pos time: 2023-12-04T00:00:00.000
2024-11-20 23:07:17,620 - INFO - pnl: 2023-11-26T23:59:59.999 148039.73215421126 === 3.017%
2024-11-20 23:07:17,625 - DEBUG - cur time: 2023-11-27T23:59:59.999 == next bar open time: 2023-11-28T00:00:00.000 == close pos time: 2023-12-05T00:00:00.000
2024-11-20 23:07:17,627 - INFO - pnl: 2023-11-27T23:59:59.999 146763.58745560198 === -0.862%
2024-11-20 23:07:17,634 - DEBUG - cur time: 2023-11-28T23:59:59.999 == next bar open time: 2023-11-29T00:00:00.000 == close pos time: 2023-12-06T00:00:00.000
2024-11-20 23:07:17,649 - DEBUG - sorted_long_factors: shape: (188, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT    ┆ -2.234308    ┆ 0    ┆ 187          │
│ YFIUSDT    ┆ -2.030121    ┆ 1    ┆ 186          │
│ UNFIUSDT   ┆ -2.005145    ┆ 2    ┆ 185          │
│ NEARUSDT   ┆ -1.785461    ┆ 3    ┆ 184          │
│ MASKUSDT   ┆ -1.736405    ┆ 4    ┆ 183          │
│ BTCDOMUSDT ┆ -1.6248      ┆ 5    ┆ 182          │
│ NMRUSDT    ┆ -1.619906    ┆ 6    ┆ 181          │
│ SEIUSDT    ┆ -1.598437    ┆ 7    ┆ 180          │
│ MINAUSDT   ┆ -1.593402    ┆ 8    ┆ 179          │
│ QTUMUSDT   ┆ -1.581922    ┆ 9    ┆ 178          │
│ …          ┆ …            ┆ …    ┆ …            │
│ CTKUSDT    ┆ 0.030647     ┆ 178  ┆ 9            │
│ FXSUSDT    ┆ 0.032253     ┆ 179  ┆ 8            │
│ IDEXUSDT   ┆ 0.204626     ┆ 180  ┆ 7            │
│ TUSDT      ┆ 0.242337     ┆ 181  ┆ 6            │
│ DENTUSDT   ┆ 0.274342     ┆ 182  ┆ 5            │
│ BALUSDT    ┆ 0.309049     ┆ 183  ┆ 4            │
│ DGBUSDT    ┆ 0.588523     ┆ 184  ┆ 3            │
│ CKBUSDT    ┆ 0.722688     ┆ 185  ┆ 2            │
│ CVXUSDT    ┆ 1.038195     ┆ 186  ┆ 1            │
│ DEFIUSDT   ┆ 2.17263      ┆ 187  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:17,665 - WARNING - 2023-11-28T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:17,665 - INFO - cur close time: 2023-11-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:17,666 - DEBUG - mean expected ret (mean factor): -0.7634003873337729
2024-11-20 23:07:17,672 - DEBUG - begin to update pos: =========
2024-11-20 23:07:17,672 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,673 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03202     ┆ 0.11977     ┆ 0.001095    ┆ … ┆ 0.02081 ┆ null   ┆ null    ┆ 0.3965  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,681 - DEBUG - update position: 2023-11-28T23:59:59.999 === diff_trading_value: 260339.6963428693 == cash: 147384.3160896646 
2024-11-20 23:07:17,684 - INFO - pnl: 2023-11-28T23:59:59.999 147384.3160896646 === 0.423%
2024-11-20 23:07:17,689 - DEBUG - cur time: 2023-11-29T23:59:59.999 == next bar open time: 2023-11-30T00:00:00.000 == close pos time: 2023-12-07T00:00:00.000
2024-11-20 23:07:17,692 - INFO - pnl: 2023-11-29T23:59:59.999 150195.4929828077 === 1.907%
2024-11-20 23:07:17,698 - DEBUG - cur time: 2023-11-30T23:59:59.999 == next bar open time: 2023-12-01T00:00:00.000 == close pos time: 2023-12-08T00:00:00.000
2024-11-20 23:07:17,701 - INFO - pnl: 2023-11-30T23:59:59.999 150721.77159550792 === 0.350%
2024-11-20 23:07:17,705 - DEBUG - cur time: 2023-12-01T23:59:59.999 == next bar open time: 2023-12-02T00:00:00.000 == close pos time: 2023-12-09T00:00:00.000
2024-11-20 23:07:17,707 - INFO - pnl: 2023-12-01T23:59:59.999 150821.69059025712 === 0.066%
2024-11-20 23:07:17,711 - DEBUG - cur time: 2023-12-02T23:59:59.999 == next bar open time: 2023-12-03T00:00:00.000 == close pos time: 2023-12-10T00:00:00.000
2024-11-20 23:07:17,714 - INFO - pnl: 2023-12-02T23:59:59.999 151924.27151163254 === 0.731%
2024-11-20 23:07:17,718 - DEBUG - cur time: 2023-12-03T23:59:59.999 == next bar open time: 2023-12-04T00:00:00.000 == close pos time: 2023-12-11T00:00:00.000
2024-11-20 23:07:17,720 - INFO - pnl: 2023-12-03T23:59:59.999 153281.08734174457 === 0.893%
2024-11-20 23:07:17,723 - DEBUG - cur time: 2023-12-04T23:59:59.999 == next bar open time: 2023-12-05T00:00:00.000 == close pos time: 2023-12-12T00:00:00.000
2024-11-20 23:07:17,725 - INFO - pnl: 2023-12-04T23:59:59.999 157398.64835619804 === 2.686%
2024-11-20 23:07:17,731 - DEBUG - cur time: 2023-12-05T23:59:59.999 == next bar open time: 2023-12-06T00:00:00.000 == close pos time: 2023-12-13T00:00:00.000
2024-11-20 23:07:17,743 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ATOMUSDT     ┆ -1.729474    ┆ 0    ┆ 188          │
│ CYBERUSDT    ┆ -1.726082    ┆ 1    ┆ 187          │
│ SNXUSDT      ┆ -1.7051      ┆ 2    ┆ 186          │
│ AXSUSDT      ┆ -1.697439    ┆ 3    ┆ 185          │
│ NEOUSDT      ┆ -1.688673    ┆ 4    ┆ 184          │
│ UNIUSDT      ┆ -1.674773    ┆ 5    ┆ 183          │
│ NEARUSDT     ┆ -1.647194    ┆ 6    ┆ 182          │
│ MDTUSDT      ┆ -1.632567    ┆ 7    ┆ 181          │
│ HOOKUSDT     ┆ -1.559538    ┆ 8    ┆ 180          │
│ WLDUSDT      ┆ -1.551431    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TUSDT        ┆ -0.028396    ┆ 179  ┆ 9            │
│ CTKUSDT      ┆ -0.016901    ┆ 180  ┆ 8            │
│ FOOTBALLUSDT ┆ -0.008504    ┆ 181  ┆ 7            │
│ IDEXUSDT     ┆ 0.042454     ┆ 182  ┆ 6            │
│ CVXUSDT      ┆ 0.077439     ┆ 183  ┆ 5            │
│ ATAUSDT      ┆ 0.08736      ┆ 184  ┆ 4            │
│ DGBUSDT      ┆ 0.554896     ┆ 185  ┆ 3            │
│ DEFIUSDT     ┆ 0.836445     ┆ 186  ┆ 2            │
│ CKBUSDT      ┆ 0.881203     ┆ 187  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.666165     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:17,751 - WARNING - 2023-12-05T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:17,751 - INFO - cur close time: 2023-12-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:17,753 - DEBUG - mean expected ret (mean factor): -0.7699201381971635
2024-11-20 23:07:17,757 - DEBUG - begin to update pos: =========
2024-11-20 23:07:17,758 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,758 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.04247     ┆ 0.22541     ┆ 0.0016203   ┆ … ┆ 0.0234  ┆ null   ┆ null    ┆ 0.4182  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,766 - DEBUG - update position: 2023-12-05T23:59:59.999 === diff_trading_value: 268574.9874844991 == cash: 155623.30515053935 
2024-11-20 23:07:17,767 - INFO - pnl: 2023-12-05T23:59:59.999 155623.30515053935 === -1.128%
2024-11-20 23:07:17,771 - DEBUG - cur time: 2023-12-06T23:59:59.999 == next bar open time: 2023-12-07T00:00:00.000 == close pos time: 2023-12-14T00:00:00.000
2024-11-20 23:07:17,773 - INFO - pnl: 2023-12-06T23:59:59.999 158244.3265128517 === 1.684%
2024-11-20 23:07:17,778 - DEBUG - cur time: 2023-12-07T23:59:59.999 == next bar open time: 2023-12-08T00:00:00.000 == close pos time: 2023-12-15T00:00:00.000
2024-11-20 23:07:17,781 - INFO - pnl: 2023-12-07T23:59:59.999 157102.4637202239 === -0.722%
2024-11-20 23:07:17,786 - DEBUG - cur time: 2023-12-08T23:59:59.999 == next bar open time: 2023-12-09T00:00:00.000 == close pos time: 2023-12-16T00:00:00.000
2024-11-20 23:07:17,789 - INFO - pnl: 2023-12-08T23:59:59.999 157268.49696086787 === 0.106%
2024-11-20 23:07:17,793 - DEBUG - cur time: 2023-12-09T23:59:59.999 == next bar open time: 2023-12-10T00:00:00.000 == close pos time: 2023-12-17T00:00:00.000
2024-11-20 23:07:17,795 - INFO - pnl: 2023-12-09T23:59:59.999 156941.9533982018 === -0.208%
2024-11-20 23:07:17,801 - DEBUG - cur time: 2023-12-10T23:59:59.999 == next bar open time: 2023-12-11T00:00:00.000 == close pos time: 2023-12-18T00:00:00.000
2024-11-20 23:07:17,805 - INFO - pnl: 2023-12-10T23:59:59.999 154663.7058303755 === -1.452%
2024-11-20 23:07:17,810 - DEBUG - cur time: 2023-12-11T23:59:59.999 == next bar open time: 2023-12-12T00:00:00.000 == close pos time: 2023-12-19T00:00:00.000
2024-11-20 23:07:17,812 - INFO - pnl: 2023-12-11T23:59:59.999 156235.63173794845 === 1.016%
2024-11-20 23:07:17,817 - DEBUG - cur time: 2023-12-12T23:59:59.999 == next bar open time: 2023-12-13T00:00:00.000 == close pos time: 2023-12-20T00:00:00.000
2024-11-20 23:07:17,828 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ UNIUSDT      ┆ -1.880239    ┆ 0    ┆ 188          │
│ BNBUSDT      ┆ -1.819278    ┆ 1    ┆ 187          │
│ DOTUSDT      ┆ -1.801947    ┆ 2    ┆ 186          │
│ EOSUSDT      ┆ -1.708035    ┆ 3    ┆ 185          │
│ NEARUSDT     ┆ -1.663618    ┆ 4    ┆ 184          │
│ MASKUSDT     ┆ -1.652304    ┆ 5    ┆ 183          │
│ INJUSDT      ┆ -1.646943    ┆ 6    ┆ 182          │
│ YFIUSDT      ┆ -1.63498     ┆ 7    ┆ 181          │
│ CYBERUSDT    ┆ -1.627153    ┆ 8    ┆ 180          │
│ SSVUSDT      ┆ -1.601378    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ QNTUSDT      ┆ -0.048504    ┆ 179  ┆ 9            │
│ RSRUSDT      ┆ -0.019233    ┆ 180  ┆ 8            │
│ DUSKUSDT     ┆ 0.070015     ┆ 181  ┆ 7            │
│ TRUUSDT      ┆ 0.119693     ┆ 182  ┆ 6            │
│ DGBUSDT      ┆ 0.376086     ┆ 183  ┆ 5            │
│ UNFIUSDT     ┆ 0.404041     ┆ 184  ┆ 4            │
│ CVXUSDT      ┆ 0.418417     ┆ 185  ┆ 3            │
│ CKBUSDT      ┆ 0.465103     ┆ 186  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.273135     ┆ 187  ┆ 1            │
│ DEFIUSDT     ┆ 1.549278     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:17,837 - WARNING - 2023-12-12T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:17,837 - INFO - cur close time: 2023-12-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:17,838 - DEBUG - mean expected ret (mean factor): -0.7649608357710912
2024-11-20 23:07:17,842 - DEBUG - begin to update pos: =========
2024-11-20 23:07:17,843 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,843 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03829     ┆ 0.17667     ┆ 0.0013973   ┆ … ┆ 0.02359 ┆ null   ┆ null    ┆ 0.373   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,850 - DEBUG - update position: 2023-12-12T23:59:59.999 === diff_trading_value: 257043.75015040743 == cash: 154250.7148249504 
2024-11-20 23:07:17,851 - INFO - pnl: 2023-12-12T23:59:59.999 154250.7148249504 === -1.270%
2024-11-20 23:07:17,854 - DEBUG - cur time: 2023-12-13T23:59:59.999 == next bar open time: 2023-12-14T00:00:00.000 == close pos time: 2023-12-21T00:00:00.000
2024-11-20 23:07:17,856 - INFO - pnl: 2023-12-13T23:59:59.999 153207.0780235757 === -0.677%
2024-11-20 23:07:17,860 - DEBUG - cur time: 2023-12-14T23:59:59.999 == next bar open time: 2023-12-15T00:00:00.000 == close pos time: 2023-12-22T00:00:00.000
2024-11-20 23:07:17,861 - INFO - pnl: 2023-12-14T23:59:59.999 153624.09285047936 === 0.272%
2024-11-20 23:07:17,866 - DEBUG - cur time: 2023-12-15T23:59:59.999 == next bar open time: 2023-12-16T00:00:00.000 == close pos time: 2023-12-23T00:00:00.000
2024-11-20 23:07:17,868 - INFO - pnl: 2023-12-15T23:59:59.999 155260.27779020046 === 1.065%
2024-11-20 23:07:17,872 - DEBUG - cur time: 2023-12-16T23:59:59.999 == next bar open time: 2023-12-17T00:00:00.000 == close pos time: 2023-12-24T00:00:00.000
2024-11-20 23:07:17,873 - INFO - pnl: 2023-12-16T23:59:59.999 154825.98985296045 === -0.280%
2024-11-20 23:07:17,878 - DEBUG - cur time: 2023-12-17T23:59:59.999 == next bar open time: 2023-12-18T00:00:00.000 == close pos time: 2023-12-25T00:00:00.000
2024-11-20 23:07:17,880 - INFO - pnl: 2023-12-17T23:59:59.999 155318.62586752858 === 0.318%
2024-11-20 23:07:17,884 - DEBUG - cur time: 2023-12-18T23:59:59.999 == next bar open time: 2023-12-19T00:00:00.000 == close pos time: 2023-12-26T00:00:00.000
2024-11-20 23:07:17,886 - INFO - pnl: 2023-12-18T23:59:59.999 151543.66126563217 === -2.430%
2024-11-20 23:07:17,891 - DEBUG - cur time: 2023-12-19T23:59:59.999 == next bar open time: 2023-12-20T00:00:00.000 == close pos time: 2023-12-27T00:00:00.000
2024-11-20 23:07:17,903 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XVSUSDT      ┆ -1.821763    ┆ 0    ┆ 188          │
│ MASKUSDT     ┆ -1.672818    ┆ 1    ┆ 187          │
│ WAVESUSDT    ┆ -1.655897    ┆ 2    ┆ 186          │
│ LUNA2USDT    ┆ -1.642093    ┆ 3    ┆ 185          │
│ LPTUSDT      ┆ -1.611824    ┆ 4    ┆ 184          │
│ ARKMUSDT     ┆ -1.509666    ┆ 5    ┆ 183          │
│ SEIUSDT      ┆ -1.506267    ┆ 6    ┆ 182          │
│ AAVEUSDT     ┆ -1.479856    ┆ 7    ┆ 181          │
│ BANDUSDT     ┆ -1.473398    ┆ 8    ┆ 180          │
│ 1000LUNCUSDT ┆ -1.462469    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IMXUSDT      ┆ 0.041637     ┆ 179  ┆ 9            │
│ RLCUSDT      ┆ 0.073909     ┆ 180  ┆ 8            │
│ XVGUSDT      ┆ 0.14212      ┆ 181  ┆ 7            │
│ TRUUSDT      ┆ 0.198574     ┆ 182  ┆ 6            │
│ CVXUSDT      ┆ 0.236654     ┆ 183  ┆ 5            │
│ ZENUSDT      ┆ 0.265747     ┆ 184  ┆ 4            │
│ DGBUSDT      ┆ 0.449603     ┆ 185  ┆ 3            │
│ CKBUSDT      ┆ 0.7205       ┆ 186  ┆ 2            │
│ DEFIUSDT     ┆ 0.773992     ┆ 187  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.181573     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:17,911 - INFO - cur close time: 2023-12-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:17,912 - DEBUG - mean expected ret (mean factor): -0.7700574763641768
2024-11-20 23:07:17,918 - DEBUG - begin to update pos: =========
2024-11-20 23:07:17,919 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,919 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03411     ┆ 0.16116     ┆ 0.0012483   ┆ … ┆ 0.02249 ┆ null   ┆ null    ┆ 0.3677  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:17,927 - DEBUG - update position: 2023-12-19T23:59:59.999 === diff_trading_value: 274160.75169906905 == cash: 149689.66664505785 
2024-11-20 23:07:17,928 - INFO - pnl: 2023-12-19T23:59:59.999 149689.66664505785 === -1.223%
2024-11-20 23:07:17,934 - DEBUG - cur time: 2023-12-20T23:59:59.999 == next bar open time: 2023-12-21T00:00:00.000 == close pos time: 2023-12-28T00:00:00.000
2024-11-20 23:07:17,936 - INFO - pnl: 2023-12-20T23:59:59.999 149800.38758605038 === 0.074%
2024-11-20 23:07:17,942 - DEBUG - cur time: 2023-12-21T23:59:59.999 == next bar open time: 2023-12-22T00:00:00.000 == close pos time: 2023-12-29T00:00:00.000
2024-11-20 23:07:17,944 - INFO - pnl: 2023-12-21T23:59:59.999 151527.56881401967 === 1.153%
2024-11-20 23:07:17,949 - DEBUG - cur time: 2023-12-22T23:59:59.999 == next bar open time: 2023-12-23T00:00:00.000 == close pos time: 2023-12-30T00:00:00.000
2024-11-20 23:07:17,951 - INFO - pnl: 2023-12-22T23:59:59.999 156062.31148927225 === 2.993%
2024-11-20 23:07:17,956 - DEBUG - cur time: 2023-12-23T23:59:59.999 == next bar open time: 2023-12-24T00:00:00.000 == close pos time: 2023-12-31T00:00:00.000
2024-11-20 23:07:17,958 - INFO - pnl: 2023-12-23T23:59:59.999 156666.43117675433 === 0.387%
2024-11-20 23:07:17,962 - DEBUG - cur time: 2023-12-24T23:59:59.999 == next bar open time: 2023-12-25T00:00:00.000 == close pos time: 2024-01-01T00:00:00.000
2024-11-20 23:07:17,964 - INFO - pnl: 2023-12-24T23:59:59.999 159163.49584839618 === 1.594%
2024-11-20 23:07:17,969 - DEBUG - cur time: 2023-12-25T23:59:59.999 == next bar open time: 2023-12-26T00:00:00.000 == close pos time: 2024-01-02T00:00:00.000
2024-11-20 23:07:17,971 - INFO - pnl: 2023-12-25T23:59:59.999 157449.54152952597 === -1.077%
2024-11-20 23:07:17,975 - DEBUG - cur time: 2023-12-26T23:59:59.999 == next bar open time: 2023-12-27T00:00:00.000 == close pos time: 2024-01-03T00:00:00.000
2024-11-20 23:07:17,986 - DEBUG - sorted_long_factors: shape: (190, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CYBERUSDT    ┆ -2.05845     ┆ 0    ┆ 189          │
│ AAVEUSDT     ┆ -1.758844    ┆ 1    ┆ 188          │
│ APTUSDT      ┆ -1.596049    ┆ 2    ┆ 187          │
│ RNDRUSDT     ┆ -1.511014    ┆ 3    ┆ 186          │
│ SANDUSDT     ┆ -1.493225    ┆ 4    ┆ 185          │
│ UNIUSDT      ┆ -1.490554    ┆ 5    ┆ 184          │
│ COMPUSDT     ┆ -1.488158    ┆ 6    ┆ 183          │
│ DYDXUSDT     ┆ -1.4881      ┆ 7    ┆ 182          │
│ ENSUSDT      ┆ -1.481356    ┆ 8    ┆ 181          │
│ SEIUSDT      ┆ -1.461866    ┆ 9    ┆ 180          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COTIUSDT     ┆ -0.122041    ┆ 180  ┆ 9            │
│ TLMUSDT      ┆ -0.105029    ┆ 181  ┆ 8            │
│ DUSKUSDT     ┆ -0.08413     ┆ 182  ┆ 7            │
│ CVXUSDT      ┆ -0.076018    ┆ 183  ┆ 6            │
│ YFIUSDT      ┆ 0.077548     ┆ 184  ┆ 5            │
│ DGBUSDT      ┆ 0.121425     ┆ 185  ┆ 4            │
│ DEFIUSDT     ┆ 0.17606      ┆ 186  ┆ 3            │
│ CKBUSDT      ┆ 0.206974     ┆ 187  ┆ 2            │
│ BTCDOMUSDT   ┆ 0.621266     ┆ 188  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.634935     ┆ 189  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:17,996 - WARNING - 2023-12-26T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:17,996 - INFO - cur close time: 2023-12-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:17,996 - DEBUG - mean expected ret (mean factor): -0.7959502161466793
2024-11-20 23:07:18,002 - DEBUG - begin to update pos: =========
2024-11-20 23:07:18,003 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,003 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03564     ┆ 0.14868     ┆ 0.0013393   ┆ … ┆ 0.02748 ┆ null   ┆ null    ┆ 0.3588  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,011 - DEBUG - update position: 2023-12-26T23:59:59.999 === diff_trading_value: 274907.6771607974 == cash: 160374.75100774318 
2024-11-20 23:07:18,015 - INFO - pnl: 2023-12-26T23:59:59.999 160374.75100774318 === 1.858%
2024-11-20 23:07:18,021 - DEBUG - cur time: 2023-12-27T23:59:59.999 == next bar open time: 2023-12-28T00:00:00.000 == close pos time: 2024-01-04T00:00:00.000
2024-11-20 23:07:18,023 - INFO - pnl: 2023-12-27T23:59:59.999 164161.00083916614 === 2.361%
2024-11-20 23:07:18,027 - DEBUG - cur time: 2023-12-28T23:59:59.999 == next bar open time: 2023-12-29T00:00:00.000 == close pos time: 2024-01-05T00:00:00.000
2024-11-20 23:07:18,029 - INFO - pnl: 2023-12-28T23:59:59.999 162544.33002567338 === -0.985%
2024-11-20 23:07:18,035 - DEBUG - cur time: 2023-12-29T23:59:59.999 == next bar open time: 2023-12-30T00:00:00.000 == close pos time: 2024-01-06T00:00:00.000
2024-11-20 23:07:18,039 - INFO - pnl: 2023-12-29T23:59:59.999 160891.69113904823 === -1.017%
2024-11-20 23:07:18,045 - DEBUG - cur time: 2023-12-30T23:59:59.999 == next bar open time: 2023-12-31T00:00:00.000 == close pos time: 2024-01-07T00:00:00.000
2024-11-20 23:07:18,048 - INFO - pnl: 2023-12-30T23:59:59.999 160128.72374178658 === -0.474%
2024-11-20 23:07:18,052 - DEBUG - cur time: 2023-12-31T23:59:59.999 == next bar open time: 2024-01-01T00:00:00.000 == close pos time: 2024-01-08T00:00:00.000
2024-11-20 23:07:18,054 - INFO - pnl: 2023-12-31T23:59:59.999 161199.2029464874 === 0.669%
2024-11-20 23:07:18,059 - DEBUG - cur time: 2024-01-01T23:59:59.999 == next bar open time: 2024-01-02T00:00:00.000 == close pos time: 2024-01-09T00:00:00.000
2024-11-20 23:07:18,061 - INFO - pnl: 2024-01-01T23:59:59.999 156751.69688676155 === -2.759%
2024-11-20 23:07:18,067 - DEBUG - cur time: 2024-01-02T23:59:59.999 == next bar open time: 2024-01-03T00:00:00.000 == close pos time: 2024-01-10T00:00:00.000
2024-11-20 23:07:18,077 - DEBUG - sorted_long_factors: shape: (191, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RUNEUSDT     ┆ -1.755397    ┆ 0    ┆ 190          │
│ GMTUSDT      ┆ -1.6493      ┆ 1    ┆ 189          │
│ STORJUSDT    ┆ -1.648354    ┆ 2    ┆ 188          │
│ CYBERUSDT    ┆ -1.596346    ┆ 3    ┆ 187          │
│ WAVESUSDT    ┆ -1.560491    ┆ 4    ┆ 186          │
│ LPTUSDT      ┆ -1.533397    ┆ 5    ┆ 185          │
│ TRBUSDT      ┆ -1.533057    ┆ 6    ┆ 184          │
│ OXTUSDT      ┆ -1.519551    ┆ 7    ┆ 183          │
│ MKRUSDT      ┆ -1.491923    ┆ 8    ┆ 182          │
│ ARKMUSDT     ┆ -1.474397    ┆ 9    ┆ 181          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TLMUSDT      ┆ -0.081802    ┆ 181  ┆ 9            │
│ TUSDT        ┆ 0.005162     ┆ 182  ┆ 8            │
│ RVNUSDT      ┆ 0.010854     ┆ 183  ┆ 7            │
│ DGBUSDT      ┆ 0.073743     ┆ 184  ┆ 6            │
│ DARUSDT      ┆ 0.099474     ┆ 185  ┆ 5            │
│ BTCDOMUSDT   ┆ 0.203409     ┆ 186  ┆ 4            │
│ NKNUSDT      ┆ 0.283943     ┆ 187  ┆ 3            │
│ CKBUSDT      ┆ 0.337071     ┆ 188  ┆ 2            │
│ COMBOUSDT    ┆ 0.382858     ┆ 189  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.555805     ┆ 190  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:18,085 - INFO - cur close time: 2024-01-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:18,086 - DEBUG - mean expected ret (mean factor): -0.7897623266496496
2024-11-20 23:07:18,091 - DEBUG - begin to update pos: =========
2024-11-20 23:07:18,091 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,091 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03555     ┆ 0.13843     ┆ 0.0013391   ┆ … ┆ 0.02545 ┆ null   ┆ null    ┆ 0.3721  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,100 - DEBUG - update position: 2024-01-02T23:59:59.999 === diff_trading_value: 274178.87737446954 == cash: 156572.80082265023 
2024-11-20 23:07:18,103 - INFO - pnl: 2024-01-02T23:59:59.999 156572.80082265023 === -0.114%
2024-11-20 23:07:18,112 - DEBUG - cur time: 2024-01-03T23:59:59.999 == next bar open time: 2024-01-04T00:00:00.000 == close pos time: 2024-01-11T00:00:00.000
2024-11-20 23:07:18,115 - INFO - pnl: 2024-01-03T23:59:59.999 159827.0763599078 === 2.078%
2024-11-20 23:07:18,120 - DEBUG - cur time: 2024-01-04T23:59:59.999 == next bar open time: 2024-01-05T00:00:00.000 == close pos time: 2024-01-12T00:00:00.000
2024-11-20 23:07:18,121 - INFO - pnl: 2024-01-04T23:59:59.999 160716.81340806474 === 0.557%
2024-11-20 23:07:18,126 - DEBUG - cur time: 2024-01-05T23:59:59.999 == next bar open time: 2024-01-06T00:00:00.000 == close pos time: 2024-01-13T00:00:00.000
2024-11-20 23:07:18,128 - INFO - pnl: 2024-01-05T23:59:59.999 161605.240839795 === 0.553%
2024-11-20 23:07:18,133 - DEBUG - cur time: 2024-01-06T23:59:59.999 == next bar open time: 2024-01-07T00:00:00.000 == close pos time: 2024-01-14T00:00:00.000
2024-11-20 23:07:18,134 - INFO - pnl: 2024-01-06T23:59:59.999 160551.18809027356 === -0.652%
2024-11-20 23:07:18,139 - DEBUG - cur time: 2024-01-07T23:59:59.999 == next bar open time: 2024-01-08T00:00:00.000 == close pos time: 2024-01-15T00:00:00.000
2024-11-20 23:07:18,141 - INFO - pnl: 2024-01-07T23:59:59.999 158756.2821013456 === -1.118%
2024-11-20 23:07:18,145 - DEBUG - cur time: 2024-01-08T23:59:59.999 == next bar open time: 2024-01-09T00:00:00.000 == close pos time: 2024-01-16T00:00:00.000
2024-11-20 23:07:18,147 - INFO - pnl: 2024-01-08T23:59:59.999 161482.65038863674 === 1.717%
2024-11-20 23:07:18,152 - DEBUG - cur time: 2024-01-09T23:59:59.999 == next bar open time: 2024-01-10T00:00:00.000 == close pos time: 2024-01-17T00:00:00.000
2024-11-20 23:07:18,161 - DEBUG - sorted_long_factors: shape: (193, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CYBERUSDT    ┆ -1.956179    ┆ 0    ┆ 192          │
│ MKRUSDT      ┆ -1.88449     ┆ 1    ┆ 191          │
│ TRBUSDT      ┆ -1.849175    ┆ 2    ┆ 190          │
│ LDOUSDT      ┆ -1.769389    ┆ 3    ┆ 189          │
│ PENDLEUSDT   ┆ -1.73024     ┆ 4    ┆ 188          │
│ ARBUSDT      ┆ -1.709109    ┆ 5    ┆ 187          │
│ OPUSDT       ┆ -1.706937    ┆ 6    ┆ 186          │
│ YGGUSDT      ┆ -1.690692    ┆ 7    ┆ 185          │
│ WLDUSDT      ┆ -1.646796    ┆ 8    ┆ 184          │
│ SSVUSDT      ┆ -1.56466     ┆ 9    ┆ 183          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RLCUSDT      ┆ 0.173435     ┆ 183  ┆ 9            │
│ CTKUSDT      ┆ 0.20669      ┆ 184  ┆ 8            │
│ DEFIUSDT     ┆ 0.229776     ┆ 185  ┆ 7            │
│ KLAYUSDT     ┆ 0.247779     ┆ 186  ┆ 6            │
│ DGBUSDT      ┆ 0.291215     ┆ 187  ┆ 5            │
│ ALICEUSDT    ┆ 0.332432     ┆ 188  ┆ 4            │
│ IDEXUSDT     ┆ 0.359264     ┆ 189  ┆ 3            │
│ DARUSDT      ┆ 0.379403     ┆ 190  ┆ 2            │
│ CKBUSDT      ┆ 0.563841     ┆ 191  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.769012     ┆ 192  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:18,174 - WARNING - 2024-01-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:18,174 - INFO - cur close time: 2024-01-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:18,174 - DEBUG - mean expected ret (mean factor): -0.7532674378260601
2024-11-20 23:07:18,179 - DEBUG - begin to update pos: =========
2024-11-20 23:07:18,180 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,180 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02909     ┆ 0.11731     ┆ 0.0011966   ┆ … ┆ 0.02085 ┆ null   ┆ null    ┆ 0.3241  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,188 - DEBUG - update position: 2024-01-09T23:59:59.999 === diff_trading_value: 216479.0018328893 == cash: 161351.0828321582 
2024-11-20 23:07:18,190 - INFO - pnl: 2024-01-09T23:59:59.999 161351.0828321582 === -0.081%
2024-11-20 23:07:18,193 - DEBUG - cur time: 2024-01-10T23:59:59.999 == next bar open time: 2024-01-11T00:00:00.000 == close pos time: 2024-01-18T00:00:00.000
2024-11-20 23:07:18,196 - INFO - pnl: 2024-01-10T23:59:59.999 159332.42859881977 === -1.251%
2024-11-20 23:07:18,203 - DEBUG - cur time: 2024-01-11T23:59:59.999 == next bar open time: 2024-01-12T00:00:00.000 == close pos time: 2024-01-19T00:00:00.000
2024-11-20 23:07:18,206 - INFO - pnl: 2024-01-11T23:59:59.999 158627.8503907338 === -0.442%
2024-11-20 23:07:18,210 - DEBUG - cur time: 2024-01-12T23:59:59.999 == next bar open time: 2024-01-13T00:00:00.000 == close pos time: 2024-01-20T00:00:00.000
2024-11-20 23:07:18,213 - INFO - pnl: 2024-01-12T23:59:59.999 155625.27239647385 === -1.893%
2024-11-20 23:07:18,217 - DEBUG - cur time: 2024-01-13T23:59:59.999 == next bar open time: 2024-01-14T00:00:00.000 == close pos time: 2024-01-21T00:00:00.000
2024-11-20 23:07:18,219 - INFO - pnl: 2024-01-13T23:59:59.999 158469.30558691907 === 1.827%
2024-11-20 23:07:18,223 - DEBUG - cur time: 2024-01-14T23:59:59.999 == next bar open time: 2024-01-15T00:00:00.000 == close pos time: 2024-01-22T00:00:00.000
2024-11-20 23:07:18,226 - INFO - pnl: 2024-01-14T23:59:59.999 159512.58577242642 === 0.658%
2024-11-20 23:07:18,231 - DEBUG - cur time: 2024-01-15T23:59:59.999 == next bar open time: 2024-01-16T00:00:00.000 == close pos time: 2024-01-23T00:00:00.000
2024-11-20 23:07:18,234 - INFO - pnl: 2024-01-15T23:59:59.999 157089.05367868725 === -1.519%
2024-11-20 23:07:18,241 - DEBUG - cur time: 2024-01-16T23:59:59.999 == next bar open time: 2024-01-17T00:00:00.000 == close pos time: 2024-01-24T00:00:00.000
2024-11-20 23:07:18,257 - DEBUG - sorted_long_factors: shape: (193, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT      ┆ -2.030047    ┆ 0    ┆ 192          │
│ GMTUSDT      ┆ -1.782691    ┆ 1    ┆ 191          │
│ WLDUSDT      ┆ -1.757639    ┆ 2    ┆ 190          │
│ LDOUSDT      ┆ -1.739639    ┆ 3    ┆ 189          │
│ OPUSDT       ┆ -1.739353    ┆ 4    ┆ 188          │
│ LQTYUSDT     ┆ -1.660354    ┆ 5    ┆ 187          │
│ JOEUSDT      ┆ -1.647669    ┆ 6    ┆ 186          │
│ BLURUSDT     ┆ -1.634458    ┆ 7    ┆ 185          │
│ YGGUSDT      ┆ -1.602693    ┆ 8    ┆ 184          │
│ AXSUSDT      ┆ -1.593607    ┆ 9    ┆ 183          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DEFIUSDT     ┆ 0.303365     ┆ 183  ┆ 9            │
│ COTIUSDT     ┆ 0.34173      ┆ 184  ┆ 8            │
│ CTKUSDT      ┆ 0.4431       ┆ 185  ┆ 7            │
│ SPELLUSDT    ┆ 0.459348     ┆ 186  ┆ 6            │
│ DODOXUSDT    ┆ 0.539969     ┆ 187  ┆ 5            │
│ COMBOUSDT    ┆ 0.545205     ┆ 188  ┆ 4            │
│ CKBUSDT      ┆ 0.567372     ┆ 189  ┆ 3            │
│ DGBUSDT      ┆ 0.652369     ┆ 190  ┆ 2            │
│ IDEXUSDT     ┆ 0.663728     ┆ 191  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.486974     ┆ 192  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:18,266 - WARNING - 2024-01-16T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:18,266 - INFO - cur close time: 2024-01-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:18,266 - DEBUG - mean expected ret (mean factor): -0.7349266892531491
2024-11-20 23:07:18,271 - DEBUG - begin to update pos: =========
2024-11-20 23:07:18,271 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,271 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03149     ┆ 0.12489     ┆ 0.0012454   ┆ … ┆ 0.02294 ┆ null   ┆ null    ┆ 0.3381  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,279 - DEBUG - update position: 2024-01-16T23:59:59.999 === diff_trading_value: 206555.79218168606 == cash: 154657.1235272244 
2024-11-20 23:07:18,281 - INFO - pnl: 2024-01-16T23:59:59.999 154657.1235272244 === -1.548%
2024-11-20 23:07:18,286 - DEBUG - cur time: 2024-01-17T23:59:59.999 == next bar open time: 2024-01-18T00:00:00.000 == close pos time: 2024-01-25T00:00:00.000
2024-11-20 23:07:18,289 - INFO - pnl: 2024-01-17T23:59:59.999 154391.8422047561 === -0.172%
2024-11-20 23:07:18,295 - DEBUG - cur time: 2024-01-18T23:59:59.999 == next bar open time: 2024-01-19T00:00:00.000 == close pos time: 2024-01-26T00:00:00.000
2024-11-20 23:07:18,299 - INFO - pnl: 2024-01-18T23:59:59.999 155866.10908606547 === 0.955%
2024-11-20 23:07:18,307 - DEBUG - cur time: 2024-01-19T23:59:59.999 == next bar open time: 2024-01-20T00:00:00.000 == close pos time: 2024-01-27T00:00:00.000
2024-11-20 23:07:18,310 - INFO - pnl: 2024-01-19T23:59:59.999 156249.00010978387 === 0.246%
2024-11-20 23:07:18,318 - DEBUG - cur time: 2024-01-20T23:59:59.999 == next bar open time: 2024-01-21T00:00:00.000 == close pos time: 2024-01-28T00:00:00.000
2024-11-20 23:07:18,321 - INFO - pnl: 2024-01-20T23:59:59.999 158401.9704974825 === 1.378%
2024-11-20 23:07:18,326 - DEBUG - cur time: 2024-01-21T23:59:59.999 == next bar open time: 2024-01-22T00:00:00.000 == close pos time: 2024-01-29T00:00:00.000
2024-11-20 23:07:18,328 - INFO - pnl: 2024-01-21T23:59:59.999 159130.04188475804 === 0.460%
2024-11-20 23:07:18,333 - DEBUG - cur time: 2024-01-22T23:59:59.999 == next bar open time: 2024-01-23T00:00:00.000 == close pos time: 2024-01-30T00:00:00.000
2024-11-20 23:07:18,336 - INFO - pnl: 2024-01-22T23:59:59.999 159160.27104730037 === 0.019%
2024-11-20 23:07:18,343 - DEBUG - cur time: 2024-01-23T23:59:59.999 == next bar open time: 2024-01-24T00:00:00.000 == close pos time: 2024-01-31T00:00:00.000
2024-11-20 23:07:18,353 - DEBUG - sorted_long_factors: shape: (196, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT   ┆ -1.858252    ┆ 0    ┆ 195          │
│ APEUSDT      ┆ -1.811184    ┆ 1    ┆ 194          │
│ CFXUSDT      ┆ -1.79691     ┆ 2    ┆ 193          │
│ ASTRUSDT     ┆ -1.758153    ┆ 3    ┆ 192          │
│ PENDLEUSDT   ┆ -1.598058    ┆ 4    ┆ 191          │
│ RNDRUSDT     ┆ -1.570922    ┆ 5    ┆ 190          │
│ BLURUSDT     ┆ -1.500864    ┆ 6    ┆ 189          │
│ SEIUSDT      ┆ -1.494889    ┆ 7    ┆ 188          │
│ FOOTBALLUSDT ┆ -1.486751    ┆ 8    ┆ 187          │
│ SUIUSDT      ┆ -1.457062    ┆ 9    ┆ 186          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CKBUSDT      ┆ 0.132808     ┆ 186  ┆ 9            │
│ TRUUSDT      ┆ 0.152876     ┆ 187  ┆ 8            │
│ DODOXUSDT    ┆ 0.25689      ┆ 188  ┆ 7            │
│ TLMUSDT      ┆ 0.299149     ┆ 189  ┆ 6            │
│ ANTUSDT      ┆ 0.355459     ┆ 190  ┆ 5            │
│ CTKUSDT      ┆ 0.424288     ┆ 191  ┆ 4            │
│ DASHUSDT     ┆ 0.429873     ┆ 192  ┆ 3            │
│ DEFIUSDT     ┆ 0.543475     ┆ 193  ┆ 2            │
│ DGBUSDT      ┆ 0.554478     ┆ 194  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.381308     ┆ 195  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:18,361 - WARNING - 2024-01-23T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:18,361 - INFO - cur close time: 2024-01-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:18,361 - DEBUG - mean expected ret (mean factor): -0.7463375587661828
2024-11-20 23:07:18,366 - DEBUG - begin to update pos: =========
2024-11-20 23:07:18,366 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,367 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02849     ┆ 0.09393     ┆ 0.0010413   ┆ … ┆ 0.01961 ┆ null   ┆ null    ┆ 0.2947  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,374 - DEBUG - update position: 2024-01-23T23:59:59.999 === diff_trading_value: 238696.3769431215 == cash: 158644.86614463938 
2024-11-20 23:07:18,375 - INFO - pnl: 2024-01-23T23:59:59.999 158644.86614463938 === -0.324%
2024-11-20 23:07:18,379 - DEBUG - cur time: 2024-01-24T23:59:59.999 == next bar open time: 2024-01-25T00:00:00.000 == close pos time: 2024-02-01T00:00:00.000
2024-11-20 23:07:18,381 - INFO - pnl: 2024-01-24T23:59:59.999 157064.13424924682 === -0.996%
2024-11-20 23:07:18,385 - DEBUG - cur time: 2024-01-25T23:59:59.999 == next bar open time: 2024-01-26T00:00:00.000 == close pos time: 2024-02-02T00:00:00.000
2024-11-20 23:07:18,387 - INFO - pnl: 2024-01-25T23:59:59.999 159270.74517282424 === 1.405%
2024-11-20 23:07:18,392 - DEBUG - cur time: 2024-01-26T23:59:59.999 == next bar open time: 2024-01-27T00:00:00.000 == close pos time: 2024-02-03T00:00:00.000
2024-11-20 23:07:18,393 - INFO - pnl: 2024-01-26T23:59:59.999 154650.2866143105 === -2.901%
2024-11-20 23:07:18,396 - DEBUG - cur time: 2024-01-27T23:59:59.999 == next bar open time: 2024-01-28T00:00:00.000 == close pos time: 2024-02-04T00:00:00.000
2024-11-20 23:07:18,399 - INFO - pnl: 2024-01-27T23:59:59.999 157157.46098012052 === 1.621%
2024-11-20 23:07:18,403 - DEBUG - cur time: 2024-01-28T23:59:59.999 == next bar open time: 2024-01-29T00:00:00.000 == close pos time: 2024-02-05T00:00:00.000
2024-11-20 23:07:18,404 - INFO - pnl: 2024-01-28T23:59:59.999 156217.82581107816 === -0.598%
2024-11-20 23:07:18,408 - DEBUG - cur time: 2024-01-29T23:59:59.999 == next bar open time: 2024-01-30T00:00:00.000 == close pos time: 2024-02-06T00:00:00.000
2024-11-20 23:07:18,410 - INFO - pnl: 2024-01-29T23:59:59.999 152063.99724349345 === -2.659%
2024-11-20 23:07:18,414 - DEBUG - cur time: 2024-01-30T23:59:59.999 == next bar open time: 2024-01-31T00:00:00.000 == close pos time: 2024-02-07T00:00:00.000
2024-11-20 23:07:18,424 - DEBUG - sorted_long_factors: shape: (202, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT      ┆ -2.111944    ┆ 0    ┆ 201          │
│ RNDRUSDT     ┆ -1.681459    ┆ 1    ┆ 200          │
│ NMRUSDT      ┆ -1.593198    ┆ 2    ┆ 199          │
│ OMGUSDT      ┆ -1.582745    ┆ 3    ┆ 198          │
│ PENDLEUSDT   ┆ -1.546616    ┆ 4    ┆ 197          │
│ DYDXUSDT     ┆ -1.528434    ┆ 5    ┆ 196          │
│ MAGICUSDT    ┆ -1.524618    ┆ 6    ┆ 195          │
│ XEMUSDT      ┆ -1.504032    ┆ 7    ┆ 194          │
│ XMRUSDT      ┆ -1.493138    ┆ 8    ┆ 193          │
│ RUNEUSDT     ┆ -1.49257     ┆ 9    ┆ 192          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ZENUSDT      ┆ -0.07909     ┆ 192  ┆ 9            │
│ LQTYUSDT     ┆ -0.071704    ┆ 193  ┆ 8            │
│ BELUSDT      ┆ -0.049763    ┆ 194  ┆ 7            │
│ TLMUSDT      ┆ -0.045806    ┆ 195  ┆ 6            │
│ DGBUSDT      ┆ 0.18645      ┆ 196  ┆ 5            │
│ BTCDOMUSDT   ┆ 0.431092     ┆ 197  ┆ 4            │
│ QNTUSDT      ┆ 0.435981     ┆ 198  ┆ 3            │
│ DEFIUSDT     ┆ 0.476686     ┆ 199  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.101448     ┆ 200  ┆ 1            │
│ DODOXUSDT    ┆ 1.160187     ┆ 201  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:18,431 - WARNING - 2024-01-30T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:18,433 - INFO - cur close time: 2024-01-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:18,433 - DEBUG - mean expected ret (mean factor): -0.7845693196905468
2024-11-20 23:07:18,438 - DEBUG - begin to update pos: =========
2024-11-20 23:07:18,439 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,439 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02857     ┆ 0.09767     ┆ 0.0010093   ┆ … ┆ 0.02046 ┆ null   ┆ null    ┆ 0.3316  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,450 - DEBUG - update position: 2024-01-30T23:59:59.999 === diff_trading_value: 279452.36925204436 == cash: 151538.5148164187 
2024-11-20 23:07:18,451 - INFO - pnl: 2024-01-30T23:59:59.999 151538.5148164187 === -0.346%
2024-11-20 23:07:18,455 - DEBUG - cur time: 2024-01-31T23:59:59.999 == next bar open time: 2024-02-01T00:00:00.000 == close pos time: 2024-02-08T00:00:00.000
2024-11-20 23:07:18,456 - INFO - pnl: 2024-01-31T23:59:59.999 152649.31616835642 === 0.733%
2024-11-20 23:07:18,461 - DEBUG - cur time: 2024-02-01T23:59:59.999 == next bar open time: 2024-02-02T00:00:00.000 == close pos time: 2024-02-09T00:00:00.000
2024-11-20 23:07:18,464 - INFO - pnl: 2024-02-01T23:59:59.999 152028.09792274877 === -0.407%
2024-11-20 23:07:18,468 - DEBUG - cur time: 2024-02-02T23:59:59.999 == next bar open time: 2024-02-03T00:00:00.000 == close pos time: 2024-02-10T00:00:00.000
2024-11-20 23:07:18,470 - INFO - pnl: 2024-02-02T23:59:59.999 149148.84802669106 === -1.894%
2024-11-20 23:07:18,474 - DEBUG - cur time: 2024-02-03T23:59:59.999 == next bar open time: 2024-02-04T00:00:00.000 == close pos time: 2024-02-11T00:00:00.000
2024-11-20 23:07:18,477 - INFO - pnl: 2024-02-03T23:59:59.999 148972.33217555415 === -0.118%
2024-11-20 23:07:18,481 - DEBUG - cur time: 2024-02-04T23:59:59.999 == next bar open time: 2024-02-05T00:00:00.000 == close pos time: 2024-02-12T00:00:00.000
2024-11-20 23:07:18,485 - INFO - pnl: 2024-02-04T23:59:59.999 146714.4350501701 === -1.516%
2024-11-20 23:07:18,489 - DEBUG - cur time: 2024-02-05T23:59:59.999 == next bar open time: 2024-02-06T00:00:00.000 == close pos time: 2024-02-13T00:00:00.000
2024-11-20 23:07:18,491 - INFO - pnl: 2024-02-05T23:59:59.999 146731.93068444903 === 0.012%
2024-11-20 23:07:18,495 - DEBUG - cur time: 2024-02-06T23:59:59.999 == next bar open time: 2024-02-07T00:00:00.000 == close pos time: 2024-02-14T00:00:00.000
2024-11-20 23:07:18,504 - DEBUG - sorted_long_factors: shape: (205, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ OPUSDT       ┆ -1.980168    ┆ 0    ┆ 204          │
│ UMAUSDT      ┆ -1.975409    ┆ 1    ┆ 203          │
│ BSVUSDT      ┆ -1.93006     ┆ 2    ┆ 202          │
│ GASUSDT      ┆ -1.880985    ┆ 3    ┆ 201          │
│ WLDUSDT      ┆ -1.787307    ┆ 4    ┆ 200          │
│ DOTUSDT      ┆ -1.689039    ┆ 5    ┆ 199          │
│ INJUSDT      ┆ -1.638004    ┆ 6    ┆ 198          │
│ NEOUSDT      ┆ -1.634554    ┆ 7    ┆ 197          │
│ RUNEUSDT     ┆ -1.624125    ┆ 8    ┆ 196          │
│ ARKUSDT      ┆ -1.612777    ┆ 9    ┆ 195          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DENTUSDT     ┆ 0.14391      ┆ 195  ┆ 9            │
│ BELUSDT      ┆ 0.163495     ┆ 196  ┆ 8            │
│ KEYUSDT      ┆ 0.221185     ┆ 197  ┆ 7            │
│ XVGUSDT      ┆ 0.238483     ┆ 198  ┆ 6            │
│ TLMUSDT      ┆ 0.312916     ┆ 199  ┆ 5            │
│ DGBUSDT      ┆ 0.429848     ┆ 200  ┆ 4            │
│ BICOUSDT     ┆ 0.542444     ┆ 201  ┆ 3            │
│ DODOXUSDT    ┆ 0.660593     ┆ 202  ┆ 2            │
│ IDEXUSDT     ┆ 0.696415     ┆ 203  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.066012     ┆ 204  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:18,511 - WARNING - 2024-02-06T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:18,511 - INFO - cur close time: 2024-02-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:18,511 - DEBUG - mean expected ret (mean factor): -0.7888968583192804
2024-11-20 23:07:18,518 - DEBUG - begin to update pos: =========
2024-11-20 23:07:18,518 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,518 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02796     ┆ 0.1046      ┆ 0.0009039   ┆ … ┆ 0.01974 ┆ null   ┆ null    ┆ 0.3165  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,525 - DEBUG - update position: 2024-02-06T23:59:59.999 === diff_trading_value: 280371.6455645573 == cash: 152687.5336291073 
2024-11-20 23:07:18,526 - INFO - pnl: 2024-02-06T23:59:59.999 152687.5336291073 === 4.059%
2024-11-20 23:07:18,530 - DEBUG - cur time: 2024-02-07T23:59:59.999 == next bar open time: 2024-02-08T00:00:00.000 == close pos time: 2024-02-15T00:00:00.000
2024-11-20 23:07:18,531 - INFO - pnl: 2024-02-07T23:59:59.999 153971.11369949655 === 0.841%
2024-11-20 23:07:18,535 - DEBUG - cur time: 2024-02-08T23:59:59.999 == next bar open time: 2024-02-09T00:00:00.000 == close pos time: 2024-02-16T00:00:00.000
2024-11-20 23:07:18,537 - INFO - pnl: 2024-02-08T23:59:59.999 154118.21900128305 === 0.096%
2024-11-20 23:07:18,541 - DEBUG - cur time: 2024-02-09T23:59:59.999 == next bar open time: 2024-02-10T00:00:00.000 == close pos time: 2024-02-17T00:00:00.000
2024-11-20 23:07:18,542 - INFO - pnl: 2024-02-09T23:59:59.999 154139.39269368834 === 0.014%
2024-11-20 23:07:18,546 - DEBUG - cur time: 2024-02-10T23:59:59.999 == next bar open time: 2024-02-11T00:00:00.000 == close pos time: 2024-02-18T00:00:00.000
2024-11-20 23:07:18,549 - INFO - pnl: 2024-02-10T23:59:59.999 154740.1751808886 === 0.390%
2024-11-20 23:07:18,553 - DEBUG - cur time: 2024-02-11T23:59:59.999 == next bar open time: 2024-02-12T00:00:00.000 == close pos time: 2024-02-19T00:00:00.000
2024-11-20 23:07:18,555 - INFO - pnl: 2024-02-11T23:59:59.999 153242.73582612092 === -0.968%
2024-11-20 23:07:18,559 - DEBUG - cur time: 2024-02-12T23:59:59.999 == next bar open time: 2024-02-13T00:00:00.000 == close pos time: 2024-02-20T00:00:00.000
2024-11-20 23:07:18,561 - INFO - pnl: 2024-02-12T23:59:59.999 151953.96747678943 === -0.841%
2024-11-20 23:07:18,566 - DEBUG - cur time: 2024-02-13T23:59:59.999 == next bar open time: 2024-02-14T00:00:00.000 == close pos time: 2024-02-21T00:00:00.000
2024-11-20 23:07:18,580 - DEBUG - sorted_long_factors: shape: (212, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT      ┆ -1.871975    ┆ 0    ┆ 211          │
│ EGLDUSDT     ┆ -1.778899    ┆ 1    ┆ 210          │
│ DYDXUSDT     ┆ -1.759967    ┆ 2    ┆ 209          │
│ CYBERUSDT    ┆ -1.682843    ┆ 3    ┆ 208          │
│ COMPUSDT     ┆ -1.682542    ┆ 4    ┆ 207          │
│ FILUSDT      ┆ -1.662711    ┆ 5    ┆ 206          │
│ DOTUSDT      ┆ -1.622941    ┆ 6    ┆ 205          │
│ IMXUSDT      ┆ -1.62179     ┆ 7    ┆ 204          │
│ BONDUSDT     ┆ -1.582258    ┆ 8    ┆ 203          │
│ RNDRUSDT     ┆ -1.550946    ┆ 9    ┆ 202          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ANTUSDT      ┆ 0.076873     ┆ 202  ┆ 9            │
│ TRUUSDT      ┆ 0.187576     ┆ 203  ┆ 8            │
│ COMBOUSDT    ┆ 0.286684     ┆ 204  ┆ 7            │
│ ATAUSDT      ┆ 0.378855     ┆ 205  ┆ 6            │
│ KEYUSDT      ┆ 0.489568     ┆ 206  ┆ 5            │
│ XVGUSDT      ┆ 0.613922     ┆ 207  ┆ 4            │
│ DGBUSDT      ┆ 0.651157     ┆ 208  ┆ 3            │
│ DODOXUSDT    ┆ 0.65976      ┆ 209  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.735951     ┆ 210  ┆ 1            │
│ DEFIUSDT     ┆ 1.863045     ┆ 211  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:18,591 - WARNING - 2024-02-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:18,591 - INFO - cur close time: 2024-02-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:18,592 - DEBUG - mean expected ret (mean factor): -0.766176354036083
2024-11-20 23:07:18,597 - DEBUG - begin to update pos: =========
2024-11-20 23:07:18,597 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,597 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03216     ┆ 0.1137      ┆ 0.0010838   ┆ … ┆ 0.02125 ┆ null   ┆ null    ┆ 0.3255  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,605 - DEBUG - update position: 2024-02-13T23:59:59.999 === diff_trading_value: 274068.9928167132 == cash: 155475.06711805076 
2024-11-20 23:07:18,607 - INFO - pnl: 2024-02-13T23:59:59.999 155475.06711805076 === 2.317%
2024-11-20 23:07:18,611 - DEBUG - cur time: 2024-02-14T23:59:59.999 == next bar open time: 2024-02-15T00:00:00.000 == close pos time: 2024-02-22T00:00:00.000
2024-11-20 23:07:18,614 - INFO - pnl: 2024-02-14T23:59:59.999 155272.56258489357 === -0.130%
2024-11-20 23:07:18,620 - DEBUG - cur time: 2024-02-15T23:59:59.999 == next bar open time: 2024-02-16T00:00:00.000 == close pos time: 2024-02-23T00:00:00.000
2024-11-20 23:07:18,622 - INFO - pnl: 2024-02-15T23:59:59.999 156404.00971608385 === 0.729%
2024-11-20 23:07:18,626 - DEBUG - cur time: 2024-02-16T23:59:59.999 == next bar open time: 2024-02-17T00:00:00.000 == close pos time: 2024-02-24T00:00:00.000
2024-11-20 23:07:18,627 - INFO - pnl: 2024-02-16T23:59:59.999 154216.5230345678 === -1.399%
2024-11-20 23:07:18,631 - DEBUG - cur time: 2024-02-17T23:59:59.999 == next bar open time: 2024-02-18T00:00:00.000 == close pos time: 2024-02-25T00:00:00.000
2024-11-20 23:07:18,634 - INFO - pnl: 2024-02-17T23:59:59.999 153134.53239934513 === -0.702%
2024-11-20 23:07:18,640 - DEBUG - cur time: 2024-02-18T23:59:59.999 == next bar open time: 2024-02-19T00:00:00.000 == close pos time: 2024-02-26T00:00:00.000
2024-11-20 23:07:18,644 - INFO - pnl: 2024-02-18T23:59:59.999 149763.01160140627 === -2.202%
2024-11-20 23:07:18,653 - DEBUG - cur time: 2024-02-19T23:59:59.999 == next bar open time: 2024-02-20T00:00:00.000 == close pos time: 2024-02-27T00:00:00.000
2024-11-20 23:07:18,656 - INFO - pnl: 2024-02-19T23:59:59.999 141776.6975846051 === -5.333%
2024-11-20 23:07:18,660 - DEBUG - cur time: 2024-02-20T23:59:59.999 == next bar open time: 2024-02-21T00:00:00.000 == close pos time: 2024-02-28T00:00:00.000
2024-11-20 23:07:18,672 - DEBUG - sorted_long_factors: shape: (216, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ OPUSDT       ┆ -1.661764    ┆ 0    ┆ 215          │
│ RNDRUSDT     ┆ -1.495495    ┆ 1    ┆ 214          │
│ ICPUSDT      ┆ -1.474046    ┆ 2    ┆ 213          │
│ DOTUSDT      ┆ -1.459749    ┆ 3    ┆ 212          │
│ GASUSDT      ┆ -1.421598    ┆ 4    ┆ 211          │
│ APTUSDT      ┆ -1.419286    ┆ 5    ┆ 210          │
│ CYBERUSDT    ┆ -1.41541     ┆ 6    ┆ 209          │
│ MAVUSDT      ┆ -1.414591    ┆ 7    ┆ 208          │
│ BNBUSDT      ┆ -1.39462     ┆ 8    ┆ 207          │
│ XTZUSDT      ┆ -1.384674    ┆ 9    ┆ 206          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DENTUSDT     ┆ -0.245521    ┆ 206  ┆ 9            │
│ JASMYUSDT    ┆ -0.16903     ┆ 207  ┆ 8            │
│ CTKUSDT      ┆ -0.13411     ┆ 208  ┆ 7            │
│ TLMUSDT      ┆ -0.051918    ┆ 209  ┆ 6            │
│ COMBOUSDT    ┆ -0.038352    ┆ 210  ┆ 5            │
│ ATAUSDT      ┆ -0.010681    ┆ 211  ┆ 4            │
│ PENDLEUSDT   ┆ 0.125772     ┆ 212  ┆ 3            │
│ DGBUSDT      ┆ 0.260953     ┆ 213  ┆ 2            │
│ DEFIUSDT     ┆ 1.684157     ┆ 214  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.526509     ┆ 215  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:18,679 - WARNING - 2024-02-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:18,679 - INFO - cur close time: 2024-02-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:18,679 - DEBUG - mean expected ret (mean factor): -0.7858628546373265
2024-11-20 23:07:18,685 - DEBUG - begin to update pos: =========
2024-11-20 23:07:18,685 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,686 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03447     ┆ 0.12413     ┆ 0.0011946   ┆ … ┆ 0.02351 ┆ null   ┆ null    ┆ 0.3687  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,694 - DEBUG - update position: 2024-02-20T23:59:59.999 === diff_trading_value: 291999.09953445324 == cash: 144302.0827541784 
2024-11-20 23:07:18,696 - INFO - pnl: 2024-02-20T23:59:59.999 144302.0827541784 === 1.781%
2024-11-20 23:07:18,700 - DEBUG - cur time: 2024-02-21T23:59:59.999 == next bar open time: 2024-02-22T00:00:00.000 == close pos time: 2024-02-29T00:00:00.000
2024-11-20 23:07:18,702 - INFO - pnl: 2024-02-21T23:59:59.999 146759.34674510366 === 1.703%
2024-11-20 23:07:18,707 - DEBUG - cur time: 2024-02-22T23:59:59.999 == next bar open time: 2024-02-23T00:00:00.000 == close pos time: 2024-03-01T00:00:00.000
2024-11-20 23:07:18,709 - INFO - pnl: 2024-02-22T23:59:59.999 148724.5210043624 === 1.339%
2024-11-20 23:07:18,714 - DEBUG - cur time: 2024-02-23T23:59:59.999 == next bar open time: 2024-02-24T00:00:00.000 == close pos time: 2024-03-02T00:00:00.000
2024-11-20 23:07:18,716 - INFO - pnl: 2024-02-23T23:59:59.999 149163.86181072722 === 0.295%
2024-11-20 23:07:18,721 - DEBUG - cur time: 2024-02-24T23:59:59.999 == next bar open time: 2024-02-25T00:00:00.000 == close pos time: 2024-03-03T00:00:00.000
2024-11-20 23:07:18,724 - INFO - pnl: 2024-02-24T23:59:59.999 155305.79106430043 === 4.118%
2024-11-20 23:07:18,728 - DEBUG - cur time: 2024-02-25T23:59:59.999 == next bar open time: 2024-02-26T00:00:00.000 == close pos time: 2024-03-04T00:00:00.000
2024-11-20 23:07:18,731 - INFO - pnl: 2024-02-25T23:59:59.999 160348.4717846609 === 3.247%
2024-11-20 23:07:18,736 - DEBUG - cur time: 2024-02-26T23:59:59.999 == next bar open time: 2024-02-27T00:00:00.000 == close pos time: 2024-03-05T00:00:00.000
2024-11-20 23:07:18,738 - INFO - pnl: 2024-02-26T23:59:59.999 164730.74579234308 === 2.733%
2024-11-20 23:07:18,745 - DEBUG - cur time: 2024-02-27T23:59:59.999 == next bar open time: 2024-02-28T00:00:00.000 == close pos time: 2024-03-06T00:00:00.000
2024-11-20 23:07:18,755 - DEBUG - sorted_long_factors: shape: (220, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ICPUSDT      ┆ -1.77219     ┆ 0    ┆ 219          │
│ BSVUSDT      ┆ -1.715635    ┆ 1    ┆ 218          │
│ EOSUSDT      ┆ -1.656391    ┆ 2    ┆ 217          │
│ AXSUSDT      ┆ -1.645617    ┆ 3    ┆ 216          │
│ ENSUSDT      ┆ -1.638835    ┆ 4    ┆ 215          │
│ DOTUSDT      ┆ -1.634857    ┆ 5    ┆ 214          │
│ UMAUSDT      ┆ -1.63271     ┆ 6    ┆ 213          │
│ GASUSDT      ┆ -1.631401    ┆ 7    ┆ 212          │
│ ORDIUSDT     ┆ -1.597277    ┆ 8    ┆ 211          │
│ API3USDT     ┆ -1.589694    ┆ 9    ┆ 210          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DODOXUSDT    ┆ 0.034171     ┆ 210  ┆ 9            │
│ RENUSDT      ┆ 0.039827     ┆ 211  ┆ 8            │
│ RSRUSDT      ┆ 0.074377     ┆ 212  ┆ 7            │
│ TLMUSDT      ┆ 0.144336     ┆ 213  ┆ 6            │
│ REEFUSDT     ┆ 0.16245      ┆ 214  ┆ 5            │
│ DGBUSDT      ┆ 0.334834     ┆ 215  ┆ 4            │
│ FOOTBALLUSDT ┆ 0.342072     ┆ 216  ┆ 3            │
│ BTCDOMUSDT   ┆ 0.774874     ┆ 217  ┆ 2            │
│ DEFIUSDT     ┆ 0.806866     ┆ 218  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.969134     ┆ 219  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:18,765 - WARNING - 2024-02-27T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:18,765 - INFO - cur close time: 2024-02-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:18,765 - DEBUG - mean expected ret (mean factor): -0.7622698284369775
2024-11-20 23:07:18,770 - DEBUG - begin to update pos: =========
2024-11-20 23:07:18,770 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,771 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.05097     ┆ 0.13141     ┆ 0.0026636   ┆ … ┆ 0.02624 ┆ null   ┆ null    ┆ 0.3801  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,780 - DEBUG - update position: 2024-02-27T23:59:59.999 === diff_trading_value: 274344.16051197576 == cash: 162790.42224931568 
2024-11-20 23:07:18,783 - INFO - pnl: 2024-02-27T23:59:59.999 162790.42224931568 === -1.178%
2024-11-20 23:07:18,788 - DEBUG - cur time: 2024-02-28T23:59:59.999 == next bar open time: 2024-02-29T00:00:00.000 == close pos time: 2024-03-07T00:00:00.000
2024-11-20 23:07:18,791 - INFO - pnl: 2024-02-28T23:59:59.999 164263.5501268133 === 0.905%
2024-11-20 23:07:18,798 - DEBUG - cur time: 2024-02-29T23:59:59.999 == next bar open time: 2024-03-01T00:00:00.000 == close pos time: 2024-03-08T00:00:00.000
2024-11-20 23:07:18,801 - INFO - pnl: 2024-02-29T23:59:59.999 165564.45440320802 === 0.792%
2024-11-20 23:07:18,808 - DEBUG - cur time: 2024-03-01T23:59:59.999 == next bar open time: 2024-03-02T00:00:00.000 == close pos time: 2024-03-09T00:00:00.000
2024-11-20 23:07:18,810 - INFO - pnl: 2024-03-01T23:59:59.999 168436.71924221556 === 1.735%
2024-11-20 23:07:18,815 - DEBUG - cur time: 2024-03-02T23:59:59.999 == next bar open time: 2024-03-03T00:00:00.000 == close pos time: 2024-03-10T00:00:00.000
2024-11-20 23:07:18,817 - INFO - pnl: 2024-03-02T23:59:59.999 163471.62681717967 === -2.948%
2024-11-20 23:07:18,821 - DEBUG - cur time: 2024-03-03T23:59:59.999 == next bar open time: 2024-03-04T00:00:00.000 == close pos time: 2024-03-11T00:00:00.000
2024-11-20 23:07:18,824 - INFO - pnl: 2024-03-03T23:59:59.999 167290.7031285647 === 2.336%
2024-11-20 23:07:18,829 - DEBUG - cur time: 2024-03-04T23:59:59.999 == next bar open time: 2024-03-05T00:00:00.000 == close pos time: 2024-03-12T00:00:00.000
2024-11-20 23:07:18,832 - INFO - pnl: 2024-03-04T23:59:59.999 165671.0003874897 === -0.968%
2024-11-20 23:07:18,836 - DEBUG - cur time: 2024-03-05T23:59:59.999 == next bar open time: 2024-03-06T00:00:00.000 == close pos time: 2024-03-13T00:00:00.000
2024-11-20 23:07:18,849 - DEBUG - sorted_long_factors: shape: (222, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT     ┆ -1.951599    ┆ 0    ┆ 221          │
│ GASUSDT      ┆ -1.734708    ┆ 1    ┆ 220          │
│ ICPUSDT      ┆ -1.634059    ┆ 2    ┆ 219          │
│ SSVUSDT      ┆ -1.613376    ┆ 3    ┆ 218          │
│ DOTUSDT      ┆ -1.533605    ┆ 4    ┆ 217          │
│ OPUSDT       ┆ -1.491394    ┆ 5    ┆ 216          │
│ CYBERUSDT    ┆ -1.489334    ┆ 6    ┆ 215          │
│ ATOMUSDT     ┆ -1.458129    ┆ 7    ┆ 214          │
│ WAVESUSDT    ┆ -1.425897    ┆ 8    ┆ 213          │
│ UNFIUSDT     ┆ -1.416909    ┆ 9    ┆ 212          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ARKMUSDT     ┆ -0.077897    ┆ 212  ┆ 9            │
│ GALUSDT      ┆ -0.055284    ┆ 213  ┆ 8            │
│ COMBOUSDT    ┆ -0.015328    ┆ 214  ┆ 7            │
│ CELOUSDT     ┆ 0.030435     ┆ 215  ┆ 6            │
│ DGBUSDT      ┆ 0.035353     ┆ 216  ┆ 5            │
│ BTCDOMUSDT   ┆ 0.154414     ┆ 217  ┆ 4            │
│ OXTUSDT      ┆ 0.411488     ┆ 218  ┆ 3            │
│ FOOTBALLUSDT ┆ 0.942245     ┆ 219  ┆ 2            │
│ DEFIUSDT     ┆ 0.996726     ┆ 220  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.673646     ┆ 221  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:18,857 - WARNING - 2024-03-05T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:18,857 - INFO - cur close time: 2024-03-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:18,857 - DEBUG - mean expected ret (mean factor): -0.7817369441507122
2024-11-20 23:07:18,861 - DEBUG - begin to update pos: =========
2024-11-20 23:07:18,863 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,863 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.030505    ┆ 0.11579     ┆ 0.20201     ┆ 0.0063028   ┆ … ┆ 0.03018 ┆ null   ┆ null    ┆ 0.4059  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,869 - DEBUG - update position: 2024-03-05T23:59:59.999 === diff_trading_value: 225402.0351534213 == cash: 163090.0981344489 
2024-11-20 23:07:18,870 - INFO - pnl: 2024-03-05T23:59:59.999 163090.0981344489 === -1.558%
2024-11-20 23:07:18,873 - DEBUG - cur time: 2024-03-06T23:59:59.999 == next bar open time: 2024-03-07T00:00:00.000 == close pos time: 2024-03-14T00:00:00.000
2024-11-20 23:07:18,874 - INFO - pnl: 2024-03-06T23:59:59.999 166503.80496427618 === 2.093%
2024-11-20 23:07:18,877 - DEBUG - cur time: 2024-03-07T23:59:59.999 == next bar open time: 2024-03-08T00:00:00.000 == close pos time: 2024-03-15T00:00:00.000
2024-11-20 23:07:18,878 - INFO - pnl: 2024-03-07T23:59:59.999 167935.19294930858 === 0.860%
2024-11-20 23:07:18,881 - DEBUG - cur time: 2024-03-08T23:59:59.999 == next bar open time: 2024-03-09T00:00:00.000 == close pos time: 2024-03-16T00:00:00.000
2024-11-20 23:07:18,883 - INFO - pnl: 2024-03-08T23:59:59.999 168299.6159387099 === 0.217%
2024-11-20 23:07:18,886 - DEBUG - cur time: 2024-03-09T23:59:59.999 == next bar open time: 2024-03-10T00:00:00.000 == close pos time: 2024-03-17T00:00:00.000
2024-11-20 23:07:18,888 - INFO - pnl: 2024-03-09T23:59:59.999 175729.4023152302 === 4.415%
2024-11-20 23:07:18,893 - DEBUG - cur time: 2024-03-10T23:59:59.999 == next bar open time: 2024-03-11T00:00:00.000 == close pos time: 2024-03-18T00:00:00.000
2024-11-20 23:07:18,894 - INFO - pnl: 2024-03-10T23:59:59.999 176333.28035971613 === 0.344%
2024-11-20 23:07:18,899 - DEBUG - cur time: 2024-03-11T23:59:59.999 == next bar open time: 2024-03-12T00:00:00.000 == close pos time: 2024-03-19T00:00:00.000
2024-11-20 23:07:18,901 - INFO - pnl: 2024-03-11T23:59:59.999 180181.77423484498 === 2.183%
2024-11-20 23:07:18,906 - DEBUG - cur time: 2024-03-12T23:59:59.999 == next bar open time: 2024-03-13T00:00:00.000 == close pos time: 2024-03-20T00:00:00.000
2024-11-20 23:07:18,917 - DEBUG - sorted_long_factors: shape: (225, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT     ┆ -2.349954    ┆ 0    ┆ 224          │
│ GASUSDT      ┆ -1.925425    ┆ 1    ┆ 223          │
│ TIAUSDT      ┆ -1.849231    ┆ 2    ┆ 222          │
│ POWRUSDT     ┆ -1.73098     ┆ 3    ┆ 221          │
│ CAKEUSDT     ┆ -1.702235    ┆ 4    ┆ 220          │
│ WLDUSDT      ┆ -1.636444    ┆ 5    ┆ 219          │
│ PYTHUSDT     ┆ -1.550313    ┆ 6    ┆ 218          │
│ EGLDUSDT     ┆ -1.501393    ┆ 7    ┆ 217          │
│ STXUSDT      ┆ -1.485359    ┆ 8    ┆ 216          │
│ BONDUSDT     ┆ -1.470836    ┆ 9    ┆ 215          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COMBOUSDT    ┆ -0.038137    ┆ 215  ┆ 9            │
│ PENDLEUSDT   ┆ -0.024514    ┆ 216  ┆ 8            │
│ CVXUSDT      ┆ -0.015764    ┆ 217  ┆ 7            │
│ AAVEUSDT     ┆ -0.010122    ┆ 218  ┆ 6            │
│ BALUSDT      ┆ 0.061896     ┆ 219  ┆ 5            │
│ DGBUSDT      ┆ 0.098301     ┆ 220  ┆ 4            │
│ ANTUSDT      ┆ 0.634685     ┆ 221  ┆ 3            │
│ IDEXUSDT     ┆ 0.703665     ┆ 222  ┆ 2            │
│ DEFIUSDT     ┆ 1.566801     ┆ 223  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.619771     ┆ 224  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:18,923 - WARNING - 2024-03-12T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:18,923 - INFO - cur close time: 2024-03-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:18,923 - DEBUG - mean expected ret (mean factor): -0.7788877809092383
2024-11-20 23:07:18,928 - DEBUG - begin to update pos: =========
2024-11-20 23:07:18,928 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,928 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028863    ┆ 0.26997     ┆ 0.18523     ┆ 0.008289    ┆ … ┆ 0.03769 ┆ null   ┆ null    ┆ 0.9435  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,935 - DEBUG - update position: 2024-03-12T23:59:59.999 === diff_trading_value: 346205.5102502389 == cash: 182302.28497418328 
2024-11-20 23:07:18,936 - INFO - pnl: 2024-03-12T23:59:59.999 182302.28497418328 === 1.177%
2024-11-20 23:07:18,940 - DEBUG - cur time: 2024-03-13T23:59:59.999 == next bar open time: 2024-03-14T00:00:00.000 == close pos time: 2024-03-21T00:00:00.000
2024-11-20 23:07:18,941 - INFO - pnl: 2024-03-13T23:59:59.999 183479.32374133053 === 0.646%
2024-11-20 23:07:18,944 - DEBUG - cur time: 2024-03-14T23:59:59.999 == next bar open time: 2024-03-15T00:00:00.000 == close pos time: 2024-03-22T00:00:00.000
2024-11-20 23:07:18,945 - INFO - pnl: 2024-03-14T23:59:59.999 182872.53986851533 === -0.331%
2024-11-20 23:07:18,950 - DEBUG - cur time: 2024-03-15T23:59:59.999 == next bar open time: 2024-03-16T00:00:00.000 == close pos time: 2024-03-23T00:00:00.000
2024-11-20 23:07:18,950 - INFO - pnl: 2024-03-15T23:59:59.999 183041.13128632875 === 0.092%
2024-11-20 23:07:18,954 - DEBUG - cur time: 2024-03-16T23:59:59.999 == next bar open time: 2024-03-17T00:00:00.000 == close pos time: 2024-03-24T00:00:00.000
2024-11-20 23:07:18,957 - INFO - pnl: 2024-03-16T23:59:59.999 180678.07332788093 === -1.291%
2024-11-20 23:07:18,961 - DEBUG - cur time: 2024-03-17T23:59:59.999 == next bar open time: 2024-03-18T00:00:00.000 == close pos time: 2024-03-25T00:00:00.000
2024-11-20 23:07:18,962 - INFO - pnl: 2024-03-17T23:59:59.999 181609.70051780523 === 0.516%
2024-11-20 23:07:18,966 - DEBUG - cur time: 2024-03-18T23:59:59.999 == next bar open time: 2024-03-19T00:00:00.000 == close pos time: 2024-03-26T00:00:00.000
2024-11-20 23:07:18,969 - INFO - pnl: 2024-03-18T23:59:59.999 181691.01849517418 === 0.045%
2024-11-20 23:07:18,974 - DEBUG - cur time: 2024-03-19T23:59:59.999 == next bar open time: 2024-03-20T00:00:00.000 == close pos time: 2024-03-27T00:00:00.000
2024-11-20 23:07:18,984 - DEBUG - sorted_long_factors: shape: (226, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ JTOUSDT      ┆ -2.136652    ┆ 0    ┆ 225          │
│ APTUSDT      ┆ -2.052662    ┆ 1    ┆ 224          │
│ GASUSDT      ┆ -1.895398    ┆ 2    ┆ 223          │
│ BONDUSDT     ┆ -1.555895    ┆ 3    ┆ 222          │
│ FTMUSDT      ┆ -1.485682    ┆ 4    ┆ 221          │
│ TRXUSDT      ┆ -1.472532    ┆ 5    ┆ 220          │
│ MEMEUSDT     ┆ -1.407515    ┆ 6    ┆ 219          │
│ BTCDOMUSDT   ┆ -1.399456    ┆ 7    ┆ 218          │
│ PYTHUSDT     ┆ -1.387512    ┆ 8    ┆ 217          │
│ CYBERUSDT    ┆ -1.367939    ┆ 9    ┆ 216          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IDUSDT       ┆ -0.002047    ┆ 216  ┆ 9            │
│ CVXUSDT      ┆ 0.004519     ┆ 217  ┆ 8            │
│ IDEXUSDT     ┆ 0.070487     ┆ 218  ┆ 7            │
│ BALUSDT      ┆ 0.106704     ┆ 219  ┆ 6            │
│ OXTUSDT      ┆ 0.12454      ┆ 220  ┆ 5            │
│ PENDLEUSDT   ┆ 0.145081     ┆ 221  ┆ 4            │
│ COMBOUSDT    ┆ 0.268384     ┆ 222  ┆ 3            │
│ ANTUSDT      ┆ 0.785307     ┆ 223  ┆ 2            │
│ DEFIUSDT     ┆ 1.8241       ┆ 224  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.248778     ┆ 225  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:18,992 - WARNING - 2024-03-19T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:18,992 - INFO - cur close time: 2024-03-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:18,992 - DEBUG - mean expected ret (mean factor): -0.7760782088267923
2024-11-20 23:07:18,997 - DEBUG - begin to update pos: =========
2024-11-20 23:07:18,997 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:18,998 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.021598    ┆ 0.1772      ┆ 0.12732     ┆ 0.0066026   ┆ … ┆ 0.03084 ┆ null   ┆ null    ┆ 1.1389  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,009 - DEBUG - update position: 2024-03-19T23:59:59.999 === diff_trading_value: 216582.78367922234 == cash: 185486.19094002948 
2024-11-20 23:07:19,011 - INFO - pnl: 2024-03-19T23:59:59.999 175486.19094002948 === -3.415%
2024-11-20 23:07:19,014 - DEBUG - cur time: 2024-03-20T23:59:59.999 == next bar open time: 2024-03-21T00:00:00.000 == close pos time: 2024-03-28T00:00:00.000
2024-11-20 23:07:19,016 - INFO - pnl: 2024-03-20T23:59:59.999 180439.1503579203 === 2.822%
2024-11-20 23:07:19,020 - DEBUG - cur time: 2024-03-21T23:59:59.999 == next bar open time: 2024-03-22T00:00:00.000 == close pos time: 2024-03-29T00:00:00.000
2024-11-20 23:07:19,021 - INFO - pnl: 2024-03-21T23:59:59.999 183521.24181691857 === 1.708%
2024-11-20 23:07:19,026 - DEBUG - cur time: 2024-03-22T23:59:59.999 == next bar open time: 2024-03-23T00:00:00.000 == close pos time: 2024-03-30T00:00:00.000
2024-11-20 23:07:19,028 - INFO - pnl: 2024-03-22T23:59:59.999 183527.41247873096 === 0.003%
2024-11-20 23:07:19,033 - DEBUG - cur time: 2024-03-23T23:59:59.999 == next bar open time: 2024-03-24T00:00:00.000 == close pos time: 2024-03-31T00:00:00.000
2024-11-20 23:07:19,033 - INFO - pnl: 2024-03-23T23:59:59.999 185433.08100668437 === 1.038%
2024-11-20 23:07:19,039 - DEBUG - cur time: 2024-03-24T23:59:59.999 == next bar open time: 2024-03-25T00:00:00.000 == close pos time: 2024-04-01T00:00:00.000
2024-11-20 23:07:19,040 - INFO - pnl: 2024-03-24T23:59:59.999 188296.87139452316 === 1.544%
2024-11-20 23:07:19,045 - DEBUG - cur time: 2024-03-25T23:59:59.999 == next bar open time: 2024-03-26T00:00:00.000 == close pos time: 2024-04-02T00:00:00.000
2024-11-20 23:07:19,047 - INFO - pnl: 2024-03-25T23:59:59.999 173722.46110415395 === -7.740%
2024-11-20 23:07:19,052 - DEBUG - cur time: 2024-03-26T23:59:59.999 == next bar open time: 2024-03-27T00:00:00.000 == close pos time: 2024-04-03T00:00:00.000
2024-11-20 23:07:19,061 - DEBUG - sorted_long_factors: shape: (224, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ JTOUSDT    ┆ -2.280554    ┆ 0    ┆ 223          │
│ ICPUSDT    ┆ -2.008758    ┆ 1    ┆ 222          │
│ BONDUSDT   ┆ -1.952407    ┆ 2    ┆ 221          │
│ MASKUSDT   ┆ -1.872749    ┆ 3    ┆ 220          │
│ IDUSDT     ┆ -1.863098    ┆ 4    ┆ 219          │
│ ZRXUSDT    ┆ -1.807522    ┆ 5    ┆ 218          │
│ HIFIUSDT   ┆ -1.79563     ┆ 6    ┆ 217          │
│ TIAUSDT    ┆ -1.789578    ┆ 7    ┆ 216          │
│ INJUSDT    ┆ -1.760647    ┆ 8    ┆ 215          │
│ BTCDOMUSDT ┆ -1.701807    ┆ 9    ┆ 214          │
│ …          ┆ …            ┆ …    ┆ …            │
│ TUSDT      ┆ -0.081986    ┆ 214  ┆ 9            │
│ STXUSDT    ┆ -0.067662    ┆ 215  ┆ 8            │
│ MAVUSDT    ┆ -0.040793    ┆ 216  ┆ 7            │
│ BALUSDT    ┆ -0.038014    ┆ 217  ┆ 6            │
│ SFPUSDT    ┆ -0.030438    ┆ 218  ┆ 5            │
│ DENTUSDT   ┆ -0.016482    ┆ 219  ┆ 4            │
│ IMXUSDT    ┆ -0.011686    ┆ 220  ┆ 3            │
│ XVGUSDT    ┆ 0.087511     ┆ 221  ┆ 2            │
│ OXTUSDT    ┆ 0.808516     ┆ 222  ┆ 1            │
│ DEFIUSDT   ┆ 1.507626     ┆ 223  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:19,069 - WARNING - 2024-03-26T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:19,069 - INFO - cur close time: 2024-03-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:19,069 - DEBUG - mean expected ret (mean factor): -0.8099207140895768
2024-11-20 23:07:19,073 - DEBUG - begin to update pos: =========
2024-11-20 23:07:19,073 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬─────────┬──────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT  │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---      │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64      │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆         ┆          │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪═════════╪══════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ -10000.0 │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴─────────┴──────────┘
2024-11-20 23:07:19,073 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.026894    ┆ 0.24123     ┆ 0.15992     ┆ 0.0080402   ┆ … ┆ 0.03741 ┆ null   ┆ null    ┆ 1.048   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,080 - DEBUG - update position: 2024-03-26T23:59:59.999 === diff_trading_value: 290591.9506391741 == cash: 175551.89669302205 
2024-11-20 23:07:19,081 - INFO - pnl: 2024-03-26T23:59:59.999 175551.89669302205 === 1.053%
2024-11-20 23:07:19,085 - DEBUG - cur time: 2024-03-27T23:59:59.999 == next bar open time: 2024-03-28T00:00:00.000 == close pos time: 2024-04-04T00:00:00.000
2024-11-20 23:07:19,087 - INFO - pnl: 2024-03-27T23:59:59.999 172684.6891335956 === -1.633%
2024-11-20 23:07:19,090 - DEBUG - cur time: 2024-03-28T23:59:59.999 == next bar open time: 2024-03-29T00:00:00.000 == close pos time: 2024-04-05T00:00:00.000
2024-11-20 23:07:19,093 - INFO - pnl: 2024-03-28T23:59:59.999 172968.51176616515 === 0.164%
2024-11-20 23:07:19,097 - DEBUG - cur time: 2024-03-29T23:59:59.999 == next bar open time: 2024-03-30T00:00:00.000 == close pos time: 2024-04-06T00:00:00.000
2024-11-20 23:07:19,099 - INFO - pnl: 2024-03-29T23:59:59.999 178974.9088992625 === 3.473%
2024-11-20 23:07:19,102 - DEBUG - cur time: 2024-03-30T23:59:59.999 == next bar open time: 2024-03-31T00:00:00.000 == close pos time: 2024-04-07T00:00:00.000
2024-11-20 23:07:19,104 - INFO - pnl: 2024-03-30T23:59:59.999 180628.28737488823 === 0.924%
2024-11-20 23:07:19,108 - DEBUG - cur time: 2024-03-31T23:59:59.999 == next bar open time: 2024-04-01T00:00:00.000 == close pos time: 2024-04-08T00:00:00.000
2024-11-20 23:07:19,111 - INFO - pnl: 2024-03-31T23:59:59.999 177920.2211601695 === -1.499%
2024-11-20 23:07:19,117 - DEBUG - cur time: 2024-04-01T23:59:59.999 == next bar open time: 2024-04-02T00:00:00.000 == close pos time: 2024-04-09T00:00:00.000
2024-11-20 23:07:19,119 - INFO - pnl: 2024-04-01T23:59:59.999 180761.33559110685 === 1.597%
2024-11-20 23:07:19,124 - DEBUG - cur time: 2024-04-02T23:59:59.999 == next bar open time: 2024-04-03T00:00:00.000 == close pos time: 2024-04-10T00:00:00.000
2024-11-20 23:07:19,133 - DEBUG - sorted_long_factors: shape: (225, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ BONDUSDT    ┆ -2.227656    ┆ 0    ┆ 224          │
│ AUCTIONUSDT ┆ -1.988991    ┆ 1    ┆ 223          │
│ ORDIUSDT    ┆ -1.789882    ┆ 2    ┆ 222          │
│ MKRUSDT     ┆ -1.733435    ┆ 3    ┆ 221          │
│ MASKUSDT    ┆ -1.645061    ┆ 4    ┆ 220          │
│ WAVESUSDT   ┆ -1.512213    ┆ 5    ┆ 219          │
│ BSVUSDT     ┆ -1.512189    ┆ 6    ┆ 218          │
│ GASUSDT     ┆ -1.476893    ┆ 7    ┆ 217          │
│ ILVUSDT     ┆ -1.464221    ┆ 8    ┆ 216          │
│ RNDRUSDT    ┆ -1.442681    ┆ 9    ┆ 215          │
│ …           ┆ …            ┆ …    ┆ …            │
│ ZECUSDT     ┆ -0.085111    ┆ 215  ┆ 9            │
│ HFTUSDT     ┆ -0.004613    ┆ 216  ┆ 8            │
│ ALPHAUSDT   ┆ 0.079611     ┆ 217  ┆ 7            │
│ BNTUSDT     ┆ 0.087356     ┆ 218  ┆ 6            │
│ SNTUSDT     ┆ 0.209974     ┆ 219  ┆ 5            │
│ DENTUSDT    ┆ 0.268086     ┆ 220  ┆ 4            │
│ SFPUSDT     ┆ 0.355789     ┆ 221  ┆ 3            │
│ CVXUSDT     ┆ 0.63848      ┆ 222  ┆ 2            │
│ OXTUSDT     ┆ 0.794344     ┆ 223  ┆ 1            │
│ DEFIUSDT    ┆ 3.023859     ┆ 224  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:19,141 - WARNING - 2024-04-02T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:19,141 - INFO - cur close time: 2024-04-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:19,141 - DEBUG - mean expected ret (mean factor): -0.7747383960450133
2024-11-20 23:07:19,147 - DEBUG - begin to update pos: =========
2024-11-20 23:07:19,147 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,148 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022675    ┆ 0.2095      ┆ 0.13708     ┆ 0.0072585   ┆ … ┆ 0.03259 ┆ null   ┆ null    ┆ 0.6554  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,154 - DEBUG - update position: 2024-04-02T23:59:59.999 === diff_trading_value: 270374.6297679319 == cash: 182217.75142397464 
2024-11-20 23:07:19,155 - INFO - pnl: 2024-04-02T23:59:59.999 182217.75142397464 === 0.806%
2024-11-20 23:07:19,159 - DEBUG - cur time: 2024-04-03T23:59:59.999 == next bar open time: 2024-04-04T00:00:00.000 == close pos time: 2024-04-11T00:00:00.000
2024-11-20 23:07:19,160 - INFO - pnl: 2024-04-03T23:59:59.999 184966.04942289324 === 1.508%
2024-11-20 23:07:19,165 - DEBUG - cur time: 2024-04-04T23:59:59.999 == next bar open time: 2024-04-05T00:00:00.000 == close pos time: 2024-04-12T00:00:00.000
2024-11-20 23:07:19,166 - INFO - pnl: 2024-04-04T23:59:59.999 183127.7622723793 === -0.994%
2024-11-20 23:07:19,170 - DEBUG - cur time: 2024-04-05T23:59:59.999 == next bar open time: 2024-04-06T00:00:00.000 == close pos time: 2024-04-13T00:00:00.000
2024-11-20 23:07:19,172 - INFO - pnl: 2024-04-05T23:59:59.999 183504.17038167742 === 0.206%
2024-11-20 23:07:19,175 - DEBUG - cur time: 2024-04-06T23:59:59.999 == next bar open time: 2024-04-07T00:00:00.000 == close pos time: 2024-04-14T00:00:00.000
2024-11-20 23:07:19,176 - INFO - pnl: 2024-04-06T23:59:59.999 181569.41747890523 === -1.054%
2024-11-20 23:07:19,179 - DEBUG - cur time: 2024-04-07T23:59:59.999 == next bar open time: 2024-04-08T00:00:00.000 == close pos time: 2024-04-15T00:00:00.000
2024-11-20 23:07:19,180 - INFO - pnl: 2024-04-07T23:59:59.999 183498.21867179038 === 1.062%
2024-11-20 23:07:19,183 - DEBUG - cur time: 2024-04-08T23:59:59.999 == next bar open time: 2024-04-09T00:00:00.000 == close pos time: 2024-04-16T00:00:00.000
2024-11-20 23:07:19,184 - INFO - pnl: 2024-04-08T23:59:59.999 187287.86354594148 === 2.065%
2024-11-20 23:07:19,187 - DEBUG - cur time: 2024-04-09T23:59:59.999 == next bar open time: 2024-04-10T00:00:00.000 == close pos time: 2024-04-17T00:00:00.000
2024-11-20 23:07:19,196 - DEBUG - sorted_long_factors: shape: (227, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ AUCTIONUSDT ┆ -1.991513    ┆ 0    ┆ 226          │
│ TRBUSDT     ┆ -1.983281    ┆ 1    ┆ 225          │
│ ILVUSDT     ┆ -1.889865    ┆ 2    ┆ 224          │
│ PYTHUSDT    ┆ -1.699076    ┆ 3    ┆ 223          │
│ WAVESUSDT   ┆ -1.650259    ┆ 4    ┆ 222          │
│ KAVAUSDT    ┆ -1.602867    ┆ 5    ┆ 221          │
│ AAVEUSDT    ┆ -1.593126    ┆ 6    ┆ 220          │
│ MASKUSDT    ┆ -1.507069    ┆ 7    ┆ 219          │
│ SUIUSDT     ┆ -1.492489    ┆ 8    ┆ 218          │
│ UNIUSDT     ┆ -1.485168    ┆ 9    ┆ 217          │
│ …           ┆ …            ┆ …    ┆ …            │
│ RUNEUSDT    ┆ -0.066154    ┆ 217  ┆ 9            │
│ COMBOUSDT   ┆ -0.066032    ┆ 218  ┆ 8            │
│ PHBUSDT     ┆ -0.039602    ┆ 219  ┆ 7            │
│ STPTUSDT    ┆ -0.017535    ┆ 220  ┆ 6            │
│ OXTUSDT     ┆ 0.104521     ┆ 221  ┆ 5            │
│ NMRUSDT     ┆ 0.166894     ┆ 222  ┆ 4            │
│ XMRUSDT     ┆ 0.208547     ┆ 223  ┆ 3            │
│ DODOXUSDT   ┆ 0.356929     ┆ 224  ┆ 2            │
│ CVXUSDT     ┆ 0.698623     ┆ 225  ┆ 1            │
│ DEFIUSDT    ┆ 1.716885     ┆ 226  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:19,204 - WARNING - 2024-04-09T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:19,204 - INFO - cur close time: 2024-04-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:19,204 - DEBUG - mean expected ret (mean factor): -0.7819722804038319
2024-11-20 23:07:19,209 - DEBUG - begin to update pos: =========
2024-11-20 23:07:19,209 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,209 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022253    ┆ 0.19871     ┆ 0.13281     ┆ 0.0070415   ┆ … ┆ 0.03304 ┆ null   ┆ null    ┆ 0.6816  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,218 - DEBUG - update position: 2024-04-09T23:59:59.999 === diff_trading_value: 241089.52426895685 == cash: 189013.90431421768 
2024-11-20 23:07:19,220 - INFO - pnl: 2024-04-09T23:59:59.999 189013.90431421768 === 0.922%
2024-11-20 23:07:19,226 - DEBUG - cur time: 2024-04-10T23:59:59.999 == next bar open time: 2024-04-11T00:00:00.000 == close pos time: 2024-04-18T00:00:00.000
2024-11-20 23:07:19,229 - INFO - pnl: 2024-04-10T23:59:59.999 190359.75615784648 === 0.712%
2024-11-20 23:07:19,234 - DEBUG - cur time: 2024-04-11T23:59:59.999 == next bar open time: 2024-04-12T00:00:00.000 == close pos time: 2024-04-19T00:00:00.000
2024-11-20 23:07:19,237 - INFO - pnl: 2024-04-11T23:59:59.999 193283.34931030183 === 1.536%
2024-11-20 23:07:19,243 - DEBUG - cur time: 2024-04-12T23:59:59.999 == next bar open time: 2024-04-13T00:00:00.000 == close pos time: 2024-04-20T00:00:00.000
2024-11-20 23:07:19,246 - INFO - pnl: 2024-04-12T23:59:59.999 191418.92685967835 === -0.965%
2024-11-20 23:07:19,251 - DEBUG - cur time: 2024-04-13T23:59:59.999 == next bar open time: 2024-04-14T00:00:00.000 == close pos time: 2024-04-21T00:00:00.000
2024-11-20 23:07:19,253 - INFO - pnl: 2024-04-13T23:59:59.999 190599.1867462236 === -0.428%
2024-11-20 23:07:19,259 - DEBUG - cur time: 2024-04-14T23:59:59.999 == next bar open time: 2024-04-15T00:00:00.000 == close pos time: 2024-04-22T00:00:00.000
2024-11-20 23:07:19,261 - INFO - pnl: 2024-04-14T23:59:59.999 192051.42218492323 === 0.762%
2024-11-20 23:07:19,266 - DEBUG - cur time: 2024-04-15T23:59:59.999 == next bar open time: 2024-04-16T00:00:00.000 == close pos time: 2024-04-23T00:00:00.000
2024-11-20 23:07:19,268 - INFO - pnl: 2024-04-15T23:59:59.999 193165.36446805787 === 0.580%
2024-11-20 23:07:19,271 - DEBUG - cur time: 2024-04-16T23:59:59.999 == next bar open time: 2024-04-17T00:00:00.000 == close pos time: 2024-04-24T00:00:00.000
2024-11-20 23:07:19,287 - DEBUG - sorted_long_factors: shape: (227, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ONTUSDT      ┆ -2.105656    ┆ 0    ┆ 226          │
│ HIGHUSDT     ┆ -1.950253    ┆ 1    ┆ 225          │
│ AUCTIONUSDT  ┆ -1.85765     ┆ 2    ┆ 224          │
│ BTCDOMUSDT   ┆ -1.804231    ┆ 3    ┆ 223          │
│ BELUSDT      ┆ -1.795958    ┆ 4    ┆ 222          │
│ ONGUSDT      ┆ -1.780193    ┆ 5    ┆ 221          │
│ 1000SATSUSDT ┆ -1.584556    ┆ 6    ┆ 220          │
│ BIGTIMEUSDT  ┆ -1.543174    ┆ 7    ┆ 219          │
│ GASUSDT      ┆ -1.513006    ┆ 8    ┆ 218          │
│ ORBSUSDT     ┆ -1.497733    ┆ 9    ┆ 217          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DUSKUSDT     ┆ 0.07709      ┆ 217  ┆ 9            │
│ HFTUSDT      ┆ 0.088487     ┆ 218  ┆ 8            │
│ AGLDUSDT     ┆ 0.095715     ┆ 219  ┆ 7            │
│ LITUSDT      ┆ 0.130166     ┆ 220  ┆ 6            │
│ COMBOUSDT    ┆ 0.208363     ┆ 221  ┆ 5            │
│ QNTUSDT      ┆ 0.228026     ┆ 222  ┆ 4            │
│ DODOXUSDT    ┆ 0.273396     ┆ 223  ┆ 3            │
│ GTCUSDT      ┆ 0.283242     ┆ 224  ┆ 2            │
│ CVXUSDT      ┆ 0.43255      ┆ 225  ┆ 1            │
│ DEFIUSDT     ┆ 2.511889     ┆ 226  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:19,294 - WARNING - 2024-04-16T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:19,294 - INFO - cur close time: 2024-04-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:19,294 - DEBUG - mean expected ret (mean factor): -0.7898727746556554
2024-11-20 23:07:19,299 - DEBUG - begin to update pos: =========
2024-11-20 23:07:19,300 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,300 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.014672    ┆ 0.14184     ┆ 0.10174     ┆ 0.0054014   ┆ … ┆ 0.02422 ┆ null   ┆ null    ┆ 0.4929  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,306 - DEBUG - update position: 2024-04-16T23:59:59.999 === diff_trading_value: 267220.03544848866 == cash: 194587.33513375034 
2024-11-20 23:07:19,308 - INFO - pnl: 2024-04-16T23:59:59.999 194587.33513375034 === 0.736%
2024-11-20 23:07:19,310 - DEBUG - cur time: 2024-04-17T23:59:59.999 == next bar open time: 2024-04-18T00:00:00.000 == close pos time: 2024-04-25T00:00:00.000
2024-11-20 23:07:19,312 - INFO - pnl: 2024-04-17T23:59:59.999 196812.30215971213 === 1.143%
2024-11-20 23:07:19,316 - DEBUG - cur time: 2024-04-18T23:59:59.999 == next bar open time: 2024-04-19T00:00:00.000 == close pos time: 2024-04-26T00:00:00.000
2024-11-20 23:07:19,318 - INFO - pnl: 2024-04-18T23:59:59.999 193384.84293058355 === -1.741%
2024-11-20 23:07:19,322 - DEBUG - cur time: 2024-04-19T23:59:59.999 == next bar open time: 2024-04-20T00:00:00.000 == close pos time: 2024-04-27T00:00:00.000
2024-11-20 23:07:19,324 - INFO - pnl: 2024-04-19T23:59:59.999 191260.22295625947 === -1.099%
2024-11-20 23:07:19,327 - DEBUG - cur time: 2024-04-20T23:59:59.999 == next bar open time: 2024-04-21T00:00:00.000 == close pos time: 2024-04-28T00:00:00.000
2024-11-20 23:07:19,330 - INFO - pnl: 2024-04-20T23:59:59.999 192681.96546243172 === 0.743%
2024-11-20 23:07:19,334 - DEBUG - cur time: 2024-04-21T23:59:59.999 == next bar open time: 2024-04-22T00:00:00.000 == close pos time: 2024-04-29T00:00:00.000
2024-11-20 23:07:19,336 - INFO - pnl: 2024-04-21T23:59:59.999 190281.77110466975 === -1.246%
2024-11-20 23:07:19,340 - DEBUG - cur time: 2024-04-22T23:59:59.999 == next bar open time: 2024-04-23T00:00:00.000 == close pos time: 2024-04-30T00:00:00.000
2024-11-20 23:07:19,342 - INFO - pnl: 2024-04-22T23:59:59.999 189805.20943701133 === -0.250%
2024-11-20 23:07:19,345 - DEBUG - cur time: 2024-04-23T23:59:59.999 == next bar open time: 2024-04-24T00:00:00.000 == close pos time: 2024-05-01T00:00:00.000
2024-11-20 23:07:19,356 - DEBUG - sorted_long_factors: shape: (229, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ BIGTIMEUSDT ┆ -1.9594      ┆ 0    ┆ 228          │
│ JTOUSDT     ┆ -1.759721    ┆ 1    ┆ 227          │
│ ATAUSDT     ┆ -1.650851    ┆ 2    ┆ 226          │
│ MEMEUSDT    ┆ -1.594679    ┆ 3    ┆ 225          │
│ ONTUSDT     ┆ -1.585963    ┆ 4    ┆ 224          │
│ BNXUSDT     ┆ -1.56329     ┆ 5    ┆ 223          │
│ TIAUSDT     ┆ -1.544746    ┆ 6    ┆ 222          │
│ JASMYUSDT   ┆ -1.450814    ┆ 7    ┆ 221          │
│ BNBUSDT     ┆ -1.440406    ┆ 8    ┆ 220          │
│ ANKRUSDT    ┆ -1.438311    ┆ 9    ┆ 219          │
│ …           ┆ …            ┆ …    ┆ …            │
│ AGLDUSDT    ┆ -0.068691    ┆ 219  ┆ 9            │
│ FXSUSDT     ┆ -0.016373    ┆ 220  ┆ 8            │
│ RADUSDT     ┆ 0.001897     ┆ 221  ┆ 7            │
│ OXTUSDT     ┆ 0.01951      ┆ 222  ┆ 6            │
│ ALICEUSDT   ┆ 0.021397     ┆ 223  ┆ 5            │
│ DASHUSDT    ┆ 0.136207     ┆ 224  ┆ 4            │
│ KSMUSDT     ┆ 0.153626     ┆ 225  ┆ 3            │
│ NMRUSDT     ┆ 0.199129     ┆ 226  ┆ 2            │
│ CVXUSDT     ┆ 0.452106     ┆ 227  ┆ 1            │
│ DEFIUSDT    ┆ 3.064888     ┆ 228  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:19,362 - WARNING - 2024-04-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:19,363 - INFO - cur close time: 2024-04-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:19,363 - DEBUG - mean expected ret (mean factor): -0.7752869401394504
2024-11-20 23:07:19,368 - DEBUG - begin to update pos: =========
2024-11-20 23:07:19,368 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,369 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.02474     ┆ 0.19338     ┆ 0.11123     ┆ 0.0076765   ┆ … ┆ 0.02718 ┆ null   ┆ null    ┆ 0.5585  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,375 - DEBUG - update position: 2024-04-23T23:59:59.999 === diff_trading_value: 276766.2722868384 == cash: 191286.15396514814 
2024-11-20 23:07:19,376 - INFO - pnl: 2024-04-23T23:59:59.999 191286.15396514814 === 0.780%
2024-11-20 23:07:19,379 - DEBUG - cur time: 2024-04-24T23:59:59.999 == next bar open time: 2024-04-25T00:00:00.000 == close pos time: 2024-05-02T00:00:00.000
2024-11-20 23:07:19,380 - INFO - pnl: 2024-04-24T23:59:59.999 188057.65324239028 === -1.688%
2024-11-20 23:07:19,384 - DEBUG - cur time: 2024-04-25T23:59:59.999 == next bar open time: 2024-04-26T00:00:00.000 == close pos time: 2024-05-03T00:00:00.000
2024-11-20 23:07:19,385 - INFO - pnl: 2024-04-25T23:59:59.999 191120.91053474642 === 1.629%
2024-11-20 23:07:19,389 - DEBUG - cur time: 2024-04-26T23:59:59.999 == next bar open time: 2024-04-27T00:00:00.000 == close pos time: 2024-05-04T00:00:00.000
2024-11-20 23:07:19,391 - INFO - pnl: 2024-04-26T23:59:59.999 191040.71496446815 === -0.042%
2024-11-20 23:07:19,394 - DEBUG - cur time: 2024-04-27T23:59:59.999 == next bar open time: 2024-04-28T00:00:00.000 == close pos time: 2024-05-05T00:00:00.000
2024-11-20 23:07:19,395 - INFO - pnl: 2024-04-27T23:59:59.999 192683.23858343085 === 0.860%
2024-11-20 23:07:19,400 - DEBUG - cur time: 2024-04-28T23:59:59.999 == next bar open time: 2024-04-29T00:00:00.000 == close pos time: 2024-05-06T00:00:00.000
2024-11-20 23:07:19,401 - INFO - pnl: 2024-04-28T23:59:59.999 190717.11096492386 === -1.020%
2024-11-20 23:07:19,405 - DEBUG - cur time: 2024-04-29T23:59:59.999 == next bar open time: 2024-04-30T00:00:00.000 == close pos time: 2024-05-07T00:00:00.000
2024-11-20 23:07:19,407 - INFO - pnl: 2024-04-29T23:59:59.999 189331.87374004934 === -0.726%
2024-11-20 23:07:19,411 - DEBUG - cur time: 2024-04-30T23:59:59.999 == next bar open time: 2024-05-01T00:00:00.000 == close pos time: 2024-05-08T00:00:00.000
2024-11-20 23:07:19,421 - DEBUG - sorted_long_factors: shape: (232, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ XMRUSDT  ┆ -1.9474      ┆ 0    ┆ 231          │
│ WIFUSDT  ┆ -1.930866    ┆ 1    ┆ 230          │
│ JTOUSDT  ┆ -1.852404    ┆ 2    ┆ 229          │
│ NEOUSDT  ┆ -1.841004    ┆ 3    ┆ 228          │
│ TIAUSDT  ┆ -1.773758    ┆ 4    ┆ 227          │
│ HIGHUSDT ┆ -1.73685     ┆ 5    ┆ 226          │
│ ONGUSDT  ┆ -1.709641    ┆ 6    ┆ 225          │
│ LDOUSDT  ┆ -1.696019    ┆ 7    ┆ 224          │
│ SSVUSDT  ┆ -1.643888    ┆ 8    ┆ 223          │
│ GASUSDT  ┆ -1.620854    ┆ 9    ┆ 222          │
│ …        ┆ …            ┆ …    ┆ …            │
│ IDEXUSDT ┆ 0.060951     ┆ 222  ┆ 9            │
│ TLMUSDT  ┆ 0.093273     ┆ 223  ┆ 8            │
│ ZENUSDT  ┆ 0.097168     ┆ 224  ┆ 7            │
│ AGLDUSDT ┆ 0.117156     ┆ 225  ┆ 6            │
│ CVXUSDT  ┆ 0.121334     ┆ 226  ┆ 5            │
│ MDTUSDT  ┆ 0.293918     ┆ 227  ┆ 4            │
│ RADUSDT  ┆ 0.395057     ┆ 228  ┆ 3            │
│ NMRUSDT  ┆ 0.650913     ┆ 229  ┆ 2            │
│ OXTUSDT  ┆ 0.651029     ┆ 230  ┆ 1            │
│ DEFIUSDT ┆ 2.774228     ┆ 231  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:19,430 - WARNING - 2024-04-30T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:19,430 - INFO - cur close time: 2024-04-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:19,431 - DEBUG - mean expected ret (mean factor): -0.7749735104532846
2024-11-20 23:07:19,436 - DEBUG - begin to update pos: =========
2024-11-20 23:07:19,437 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,437 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022664    ┆ 0.15616     ┆ 0.09974     ┆ 0.0066671   ┆ … ┆ 0.02276 ┆ null   ┆ null    ┆ 0.4623  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,447 - DEBUG - update position: 2024-04-30T23:59:59.999 === diff_trading_value: 245881.75137985777 == cash: 190033.8775215574 
2024-11-20 23:07:19,449 - INFO - pnl: 2024-04-30T23:59:59.999 190033.8775215574 === 0.371%
2024-11-20 23:07:19,453 - DEBUG - cur time: 2024-05-01T23:59:59.999 == next bar open time: 2024-05-02T00:00:00.000 == close pos time: 2024-05-09T00:00:00.000
2024-11-20 23:07:19,455 - INFO - pnl: 2024-05-01T23:59:59.999 190712.1003122567 === 0.357%
2024-11-20 23:07:19,458 - DEBUG - cur time: 2024-05-02T23:59:59.999 == next bar open time: 2024-05-03T00:00:00.000 == close pos time: 2024-05-10T00:00:00.000
2024-11-20 23:07:19,461 - INFO - pnl: 2024-05-02T23:59:59.999 190431.09543964636 === -0.147%
2024-11-20 23:07:19,468 - DEBUG - cur time: 2024-05-03T23:59:59.999 == next bar open time: 2024-05-04T00:00:00.000 == close pos time: 2024-05-11T00:00:00.000
2024-11-20 23:07:19,471 - INFO - pnl: 2024-05-03T23:59:59.999 190066.62132609898 === -0.191%
2024-11-20 23:07:19,475 - DEBUG - cur time: 2024-05-04T23:59:59.999 == next bar open time: 2024-05-05T00:00:00.000 == close pos time: 2024-05-12T00:00:00.000
2024-11-20 23:07:19,477 - INFO - pnl: 2024-05-04T23:59:59.999 188087.75332186342 === -1.041%
2024-11-20 23:07:19,482 - DEBUG - cur time: 2024-05-05T23:59:59.999 == next bar open time: 2024-05-06T00:00:00.000 == close pos time: 2024-05-13T00:00:00.000
2024-11-20 23:07:19,483 - INFO - pnl: 2024-05-05T23:59:59.999 190230.24714008847 === 1.139%
2024-11-20 23:07:19,486 - DEBUG - cur time: 2024-05-06T23:59:59.999 == next bar open time: 2024-05-07T00:00:00.000 == close pos time: 2024-05-14T00:00:00.000
2024-11-20 23:07:19,489 - INFO - pnl: 2024-05-06T23:59:59.999 188968.44907103913 === -0.663%
2024-11-20 23:07:19,494 - DEBUG - cur time: 2024-05-07T23:59:59.999 == next bar open time: 2024-05-08T00:00:00.000 == close pos time: 2024-05-15T00:00:00.000
2024-11-20 23:07:19,506 - DEBUG - sorted_long_factors: shape: (231, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LDOUSDT      ┆ -1.940245    ┆ 0    ┆ 230          │
│ GASUSDT      ┆ -1.93055     ┆ 1    ┆ 229          │
│ POWRUSDT     ┆ -1.888744    ┆ 2    ┆ 228          │
│ RNDRUSDT     ┆ -1.882839    ┆ 3    ┆ 227          │
│ LPTUSDT      ┆ -1.863449    ┆ 4    ┆ 226          │
│ USDCUSDT     ┆ -1.826178    ┆ 5    ┆ 225          │
│ WAVESUSDT    ┆ -1.791963    ┆ 6    ┆ 224          │
│ ONGUSDT      ┆ -1.706075    ┆ 7    ┆ 223          │
│ RLCUSDT      ┆ -1.687879    ┆ 8    ┆ 222          │
│ 1000SATSUSDT ┆ -1.683944    ┆ 9    ┆ 221          │
│ …            ┆ …            ┆ …    ┆ …            │
│ FXSUSDT      ┆ 0.018595     ┆ 221  ┆ 9            │
│ ZENUSDT      ┆ 0.033995     ┆ 222  ┆ 8            │
│ PERPUSDT     ┆ 0.110898     ┆ 223  ┆ 7            │
│ DODOXUSDT    ┆ 0.247073     ┆ 224  ┆ 6            │
│ GMXUSDT      ┆ 0.312739     ┆ 225  ┆ 5            │
│ HFTUSDT      ┆ 0.370594     ┆ 226  ┆ 4            │
│ AGLDUSDT     ┆ 0.464538     ┆ 227  ┆ 3            │
│ QNTUSDT      ┆ 0.480003     ┆ 228  ┆ 2            │
│ XVSUSDT      ┆ 0.49425      ┆ 229  ┆ 1            │
│ DEFIUSDT     ┆ 2.631977     ┆ 230  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:19,515 - WARNING - 2024-05-07T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:19,515 - INFO - cur close time: 2024-05-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:19,515 - DEBUG - mean expected ret (mean factor): -0.7755932886590026
2024-11-20 23:07:19,520 - DEBUG - begin to update pos: =========
2024-11-20 23:07:19,520 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,521 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023788    ┆ 0.17124     ┆ 0.10276     ┆ 0.0079028   ┆ … ┆ 0.02359 ┆ null   ┆ null    ┆ 0.4753  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,528 - DEBUG - update position: 2024-05-07T23:59:59.999 === diff_trading_value: 264032.78768649313 == cash: 178901.7089352095 
2024-11-20 23:07:19,529 - INFO - pnl: 2024-05-07T23:59:59.999 178901.7089352095 === -5.327%
2024-11-20 23:07:19,534 - DEBUG - cur time: 2024-05-08T23:59:59.999 == next bar open time: 2024-05-09T00:00:00.000 == close pos time: 2024-05-16T00:00:00.000
2024-11-20 23:07:19,535 - INFO - pnl: 2024-05-08T23:59:59.999 178223.18223709732 === -0.379%
2024-11-20 23:07:19,539 - DEBUG - cur time: 2024-05-09T23:59:59.999 == next bar open time: 2024-05-10T00:00:00.000 == close pos time: 2024-05-17T00:00:00.000
2024-11-20 23:07:19,542 - INFO - pnl: 2024-05-09T23:59:59.999 176563.19428377907 === -0.931%
2024-11-20 23:07:19,546 - DEBUG - cur time: 2024-05-10T23:59:59.999 == next bar open time: 2024-05-11T00:00:00.000 == close pos time: 2024-05-18T00:00:00.000
2024-11-20 23:07:19,548 - INFO - pnl: 2024-05-10T23:59:59.999 175825.4696256598 === -0.418%
2024-11-20 23:07:19,554 - DEBUG - cur time: 2024-05-11T23:59:59.999 == next bar open time: 2024-05-12T00:00:00.000 == close pos time: 2024-05-19T00:00:00.000
2024-11-20 23:07:19,556 - INFO - pnl: 2024-05-11T23:59:59.999 173748.16037017966 === -1.181%
2024-11-20 23:07:19,561 - DEBUG - cur time: 2024-05-12T23:59:59.999 == next bar open time: 2024-05-13T00:00:00.000 == close pos time: 2024-05-20T00:00:00.000
2024-11-20 23:07:19,563 - INFO - pnl: 2024-05-12T23:59:59.999 172266.73230318486 === -0.853%
2024-11-20 23:07:19,568 - DEBUG - cur time: 2024-05-13T23:59:59.999 == next bar open time: 2024-05-14T00:00:00.000 == close pos time: 2024-05-21T00:00:00.000
2024-11-20 23:07:19,570 - INFO - pnl: 2024-05-13T23:59:59.999 173516.43345596202 === 0.725%
2024-11-20 23:07:19,576 - DEBUG - cur time: 2024-05-14T23:59:59.999 == next bar open time: 2024-05-15T00:00:00.000 == close pos time: 2024-05-22T00:00:00.000
2024-11-20 23:07:19,588 - DEBUG - sorted_long_factors: shape: (227, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TIAUSDT   ┆ -2.143241    ┆ 0    ┆ 226          │
│ JTOUSDT   ┆ -1.848057    ┆ 1    ┆ 225          │
│ JUPUSDT   ┆ -1.79118     ┆ 2    ┆ 224          │
│ SUPERUSDT ┆ -1.695061    ┆ 3    ┆ 223          │
│ LSKUSDT   ┆ -1.670567    ┆ 4    ┆ 222          │
│ ARKUSDT   ┆ -1.659339    ┆ 5    ┆ 221          │
│ MOVRUSDT  ┆ -1.648874    ┆ 6    ┆ 220          │
│ WAVESUSDT ┆ -1.616165    ┆ 7    ┆ 219          │
│ SUIUSDT   ┆ -1.579109    ┆ 8    ┆ 218          │
│ USDCUSDT  ┆ -1.565451    ┆ 9    ┆ 217          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CYBERUSDT ┆ 0.081347     ┆ 217  ┆ 9            │
│ HFTUSDT   ┆ 0.091463     ┆ 218  ┆ 8            │
│ C98USDT   ┆ 0.145455     ┆ 219  ┆ 7            │
│ IOTXUSDT  ┆ 0.165124     ┆ 220  ┆ 6            │
│ DARUSDT   ┆ 0.175648     ┆ 221  ┆ 5            │
│ DENTUSDT  ┆ 0.218891     ┆ 222  ┆ 4            │
│ OGNUSDT   ┆ 0.44544      ┆ 223  ┆ 3            │
│ ETHWUSDT  ┆ 0.461245     ┆ 224  ┆ 2            │
│ DODOXUSDT ┆ 0.667711     ┆ 225  ┆ 1            │
│ DEFIUSDT  ┆ 1.287686     ┆ 226  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:19,598 - WARNING - 2024-05-14T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:19,599 - INFO - cur close time: 2024-05-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:19,599 - DEBUG - mean expected ret (mean factor): -0.79227509809638
2024-11-20 23:07:19,608 - DEBUG - begin to update pos: =========
2024-11-20 23:07:19,608 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,608 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.02291     ┆ 0.18883     ┆ 0.10201     ┆ 0.0105653   ┆ … ┆ 0.02167 ┆ null   ┆ null    ┆ 0.4401  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,616 - DEBUG - update position: 2024-05-14T23:59:59.999 === diff_trading_value: 271509.6064992298 == cash: 173440.8440963871 
2024-11-20 23:07:19,617 - INFO - pnl: 2024-05-14T23:59:59.999 173440.8440963871 === -0.044%
2024-11-20 23:07:19,621 - DEBUG - cur time: 2024-05-15T23:59:59.999 == next bar open time: 2024-05-16T00:00:00.000 == close pos time: 2024-05-23T00:00:00.000
2024-11-20 23:07:19,624 - INFO - pnl: 2024-05-15T23:59:59.999 173936.45782958914 === 0.286%
2024-11-20 23:07:19,630 - DEBUG - cur time: 2024-05-16T23:59:59.999 == next bar open time: 2024-05-17T00:00:00.000 == close pos time: 2024-05-24T00:00:00.000
2024-11-20 23:07:19,631 - INFO - pnl: 2024-05-16T23:59:59.999 172588.98107194254 === -0.775%
2024-11-20 23:07:19,637 - DEBUG - cur time: 2024-05-17T23:59:59.999 == next bar open time: 2024-05-18T00:00:00.000 == close pos time: 2024-05-25T00:00:00.000
2024-11-20 23:07:19,641 - INFO - pnl: 2024-05-17T23:59:59.999 172360.1657502624 === -0.133%
2024-11-20 23:07:19,648 - DEBUG - cur time: 2024-05-18T23:59:59.999 == next bar open time: 2024-05-19T00:00:00.000 == close pos time: 2024-05-26T00:00:00.000
2024-11-20 23:07:19,649 - INFO - pnl: 2024-05-18T23:59:59.999 173156.13008068927 === 0.462%
2024-11-20 23:07:19,653 - DEBUG - cur time: 2024-05-19T23:59:59.999 == next bar open time: 2024-05-20T00:00:00.000 == close pos time: 2024-05-27T00:00:00.000
2024-11-20 23:07:19,656 - INFO - pnl: 2024-05-19T23:59:59.999 172923.9130711751 === -0.134%
2024-11-20 23:07:19,659 - DEBUG - cur time: 2024-05-20T23:59:59.999 == next bar open time: 2024-05-21T00:00:00.000 == close pos time: 2024-05-28T00:00:00.000
2024-11-20 23:07:19,661 - INFO - pnl: 2024-05-20T23:59:59.999 176441.6440077984 === 2.034%
2024-11-20 23:07:19,667 - DEBUG - cur time: 2024-05-21T23:59:59.999 == next bar open time: 2024-05-22T00:00:00.000 == close pos time: 2024-05-29T00:00:00.000
2024-11-20 23:07:19,676 - DEBUG - sorted_long_factors: shape: (229, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ RNDRUSDT    ┆ -2.277284    ┆ 0    ┆ 228          │
│ WLDUSDT     ┆ -2.232532    ┆ 1    ┆ 227          │
│ BNBUSDT     ┆ -2.190013    ┆ 2    ┆ 226          │
│ XMRUSDT     ┆ -2.037458    ┆ 3    ┆ 225          │
│ MOVRUSDT    ┆ -2.012069    ┆ 4    ┆ 224          │
│ ORDIUSDT    ┆ -1.945176    ┆ 5    ┆ 223          │
│ TIAUSDT     ┆ -1.711097    ┆ 6    ┆ 222          │
│ PENDLEUSDT  ┆ -1.676618    ┆ 7    ┆ 221          │
│ AUCTIONUSDT ┆ -1.670168    ┆ 8    ┆ 220          │
│ XAIUSDT     ┆ -1.629446    ┆ 9    ┆ 219          │
│ …           ┆ …            ┆ …    ┆ …            │
│ RENUSDT     ┆ 0.080668     ┆ 219  ┆ 9            │
│ GALUSDT     ┆ 0.093902     ┆ 220  ┆ 8            │
│ KEYUSDT     ┆ 0.163882     ┆ 221  ┆ 7            │
│ OXTUSDT     ┆ 0.253156     ┆ 222  ┆ 6            │
│ JOEUSDT     ┆ 0.257522     ┆ 223  ┆ 5            │
│ TLMUSDT     ┆ 0.258066     ┆ 224  ┆ 4            │
│ DARUSDT     ┆ 0.339619     ┆ 225  ┆ 3            │
│ OGNUSDT     ┆ 0.36372      ┆ 226  ┆ 2            │
│ DODOXUSDT   ┆ 1.677815     ┆ 227  ┆ 1            │
│ DEFIUSDT    ┆ 2.063044     ┆ 228  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:19,684 - WARNING - 2024-05-21T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:19,684 - INFO - cur close time: 2024-05-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:19,685 - DEBUG - mean expected ret (mean factor): -0.7707752777331962
2024-11-20 23:07:19,690 - DEBUG - begin to update pos: =========
2024-11-20 23:07:19,690 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,690 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.032943    ┆ 0.22988     ┆ 0.11115     ┆ 0.013844    ┆ … ┆ 0.02472 ┆ null   ┆ null    ┆ 0.5744  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,699 - DEBUG - update position: 2024-05-21T23:59:59.999 === diff_trading_value: 280570.7022032645 == cash: 179260.70356369516 
2024-11-20 23:07:19,700 - INFO - pnl: 2024-05-21T23:59:59.999 179260.70356369516 === 1.598%
2024-11-20 23:07:19,708 - DEBUG - cur time: 2024-05-22T23:59:59.999 == next bar open time: 2024-05-23T00:00:00.000 == close pos time: 2024-05-30T00:00:00.000
2024-11-20 23:07:19,710 - INFO - pnl: 2024-05-22T23:59:59.999 181957.90871522774 === 1.505%
2024-11-20 23:07:19,715 - DEBUG - cur time: 2024-05-23T23:59:59.999 == next bar open time: 2024-05-24T00:00:00.000 == close pos time: 2024-05-31T00:00:00.000
2024-11-20 23:07:19,717 - INFO - pnl: 2024-05-23T23:59:59.999 182573.26294945198 === 0.338%
2024-11-20 23:07:19,722 - DEBUG - cur time: 2024-05-24T23:59:59.999 == next bar open time: 2024-05-25T00:00:00.000 == close pos time: 2024-06-01T00:00:00.000
2024-11-20 23:07:19,723 - INFO - pnl: 2024-05-24T23:59:59.999 185558.50346924708 === 1.635%
2024-11-20 23:07:19,727 - DEBUG - cur time: 2024-05-25T23:59:59.999 == next bar open time: 2024-05-26T00:00:00.000 == close pos time: 2024-06-02T00:00:00.000
2024-11-20 23:07:19,730 - INFO - pnl: 2024-05-25T23:59:59.999 185353.5901917226 === -0.110%
2024-11-20 23:07:19,735 - DEBUG - cur time: 2024-05-26T23:59:59.999 == next bar open time: 2024-05-27T00:00:00.000 == close pos time: 2024-06-03T00:00:00.000
2024-11-20 23:07:19,738 - INFO - pnl: 2024-05-26T23:59:59.999 182411.3551899143 === -1.587%
2024-11-20 23:07:19,743 - DEBUG - cur time: 2024-05-27T23:59:59.999 == next bar open time: 2024-05-28T00:00:00.000 == close pos time: 2024-06-04T00:00:00.000
2024-11-20 23:07:19,745 - INFO - pnl: 2024-05-27T23:59:59.999 185033.351578145 === 1.437%
2024-11-20 23:07:19,751 - DEBUG - cur time: 2024-05-28T23:59:59.999 == next bar open time: 2024-05-29T00:00:00.000 == close pos time: 2024-06-05T00:00:00.000
2024-11-20 23:07:19,766 - DEBUG - sorted_long_factors: shape: (230, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WIFUSDT      ┆ -1.930949    ┆ 0    ┆ 229          │
│ TIAUSDT      ┆ -1.923188    ┆ 1    ┆ 228          │
│ JTOUSDT      ┆ -1.898261    ┆ 2    ┆ 227          │
│ RNDRUSDT     ┆ -1.858663    ┆ 3    ┆ 226          │
│ LSKUSDT      ┆ -1.761158    ┆ 4    ┆ 225          │
│ ONDOUSDT     ┆ -1.745582    ┆ 5    ┆ 224          │
│ JUPUSDT      ┆ -1.688075    ┆ 6    ┆ 223          │
│ 1000SATSUSDT ┆ -1.648978    ┆ 7    ┆ 222          │
│ 1000RATSUSDT ┆ -1.631396    ┆ 8    ┆ 221          │
│ TRBUSDT      ┆ -1.561941    ┆ 9    ┆ 220          │
│ …            ┆ …            ┆ …    ┆ …            │
│ FLMUSDT      ┆ 0.120271     ┆ 220  ┆ 9            │
│ TLMUSDT      ┆ 0.148995     ┆ 221  ┆ 8            │
│ TUSDT        ┆ 0.203041     ┆ 222  ┆ 7            │
│ RVNUSDT      ┆ 0.208252     ┆ 223  ┆ 6            │
│ BALUSDT      ┆ 0.307579     ┆ 224  ┆ 5            │
│ BNTUSDT      ┆ 0.337507     ┆ 225  ┆ 4            │
│ OXTUSDT      ┆ 0.403185     ┆ 226  ┆ 3            │
│ DODOXUSDT    ┆ 0.55118      ┆ 227  ┆ 2            │
│ KSMUSDT      ┆ 0.586765     ┆ 228  ┆ 1            │
│ DEFIUSDT     ┆ 3.166577     ┆ 229  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:19,775 - INFO - cur close time: 2024-05-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:19,775 - DEBUG - mean expected ret (mean factor): -0.7757933963163572
2024-11-20 23:07:19,780 - DEBUG - begin to update pos: =========
2024-11-20 23:07:19,781 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,781 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.041152    ┆ 0.29484     ┆ 0.11473     ┆ 0.0160126   ┆ … ┆ 0.02484 ┆ null   ┆ null    ┆ 0.5476  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,787 - DEBUG - update position: 2024-05-28T23:59:59.999 === diff_trading_value: 277808.86943942716 == cash: 184654.56438560394 
2024-11-20 23:07:19,789 - INFO - pnl: 2024-05-28T23:59:59.999 184654.56438560394 === -0.205%
2024-11-20 23:07:19,793 - DEBUG - cur time: 2024-05-29T23:59:59.999 == next bar open time: 2024-05-30T00:00:00.000 == close pos time: 2024-06-06T00:00:00.000
2024-11-20 23:07:19,796 - INFO - pnl: 2024-05-29T23:59:59.999 185242.08385941933 === 0.318%
2024-11-20 23:07:19,800 - DEBUG - cur time: 2024-05-30T23:59:59.999 == next bar open time: 2024-05-31T00:00:00.000 == close pos time: 2024-06-07T00:00:00.000
2024-11-20 23:07:19,801 - INFO - pnl: 2024-05-30T23:59:59.999 182840.9558782923 === -1.296%
2024-11-20 23:07:19,807 - DEBUG - cur time: 2024-05-31T23:59:59.999 == next bar open time: 2024-06-01T00:00:00.000 == close pos time: 2024-06-08T00:00:00.000
2024-11-20 23:07:19,809 - INFO - pnl: 2024-05-31T23:59:59.999 186441.76090778373 === 1.969%
2024-11-20 23:07:19,813 - DEBUG - cur time: 2024-06-01T23:59:59.999 == next bar open time: 2024-06-02T00:00:00.000 == close pos time: 2024-06-09T00:00:00.000
2024-11-20 23:07:19,815 - INFO - pnl: 2024-06-01T23:59:59.999 184342.47065404244 === -1.126%
2024-11-20 23:07:19,818 - DEBUG - cur time: 2024-06-02T23:59:59.999 == next bar open time: 2024-06-03T00:00:00.000 == close pos time: 2024-06-10T00:00:00.000
2024-11-20 23:07:19,820 - INFO - pnl: 2024-06-02T23:59:59.999 186666.03904077015 === 1.260%
2024-11-20 23:07:19,825 - DEBUG - cur time: 2024-06-03T23:59:59.999 == next bar open time: 2024-06-04T00:00:00.000 == close pos time: 2024-06-11T00:00:00.000
2024-11-20 23:07:19,827 - INFO - pnl: 2024-06-03T23:59:59.999 192251.94191831493 === 2.992%
2024-11-20 23:07:19,832 - DEBUG - cur time: 2024-06-04T23:59:59.999 == next bar open time: 2024-06-05T00:00:00.000 == close pos time: 2024-06-12T00:00:00.000
2024-11-20 23:07:19,848 - DEBUG - sorted_long_factors: shape: (234, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ JTOUSDT    ┆ -1.965326    ┆ 0    ┆ 233          │
│ WIFUSDT    ┆ -1.923732    ┆ 1    ┆ 232          │
│ INJUSDT    ┆ -1.893487    ┆ 2    ┆ 231          │
│ RNDRUSDT   ┆ -1.878102    ┆ 3    ┆ 230          │
│ DOTUSDT    ┆ -1.816617    ┆ 4    ┆ 229          │
│ MANTAUSDT  ┆ -1.736834    ┆ 5    ┆ 228          │
│ NEOUSDT    ┆ -1.722598    ┆ 6    ┆ 227          │
│ ATOMUSDT   ┆ -1.682216    ┆ 7    ┆ 226          │
│ TRBUSDT    ┆ -1.662536    ┆ 8    ┆ 225          │
│ OPUSDT     ┆ -1.654581    ┆ 9    ┆ 224          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BTCDOMUSDT ┆ 0.114688     ┆ 224  ┆ 9            │
│ NMRUSDT    ┆ 0.150922     ┆ 225  ┆ 8            │
│ RVNUSDT    ┆ 0.179969     ┆ 226  ┆ 7            │
│ STMXUSDT   ┆ 0.207563     ┆ 227  ┆ 6            │
│ ORBSUSDT   ┆ 0.229475     ┆ 228  ┆ 5            │
│ DODOXUSDT  ┆ 0.352548     ┆ 229  ┆ 4            │
│ ICXUSDT    ┆ 0.354797     ┆ 230  ┆ 3            │
│ REEFUSDT   ┆ 0.391355     ┆ 231  ┆ 2            │
│ OXTUSDT    ┆ 0.447502     ┆ 232  ┆ 1            │
│ DEFIUSDT   ┆ 2.621039     ┆ 233  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:19,859 - WARNING - 2024-06-04T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:19,859 - INFO - cur close time: 2024-06-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:19,859 - DEBUG - mean expected ret (mean factor): -0.7857602385871143
2024-11-20 23:07:19,866 - DEBUG - begin to update pos: =========
2024-11-20 23:07:19,866 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,867 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.033173    ┆ 0.29607     ┆ 0.11918     ┆ 0.0143724   ┆ … ┆ 0.02362 ┆ null   ┆ null    ┆ 0.5249  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,876 - DEBUG - update position: 2024-06-04T23:59:59.999 === diff_trading_value: 230233.9748406447 == cash: 188761.13069595836 
2024-11-20 23:07:19,879 - INFO - pnl: 2024-06-04T23:59:59.999 188761.13069595836 === -1.816%
2024-11-20 23:07:19,884 - DEBUG - cur time: 2024-06-05T23:59:59.999 == next bar open time: 2024-06-06T00:00:00.000 == close pos time: 2024-06-13T00:00:00.000
2024-11-20 23:07:19,886 - INFO - pnl: 2024-06-05T23:59:59.999 187563.68075186564 === -0.634%
2024-11-20 23:07:19,892 - DEBUG - cur time: 2024-06-06T23:59:59.999 == next bar open time: 2024-06-07T00:00:00.000 == close pos time: 2024-06-14T00:00:00.000
2024-11-20 23:07:19,894 - INFO - pnl: 2024-06-06T23:59:59.999 186785.13629150734 === -0.415%
2024-11-20 23:07:19,900 - DEBUG - cur time: 2024-06-07T23:59:59.999 == next bar open time: 2024-06-08T00:00:00.000 == close pos time: 2024-06-15T00:00:00.000
2024-11-20 23:07:19,903 - INFO - pnl: 2024-06-07T23:59:59.999 187112.5305560025 === 0.175%
2024-11-20 23:07:19,910 - DEBUG - cur time: 2024-06-08T23:59:59.999 == next bar open time: 2024-06-09T00:00:00.000 == close pos time: 2024-06-16T00:00:00.000
2024-11-20 23:07:19,915 - INFO - pnl: 2024-06-08T23:59:59.999 185643.4851466658 === -0.785%
2024-11-20 23:07:19,921 - DEBUG - cur time: 2024-06-09T23:59:59.999 == next bar open time: 2024-06-10T00:00:00.000 == close pos time: 2024-06-17T00:00:00.000
2024-11-20 23:07:19,924 - INFO - pnl: 2024-06-09T23:59:59.999 184685.17504308763 === -0.516%
2024-11-20 23:07:19,931 - DEBUG - cur time: 2024-06-10T23:59:59.999 == next bar open time: 2024-06-11T00:00:00.000 == close pos time: 2024-06-18T00:00:00.000
2024-11-20 23:07:19,934 - INFO - pnl: 2024-06-10T23:59:59.999 184100.75368315456 === -0.316%
2024-11-20 23:07:19,939 - DEBUG - cur time: 2024-06-11T23:59:59.999 == next bar open time: 2024-06-12T00:00:00.000 == close pos time: 2024-06-19T00:00:00.000
2024-11-20 23:07:19,950 - DEBUG - sorted_long_factors: shape: (236, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ ACEUSDT    ┆ -1.878799    ┆ 0    ┆ 235          │
│ MOVRUSDT   ┆ -1.874532    ┆ 1    ┆ 234          │
│ INJUSDT    ┆ -1.773852    ┆ 2    ┆ 233          │
│ UMAUSDT    ┆ -1.743357    ┆ 3    ┆ 232          │
│ OMUSDT     ┆ -1.639158    ┆ 4    ┆ 231          │
│ FILUSDT    ┆ -1.626073    ┆ 5    ┆ 230          │
│ XAIUSDT    ┆ -1.624438    ┆ 6    ┆ 229          │
│ LQTYUSDT   ┆ -1.584424    ┆ 7    ┆ 228          │
│ STRKUSDT   ┆ -1.563252    ┆ 8    ┆ 227          │
│ PORTALUSDT ┆ -1.495379    ┆ 9    ┆ 226          │
│ …          ┆ …            ┆ …    ┆ …            │
│ ALPHAUSDT  ┆ -0.038057    ┆ 226  ┆ 9            │
│ ZENUSDT    ┆ -0.010456    ┆ 227  ┆ 8            │
│ BNTUSDT    ┆ -0.008712    ┆ 228  ┆ 7            │
│ QNTUSDT    ┆ 0.034929     ┆ 229  ┆ 6            │
│ SKLUSDT    ┆ 0.071127     ┆ 230  ┆ 5            │
│ DODOXUSDT  ┆ 0.186435     ┆ 231  ┆ 4            │
│ BALUSDT    ┆ 0.24116      ┆ 232  ┆ 3            │
│ OXTUSDT    ┆ 0.476231     ┆ 233  ┆ 2            │
│ NMRUSDT    ┆ 1.005896     ┆ 234  ┆ 1            │
│ DEFIUSDT   ┆ 2.12813      ┆ 235  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:19,959 - WARNING - 2024-06-11T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:19,959 - INFO - cur close time: 2024-06-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:19,961 - DEBUG - mean expected ret (mean factor): -0.790465799758004
2024-11-20 23:07:19,965 - DEBUG - begin to update pos: =========
2024-11-20 23:07:19,965 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,966 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.027134    ┆ 0.23658     ┆ 0.10074     ┆ 0.0127355   ┆ … ┆ 0.02011 ┆ null   ┆ null    ┆ 0.4304  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:19,973 - DEBUG - update position: 2024-06-11T23:59:59.999 === diff_trading_value: 258633.6885536928 == cash: 185048.917446343 
2024-11-20 23:07:19,975 - INFO - pnl: 2024-06-11T23:59:59.999 185048.917446343 === 0.515%
2024-11-20 23:07:19,979 - DEBUG - cur time: 2024-06-12T23:59:59.999 == next bar open time: 2024-06-13T00:00:00.000 == close pos time: 2024-06-20T00:00:00.000
2024-11-20 23:07:19,981 - INFO - pnl: 2024-06-12T23:59:59.999 185485.59873436939 === 0.236%
2024-11-20 23:07:19,986 - DEBUG - cur time: 2024-06-13T23:59:59.999 == next bar open time: 2024-06-14T00:00:00.000 == close pos time: 2024-06-21T00:00:00.000
2024-11-20 23:07:19,988 - INFO - pnl: 2024-06-13T23:59:59.999 187069.88256074447 === 0.854%
2024-11-20 23:07:19,991 - DEBUG - cur time: 2024-06-14T23:59:59.999 == next bar open time: 2024-06-15T00:00:00.000 == close pos time: 2024-06-22T00:00:00.000
2024-11-20 23:07:19,993 - INFO - pnl: 2024-06-14T23:59:59.999 189134.05542027394 === 1.103%
2024-11-20 23:07:19,997 - DEBUG - cur time: 2024-06-15T23:59:59.999 == next bar open time: 2024-06-16T00:00:00.000 == close pos time: 2024-06-23T00:00:00.000
2024-11-20 23:07:19,999 - INFO - pnl: 2024-06-15T23:59:59.999 188570.7677474363 === -0.298%
2024-11-20 23:07:20,003 - DEBUG - cur time: 2024-06-16T23:59:59.999 == next bar open time: 2024-06-17T00:00:00.000 == close pos time: 2024-06-24T00:00:00.000
2024-11-20 23:07:20,005 - INFO - pnl: 2024-06-16T23:59:59.999 187686.35764493045 === -0.469%
2024-11-20 23:07:20,008 - DEBUG - cur time: 2024-06-17T23:59:59.999 == next bar open time: 2024-06-18T00:00:00.000 == close pos time: 2024-06-25T00:00:00.000
2024-11-20 23:07:20,010 - INFO - pnl: 2024-06-17T23:59:59.999 189254.13008603908 === 0.835%
2024-11-20 23:07:20,015 - DEBUG - cur time: 2024-06-18T23:59:59.999 == next bar open time: 2024-06-19T00:00:00.000 == close pos time: 2024-06-26T00:00:00.000
2024-11-20 23:07:20,025 - DEBUG - sorted_long_factors: shape: (237, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HIGHUSDT     ┆ -2.114331    ┆ 0    ┆ 236          │
│ OMUSDT       ┆ -2.038873    ┆ 1    ┆ 235          │
│ TONUSDT      ┆ -1.889756    ┆ 2    ┆ 234          │
│ TRBUSDT      ┆ -1.875614    ┆ 3    ┆ 233          │
│ BTCDOMUSDT   ┆ -1.863361    ┆ 4    ┆ 232          │
│ ENSUSDT      ┆ -1.841754    ┆ 5    ┆ 231          │
│ ONDOUSDT     ┆ -1.803316    ┆ 6    ┆ 230          │
│ MOVRUSDT     ┆ -1.795977    ┆ 7    ┆ 229          │
│ ZETAUSDT     ┆ -1.670742    ┆ 8    ┆ 228          │
│ 1000SATSUSDT ┆ -1.61349     ┆ 9    ┆ 227          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RLCUSDT      ┆ -0.00297     ┆ 227  ┆ 9            │
│ PERPUSDT     ┆ 0.035266     ┆ 228  ┆ 8            │
│ NKNUSDT      ┆ 0.061013     ┆ 229  ┆ 7            │
│ YFIUSDT      ┆ 0.062563     ┆ 230  ┆ 6            │
│ BONDUSDT     ┆ 0.146954     ┆ 231  ┆ 5            │
│ HFTUSDT      ┆ 0.180964     ┆ 232  ┆ 4            │
│ JOEUSDT      ┆ 0.22169      ┆ 233  ┆ 3            │
│ NMRUSDT      ┆ 0.49191      ┆ 234  ┆ 2            │
│ DODOXUSDT    ┆ 0.750625     ┆ 235  ┆ 1            │
│ DEFIUSDT     ┆ 2.110804     ┆ 236  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:20,034 - WARNING - 2024-06-18T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:20,034 - INFO - cur close time: 2024-06-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:20,034 - DEBUG - mean expected ret (mean factor): -0.79072432396333
2024-11-20 23:07:20,042 - DEBUG - begin to update pos: =========
2024-11-20 23:07:20,043 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,043 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.021082    ┆ 0.16809     ┆ 0.09185     ┆ 0.0109649   ┆ … ┆ 0.01684 ┆ null   ┆ null    ┆ 0.3361  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,052 - DEBUG - update position: 2024-06-18T23:59:59.999 === diff_trading_value: 279595.26484174654 == cash: 189335.2154742019 
2024-11-20 23:07:20,054 - INFO - pnl: 2024-06-18T23:59:59.999 189335.2154742019 === 0.043%
2024-11-20 23:07:20,058 - DEBUG - cur time: 2024-06-19T23:59:59.999 == next bar open time: 2024-06-20T00:00:00.000 == close pos time: 2024-06-27T00:00:00.000
2024-11-20 23:07:20,059 - INFO - pnl: 2024-06-19T23:59:59.999 189870.55968346383 === 0.283%
2024-11-20 23:07:20,064 - DEBUG - cur time: 2024-06-20T23:59:59.999 == next bar open time: 2024-06-21T00:00:00.000 == close pos time: 2024-06-28T00:00:00.000
2024-11-20 23:07:20,065 - INFO - pnl: 2024-06-20T23:59:59.999 189742.2928449435 === -0.068%
2024-11-20 23:07:20,069 - DEBUG - cur time: 2024-06-21T23:59:59.999 == next bar open time: 2024-06-22T00:00:00.000 == close pos time: 2024-06-29T00:00:00.000
2024-11-20 23:07:20,071 - INFO - pnl: 2024-06-21T23:59:59.999 188495.88850105472 === -0.657%
2024-11-20 23:07:20,076 - DEBUG - cur time: 2024-06-22T23:59:59.999 == next bar open time: 2024-06-23T00:00:00.000 == close pos time: 2024-06-30T00:00:00.000
2024-11-20 23:07:20,077 - INFO - pnl: 2024-06-22T23:59:59.999 187281.26388942578 === -0.644%
2024-11-20 23:07:20,082 - DEBUG - cur time: 2024-06-23T23:59:59.999 == next bar open time: 2024-06-24T00:00:00.000 == close pos time: 2024-07-01T00:00:00.000
2024-11-20 23:07:20,083 - INFO - pnl: 2024-06-23T23:59:59.999 187644.4933936796 === 0.194%
2024-11-20 23:07:20,088 - DEBUG - cur time: 2024-06-24T23:59:59.999 == next bar open time: 2024-06-25T00:00:00.000 == close pos time: 2024-07-02T00:00:00.000
2024-11-20 23:07:20,090 - INFO - pnl: 2024-06-24T23:59:59.999 186993.7664968307 === -0.347%
2024-11-20 23:07:20,093 - DEBUG - cur time: 2024-06-25T23:59:59.999 == next bar open time: 2024-06-26T00:00:00.000 == close pos time: 2024-07-03T00:00:00.000
2024-11-20 23:07:20,106 - DEBUG - sorted_long_factors: shape: (239, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT     ┆ -2.37146     ┆ 0    ┆ 238          │
│ LPTUSDT     ┆ -2.287584    ┆ 1    ┆ 237          │
│ AUCTIONUSDT ┆ -2.237994    ┆ 2    ┆ 236          │
│ FXSUSDT     ┆ -2.160752    ┆ 3    ┆ 235          │
│ API3USDT    ┆ -1.917216    ┆ 4    ┆ 234          │
│ NEOUSDT     ┆ -1.841833    ┆ 5    ┆ 233          │
│ ENSUSDT     ┆ -1.804071    ┆ 6    ┆ 232          │
│ HIGHUSDT    ┆ -1.748136    ┆ 7    ┆ 231          │
│ BTCDOMUSDT  ┆ -1.709244    ┆ 8    ┆ 230          │
│ PIXELUSDT   ┆ -1.696963    ┆ 9    ┆ 229          │
│ …           ┆ …            ┆ …    ┆ …            │
│ NKNUSDT     ┆ 0.101692     ┆ 229  ┆ 9            │
│ TLMUSDT     ┆ 0.12819      ┆ 230  ┆ 8            │
│ NMRUSDT     ┆ 0.156632     ┆ 231  ┆ 7            │
│ AMBUSDT     ┆ 0.208514     ┆ 232  ┆ 6            │
│ BANDUSDT    ┆ 0.305483     ┆ 233  ┆ 5            │
│ DODOXUSDT   ┆ 0.415563     ┆ 234  ┆ 4            │
│ DARUSDT     ┆ 0.490101     ┆ 235  ┆ 3            │
│ JOEUSDT     ┆ 0.787258     ┆ 236  ┆ 2            │
│ OXTUSDT     ┆ 0.941546     ┆ 237  ┆ 1            │
│ DEFIUSDT    ┆ 1.518036     ┆ 238  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:20,113 - WARNING - 2024-06-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:20,113 - INFO - cur close time: 2024-06-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:20,113 - DEBUG - mean expected ret (mean factor): -0.7888792872543712
2024-11-20 23:07:20,117 - DEBUG - begin to update pos: =========
2024-11-20 23:07:20,118 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,118 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023244    ┆ 0.17788     ┆ 0.08118     ┆ 0.0128475   ┆ … ┆ 0.01771 ┆ null   ┆ null    ┆ 0.3695  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,126 - DEBUG - update position: 2024-06-25T23:59:59.999 === diff_trading_value: 219469.42142790926 == cash: 187422.02652084667 
2024-11-20 23:07:20,127 - INFO - pnl: 2024-06-25T23:59:59.999 187422.02652084667 === 0.229%
2024-11-20 23:07:20,131 - DEBUG - cur time: 2024-06-26T23:59:59.999 == next bar open time: 2024-06-27T00:00:00.000 == close pos time: 2024-07-04T00:00:00.000
2024-11-20 23:07:20,133 - INFO - pnl: 2024-06-26T23:59:59.999 187459.00608363588 === 0.020%
2024-11-20 23:07:20,138 - DEBUG - cur time: 2024-06-27T23:59:59.999 == next bar open time: 2024-06-28T00:00:00.000 == close pos time: 2024-07-05T00:00:00.000
2024-11-20 23:07:20,140 - INFO - pnl: 2024-06-27T23:59:59.999 187933.37199436987 === 0.253%
2024-11-20 23:07:20,145 - DEBUG - cur time: 2024-06-28T23:59:59.999 == next bar open time: 2024-06-29T00:00:00.000 == close pos time: 2024-07-06T00:00:00.000
2024-11-20 23:07:20,147 - INFO - pnl: 2024-06-28T23:59:59.999 189343.87655988644 === 0.751%
2024-11-20 23:07:20,153 - DEBUG - cur time: 2024-06-29T23:59:59.999 == next bar open time: 2024-06-30T00:00:00.000 == close pos time: 2024-07-07T00:00:00.000
2024-11-20 23:07:20,156 - INFO - pnl: 2024-06-29T23:59:59.999 190275.93502859003 === 0.492%
2024-11-20 23:07:20,161 - DEBUG - cur time: 2024-06-30T23:59:59.999 == next bar open time: 2024-07-01T00:00:00.000 == close pos time: 2024-07-08T00:00:00.000
2024-11-20 23:07:20,163 - INFO - pnl: 2024-06-30T23:59:59.999 190643.1788006021 === 0.193%
2024-11-20 23:07:20,168 - DEBUG - cur time: 2024-07-01T23:59:59.999 == next bar open time: 2024-07-02T00:00:00.000 == close pos time: 2024-07-09T00:00:00.000
2024-11-20 23:07:20,171 - INFO - pnl: 2024-07-01T23:59:59.999 189665.50182563826 === -0.513%
2024-11-20 23:07:20,176 - DEBUG - cur time: 2024-07-02T23:59:59.999 == next bar open time: 2024-07-03T00:00:00.000 == close pos time: 2024-07-10T00:00:00.000
2024-11-20 23:07:20,189 - DEBUG - sorted_long_factors: shape: (240, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BAKEUSDT  ┆ -2.159005    ┆ 0    ┆ 239          │
│ GASUSDT   ┆ -2.060515    ┆ 1    ┆ 238          │
│ MANTAUSDT ┆ -1.993481    ┆ 2    ┆ 237          │
│ ARUSDT    ┆ -1.991079    ┆ 3    ┆ 236          │
│ JTOUSDT   ┆ -1.970514    ┆ 4    ┆ 235          │
│ JUPUSDT   ┆ -1.955847    ┆ 5    ┆ 234          │
│ FETUSDT   ┆ -1.932858    ┆ 6    ┆ 233          │
│ LSKUSDT   ┆ -1.874569    ┆ 7    ┆ 232          │
│ TONUSDT   ┆ -1.854823    ┆ 8    ┆ 231          │
│ TRBUSDT   ┆ -1.785568    ┆ 9    ┆ 230          │
│ …         ┆ …            ┆ …    ┆ …            │
│ NMRUSDT   ┆ 0.229024     ┆ 230  ┆ 9            │
│ BNTUSDT   ┆ 0.238603     ┆ 231  ┆ 8            │
│ STEEMUSDT ┆ 0.27638      ┆ 232  ┆ 7            │
│ ORBSUSDT  ┆ 0.316511     ┆ 233  ┆ 6            │
│ PERPUSDT  ┆ 0.31725      ┆ 234  ┆ 5            │
│ DODOXUSDT ┆ 0.529622     ┆ 235  ┆ 4            │
│ DARUSDT   ┆ 0.538268     ┆ 236  ┆ 3            │
│ HFTUSDT   ┆ 0.631995     ┆ 237  ┆ 2            │
│ OXTUSDT   ┆ 1.040395     ┆ 238  ┆ 1            │
│ DEFIUSDT  ┆ 1.53079      ┆ 239  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:20,197 - INFO - cur close time: 2024-07-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:20,197 - DEBUG - mean expected ret (mean factor): -0.7842921499479025
2024-11-20 23:07:20,202 - DEBUG - begin to update pos: =========
2024-11-20 23:07:20,203 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,203 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025402    ┆ 0.18312     ┆ 0.08182     ┆ 0.0113167   ┆ … ┆ 0.01769 ┆ null   ┆ null    ┆ 0.3613  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,210 - DEBUG - update position: 2024-07-02T23:59:59.999 === diff_trading_value: 292670.79088455066 == cash: 190550.74349685924 
2024-11-20 23:07:20,211 - INFO - pnl: 2024-07-02T23:59:59.999 190550.74349685924 === 0.467%
2024-11-20 23:07:20,217 - DEBUG - cur time: 2024-07-03T23:59:59.999 == next bar open time: 2024-07-04T00:00:00.000 == close pos time: 2024-07-11T00:00:00.000
2024-11-20 23:07:20,220 - INFO - pnl: 2024-07-03T23:59:59.999 192833.69391327456 === 1.198%
2024-11-20 23:07:20,225 - DEBUG - cur time: 2024-07-04T23:59:59.999 == next bar open time: 2024-07-05T00:00:00.000 == close pos time: 2024-07-12T00:00:00.000
2024-11-20 23:07:20,227 - INFO - pnl: 2024-07-04T23:59:59.999 191745.0690152391 === -0.565%
2024-11-20 23:07:20,231 - DEBUG - cur time: 2024-07-05T23:59:59.999 == next bar open time: 2024-07-06T00:00:00.000 == close pos time: 2024-07-13T00:00:00.000
2024-11-20 23:07:20,234 - INFO - pnl: 2024-07-05T23:59:59.999 193197.97768719582 === 0.758%
2024-11-20 23:07:20,240 - DEBUG - cur time: 2024-07-06T23:59:59.999 == next bar open time: 2024-07-07T00:00:00.000 == close pos time: 2024-07-14T00:00:00.000
2024-11-20 23:07:20,242 - INFO - pnl: 2024-07-06T23:59:59.999 191692.05664884418 === -0.779%
2024-11-20 23:07:20,248 - DEBUG - cur time: 2024-07-07T23:59:59.999 == next bar open time: 2024-07-08T00:00:00.000 == close pos time: 2024-07-15T00:00:00.000
2024-11-20 23:07:20,250 - INFO - pnl: 2024-07-07T23:59:59.999 192508.07089750632 === 0.426%
2024-11-20 23:07:20,255 - DEBUG - cur time: 2024-07-08T23:59:59.999 == next bar open time: 2024-07-09T00:00:00.000 == close pos time: 2024-07-16T00:00:00.000
2024-11-20 23:07:20,257 - INFO - pnl: 2024-07-08T23:59:59.999 192777.96073948784 === 0.140%
2024-11-20 23:07:20,263 - DEBUG - cur time: 2024-07-09T23:59:59.999 == next bar open time: 2024-07-10T00:00:00.000 == close pos time: 2024-07-17T00:00:00.000
2024-11-20 23:07:20,275 - DEBUG - sorted_long_factors: shape: (239, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT ┆ -2.203512    ┆ 0    ┆ 238          │
│ OMUSDT     ┆ -2.148879    ┆ 1    ┆ 237          │
│ JUPUSDT    ┆ -2.113286    ┆ 2    ┆ 236          │
│ YFIUSDT    ┆ -2.020366    ┆ 3    ┆ 235          │
│ ZENUSDT    ┆ -1.904433    ┆ 4    ┆ 234          │
│ TONUSDT    ┆ -1.878191    ┆ 5    ┆ 233          │
│ BALUSDT    ┆ -1.837581    ┆ 6    ┆ 232          │
│ LDOUSDT    ┆ -1.81766     ┆ 7    ┆ 231          │
│ WIFUSDT    ┆ -1.811403    ┆ 8    ┆ 230          │
│ DYMUSDT    ┆ -1.762467    ┆ 9    ┆ 229          │
│ …          ┆ …            ┆ …    ┆ …            │
│ TLMUSDT    ┆ 0.032824     ┆ 229  ┆ 9            │
│ RIFUSDT    ┆ 0.076648     ┆ 230  ┆ 8            │
│ XVGUSDT    ┆ 0.08163      ┆ 231  ┆ 7            │
│ NKNUSDT    ┆ 0.093791     ┆ 232  ┆ 6            │
│ SUPERUSDT  ┆ 0.096862     ┆ 233  ┆ 5            │
│ BADGERUSDT ┆ 0.225217     ┆ 234  ┆ 4            │
│ STEEMUSDT  ┆ 0.283927     ┆ 235  ┆ 3            │
│ DODOXUSDT  ┆ 0.923555     ┆ 236  ┆ 2            │
│ OXTUSDT    ┆ 1.013931     ┆ 237  ┆ 1            │
│ DEFIUSDT   ┆ 1.395987     ┆ 238  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:20,284 - WARNING - 2024-07-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:20,284 - INFO - cur close time: 2024-07-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:20,284 - DEBUG - mean expected ret (mean factor): -0.7892190735539167
2024-11-20 23:07:20,289 - DEBUG - begin to update pos: =========
2024-11-20 23:07:20,290 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,290 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025914    ┆ 0.14401     ┆ 0.07049     ┆ 0.0090814   ┆ … ┆ 0.01526 ┆ null   ┆ null    ┆ 0.3084  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,296 - DEBUG - update position: 2024-07-09T23:59:59.999 === diff_trading_value: 232185.24356900476 == cash: 192437.35934747042 
2024-11-20 23:07:20,297 - INFO - pnl: 2024-07-09T23:59:59.999 192437.35934747042 === -0.177%
2024-11-20 23:07:20,301 - DEBUG - cur time: 2024-07-10T23:59:59.999 == next bar open time: 2024-07-11T00:00:00.000 == close pos time: 2024-07-18T00:00:00.000
2024-11-20 23:07:20,304 - INFO - pnl: 2024-07-10T23:59:59.999 193120.09167951104 === 0.355%
2024-11-20 23:07:20,308 - DEBUG - cur time: 2024-07-11T23:59:59.999 == next bar open time: 2024-07-12T00:00:00.000 == close pos time: 2024-07-19T00:00:00.000
2024-11-20 23:07:20,309 - INFO - pnl: 2024-07-11T23:59:59.999 192768.79952409273 === -0.182%
2024-11-20 23:07:20,314 - DEBUG - cur time: 2024-07-12T23:59:59.999 == next bar open time: 2024-07-13T00:00:00.000 == close pos time: 2024-07-20T00:00:00.000
2024-11-20 23:07:20,316 - INFO - pnl: 2024-07-12T23:59:59.999 195509.9016429706 === 1.422%
2024-11-20 23:07:20,323 - DEBUG - cur time: 2024-07-13T23:59:59.999 == next bar open time: 2024-07-14T00:00:00.000 == close pos time: 2024-07-21T00:00:00.000
2024-11-20 23:07:20,325 - INFO - pnl: 2024-07-13T23:59:59.999 194846.8085510909 === -0.339%
2024-11-20 23:07:20,330 - DEBUG - cur time: 2024-07-14T23:59:59.999 == next bar open time: 2024-07-15T00:00:00.000 == close pos time: 2024-07-22T00:00:00.000
2024-11-20 23:07:20,331 - INFO - pnl: 2024-07-14T23:59:59.999 198006.51519646743 === 1.622%
2024-11-20 23:07:20,337 - DEBUG - cur time: 2024-07-15T23:59:59.999 == next bar open time: 2024-07-16T00:00:00.000 == close pos time: 2024-07-23T00:00:00.000
2024-11-20 23:07:20,340 - INFO - pnl: 2024-07-15T23:59:59.999 196319.22610354418 === -0.852%
2024-11-20 23:07:20,345 - DEBUG - cur time: 2024-07-16T23:59:59.999 == next bar open time: 2024-07-17T00:00:00.000 == close pos time: 2024-07-24T00:00:00.000
2024-11-20 23:07:20,359 - DEBUG - sorted_long_factors: shape: (240, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ MKRUSDT    ┆ -2.035305    ┆ 0    ┆ 239          │
│ MAVIAUSDT  ┆ -1.977562    ┆ 1    ┆ 238          │
│ WIFUSDT    ┆ -1.881211    ┆ 2    ┆ 237          │
│ ZECUSDT    ┆ -1.872089    ┆ 3    ┆ 236          │
│ WLDUSDT    ┆ -1.826103    ┆ 4    ┆ 235          │
│ AAVEUSDT   ┆ -1.777484    ┆ 5    ┆ 234          │
│ DYMUSDT    ┆ -1.720823    ┆ 6    ┆ 233          │
│ OMUSDT     ┆ -1.716643    ┆ 7    ┆ 232          │
│ BTCDOMUSDT ┆ -1.714009    ┆ 8    ┆ 231          │
│ ETHFIUSDT  ┆ -1.677385    ┆ 9    ┆ 230          │
│ …          ┆ …            ┆ …    ┆ …            │
│ XVGUSDT    ┆ 0.109705     ┆ 230  ┆ 9            │
│ BNTUSDT    ┆ 0.125907     ┆ 231  ┆ 8            │
│ RENUSDT    ┆ 0.133738     ┆ 232  ┆ 7            │
│ BAKEUSDT   ┆ 0.146203     ┆ 233  ┆ 6            │
│ ETHWUSDT   ┆ 0.163628     ┆ 234  ┆ 5            │
│ HFTUSDT    ┆ 0.24645      ┆ 235  ┆ 4            │
│ XEMUSDT    ┆ 0.330042     ┆ 236  ┆ 3            │
│ ORBSUSDT   ┆ 0.461358     ┆ 237  ┆ 2            │
│ DODOXUSDT  ┆ 0.72481      ┆ 238  ┆ 1            │
│ DEFIUSDT   ┆ 1.784881     ┆ 239  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:20,370 - WARNING - 2024-07-16T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:20,370 - INFO - cur close time: 2024-07-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:20,370 - DEBUG - mean expected ret (mean factor): -0.8048863495513456
2024-11-20 23:07:20,379 - DEBUG - begin to update pos: =========
2024-11-20 23:07:20,379 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,379 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028587    ┆ 0.18948     ┆ 0.09333     ┆ 0.0123757   ┆ … ┆ 0.01758 ┆ null   ┆ null    ┆ 0.359   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,390 - DEBUG - update position: 2024-07-16T23:59:59.999 === diff_trading_value: 259023.43582230245 == cash: 195491.16606749027 
2024-11-20 23:07:20,392 - INFO - pnl: 2024-07-16T23:59:59.999 195491.16606749027 === -0.422%
2024-11-20 23:07:20,396 - DEBUG - cur time: 2024-07-17T23:59:59.999 == next bar open time: 2024-07-18T00:00:00.000 == close pos time: 2024-07-25T00:00:00.000
2024-11-20 23:07:20,398 - INFO - pnl: 2024-07-17T23:59:59.999 193468.54425744398 === -1.035%
2024-11-20 23:07:20,403 - DEBUG - cur time: 2024-07-18T23:59:59.999 == next bar open time: 2024-07-19T00:00:00.000 == close pos time: 2024-07-26T00:00:00.000
2024-11-20 23:07:20,406 - INFO - pnl: 2024-07-18T23:59:59.999 192746.33068882034 === -0.373%
2024-11-20 23:07:20,410 - DEBUG - cur time: 2024-07-19T23:59:59.999 == next bar open time: 2024-07-20T00:00:00.000 == close pos time: 2024-07-27T00:00:00.000
2024-11-20 23:07:20,412 - INFO - pnl: 2024-07-19T23:59:59.999 195493.6681131634 === 1.425%
2024-11-20 23:07:20,416 - DEBUG - cur time: 2024-07-20T23:59:59.999 == next bar open time: 2024-07-21T00:00:00.000 == close pos time: 2024-07-28T00:00:00.000
2024-11-20 23:07:20,419 - INFO - pnl: 2024-07-20T23:59:59.999 196007.6059425656 === 0.263%
2024-11-20 23:07:20,426 - DEBUG - cur time: 2024-07-21T23:59:59.999 == next bar open time: 2024-07-22T00:00:00.000 == close pos time: 2024-07-29T00:00:00.000
2024-11-20 23:07:20,429 - INFO - pnl: 2024-07-21T23:59:59.999 197109.61883532445 === 0.562%
2024-11-20 23:07:20,437 - DEBUG - cur time: 2024-07-22T23:59:59.999 == next bar open time: 2024-07-23T00:00:00.000 == close pos time: 2024-07-30T00:00:00.000
2024-11-20 23:07:20,440 - INFO - pnl: 2024-07-22T23:59:59.999 196966.4817451352 === -0.073%
2024-11-20 23:07:20,446 - DEBUG - cur time: 2024-07-23T23:59:59.999 == next bar open time: 2024-07-24T00:00:00.000 == close pos time: 2024-07-31T00:00:00.000
2024-11-20 23:07:20,460 - DEBUG - sorted_long_factors: shape: (243, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ MKRUSDT    ┆ -1.972805    ┆ 0    ┆ 242          │
│ STRKUSDT   ┆ -1.892097    ┆ 1    ┆ 241          │
│ ENSUSDT    ┆ -1.843455    ┆ 2    ┆ 240          │
│ TONUSDT    ┆ -1.810532    ┆ 3    ┆ 239          │
│ ETHFIUSDT  ┆ -1.791852    ┆ 4    ┆ 238          │
│ XAIUSDT    ┆ -1.700535    ┆ 5    ┆ 237          │
│ PIXELUSDT  ┆ -1.610655    ┆ 6    ┆ 236          │
│ JUPUSDT    ┆ -1.609413    ┆ 7    ┆ 235          │
│ WLDUSDT    ┆ -1.585159    ┆ 8    ┆ 234          │
│ PORTALUSDT ┆ -1.557259    ┆ 9    ┆ 233          │
│ …          ┆ …            ┆ …    ┆ …            │
│ ALPHAUSDT  ┆ -0.090061    ┆ 233  ┆ 9            │
│ AMBUSDT    ┆ 0.035501     ┆ 234  ┆ 8            │
│ BSVUSDT    ┆ 0.055737     ┆ 235  ┆ 7            │
│ XVGUSDT    ┆ 0.08939      ┆ 236  ┆ 6            │
│ BADGERUSDT ┆ 0.09284      ┆ 237  ┆ 5            │
│ BNTUSDT    ┆ 0.100199     ┆ 238  ┆ 4            │
│ LQTYUSDT   ┆ 0.11667      ┆ 239  ┆ 3            │
│ ICPUSDT    ┆ 0.291956     ┆ 240  ┆ 2            │
│ DEFIUSDT   ┆ 0.742106     ┆ 241  ┆ 1            │
│ DODOXUSDT  ┆ 1.138355     ┆ 242  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:20,470 - WARNING - 2024-07-23T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:20,470 - INFO - cur close time: 2024-07-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:20,470 - DEBUG - mean expected ret (mean factor): -0.8012205410551819
2024-11-20 23:07:20,476 - DEBUG - begin to update pos: =========
2024-11-20 23:07:20,477 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,477 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028221    ┆ 0.18487     ┆ 0.08473     ┆ 0.0125261   ┆ … ┆ 0.01688 ┆ null   ┆ null    ┆ 0.373   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,486 - DEBUG - update position: 2024-07-23T23:59:59.999 === diff_trading_value: 283367.942113528 == cash: 197291.2117761748 
2024-11-20 23:07:20,488 - INFO - pnl: 2024-07-23T23:59:59.999 197291.2117761748 === 0.165%
2024-11-20 23:07:20,493 - DEBUG - cur time: 2024-07-24T23:59:59.999 == next bar open time: 2024-07-25T00:00:00.000 == close pos time: 2024-08-01T00:00:00.000
2024-11-20 23:07:20,494 - INFO - pnl: 2024-07-24T23:59:59.999 198635.52513956933 === 0.681%
2024-11-20 23:07:20,500 - DEBUG - cur time: 2024-07-25T23:59:59.999 == next bar open time: 2024-07-26T00:00:00.000 == close pos time: 2024-08-02T00:00:00.000
2024-11-20 23:07:20,501 - INFO - pnl: 2024-07-25T23:59:59.999 200604.59304452816 === 0.991%
2024-11-20 23:07:20,508 - DEBUG - cur time: 2024-07-26T23:59:59.999 == next bar open time: 2024-07-27T00:00:00.000 == close pos time: 2024-08-03T00:00:00.000
2024-11-20 23:07:20,511 - INFO - pnl: 2024-07-26T23:59:59.999 201481.75103908958 === 0.437%
2024-11-20 23:07:20,516 - DEBUG - cur time: 2024-07-27T23:59:59.999 == next bar open time: 2024-07-28T00:00:00.000 == close pos time: 2024-08-04T00:00:00.000
2024-11-20 23:07:20,517 - INFO - pnl: 2024-07-27T23:59:59.999 204129.70304305045 === 1.314%
2024-11-20 23:07:20,521 - DEBUG - cur time: 2024-07-28T23:59:59.999 == next bar open time: 2024-07-29T00:00:00.000 == close pos time: 2024-08-05T00:00:00.000
2024-11-20 23:07:20,523 - INFO - pnl: 2024-07-28T23:59:59.999 204216.27451382967 === 0.042%
2024-11-20 23:07:20,526 - DEBUG - cur time: 2024-07-29T23:59:59.999 == next bar open time: 2024-07-30T00:00:00.000 == close pos time: 2024-08-06T00:00:00.000
2024-11-20 23:07:20,527 - INFO - pnl: 2024-07-29T23:59:59.999 205509.78213578064 === 0.633%
2024-11-20 23:07:20,531 - DEBUG - cur time: 2024-07-30T23:59:59.999 == next bar open time: 2024-07-31T00:00:00.000 == close pos time: 2024-08-07T00:00:00.000
2024-11-20 23:07:20,541 - DEBUG - sorted_long_factors: shape: (244, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TONUSDT   ┆ -2.206033    ┆ 0    ┆ 243          │
│ OMUSDT    ┆ -2.123428    ┆ 1    ┆ 242          │
│ WIFUSDT   ┆ -2.029263    ┆ 2    ┆ 241          │
│ ETHFIUSDT ┆ -2.024391    ┆ 3    ┆ 240          │
│ STRKUSDT  ┆ -1.809173    ┆ 4    ┆ 239          │
│ USDCUSDT  ┆ -1.710629    ┆ 5    ┆ 238          │
│ TAOUSDT   ┆ -1.686123    ┆ 6    ┆ 237          │
│ XRPUSDT   ┆ -1.673628    ┆ 7    ┆ 236          │
│ TNSRUSDT  ┆ -1.653764    ┆ 8    ┆ 235          │
│ JUPUSDT   ┆ -1.653316    ┆ 9    ┆ 234          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ALPHAUSDT ┆ 0.118206     ┆ 234  ┆ 9            │
│ ONEUSDT   ┆ 0.129228     ┆ 235  ┆ 8            │
│ PERPUSDT  ┆ 0.189036     ┆ 236  ┆ 7            │
│ XVGUSDT   ┆ 0.252418     ┆ 237  ┆ 6            │
│ COMBOUSDT ┆ 0.376827     ┆ 238  ┆ 5            │
│ BNTUSDT   ┆ 0.406366     ┆ 239  ┆ 4            │
│ ATAUSDT   ┆ 0.462044     ┆ 240  ┆ 3            │
│ AGLDUSDT  ┆ 0.486389     ┆ 241  ┆ 2            │
│ BICOUSDT  ┆ 0.51446      ┆ 242  ┆ 1            │
│ DEFIUSDT  ┆ 1.219895     ┆ 243  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:20,549 - INFO - cur close time: 2024-07-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:20,549 - DEBUG - mean expected ret (mean factor): -0.7989368117585327
2024-11-20 23:07:20,555 - DEBUG - begin to update pos: =========
2024-11-20 23:07:20,555 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,555 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025936    ┆ 0.16707     ┆ 0.08037     ┆ 0.0113012   ┆ … ┆ 0.01679 ┆ null   ┆ null    ┆ 0.3687  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,566 - DEBUG - update position: 2024-07-30T23:59:59.999 === diff_trading_value: 256124.09750873398 == cash: 206804.5598279572 
2024-11-20 23:07:20,567 - INFO - pnl: 2024-07-30T23:59:59.999 206804.5598279572 === 0.630%
2024-11-20 23:07:20,572 - DEBUG - cur time: 2024-07-31T23:59:59.999 == next bar open time: 2024-08-01T00:00:00.000 == close pos time: 2024-08-08T00:00:00.000
2024-11-20 23:07:20,574 - INFO - pnl: 2024-07-31T23:59:59.999 207609.95796540007 === 0.389%
2024-11-20 23:07:20,582 - DEBUG - cur time: 2024-08-01T23:59:59.999 == next bar open time: 2024-08-02T00:00:00.000 == close pos time: 2024-08-09T00:00:00.000
2024-11-20 23:07:20,583 - INFO - pnl: 2024-08-01T23:59:59.999 208479.88283673534 === 0.419%
2024-11-20 23:07:20,588 - DEBUG - cur time: 2024-08-02T23:59:59.999 == next bar open time: 2024-08-03T00:00:00.000 == close pos time: 2024-08-10T00:00:00.000
2024-11-20 23:07:20,590 - INFO - pnl: 2024-08-02T23:59:59.999 209782.89686981757 === 0.625%
2024-11-20 23:07:20,593 - DEBUG - cur time: 2024-08-03T23:59:59.999 == next bar open time: 2024-08-04T00:00:00.000 == close pos time: 2024-08-11T00:00:00.000
2024-11-20 23:07:20,595 - INFO - pnl: 2024-08-03T23:59:59.999 209179.38958746762 === -0.288%
2024-11-20 23:07:20,600 - DEBUG - cur time: 2024-08-04T23:59:59.999 == next bar open time: 2024-08-05T00:00:00.000 == close pos time: 2024-08-12T00:00:00.000
2024-11-20 23:07:20,602 - INFO - pnl: 2024-08-04T23:59:59.999 209612.9572094881 === 0.207%
2024-11-20 23:07:20,606 - DEBUG - cur time: 2024-08-05T23:59:59.999 == next bar open time: 2024-08-06T00:00:00.000 == close pos time: 2024-08-13T00:00:00.000
2024-11-20 23:07:20,608 - INFO - pnl: 2024-08-05T23:59:59.999 209375.467554058 === -0.113%
2024-11-20 23:07:20,612 - DEBUG - cur time: 2024-08-06T23:59:59.999 == next bar open time: 2024-08-07T00:00:00.000 == close pos time: 2024-08-14T00:00:00.000
2024-11-20 23:07:20,624 - DEBUG - sorted_long_factors: shape: (244, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT ┆ -2.657316    ┆ 0    ┆ 243          │
│ BSVUSDT    ┆ -2.07824     ┆ 1    ┆ 242          │
│ ZECUSDT    ┆ -1.97808     ┆ 2    ┆ 241          │
│ SAGAUSDT   ┆ -1.943405    ┆ 3    ┆ 240          │
│ AAVEUSDT   ┆ -1.915027    ┆ 4    ┆ 239          │
│ XMRUSDT    ┆ -1.858118    ┆ 5    ┆ 238          │
│ BOMEUSDT   ┆ -1.853451    ┆ 6    ┆ 237          │
│ TONUSDT    ┆ -1.819841    ┆ 7    ┆ 236          │
│ CRVUSDT    ┆ -1.81093     ┆ 8    ┆ 235          │
│ STRKUSDT   ┆ -1.803234    ┆ 9    ┆ 234          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BNTUSDT    ┆ 0.235084     ┆ 234  ┆ 9            │
│ HFTUSDT    ┆ 0.253522     ┆ 235  ┆ 8            │
│ BICOUSDT   ┆ 0.26179      ┆ 236  ┆ 7            │
│ BELUSDT    ┆ 0.262243     ┆ 237  ┆ 6            │
│ COMBOUSDT  ┆ 0.285274     ┆ 238  ┆ 5            │
│ JOEUSDT    ┆ 0.383437     ┆ 239  ┆ 4            │
│ PERPUSDT   ┆ 0.480774     ┆ 240  ┆ 3            │
│ ETHWUSDT   ┆ 0.645623     ┆ 241  ┆ 2            │
│ AGLDUSDT   ┆ 0.714982     ┆ 242  ┆ 1            │
│ DEFIUSDT   ┆ 1.285187     ┆ 243  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:20,633 - WARNING - 2024-08-06T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:20,633 - INFO - cur close time: 2024-08-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:20,633 - DEBUG - mean expected ret (mean factor): -0.8072172084604688
2024-11-20 23:07:20,641 - DEBUG - begin to update pos: =========
2024-11-20 23:07:20,641 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,641 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.019827    ┆ 0.12081     ┆ 0.06682     ┆ 0.0077357   ┆ … ┆ 0.01303 ┆ null   ┆ null    ┆ 0.2788  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,650 - DEBUG - update position: 2024-08-06T23:59:59.999 === diff_trading_value: 256177.74922400096 == cash: 207686.2138268599 
2024-11-20 23:07:20,651 - INFO - pnl: 2024-08-06T23:59:59.999 207686.2138268599 === -0.807%
2024-11-20 23:07:20,656 - DEBUG - cur time: 2024-08-07T23:59:59.999 == next bar open time: 2024-08-08T00:00:00.000 == close pos time: 2024-08-15T00:00:00.000
2024-11-20 23:07:20,658 - INFO - pnl: 2024-08-07T23:59:59.999 207229.62595076518 === -0.220%
2024-11-20 23:07:20,662 - DEBUG - cur time: 2024-08-08T23:59:59.999 == next bar open time: 2024-08-09T00:00:00.000 == close pos time: 2024-08-16T00:00:00.000
2024-11-20 23:07:20,664 - INFO - pnl: 2024-08-08T23:59:59.999 207514.93936457692 === 0.138%
2024-11-20 23:07:20,669 - DEBUG - cur time: 2024-08-09T23:59:59.999 == next bar open time: 2024-08-10T00:00:00.000 == close pos time: 2024-08-17T00:00:00.000
2024-11-20 23:07:20,671 - INFO - pnl: 2024-08-09T23:59:59.999 205853.46233466116 === -0.801%
2024-11-20 23:07:20,675 - DEBUG - cur time: 2024-08-10T23:59:59.999 == next bar open time: 2024-08-11T00:00:00.000 == close pos time: 2024-08-18T00:00:00.000
2024-11-20 23:07:20,677 - INFO - pnl: 2024-08-10T23:59:59.999 207644.83742154823 === 0.870%
2024-11-20 23:07:20,681 - DEBUG - cur time: 2024-08-11T23:59:59.999 == next bar open time: 2024-08-12T00:00:00.000 == close pos time: 2024-08-19T00:00:00.000
2024-11-20 23:07:20,683 - INFO - pnl: 2024-08-11T23:59:59.999 206704.66732997118 === -0.453%
2024-11-20 23:07:20,687 - DEBUG - cur time: 2024-08-12T23:59:59.999 == next bar open time: 2024-08-13T00:00:00.000 == close pos time: 2024-08-20T00:00:00.000
2024-11-20 23:07:20,689 - INFO - pnl: 2024-08-12T23:59:59.999 202269.83098608424 === -2.145%
2024-11-20 23:07:20,693 - DEBUG - cur time: 2024-08-13T23:59:59.999 == next bar open time: 2024-08-14T00:00:00.000 == close pos time: 2024-08-21T00:00:00.000
2024-11-20 23:07:20,707 - DEBUG - sorted_long_factors: shape: (245, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT ┆ -2.935375    ┆ 0    ┆ 244          │
│ SAGAUSDT   ┆ -2.420731    ┆ 1    ┆ 243          │
│ ZETAUSDT   ┆ -2.214329    ┆ 2    ┆ 242          │
│ TONUSDT    ┆ -2.187891    ┆ 3    ┆ 241          │
│ USDCUSDT   ┆ -2.118718    ┆ 4    ┆ 240          │
│ GLMUSDT    ┆ -2.071122    ┆ 5    ┆ 239          │
│ TRXUSDT    ┆ -1.970022    ┆ 6    ┆ 238          │
│ AEVOUSDT   ┆ -1.913659    ┆ 7    ┆ 237          │
│ WUSDT      ┆ -1.90351     ┆ 8    ┆ 236          │
│ CRVUSDT    ┆ -1.81158     ┆ 9    ┆ 235          │
│ …          ┆ …            ┆ …    ┆ …            │
│ OXTUSDT    ┆ 0.188204     ┆ 235  ┆ 9            │
│ AGLDUSDT   ┆ 0.228555     ┆ 236  ┆ 8            │
│ BNTUSDT    ┆ 0.246081     ┆ 237  ┆ 7            │
│ QNTUSDT    ┆ 0.325879     ┆ 238  ┆ 6            │
│ MOVRUSDT   ┆ 0.341423     ┆ 239  ┆ 5            │
│ RLCUSDT    ┆ 0.454951     ┆ 240  ┆ 4            │
│ ETHWUSDT   ┆ 0.480433     ┆ 241  ┆ 3            │
│ JOEUSDT    ┆ 0.735712     ┆ 242  ┆ 2            │
│ DODOXUSDT  ┆ 1.121537     ┆ 243  ┆ 1            │
│ DEFIUSDT   ┆ 1.468849     ┆ 244  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:20,716 - WARNING - 2024-08-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:20,717 - INFO - cur close time: 2024-08-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:20,718 - DEBUG - mean expected ret (mean factor): -0.8069682930977602
2024-11-20 23:07:20,723 - DEBUG - begin to update pos: =========
2024-11-20 23:07:20,723 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,724 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.019792    ┆ 0.12265     ┆ 0.07864     ┆ 0.0081801   ┆ … ┆ 0.01396 ┆ null   ┆ null    ┆ 0.3136  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,731 - DEBUG - update position: 2024-08-13T23:59:59.999 === diff_trading_value: 240646.23883609334 == cash: 202809.94066445378 
2024-11-20 23:07:20,733 - INFO - pnl: 2024-08-13T23:59:59.999 202809.94066445378 === 0.267%
2024-11-20 23:07:20,737 - DEBUG - cur time: 2024-08-14T23:59:59.999 == next bar open time: 2024-08-15T00:00:00.000 == close pos time: 2024-08-22T00:00:00.000
2024-11-20 23:07:20,739 - INFO - pnl: 2024-08-14T23:59:59.999 201234.1481598659 === -0.777%
2024-11-20 23:07:20,743 - DEBUG - cur time: 2024-08-15T23:59:59.999 == next bar open time: 2024-08-16T00:00:00.000 == close pos time: 2024-08-23T00:00:00.000
2024-11-20 23:07:20,746 - INFO - pnl: 2024-08-15T23:59:59.999 200326.6918597521 === -0.451%
2024-11-20 23:07:20,750 - DEBUG - cur time: 2024-08-16T23:59:59.999 == next bar open time: 2024-08-17T00:00:00.000 == close pos time: 2024-08-24T00:00:00.000
2024-11-20 23:07:20,754 - INFO - pnl: 2024-08-16T23:59:59.999 200653.02365352688 === 0.163%
2024-11-20 23:07:20,758 - DEBUG - cur time: 2024-08-17T23:59:59.999 == next bar open time: 2024-08-18T00:00:00.000 == close pos time: 2024-08-25T00:00:00.000
2024-11-20 23:07:20,760 - INFO - pnl: 2024-08-17T23:59:59.999 203599.3581072958 === 1.468%
2024-11-20 23:07:20,767 - DEBUG - cur time: 2024-08-18T23:59:59.999 == next bar open time: 2024-08-19T00:00:00.000 == close pos time: 2024-08-26T00:00:00.000
2024-11-20 23:07:20,770 - INFO - pnl: 2024-08-18T23:59:59.999 207499.77132664644 === 1.916%
2024-11-20 23:07:20,775 - DEBUG - cur time: 2024-08-19T23:59:59.999 == next bar open time: 2024-08-20T00:00:00.000 == close pos time: 2024-08-27T00:00:00.000
2024-11-20 23:07:20,778 - INFO - pnl: 2024-08-19T23:59:59.999 209513.66849464667 === 0.971%
2024-11-20 23:07:20,784 - DEBUG - cur time: 2024-08-20T23:59:59.999 == next bar open time: 2024-08-21T00:00:00.000 == close pos time: 2024-08-28T00:00:00.000
2024-11-20 23:07:20,796 - DEBUG - sorted_long_factors: shape: (245, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT   ┆ -1.861516    ┆ 0    ┆ 244          │
│ ETHFIUSDT ┆ -1.783475    ┆ 1    ┆ 243          │
│ TAOUSDT   ┆ -1.751046    ┆ 2    ┆ 242          │
│ XMRUSDT   ┆ -1.736589    ┆ 3    ┆ 241          │
│ TONUSDT   ┆ -1.730593    ┆ 4    ┆ 240          │
│ DYMUSDT   ┆ -1.710317    ┆ 5    ┆ 239          │
│ JTOUSDT   ┆ -1.664184    ┆ 6    ┆ 238          │
│ AAVEUSDT  ┆ -1.602675    ┆ 7    ┆ 237          │
│ GLMUSDT   ┆ -1.591845    ┆ 8    ┆ 236          │
│ INJUSDT   ┆ -1.589927    ┆ 9    ┆ 235          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ACHUSDT   ┆ 0.057441     ┆ 235  ┆ 9            │
│ STEEMUSDT ┆ 0.129467     ┆ 236  ┆ 8            │
│ FXSUSDT   ┆ 0.201388     ┆ 237  ┆ 7            │
│ JOEUSDT   ┆ 0.31215      ┆ 238  ┆ 6            │
│ OMGUSDT   ┆ 0.319014     ┆ 239  ┆ 5            │
│ HFTUSDT   ┆ 0.524957     ┆ 240  ┆ 4            │
│ OXTUSDT   ┆ 0.669265     ┆ 241  ┆ 3            │
│ ETHWUSDT  ┆ 0.826014     ┆ 242  ┆ 2            │
│ ILVUSDT   ┆ 0.882561     ┆ 243  ┆ 1            │
│ DEFIUSDT  ┆ 1.697463     ┆ 244  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:20,803 - INFO - cur close time: 2024-08-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:20,804 - DEBUG - mean expected ret (mean factor): -0.8011687277865096
2024-11-20 23:07:20,808 - DEBUG - begin to update pos: =========
2024-11-20 23:07:20,808 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,808 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.018147    ┆ 0.12477     ┆ 0.07929     ┆ 0.007753    ┆ … ┆ 0.01378 ┆ null   ┆ null    ┆ 0.311   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,815 - DEBUG - update position: 2024-08-20T23:59:59.999 === diff_trading_value: 274622.18783406704 == cash: 209027.02256726156 
2024-11-20 23:07:20,817 - INFO - pnl: 2024-08-20T23:59:59.999 209027.02256726156 === -0.232%
2024-11-20 23:07:20,820 - DEBUG - cur time: 2024-08-21T23:59:59.999 == next bar open time: 2024-08-22T00:00:00.000 == close pos time: 2024-08-29T00:00:00.000
2024-11-20 23:07:20,822 - INFO - pnl: 2024-08-21T23:59:59.999 211723.48322553153 === 1.290%
2024-11-20 23:07:20,826 - DEBUG - cur time: 2024-08-22T23:59:59.999 == next bar open time: 2024-08-23T00:00:00.000 == close pos time: 2024-08-30T00:00:00.000
2024-11-20 23:07:20,828 - INFO - pnl: 2024-08-22T23:59:59.999 211169.44534950648 === -0.262%
2024-11-20 23:07:20,831 - DEBUG - cur time: 2024-08-23T23:59:59.999 == next bar open time: 2024-08-24T00:00:00.000 == close pos time: 2024-08-31T00:00:00.000
2024-11-20 23:07:20,833 - INFO - pnl: 2024-08-23T23:59:59.999 207845.3266856222 === -1.574%
2024-11-20 23:07:20,838 - DEBUG - cur time: 2024-08-24T23:59:59.999 == next bar open time: 2024-08-25T00:00:00.000 == close pos time: 2024-09-01T00:00:00.000
2024-11-20 23:07:20,840 - INFO - pnl: 2024-08-24T23:59:59.999 208942.5390988143 === 0.528%
2024-11-20 23:07:20,844 - DEBUG - cur time: 2024-08-25T23:59:59.999 == next bar open time: 2024-08-26T00:00:00.000 == close pos time: 2024-09-02T00:00:00.000
2024-11-20 23:07:20,846 - INFO - pnl: 2024-08-25T23:59:59.999 207323.82509921546 === -0.775%
2024-11-20 23:07:20,851 - DEBUG - cur time: 2024-08-26T23:59:59.999 == next bar open time: 2024-08-27T00:00:00.000 == close pos time: 2024-09-03T00:00:00.000
2024-11-20 23:07:20,852 - INFO - pnl: 2024-08-26T23:59:59.999 208152.21110353174 === 0.400%
2024-11-20 23:07:20,856 - DEBUG - cur time: 2024-08-27T23:59:59.999 == next bar open time: 2024-08-28T00:00:00.000 == close pos time: 2024-09-04T00:00:00.000
2024-11-20 23:07:20,867 - DEBUG - sorted_long_factors: shape: (247, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ TAOUSDT     ┆ -2.122546    ┆ 0    ┆ 246          │
│ AUCTIONUSDT ┆ -1.825244    ┆ 1    ┆ 245          │
│ NOTUSDT     ┆ -1.657519    ┆ 2    ┆ 244          │
│ ICPUSDT     ┆ -1.626932    ┆ 3    ┆ 243          │
│ ETHFIUSDT   ┆ -1.624177    ┆ 4    ┆ 242          │
│ YFIUSDT     ┆ -1.596245    ┆ 5    ┆ 241          │
│ AEVOUSDT    ┆ -1.557748    ┆ 6    ┆ 240          │
│ LUNA2USDT   ┆ -1.536924    ┆ 7    ┆ 239          │
│ XMRUSDT     ┆ -1.527613    ┆ 8    ┆ 238          │
│ FILUSDT     ┆ -1.516941    ┆ 9    ┆ 237          │
│ …           ┆ …            ┆ …    ┆ …            │
│ PERPUSDT    ┆ 0.204194     ┆ 237  ┆ 9            │
│ HFTUSDT     ┆ 0.242015     ┆ 238  ┆ 8            │
│ LSKUSDT     ┆ 0.262657     ┆ 239  ┆ 7            │
│ XVGUSDT     ┆ 0.313014     ┆ 240  ┆ 6            │
│ OMGUSDT     ┆ 0.340217     ┆ 241  ┆ 5            │
│ AGLDUSDT    ┆ 0.402783     ┆ 242  ┆ 4            │
│ OXTUSDT     ┆ 0.519002     ┆ 243  ┆ 3            │
│ ETHWUSDT    ┆ 0.522412     ┆ 244  ┆ 2            │
│ STEEMUSDT   ┆ 0.666903     ┆ 245  ┆ 1            │
│ DEFIUSDT    ┆ 1.486016     ┆ 246  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:20,876 - WARNING - 2024-08-27T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:20,876 - INFO - cur close time: 2024-08-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:20,876 - DEBUG - mean expected ret (mean factor): -0.7823359101843425
2024-11-20 23:07:20,881 - DEBUG - begin to update pos: =========
2024-11-20 23:07:20,881 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,881 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.018235    ┆ 0.14647     ┆ 0.08199     ┆ 0.0076345   ┆ … ┆ 0.01366 ┆ null   ┆ null    ┆ 0.3041  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,887 - DEBUG - update position: 2024-08-27T23:59:59.999 === diff_trading_value: 265362.3795616297 == cash: 208266.37838807094 
2024-11-20 23:07:20,889 - INFO - pnl: 2024-08-27T23:59:59.999 208266.37838807094 === 0.055%
2024-11-20 23:07:20,894 - DEBUG - cur time: 2024-08-28T23:59:59.999 == next bar open time: 2024-08-29T00:00:00.000 == close pos time: 2024-09-05T00:00:00.000
2024-11-20 23:07:20,896 - INFO - pnl: 2024-08-28T23:59:59.999 206871.07165903537 === -0.670%
2024-11-20 23:07:20,900 - DEBUG - cur time: 2024-08-29T23:59:59.999 == next bar open time: 2024-08-30T00:00:00.000 == close pos time: 2024-09-06T00:00:00.000
2024-11-20 23:07:20,902 - INFO - pnl: 2024-08-29T23:59:59.999 207131.23077447523 === 0.126%
2024-11-20 23:07:20,907 - DEBUG - cur time: 2024-08-30T23:59:59.999 == next bar open time: 2024-08-31T00:00:00.000 == close pos time: 2024-09-07T00:00:00.000
2024-11-20 23:07:20,909 - INFO - pnl: 2024-08-30T23:59:59.999 206985.59365436787 === -0.070%
2024-11-20 23:07:20,913 - DEBUG - cur time: 2024-08-31T23:59:59.999 == next bar open time: 2024-09-01T00:00:00.000 == close pos time: 2024-09-08T00:00:00.000
2024-11-20 23:07:20,915 - INFO - pnl: 2024-08-31T23:59:59.999 206407.14992933546 === -0.279%
2024-11-20 23:07:20,921 - DEBUG - cur time: 2024-09-01T23:59:59.999 == next bar open time: 2024-09-02T00:00:00.000 == close pos time: 2024-09-09T00:00:00.000
2024-11-20 23:07:20,924 - INFO - pnl: 2024-09-01T23:59:59.999 206987.16216365178 === 0.281%
2024-11-20 23:07:20,929 - DEBUG - cur time: 2024-09-02T23:59:59.999 == next bar open time: 2024-09-03T00:00:00.000 == close pos time: 2024-09-10T00:00:00.000
2024-11-20 23:07:20,930 - INFO - pnl: 2024-09-02T23:59:59.999 207570.70810259643 === 0.282%
2024-11-20 23:07:20,935 - DEBUG - cur time: 2024-09-03T23:59:59.999 == next bar open time: 2024-09-04T00:00:00.000 == close pos time: 2024-09-11T00:00:00.000
2024-11-20 23:07:20,946 - DEBUG - sorted_long_factors: shape: (246, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ TONUSDT       ┆ -2.51607     ┆ 0    ┆ 245          │
│ BTCDOMUSDT    ┆ -2.200469    ┆ 1    ┆ 244          │
│ XMRUSDT       ┆ -2.082535    ┆ 2    ┆ 243          │
│ TAOUSDT       ┆ -2.032816    ┆ 3    ┆ 242          │
│ AUCTIONUSDT   ┆ -1.916978    ┆ 4    ┆ 241          │
│ BONDUSDT      ┆ -1.904392    ┆ 5    ┆ 240          │
│ USDCUSDT      ┆ -1.785522    ┆ 6    ┆ 239          │
│ LUNA2USDT     ┆ -1.696923    ┆ 7    ┆ 238          │
│ 1000FLOKIUSDT ┆ -1.679559    ┆ 8    ┆ 237          │
│ NOTUSDT       ┆ -1.614804    ┆ 9    ┆ 236          │
│ …             ┆ …            ┆ …    ┆ …            │
│ LSKUSDT       ┆ 0.13974      ┆ 236  ┆ 9            │
│ OMGUSDT       ┆ 0.267036     ┆ 237  ┆ 8            │
│ AGLDUSDT      ┆ 0.269331     ┆ 238  ┆ 7            │
│ WAXPUSDT      ┆ 0.284384     ┆ 239  ┆ 6            │
│ PERPUSDT      ┆ 0.348926     ┆ 240  ┆ 5            │
│ ILVUSDT       ┆ 0.407831     ┆ 241  ┆ 4            │
│ XVGUSDT       ┆ 0.419745     ┆ 242  ┆ 3            │
│ STEEMUSDT     ┆ 0.658603     ┆ 243  ┆ 2            │
│ ETHWUSDT      ┆ 1.466398     ┆ 244  ┆ 1            │
│ DEFIUSDT      ┆ 1.767808     ┆ 245  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:20,953 - WARNING - 2024-09-03T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:20,953 - INFO - cur close time: 2024-09-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:20,953 - DEBUG - mean expected ret (mean factor): -0.769376712771645
2024-11-20 23:07:20,958 - DEBUG - begin to update pos: =========
2024-11-20 23:07:20,959 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,959 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.016543    ┆ 0.11881     ┆ 0.07527     ┆ 0.0072644   ┆ … ┆ 0.01311 ┆ null   ┆ null    ┆ 0.2767  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:20,967 - DEBUG - update position: 2024-09-03T23:59:59.999 === diff_trading_value: 193857.83424182184 == cash: 208499.96491996967 
2024-11-20 23:07:20,968 - INFO - pnl: 2024-09-03T23:59:59.999 208499.96491996967 === 0.448%
2024-11-20 23:07:20,971 - DEBUG - cur time: 2024-09-04T23:59:59.999 == next bar open time: 2024-09-05T00:00:00.000 == close pos time: 2024-09-12T00:00:00.000
2024-11-20 23:07:20,973 - INFO - pnl: 2024-09-04T23:59:59.999 211590.74666376453 === 1.482%
2024-11-20 23:07:20,978 - DEBUG - cur time: 2024-09-05T23:59:59.999 == next bar open time: 2024-09-06T00:00:00.000 == close pos time: 2024-09-13T00:00:00.000
2024-11-20 23:07:20,980 - INFO - pnl: 2024-09-05T23:59:59.999 209978.75772847107 === -0.762%
2024-11-20 23:07:20,983 - DEBUG - cur time: 2024-09-06T23:59:59.999 == next bar open time: 2024-09-07T00:00:00.000 == close pos time: 2024-09-14T00:00:00.000
2024-11-20 23:07:20,984 - INFO - pnl: 2024-09-06T23:59:59.999 209141.00057644382 === -0.399%
2024-11-20 23:07:20,988 - DEBUG - cur time: 2024-09-07T23:59:59.999 == next bar open time: 2024-09-08T00:00:00.000 == close pos time: 2024-09-15T00:00:00.000
2024-11-20 23:07:20,989 - INFO - pnl: 2024-09-07T23:59:59.999 209957.53887935894 === 0.390%
2024-11-20 23:07:20,994 - DEBUG - cur time: 2024-09-08T23:59:59.999 == next bar open time: 2024-09-09T00:00:00.000 == close pos time: 2024-09-16T00:00:00.000
2024-11-20 23:07:20,995 - INFO - pnl: 2024-09-08T23:59:59.999 210958.34699001233 === 0.477%
2024-11-20 23:07:20,999 - DEBUG - cur time: 2024-09-09T23:59:59.999 == next bar open time: 2024-09-10T00:00:00.000 == close pos time: 2024-09-17T00:00:00.000
2024-11-20 23:07:21,001 - INFO - pnl: 2024-09-09T23:59:59.999 211479.8725815057 === 0.247%
2024-11-20 23:07:21,004 - DEBUG - cur time: 2024-09-10T23:59:59.999 == next bar open time: 2024-09-11T00:00:00.000 == close pos time: 2024-09-18T00:00:00.000
2024-11-20 23:07:21,019 - DEBUG - sorted_long_factors: shape: (247, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT ┆ -2.07812     ┆ 0    ┆ 246          │
│ TRBUSDT    ┆ -2.009291    ┆ 1    ┆ 245          │
│ AAVEUSDT   ┆ -1.9745      ┆ 2    ┆ 244          │
│ IMXUSDT    ┆ -1.828421    ┆ 3    ┆ 243          │
│ FETUSDT    ┆ -1.820609    ┆ 4    ┆ 242          │
│ SFPUSDT    ┆ -1.722098    ┆ 5    ┆ 241          │
│ BONDUSDT   ┆ -1.717957    ┆ 6    ┆ 240          │
│ UMAUSDT    ┆ -1.629719    ┆ 7    ┆ 239          │
│ PENDLEUSDT ┆ -1.623319    ┆ 8    ┆ 238          │
│ RONINUSDT  ┆ -1.609332    ┆ 9    ┆ 237          │
│ …          ┆ …            ┆ …    ┆ …            │
│ OMGUSDT    ┆ 0.273707     ┆ 237  ┆ 9            │
│ XVGUSDT    ┆ 0.351352     ┆ 238  ┆ 8            │
│ BICOUSDT   ┆ 0.352049     ┆ 239  ┆ 7            │
│ BNTUSDT    ┆ 0.362321     ┆ 240  ┆ 6            │
│ LSKUSDT    ┆ 0.393253     ┆ 241  ┆ 5            │
│ HFTUSDT    ┆ 0.417174     ┆ 242  ┆ 4            │
│ DODOXUSDT  ┆ 0.536023     ┆ 243  ┆ 3            │
│ STEEMUSDT  ┆ 0.764031     ┆ 244  ┆ 2            │
│ DEFIUSDT   ┆ 1.02071      ┆ 245  ┆ 1            │
│ ETHWUSDT   ┆ 1.239353     ┆ 246  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:21,026 - WARNING - 2024-09-10T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:21,027 - INFO - cur close time: 2024-09-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:21,027 - DEBUG - mean expected ret (mean factor): -0.7712613407291535
2024-11-20 23:07:21,032 - DEBUG - begin to update pos: =========
2024-11-20 23:07:21,032 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,032 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.017236    ┆ 0.12736     ┆ 0.08483     ┆ 0.0074615   ┆ … ┆ 0.01334 ┆ null   ┆ null    ┆ 0.2831  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,038 - DEBUG - update position: 2024-09-10T23:59:59.999 === diff_trading_value: 264358.3094201002 == cash: 210868.99616484388 
2024-11-20 23:07:21,039 - INFO - pnl: 2024-09-10T23:59:59.999 210868.99616484388 === -0.289%
2024-11-20 23:07:21,043 - DEBUG - cur time: 2024-09-11T23:59:59.999 == next bar open time: 2024-09-12T00:00:00.000 == close pos time: 2024-09-19T00:00:00.000
2024-11-20 23:07:21,045 - INFO - pnl: 2024-09-11T23:59:59.999 210126.14568087112 === -0.352%
2024-11-20 23:07:21,050 - DEBUG - cur time: 2024-09-12T23:59:59.999 == next bar open time: 2024-09-13T00:00:00.000 == close pos time: 2024-09-20T00:00:00.000
2024-11-20 23:07:21,051 - INFO - pnl: 2024-09-12T23:59:59.999 212141.32243573744 === 0.959%
2024-11-20 23:07:21,057 - DEBUG - cur time: 2024-09-13T23:59:59.999 == next bar open time: 2024-09-14T00:00:00.000 == close pos time: 2024-09-21T00:00:00.000
2024-11-20 23:07:21,058 - INFO - pnl: 2024-09-13T23:59:59.999 212803.2906381942 === 0.312%
2024-11-20 23:07:21,064 - DEBUG - cur time: 2024-09-14T23:59:59.999 == next bar open time: 2024-09-15T00:00:00.000 == close pos time: 2024-09-22T00:00:00.000
2024-11-20 23:07:21,066 - INFO - pnl: 2024-09-14T23:59:59.999 212647.6125348557 === -0.073%
2024-11-20 23:07:21,070 - DEBUG - cur time: 2024-09-15T23:59:59.999 == next bar open time: 2024-09-16T00:00:00.000 == close pos time: 2024-09-23T00:00:00.000
2024-11-20 23:07:21,072 - INFO - pnl: 2024-09-15T23:59:59.999 212926.97671146627 === 0.131%
2024-11-20 23:07:21,075 - DEBUG - cur time: 2024-09-16T23:59:59.999 == next bar open time: 2024-09-17T00:00:00.000 == close pos time: 2024-09-24T00:00:00.000
2024-11-20 23:07:21,076 - INFO - pnl: 2024-09-16T23:59:59.999 211836.84529034025 === -0.512%
2024-11-20 23:07:21,080 - DEBUG - cur time: 2024-09-17T23:59:59.999 == next bar open time: 2024-09-18T00:00:00.000 == close pos time: 2024-09-25T00:00:00.000
2024-11-20 23:07:21,090 - DEBUG - sorted_long_factors: shape: (247, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ XMRUSDT    ┆ -1.914916    ┆ 0    ┆ 246          │
│ SAGAUSDT   ┆ -1.909144    ┆ 1    ┆ 245          │
│ BBUSDT     ┆ -1.716072    ┆ 2    ┆ 244          │
│ UNIUSDT    ┆ -1.677734    ┆ 3    ┆ 243          │
│ AAVEUSDT   ┆ -1.669095    ┆ 4    ┆ 242          │
│ PENDLEUSDT ┆ -1.66176     ┆ 5    ┆ 241          │
│ BTCDOMUSDT ┆ -1.653197    ┆ 6    ┆ 240          │
│ FETUSDT    ┆ -1.64544     ┆ 7    ┆ 239          │
│ WIFUSDT    ┆ -1.619184    ┆ 8    ┆ 238          │
│ YFIUSDT    ┆ -1.609399    ┆ 9    ┆ 237          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BADGERUSDT ┆ 0.385836     ┆ 237  ┆ 9            │
│ OXTUSDT    ┆ 0.387624     ┆ 238  ┆ 8            │
│ DODOXUSDT  ┆ 0.390019     ┆ 239  ┆ 7            │
│ FXSUSDT    ┆ 0.482455     ┆ 240  ┆ 6            │
│ STEEMUSDT  ┆ 0.569519     ┆ 241  ┆ 5            │
│ COMBOUSDT  ┆ 0.70568      ┆ 242  ┆ 4            │
│ BICOUSDT   ┆ 0.711017     ┆ 243  ┆ 3            │
│ ETHWUSDT   ┆ 0.827163     ┆ 244  ┆ 2            │
│ HFTUSDT    ┆ 0.872395     ┆ 245  ┆ 1            │
│ DEFIUSDT   ┆ 1.16642      ┆ 246  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:21,097 - INFO - cur close time: 2024-09-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:21,098 - DEBUG - mean expected ret (mean factor): -0.7622194608775218
2024-11-20 23:07:21,103 - DEBUG - begin to update pos: =========
2024-11-20 23:07:21,103 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,103 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.016538    ┆ 0.12155     ┆ 0.08174     ┆ 0.0073193   ┆ … ┆ 0.01349 ┆ null   ┆ null    ┆ 0.2844  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,109 - DEBUG - update position: 2024-09-17T23:59:59.999 === diff_trading_value: 205281.78093437478 == cash: 213205.1844626464 
2024-11-20 23:07:21,110 - INFO - pnl: 2024-09-17T23:59:59.999 213205.1844626464 === 0.646%
2024-11-20 23:07:21,114 - DEBUG - cur time: 2024-09-18T23:59:59.999 == next bar open time: 2024-09-19T00:00:00.000 == close pos time: 2024-09-26T00:00:00.000
2024-11-20 23:07:21,116 - INFO - pnl: 2024-09-18T23:59:59.999 214504.80734629475 === 0.610%
2024-11-20 23:07:21,120 - DEBUG - cur time: 2024-09-19T23:59:59.999 == next bar open time: 2024-09-20T00:00:00.000 == close pos time: 2024-09-27T00:00:00.000
2024-11-20 23:07:21,123 - INFO - pnl: 2024-09-19T23:59:59.999 215747.41894860842 === 0.579%
2024-11-20 23:07:21,127 - DEBUG - cur time: 2024-09-20T23:59:59.999 == next bar open time: 2024-09-21T00:00:00.000 == close pos time: 2024-09-28T00:00:00.000
2024-11-20 23:07:21,129 - INFO - pnl: 2024-09-20T23:59:59.999 217650.33299078222 === 0.882%
2024-11-20 23:07:21,133 - DEBUG - cur time: 2024-09-21T23:59:59.999 == next bar open time: 2024-09-22T00:00:00.000 == close pos time: 2024-09-29T00:00:00.000
2024-11-20 23:07:21,133 - INFO - pnl: 2024-09-21T23:59:59.999 219733.86309428458 === 0.957%
2024-11-20 23:07:21,137 - DEBUG - cur time: 2024-09-22T23:59:59.999 == next bar open time: 2024-09-23T00:00:00.000 == close pos time: 2024-09-30T00:00:00.000
2024-11-20 23:07:21,139 - INFO - pnl: 2024-09-22T23:59:59.999 215893.19013572801 === -1.748%
2024-11-20 23:07:21,144 - DEBUG - cur time: 2024-09-23T23:59:59.999 == next bar open time: 2024-09-24T00:00:00.000 == close pos time: 2024-10-01T00:00:00.000
2024-11-20 23:07:21,146 - INFO - pnl: 2024-09-23T23:59:59.999 218230.90656441852 === 1.083%
2024-11-20 23:07:21,150 - DEBUG - cur time: 2024-09-24T23:59:59.999 == next bar open time: 2024-09-25T00:00:00.000 == close pos time: 2024-10-02T00:00:00.000
2024-11-20 23:07:21,159 - DEBUG - sorted_long_factors: shape: (248, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ TAOUSDT    ┆ -2.464415    ┆ 0    ┆ 247          │
│ ETHFIUSDT  ┆ -2.086695    ┆ 1    ┆ 246          │
│ BNBUSDT    ┆ -2.004868    ┆ 2    ┆ 245          │
│ ENSUSDT    ┆ -1.89956     ┆ 3    ┆ 244          │
│ IOUSDT     ┆ -1.815584    ┆ 4    ┆ 243          │
│ BTCDOMUSDT ┆ -1.630439    ┆ 5    ┆ 242          │
│ PENDLEUSDT ┆ -1.594046    ┆ 6    ┆ 241          │
│ TRBUSDT    ┆ -1.58523     ┆ 7    ┆ 240          │
│ GASUSDT    ┆ -1.563073    ┆ 8    ┆ 239          │
│ ENAUSDT    ┆ -1.556092    ┆ 9    ┆ 238          │
│ …          ┆ …            ┆ …    ┆ …            │
│ HFTUSDT    ┆ 0.171558     ┆ 238  ┆ 9            │
│ QNTUSDT    ┆ 0.259607     ┆ 239  ┆ 8            │
│ OXTUSDT    ┆ 0.373785     ┆ 240  ┆ 7            │
│ CELRUSDT   ┆ 0.419692     ┆ 241  ┆ 6            │
│ BANDUSDT   ┆ 0.431989     ┆ 242  ┆ 5            │
│ BICOUSDT   ┆ 0.488011     ┆ 243  ┆ 4            │
│ XVGUSDT    ┆ 0.592383     ┆ 244  ┆ 3            │
│ BNTUSDT    ┆ 0.662136     ┆ 245  ┆ 2            │
│ COMBOUSDT  ┆ 0.732504     ┆ 246  ┆ 1            │
│ DEFIUSDT   ┆ 2.590372     ┆ 247  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:21,167 - WARNING - 2024-09-24T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:21,167 - INFO - cur close time: 2024-09-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:21,167 - DEBUG - mean expected ret (mean factor): -0.7605489518882876
2024-11-20 23:07:21,173 - DEBUG - begin to update pos: =========
2024-11-20 23:07:21,173 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,173 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.01852     ┆ 0.1414      ┆ 0.08757     ┆ 0.0085898   ┆ … ┆ 0.01587 ┆ null   ┆ null    ┆ 0.3397  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,180 - DEBUG - update position: 2024-09-24T23:59:59.999 === diff_trading_value: 242019.80966502073 == cash: 218742.9413058995 
2024-11-20 23:07:21,181 - INFO - pnl: 2024-09-24T23:59:59.999 218742.9413058995 === 0.235%
2024-11-20 23:07:21,186 - DEBUG - cur time: 2024-09-25T23:59:59.999 == next bar open time: 2024-09-26T00:00:00.000 == close pos time: 2024-10-03T00:00:00.000
2024-11-20 23:07:21,188 - INFO - pnl: 2024-09-25T23:59:59.999 219275.8893850413 === 0.244%
2024-11-20 23:07:21,192 - DEBUG - cur time: 2024-09-26T23:59:59.999 == next bar open time: 2024-09-27T00:00:00.000 == close pos time: 2024-10-04T00:00:00.000
2024-11-20 23:07:21,194 - INFO - pnl: 2024-09-26T23:59:59.999 217582.06006428442 === -0.772%
2024-11-20 23:07:21,198 - DEBUG - cur time: 2024-09-27T23:59:59.999 == next bar open time: 2024-09-28T00:00:00.000 == close pos time: 2024-10-05T00:00:00.000
2024-11-20 23:07:21,200 - INFO - pnl: 2024-09-27T23:59:59.999 217604.74318035983 === 0.010%
2024-11-20 23:07:21,204 - DEBUG - cur time: 2024-09-28T23:59:59.999 == next bar open time: 2024-09-29T00:00:00.000 == close pos time: 2024-10-06T00:00:00.000
2024-11-20 23:07:21,206 - INFO - pnl: 2024-09-28T23:59:59.999 218321.62878946675 === 0.329%
2024-11-20 23:07:21,209 - DEBUG - cur time: 2024-09-29T23:59:59.999 == next bar open time: 2024-09-30T00:00:00.000 == close pos time: 2024-10-07T00:00:00.000
2024-11-20 23:07:21,211 - INFO - pnl: 2024-09-29T23:59:59.999 220242.44796881705 === 0.880%
2024-11-20 23:07:21,217 - DEBUG - cur time: 2024-09-30T23:59:59.999 == next bar open time: 2024-10-01T00:00:00.000 == close pos time: 2024-10-08T00:00:00.000
2024-11-20 23:07:21,219 - INFO - pnl: 2024-09-30T23:59:59.999 217688.29291394912 === -1.160%
2024-11-20 23:07:21,223 - DEBUG - cur time: 2024-10-01T23:59:59.999 == next bar open time: 2024-10-02T00:00:00.000 == close pos time: 2024-10-09T00:00:00.000
2024-11-20 23:07:21,234 - DEBUG - sorted_long_factors: shape: (252, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ ETHFIUSDT  ┆ -1.980906    ┆ 0    ┆ 251          │
│ SAGAUSDT   ┆ -1.886257    ┆ 1    ┆ 250          │
│ BTCDOMUSDT ┆ -1.67392     ┆ 2    ┆ 249          │
│ WUSDT      ┆ -1.644793    ┆ 3    ┆ 248          │
│ INJUSDT    ┆ -1.640248    ┆ 4    ┆ 247          │
│ UNFIUSDT   ┆ -1.62161     ┆ 5    ┆ 246          │
│ LUNA2USDT  ┆ -1.621173    ┆ 6    ┆ 245          │
│ TAOUSDT    ┆ -1.586972    ┆ 7    ┆ 244          │
│ UMAUSDT    ┆ -1.576712    ┆ 8    ┆ 243          │
│ REZUSDT    ┆ -1.562606    ┆ 9    ┆ 242          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BICOUSDT   ┆ 0.172051     ┆ 242  ┆ 9            │
│ JOEUSDT    ┆ 0.209702     ┆ 243  ┆ 8            │
│ BADGERUSDT ┆ 0.233053     ┆ 244  ┆ 7            │
│ XVGUSDT    ┆ 0.248129     ┆ 245  ┆ 6            │
│ STEEMUSDT  ┆ 0.25425      ┆ 246  ┆ 5            │
│ METISUSDT  ┆ 0.295008     ┆ 247  ┆ 4            │
│ PERPUSDT   ┆ 0.365894     ┆ 248  ┆ 3            │
│ LSKUSDT    ┆ 0.412788     ┆ 249  ┆ 2            │
│ HFTUSDT    ┆ 0.461739     ┆ 250  ┆ 1            │
│ DEFIUSDT   ┆ 2.156505     ┆ 251  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:21,241 - WARNING - 2024-10-01T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:21,241 - INFO - cur close time: 2024-10-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:21,242 - DEBUG - mean expected ret (mean factor): -0.7663671862769595
2024-11-20 23:07:21,246 - DEBUG - begin to update pos: =========
2024-11-20 23:07:21,246 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,246 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.023853    ┆ 0.13668     ┆ 0.08759     ┆ 0.0096952  ┆ … ┆ 0.01382 ┆ 0.12161 ┆ 4.3713  ┆ 0.3063  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:21,254 - DEBUG - update position: 2024-10-01T23:59:59.999 === diff_trading_value: 239295.19172816304 == cash: 216417.19259708235 
2024-11-20 23:07:21,256 - INFO - pnl: 2024-10-01T23:59:59.999 216417.19259708235 === -0.584%
2024-11-20 23:07:21,260 - DEBUG - cur time: 2024-10-02T23:59:59.999 == next bar open time: 2024-10-03T00:00:00.000 == close pos time: 2024-10-10T00:00:00.000
2024-11-20 23:07:21,262 - INFO - pnl: 2024-10-02T23:59:59.999 213502.54576266804 === -1.347%
2024-11-20 23:07:21,266 - DEBUG - cur time: 2024-10-03T23:59:59.999 == next bar open time: 2024-10-04T00:00:00.000 == close pos time: 2024-10-11T00:00:00.000
2024-11-20 23:07:21,268 - INFO - pnl: 2024-10-03T23:59:59.999 216236.80016022868 === 1.281%
2024-11-20 23:07:21,271 - DEBUG - cur time: 2024-10-04T23:59:59.999 == next bar open time: 2024-10-05T00:00:00.000 == close pos time: 2024-10-12T00:00:00.000
2024-11-20 23:07:21,272 - INFO - pnl: 2024-10-04T23:59:59.999 213932.97765495925 === -1.065%
2024-11-20 23:07:21,275 - DEBUG - cur time: 2024-10-05T23:59:59.999 == next bar open time: 2024-10-06T00:00:00.000 == close pos time: 2024-10-13T00:00:00.000
2024-11-20 23:07:21,277 - INFO - pnl: 2024-10-05T23:59:59.999 213750.73093286445 === -0.085%
2024-11-20 23:07:21,281 - DEBUG - cur time: 2024-10-06T23:59:59.999 == next bar open time: 2024-10-07T00:00:00.000 == close pos time: 2024-10-14T00:00:00.000
2024-11-20 23:07:21,283 - INFO - pnl: 2024-10-06T23:59:59.999 214821.15883999865 === 0.501%
2024-11-20 23:07:21,287 - DEBUG - cur time: 2024-10-07T23:59:59.999 == next bar open time: 2024-10-08T00:00:00.000 == close pos time: 2024-10-15T00:00:00.000
2024-11-20 23:07:21,289 - INFO - pnl: 2024-10-07T23:59:59.999 213700.4931881506 === -0.522%
2024-11-20 23:07:21,293 - DEBUG - cur time: 2024-10-08T23:59:59.999 == next bar open time: 2024-10-09T00:00:00.000 == close pos time: 2024-10-16T00:00:00.000
2024-11-20 23:07:21,305 - DEBUG - sorted_long_factors: shape: (252, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ARUSDT    ┆ -2.270879    ┆ 0    ┆ 251          │
│ UNFIUSDT  ┆ -1.959868    ┆ 1    ┆ 250          │
│ XRPUSDT   ┆ -1.934033    ┆ 2    ┆ 249          │
│ HIGHUSDT  ┆ -1.911469    ┆ 3    ┆ 248          │
│ QTUMUSDT  ┆ -1.889146    ┆ 4    ┆ 247          │
│ NEOUSDT   ┆ -1.808926    ┆ 5    ┆ 246          │
│ EGLDUSDT  ┆ -1.790527    ┆ 6    ┆ 245          │
│ EDUUSDT   ┆ -1.748559    ┆ 7    ┆ 244          │
│ ETHFIUSDT ┆ -1.740856    ┆ 8    ┆ 243          │
│ REZUSDT   ┆ -1.721212    ┆ 9    ┆ 242          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XVGUSDT   ┆ 0.173365     ┆ 242  ┆ 9            │
│ SKLUSDT   ┆ 0.209921     ┆ 243  ┆ 8            │
│ JOEUSDT   ┆ 0.299839     ┆ 244  ┆ 7            │
│ WAXPUSDT  ┆ 0.3121       ┆ 245  ┆ 6            │
│ HFTUSDT   ┆ 0.366646     ┆ 246  ┆ 5            │
│ PERPUSDT  ┆ 0.404417     ┆ 247  ┆ 4            │
│ BICOUSDT  ┆ 0.507468     ┆ 248  ┆ 3            │
│ LSKUSDT   ┆ 0.519648     ┆ 249  ┆ 2            │
│ STEEMUSDT ┆ 0.6833       ┆ 250  ┆ 1            │
│ DEFIUSDT  ┆ 1.907052     ┆ 251  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:21,313 - WARNING - 2024-10-08T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:21,313 - INFO - cur close time: 2024-10-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:21,314 - DEBUG - mean expected ret (mean factor): -0.7711106864941661
2024-11-20 23:07:21,318 - DEBUG - begin to update pos: =========
2024-11-20 23:07:21,319 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,319 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.020946    ┆ 0.13493     ┆ 0.08588     ┆ 0.0095009  ┆ … ┆ 0.01427 ┆ 0.12711 ┆ 4.1214  ┆ 0.3111  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:21,328 - DEBUG - update position: 2024-10-08T23:59:59.999 === diff_trading_value: 225180.91263082853 == cash: 214379.07294345103 
2024-11-20 23:07:21,331 - INFO - pnl: 2024-10-08T23:59:59.999 214379.07294345103 === 0.318%
2024-11-20 23:07:21,336 - DEBUG - cur time: 2024-10-09T23:59:59.999 == next bar open time: 2024-10-10T00:00:00.000 == close pos time: 2024-10-17T00:00:00.000
2024-11-20 23:07:21,338 - INFO - pnl: 2024-10-09T23:59:59.999 214023.92808884746 === -0.166%
2024-11-20 23:07:21,342 - DEBUG - cur time: 2024-10-10T23:59:59.999 == next bar open time: 2024-10-11T00:00:00.000 == close pos time: 2024-10-18T00:00:00.000
2024-11-20 23:07:21,344 - INFO - pnl: 2024-10-10T23:59:59.999 214344.9324154295 === 0.150%
2024-11-20 23:07:21,348 - DEBUG - cur time: 2024-10-11T23:59:59.999 == next bar open time: 2024-10-12T00:00:00.000 == close pos time: 2024-10-19T00:00:00.000
2024-11-20 23:07:21,349 - INFO - pnl: 2024-10-11T23:59:59.999 212567.7093853906 === -0.829%
2024-11-20 23:07:21,355 - DEBUG - cur time: 2024-10-12T23:59:59.999 == next bar open time: 2024-10-13T00:00:00.000 == close pos time: 2024-10-20T00:00:00.000
2024-11-20 23:07:21,356 - INFO - pnl: 2024-10-12T23:59:59.999 213266.957226489 === 0.329%
2024-11-20 23:07:21,360 - DEBUG - cur time: 2024-10-13T23:59:59.999 == next bar open time: 2024-10-14T00:00:00.000 == close pos time: 2024-10-21T00:00:00.000
2024-11-20 23:07:21,361 - INFO - pnl: 2024-10-13T23:59:59.999 213947.04987971892 === 0.319%
2024-11-20 23:07:21,366 - DEBUG - cur time: 2024-10-14T23:59:59.999 == next bar open time: 2024-10-15T00:00:00.000 == close pos time: 2024-10-22T00:00:00.000
2024-11-20 23:07:21,368 - INFO - pnl: 2024-10-14T23:59:59.999 213476.2983742244 === -0.220%
2024-11-20 23:07:21,372 - DEBUG - cur time: 2024-10-15T23:59:59.999 == next bar open time: 2024-10-16T00:00:00.000 == close pos time: 2024-10-23T00:00:00.000
2024-11-20 23:07:21,382 - DEBUG - sorted_long_factors: shape: (252, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT   ┆ -1.951035    ┆ 0    ┆ 251          │
│ NEARUSDT  ┆ -1.769642    ┆ 1    ┆ 250          │
│ ENAUSDT   ┆ -1.75131     ┆ 2    ┆ 249          │
│ WUSDT     ┆ -1.652998    ┆ 3    ┆ 248          │
│ BBUSDT    ┆ -1.645309    ┆ 4    ┆ 247          │
│ FTMUSDT   ┆ -1.613191    ┆ 5    ┆ 246          │
│ ETHFIUSDT ┆ -1.612913    ┆ 6    ┆ 245          │
│ ORDIUSDT  ┆ -1.598696    ┆ 7    ┆ 244          │
│ WLDUSDT   ┆ -1.585978    ┆ 8    ┆ 243          │
│ NOTUSDT   ┆ -1.561946    ┆ 9    ┆ 242          │
│ …         ┆ …            ┆ …    ┆ …            │
│ RVNUSDT   ┆ 0.080969     ┆ 242  ┆ 9            │
│ HFTUSDT   ┆ 0.082291     ┆ 243  ┆ 8            │
│ WAXPUSDT  ┆ 0.195979     ┆ 244  ┆ 7            │
│ DODOXUSDT ┆ 0.199728     ┆ 245  ┆ 6            │
│ LSKUSDT   ┆ 0.222098     ┆ 246  ┆ 5            │
│ NKNUSDT   ┆ 0.243268     ┆ 247  ┆ 4            │
│ XMRUSDT   ┆ 0.282659     ┆ 248  ┆ 3            │
│ PERPUSDT  ┆ 0.284533     ┆ 249  ┆ 2            │
│ STEEMUSDT ┆ 0.656037     ┆ 250  ┆ 1            │
│ DEFIUSDT  ┆ 1.925057     ┆ 251  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:21,389 - WARNING - 2024-10-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:21,390 - INFO - cur close time: 2024-10-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:21,390 - DEBUG - mean expected ret (mean factor): -0.7813346659564694
2024-11-20 23:07:21,395 - DEBUG - begin to update pos: =========
2024-11-20 23:07:21,395 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,396 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.022482    ┆ 0.14815     ┆ 0.09038     ┆ 0.0103876  ┆ … ┆ 0.0153  ┆ 0.13358 ┆ 4.1105  ┆ 0.336   │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:21,402 - DEBUG - update position: 2024-10-15T23:59:59.999 === diff_trading_value: 291901.84481265035 == cash: 214138.7768165237 
2024-11-20 23:07:21,404 - INFO - pnl: 2024-10-15T23:59:59.999 214138.7768165237 === 0.310%
2024-11-20 23:07:21,407 - DEBUG - cur time: 2024-10-16T23:59:59.999 == next bar open time: 2024-10-17T00:00:00.000 == close pos time: 2024-10-24T00:00:00.000
2024-11-20 23:07:21,409 - INFO - pnl: 2024-10-16T23:59:59.999 215696.93257803764 === 0.728%
2024-11-20 23:07:21,413 - DEBUG - cur time: 2024-10-17T23:59:59.999 == next bar open time: 2024-10-18T00:00:00.000 == close pos time: 2024-10-25T00:00:00.000
2024-11-20 23:07:21,414 - INFO - pnl: 2024-10-17T23:59:59.999 217791.5924862164 === 0.971%
2024-11-20 23:07:21,418 - DEBUG - cur time: 2024-10-18T23:59:59.999 == next bar open time: 2024-10-19T00:00:00.000 == close pos time: 2024-10-26T00:00:00.000
2024-11-20 23:07:21,420 - INFO - pnl: 2024-10-18T23:59:59.999 216312.3036005425 === -0.679%
2024-11-20 23:07:21,426 - DEBUG - cur time: 2024-10-19T23:59:59.999 == next bar open time: 2024-10-20T00:00:00.000 == close pos time: 2024-10-27T00:00:00.000
2024-11-20 23:07:21,428 - INFO - pnl: 2024-10-19T23:59:59.999 217761.69114189717 === 0.670%
2024-11-20 23:07:21,432 - DEBUG - cur time: 2024-10-20T23:59:59.999 == next bar open time: 2024-10-21T00:00:00.000 == close pos time: 2024-10-28T00:00:00.000
2024-11-20 23:07:21,434 - INFO - pnl: 2024-10-20T23:59:59.999 220595.14989468045 === 1.301%
2024-11-20 23:07:21,438 - DEBUG - cur time: 2024-10-21T23:59:59.999 == next bar open time: 2024-10-22T00:00:00.000 == close pos time: 2024-10-29T00:00:00.000
2024-11-20 23:07:21,440 - INFO - pnl: 2024-10-21T23:59:59.999 222733.50268929746 === 0.969%
2024-11-20 23:07:21,446 - DEBUG - cur time: 2024-10-22T23:59:59.999 == next bar open time: 2024-10-23T00:00:00.000 == close pos time: 2024-10-30T00:00:00.000
2024-11-20 23:07:21,457 - DEBUG - sorted_long_factors: shape: (251, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ TNSRUSDT   ┆ -1.930972    ┆ 0    ┆ 250          │
│ IOUSDT     ┆ -1.926871    ┆ 1    ┆ 249          │
│ SAGAUSDT   ┆ -1.879219    ┆ 2    ┆ 248          │
│ ARUSDT     ┆ -1.717557    ┆ 3    ┆ 247          │
│ TAOUSDT    ┆ -1.713443    ┆ 4    ┆ 246          │
│ ZROUSDT    ┆ -1.689596    ┆ 5    ┆ 245          │
│ UNIUSDT    ┆ -1.683357    ┆ 6    ┆ 244          │
│ PENDLEUSDT ┆ -1.672572    ┆ 7    ┆ 243          │
│ ZECUSDT    ┆ -1.634894    ┆ 8    ┆ 242          │
│ ZETAUSDT   ┆ -1.634357    ┆ 9    ┆ 241          │
│ …          ┆ …            ┆ …    ┆ …            │
│ XVGUSDT    ┆ 0.065319     ┆ 241  ┆ 9            │
│ HFTUSDT    ┆ 0.083755     ┆ 242  ┆ 8            │
│ ONTUSDT    ┆ 0.085752     ┆ 243  ┆ 7            │
│ NTRNUSDT   ┆ 0.130762     ┆ 244  ┆ 6            │
│ LSKUSDT    ┆ 0.151054     ┆ 245  ┆ 5            │
│ KSMUSDT    ┆ 0.218843     ┆ 246  ┆ 4            │
│ OXTUSDT    ┆ 0.238902     ┆ 247  ┆ 3            │
│ BNTUSDT    ┆ 0.533929     ┆ 248  ┆ 2            │
│ STEEMUSDT  ┆ 0.91607      ┆ 249  ┆ 1            │
│ DEFIUSDT   ┆ 2.273519     ┆ 250  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:21,465 - INFO - cur close time: 2024-10-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:21,466 - DEBUG - mean expected ret (mean factor): -0.7772230163645762
2024-11-20 23:07:21,471 - DEBUG - begin to update pos: =========
2024-11-20 23:07:21,471 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬──────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT  ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---      ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ f64      ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆          ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪══════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ -10000.0 ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴──────────┴─────────┘
2024-11-20 23:07:21,471 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.022727    ┆ 0.14872     ┆ 0.09347     ┆ 0.0100747  ┆ … ┆ 0.01528 ┆ 0.14488 ┆ 3.7975  ┆ 0.3511  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:21,478 - DEBUG - update position: 2024-10-22T23:59:59.999 === diff_trading_value: 306482.4752219962 == cash: 222860.2544158946 
2024-11-20 23:07:21,480 - INFO - pnl: 2024-10-22T23:59:59.999 222860.2544158946 === 0.057%
2024-11-20 23:07:21,484 - DEBUG - cur time: 2024-10-23T23:59:59.999 == next bar open time: 2024-10-24T00:00:00.000 == close pos time: 2024-10-31T00:00:00.000
2024-11-20 23:07:21,486 - INFO - pnl: 2024-10-23T23:59:59.999 221419.44885067717 === -0.647%
2024-11-20 23:07:21,490 - DEBUG - cur time: 2024-10-24T23:59:59.999 == next bar open time: 2024-10-25T00:00:00.000 == close pos time: 2024-11-01T00:00:00.000
2024-11-20 23:07:21,491 - INFO - pnl: 2024-10-24T23:59:59.999 221725.0107586312 === 0.138%
2024-11-20 23:07:21,496 - DEBUG - cur time: 2024-10-25T23:59:59.999 == next bar open time: 2024-10-26T00:00:00.000 == close pos time: 2024-11-02T00:00:00.000
2024-11-20 23:07:21,499 - INFO - pnl: 2024-10-25T23:59:59.999 222261.4741929173 === 0.242%
2024-11-20 23:07:21,503 - DEBUG - cur time: 2024-10-26T23:59:59.999 == next bar open time: 2024-10-27T00:00:00.000 == close pos time: 2024-11-03T00:00:00.000
2024-11-20 23:07:21,504 - INFO - pnl: 2024-10-26T23:59:59.999 220636.40713425295 === -0.731%
2024-11-20 23:07:21,520 - INFO - start get SinglePnl: shape: (125_901, 83)
┌────────────┬───────────┬──────────┬──────────┬───┬───────────┬───────────┬───────────┬───────────┐
│ symbol     ┆ open_time ┆ open     ┆ high     ┆ … ┆ long_valu ┆ short_val ┆ long_valu ┆ short_val │
│ ---        ┆ ---       ┆ ---      ┆ ---      ┆   ┆ e_scale_9 ┆ ue_scale_ ┆ e_scale_1 ┆ ue_scale_ │
│ str        ┆ datetime[ ┆ f64      ┆ f64      ┆   ┆ day       ┆ 9day      ┆ 0day      ┆ 10day     │
│            ┆ ms]       ┆          ┆          ┆   ┆ ---       ┆ ---       ┆ ---       ┆ ---       │
│            ┆           ┆          ┆          ┆   ┆ f64       ┆ f64       ┆ f64       ┆ f64       │
╞════════════╪═══════════╪══════════╪══════════╪═══╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.024872 ┆ 0.02937  ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.024425 ┆ 0.027349 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.027227 ┆ 0.047868 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.03773  ┆ 0.042696 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.030505 ┆ 0.036907 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.029994 ┆ 0.030839 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.027063 ┆ 0.035125 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.031768 ┆ 0.034467 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-1 ┆ 0.0339   ┆ 0.033974 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-1 ┆ 0.031026 ┆ 0.03276  ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ …          ┆ …         ┆ …        ┆ …        ┆ … ┆ …         ┆ …         ┆ …         ┆ …         │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3196   ┆ 0.3373   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3355   ┆ 0.3415   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3359   ┆ 0.3565   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3553   ┆ 0.3881   ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.2       ┆ 0.8       │
│            ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3577   ┆ 0.3581   ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.0       ┆ 1.0       │
│            ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3511   ┆ 0.3547   ┆ … ┆ 0.8       ┆ 1.2       ┆ 1.0       ┆ 1.0       │
│            ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3383   ┆ 0.3548   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3417   ┆ 0.3632   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3194   ┆ 0.3243   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.316    ┆ 0.3317   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
└────────────┴───────────┴──────────┴──────────┴───┴───────────┴───────────┴───────────┴───────────┘
2024-11-20 23:07:21,593 - DEBUG - cur time: 2023-01-11T23:59:59.999 == next bar open time: 2023-01-12T00:00:00.000 == close pos time: 2023-01-19T00:00:00.000
2024-11-20 23:07:21,601 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APEUSDT      ┆ -1.817352    ┆ 0    ┆ 132          │
│ ENSUSDT      ┆ -1.685771    ┆ 1    ┆ 131          │
│ ICPUSDT      ┆ -1.647906    ┆ 2    ┆ 130          │
│ MATICUSDT    ┆ -1.623862    ┆ 3    ┆ 129          │
│ UNIUSDT      ┆ -1.549105    ┆ 4    ┆ 128          │
│ 1000LUNCUSDT ┆ -1.519987    ┆ 5    ┆ 127          │
│ UNFIUSDT     ┆ -1.49129     ┆ 6    ┆ 126          │
│ XMRUSDT      ┆ -1.483742    ┆ 7    ┆ 125          │
│ THETAUSDT    ┆ -1.475362    ┆ 8    ┆ 124          │
│ NEOUSDT      ┆ -1.473415    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ FLMUSDT      ┆ -0.121224    ┆ 123  ┆ 9            │
│ ONEUSDT      ┆ 0.037246     ┆ 124  ┆ 8            │
│ TOMOUSDT     ┆ 0.062454     ┆ 125  ┆ 7            │
│ API3USDT     ┆ 0.077804     ┆ 126  ┆ 6            │
│ ZENUSDT      ┆ 0.115273     ┆ 127  ┆ 5            │
│ DUSKUSDT     ┆ 0.142935     ┆ 128  ┆ 4            │
│ CELRUSDT     ┆ 0.195682     ┆ 129  ┆ 3            │
│ ARPAUSDT     ┆ 0.198621     ┆ 130  ┆ 2            │
│ SKLUSDT      ┆ 0.215992     ┆ 131  ┆ 1            │
│ DEFIUSDT     ┆ 0.768332     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:21,610 - WARNING - 2023-01-11T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:21,611 - INFO - cur close time: 2023-01-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:21,611 - DEBUG - mean expected ret (mean factor): -0.8313756460321154
2024-11-20 23:07:21,617 - DEBUG - begin to update pos: =========
2024-11-20 23:07:21,617 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,618 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1652      ┆ null        ┆ … ┆ 0.02328 ┆ null   ┆ null    ┆ 0.178   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,625 - DEBUG - update position: 2023-01-11T23:59:59.999 === diff_trading_value: 200000.0 == cash: 99800.0 
2024-11-20 23:07:21,630 - DEBUG - cur time: 2023-01-12T23:59:59.999 == next bar open time: 2023-01-13T00:00:00.000 == close pos time: 2023-01-20T00:00:00.000
2024-11-20 23:07:21,632 - INFO - pnl: 2023-01-12T23:59:59.999 100888.96973635448 === 1.091%
2024-11-20 23:07:21,637 - DEBUG - cur time: 2023-01-13T23:59:59.999 == next bar open time: 2023-01-14T00:00:00.000 == close pos time: 2023-01-21T00:00:00.000
2024-11-20 23:07:21,640 - INFO - pnl: 2023-01-13T23:59:59.999 102459.29553248012 === 1.556%
2024-11-20 23:07:21,645 - DEBUG - cur time: 2023-01-14T23:59:59.999 == next bar open time: 2023-01-15T00:00:00.000 == close pos time: 2023-01-22T00:00:00.000
2024-11-20 23:07:21,648 - INFO - pnl: 2023-01-14T23:59:59.999 103106.24483001948 === 0.631%
2024-11-20 23:07:21,653 - DEBUG - cur time: 2023-01-15T23:59:59.999 == next bar open time: 2023-01-16T00:00:00.000 == close pos time: 2023-01-23T00:00:00.000
2024-11-20 23:07:21,657 - INFO - pnl: 2023-01-15T23:59:59.999 103121.60805329148 === 0.015%
2024-11-20 23:07:21,662 - DEBUG - cur time: 2023-01-16T23:59:59.999 == next bar open time: 2023-01-17T00:00:00.000 == close pos time: 2023-01-24T00:00:00.000
2024-11-20 23:07:21,664 - INFO - pnl: 2023-01-16T23:59:59.999 103993.05216530015 === 0.845%
2024-11-20 23:07:21,671 - DEBUG - cur time: 2023-01-17T23:59:59.999 == next bar open time: 2023-01-18T00:00:00.000 == close pos time: 2023-01-25T00:00:00.000
2024-11-20 23:07:21,674 - INFO - pnl: 2023-01-17T23:59:59.999 104875.301293792 === 0.848%
2024-11-20 23:07:21,680 - DEBUG - cur time: 2023-01-18T23:59:59.999 == next bar open time: 2023-01-19T00:00:00.000 == close pos time: 2023-01-26T00:00:00.000
2024-11-20 23:07:21,692 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AAVEUSDT     ┆ -1.790211    ┆ 0    ┆ 132          │
│ ICPUSDT      ┆ -1.747107    ┆ 1    ┆ 131          │
│ 1000LUNCUSDT ┆ -1.61149     ┆ 2    ┆ 130          │
│ INJUSDT      ┆ -1.594118    ┆ 3    ┆ 129          │
│ UNIUSDT      ┆ -1.584918    ┆ 4    ┆ 128          │
│ LUNA2USDT    ┆ -1.558461    ┆ 5    ┆ 127          │
│ ENSUSDT      ┆ -1.491558    ┆ 6    ┆ 126          │
│ GALUSDT      ┆ -1.486855    ┆ 7    ┆ 125          │
│ THETAUSDT    ┆ -1.452769    ┆ 8    ┆ 124          │
│ CVXUSDT      ┆ -1.405377    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ GALAUSDT     ┆ -0.269919    ┆ 123  ┆ 9            │
│ MKRUSDT      ┆ -0.239208    ┆ 124  ┆ 8            │
│ RLCUSDT      ┆ -0.195405    ┆ 125  ┆ 7            │
│ BALUSDT      ┆ -0.165609    ┆ 126  ┆ 6            │
│ ANTUSDT      ┆ -0.093971    ┆ 127  ┆ 5            │
│ TOMOUSDT     ┆ -0.079367    ┆ 128  ┆ 4            │
│ LPTUSDT      ┆ 0.103317     ┆ 129  ┆ 3            │
│ ARPAUSDT     ┆ 0.286929     ┆ 130  ┆ 2            │
│ API3USDT     ┆ 0.331408     ┆ 131  ┆ 1            │
│ DEFIUSDT     ┆ 0.391309     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:21,700 - WARNING - 2023-01-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:21,700 - INFO - cur close time: 2023-01-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:21,700 - DEBUG - mean expected ret (mean factor): -0.8209174326221409
2024-11-20 23:07:21,705 - DEBUG - begin to update pos: =========
2024-11-20 23:07:21,705 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,706 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1616      ┆ null        ┆ … ┆ 0.0247  ┆ null   ┆ null    ┆ 0.1972  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,714 - DEBUG - update position: 2023-01-18T23:59:59.999 === diff_trading_value: 229290.161610551 == cash: 104087.19865756933 
2024-11-20 23:07:21,715 - INFO - pnl: 2023-01-18T23:59:59.999 104087.19865756933 === -0.751%
2024-11-20 23:07:21,720 - DEBUG - cur time: 2023-01-19T23:59:59.999 == next bar open time: 2023-01-20T00:00:00.000 == close pos time: 2023-01-27T00:00:00.000
2024-11-20 23:07:21,723 - INFO - pnl: 2023-01-19T23:59:59.999 102870.81925933843 === -1.169%
2024-11-20 23:07:21,727 - DEBUG - cur time: 2023-01-20T23:59:59.999 == next bar open time: 2023-01-21T00:00:00.000 == close pos time: 2023-01-28T00:00:00.000
2024-11-20 23:07:21,728 - INFO - pnl: 2023-01-20T23:59:59.999 103926.33472497738 === 1.026%
2024-11-20 23:07:21,733 - DEBUG - cur time: 2023-01-21T23:59:59.999 == next bar open time: 2023-01-22T00:00:00.000 == close pos time: 2023-01-29T00:00:00.000
2024-11-20 23:07:21,735 - INFO - pnl: 2023-01-21T23:59:59.999 104210.14314354098 === 0.273%
2024-11-20 23:07:21,740 - DEBUG - cur time: 2023-01-22T23:59:59.999 == next bar open time: 2023-01-23T00:00:00.000 == close pos time: 2023-01-30T00:00:00.000
2024-11-20 23:07:21,742 - INFO - pnl: 2023-01-22T23:59:59.999 103517.09147534469 === -0.665%
2024-11-20 23:07:21,747 - DEBUG - cur time: 2023-01-23T23:59:59.999 == next bar open time: 2023-01-24T00:00:00.000 == close pos time: 2023-01-31T00:00:00.000
2024-11-20 23:07:21,750 - INFO - pnl: 2023-01-23T23:59:59.999 106276.62016382757 === 2.666%
2024-11-20 23:07:21,756 - DEBUG - cur time: 2023-01-24T23:59:59.999 == next bar open time: 2023-01-25T00:00:00.000 == close pos time: 2023-02-01T00:00:00.000
2024-11-20 23:07:21,759 - INFO - pnl: 2023-01-24T23:59:59.999 110242.09025579151 === 3.731%
2024-11-20 23:07:21,763 - DEBUG - cur time: 2023-01-25T23:59:59.999 == next bar open time: 2023-01-26T00:00:00.000 == close pos time: 2023-02-02T00:00:00.000
2024-11-20 23:07:21,771 - DEBUG - sorted_long_factors: shape: (133, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ LUNA2USDT ┆ -1.963473    ┆ 0    ┆ 132          │
│ BNBUSDT   ┆ -1.854558    ┆ 1    ┆ 131          │
│ LDOUSDT   ┆ -1.841382    ┆ 2    ┆ 130          │
│ FILUSDT   ┆ -1.670508    ┆ 3    ┆ 129          │
│ APEUSDT   ┆ -1.660691    ┆ 4    ┆ 128          │
│ LITUSDT   ┆ -1.650733    ┆ 5    ┆ 127          │
│ UNFIUSDT  ┆ -1.586917    ┆ 6    ┆ 126          │
│ YFIUSDT   ┆ -1.583351    ┆ 7    ┆ 125          │
│ AAVEUSDT  ┆ -1.582835    ┆ 8    ┆ 124          │
│ AXSUSDT   ┆ -1.526904    ┆ 9    ┆ 123          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CELRUSDT  ┆ -0.121716    ┆ 123  ┆ 9            │
│ GTCUSDT   ┆ -0.114663    ┆ 124  ┆ 8            │
│ QTUMUSDT  ┆ -0.10805     ┆ 125  ┆ 7            │
│ DGBUSDT   ┆ -0.015506    ┆ 126  ┆ 6            │
│ ANTUSDT   ┆ -0.002138    ┆ 127  ┆ 5            │
│ SFPUSDT   ┆ 0.011728     ┆ 128  ┆ 4            │
│ TOMOUSDT  ┆ 0.091289     ┆ 129  ┆ 3            │
│ SKLUSDT   ┆ 0.3103       ┆ 130  ┆ 2            │
│ ARPAUSDT  ┆ 0.41621      ┆ 131  ┆ 1            │
│ DEFIUSDT  ┆ 1.005012     ┆ 132  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:21,780 - WARNING - 2023-01-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:21,780 - INFO - cur close time: 2023-01-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:21,781 - DEBUG - mean expected ret (mean factor): -0.8134948394878994
2024-11-20 23:07:21,788 - DEBUG - begin to update pos: =========
2024-11-20 23:07:21,788 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,789 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1735      ┆ null        ┆ … ┆ 0.028   ┆ null   ┆ null    ┆ 0.2252  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,797 - DEBUG - update position: 2023-01-25T23:59:59.999 === diff_trading_value: 296249.7913731963 == cash: 105970.31879144476 
2024-11-20 23:07:21,799 - INFO - pnl: 2023-01-25T23:59:59.999 105970.31879144476 === -3.875%
2024-11-20 23:07:21,803 - DEBUG - cur time: 2023-01-26T23:59:59.999 == next bar open time: 2023-01-27T00:00:00.000 == close pos time: 2023-02-03T00:00:00.000
2024-11-20 23:07:21,805 - INFO - pnl: 2023-01-26T23:59:59.999 109615.01883131126 === 3.439%
2024-11-20 23:07:21,809 - DEBUG - cur time: 2023-01-27T23:59:59.999 == next bar open time: 2023-01-28T00:00:00.000 == close pos time: 2023-02-04T00:00:00.000
2024-11-20 23:07:21,811 - INFO - pnl: 2023-01-27T23:59:59.999 111900.09137194266 === 2.085%
2024-11-20 23:07:21,816 - DEBUG - cur time: 2023-01-28T23:59:59.999 == next bar open time: 2023-01-29T00:00:00.000 == close pos time: 2023-02-05T00:00:00.000
2024-11-20 23:07:21,819 - INFO - pnl: 2023-01-28T23:59:59.999 111963.48495346775 === 0.057%
2024-11-20 23:07:21,823 - DEBUG - cur time: 2023-01-29T23:59:59.999 == next bar open time: 2023-01-30T00:00:00.000 == close pos time: 2023-02-06T00:00:00.000
2024-11-20 23:07:21,825 - INFO - pnl: 2023-01-29T23:59:59.999 112077.19581262367 === 0.102%
2024-11-20 23:07:21,830 - DEBUG - cur time: 2023-01-30T23:59:59.999 == next bar open time: 2023-01-31T00:00:00.000 == close pos time: 2023-02-07T00:00:00.000
2024-11-20 23:07:21,831 - INFO - pnl: 2023-01-30T23:59:59.999 115622.22575152668 === 3.163%
2024-11-20 23:07:21,836 - DEBUG - cur time: 2023-01-31T23:59:59.999 == next bar open time: 2023-02-01T00:00:00.000 == close pos time: 2023-02-08T00:00:00.000
2024-11-20 23:07:21,838 - INFO - pnl: 2023-01-31T23:59:59.999 115029.64730264037 === -0.513%
2024-11-20 23:07:21,843 - DEBUG - cur time: 2023-02-01T23:59:59.999 == next bar open time: 2023-02-02T00:00:00.000 == close pos time: 2023-02-09T00:00:00.000
2024-11-20 23:07:21,853 - DEBUG - sorted_long_factors: shape: (135, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ LDOUSDT   ┆ -1.792408    ┆ 0    ┆ 134          │
│ COMPUSDT  ┆ -1.756543    ┆ 1    ┆ 133          │
│ QNTUSDT   ┆ -1.746092    ┆ 2    ┆ 132          │
│ LUNA2USDT ┆ -1.645851    ┆ 3    ┆ 131          │
│ BNBUSDT   ┆ -1.632525    ┆ 4    ┆ 130          │
│ INJUSDT   ┆ -1.574229    ┆ 5    ┆ 129          │
│ FILUSDT   ┆ -1.569397    ┆ 6    ┆ 128          │
│ ATOMUSDT  ┆ -1.550613    ┆ 7    ┆ 127          │
│ DOTUSDT   ┆ -1.536673    ┆ 8    ┆ 126          │
│ AAVEUSDT  ┆ -1.501641    ┆ 9    ┆ 125          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ONTUSDT   ┆ -0.084793    ┆ 125  ┆ 9            │
│ API3USDT  ┆ -0.067999    ┆ 126  ┆ 8            │
│ IOSTUSDT  ┆ 0.009119     ┆ 127  ┆ 7            │
│ BLZUSDT   ┆ 0.021592     ┆ 128  ┆ 6            │
│ DENTUSDT  ┆ 0.078358     ┆ 129  ┆ 5            │
│ TOMOUSDT  ┆ 0.154288     ┆ 130  ┆ 4            │
│ ARPAUSDT  ┆ 0.203096     ┆ 131  ┆ 3            │
│ CTSIUSDT  ┆ 0.219513     ┆ 132  ┆ 2            │
│ DGBUSDT   ┆ 0.509735     ┆ 133  ┆ 1            │
│ DEFIUSDT  ┆ 2.453297     ┆ 134  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:21,860 - INFO - cur close time: 2023-02-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:21,860 - DEBUG - mean expected ret (mean factor): -0.8126735317227447
2024-11-20 23:07:21,865 - DEBUG - begin to update pos: =========
2024-11-20 23:07:21,866 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,866 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1716      ┆ null        ┆ … ┆ 0.02818 ┆ null   ┆ null    ┆ 0.2261  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,872 - DEBUG - update position: 2023-02-01T23:59:59.999 === diff_trading_value: 208899.69261296533 == cash: 115223.84897506615 
2024-11-20 23:07:21,874 - INFO - pnl: 2023-02-01T23:59:59.999 115223.84897506615 === 0.169%
2024-11-20 23:07:21,879 - DEBUG - cur time: 2023-02-02T23:59:59.999 == next bar open time: 2023-02-03T00:00:00.000 == close pos time: 2023-02-10T00:00:00.000
2024-11-20 23:07:21,881 - INFO - pnl: 2023-02-02T23:59:59.999 118617.27096841623 === 2.945%
2024-11-20 23:07:21,884 - DEBUG - cur time: 2023-02-03T23:59:59.999 == next bar open time: 2023-02-04T00:00:00.000 == close pos time: 2023-02-11T00:00:00.000
2024-11-20 23:07:21,885 - INFO - pnl: 2023-02-03T23:59:59.999 119057.75948710939 === 0.371%
2024-11-20 23:07:21,889 - DEBUG - cur time: 2023-02-04T23:59:59.999 == next bar open time: 2023-02-05T00:00:00.000 == close pos time: 2023-02-12T00:00:00.000
2024-11-20 23:07:21,890 - INFO - pnl: 2023-02-04T23:59:59.999 121050.58865727954 === 1.674%
2024-11-20 23:07:21,894 - DEBUG - cur time: 2023-02-05T23:59:59.999 == next bar open time: 2023-02-06T00:00:00.000 == close pos time: 2023-02-13T00:00:00.000
2024-11-20 23:07:21,896 - INFO - pnl: 2023-02-05T23:59:59.999 121466.31459097963 === 0.343%
2024-11-20 23:07:21,899 - DEBUG - cur time: 2023-02-06T23:59:59.999 == next bar open time: 2023-02-07T00:00:00.000 == close pos time: 2023-02-14T00:00:00.000
2024-11-20 23:07:21,901 - INFO - pnl: 2023-02-06T23:59:59.999 121847.52351649088 === 0.314%
2024-11-20 23:07:21,904 - DEBUG - cur time: 2023-02-07T23:59:59.999 == next bar open time: 2023-02-08T00:00:00.000 == close pos time: 2023-02-15T00:00:00.000
2024-11-20 23:07:21,906 - INFO - pnl: 2023-02-07T23:59:59.999 122831.6050937805 === 0.808%
2024-11-20 23:07:21,909 - DEBUG - cur time: 2023-02-08T23:59:59.999 == next bar open time: 2023-02-09T00:00:00.000 == close pos time: 2023-02-16T00:00:00.000
2024-11-20 23:07:21,918 - DEBUG - sorted_long_factors: shape: (135, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ APTUSDT   ┆ -1.767094    ┆ 0    ┆ 134          │
│ MATICUSDT ┆ -1.664747    ┆ 1    ┆ 133          │
│ AXSUSDT   ┆ -1.650827    ┆ 2    ┆ 132          │
│ NEARUSDT  ┆ -1.63461     ┆ 3    ┆ 131          │
│ LDOUSDT   ┆ -1.598785    ┆ 4    ┆ 130          │
│ LUNA2USDT ┆ -1.531781    ┆ 5    ┆ 129          │
│ OMGUSDT   ┆ -1.496587    ┆ 6    ┆ 128          │
│ STGUSDT   ┆ -1.445851    ┆ 7    ┆ 127          │
│ STORJUSDT ┆ -1.392054    ┆ 8    ┆ 126          │
│ TRXUSDT   ┆ -1.387553    ┆ 9    ┆ 125          │
│ …         ┆ …            ┆ …    ┆ …            │
│ LINAUSDT  ┆ -0.145818    ┆ 125  ┆ 9            │
│ OGNUSDT   ┆ -0.143976    ┆ 126  ┆ 8            │
│ FLMUSDT   ┆ -0.097215    ┆ 127  ┆ 7            │
│ DUSKUSDT  ┆ 0.008945     ┆ 128  ┆ 6            │
│ TOMOUSDT  ┆ 0.08452      ┆ 129  ┆ 5            │
│ SKLUSDT   ┆ 0.088639     ┆ 130  ┆ 4            │
│ DASHUSDT  ┆ 0.246867     ┆ 131  ┆ 3            │
│ API3USDT  ┆ 0.278236     ┆ 132  ┆ 2            │
│ DGBUSDT   ┆ 0.696647     ┆ 133  ┆ 1            │
│ DEFIUSDT  ┆ 1.529131     ┆ 134  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:21,927 - WARNING - 2023-02-08T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:21,927 - INFO - cur close time: 2023-02-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:21,927 - DEBUG - mean expected ret (mean factor): -0.8061779612666871
2024-11-20 23:07:21,932 - DEBUG - begin to update pos: =========
2024-11-20 23:07:21,933 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,933 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1809      ┆ null        ┆ … ┆ 0.03077 ┆ null   ┆ null    ┆ 0.2555  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:21,940 - DEBUG - update position: 2023-02-08T23:59:59.999 === diff_trading_value: 269062.77728610183 == cash: 122317.26781689675 
2024-11-20 23:07:21,941 - INFO - pnl: 2023-02-08T23:59:59.999 122317.26781689675 === -0.419%
2024-11-20 23:07:21,946 - DEBUG - cur time: 2023-02-09T23:59:59.999 == next bar open time: 2023-02-10T00:00:00.000 == close pos time: 2023-02-17T00:00:00.000
2024-11-20 23:07:21,948 - INFO - pnl: 2023-02-09T23:59:59.999 121276.79763569243 === -0.851%
2024-11-20 23:07:21,953 - DEBUG - cur time: 2023-02-10T23:59:59.999 == next bar open time: 2023-02-11T00:00:00.000 == close pos time: 2023-02-18T00:00:00.000
2024-11-20 23:07:21,955 - INFO - pnl: 2023-02-10T23:59:59.999 126311.22190470214 === 4.151%
2024-11-20 23:07:21,958 - DEBUG - cur time: 2023-02-11T23:59:59.999 == next bar open time: 2023-02-12T00:00:00.000 == close pos time: 2023-02-19T00:00:00.000
2024-11-20 23:07:21,961 - INFO - pnl: 2023-02-11T23:59:59.999 128335.16628804557 === 1.602%
2024-11-20 23:07:21,966 - DEBUG - cur time: 2023-02-12T23:59:59.999 == next bar open time: 2023-02-13T00:00:00.000 == close pos time: 2023-02-20T00:00:00.000
2024-11-20 23:07:21,967 - INFO - pnl: 2023-02-12T23:59:59.999 129489.68212074979 === 0.900%
2024-11-20 23:07:21,972 - DEBUG - cur time: 2023-02-13T23:59:59.999 == next bar open time: 2023-02-14T00:00:00.000 == close pos time: 2023-02-21T00:00:00.000
2024-11-20 23:07:21,975 - INFO - pnl: 2023-02-13T23:59:59.999 127241.6437428741 === -1.736%
2024-11-20 23:07:21,983 - DEBUG - cur time: 2023-02-14T23:59:59.999 == next bar open time: 2023-02-15T00:00:00.000 == close pos time: 2023-02-22T00:00:00.000
2024-11-20 23:07:21,986 - INFO - pnl: 2023-02-14T23:59:59.999 126706.99174120801 === -0.420%
2024-11-20 23:07:21,990 - DEBUG - cur time: 2023-02-15T23:59:59.999 == next bar open time: 2023-02-16T00:00:00.000 == close pos time: 2023-02-23T00:00:00.000
2024-11-20 23:07:22,003 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ATOMUSDT     ┆ -1.906777    ┆ 0    ┆ 135          │
│ FOOTBALLUSDT ┆ -1.852958    ┆ 1    ┆ 134          │
│ AXSUSDT      ┆ -1.848002    ┆ 2    ┆ 133          │
│ LDOUSDT      ┆ -1.750042    ┆ 3    ┆ 132          │
│ NEARUSDT     ┆ -1.706776    ┆ 4    ┆ 131          │
│ STGUSDT      ┆ -1.630965    ┆ 5    ┆ 130          │
│ LITUSDT      ┆ -1.566104    ┆ 6    ┆ 129          │
│ INJUSDT      ┆ -1.565959    ┆ 7    ┆ 128          │
│ SNXUSDT      ┆ -1.556503    ┆ 8    ┆ 127          │
│ NEOUSDT      ┆ -1.48028     ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COTIUSDT     ┆ -0.024533    ┆ 126  ┆ 9            │
│ NKNUSDT      ┆ -0.003268    ┆ 127  ┆ 8            │
│ XEMUSDT      ┆ 0.128847     ┆ 128  ┆ 7            │
│ BELUSDT      ┆ 0.141711     ┆ 129  ┆ 6            │
│ 1000XECUSDT  ┆ 0.335515     ┆ 130  ┆ 5            │
│ DENTUSDT     ┆ 0.362076     ┆ 131  ┆ 4            │
│ LINAUSDT     ┆ 0.38541      ┆ 132  ┆ 3            │
│ DEFIUSDT     ┆ 0.72993      ┆ 133  ┆ 2            │
│ DGBUSDT      ┆ 0.90118      ┆ 134  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.466058     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:22,013 - WARNING - 2023-02-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:22,013 - INFO - cur close time: 2023-02-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:22,013 - DEBUG - mean expected ret (mean factor): -0.7927822456621036
2024-11-20 23:07:22,020 - DEBUG - begin to update pos: =========
2024-11-20 23:07:22,020 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,021 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1758      ┆ null        ┆ … ┆ 0.0315  ┆ null   ┆ null    ┆ 0.2543  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,029 - DEBUG - update position: 2023-02-15T23:59:59.999 === diff_trading_value: 251962.4651937724 == cash: 126275.28181797799 
2024-11-20 23:07:22,031 - INFO - pnl: 2023-02-15T23:59:59.999 126275.28181797799 === -0.341%
2024-11-20 23:07:22,034 - DEBUG - cur time: 2023-02-16T23:59:59.999 == next bar open time: 2023-02-17T00:00:00.000 == close pos time: 2023-02-24T00:00:00.000
2024-11-20 23:07:22,036 - INFO - pnl: 2023-02-16T23:59:59.999 126933.53141564006 === 0.521%
2024-11-20 23:07:22,040 - DEBUG - cur time: 2023-02-17T23:59:59.999 == next bar open time: 2023-02-18T00:00:00.000 == close pos time: 2023-02-25T00:00:00.000
2024-11-20 23:07:22,042 - INFO - pnl: 2023-02-17T23:59:59.999 127254.47187386318 === 0.253%
2024-11-20 23:07:22,046 - DEBUG - cur time: 2023-02-18T23:59:59.999 == next bar open time: 2023-02-19T00:00:00.000 == close pos time: 2023-02-26T00:00:00.000
2024-11-20 23:07:22,048 - INFO - pnl: 2023-02-18T23:59:59.999 124633.28624084764 === -2.060%
2024-11-20 23:07:22,054 - DEBUG - cur time: 2023-02-19T23:59:59.999 == next bar open time: 2023-02-20T00:00:00.000 == close pos time: 2023-02-27T00:00:00.000
2024-11-20 23:07:22,057 - INFO - pnl: 2023-02-19T23:59:59.999 127153.50565574483 === 2.022%
2024-11-20 23:07:22,061 - DEBUG - cur time: 2023-02-20T23:59:59.999 == next bar open time: 2023-02-21T00:00:00.000 == close pos time: 2023-02-28T00:00:00.000
2024-11-20 23:07:22,064 - INFO - pnl: 2023-02-20T23:59:59.999 130477.09855164564 === 2.614%
2024-11-20 23:07:22,068 - DEBUG - cur time: 2023-02-21T23:59:59.999 == next bar open time: 2023-02-22T00:00:00.000 == close pos time: 2023-03-01T00:00:00.000
2024-11-20 23:07:22,070 - INFO - pnl: 2023-02-21T23:59:59.999 136329.8744845814 === 4.486%
2024-11-20 23:07:22,074 - DEBUG - cur time: 2023-02-22T23:59:59.999 == next bar open time: 2023-02-23T00:00:00.000 == close pos time: 2023-03-02T00:00:00.000
2024-11-20 23:07:22,085 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -1.61952     ┆ 0    ┆ 135          │
│ 1000LUNCUSDT ┆ -1.604421    ┆ 1    ┆ 134          │
│ LUNA2USDT    ┆ -1.47009     ┆ 2    ┆ 133          │
│ WAVESUSDT    ┆ -1.450583    ┆ 3    ┆ 132          │
│ YFIUSDT      ┆ -1.447575    ┆ 4    ┆ 131          │
│ STGUSDT      ┆ -1.441735    ┆ 5    ┆ 130          │
│ INJUSDT      ┆ -1.425359    ┆ 6    ┆ 129          │
│ NEOUSDT      ┆ -1.391127    ┆ 7    ┆ 128          │
│ QNTUSDT      ┆ -1.370337    ┆ 8    ┆ 127          │
│ TRXUSDT      ┆ -1.352687    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CRVUSDT      ┆ -0.301605    ┆ 126  ┆ 9            │
│ DGBUSDT      ┆ -0.222469    ┆ 127  ┆ 8            │
│ COTIUSDT     ┆ -0.221219    ┆ 128  ┆ 7            │
│ DARUSDT      ┆ -0.18125     ┆ 129  ┆ 6            │
│ 1000XECUSDT  ┆ -0.161184    ┆ 130  ┆ 5            │
│ API3USDT     ┆ -0.128839    ┆ 131  ┆ 4            │
│ AAVEUSDT     ┆ -0.000102    ┆ 132  ┆ 3            │
│ ANTUSDT      ┆ 0.156716     ┆ 133  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.612608     ┆ 134  ┆ 1            │
│ DEFIUSDT     ┆ 1.713084     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:22,092 - WARNING - 2023-02-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:22,092 - INFO - cur close time: 2023-02-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:22,092 - DEBUG - mean expected ret (mean factor): -0.7821032872078173
2024-11-20 23:07:22,097 - DEBUG - begin to update pos: =========
2024-11-20 23:07:22,097 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,097 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1637      ┆ null        ┆ … ┆ 0.03529 ┆ null   ┆ null    ┆ 0.2628  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,104 - DEBUG - update position: 2023-02-22T23:59:59.999 === diff_trading_value: 267554.892012171 == cash: 134787.6006100313 
2024-11-20 23:07:22,105 - INFO - pnl: 2023-02-22T23:59:59.999 134787.6006100313 === -1.131%
2024-11-20 23:07:22,108 - DEBUG - cur time: 2023-02-23T23:59:59.999 == next bar open time: 2023-02-24T00:00:00.000 == close pos time: 2023-03-03T00:00:00.000
2024-11-20 23:07:22,110 - INFO - pnl: 2023-02-23T23:59:59.999 134106.79648879578 === -0.505%
2024-11-20 23:07:22,116 - DEBUG - cur time: 2023-02-24T23:59:59.999 == next bar open time: 2023-02-25T00:00:00.000 == close pos time: 2023-03-04T00:00:00.000
2024-11-20 23:07:22,118 - INFO - pnl: 2023-02-24T23:59:59.999 134586.50099127233 === 0.358%
2024-11-20 23:07:22,122 - DEBUG - cur time: 2023-02-25T23:59:59.999 == next bar open time: 2023-02-26T00:00:00.000 == close pos time: 2023-03-05T00:00:00.000
2024-11-20 23:07:22,123 - INFO - pnl: 2023-02-25T23:59:59.999 134390.27795710062 === -0.146%
2024-11-20 23:07:22,127 - DEBUG - cur time: 2023-02-26T23:59:59.999 == next bar open time: 2023-02-27T00:00:00.000 == close pos time: 2023-03-06T00:00:00.000
2024-11-20 23:07:22,129 - INFO - pnl: 2023-02-26T23:59:59.999 132283.51333020726 === -1.568%
2024-11-20 23:07:22,135 - DEBUG - cur time: 2023-02-27T23:59:59.999 == next bar open time: 2023-02-28T00:00:00.000 == close pos time: 2023-03-07T00:00:00.000
2024-11-20 23:07:22,137 - INFO - pnl: 2023-02-27T23:59:59.999 131636.1305033063 === -0.489%
2024-11-20 23:07:22,141 - DEBUG - cur time: 2023-02-28T23:59:59.999 == next bar open time: 2023-03-01T00:00:00.000 == close pos time: 2023-03-08T00:00:00.000
2024-11-20 23:07:22,144 - INFO - pnl: 2023-02-28T23:59:59.999 131585.364045618 === -0.039%
2024-11-20 23:07:22,149 - DEBUG - cur time: 2023-03-01T23:59:59.999 == next bar open time: 2023-03-02T00:00:00.000 == close pos time: 2023-03-09T00:00:00.000
2024-11-20 23:07:22,159 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LDOUSDT      ┆ -1.884997    ┆ 0    ┆ 135          │
│ OPUSDT       ┆ -1.667656    ┆ 1    ┆ 134          │
│ AXSUSDT      ┆ -1.654117    ┆ 2    ┆ 133          │
│ FILUSDT      ┆ -1.642817    ┆ 3    ┆ 132          │
│ XMRUSDT      ┆ -1.63672     ┆ 4    ┆ 131          │
│ DOTUSDT      ┆ -1.631298    ┆ 5    ┆ 130          │
│ BNBUSDT      ┆ -1.604752    ┆ 6    ┆ 129          │
│ ICPUSDT      ┆ -1.548681    ┆ 7    ┆ 128          │
│ TRBUSDT      ┆ -1.523538    ┆ 8    ┆ 127          │
│ ENSUSDT      ┆ -1.520849    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ LINAUSDT     ┆ 0.042728     ┆ 126  ┆ 9            │
│ DENTUSDT     ┆ 0.096419     ┆ 127  ┆ 8            │
│ DGBUSDT      ┆ 0.130382     ┆ 128  ┆ 7            │
│ LPTUSDT      ┆ 0.136518     ┆ 129  ┆ 6            │
│ COTIUSDT     ┆ 0.258981     ┆ 130  ┆ 5            │
│ 1000XECUSDT  ┆ 0.307839     ┆ 131  ┆ 4            │
│ DARUSDT      ┆ 0.366134     ┆ 132  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.666039     ┆ 133  ┆ 2            │
│ API3USDT     ┆ 0.88143      ┆ 134  ┆ 1            │
│ DEFIUSDT     ┆ 1.101872     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:22,167 - WARNING - 2023-03-01T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:22,167 - INFO - cur close time: 2023-03-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:22,167 - DEBUG - mean expected ret (mean factor): -0.7779772575839868
2024-11-20 23:07:22,172 - DEBUG - begin to update pos: =========
2024-11-20 23:07:22,172 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,173 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1655      ┆ null        ┆ … ┆ 0.03209 ┆ null   ┆ null    ┆ 0.3018  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,180 - DEBUG - update position: 2023-03-01T23:59:59.999 === diff_trading_value: 302255.6435745097 == cash: 130932.99238673727 
2024-11-20 23:07:22,182 - INFO - pnl: 2023-03-01T23:59:59.999 130932.99238673727 === -0.496%
2024-11-20 23:07:22,187 - DEBUG - cur time: 2023-03-02T23:59:59.999 == next bar open time: 2023-03-03T00:00:00.000 == close pos time: 2023-03-10T00:00:00.000
2024-11-20 23:07:22,189 - INFO - pnl: 2023-03-02T23:59:59.999 130481.43099566076 === -0.345%
2024-11-20 23:07:22,194 - DEBUG - cur time: 2023-03-03T23:59:59.999 == next bar open time: 2023-03-04T00:00:00.000 == close pos time: 2023-03-11T00:00:00.000
2024-11-20 23:07:22,197 - INFO - pnl: 2023-03-03T23:59:59.999 129507.58817023256 === -0.746%
2024-11-20 23:07:22,200 - DEBUG - cur time: 2023-03-04T23:59:59.999 == next bar open time: 2023-03-05T00:00:00.000 == close pos time: 2023-03-12T00:00:00.000
2024-11-20 23:07:22,201 - INFO - pnl: 2023-03-04T23:59:59.999 129413.23270922985 === -0.073%
2024-11-20 23:07:22,205 - DEBUG - cur time: 2023-03-05T23:59:59.999 == next bar open time: 2023-03-06T00:00:00.000 == close pos time: 2023-03-13T00:00:00.000
2024-11-20 23:07:22,208 - INFO - pnl: 2023-03-05T23:59:59.999 128734.74404526206 === -0.524%
2024-11-20 23:07:22,212 - DEBUG - cur time: 2023-03-06T23:59:59.999 == next bar open time: 2023-03-07T00:00:00.000 == close pos time: 2023-03-14T00:00:00.000
2024-11-20 23:07:22,214 - INFO - pnl: 2023-03-06T23:59:59.999 129174.79860749446 === 0.342%
2024-11-20 23:07:22,218 - DEBUG - cur time: 2023-03-07T23:59:59.999 == next bar open time: 2023-03-08T00:00:00.000 == close pos time: 2023-03-15T00:00:00.000
2024-11-20 23:07:22,219 - INFO - pnl: 2023-03-07T23:59:59.999 128359.20196540114 === -0.631%
2024-11-20 23:07:22,224 - DEBUG - cur time: 2023-03-08T23:59:59.999 == next bar open time: 2023-03-09T00:00:00.000 == close pos time: 2023-03-16T00:00:00.000
2024-11-20 23:07:22,237 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -1.970266    ┆ 0    ┆ 135          │
│ QNTUSDT      ┆ -1.96989     ┆ 1    ┆ 134          │
│ BALUSDT      ┆ -1.776311    ┆ 2    ┆ 133          │
│ LUNA2USDT    ┆ -1.72863     ┆ 3    ┆ 132          │
│ EOSUSDT      ┆ -1.615687    ┆ 4    ┆ 131          │
│ BTCDOMUSDT   ┆ -1.605232    ┆ 5    ┆ 130          │
│ IMXUSDT      ┆ -1.507491    ┆ 6    ┆ 129          │
│ APTUSDT      ┆ -1.48277     ┆ 7    ┆ 128          │
│ GTCUSDT      ┆ -1.476738    ┆ 8    ┆ 127          │
│ XMRUSDT      ┆ -1.437692    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CTKUSDT      ┆ -0.108291    ┆ 126  ┆ 9            │
│ TOMOUSDT     ┆ -0.02773     ┆ 127  ┆ 8            │
│ 1000XECUSDT  ┆ -0.027285    ┆ 128  ┆ 7            │
│ DGBUSDT      ┆ 0.116809     ┆ 129  ┆ 6            │
│ BLUEBIRDUSDT ┆ 0.15617      ┆ 130  ┆ 5            │
│ ARPAUSDT     ┆ 0.228261     ┆ 131  ┆ 4            │
│ DASHUSDT     ┆ 0.274093     ┆ 132  ┆ 3            │
│ CTSIUSDT     ┆ 0.303114     ┆ 133  ┆ 2            │
│ HNTUSDT      ┆ 0.508737     ┆ 134  ┆ 1            │
│ DEFIUSDT     ┆ 1.326422     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:22,250 - WARNING - 2023-03-08T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:22,250 - INFO - cur close time: 2023-03-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:22,251 - DEBUG - mean expected ret (mean factor): -0.7523329713266298
2024-11-20 23:07:22,258 - DEBUG - begin to update pos: =========
2024-11-20 23:07:22,258 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,258 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1306      ┆ null        ┆ … ┆ 0.02443 ┆ null   ┆ null    ┆ 0.2159  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,271 - DEBUG - update position: 2023-03-08T23:59:59.999 === diff_trading_value: 270145.6360437427 == cash: 128116.55743325908 
2024-11-20 23:07:22,272 - INFO - pnl: 2023-03-08T23:59:59.999 128116.55743325908 === -0.189%
2024-11-20 23:07:22,278 - DEBUG - cur time: 2023-03-09T23:59:59.999 == next bar open time: 2023-03-10T00:00:00.000 == close pos time: 2023-03-17T00:00:00.000
2024-11-20 23:07:22,280 - INFO - pnl: 2023-03-09T23:59:59.999 125332.25557959262 === -2.173%
2024-11-20 23:07:22,284 - DEBUG - cur time: 2023-03-10T23:59:59.999 == next bar open time: 2023-03-11T00:00:00.000 == close pos time: 2023-03-18T00:00:00.000
2024-11-20 23:07:22,286 - INFO - pnl: 2023-03-10T23:59:59.999 128029.74778478341 === 2.152%
2024-11-20 23:07:22,290 - DEBUG - cur time: 2023-03-11T23:59:59.999 == next bar open time: 2023-03-12T00:00:00.000 == close pos time: 2023-03-19T00:00:00.000
2024-11-20 23:07:22,293 - INFO - pnl: 2023-03-11T23:59:59.999 128280.05380724011 === 0.196%
2024-11-20 23:07:22,297 - DEBUG - cur time: 2023-03-12T23:59:59.999 == next bar open time: 2023-03-13T00:00:00.000 == close pos time: 2023-03-20T00:00:00.000
2024-11-20 23:07:22,298 - INFO - pnl: 2023-03-12T23:59:59.999 130035.51289286032 === 1.368%
2024-11-20 23:07:22,304 - DEBUG - cur time: 2023-03-13T23:59:59.999 == next bar open time: 2023-03-14T00:00:00.000 == close pos time: 2023-03-21T00:00:00.000
2024-11-20 23:07:22,307 - INFO - pnl: 2023-03-13T23:59:59.999 128076.23829972738 === -1.507%
2024-11-20 23:07:22,313 - DEBUG - cur time: 2023-03-14T23:59:59.999 == next bar open time: 2023-03-15T00:00:00.000 == close pos time: 2023-03-22T00:00:00.000
2024-11-20 23:07:22,317 - INFO - pnl: 2023-03-14T23:59:59.999 127957.80526009407 === -0.092%
2024-11-20 23:07:22,321 - DEBUG - cur time: 2023-03-15T23:59:59.999 == next bar open time: 2023-03-16T00:00:00.000 == close pos time: 2023-03-23T00:00:00.000
2024-11-20 23:07:22,332 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -2.258409    ┆ 0    ┆ 134          │
│ 1000SHIBUSDT ┆ -1.86164     ┆ 1    ┆ 133          │
│ XRPUSDT      ┆ -1.75583     ┆ 2    ┆ 132          │
│ IMXUSDT      ┆ -1.684102    ┆ 3    ┆ 131          │
│ FILUSDT      ┆ -1.646746    ┆ 4    ┆ 130          │
│ LDOUSDT      ┆ -1.523247    ┆ 5    ┆ 129          │
│ APTUSDT      ┆ -1.425605    ┆ 6    ┆ 128          │
│ 1000LUNCUSDT ┆ -1.42215     ┆ 7    ┆ 127          │
│ XLMUSDT      ┆ -1.418071    ┆ 8    ┆ 126          │
│ GALAUSDT     ┆ -1.414306    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ C98USDT      ┆ -0.053787    ┆ 125  ┆ 9            │
│ 1000XECUSDT  ┆ -0.050755    ┆ 126  ┆ 8            │
│ NKNUSDT      ┆ -0.027375    ┆ 127  ┆ 7            │
│ APEUSDT      ┆ -0.007702    ┆ 128  ┆ 6            │
│ COMPUSDT     ┆ 0.026683     ┆ 129  ┆ 5            │
│ MKRUSDT      ┆ 0.191982     ┆ 130  ┆ 4            │
│ CTSIUSDT     ┆ 0.248443     ┆ 131  ┆ 3            │
│ TRBUSDT      ┆ 0.272623     ┆ 132  ┆ 2            │
│ DASHUSDT     ┆ 0.646828     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 0.894643     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:22,343 - WARNING - 2023-03-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:22,344 - INFO - cur close time: 2023-03-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:22,344 - DEBUG - mean expected ret (mean factor): -0.7618910098476422
2024-11-20 23:07:22,350 - DEBUG - begin to update pos: =========
2024-11-20 23:07:22,350 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,350 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1237      ┆ null        ┆ … ┆ 0.02678 ┆ null   ┆ null    ┆ 0.2166  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,358 - DEBUG - update position: 2023-03-15T23:59:59.999 === diff_trading_value: 256934.93603974974 == cash: 125813.85931184172 
2024-11-20 23:07:22,361 - INFO - pnl: 2023-03-15T23:59:59.999 125813.85931184172 === -1.676%
2024-11-20 23:07:22,366 - DEBUG - cur time: 2023-03-16T23:59:59.999 == next bar open time: 2023-03-17T00:00:00.000 == close pos time: 2023-03-24T00:00:00.000
2024-11-20 23:07:22,368 - INFO - pnl: 2023-03-16T23:59:59.999 124585.0308639791 === -0.977%
2024-11-20 23:07:22,372 - DEBUG - cur time: 2023-03-17T23:59:59.999 == next bar open time: 2023-03-18T00:00:00.000 == close pos time: 2023-03-25T00:00:00.000
2024-11-20 23:07:22,374 - INFO - pnl: 2023-03-17T23:59:59.999 121875.61337734041 === -2.175%
2024-11-20 23:07:22,379 - DEBUG - cur time: 2023-03-18T23:59:59.999 == next bar open time: 2023-03-19T00:00:00.000 == close pos time: 2023-03-26T00:00:00.000
2024-11-20 23:07:22,380 - INFO - pnl: 2023-03-18T23:59:59.999 118388.68756694144 === -2.861%
2024-11-20 23:07:22,389 - DEBUG - cur time: 2023-03-19T23:59:59.999 == next bar open time: 2023-03-20T00:00:00.000 == close pos time: 2023-03-27T00:00:00.000
2024-11-20 23:07:22,392 - INFO - pnl: 2023-03-19T23:59:59.999 122099.03180666569 === 3.134%
2024-11-20 23:07:22,399 - DEBUG - cur time: 2023-03-20T23:59:59.999 == next bar open time: 2023-03-21T00:00:00.000 == close pos time: 2023-03-28T00:00:00.000
2024-11-20 23:07:22,401 - INFO - pnl: 2023-03-20T23:59:59.999 125727.25150625159 === 2.972%
2024-11-20 23:07:22,409 - DEBUG - cur time: 2023-03-21T23:59:59.999 == next bar open time: 2023-03-22T00:00:00.000 == close pos time: 2023-03-29T00:00:00.000
2024-11-20 23:07:22,410 - INFO - pnl: 2023-03-21T23:59:59.999 123180.96555220676 === -2.025%
2024-11-20 23:07:22,415 - DEBUG - cur time: 2023-03-22T23:59:59.999 == next bar open time: 2023-03-23T00:00:00.000 == close pos time: 2023-03-30T00:00:00.000
2024-11-20 23:07:22,425 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LDOUSDT      ┆ -1.93301     ┆ 0    ┆ 134          │
│ APTUSDT      ┆ -1.930542    ┆ 1    ┆ 133          │
│ 1000LUNCUSDT ┆ -1.753801    ┆ 2    ┆ 132          │
│ LUNA2USDT    ┆ -1.748836    ┆ 3    ┆ 131          │
│ GTCUSDT      ┆ -1.660273    ┆ 4    ┆ 130          │
│ RLCUSDT      ┆ -1.640748    ┆ 5    ┆ 129          │
│ ATOMUSDT     ┆ -1.580161    ┆ 6    ┆ 128          │
│ EGLDUSDT     ┆ -1.53224     ┆ 7    ┆ 127          │
│ FILUSDT      ┆ -1.499483    ┆ 8    ┆ 126          │
│ GMTUSDT      ┆ -1.480426    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ C98USDT      ┆ -0.16578     ┆ 125  ┆ 9            │
│ NKNUSDT      ┆ -0.139226    ┆ 126  ┆ 8            │
│ ALICEUSDT    ┆ -0.102429    ┆ 127  ┆ 7            │
│ IOTXUSDT     ┆ 0.00998      ┆ 128  ┆ 6            │
│ SPELLUSDT    ┆ 0.044696     ┆ 129  ┆ 5            │
│ 1000XECUSDT  ┆ 0.085384     ┆ 130  ┆ 4            │
│ OGNUSDT      ┆ 0.133321     ┆ 131  ┆ 3            │
│ DGBUSDT      ┆ 0.183086     ┆ 132  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.671563     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 1.028781     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:22,433 - WARNING - 2023-03-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:22,433 - INFO - cur close time: 2023-03-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:22,433 - DEBUG - mean expected ret (mean factor): -0.7523824240909454
2024-11-20 23:07:22,438 - DEBUG - begin to update pos: =========
2024-11-20 23:07:22,438 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,439 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1247      ┆ null        ┆ … ┆ 0.02717 ┆ null   ┆ null    ┆ 0.2268  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,446 - DEBUG - update position: 2023-03-22T23:59:59.999 === diff_trading_value: 263339.0385973576 == cash: 123006.06775765696 
2024-11-20 23:07:22,448 - INFO - pnl: 2023-03-22T23:59:59.999 123006.06775765696 === -0.142%
2024-11-20 23:07:22,451 - DEBUG - cur time: 2023-03-23T23:59:59.999 == next bar open time: 2023-03-24T00:00:00.000 == close pos time: 2023-03-31T00:00:00.000
2024-11-20 23:07:22,453 - INFO - pnl: 2023-03-23T23:59:59.999 126804.87826000726 === 3.088%
2024-11-20 23:07:22,457 - DEBUG - cur time: 2023-03-24T23:59:59.999 == next bar open time: 2023-03-25T00:00:00.000 == close pos time: 2023-04-01T00:00:00.000
2024-11-20 23:07:22,459 - INFO - pnl: 2023-03-24T23:59:59.999 127348.14623230834 === 0.428%
2024-11-20 23:07:22,461 - DEBUG - cur time: 2023-03-25T23:59:59.999 == next bar open time: 2023-03-26T00:00:00.000 == close pos time: 2023-04-02T00:00:00.000
2024-11-20 23:07:22,464 - INFO - pnl: 2023-03-25T23:59:59.999 127237.79549011725 === -0.087%
2024-11-20 23:07:22,468 - DEBUG - cur time: 2023-03-26T23:59:59.999 == next bar open time: 2023-03-27T00:00:00.000 == close pos time: 2023-04-03T00:00:00.000
2024-11-20 23:07:22,470 - INFO - pnl: 2023-03-26T23:59:59.999 127784.86125410299 === 0.430%
2024-11-20 23:07:22,475 - DEBUG - cur time: 2023-03-27T23:59:59.999 == next bar open time: 2023-03-28T00:00:00.000 == close pos time: 2023-04-04T00:00:00.000
2024-11-20 23:07:22,478 - INFO - pnl: 2023-03-27T23:59:59.999 128484.87051609922 === 0.548%
2024-11-20 23:07:22,481 - DEBUG - cur time: 2023-03-28T23:59:59.999 == next bar open time: 2023-03-29T00:00:00.000 == close pos time: 2023-04-05T00:00:00.000
2024-11-20 23:07:22,483 - INFO - pnl: 2023-03-28T23:59:59.999 129686.14596684641 === 0.935%
2024-11-20 23:07:22,487 - DEBUG - cur time: 2023-03-29T23:59:59.999 == next bar open time: 2023-03-30T00:00:00.000 == close pos time: 2023-04-06T00:00:00.000
2024-11-20 23:07:22,496 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -2.096523    ┆ 0    ┆ 134          │
│ MKRUSDT      ┆ -2.063079    ┆ 1    ┆ 133          │
│ FILUSDT      ┆ -1.947446    ┆ 2    ┆ 132          │
│ BTCDOMUSDT   ┆ -1.772755    ┆ 3    ┆ 131          │
│ UNIUSDT      ┆ -1.689821    ┆ 4    ┆ 130          │
│ BNBUSDT      ┆ -1.676364    ┆ 5    ┆ 129          │
│ NEOUSDT      ┆ -1.64811     ┆ 6    ┆ 128          │
│ AAVEUSDT     ┆ -1.616082    ┆ 7    ┆ 127          │
│ AXSUSDT      ┆ -1.594103    ┆ 8    ┆ 126          │
│ YFIUSDT      ┆ -1.569461    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RSRUSDT      ┆ 0.108713     ┆ 125  ┆ 9            │
│ BAKEUSDT     ┆ 0.170893     ┆ 126  ┆ 8            │
│ OGNUSDT      ┆ 0.193446     ┆ 127  ┆ 7            │
│ DENTUSDT     ┆ 0.211713     ┆ 128  ┆ 6            │
│ DEFIUSDT     ┆ 0.250759     ┆ 129  ┆ 5            │
│ 1000XECUSDT  ┆ 0.292387     ┆ 130  ┆ 4            │
│ REEFUSDT     ┆ 0.302627     ┆ 131  ┆ 3            │
│ DGBUSDT      ┆ 0.447025     ┆ 132  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.472364     ┆ 133  ┆ 1            │
│ SPELLUSDT    ┆ 0.834935     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:22,503 - INFO - cur close time: 2023-03-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:22,503 - DEBUG - mean expected ret (mean factor): -0.7392415721389114
2024-11-20 23:07:22,508 - DEBUG - begin to update pos: =========
2024-11-20 23:07:22,508 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,508 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1242      ┆ null        ┆ … ┆ 0.02827 ┆ null   ┆ null    ┆ 0.2375  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,518 - DEBUG - update position: 2023-03-29T23:59:59.999 === diff_trading_value: 256132.2645242772 == cash: 133719.27872056185 
2024-11-20 23:07:22,520 - INFO - pnl: 2023-03-29T23:59:59.999 133719.27872056185 === 3.110%
2024-11-20 23:07:22,526 - DEBUG - cur time: 2023-03-30T23:59:59.999 == next bar open time: 2023-03-31T00:00:00.000 == close pos time: 2023-04-07T00:00:00.000
2024-11-20 23:07:22,529 - INFO - pnl: 2023-03-30T23:59:59.999 135655.88088288959 === 1.448%
2024-11-20 23:07:22,534 - DEBUG - cur time: 2023-03-31T23:59:59.999 == next bar open time: 2023-04-01T00:00:00.000 == close pos time: 2023-04-08T00:00:00.000
2024-11-20 23:07:22,536 - INFO - pnl: 2023-03-31T23:59:59.999 137266.60898307557 === 1.187%
2024-11-20 23:07:22,541 - DEBUG - cur time: 2023-04-01T23:59:59.999 == next bar open time: 2023-04-02T00:00:00.000 == close pos time: 2023-04-09T00:00:00.000
2024-11-20 23:07:22,543 - INFO - pnl: 2023-04-01T23:59:59.999 139599.60687457796 === 1.700%
2024-11-20 23:07:22,548 - DEBUG - cur time: 2023-04-02T23:59:59.999 == next bar open time: 2023-04-03T00:00:00.000 == close pos time: 2023-04-10T00:00:00.000
2024-11-20 23:07:22,550 - INFO - pnl: 2023-04-02T23:59:59.999 137262.445092057 === -1.674%
2024-11-20 23:07:22,553 - DEBUG - cur time: 2023-04-03T23:59:59.999 == next bar open time: 2023-04-04T00:00:00.000 == close pos time: 2023-04-11T00:00:00.000
2024-11-20 23:07:22,555 - INFO - pnl: 2023-04-03T23:59:59.999 140961.89620441798 === 2.695%
2024-11-20 23:07:22,559 - DEBUG - cur time: 2023-04-04T23:59:59.999 == next bar open time: 2023-04-05T00:00:00.000 == close pos time: 2023-04-12T00:00:00.000
2024-11-20 23:07:22,562 - INFO - pnl: 2023-04-04T23:59:59.999 144691.27874326706 === 2.646%
2024-11-20 23:07:22,565 - DEBUG - cur time: 2023-04-05T23:59:59.999 == next bar open time: 2023-04-06T00:00:00.000 == close pos time: 2023-04-13T00:00:00.000
2024-11-20 23:07:22,575 - DEBUG - sorted_long_factors: shape: (135, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ GTCUSDT     ┆ -2.319389    ┆ 0    ┆ 134          │
│ BNBUSDT     ┆ -2.19182     ┆ 1    ┆ 133          │
│ APTUSDT     ┆ -2.160417    ┆ 2    ┆ 132          │
│ INJUSDT     ┆ -1.847652    ┆ 3    ┆ 131          │
│ OMGUSDT     ┆ -1.620519    ┆ 4    ┆ 130          │
│ MTLUSDT     ┆ -1.508224    ┆ 5    ┆ 129          │
│ XRPUSDT     ┆ -1.470966    ┆ 6    ┆ 128          │
│ MANAUSDT    ┆ -1.36522     ┆ 7    ┆ 127          │
│ NEOUSDT     ┆ -1.356505    ┆ 8    ┆ 126          │
│ ICXUSDT     ┆ -1.353949    ┆ 9    ┆ 125          │
│ …           ┆ …            ┆ …    ┆ …            │
│ API3USDT    ┆ 0.026043     ┆ 125  ┆ 9            │
│ DGBUSDT     ┆ 0.063406     ┆ 126  ┆ 8            │
│ KSMUSDT     ┆ 0.104612     ┆ 127  ┆ 7            │
│ FLMUSDT     ┆ 0.135774     ┆ 128  ┆ 6            │
│ SKLUSDT     ┆ 0.138832     ┆ 129  ┆ 5            │
│ 1000XECUSDT ┆ 0.166649     ┆ 130  ┆ 4            │
│ CTKUSDT     ┆ 0.17073      ┆ 131  ┆ 3            │
│ ARUSDT      ┆ 0.227439     ┆ 132  ┆ 2            │
│ TRBUSDT     ┆ 0.444272     ┆ 133  ┆ 1            │
│ DEFIUSDT    ┆ 1.366543     ┆ 134  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:22,581 - INFO - cur close time: 2023-04-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:22,581 - DEBUG - mean expected ret (mean factor): -0.7405183558658189
2024-11-20 23:07:22,586 - DEBUG - begin to update pos: =========
2024-11-20 23:07:22,587 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,587 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1232      ┆ null        ┆ … ┆ 0.03032 ┆ null   ┆ null    ┆ 0.3213  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,596 - DEBUG - update position: 2023-04-05T23:59:59.999 === diff_trading_value: 281435.03706289903 == cash: 143285.73719910815 
2024-11-20 23:07:22,598 - INFO - pnl: 2023-04-05T23:59:59.999 143285.73719910815 === -0.971%
2024-11-20 23:07:22,603 - DEBUG - cur time: 2023-04-06T23:59:59.999 == next bar open time: 2023-04-07T00:00:00.000 == close pos time: 2023-04-14T00:00:00.000
2024-11-20 23:07:22,605 - INFO - pnl: 2023-04-06T23:59:59.999 143837.44519450184 === 0.385%
2024-11-20 23:07:22,609 - DEBUG - cur time: 2023-04-07T23:59:59.999 == next bar open time: 2023-04-08T00:00:00.000 == close pos time: 2023-04-15T00:00:00.000
2024-11-20 23:07:22,611 - INFO - pnl: 2023-04-07T23:59:59.999 143489.73256144437 === -0.242%
2024-11-20 23:07:22,617 - DEBUG - cur time: 2023-04-08T23:59:59.999 == next bar open time: 2023-04-09T00:00:00.000 == close pos time: 2023-04-16T00:00:00.000
2024-11-20 23:07:22,619 - INFO - pnl: 2023-04-08T23:59:59.999 145047.06677990765 === 1.085%
2024-11-20 23:07:22,624 - DEBUG - cur time: 2023-04-09T23:59:59.999 == next bar open time: 2023-04-10T00:00:00.000 == close pos time: 2023-04-17T00:00:00.000
2024-11-20 23:07:22,627 - INFO - pnl: 2023-04-09T23:59:59.999 145447.8667325579 === 0.276%
2024-11-20 23:07:22,631 - DEBUG - cur time: 2023-04-10T23:59:59.999 == next bar open time: 2023-04-11T00:00:00.000 == close pos time: 2023-04-18T00:00:00.000
2024-11-20 23:07:22,632 - INFO - pnl: 2023-04-10T23:59:59.999 144860.81013246454 === -0.404%
2024-11-20 23:07:22,636 - DEBUG - cur time: 2023-04-11T23:59:59.999 == next bar open time: 2023-04-12T00:00:00.000 == close pos time: 2023-04-19T00:00:00.000
2024-11-20 23:07:22,638 - INFO - pnl: 2023-04-11T23:59:59.999 143853.2334920927 === -0.696%
2024-11-20 23:07:22,641 - DEBUG - cur time: 2023-04-12T23:59:59.999 == next bar open time: 2023-04-13T00:00:00.000 == close pos time: 2023-04-20T00:00:00.000
2024-11-20 23:07:22,651 - DEBUG - sorted_long_factors: shape: (135, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ APTUSDT   ┆ -1.830732    ┆ 0    ┆ 134          │
│ ATOMUSDT  ┆ -1.71153     ┆ 1    ┆ 133          │
│ APEUSDT   ┆ -1.695138    ┆ 2    ┆ 132          │
│ ICPUSDT   ┆ -1.675744    ┆ 3    ┆ 131          │
│ ADAUSDT   ┆ -1.481214    ┆ 4    ┆ 130          │
│ YFIUSDT   ┆ -1.471975    ┆ 5    ┆ 129          │
│ FTMUSDT   ┆ -1.448893    ┆ 6    ┆ 128          │
│ INJUSDT   ┆ -1.444236    ┆ 7    ┆ 127          │
│ MASKUSDT  ┆ -1.401018    ┆ 8    ┆ 126          │
│ QTUMUSDT  ┆ -1.390061    ┆ 9    ┆ 125          │
│ …         ┆ …            ┆ …    ┆ …            │
│ SPELLUSDT ┆ -0.14685     ┆ 125  ┆ 9            │
│ OGNUSDT   ┆ -0.121756    ┆ 126  ┆ 8            │
│ CTKUSDT   ┆ -0.074584    ┆ 127  ┆ 7            │
│ SNXUSDT   ┆ -0.044412    ┆ 128  ┆ 6            │
│ CVXUSDT   ┆ -0.014413    ┆ 129  ┆ 5            │
│ BLZUSDT   ┆ 0.020002     ┆ 130  ┆ 4            │
│ SKLUSDT   ┆ 0.102951     ┆ 131  ┆ 3            │
│ BALUSDT   ┆ 0.360313     ┆ 132  ┆ 2            │
│ LPTUSDT   ┆ 0.597976     ┆ 133  ┆ 1            │
│ DEFIUSDT  ┆ 1.490069     ┆ 134  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:22,664 - INFO - cur close time: 2023-04-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:22,665 - DEBUG - mean expected ret (mean factor): -0.7977570493598808
2024-11-20 23:07:22,670 - DEBUG - begin to update pos: =========
2024-11-20 23:07:22,670 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,671 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1267      ┆ null        ┆ … ┆ 0.02934 ┆ null   ┆ null    ┆ 0.2786  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,679 - DEBUG - update position: 2023-04-12T23:59:59.999 === diff_trading_value: 271449.49377876526 == cash: 145130.34396906453 
2024-11-20 23:07:22,680 - INFO - pnl: 2023-04-12T23:59:59.999 145130.34396906453 === 0.888%
2024-11-20 23:07:22,683 - DEBUG - cur time: 2023-04-13T23:59:59.999 == next bar open time: 2023-04-14T00:00:00.000 == close pos time: 2023-04-21T00:00:00.000
2024-11-20 23:07:22,684 - INFO - pnl: 2023-04-13T23:59:59.999 145814.98259053985 === 0.472%
2024-11-20 23:07:22,688 - DEBUG - cur time: 2023-04-14T23:59:59.999 == next bar open time: 2023-04-15T00:00:00.000 == close pos time: 2023-04-22T00:00:00.000
2024-11-20 23:07:22,689 - INFO - pnl: 2023-04-14T23:59:59.999 143938.78400314218 === -1.287%
2024-11-20 23:07:22,693 - DEBUG - cur time: 2023-04-15T23:59:59.999 == next bar open time: 2023-04-16T00:00:00.000 == close pos time: 2023-04-23T00:00:00.000
2024-11-20 23:07:22,695 - INFO - pnl: 2023-04-15T23:59:59.999 143448.21614271146 === -0.341%
2024-11-20 23:07:22,698 - DEBUG - cur time: 2023-04-16T23:59:59.999 == next bar open time: 2023-04-17T00:00:00.000 == close pos time: 2023-04-24T00:00:00.000
2024-11-20 23:07:22,701 - INFO - pnl: 2023-04-16T23:59:59.999 144119.94168805232 === 0.468%
2024-11-20 23:07:22,705 - DEBUG - cur time: 2023-04-17T23:59:59.999 == next bar open time: 2023-04-18T00:00:00.000 == close pos time: 2023-04-25T00:00:00.000
2024-11-20 23:07:22,708 - INFO - pnl: 2023-04-17T23:59:59.999 143487.38604647398 === -0.439%
2024-11-20 23:07:22,714 - DEBUG - cur time: 2023-04-18T23:59:59.999 == next bar open time: 2023-04-19T00:00:00.000 == close pos time: 2023-04-26T00:00:00.000
2024-11-20 23:07:22,717 - INFO - pnl: 2023-04-18T23:59:59.999 144367.67515907137 === 0.613%
2024-11-20 23:07:22,723 - DEBUG - cur time: 2023-04-19T23:59:59.999 == next bar open time: 2023-04-20T00:00:00.000 == close pos time: 2023-04-27T00:00:00.000
2024-11-20 23:07:22,734 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AXSUSDT      ┆ -1.604378    ┆ 0    ┆ 134          │
│ APTUSDT      ┆ -1.521814    ┆ 1    ┆ 133          │
│ NEOUSDT      ┆ -1.502932    ┆ 2    ┆ 132          │
│ BNBUSDT      ┆ -1.499669    ┆ 3    ┆ 131          │
│ DYDXUSDT     ┆ -1.400194    ┆ 4    ┆ 130          │
│ ICPUSDT      ┆ -1.33639     ┆ 5    ┆ 129          │
│ DOGEUSDT     ┆ -1.32586     ┆ 6    ┆ 128          │
│ SANDUSDT     ┆ -1.297295    ┆ 7    ┆ 127          │
│ EGLDUSDT     ┆ -1.242403    ┆ 8    ┆ 126          │
│ APEUSDT      ┆ -1.236278    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DGBUSDT      ┆ -0.174084    ┆ 125  ┆ 9            │
│ BLZUSDT      ┆ -0.17238     ┆ 126  ┆ 8            │
│ GTCUSDT      ┆ -0.16295     ┆ 127  ┆ 7            │
│ ARUSDT       ┆ -0.125995    ┆ 128  ┆ 6            │
│ 1000XECUSDT  ┆ -0.119612    ┆ 129  ┆ 5            │
│ BLUEBIRDUSDT ┆ -0.021664    ┆ 130  ┆ 4            │
│ XMRUSDT      ┆ 0.053235     ┆ 131  ┆ 3            │
│ LPTUSDT      ┆ 0.364323     ┆ 132  ┆ 2            │
│ CVXUSDT      ┆ 0.49879      ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 1.776197     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:22,743 - INFO - cur close time: 2023-04-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:22,743 - DEBUG - mean expected ret (mean factor): -0.7688073587424108
2024-11-20 23:07:22,749 - DEBUG - begin to update pos: =========
2024-11-20 23:07:22,750 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,750 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1163      ┆ null        ┆ … ┆ 0.03186 ┆ null   ┆ null    ┆ 0.2769  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,761 - DEBUG - update position: 2023-04-19T23:59:59.999 === diff_trading_value: 255214.19007926376 == cash: 143440.16755066134 
2024-11-20 23:07:22,763 - INFO - pnl: 2023-04-19T23:59:59.999 143440.16755066134 === -0.642%
2024-11-20 23:07:22,769 - DEBUG - cur time: 2023-04-20T23:59:59.999 == next bar open time: 2023-04-21T00:00:00.000 == close pos time: 2023-04-28T00:00:00.000
2024-11-20 23:07:22,770 - INFO - pnl: 2023-04-20T23:59:59.999 142765.45445519136 === -0.470%
2024-11-20 23:07:22,774 - DEBUG - cur time: 2023-04-21T23:59:59.999 == next bar open time: 2023-04-22T00:00:00.000 == close pos time: 2023-04-29T00:00:00.000
2024-11-20 23:07:22,776 - INFO - pnl: 2023-04-21T23:59:59.999 143577.5208803392 === 0.569%
2024-11-20 23:07:22,779 - DEBUG - cur time: 2023-04-22T23:59:59.999 == next bar open time: 2023-04-23T00:00:00.000 == close pos time: 2023-04-30T00:00:00.000
2024-11-20 23:07:22,781 - INFO - pnl: 2023-04-22T23:59:59.999 144223.3378162911 === 0.450%
2024-11-20 23:07:22,785 - DEBUG - cur time: 2023-04-23T23:59:59.999 == next bar open time: 2023-04-24T00:00:00.000 == close pos time: 2023-05-01T00:00:00.000
2024-11-20 23:07:22,787 - INFO - pnl: 2023-04-23T23:59:59.999 144588.68687755792 === 0.253%
2024-11-20 23:07:22,791 - DEBUG - cur time: 2023-04-24T23:59:59.999 == next bar open time: 2023-04-25T00:00:00.000 == close pos time: 2023-05-02T00:00:00.000
2024-11-20 23:07:22,793 - INFO - pnl: 2023-04-24T23:59:59.999 143991.30907212154 === -0.413%
2024-11-20 23:07:22,799 - DEBUG - cur time: 2023-04-25T23:59:59.999 == next bar open time: 2023-04-26T00:00:00.000 == close pos time: 2023-05-03T00:00:00.000
2024-11-20 23:07:22,801 - INFO - pnl: 2023-04-25T23:59:59.999 144714.83988040645 === 0.502%
2024-11-20 23:07:22,806 - DEBUG - cur time: 2023-04-26T23:59:59.999 == next bar open time: 2023-04-27T00:00:00.000 == close pos time: 2023-05-04T00:00:00.000
2024-11-20 23:07:22,817 - DEBUG - sorted_long_factors: shape: (135, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ UNFIUSDT  ┆ -1.902037    ┆ 0    ┆ 134          │
│ AXSUSDT   ┆ -1.85906     ┆ 1    ┆ 133          │
│ UNIUSDT   ┆ -1.599218    ┆ 2    ┆ 132          │
│ AAVEUSDT  ┆ -1.590186    ┆ 3    ┆ 131          │
│ EGLDUSDT  ┆ -1.498398    ┆ 4    ┆ 130          │
│ SANDUSDT  ┆ -1.458629    ┆ 5    ┆ 129          │
│ ICPUSDT   ┆ -1.405613    ┆ 6    ┆ 128          │
│ APTUSDT   ┆ -1.397955    ┆ 7    ┆ 127          │
│ ATOMUSDT  ┆ -1.382314    ┆ 8    ┆ 126          │
│ APEUSDT   ┆ -1.367617    ┆ 9    ┆ 125          │
│ …         ┆ …            ┆ …    ┆ …            │
│ BAKEUSDT  ┆ -0.196625    ┆ 125  ┆ 9            │
│ DARUSDT   ┆ -0.181384    ┆ 126  ┆ 8            │
│ IOTXUSDT  ┆ -0.175814    ┆ 127  ┆ 7            │
│ OGNUSDT   ┆ -0.173781    ┆ 128  ┆ 6            │
│ OMGUSDT   ┆ -0.146868    ┆ 129  ┆ 5            │
│ SPELLUSDT ┆ -0.10781     ┆ 130  ┆ 4            │
│ CVXUSDT   ┆ -0.106484    ┆ 131  ┆ 3            │
│ DGBUSDT   ┆ -0.101901    ┆ 132  ┆ 2            │
│ BLZUSDT   ┆ -0.012448    ┆ 133  ┆ 1            │
│ DEFIUSDT  ┆ 1.133849     ┆ 134  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:22,825 - WARNING - 2023-04-26T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:22,825 - INFO - cur close time: 2023-04-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:22,826 - DEBUG - mean expected ret (mean factor): -0.7769023046448421
2024-11-20 23:07:22,831 - DEBUG - begin to update pos: =========
2024-11-20 23:07:22,831 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,831 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1077      ┆ null        ┆ … ┆ 0.02901 ┆ null   ┆ null    ┆ 0.2577  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,839 - DEBUG - update position: 2023-04-26T23:59:59.999 === diff_trading_value: 183969.9184916563 == cash: 144593.62891550612 
2024-11-20 23:07:22,842 - INFO - pnl: 2023-04-26T23:59:59.999 144593.62891550612 === -0.084%
2024-11-20 23:07:22,846 - DEBUG - cur time: 2023-04-27T23:59:59.999 == next bar open time: 2023-04-28T00:00:00.000 == close pos time: 2023-05-05T00:00:00.000
2024-11-20 23:07:22,848 - INFO - pnl: 2023-04-27T23:59:59.999 143374.14836772773 === -0.843%
2024-11-20 23:07:22,851 - DEBUG - cur time: 2023-04-28T23:59:59.999 == next bar open time: 2023-04-29T00:00:00.000 == close pos time: 2023-05-06T00:00:00.000
2024-11-20 23:07:22,853 - INFO - pnl: 2023-04-28T23:59:59.999 141573.77944271505 === -1.256%
2024-11-20 23:07:22,858 - DEBUG - cur time: 2023-04-29T23:59:59.999 == next bar open time: 2023-04-30T00:00:00.000 == close pos time: 2023-05-07T00:00:00.000
2024-11-20 23:07:22,860 - INFO - pnl: 2023-04-29T23:59:59.999 140894.12158376505 === -0.480%
2024-11-20 23:07:22,863 - DEBUG - cur time: 2023-04-30T23:59:59.999 == next bar open time: 2023-05-01T00:00:00.000 == close pos time: 2023-05-08T00:00:00.000
2024-11-20 23:07:22,866 - INFO - pnl: 2023-04-30T23:59:59.999 140753.0742190519 === -0.100%
2024-11-20 23:07:22,870 - DEBUG - cur time: 2023-05-01T23:59:59.999 == next bar open time: 2023-05-02T00:00:00.000 == close pos time: 2023-05-09T00:00:00.000
2024-11-20 23:07:22,873 - INFO - pnl: 2023-05-01T23:59:59.999 141346.45885137285 === 0.422%
2024-11-20 23:07:22,877 - DEBUG - cur time: 2023-05-02T23:59:59.999 == next bar open time: 2023-05-03T00:00:00.000 == close pos time: 2023-05-10T00:00:00.000
2024-11-20 23:07:22,878 - INFO - pnl: 2023-05-02T23:59:59.999 142815.03839191454 === 1.039%
2024-11-20 23:07:22,882 - DEBUG - cur time: 2023-05-03T23:59:59.999 == next bar open time: 2023-05-04T00:00:00.000 == close pos time: 2023-05-11T00:00:00.000
2024-11-20 23:07:22,890 - DEBUG - sorted_long_factors: shape: (137, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ICPUSDT     ┆ -1.870666    ┆ 0    ┆ 136          │
│ APTUSDT     ┆ -1.806888    ┆ 1    ┆ 135          │
│ UNFIUSDT    ┆ -1.674365    ┆ 2    ┆ 134          │
│ DOTUSDT     ┆ -1.560019    ┆ 3    ┆ 133          │
│ YFIUSDT     ┆ -1.509499    ┆ 4    ┆ 132          │
│ NEARUSDT    ┆ -1.493706    ┆ 5    ┆ 131          │
│ SNXUSDT     ┆ -1.482375    ┆ 6    ┆ 130          │
│ FILUSDT     ┆ -1.455998    ┆ 7    ┆ 129          │
│ OPUSDT      ┆ -1.441077    ┆ 8    ┆ 128          │
│ FXSUSDT     ┆ -1.432364    ┆ 9    ┆ 127          │
│ …           ┆ …            ┆ …    ┆ …            │
│ 1000XECUSDT ┆ -0.088603    ┆ 127  ┆ 9            │
│ KSMUSDT     ┆ -0.00002     ┆ 128  ┆ 8            │
│ CVXUSDT     ┆ 0.01995      ┆ 129  ┆ 7            │
│ BLZUSDT     ┆ 0.040922     ┆ 130  ┆ 6            │
│ BAKEUSDT    ┆ 0.046208     ┆ 131  ┆ 5            │
│ IOTXUSDT    ┆ 0.127435     ┆ 132  ┆ 4            │
│ BTCDOMUSDT  ┆ 0.143102     ┆ 133  ┆ 3            │
│ SPELLUSDT   ┆ 0.338927     ┆ 134  ┆ 2            │
│ DGBUSDT     ┆ 0.394786     ┆ 135  ┆ 1            │
│ DEFIUSDT    ┆ 0.849584     ┆ 136  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:22,897 - INFO - cur close time: 2023-05-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:22,898 - DEBUG - mean expected ret (mean factor): -0.7727524973925137
2024-11-20 23:07:22,904 - DEBUG - begin to update pos: =========
2024-11-20 23:07:22,904 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 5000.0  ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,905 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.106       ┆ null        ┆ … ┆ 0.02749 ┆ null   ┆ null    ┆ 0.2513  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,916 - DEBUG - update position: 2023-05-03T23:59:59.999 === diff_trading_value: 223769.81347145664 == cash: 142592.3310173352 
2024-11-20 23:07:22,917 - INFO - pnl: 2023-05-03T23:59:59.999 142592.3310173352 === -0.156%
2024-11-20 23:07:22,922 - DEBUG - cur time: 2023-05-04T23:59:59.999 == next bar open time: 2023-05-05T00:00:00.000 == close pos time: 2023-05-12T00:00:00.000
2024-11-20 23:07:22,925 - INFO - pnl: 2023-05-04T23:59:59.999 143129.26950566375 === 0.377%
2024-11-20 23:07:22,929 - DEBUG - cur time: 2023-05-05T23:59:59.999 == next bar open time: 2023-05-06T00:00:00.000 == close pos time: 2023-05-13T00:00:00.000
2024-11-20 23:07:22,931 - INFO - pnl: 2023-05-05T23:59:59.999 143123.86127676044 === -0.004%
2024-11-20 23:07:22,937 - DEBUG - cur time: 2023-05-06T23:59:59.999 == next bar open time: 2023-05-07T00:00:00.000 == close pos time: 2023-05-14T00:00:00.000
2024-11-20 23:07:22,939 - INFO - pnl: 2023-05-06T23:59:59.999 144765.37238303636 === 1.147%
2024-11-20 23:07:22,945 - DEBUG - cur time: 2023-05-07T23:59:59.999 == next bar open time: 2023-05-08T00:00:00.000 == close pos time: 2023-05-15T00:00:00.000
2024-11-20 23:07:22,946 - INFO - pnl: 2023-05-07T23:59:59.999 144351.38733755014 === -0.286%
2024-11-20 23:07:22,950 - DEBUG - cur time: 2023-05-08T23:59:59.999 == next bar open time: 2023-05-09T00:00:00.000 == close pos time: 2023-05-16T00:00:00.000
2024-11-20 23:07:22,954 - INFO - pnl: 2023-05-08T23:59:59.999 145307.75810176253 === 0.663%
2024-11-20 23:07:22,958 - DEBUG - cur time: 2023-05-09T23:59:59.999 == next bar open time: 2023-05-10T00:00:00.000 == close pos time: 2023-05-17T00:00:00.000
2024-11-20 23:07:22,960 - INFO - pnl: 2023-05-09T23:59:59.999 146398.82124225018 === 0.751%
2024-11-20 23:07:22,964 - DEBUG - cur time: 2023-05-10T23:59:59.999 == next bar open time: 2023-05-11T00:00:00.000 == close pos time: 2023-05-18T00:00:00.000
2024-11-20 23:07:22,973 - DEBUG - sorted_long_factors: shape: (139, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ MTLUSDT     ┆ -1.917656    ┆ 0    ┆ 138          │
│ EGLDUSDT    ┆ -1.882005    ┆ 1    ┆ 137          │
│ ICPUSDT     ┆ -1.843499    ┆ 2    ┆ 136          │
│ BNBUSDT     ┆ -1.64727     ┆ 3    ┆ 135          │
│ TOMOUSDT    ┆ -1.560182    ┆ 4    ┆ 134          │
│ KAVAUSDT    ┆ -1.377723    ┆ 5    ┆ 133          │
│ STMXUSDT    ┆ -1.370313    ┆ 6    ┆ 132          │
│ APTUSDT     ┆ -1.343488    ┆ 7    ┆ 131          │
│ INJUSDT     ┆ -1.341423    ┆ 8    ┆ 130          │
│ BELUSDT     ┆ -1.339938    ┆ 9    ┆ 129          │
│ …           ┆ …            ┆ …    ┆ …            │
│ KNCUSDT     ┆ -0.17258     ┆ 129  ┆ 9            │
│ SKLUSDT     ┆ -0.148754    ┆ 130  ┆ 8            │
│ ZENUSDT     ┆ -0.122943    ┆ 131  ┆ 7            │
│ 1000XECUSDT ┆ -0.032791    ┆ 132  ┆ 6            │
│ TRBUSDT     ┆ -0.029471    ┆ 133  ┆ 5            │
│ LPTUSDT     ┆ 0.025689     ┆ 134  ┆ 4            │
│ BLZUSDT     ┆ 0.184526     ┆ 135  ┆ 3            │
│ BAKEUSDT    ┆ 0.187144     ┆ 136  ┆ 2            │
│ CVXUSDT     ┆ 0.527485     ┆ 137  ┆ 1            │
│ DEFIUSDT    ┆ 0.813954     ┆ 138  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:22,982 - WARNING - 2023-05-10T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:22,983 - INFO - cur close time: 2023-05-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:22,983 - DEBUG - mean expected ret (mean factor): -0.7702576585643042
2024-11-20 23:07:22,987 - DEBUG - begin to update pos: =========
2024-11-20 23:07:22,988 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,988 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.093       ┆ null        ┆ … ┆ 0.02447 ┆ null   ┆ null    ┆ 0.2264  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:22,997 - DEBUG - update position: 2023-05-10T23:59:59.999 === diff_trading_value: 271667.9895568779 == cash: 147778.562497783 
2024-11-20 23:07:22,998 - INFO - pnl: 2023-05-10T23:59:59.999 147778.562497783 === 0.942%
2024-11-20 23:07:23,003 - DEBUG - cur time: 2023-05-11T23:59:59.999 == next bar open time: 2023-05-12T00:00:00.000 == close pos time: 2023-05-19T00:00:00.000
2024-11-20 23:07:23,005 - INFO - pnl: 2023-05-11T23:59:59.999 148070.53068411237 === 0.198%
2024-11-20 23:07:23,011 - DEBUG - cur time: 2023-05-12T23:59:59.999 == next bar open time: 2023-05-13T00:00:00.000 == close pos time: 2023-05-20T00:00:00.000
2024-11-20 23:07:23,015 - INFO - pnl: 2023-05-12T23:59:59.999 148542.31044854506 === 0.319%
2024-11-20 23:07:23,022 - DEBUG - cur time: 2023-05-13T23:59:59.999 == next bar open time: 2023-05-14T00:00:00.000 == close pos time: 2023-05-21T00:00:00.000
2024-11-20 23:07:23,024 - INFO - pnl: 2023-05-13T23:59:59.999 147357.00316885495 === -0.798%
2024-11-20 23:07:23,028 - DEBUG - cur time: 2023-05-14T23:59:59.999 == next bar open time: 2023-05-15T00:00:00.000 == close pos time: 2023-05-22T00:00:00.000
2024-11-20 23:07:23,030 - INFO - pnl: 2023-05-14T23:59:59.999 147207.36658587438 === -0.102%
2024-11-20 23:07:23,033 - DEBUG - cur time: 2023-05-15T23:59:59.999 == next bar open time: 2023-05-16T00:00:00.000 == close pos time: 2023-05-23T00:00:00.000
2024-11-20 23:07:23,034 - INFO - pnl: 2023-05-15T23:59:59.999 147794.64702290305 === 0.399%
2024-11-20 23:07:23,038 - DEBUG - cur time: 2023-05-16T23:59:59.999 == next bar open time: 2023-05-17T00:00:00.000 == close pos time: 2023-05-24T00:00:00.000
2024-11-20 23:07:23,040 - INFO - pnl: 2023-05-16T23:59:59.999 150001.0607886007 === 1.493%
2024-11-20 23:07:23,046 - DEBUG - cur time: 2023-05-17T23:59:59.999 == next bar open time: 2023-05-18T00:00:00.000 == close pos time: 2023-05-25T00:00:00.000
2024-11-20 23:07:23,056 - DEBUG - sorted_long_factors: shape: (141, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ZECUSDT     ┆ -1.800219    ┆ 0    ┆ 140          │
│ MTLUSDT     ┆ -1.750087    ┆ 1    ┆ 139          │
│ FILUSDT     ┆ -1.722001    ┆ 2    ┆ 138          │
│ MAGICUSDT   ┆ -1.597129    ┆ 3    ┆ 137          │
│ APTUSDT     ┆ -1.576789    ┆ 4    ┆ 136          │
│ AAVEUSDT    ┆ -1.562119    ┆ 5    ┆ 135          │
│ NEOUSDT     ┆ -1.514718    ┆ 6    ┆ 134          │
│ FETUSDT     ┆ -1.489658    ┆ 7    ┆ 133          │
│ DASHUSDT    ┆ -1.483483    ┆ 8    ┆ 132          │
│ MASKUSDT    ┆ -1.474985    ┆ 9    ┆ 131          │
│ …           ┆ …            ┆ …    ┆ …            │
│ DUSKUSDT    ┆ 0.152364     ┆ 131  ┆ 9            │
│ SPELLUSDT   ┆ 0.176539     ┆ 132  ┆ 8            │
│ 1000XECUSDT ┆ 0.188312     ┆ 133  ┆ 7            │
│ DEFIUSDT    ┆ 0.190829     ┆ 134  ┆ 6            │
│ BLZUSDT     ┆ 0.233167     ┆ 135  ┆ 5            │
│ DGBUSDT     ┆ 0.256299     ┆ 136  ┆ 4            │
│ CVXUSDT     ┆ 0.292103     ┆ 137  ┆ 3            │
│ BAKEUSDT    ┆ 0.306955     ┆ 138  ┆ 2            │
│ LPTUSDT     ┆ 0.441025     ┆ 139  ┆ 1            │
│ KLAYUSDT    ┆ 0.502759     ┆ 140  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:23,064 - WARNING - 2023-05-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:23,065 - INFO - cur close time: 2023-05-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:23,065 - DEBUG - mean expected ret (mean factor): -0.7816378059478554
2024-11-20 23:07:23,070 - DEBUG - begin to update pos: =========
2024-11-20 23:07:23,070 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,070 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0929      ┆ null        ┆ … ┆ 0.02494 ┆ null   ┆ null    ┆ 0.232   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,077 - DEBUG - update position: 2023-05-17T23:59:59.999 === diff_trading_value: 253170.32954955482 == cash: 149182.47106068765 
2024-11-20 23:07:23,079 - INFO - pnl: 2023-05-17T23:59:59.999 149182.47106068765 === -0.546%
2024-11-20 23:07:23,081 - DEBUG - cur time: 2023-05-18T23:59:59.999 == next bar open time: 2023-05-19T00:00:00.000 == close pos time: 2023-05-26T00:00:00.000
2024-11-20 23:07:23,084 - INFO - pnl: 2023-05-18T23:59:59.999 147330.24126847362 === -1.242%
2024-11-20 23:07:23,087 - DEBUG - cur time: 2023-05-19T23:59:59.999 == next bar open time: 2023-05-20T00:00:00.000 == close pos time: 2023-05-27T00:00:00.000
2024-11-20 23:07:23,089 - INFO - pnl: 2023-05-19T23:59:59.999 147755.3644973456 === 0.289%
2024-11-20 23:07:23,091 - DEBUG - cur time: 2023-05-20T23:59:59.999 == next bar open time: 2023-05-21T00:00:00.000 == close pos time: 2023-05-28T00:00:00.000
2024-11-20 23:07:23,093 - INFO - pnl: 2023-05-20T23:59:59.999 147980.7432208315 === 0.153%
2024-11-20 23:07:23,096 - DEBUG - cur time: 2023-05-21T23:59:59.999 == next bar open time: 2023-05-22T00:00:00.000 == close pos time: 2023-05-29T00:00:00.000
2024-11-20 23:07:23,098 - INFO - pnl: 2023-05-21T23:59:59.999 148517.38247868724 === 0.363%
2024-11-20 23:07:23,103 - DEBUG - cur time: 2023-05-22T23:59:59.999 == next bar open time: 2023-05-23T00:00:00.000 == close pos time: 2023-05-30T00:00:00.000
2024-11-20 23:07:23,105 - INFO - pnl: 2023-05-22T23:59:59.999 148585.72545706265 === 0.046%
2024-11-20 23:07:23,110 - DEBUG - cur time: 2023-05-23T23:59:59.999 == next bar open time: 2023-05-24T00:00:00.000 == close pos time: 2023-05-31T00:00:00.000
2024-11-20 23:07:23,113 - INFO - pnl: 2023-05-23T23:59:59.999 148176.83082757468 === -0.275%
2024-11-20 23:07:23,116 - DEBUG - cur time: 2023-05-24T23:59:59.999 == next bar open time: 2023-05-25T00:00:00.000 == close pos time: 2023-06-01T00:00:00.000
2024-11-20 23:07:23,126 - DEBUG - sorted_long_factors: shape: (143, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HIGHUSDT     ┆ -1.52961     ┆ 0    ┆ 142          │
│ HOOKUSDT     ┆ -1.515498    ┆ 1    ┆ 141          │
│ ATOMUSDT     ┆ -1.502681    ┆ 2    ┆ 140          │
│ CRVUSDT      ┆ -1.470587    ┆ 3    ┆ 139          │
│ LDOUSDT      ┆ -1.463989    ┆ 4    ┆ 138          │
│ FETUSDT      ┆ -1.432602    ┆ 5    ┆ 137          │
│ AXSUSDT      ┆ -1.421446    ┆ 6    ┆ 136          │
│ APTUSDT      ┆ -1.3921      ┆ 7    ┆ 135          │
│ BNBUSDT      ┆ -1.386998    ┆ 8    ┆ 134          │
│ KAVAUSDT     ┆ -1.379576    ┆ 9    ┆ 133          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BLUEBIRDUSDT ┆ -0.063158    ┆ 133  ┆ 9            │
│ IOTXUSDT     ┆ -0.049418    ┆ 134  ┆ 8            │
│ LPTUSDT      ┆ -0.027659    ┆ 135  ┆ 7            │
│ GALUSDT      ┆ -0.017619    ┆ 136  ┆ 6            │
│ BLZUSDT      ┆ 0.028615     ┆ 137  ┆ 5            │
│ CVXUSDT      ┆ 0.039234     ┆ 138  ┆ 4            │
│ API3USDT     ┆ 0.078474     ┆ 139  ┆ 3            │
│ ATAUSDT      ┆ 0.097139     ┆ 140  ┆ 2            │
│ SPELLUSDT    ┆ 0.122486     ┆ 141  ┆ 1            │
│ DEFIUSDT     ┆ 0.150208     ┆ 142  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:23,133 - WARNING - 2023-05-24T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:23,133 - INFO - cur close time: 2023-05-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:23,134 - DEBUG - mean expected ret (mean factor): -0.780878474648637
2024-11-20 23:07:23,138 - DEBUG - begin to update pos: =========
2024-11-20 23:07:23,138 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,139 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0857      ┆ null        ┆ … ┆ 0.0228  ┆ null   ┆ null    ┆ 0.2207  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,145 - DEBUG - update position: 2023-05-24T23:59:59.999 === diff_trading_value: 259669.6655007052 == cash: 149274.62393679618 
2024-11-20 23:07:23,147 - INFO - pnl: 2023-05-24T23:59:59.999 149274.62393679618 === 0.741%
2024-11-20 23:07:23,149 - DEBUG - cur time: 2023-05-25T23:59:59.999 == next bar open time: 2023-05-26T00:00:00.000 == close pos time: 2023-06-02T00:00:00.000
2024-11-20 23:07:23,151 - INFO - pnl: 2023-05-25T23:59:59.999 148854.66568976565 === -0.281%
2024-11-20 23:07:23,155 - DEBUG - cur time: 2023-05-26T23:59:59.999 == next bar open time: 2023-05-27T00:00:00.000 == close pos time: 2023-06-03T00:00:00.000
2024-11-20 23:07:23,157 - INFO - pnl: 2023-05-26T23:59:59.999 146987.469677564 === -1.254%
2024-11-20 23:07:23,160 - DEBUG - cur time: 2023-05-27T23:59:59.999 == next bar open time: 2023-05-28T00:00:00.000 == close pos time: 2023-06-04T00:00:00.000
2024-11-20 23:07:23,163 - INFO - pnl: 2023-05-27T23:59:59.999 146543.03400181042 === -0.302%
2024-11-20 23:07:23,166 - DEBUG - cur time: 2023-05-28T23:59:59.999 == next bar open time: 2023-05-29T00:00:00.000 == close pos time: 2023-06-05T00:00:00.000
2024-11-20 23:07:23,169 - INFO - pnl: 2023-05-28T23:59:59.999 146493.39693812406 === -0.034%
2024-11-20 23:07:23,173 - DEBUG - cur time: 2023-05-29T23:59:59.999 == next bar open time: 2023-05-30T00:00:00.000 == close pos time: 2023-06-06T00:00:00.000
2024-11-20 23:07:23,175 - INFO - pnl: 2023-05-29T23:59:59.999 145954.50077631284 === -0.368%
2024-11-20 23:07:23,180 - DEBUG - cur time: 2023-05-30T23:59:59.999 == next bar open time: 2023-05-31T00:00:00.000 == close pos time: 2023-06-07T00:00:00.000
2024-11-20 23:07:23,181 - INFO - pnl: 2023-05-30T23:59:59.999 146568.9907010681 === 0.421%
2024-11-20 23:07:23,186 - DEBUG - cur time: 2023-05-31T23:59:59.999 == next bar open time: 2023-06-01T00:00:00.000 == close pos time: 2023-06-08T00:00:00.000
2024-11-20 23:07:23,195 - DEBUG - sorted_long_factors: shape: (147, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LITUSDT      ┆ -1.582439    ┆ 0    ┆ 146          │
│ APTUSDT      ┆ -1.549119    ┆ 1    ┆ 145          │
│ XMRUSDT      ┆ -1.546857    ┆ 2    ┆ 144          │
│ MAGICUSDT    ┆ -1.506025    ┆ 3    ┆ 143          │
│ SXPUSDT      ┆ -1.456964    ┆ 4    ┆ 142          │
│ FETUSDT      ┆ -1.412962    ┆ 5    ┆ 141          │
│ FXSUSDT      ┆ -1.379402    ┆ 6    ┆ 140          │
│ APEUSDT      ┆ -1.365578    ┆ 7    ┆ 139          │
│ DYDXUSDT     ┆ -1.344837    ┆ 8    ┆ 138          │
│ KSMUSDT      ┆ -1.338855    ┆ 9    ┆ 137          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DARUSDT      ┆ -0.234637    ┆ 137  ┆ 9            │
│ ATAUSDT      ┆ -0.22995     ┆ 138  ┆ 8            │
│ ONEUSDT      ┆ -0.212504    ┆ 139  ┆ 7            │
│ IOTXUSDT     ┆ -0.176869    ┆ 140  ┆ 6            │
│ 1000XECUSDT  ┆ -0.159106    ┆ 141  ┆ 5            │
│ RVNUSDT      ┆ -0.142822    ┆ 142  ┆ 4            │
│ BLZUSDT      ┆ -0.080967    ┆ 143  ┆ 3            │
│ CVXUSDT      ┆ 0.60832      ┆ 144  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.815473     ┆ 145  ┆ 1            │
│ DEFIUSDT     ┆ 0.943554     ┆ 146  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:23,201 - INFO - cur close time: 2023-05-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:23,201 - DEBUG - mean expected ret (mean factor): -0.7799245930809058
2024-11-20 23:07:23,206 - DEBUG - begin to update pos: =========
2024-11-20 23:07:23,207 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,207 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0846      ┆ null        ┆ … ┆ 0.02284 ┆ null   ┆ null    ┆ 0.225   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,213 - DEBUG - update position: 2023-05-31T23:59:59.999 === diff_trading_value: 232771.7505592579 == cash: 147020.45695370977 
2024-11-20 23:07:23,214 - INFO - pnl: 2023-05-31T23:59:59.999 147020.45695370977 === 0.308%
2024-11-20 23:07:23,218 - DEBUG - cur time: 2023-06-01T23:59:59.999 == next bar open time: 2023-06-02T00:00:00.000 == close pos time: 2023-06-09T00:00:00.000
2024-11-20 23:07:23,219 - INFO - pnl: 2023-06-01T23:59:59.999 146781.97655124203 === -0.162%
2024-11-20 23:07:23,223 - DEBUG - cur time: 2023-06-02T23:59:59.999 == next bar open time: 2023-06-03T00:00:00.000 == close pos time: 2023-06-10T00:00:00.000
2024-11-20 23:07:23,225 - INFO - pnl: 2023-06-02T23:59:59.999 145400.00599704657 === -0.942%
2024-11-20 23:07:23,229 - DEBUG - cur time: 2023-06-03T23:59:59.999 == next bar open time: 2023-06-04T00:00:00.000 == close pos time: 2023-06-11T00:00:00.000
2024-11-20 23:07:23,231 - INFO - pnl: 2023-06-03T23:59:59.999 144422.90279267036 === -0.672%
2024-11-20 23:07:23,234 - DEBUG - cur time: 2023-06-04T23:59:59.999 == next bar open time: 2023-06-05T00:00:00.000 == close pos time: 2023-06-12T00:00:00.000
2024-11-20 23:07:23,236 - INFO - pnl: 2023-06-04T23:59:59.999 143706.22843523434 === -0.496%
2024-11-20 23:07:23,240 - DEBUG - cur time: 2023-06-05T23:59:59.999 == next bar open time: 2023-06-06T00:00:00.000 == close pos time: 2023-06-13T00:00:00.000
2024-11-20 23:07:23,241 - INFO - pnl: 2023-06-05T23:59:59.999 144472.021383415 === 0.533%
2024-11-20 23:07:23,246 - DEBUG - cur time: 2023-06-06T23:59:59.999 == next bar open time: 2023-06-07T00:00:00.000 == close pos time: 2023-06-14T00:00:00.000
2024-11-20 23:07:23,248 - INFO - pnl: 2023-06-06T23:59:59.999 143484.03030927177 === -0.684%
2024-11-20 23:07:23,251 - DEBUG - cur time: 2023-06-07T23:59:59.999 == next bar open time: 2023-06-08T00:00:00.000 == close pos time: 2023-06-15T00:00:00.000
2024-11-20 23:07:23,258 - DEBUG - sorted_long_factors: shape: (152, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MKRUSDT      ┆ -1.705346    ┆ 0    ┆ 151          │
│ STXUSDT      ┆ -1.670744    ┆ 1    ┆ 150          │
│ AGIXUSDT     ┆ -1.595973    ┆ 2    ┆ 149          │
│ PHBUSDT      ┆ -1.560655    ┆ 3    ┆ 148          │
│ FETUSDT      ┆ -1.551945    ┆ 4    ┆ 147          │
│ MTLUSDT      ┆ -1.505678    ┆ 5    ┆ 146          │
│ ACHUSDT      ┆ -1.415899    ┆ 6    ┆ 145          │
│ MANAUSDT     ┆ -1.375093    ┆ 7    ┆ 144          │
│ IOTAUSDT     ┆ -1.362533    ┆ 8    ┆ 143          │
│ RNDRUSDT     ┆ -1.3539      ┆ 9    ┆ 142          │
│ …            ┆ …            ┆ …    ┆ …            │
│ LRCUSDT      ┆ -0.149577    ┆ 142  ┆ 9            │
│ ENSUSDT      ┆ -0.122084    ┆ 143  ┆ 8            │
│ ALICEUSDT    ┆ -0.096411    ┆ 144  ┆ 7            │
│ AAVEUSDT     ┆ -0.068177    ┆ 145  ┆ 6            │
│ GALUSDT      ┆ -0.005494    ┆ 146  ┆ 5            │
│ GTCUSDT      ┆ 0.035876     ┆ 147  ┆ 4            │
│ CVXUSDT      ┆ 0.262742     ┆ 148  ┆ 3            │
│ ZENUSDT      ┆ 0.387942     ┆ 149  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.417875     ┆ 150  ┆ 1            │
│ DEFIUSDT     ┆ 1.434261     ┆ 151  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:23,264 - WARNING - 2023-06-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:23,264 - INFO - cur close time: 2023-06-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:23,265 - DEBUG - mean expected ret (mean factor): -0.7990209638522731
2024-11-20 23:07:23,269 - DEBUG - begin to update pos: =========
2024-11-20 23:07:23,269 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,269 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09357     ┆ null        ┆ … ┆ 0.02087 ┆ null   ┆ null    ┆ 0.1986  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,275 - DEBUG - update position: 2023-06-07T23:59:59.999 === diff_trading_value: 248046.6424304458 == cash: 143735.28942944724 
2024-11-20 23:07:23,276 - INFO - pnl: 2023-06-07T23:59:59.999 143735.28942944724 === 0.175%
2024-11-20 23:07:23,279 - DEBUG - cur time: 2023-06-08T23:59:59.999 == next bar open time: 2023-06-09T00:00:00.000 == close pos time: 2023-06-16T00:00:00.000
2024-11-20 23:07:23,281 - INFO - pnl: 2023-06-08T23:59:59.999 145320.09765632718 === 1.103%
2024-11-20 23:07:23,283 - DEBUG - cur time: 2023-06-09T23:59:59.999 == next bar open time: 2023-06-10T00:00:00.000 == close pos time: 2023-06-17T00:00:00.000
2024-11-20 23:07:23,285 - INFO - pnl: 2023-06-09T23:59:59.999 146452.26549985548 === 0.779%
2024-11-20 23:07:23,288 - DEBUG - cur time: 2023-06-10T23:59:59.999 == next bar open time: 2023-06-11T00:00:00.000 == close pos time: 2023-06-18T00:00:00.000
2024-11-20 23:07:23,290 - INFO - pnl: 2023-06-10T23:59:59.999 144120.49160356366 === -1.592%
2024-11-20 23:07:23,293 - DEBUG - cur time: 2023-06-11T23:59:59.999 == next bar open time: 2023-06-12T00:00:00.000 == close pos time: 2023-06-19T00:00:00.000
2024-11-20 23:07:23,294 - INFO - pnl: 2023-06-11T23:59:59.999 144395.19839238675 === 0.191%
2024-11-20 23:07:23,297 - DEBUG - cur time: 2023-06-12T23:59:59.999 == next bar open time: 2023-06-13T00:00:00.000 == close pos time: 2023-06-20T00:00:00.000
2024-11-20 23:07:23,299 - INFO - pnl: 2023-06-12T23:59:59.999 144858.58508054467 === 0.321%
2024-11-20 23:07:23,303 - DEBUG - cur time: 2023-06-13T23:59:59.999 == next bar open time: 2023-06-14T00:00:00.000 == close pos time: 2023-06-21T00:00:00.000
2024-11-20 23:07:23,306 - INFO - pnl: 2023-06-13T23:59:59.999 146159.26254180344 === 0.898%
2024-11-20 23:07:23,309 - DEBUG - cur time: 2023-06-14T23:59:59.999 == next bar open time: 2023-06-15T00:00:00.000 == close pos time: 2023-06-22T00:00:00.000
2024-11-20 23:07:23,316 - DEBUG - sorted_long_factors: shape: (153, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HIGHUSDT     ┆ -2.148239    ┆ 0    ┆ 152          │
│ MTLUSDT      ┆ -1.883107    ┆ 1    ┆ 151          │
│ RNDRUSDT     ┆ -1.831014    ┆ 2    ┆ 150          │
│ TOMOUSDT     ┆ -1.71996     ┆ 3    ┆ 149          │
│ SUSHIUSDT    ┆ -1.626969    ┆ 4    ┆ 148          │
│ SSVUSDT      ┆ -1.561424    ┆ 5    ┆ 147          │
│ KAVAUSDT     ┆ -1.508019    ┆ 6    ┆ 146          │
│ MANAUSDT     ┆ -1.505888    ┆ 7    ┆ 145          │
│ DYDXUSDT     ┆ -1.505093    ┆ 8    ┆ 144          │
│ IMXUSDT      ┆ -1.438977    ┆ 9    ┆ 143          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SPELLUSDT    ┆ -0.111306    ┆ 143  ┆ 9            │
│ GTCUSDT      ┆ -0.1073      ┆ 144  ┆ 8            │
│ 1000XECUSDT  ┆ 0.003662     ┆ 145  ┆ 7            │
│ BLZUSDT      ┆ 0.055793     ┆ 146  ┆ 6            │
│ QNTUSDT      ┆ 0.057088     ┆ 147  ┆ 5            │
│ ATAUSDT      ┆ 0.132769     ┆ 148  ┆ 4            │
│ FOOTBALLUSDT ┆ 0.153729     ┆ 149  ┆ 3            │
│ CVXUSDT      ┆ 0.481881     ┆ 150  ┆ 2            │
│ DEFIUSDT     ┆ 0.671144     ┆ 151  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.72601      ┆ 152  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:23,323 - WARNING - 2023-06-14T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:23,323 - INFO - cur close time: 2023-06-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:23,323 - DEBUG - mean expected ret (mean factor): -0.8056184864403916
2024-11-20 23:07:23,328 - DEBUG - begin to update pos: =========
2024-11-20 23:07:23,328 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,329 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09387     ┆ null        ┆ … ┆ 0.01679 ┆ null   ┆ null    ┆ 0.169   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,334 - DEBUG - update position: 2023-06-14T23:59:59.999 === diff_trading_value: 225090.05506841023 == cash: 145467.20088973636 
2024-11-20 23:07:23,336 - INFO - pnl: 2023-06-14T23:59:59.999 145467.20088973636 === -0.473%
2024-11-20 23:07:23,339 - DEBUG - cur time: 2023-06-15T23:59:59.999 == next bar open time: 2023-06-16T00:00:00.000 == close pos time: 2023-06-23T00:00:00.000
2024-11-20 23:07:23,340 - INFO - pnl: 2023-06-15T23:59:59.999 144409.2159379522 === -0.727%
2024-11-20 23:07:23,342 - DEBUG - cur time: 2023-06-16T23:59:59.999 == next bar open time: 2023-06-17T00:00:00.000 == close pos time: 2023-06-24T00:00:00.000
2024-11-20 23:07:23,344 - INFO - pnl: 2023-06-16T23:59:59.999 143811.97559826582 === -0.414%
2024-11-20 23:07:23,347 - DEBUG - cur time: 2023-06-17T23:59:59.999 == next bar open time: 2023-06-18T00:00:00.000 == close pos time: 2023-06-25T00:00:00.000
2024-11-20 23:07:23,348 - INFO - pnl: 2023-06-17T23:59:59.999 144122.44475577574 === 0.216%
2024-11-20 23:07:23,351 - DEBUG - cur time: 2023-06-18T23:59:59.999 == next bar open time: 2023-06-19T00:00:00.000 == close pos time: 2023-06-26T00:00:00.000
2024-11-20 23:07:23,352 - INFO - pnl: 2023-06-18T23:59:59.999 145435.604334274 === 0.911%
2024-11-20 23:07:23,356 - DEBUG - cur time: 2023-06-19T23:59:59.999 == next bar open time: 2023-06-20T00:00:00.000 == close pos time: 2023-06-27T00:00:00.000
2024-11-20 23:07:23,357 - INFO - pnl: 2023-06-19T23:59:59.999 145909.60067568292 === 0.326%
2024-11-20 23:07:23,361 - DEBUG - cur time: 2023-06-20T23:59:59.999 == next bar open time: 2023-06-21T00:00:00.000 == close pos time: 2023-06-28T00:00:00.000
2024-11-20 23:07:23,362 - INFO - pnl: 2023-06-20T23:59:59.999 145795.00132856806 === -0.079%
2024-11-20 23:07:23,366 - DEBUG - cur time: 2023-06-21T23:59:59.999 == next bar open time: 2023-06-22T00:00:00.000 == close pos time: 2023-06-29T00:00:00.000
2024-11-20 23:07:23,375 - DEBUG - sorted_long_factors: shape: (157, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RNDRUSDT     ┆ -1.896097    ┆ 0    ┆ 156          │
│ HOOKUSDT     ┆ -1.710976    ┆ 1    ┆ 155          │
│ MAGICUSDT    ┆ -1.706546    ┆ 2    ┆ 154          │
│ STXUSDT      ┆ -1.663675    ┆ 3    ┆ 153          │
│ MASKUSDT     ┆ -1.648539    ┆ 4    ┆ 152          │
│ AXSUSDT      ┆ -1.630212    ┆ 5    ┆ 151          │
│ CFXUSDT      ┆ -1.613909    ┆ 6    ┆ 150          │
│ NEOUSDT      ┆ -1.548554    ┆ 7    ┆ 149          │
│ XRPUSDT      ┆ -1.545639    ┆ 8    ┆ 148          │
│ KAVAUSDT     ┆ -1.531903    ┆ 9    ┆ 147          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DARUSDT      ┆ -0.128497    ┆ 147  ┆ 9            │
│ IOTXUSDT     ┆ 0.02523      ┆ 148  ┆ 8            │
│ KSMUSDT      ┆ 0.046052     ┆ 149  ┆ 7            │
│ BLUEBIRDUSDT ┆ 0.047988     ┆ 150  ┆ 6            │
│ ATAUSDT      ┆ 0.072838     ┆ 151  ┆ 5            │
│ BLZUSDT      ┆ 0.144687     ┆ 152  ┆ 4            │
│ DEFIUSDT     ┆ 0.441475     ┆ 153  ┆ 3            │
│ 1000XECUSDT  ┆ 0.446912     ┆ 154  ┆ 2            │
│ DGBUSDT      ┆ 0.456702     ┆ 155  ┆ 1            │
│ CVXUSDT      ┆ 0.568278     ┆ 156  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:23,384 - WARNING - 2023-06-21T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:23,384 - INFO - cur close time: 2023-06-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:23,384 - DEBUG - mean expected ret (mean factor): -0.8171885276693732
2024-11-20 23:07:23,390 - DEBUG - begin to update pos: =========
2024-11-20 23:07:23,390 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,390 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09332     ┆ null        ┆ … ┆ 0.019   ┆ null   ┆ null    ┆ 0.1937  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,398 - DEBUG - update position: 2023-06-21T23:59:59.999 === diff_trading_value: 298544.11090053275 == cash: 147436.30991083404 
2024-11-20 23:07:23,400 - INFO - pnl: 2023-06-21T23:59:59.999 147436.30991083404 === 1.126%
2024-11-20 23:07:23,405 - DEBUG - cur time: 2023-06-22T23:59:59.999 == next bar open time: 2023-06-23T00:00:00.000 == close pos time: 2023-06-30T00:00:00.000
2024-11-20 23:07:23,407 - INFO - pnl: 2023-06-22T23:59:59.999 149001.77992237045 === 1.062%
2024-11-20 23:07:23,411 - DEBUG - cur time: 2023-06-23T23:59:59.999 == next bar open time: 2023-06-24T00:00:00.000 == close pos time: 2023-07-01T00:00:00.000
2024-11-20 23:07:23,412 - INFO - pnl: 2023-06-23T23:59:59.999 150920.71472761687 === 1.288%
2024-11-20 23:07:23,415 - DEBUG - cur time: 2023-06-24T23:59:59.999 == next bar open time: 2023-06-25T00:00:00.000 == close pos time: 2023-07-02T00:00:00.000
2024-11-20 23:07:23,416 - INFO - pnl: 2023-06-24T23:59:59.999 151902.9226641105 === 0.651%
2024-11-20 23:07:23,420 - DEBUG - cur time: 2023-06-25T23:59:59.999 == next bar open time: 2023-06-26T00:00:00.000 == close pos time: 2023-07-03T00:00:00.000
2024-11-20 23:07:23,421 - INFO - pnl: 2023-06-25T23:59:59.999 152313.3960036714 === 0.270%
2024-11-20 23:07:23,427 - DEBUG - cur time: 2023-06-26T23:59:59.999 == next bar open time: 2023-06-27T00:00:00.000 == close pos time: 2023-07-04T00:00:00.000
2024-11-20 23:07:23,429 - INFO - pnl: 2023-06-26T23:59:59.999 151514.0740220494 === -0.525%
2024-11-20 23:07:23,432 - DEBUG - cur time: 2023-06-27T23:59:59.999 == next bar open time: 2023-06-28T00:00:00.000 == close pos time: 2023-07-05T00:00:00.000
2024-11-20 23:07:23,434 - INFO - pnl: 2023-06-27T23:59:59.999 152555.32377572695 === 0.687%
2024-11-20 23:07:23,440 - DEBUG - cur time: 2023-06-28T23:59:59.999 == next bar open time: 2023-06-29T00:00:00.000 == close pos time: 2023-07-06T00:00:00.000
2024-11-20 23:07:23,453 - DEBUG - sorted_long_factors: shape: (157, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT      ┆ -1.674542    ┆ 0    ┆ 156          │
│ RNDRUSDT     ┆ -1.589985    ┆ 1    ┆ 155          │
│ MASKUSDT     ┆ -1.583092    ┆ 2    ┆ 154          │
│ AGIXUSDT     ┆ -1.564622    ┆ 3    ┆ 153          │
│ MAGICUSDT    ┆ -1.51143     ┆ 4    ┆ 152          │
│ MINAUSDT     ┆ -1.456789    ┆ 5    ┆ 151          │
│ FILUSDT      ┆ -1.442966    ┆ 6    ┆ 150          │
│ XRPUSDT      ┆ -1.430141    ┆ 7    ┆ 149          │
│ NEARUSDT     ┆ -1.42073     ┆ 8    ┆ 148          │
│ HOOKUSDT     ┆ -1.381513    ┆ 9    ┆ 147          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BANDUSDT     ┆ -0.150407    ┆ 147  ┆ 9            │
│ IOTXUSDT     ┆ -0.137787    ┆ 148  ┆ 8            │
│ GTCUSDT      ┆ -0.10417     ┆ 149  ┆ 7            │
│ CVXUSDT      ┆ -0.027492    ┆ 150  ┆ 6            │
│ DGBUSDT      ┆ -0.025545    ┆ 151  ┆ 5            │
│ ZENUSDT      ┆ 0.094706     ┆ 152  ┆ 4            │
│ DARUSDT      ┆ 0.192409     ┆ 153  ┆ 3            │
│ CTKUSDT      ┆ 0.261137     ┆ 154  ┆ 2            │
│ DEFIUSDT     ┆ 0.652823     ┆ 155  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.684852     ┆ 156  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:23,459 - WARNING - 2023-06-28T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:23,459 - INFO - cur close time: 2023-06-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:23,461 - DEBUG - mean expected ret (mean factor): -0.806953046165121
2024-11-20 23:07:23,465 - DEBUG - begin to update pos: =========
2024-11-20 23:07:23,465 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,466 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08463     ┆ null        ┆ … ┆ 0.01909 ┆ null   ┆ null    ┆ 0.1967  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,476 - DEBUG - update position: 2023-06-28T23:59:59.999 === diff_trading_value: 192360.73550008255 == cash: 152308.88906444 
2024-11-20 23:07:23,477 - INFO - pnl: 2023-06-28T23:59:59.999 152308.88906444 === -0.162%
2024-11-20 23:07:23,482 - DEBUG - cur time: 2023-06-29T23:59:59.999 == next bar open time: 2023-06-30T00:00:00.000 == close pos time: 2023-07-07T00:00:00.000
2024-11-20 23:07:23,483 - INFO - pnl: 2023-06-29T23:59:59.999 152488.59045104455 === 0.118%
2024-11-20 23:07:23,486 - DEBUG - cur time: 2023-06-30T23:59:59.999 == next bar open time: 2023-07-01T00:00:00.000 == close pos time: 2023-07-08T00:00:00.000
2024-11-20 23:07:23,488 - INFO - pnl: 2023-06-30T23:59:59.999 160024.92326709416 === 4.942%
2024-11-20 23:07:23,491 - DEBUG - cur time: 2023-07-01T23:59:59.999 == next bar open time: 2023-07-02T00:00:00.000 == close pos time: 2023-07-09T00:00:00.000
2024-11-20 23:07:23,493 - INFO - pnl: 2023-07-01T23:59:59.999 157311.68710461698 === -1.696%
2024-11-20 23:07:23,498 - DEBUG - cur time: 2023-07-02T23:59:59.999 == next bar open time: 2023-07-03T00:00:00.000 == close pos time: 2023-07-10T00:00:00.000
2024-11-20 23:07:23,500 - INFO - pnl: 2023-07-02T23:59:59.999 158141.07394062917 === 0.527%
2024-11-20 23:07:23,503 - DEBUG - cur time: 2023-07-03T23:59:59.999 == next bar open time: 2023-07-04T00:00:00.000 == close pos time: 2023-07-11T00:00:00.000
2024-11-20 23:07:23,505 - INFO - pnl: 2023-07-03T23:59:59.999 156034.34047602487 === -1.332%
2024-11-20 23:07:23,508 - DEBUG - cur time: 2023-07-04T23:59:59.999 == next bar open time: 2023-07-05T00:00:00.000 == close pos time: 2023-07-12T00:00:00.000
2024-11-20 23:07:23,510 - INFO - pnl: 2023-07-04T23:59:59.999 157910.87017770545 === 1.203%
2024-11-20 23:07:23,514 - DEBUG - cur time: 2023-07-05T23:59:59.999 == next bar open time: 2023-07-06T00:00:00.000 == close pos time: 2023-07-13T00:00:00.000
2024-11-20 23:07:23,523 - DEBUG - sorted_long_factors: shape: (159, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HOOKUSDT     ┆ -1.736683    ┆ 0    ┆ 158          │
│ MAGICUSDT    ┆ -1.733887    ┆ 1    ┆ 157          │
│ APTUSDT      ┆ -1.669382    ┆ 2    ┆ 156          │
│ MTLUSDT      ┆ -1.627409    ┆ 3    ┆ 155          │
│ ARBUSDT      ┆ -1.620567    ┆ 4    ┆ 154          │
│ CFXUSDT      ┆ -1.563803    ┆ 5    ┆ 153          │
│ SSVUSDT      ┆ -1.512513    ┆ 6    ┆ 152          │
│ USDCUSDT     ┆ -1.507905    ┆ 7    ┆ 151          │
│ YFIUSDT      ┆ -1.485214    ┆ 8    ┆ 150          │
│ ZRXUSDT      ┆ -1.460231    ┆ 9    ┆ 149          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COTIUSDT     ┆ -0.096779    ┆ 149  ┆ 9            │
│ ATAUSDT      ┆ -0.051618    ┆ 150  ┆ 8            │
│ DARUSDT      ┆ -0.044906    ┆ 151  ┆ 7            │
│ IOTXUSDT     ┆ -0.041053    ┆ 152  ┆ 6            │
│ INJUSDT      ┆ 0.07894      ┆ 153  ┆ 5            │
│ API3USDT     ┆ 0.199157     ┆ 154  ┆ 4            │
│ PERPUSDT     ┆ 0.412106     ┆ 155  ┆ 3            │
│ CTKUSDT      ┆ 0.494245     ┆ 156  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.61389      ┆ 157  ┆ 1            │
│ DEFIUSDT     ┆ 0.792519     ┆ 158  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:23,530 - WARNING - 2023-07-05T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:23,530 - INFO - cur close time: 2023-07-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:23,531 - DEBUG - mean expected ret (mean factor): -0.8138799213235478
2024-11-20 23:07:23,536 - DEBUG - begin to update pos: =========
2024-11-20 23:07:23,536 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬─────────┬──────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT  │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---      │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64      │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆         ┆          │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪═════════╪══════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ -10000.0 │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴─────────┴──────────┘
2024-11-20 23:07:23,537 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08245     ┆ null        ┆ … ┆ 0.02192 ┆ null   ┆ null    ┆ 0.2241  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,543 - DEBUG - update position: 2023-07-05T23:59:59.999 === diff_trading_value: 238450.62496334527 == cash: 156700.8014512509 
2024-11-20 23:07:23,544 - INFO - pnl: 2023-07-05T23:59:59.999 156700.8014512509 === -0.766%
2024-11-20 23:07:23,548 - DEBUG - cur time: 2023-07-06T23:59:59.999 == next bar open time: 2023-07-07T00:00:00.000 == close pos time: 2023-07-14T00:00:00.000
2024-11-20 23:07:23,550 - INFO - pnl: 2023-07-06T23:59:59.999 157403.5470736926 === 0.448%
2024-11-20 23:07:23,555 - DEBUG - cur time: 2023-07-07T23:59:59.999 == next bar open time: 2023-07-08T00:00:00.000 == close pos time: 2023-07-15T00:00:00.000
2024-11-20 23:07:23,558 - INFO - pnl: 2023-07-07T23:59:59.999 155904.3732550203 === -0.952%
2024-11-20 23:07:23,563 - DEBUG - cur time: 2023-07-08T23:59:59.999 == next bar open time: 2023-07-09T00:00:00.000 == close pos time: 2023-07-16T00:00:00.000
2024-11-20 23:07:23,565 - INFO - pnl: 2023-07-08T23:59:59.999 154848.05090752177 === -0.678%
2024-11-20 23:07:23,570 - DEBUG - cur time: 2023-07-09T23:59:59.999 == next bar open time: 2023-07-10T00:00:00.000 == close pos time: 2023-07-17T00:00:00.000
2024-11-20 23:07:23,573 - INFO - pnl: 2023-07-09T23:59:59.999 154728.33980488474 === -0.077%
2024-11-20 23:07:23,578 - DEBUG - cur time: 2023-07-10T23:59:59.999 == next bar open time: 2023-07-11T00:00:00.000 == close pos time: 2023-07-18T00:00:00.000
2024-11-20 23:07:23,580 - INFO - pnl: 2023-07-10T23:59:59.999 154952.44290431894 === 0.145%
2024-11-20 23:07:23,585 - DEBUG - cur time: 2023-07-11T23:59:59.999 == next bar open time: 2023-07-12T00:00:00.000 == close pos time: 2023-07-19T00:00:00.000
2024-11-20 23:07:23,587 - INFO - pnl: 2023-07-11T23:59:59.999 154722.71382130345 === -0.148%
2024-11-20 23:07:23,591 - DEBUG - cur time: 2023-07-12T23:59:59.999 == next bar open time: 2023-07-13T00:00:00.000 == close pos time: 2023-07-20T00:00:00.000
2024-11-20 23:07:23,603 - DEBUG - sorted_long_factors: shape: (163, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SSVUSDT      ┆ -1.756585    ┆ 0    ┆ 162          │
│ STXUSDT      ┆ -1.727442    ┆ 1    ┆ 161          │
│ APTUSDT      ┆ -1.676881    ┆ 2    ┆ 160          │
│ AAVEUSDT     ┆ -1.66627     ┆ 3    ┆ 159          │
│ ZENUSDT      ┆ -1.589582    ┆ 4    ┆ 158          │
│ HOOKUSDT     ┆ -1.584776    ┆ 5    ┆ 157          │
│ COMPUSDT     ┆ -1.458356    ┆ 6    ┆ 156          │
│ SNXUSDT      ┆ -1.455472    ┆ 7    ┆ 155          │
│ RNDRUSDT     ┆ -1.404951    ┆ 8    ┆ 154          │
│ MASKUSDT     ┆ -1.379392    ┆ 9    ┆ 153          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BAKEUSDT     ┆ 0.118574     ┆ 153  ┆ 9            │
│ PERPUSDT     ┆ 0.140041     ┆ 154  ┆ 8            │
│ QNTUSDT      ┆ 0.140748     ┆ 155  ┆ 7            │
│ IOTXUSDT     ┆ 0.152269     ┆ 156  ┆ 6            │
│ CKBUSDT      ┆ 0.194302     ┆ 157  ┆ 5            │
│ LEVERUSDT    ┆ 0.196033     ┆ 158  ┆ 4            │
│ CHRUSDT      ┆ 0.230945     ┆ 159  ┆ 3            │
│ GTCUSDT      ┆ 0.286126     ┆ 160  ┆ 2            │
│ CTKUSDT      ┆ 0.626028     ┆ 161  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.900854     ┆ 162  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:23,610 - WARNING - 2023-07-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:23,610 - INFO - cur close time: 2023-07-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:23,611 - DEBUG - mean expected ret (mean factor): -0.8196749076399075
2024-11-20 23:07:23,617 - DEBUG - begin to update pos: =========
2024-11-20 23:07:23,617 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,618 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08356     ┆ null        ┆ … ┆ 0.02089 ┆ null   ┆ null    ┆ 0.2098  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,626 - DEBUG - update position: 2023-07-12T23:59:59.999 === diff_trading_value: 216346.4457911663 == cash: 154238.27290189615 
2024-11-20 23:07:23,629 - INFO - pnl: 2023-07-12T23:59:59.999 154238.27290189615 === -0.313%
2024-11-20 23:07:23,635 - DEBUG - cur time: 2023-07-13T23:59:59.999 == next bar open time: 2023-07-14T00:00:00.000 == close pos time: 2023-07-21T00:00:00.000
2024-11-20 23:07:23,637 - INFO - pnl: 2023-07-13T23:59:59.999 156273.66465253383 === 1.320%
2024-11-20 23:07:23,642 - DEBUG - cur time: 2023-07-14T23:59:59.999 == next bar open time: 2023-07-15T00:00:00.000 == close pos time: 2023-07-22T00:00:00.000
2024-11-20 23:07:23,644 - INFO - pnl: 2023-07-14T23:59:59.999 154086.78651185113 === -1.399%
2024-11-20 23:07:23,649 - DEBUG - cur time: 2023-07-15T23:59:59.999 == next bar open time: 2023-07-16T00:00:00.000 == close pos time: 2023-07-23T00:00:00.000
2024-11-20 23:07:23,651 - INFO - pnl: 2023-07-15T23:59:59.999 153263.38556261454 === -0.534%
2024-11-20 23:07:23,657 - DEBUG - cur time: 2023-07-16T23:59:59.999 == next bar open time: 2023-07-17T00:00:00.000 == close pos time: 2023-07-24T00:00:00.000
2024-11-20 23:07:23,660 - INFO - pnl: 2023-07-16T23:59:59.999 153121.7385256079 === -0.092%
2024-11-20 23:07:23,667 - DEBUG - cur time: 2023-07-17T23:59:59.999 == next bar open time: 2023-07-18T00:00:00.000 == close pos time: 2023-07-25T00:00:00.000
2024-11-20 23:07:23,668 - INFO - pnl: 2023-07-17T23:59:59.999 153539.52348964193 === 0.273%
2024-11-20 23:07:23,674 - DEBUG - cur time: 2023-07-18T23:59:59.999 == next bar open time: 2023-07-19T00:00:00.000 == close pos time: 2023-07-26T00:00:00.000
2024-11-20 23:07:23,676 - INFO - pnl: 2023-07-18T23:59:59.999 153370.186096152 === -0.110%
2024-11-20 23:07:23,683 - DEBUG - cur time: 2023-07-19T23:59:59.999 == next bar open time: 2023-07-20T00:00:00.000 == close pos time: 2023-07-27T00:00:00.000
2024-11-20 23:07:23,693 - DEBUG - sorted_long_factors: shape: (165, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ARBUSDT      ┆ -2.009568    ┆ 0    ┆ 164          │
│ MKRUSDT      ┆ -1.833836    ┆ 1    ┆ 163          │
│ STXUSDT      ┆ -1.831336    ┆ 2    ┆ 162          │
│ ANTUSDT      ┆ -1.814231    ┆ 3    ┆ 161          │
│ YFIUSDT      ┆ -1.762269    ┆ 4    ┆ 160          │
│ MASKUSDT     ┆ -1.657051    ┆ 5    ┆ 159          │
│ TOMOUSDT     ┆ -1.656843    ┆ 6    ┆ 158          │
│ LQTYUSDT     ┆ -1.64691     ┆ 7    ┆ 157          │
│ STORJUSDT    ┆ -1.577229    ┆ 8    ┆ 156          │
│ RNDRUSDT     ┆ -1.531551    ┆ 9    ┆ 155          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DEFIUSDT     ┆ 0.139117     ┆ 155  ┆ 9            │
│ CKBUSDT      ┆ 0.140917     ┆ 156  ┆ 8            │
│ LEVERUSDT    ┆ 0.14132      ┆ 157  ┆ 7            │
│ OGNUSDT      ┆ 0.15413      ┆ 158  ┆ 6            │
│ TLMUSDT      ┆ 0.205436     ┆ 159  ┆ 5            │
│ REEFUSDT     ┆ 0.22507      ┆ 160  ┆ 4            │
│ IOTXUSDT     ┆ 0.265462     ┆ 161  ┆ 3            │
│ CTKUSDT      ┆ 0.295013     ┆ 162  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.374831     ┆ 163  ┆ 1            │
│ LPTUSDT      ┆ 0.609361     ┆ 164  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:23,702 - WARNING - 2023-07-19T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:23,702 - INFO - cur close time: 2023-07-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:23,702 - DEBUG - mean expected ret (mean factor): -0.8239505926515972
2024-11-20 23:07:23,707 - DEBUG - begin to update pos: =========
2024-11-20 23:07:23,707 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,708 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08668     ┆ null        ┆ … ┆ 0.02174 ┆ null   ┆ null    ┆ 0.2099  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,718 - DEBUG - update position: 2023-07-19T23:59:59.999 === diff_trading_value: 197108.7168501747 == cash: 153082.0981736236 
2024-11-20 23:07:23,721 - INFO - pnl: 2023-07-19T23:59:59.999 153082.0981736236 === -0.188%
2024-11-20 23:07:23,727 - DEBUG - cur time: 2023-07-20T23:59:59.999 == next bar open time: 2023-07-21T00:00:00.000 == close pos time: 2023-07-28T00:00:00.000
2024-11-20 23:07:23,729 - INFO - pnl: 2023-07-20T23:59:59.999 154223.03611204884 === 0.745%
2024-11-20 23:07:23,735 - DEBUG - cur time: 2023-07-21T23:59:59.999 == next bar open time: 2023-07-22T00:00:00.000 == close pos time: 2023-07-29T00:00:00.000
2024-11-20 23:07:23,737 - INFO - pnl: 2023-07-21T23:59:59.999 152532.2667727195 === -1.096%
2024-11-20 23:07:23,742 - DEBUG - cur time: 2023-07-22T23:59:59.999 == next bar open time: 2023-07-23T00:00:00.000 == close pos time: 2023-07-30T00:00:00.000
2024-11-20 23:07:23,744 - INFO - pnl: 2023-07-22T23:59:59.999 152157.9305146187 === -0.245%
2024-11-20 23:07:23,750 - DEBUG - cur time: 2023-07-23T23:59:59.999 == next bar open time: 2023-07-24T00:00:00.000 == close pos time: 2023-07-31T00:00:00.000
2024-11-20 23:07:23,751 - INFO - pnl: 2023-07-23T23:59:59.999 157703.62259618478 === 3.645%
2024-11-20 23:07:23,756 - DEBUG - cur time: 2023-07-24T23:59:59.999 == next bar open time: 2023-07-25T00:00:00.000 == close pos time: 2023-08-01T00:00:00.000
2024-11-20 23:07:23,758 - INFO - pnl: 2023-07-24T23:59:59.999 153275.86464303642 === -2.808%
2024-11-20 23:07:23,761 - DEBUG - cur time: 2023-07-25T23:59:59.999 == next bar open time: 2023-07-26T00:00:00.000 == close pos time: 2023-08-02T00:00:00.000
2024-11-20 23:07:23,763 - INFO - pnl: 2023-07-25T23:59:59.999 150832.95092695236 === -1.594%
2024-11-20 23:07:23,767 - DEBUG - cur time: 2023-07-26T23:59:59.999 == next bar open time: 2023-07-27T00:00:00.000 == close pos time: 2023-08-03T00:00:00.000
2024-11-20 23:07:23,776 - DEBUG - sorted_long_factors: shape: (166, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ARBUSDT      ┆ -1.95124     ┆ 0    ┆ 165          │
│ ICPUSDT      ┆ -1.925126    ┆ 1    ┆ 164          │
│ WAVESUSDT    ┆ -1.909666    ┆ 2    ┆ 163          │
│ LQTYUSDT     ┆ -1.882911    ┆ 3    ┆ 162          │
│ MKRUSDT      ┆ -1.716214    ┆ 4    ┆ 161          │
│ UNIUSDT      ┆ -1.642862    ┆ 5    ┆ 160          │
│ CFXUSDT      ┆ -1.609368    ┆ 6    ┆ 159          │
│ STXUSDT      ┆ -1.586289    ┆ 7    ┆ 158          │
│ DOTUSDT      ┆ -1.54374     ┆ 8    ┆ 157          │
│ BNBUSDT      ┆ -1.538216    ┆ 9    ┆ 156          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SPELLUSDT    ┆ 0.241501     ┆ 156  ┆ 9            │
│ BLUEBIRDUSDT ┆ 0.288782     ┆ 157  ┆ 8            │
│ BLZUSDT      ┆ 0.323288     ┆ 158  ┆ 7            │
│ TLMUSDT      ┆ 0.350887     ┆ 159  ┆ 6            │
│ RVNUSDT      ┆ 0.358151     ┆ 160  ┆ 5            │
│ SKLUSDT      ┆ 0.362233     ┆ 161  ┆ 4            │
│ CTKUSDT      ┆ 0.380656     ┆ 162  ┆ 3            │
│ LEVERUSDT    ┆ 0.437733     ┆ 163  ┆ 2            │
│ GTCUSDT      ┆ 0.513847     ┆ 164  ┆ 1            │
│ PERPUSDT     ┆ 0.522171     ┆ 165  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:23,783 - WARNING - 2023-07-26T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:23,783 - INFO - cur close time: 2023-07-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:23,783 - DEBUG - mean expected ret (mean factor): -0.8084936631983747
2024-11-20 23:07:23,789 - DEBUG - begin to update pos: =========
2024-11-20 23:07:23,789 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,789 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08142     ┆ null        ┆ … ┆ 0.0208  ┆ null   ┆ null    ┆ 0.2083  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,798 - DEBUG - update position: 2023-07-26T23:59:59.999 === diff_trading_value: 205807.50664334837 == cash: 151892.14212343923 
2024-11-20 23:07:23,799 - INFO - pnl: 2023-07-26T23:59:59.999 151892.14212343923 === 0.702%
2024-11-20 23:07:23,803 - DEBUG - cur time: 2023-07-27T23:59:59.999 == next bar open time: 2023-07-28T00:00:00.000 == close pos time: 2023-08-04T00:00:00.000
2024-11-20 23:07:23,805 - INFO - pnl: 2023-07-27T23:59:59.999 152279.75472008763 === 0.255%
2024-11-20 23:07:23,810 - DEBUG - cur time: 2023-07-28T23:59:59.999 == next bar open time: 2023-07-29T00:00:00.000 == close pos time: 2023-08-05T00:00:00.000
2024-11-20 23:07:23,814 - INFO - pnl: 2023-07-28T23:59:59.999 151287.08183449312 === -0.652%
2024-11-20 23:07:23,818 - DEBUG - cur time: 2023-07-29T23:59:59.999 == next bar open time: 2023-07-30T00:00:00.000 == close pos time: 2023-08-06T00:00:00.000
2024-11-20 23:07:23,820 - INFO - pnl: 2023-07-29T23:59:59.999 150082.97603002645 === -0.796%
2024-11-20 23:07:23,824 - DEBUG - cur time: 2023-07-30T23:59:59.999 == next bar open time: 2023-07-31T00:00:00.000 == close pos time: 2023-08-07T00:00:00.000
2024-11-20 23:07:23,825 - INFO - pnl: 2023-07-30T23:59:59.999 148608.9381508497 === -0.982%
2024-11-20 23:07:23,830 - DEBUG - cur time: 2023-07-31T23:59:59.999 == next bar open time: 2023-08-01T00:00:00.000 == close pos time: 2023-08-08T00:00:00.000
2024-11-20 23:07:23,831 - INFO - pnl: 2023-07-31T23:59:59.999 149091.67457652278 === 0.325%
2024-11-20 23:07:23,835 - DEBUG - cur time: 2023-08-01T23:59:59.999 == next bar open time: 2023-08-02T00:00:00.000 == close pos time: 2023-08-09T00:00:00.000
2024-11-20 23:07:23,838 - INFO - pnl: 2023-08-01T23:59:59.999 148910.48035464901 === -0.122%
2024-11-20 23:07:23,843 - DEBUG - cur time: 2023-08-02T23:59:59.999 == next bar open time: 2023-08-03T00:00:00.000 == close pos time: 2023-08-10T00:00:00.000
2024-11-20 23:07:23,853 - DEBUG - sorted_long_factors: shape: (166, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CFXUSDT      ┆ -1.819681    ┆ 0    ┆ 165          │
│ IDUSDT       ┆ -1.787005    ┆ 1    ┆ 164          │
│ UNIUSDT      ┆ -1.639069    ┆ 2    ┆ 163          │
│ HOOKUSDT     ┆ -1.633482    ┆ 3    ┆ 162          │
│ HIGHUSDT     ┆ -1.547582    ┆ 4    ┆ 161          │
│ RDNTUSDT     ┆ -1.538535    ┆ 5    ┆ 160          │
│ STXUSDT      ┆ -1.509002    ┆ 6    ┆ 159          │
│ BNBUSDT      ┆ -1.473599    ┆ 7    ┆ 158          │
│ 1INCHUSDT    ┆ -1.473585    ┆ 8    ┆ 157          │
│ WAVESUSDT    ┆ -1.438466    ┆ 9    ┆ 156          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BNXUSDT      ┆ -0.048531    ┆ 156  ┆ 9            │
│ AAVEUSDT     ┆ -0.038048    ┆ 157  ┆ 8            │
│ LEVERUSDT    ┆ -0.026995    ┆ 158  ┆ 7            │
│ GMXUSDT      ┆ -0.001425    ┆ 159  ┆ 6            │
│ BLZUSDT      ┆ 0.341315     ┆ 160  ┆ 5            │
│ CVXUSDT      ┆ 0.39811      ┆ 161  ┆ 4            │
│ IOTXUSDT     ┆ 0.446012     ┆ 162  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.605486     ┆ 163  ┆ 2            │
│ CTKUSDT      ┆ 0.803305     ┆ 164  ┆ 1            │
│ DEFIUSDT     ┆ 1.57944      ┆ 165  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:23,862 - INFO - cur close time: 2023-08-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:23,862 - DEBUG - mean expected ret (mean factor): -0.7870814988963628
2024-11-20 23:07:23,868 - DEBUG - begin to update pos: =========
2024-11-20 23:07:23,868 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,868 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08021     ┆ null        ┆ … ┆ 0.0206  ┆ null   ┆ null    ┆ 0.2205  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,878 - DEBUG - update position: 2023-08-02T23:59:59.999 === diff_trading_value: 194004.93926725627 == cash: 148623.957920809 
2024-11-20 23:07:23,880 - INFO - pnl: 2023-08-02T23:59:59.999 148623.957920809 === -0.192%
2024-11-20 23:07:23,883 - DEBUG - cur time: 2023-08-03T23:59:59.999 == next bar open time: 2023-08-04T00:00:00.000 == close pos time: 2023-08-11T00:00:00.000
2024-11-20 23:07:23,886 - INFO - pnl: 2023-08-03T23:59:59.999 148830.21240384478 === 0.139%
2024-11-20 23:07:23,891 - DEBUG - cur time: 2023-08-04T23:59:59.999 == next bar open time: 2023-08-05T00:00:00.000 == close pos time: 2023-08-12T00:00:00.000
2024-11-20 23:07:23,894 - INFO - pnl: 2023-08-04T23:59:59.999 149225.72739913475 === 0.266%
2024-11-20 23:07:23,898 - DEBUG - cur time: 2023-08-05T23:59:59.999 == next bar open time: 2023-08-06T00:00:00.000 == close pos time: 2023-08-13T00:00:00.000
2024-11-20 23:07:23,899 - INFO - pnl: 2023-08-05T23:59:59.999 149259.07734677903 === 0.022%
2024-11-20 23:07:23,903 - DEBUG - cur time: 2023-08-06T23:59:59.999 == next bar open time: 2023-08-07T00:00:00.000 == close pos time: 2023-08-14T00:00:00.000
2024-11-20 23:07:23,904 - INFO - pnl: 2023-08-06T23:59:59.999 152441.24901451316 === 2.132%
2024-11-20 23:07:23,908 - DEBUG - cur time: 2023-08-07T23:59:59.999 == next bar open time: 2023-08-08T00:00:00.000 == close pos time: 2023-08-15T00:00:00.000
2024-11-20 23:07:23,910 - INFO - pnl: 2023-08-07T23:59:59.999 151488.82242882886 === -0.625%
2024-11-20 23:07:23,915 - DEBUG - cur time: 2023-08-08T23:59:59.999 == next bar open time: 2023-08-09T00:00:00.000 == close pos time: 2023-08-16T00:00:00.000
2024-11-20 23:07:23,917 - INFO - pnl: 2023-08-08T23:59:59.999 150952.53259948205 === -0.354%
2024-11-20 23:07:23,922 - DEBUG - cur time: 2023-08-09T23:59:59.999 == next bar open time: 2023-08-10T00:00:00.000 == close pos time: 2023-08-17T00:00:00.000
2024-11-20 23:07:23,933 - DEBUG - sorted_long_factors: shape: (168, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HIGHUSDT     ┆ -2.065215    ┆ 0    ┆ 167          │
│ UNIUSDT      ┆ -1.896801    ┆ 1    ┆ 166          │
│ ARBUSDT      ┆ -1.72198     ┆ 2    ┆ 165          │
│ MKRUSDT      ┆ -1.640884    ┆ 3    ┆ 164          │
│ CFXUSDT      ┆ -1.577746    ┆ 4    ┆ 163          │
│ GTCUSDT      ┆ -1.572397    ┆ 5    ┆ 162          │
│ MASKUSDT     ┆ -1.553926    ┆ 6    ┆ 161          │
│ MAGICUSDT    ┆ -1.487292    ┆ 7    ┆ 160          │
│ FILUSDT      ┆ -1.482622    ┆ 8    ┆ 159          │
│ SSVUSDT      ┆ -1.481789    ┆ 9    ┆ 158          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DGBUSDT      ┆ -0.156645    ┆ 158  ┆ 9            │
│ REEFUSDT     ┆ -0.111308    ┆ 159  ┆ 8            │
│ DEFIUSDT     ┆ 0.053861     ┆ 160  ┆ 7            │
│ KSMUSDT      ┆ 0.075791     ┆ 161  ┆ 6            │
│ DUSKUSDT     ┆ 0.161203     ┆ 162  ┆ 5            │
│ BTCDOMUSDT   ┆ 0.266255     ┆ 163  ┆ 4            │
│ BLUEBIRDUSDT ┆ 0.390487     ┆ 164  ┆ 3            │
│ CTKUSDT      ┆ 0.431316     ┆ 165  ┆ 2            │
│ BLZUSDT      ┆ 0.56179      ┆ 166  ┆ 1            │
│ IOTXUSDT     ┆ 0.764843     ┆ 167  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:23,942 - WARNING - 2023-08-09T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:23,943 - INFO - cur close time: 2023-08-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:23,943 - DEBUG - mean expected ret (mean factor): -0.8265093463537256
2024-11-20 23:07:23,949 - DEBUG - begin to update pos: =========
2024-11-20 23:07:23,949 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,950 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.07844     ┆ null        ┆ … ┆ 0.01997 ┆ null   ┆ null    ┆ 0.2153  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:23,958 - DEBUG - update position: 2023-08-09T23:59:59.999 === diff_trading_value: 236292.151647061 == cash: 150668.22544911227 
2024-11-20 23:07:23,960 - INFO - pnl: 2023-08-09T23:59:59.999 150668.22544911227 === -0.188%
2024-11-20 23:07:23,965 - DEBUG - cur time: 2023-08-10T23:59:59.999 == next bar open time: 2023-08-11T00:00:00.000 == close pos time: 2023-08-18T00:00:00.000
2024-11-20 23:07:23,968 - INFO - pnl: 2023-08-10T23:59:59.999 150734.90638743457 === 0.044%
2024-11-20 23:07:23,973 - DEBUG - cur time: 2023-08-11T23:59:59.999 == next bar open time: 2023-08-12T00:00:00.000 == close pos time: 2023-08-19T00:00:00.000
2024-11-20 23:07:23,977 - INFO - pnl: 2023-08-11T23:59:59.999 150335.04579904513 === -0.265%
2024-11-20 23:07:23,983 - DEBUG - cur time: 2023-08-12T23:59:59.999 == next bar open time: 2023-08-13T00:00:00.000 == close pos time: 2023-08-20T00:00:00.000
2024-11-20 23:07:23,986 - INFO - pnl: 2023-08-12T23:59:59.999 150594.2382172338 === 0.172%
2024-11-20 23:07:23,994 - DEBUG - cur time: 2023-08-13T23:59:59.999 == next bar open time: 2023-08-14T00:00:00.000 == close pos time: 2023-08-21T00:00:00.000
2024-11-20 23:07:23,997 - INFO - pnl: 2023-08-13T23:59:59.999 156201.06605687377 === 3.723%
2024-11-20 23:07:24,002 - DEBUG - cur time: 2023-08-14T23:59:59.999 == next bar open time: 2023-08-15T00:00:00.000 == close pos time: 2023-08-22T00:00:00.000
2024-11-20 23:07:24,005 - INFO - pnl: 2023-08-14T23:59:59.999 155467.12021024828 === -0.470%
2024-11-20 23:07:24,010 - DEBUG - cur time: 2023-08-15T23:59:59.999 == next bar open time: 2023-08-16T00:00:00.000 == close pos time: 2023-08-23T00:00:00.000
2024-11-20 23:07:24,013 - INFO - pnl: 2023-08-15T23:59:59.999 155014.44984981127 === -0.291%
2024-11-20 23:07:24,019 - DEBUG - cur time: 2023-08-16T23:59:59.999 == next bar open time: 2023-08-17T00:00:00.000 == close pos time: 2023-08-24T00:00:00.000
2024-11-20 23:07:24,031 - DEBUG - sorted_long_factors: shape: (172, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HIGHUSDT     ┆ -1.599259    ┆ 0    ┆ 171          │
│ PHBUSDT      ┆ -1.539113    ┆ 1    ┆ 170          │
│ STXUSDT      ┆ -1.534483    ┆ 2    ┆ 169          │
│ ARBUSDT      ┆ -1.516768    ┆ 3    ┆ 168          │
│ USDCUSDT     ┆ -1.50024     ┆ 4    ┆ 167          │
│ APEUSDT      ┆ -1.484665    ┆ 5    ┆ 166          │
│ ACHUSDT      ┆ -1.463155    ┆ 6    ┆ 165          │
│ 1000PEPEUSDT ┆ -1.436962    ┆ 7    ┆ 164          │
│ IDUSDT       ┆ -1.419908    ┆ 8    ┆ 163          │
│ LQTYUSDT     ┆ -1.382878    ┆ 9    ┆ 162          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ZENUSDT      ┆ -0.225152    ┆ 162  ┆ 9            │
│ ICXUSDT      ┆ -0.209665    ┆ 163  ┆ 8            │
│ IDEXUSDT     ┆ -0.199252    ┆ 164  ┆ 7            │
│ FOOTBALLUSDT ┆ -0.069843    ┆ 165  ┆ 6            │
│ CTKUSDT      ┆ 0.035451     ┆ 166  ┆ 5            │
│ SKLUSDT      ┆ 0.096883     ┆ 167  ┆ 4            │
│ IOTXUSDT     ┆ 0.139774     ┆ 168  ┆ 3            │
│ ARUSDT       ┆ 0.272404     ┆ 169  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.919348     ┆ 170  ┆ 1            │
│ DEFIUSDT     ┆ 0.990791     ┆ 171  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,040 - WARNING - 2023-08-16T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:24,040 - INFO - cur close time: 2023-08-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:24,041 - DEBUG - mean expected ret (mean factor): -0.8180249341690928
2024-11-20 23:07:24,046 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,046 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,047 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02126     ┆ 0.06588     ┆ 0.0011653   ┆ … ┆ 0.01786 ┆ null   ┆ null    ┆ 0.192   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,055 - DEBUG - update position: 2023-08-16T23:59:59.999 === diff_trading_value: 279770.2508327891 == cash: 159336.90740013722 
2024-11-20 23:07:24,057 - INFO - pnl: 2023-08-16T23:59:59.999 159336.90740013722 === 2.788%
2024-11-20 23:07:24,060 - DEBUG - cur time: 2023-08-17T23:59:59.999 == next bar open time: 2023-08-18T00:00:00.000 == close pos time: 2023-08-25T00:00:00.000
2024-11-20 23:07:24,061 - INFO - pnl: 2023-08-17T23:59:59.999 161321.18806121618 === 1.245%
2024-11-20 23:07:24,065 - DEBUG - cur time: 2023-08-18T23:59:59.999 == next bar open time: 2023-08-19T00:00:00.000 == close pos time: 2023-08-26T00:00:00.000
2024-11-20 23:07:24,067 - INFO - pnl: 2023-08-18T23:59:59.999 160339.62247421435 === -0.608%
2024-11-20 23:07:24,071 - DEBUG - cur time: 2023-08-19T23:59:59.999 == next bar open time: 2023-08-20T00:00:00.000 == close pos time: 2023-08-27T00:00:00.000
2024-11-20 23:07:24,074 - INFO - pnl: 2023-08-19T23:59:59.999 159752.1239967798 === -0.366%
2024-11-20 23:07:24,077 - DEBUG - cur time: 2023-08-20T23:59:59.999 == next bar open time: 2023-08-21T00:00:00.000 == close pos time: 2023-08-28T00:00:00.000
2024-11-20 23:07:24,079 - INFO - pnl: 2023-08-20T23:59:59.999 160313.60416250487 === 0.351%
2024-11-20 23:07:24,084 - DEBUG - cur time: 2023-08-21T23:59:59.999 == next bar open time: 2023-08-22T00:00:00.000 == close pos time: 2023-08-29T00:00:00.000
2024-11-20 23:07:24,087 - INFO - pnl: 2023-08-21T23:59:59.999 160590.608877718 === 0.173%
2024-11-20 23:07:24,091 - DEBUG - cur time: 2023-08-22T23:59:59.999 == next bar open time: 2023-08-23T00:00:00.000 == close pos time: 2023-08-30T00:00:00.000
2024-11-20 23:07:24,094 - INFO - pnl: 2023-08-22T23:59:59.999 161300.38580278138 === 0.442%
2024-11-20 23:07:24,098 - DEBUG - cur time: 2023-08-23T23:59:59.999 == next bar open time: 2023-08-24T00:00:00.000 == close pos time: 2023-08-31T00:00:00.000
2024-11-20 23:07:24,110 - DEBUG - sorted_long_factors: shape: (174, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ UNFIUSDT     ┆ -2.038693    ┆ 0    ┆ 173          │
│ KNCUSDT      ┆ -1.800419    ┆ 1    ┆ 172          │
│ GTCUSDT      ┆ -1.798242    ┆ 2    ┆ 171          │
│ HIGHUSDT     ┆ -1.784536    ┆ 3    ┆ 170          │
│ PHBUSDT      ┆ -1.655583    ┆ 4    ┆ 169          │
│ ARBUSDT      ┆ -1.634213    ┆ 5    ┆ 168          │
│ LEVERUSDT    ┆ -1.624807    ┆ 6    ┆ 167          │
│ SUSHIUSDT    ┆ -1.577677    ┆ 7    ┆ 166          │
│ TRBUSDT      ┆ -1.569554    ┆ 8    ┆ 165          │
│ MKRUSDT      ┆ -1.528378    ┆ 9    ┆ 164          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOSTUSDT     ┆ -0.064359    ┆ 164  ┆ 9            │
│ TUSDT        ┆ 0.015949     ┆ 165  ┆ 8            │
│ DGBUSDT      ┆ 0.043524     ┆ 166  ┆ 7            │
│ IOTXUSDT     ┆ 0.075905     ┆ 167  ┆ 6            │
│ CKBUSDT      ┆ 0.144654     ┆ 168  ┆ 5            │
│ BLUEBIRDUSDT ┆ 0.482824     ┆ 169  ┆ 4            │
│ SPELLUSDT    ┆ 0.524401     ┆ 170  ┆ 3            │
│ IDEXUSDT     ┆ 0.646692     ┆ 171  ┆ 2            │
│ CTKUSDT      ┆ 0.744512     ┆ 172  ┆ 1            │
│ DEFIUSDT     ┆ 0.856601     ┆ 173  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,120 - WARNING - 2023-08-23T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:24,120 - INFO - cur close time: 2023-08-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:24,121 - DEBUG - mean expected ret (mean factor): -0.8319613464485743
2024-11-20 23:07:24,129 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,130 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,130 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0185      ┆ 0.06491     ┆ 0.0011043   ┆ … ┆ 0.01698 ┆ null   ┆ null    ┆ 0.177   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,143 - DEBUG - update position: 2023-08-23T23:59:59.999 === diff_trading_value: 257659.5240494415 == cash: 161153.23203294148 
2024-11-20 23:07:24,147 - INFO - pnl: 2023-08-23T23:59:59.999 161153.23203294148 === -0.091%
2024-11-20 23:07:24,153 - DEBUG - cur time: 2023-08-24T23:59:59.999 == next bar open time: 2023-08-25T00:00:00.000 == close pos time: 2023-09-01T00:00:00.000
2024-11-20 23:07:24,156 - INFO - pnl: 2023-08-24T23:59:59.999 160850.84122873668 === -0.188%
2024-11-20 23:07:24,162 - DEBUG - cur time: 2023-08-25T23:59:59.999 == next bar open time: 2023-08-26T00:00:00.000 == close pos time: 2023-09-02T00:00:00.000
2024-11-20 23:07:24,165 - INFO - pnl: 2023-08-25T23:59:59.999 163472.71479749712 === 1.630%
2024-11-20 23:07:24,171 - DEBUG - cur time: 2023-08-26T23:59:59.999 == next bar open time: 2023-08-27T00:00:00.000 == close pos time: 2023-09-03T00:00:00.000
2024-11-20 23:07:24,175 - INFO - pnl: 2023-08-26T23:59:59.999 160579.85702284335 === -1.770%
2024-11-20 23:07:24,181 - DEBUG - cur time: 2023-08-27T23:59:59.999 == next bar open time: 2023-08-28T00:00:00.000 == close pos time: 2023-09-04T00:00:00.000
2024-11-20 23:07:24,185 - INFO - pnl: 2023-08-27T23:59:59.999 157531.24755176468 === -1.899%
2024-11-20 23:07:24,194 - DEBUG - cur time: 2023-08-28T23:59:59.999 == next bar open time: 2023-08-29T00:00:00.000 == close pos time: 2023-09-05T00:00:00.000
2024-11-20 23:07:24,198 - INFO - pnl: 2023-08-28T23:59:59.999 157576.2756124452 === 0.029%
2024-11-20 23:07:24,203 - DEBUG - cur time: 2023-08-29T23:59:59.999 == next bar open time: 2023-08-30T00:00:00.000 == close pos time: 2023-09-06T00:00:00.000
2024-11-20 23:07:24,206 - INFO - pnl: 2023-08-29T23:59:59.999 155783.24536873828 === -1.138%
2024-11-20 23:07:24,211 - DEBUG - cur time: 2023-08-30T23:59:59.999 == next bar open time: 2023-08-31T00:00:00.000 == close pos time: 2023-09-07T00:00:00.000
2024-11-20 23:07:24,222 - DEBUG - sorted_long_factors: shape: (174, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ USDCUSDT     ┆ -1.969865    ┆ 0    ┆ 173          │
│ LPTUSDT      ┆ -1.815608    ┆ 1    ┆ 172          │
│ LEVERUSDT    ┆ -1.725561    ┆ 2    ┆ 171          │
│ 1000PEPEUSDT ┆ -1.694256    ┆ 3    ┆ 170          │
│ PHBUSDT      ┆ -1.527889    ┆ 4    ┆ 169          │
│ ARBUSDT      ┆ -1.511933    ┆ 5    ┆ 168          │
│ RDNTUSDT     ┆ -1.469905    ┆ 6    ┆ 167          │
│ BLURUSDT     ┆ -1.46794     ┆ 7    ┆ 166          │
│ SSVUSDT      ┆ -1.460631    ┆ 8    ┆ 165          │
│ DOTUSDT      ┆ -1.458535    ┆ 9    ┆ 164          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ICXUSDT      ┆ 0.033961     ┆ 164  ┆ 9            │
│ SPELLUSDT    ┆ 0.060422     ┆ 165  ┆ 8            │
│ PERPUSDT     ┆ 0.072741     ┆ 166  ┆ 7            │
│ BALUSDT      ┆ 0.114403     ┆ 167  ┆ 6            │
│ CKBUSDT      ┆ 0.205506     ┆ 168  ┆ 5            │
│ CTKUSDT      ┆ 0.283579     ┆ 169  ┆ 4            │
│ BLUEBIRDUSDT ┆ 0.296596     ┆ 170  ┆ 3            │
│ DEFIUSDT     ┆ 0.340777     ┆ 171  ┆ 2            │
│ IDEXUSDT     ┆ 0.439124     ┆ 172  ┆ 1            │
│ TUSDT        ┆ 0.5619       ┆ 173  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,228 - WARNING - 2023-08-30T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:24,228 - INFO - cur close time: 2023-08-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:24,229 - DEBUG - mean expected ret (mean factor): -0.8124516444322841
2024-11-20 23:07:24,235 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,235 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,236 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01829     ┆ 0.06398     ┆ 0.0008672   ┆ … ┆ 0.01697 ┆ null   ┆ null    ┆ 0.1736  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,242 - DEBUG - update position: 2023-08-30T23:59:59.999 === diff_trading_value: 220897.1991176553 == cash: 153303.49040195352 
2024-11-20 23:07:24,243 - INFO - pnl: 2023-08-30T23:59:59.999 153303.49040195352 === -1.592%
2024-11-20 23:07:24,246 - DEBUG - cur time: 2023-08-31T23:59:59.999 == next bar open time: 2023-09-01T00:00:00.000 == close pos time: 2023-09-08T00:00:00.000
2024-11-20 23:07:24,247 - INFO - pnl: 2023-08-31T23:59:59.999 153910.58702855877 === 0.396%
2024-11-20 23:07:24,251 - DEBUG - cur time: 2023-09-01T23:59:59.999 == next bar open time: 2023-09-02T00:00:00.000 == close pos time: 2023-09-09T00:00:00.000
2024-11-20 23:07:24,252 - INFO - pnl: 2023-09-01T23:59:59.999 154561.27494968433 === 0.423%
2024-11-20 23:07:24,255 - DEBUG - cur time: 2023-09-02T23:59:59.999 == next bar open time: 2023-09-03T00:00:00.000 == close pos time: 2023-09-10T00:00:00.000
2024-11-20 23:07:24,257 - INFO - pnl: 2023-09-02T23:59:59.999 156309.02541065114 === 1.131%
2024-11-20 23:07:24,259 - DEBUG - cur time: 2023-09-03T23:59:59.999 == next bar open time: 2023-09-04T00:00:00.000 == close pos time: 2023-09-11T00:00:00.000
2024-11-20 23:07:24,262 - INFO - pnl: 2023-09-03T23:59:59.999 156347.66513541434 === 0.025%
2024-11-20 23:07:24,264 - DEBUG - cur time: 2023-09-04T23:59:59.999 == next bar open time: 2023-09-05T00:00:00.000 == close pos time: 2023-09-12T00:00:00.000
2024-11-20 23:07:24,265 - INFO - pnl: 2023-09-04T23:59:59.999 154768.58317110757 === -1.010%
2024-11-20 23:07:24,267 - DEBUG - cur time: 2023-09-05T23:59:59.999 == next bar open time: 2023-09-06T00:00:00.000 == close pos time: 2023-09-13T00:00:00.000
2024-11-20 23:07:24,269 - INFO - pnl: 2023-09-05T23:59:59.999 159853.56354344648 === 3.286%
2024-11-20 23:07:24,273 - DEBUG - cur time: 2023-09-06T23:59:59.999 == next bar open time: 2023-09-07T00:00:00.000 == close pos time: 2023-09-14T00:00:00.000
2024-11-20 23:07:24,280 - DEBUG - sorted_long_factors: shape: (175, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DOTUSDT      ┆ -1.89085     ┆ 0    ┆ 174          │
│ ARBUSDT      ┆ -1.780418    ┆ 1    ┆ 173          │
│ ATOMUSDT     ┆ -1.622136    ┆ 2    ┆ 172          │
│ XMRUSDT      ┆ -1.612342    ┆ 3    ┆ 171          │
│ USDCUSDT     ┆ -1.602704    ┆ 4    ┆ 170          │
│ FILUSDT      ┆ -1.584349    ┆ 5    ┆ 169          │
│ MKRUSDT      ┆ -1.581961    ┆ 6    ┆ 168          │
│ APTUSDT      ┆ -1.578265    ┆ 7    ┆ 167          │
│ UNIUSDT      ┆ -1.574789    ┆ 8    ┆ 166          │
│ DYDXUSDT     ┆ -1.5665      ┆ 9    ┆ 165          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CVXUSDT      ┆ 0.121152     ┆ 165  ┆ 9            │
│ DGBUSDT      ┆ 0.125033     ┆ 166  ┆ 8            │
│ TUSDT        ┆ 0.183779     ┆ 167  ┆ 7            │
│ DENTUSDT     ┆ 0.213245     ┆ 168  ┆ 6            │
│ SPELLUSDT    ┆ 0.221821     ┆ 169  ┆ 5            │
│ BNXUSDT      ┆ 0.253401     ┆ 170  ┆ 4            │
│ ICXUSDT      ┆ 0.308701     ┆ 171  ┆ 3            │
│ IOTXUSDT     ┆ 0.605831     ┆ 172  ┆ 2            │
│ CKBUSDT      ┆ 0.606283     ┆ 173  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.643381     ┆ 174  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,286 - INFO - cur close time: 2023-09-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:24,287 - DEBUG - mean expected ret (mean factor): -0.7921582415670748
2024-11-20 23:07:24,291 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,291 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,291 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01686     ┆ 0.06134     ┆ 0.0007959   ┆ … ┆ 0.01636 ┆ null   ┆ null    ┆ 0.1749  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,298 - DEBUG - update position: 2023-09-06T23:59:59.999 === diff_trading_value: 238764.11012577644 == cash: 160833.77131050013 
2024-11-20 23:07:24,300 - INFO - pnl: 2023-09-06T23:59:59.999 160833.77131050013 === 0.613%
2024-11-20 23:07:24,304 - DEBUG - cur time: 2023-09-07T23:59:59.999 == next bar open time: 2023-09-08T00:00:00.000 == close pos time: 2023-09-15T00:00:00.000
2024-11-20 23:07:24,305 - INFO - pnl: 2023-09-07T23:59:59.999 162334.1643682292 === 0.933%
2024-11-20 23:07:24,308 - DEBUG - cur time: 2023-09-08T23:59:59.999 == next bar open time: 2023-09-09T00:00:00.000 == close pos time: 2023-09-16T00:00:00.000
2024-11-20 23:07:24,309 - INFO - pnl: 2023-09-08T23:59:59.999 162870.9035081539 === 0.331%
2024-11-20 23:07:24,311 - DEBUG - cur time: 2023-09-09T23:59:59.999 == next bar open time: 2023-09-10T00:00:00.000 == close pos time: 2023-09-17T00:00:00.000
2024-11-20 23:07:24,313 - INFO - pnl: 2023-09-09T23:59:59.999 164683.08032858226 === 1.113%
2024-11-20 23:07:24,315 - DEBUG - cur time: 2023-09-10T23:59:59.999 == next bar open time: 2023-09-11T00:00:00.000 == close pos time: 2023-09-18T00:00:00.000
2024-11-20 23:07:24,317 - INFO - pnl: 2023-09-10T23:59:59.999 164091.08112623982 === -0.359%
2024-11-20 23:07:24,320 - DEBUG - cur time: 2023-09-11T23:59:59.999 == next bar open time: 2023-09-12T00:00:00.000 == close pos time: 2023-09-19T00:00:00.000
2024-11-20 23:07:24,321 - INFO - pnl: 2023-09-11T23:59:59.999 163664.16615179493 === -0.260%
2024-11-20 23:07:24,324 - DEBUG - cur time: 2023-09-12T23:59:59.999 == next bar open time: 2023-09-13T00:00:00.000 == close pos time: 2023-09-20T00:00:00.000
2024-11-20 23:07:24,326 - INFO - pnl: 2023-09-12T23:59:59.999 164315.34182173482 === 0.398%
2024-11-20 23:07:24,328 - DEBUG - cur time: 2023-09-13T23:59:59.999 == next bar open time: 2023-09-14T00:00:00.000 == close pos time: 2023-09-21T00:00:00.000
2024-11-20 23:07:24,337 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WAVESUSDT    ┆ -1.75698     ┆ 0    ┆ 175          │
│ UNFIUSDT     ┆ -1.683319    ┆ 1    ┆ 174          │
│ PERPUSDT     ┆ -1.64496     ┆ 2    ┆ 173          │
│ EDUUSDT      ┆ -1.595773    ┆ 3    ┆ 172          │
│ FOOTBALLUSDT ┆ -1.580542    ┆ 4    ┆ 171          │
│ INJUSDT      ┆ -1.574567    ┆ 5    ┆ 170          │
│ 1000PEPEUSDT ┆ -1.557682    ┆ 6    ┆ 169          │
│ XVSUSDT      ┆ -1.521949    ┆ 7    ┆ 168          │
│ TRBUSDT      ┆ -1.5022      ┆ 8    ┆ 167          │
│ SUIUSDT      ┆ -1.474895    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RSRUSDT      ┆ -0.142814    ┆ 166  ┆ 9            │
│ ZRXUSDT      ┆ -0.089014    ┆ 167  ┆ 8            │
│ ICXUSDT      ┆ -0.001356    ┆ 168  ┆ 7            │
│ QNTUSDT      ┆ 0.000425     ┆ 169  ┆ 6            │
│ CVXUSDT      ┆ 0.066087     ┆ 170  ┆ 5            │
│ CKBUSDT      ┆ 0.075793     ┆ 171  ┆ 4            │
│ RVNUSDT      ┆ 0.217204     ┆ 172  ┆ 3            │
│ DGBUSDT      ┆ 0.632929     ┆ 173  ┆ 2            │
│ DEFIUSDT     ┆ 1.108422     ┆ 174  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.710425     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,343 - INFO - cur close time: 2023-09-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:24,343 - DEBUG - mean expected ret (mean factor): -0.8021154590504893
2024-11-20 23:07:24,348 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,348 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,348 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01595     ┆ 0.05782     ┆ 0.0006739   ┆ … ┆ 0.01593 ┆ null   ┆ null    ┆ 0.1735  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,357 - DEBUG - update position: 2023-09-13T23:59:59.999 === diff_trading_value: 289273.1886439632 == cash: 164896.3009156554 
2024-11-20 23:07:24,358 - INFO - pnl: 2023-09-13T23:59:59.999 164896.3009156554 === 0.354%
2024-11-20 23:07:24,361 - DEBUG - cur time: 2023-09-14T23:59:59.999 == next bar open time: 2023-09-15T00:00:00.000 == close pos time: 2023-09-22T00:00:00.000
2024-11-20 23:07:24,362 - INFO - pnl: 2023-09-14T23:59:59.999 165422.6767526608 === 0.319%
2024-11-20 23:07:24,366 - DEBUG - cur time: 2023-09-15T23:59:59.999 == next bar open time: 2023-09-16T00:00:00.000 == close pos time: 2023-09-23T00:00:00.000
2024-11-20 23:07:24,367 - INFO - pnl: 2023-09-15T23:59:59.999 164634.38335295906 === -0.477%
2024-11-20 23:07:24,370 - DEBUG - cur time: 2023-09-16T23:59:59.999 == next bar open time: 2023-09-17T00:00:00.000 == close pos time: 2023-09-24T00:00:00.000
2024-11-20 23:07:24,371 - INFO - pnl: 2023-09-16T23:59:59.999 164080.6646654667 === -0.336%
2024-11-20 23:07:24,375 - DEBUG - cur time: 2023-09-17T23:59:59.999 == next bar open time: 2023-09-18T00:00:00.000 == close pos time: 2023-09-25T00:00:00.000
2024-11-20 23:07:24,376 - INFO - pnl: 2023-09-17T23:59:59.999 168698.43876463367 === 2.814%
2024-11-20 23:07:24,379 - DEBUG - cur time: 2023-09-18T23:59:59.999 == next bar open time: 2023-09-19T00:00:00.000 == close pos time: 2023-09-26T00:00:00.000
2024-11-20 23:07:24,380 - INFO - pnl: 2023-09-18T23:59:59.999 167727.0980811302 === -0.576%
2024-11-20 23:07:24,383 - DEBUG - cur time: 2023-09-19T23:59:59.999 == next bar open time: 2023-09-20T00:00:00.000 == close pos time: 2023-09-27T00:00:00.000
2024-11-20 23:07:24,384 - INFO - pnl: 2023-09-19T23:59:59.999 164394.78120522288 === -1.987%
2024-11-20 23:07:24,386 - DEBUG - cur time: 2023-09-20T23:59:59.999 == next bar open time: 2023-09-21T00:00:00.000 == close pos time: 2023-09-28T00:00:00.000
2024-11-20 23:07:24,395 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT      ┆ -2.14324     ┆ 0    ┆ 175          │
│ RADUSDT      ┆ -1.854767    ┆ 1    ┆ 174          │
│ FOOTBALLUSDT ┆ -1.826551    ┆ 2    ┆ 173          │
│ IDUSDT       ┆ -1.697371    ┆ 3    ┆ 172          │
│ RDNTUSDT     ┆ -1.650001    ┆ 4    ┆ 171          │
│ MTLUSDT      ┆ -1.6432      ┆ 5    ┆ 170          │
│ PERPUSDT     ┆ -1.593395    ┆ 6    ┆ 169          │
│ 1000PEPEUSDT ┆ -1.584123    ┆ 7    ┆ 168          │
│ EDUUSDT      ┆ -1.527199    ┆ 8    ┆ 167          │
│ QNTUSDT      ┆ -1.515059    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ KSMUSDT      ┆ -0.114425    ┆ 166  ┆ 9            │
│ FXSUSDT      ┆ -0.061161    ┆ 167  ┆ 8            │
│ CTKUSDT      ┆ -0.024662    ┆ 168  ┆ 7            │
│ YFIUSDT      ┆ 0.119054     ┆ 169  ┆ 6            │
│ CVXUSDT      ┆ 0.20331      ┆ 170  ┆ 5            │
│ SUSHIUSDT    ┆ 0.209759     ┆ 171  ┆ 4            │
│ CKBUSDT      ┆ 0.245557     ┆ 172  ┆ 3            │
│ DGBUSDT      ┆ 0.403765     ┆ 173  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.895174     ┆ 174  ┆ 1            │
│ DEFIUSDT     ┆ 1.225227     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,401 - WARNING - 2023-09-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:24,401 - INFO - cur close time: 2023-09-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:24,401 - DEBUG - mean expected ret (mean factor): -0.7872366501715753
2024-11-20 23:07:24,407 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,407 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,407 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01581     ┆ 0.05775     ┆ 0.0006283   ┆ … ┆ 0.01659 ┆ null   ┆ null    ┆ 0.1839  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,413 - DEBUG - update position: 2023-09-20T23:59:59.999 === diff_trading_value: 199945.40629515186 == cash: 164763.08330503516 
2024-11-20 23:07:24,414 - INFO - pnl: 2023-09-20T23:59:59.999 164763.08330503516 === 0.224%
2024-11-20 23:07:24,417 - DEBUG - cur time: 2023-09-21T23:59:59.999 == next bar open time: 2023-09-22T00:00:00.000 == close pos time: 2023-09-29T00:00:00.000
2024-11-20 23:07:24,418 - INFO - pnl: 2023-09-21T23:59:59.999 167064.83363837335 === 1.397%
2024-11-20 23:07:24,421 - DEBUG - cur time: 2023-09-22T23:59:59.999 == next bar open time: 2023-09-23T00:00:00.000 == close pos time: 2023-09-30T00:00:00.000
2024-11-20 23:07:24,423 - INFO - pnl: 2023-09-22T23:59:59.999 165656.02777019498 === -0.843%
2024-11-20 23:07:24,426 - DEBUG - cur time: 2023-09-23T23:59:59.999 == next bar open time: 2023-09-24T00:00:00.000 == close pos time: 2023-10-01T00:00:00.000
2024-11-20 23:07:24,427 - INFO - pnl: 2023-09-23T23:59:59.999 165695.67381149938 === 0.024%
2024-11-20 23:07:24,431 - DEBUG - cur time: 2023-09-24T23:59:59.999 == next bar open time: 2023-09-25T00:00:00.000 == close pos time: 2023-10-02T00:00:00.000
2024-11-20 23:07:24,433 - INFO - pnl: 2023-09-24T23:59:59.999 165036.02884001314 === -0.398%
2024-11-20 23:07:24,438 - DEBUG - cur time: 2023-09-25T23:59:59.999 == next bar open time: 2023-09-26T00:00:00.000 == close pos time: 2023-10-03T00:00:00.000
2024-11-20 23:07:24,440 - INFO - pnl: 2023-09-25T23:59:59.999 165507.29983874637 === 0.286%
2024-11-20 23:07:24,443 - DEBUG - cur time: 2023-09-26T23:59:59.999 == next bar open time: 2023-09-27T00:00:00.000 == close pos time: 2023-10-04T00:00:00.000
2024-11-20 23:07:24,445 - INFO - pnl: 2023-09-26T23:59:59.999 163461.6056376756 === -1.236%
2024-11-20 23:07:24,448 - DEBUG - cur time: 2023-09-27T23:59:59.999 == next bar open time: 2023-09-28T00:00:00.000 == close pos time: 2023-10-05T00:00:00.000
2024-11-20 23:07:24,456 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ FILUSDT      ┆ -1.948125    ┆ 0    ┆ 175          │
│ XVSUSDT      ┆ -1.874995    ┆ 1    ┆ 174          │
│ TRBUSDT      ┆ -1.746109    ┆ 2    ┆ 173          │
│ MKRUSDT      ┆ -1.731965    ┆ 3    ┆ 172          │
│ APTUSDT      ┆ -1.698553    ┆ 4    ┆ 171          │
│ TOMOUSDT     ┆ -1.635505    ┆ 5    ┆ 170          │
│ SUIUSDT      ┆ -1.625703    ┆ 6    ┆ 169          │
│ ONTUSDT      ┆ -1.511994    ┆ 7    ┆ 168          │
│ IDUSDT       ┆ -1.495072    ┆ 8    ┆ 167          │
│ EDUUSDT      ┆ -1.48305     ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TLMUSDT      ┆ 0.004618     ┆ 166  ┆ 9            │
│ DENTUSDT     ┆ 0.008983     ┆ 167  ┆ 8            │
│ ZECUSDT      ┆ 0.027978     ┆ 168  ┆ 7            │
│ QNTUSDT      ┆ 0.029549     ┆ 169  ┆ 6            │
│ TUSDT        ┆ 0.151437     ┆ 170  ┆ 5            │
│ ALICEUSDT    ┆ 0.171818     ┆ 171  ┆ 4            │
│ CKBUSDT      ┆ 0.34504      ┆ 172  ┆ 3            │
│ DEFIUSDT     ┆ 0.493119     ┆ 173  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.698        ┆ 174  ┆ 1            │
│ DGBUSDT      ┆ 0.985983     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,463 - INFO - cur close time: 2023-09-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:24,464 - DEBUG - mean expected ret (mean factor): -0.7916459754394296
2024-11-20 23:07:24,468 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,468 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,469 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01564     ┆ 0.06518     ┆ 0.0007353   ┆ … ┆ 0.01676 ┆ null   ┆ null    ┆ 0.1848  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,474 - DEBUG - update position: 2023-09-27T23:59:59.999 === diff_trading_value: 238710.84708972723 == cash: 158976.58979359886 
2024-11-20 23:07:24,476 - INFO - pnl: 2023-09-27T23:59:59.999 158976.58979359886 === -2.744%
2024-11-20 23:07:24,479 - DEBUG - cur time: 2023-09-28T23:59:59.999 == next bar open time: 2023-09-29T00:00:00.000 == close pos time: 2023-10-06T00:00:00.000
2024-11-20 23:07:24,480 - INFO - pnl: 2023-09-28T23:59:59.999 161385.38720982708 === 1.515%
2024-11-20 23:07:24,484 - DEBUG - cur time: 2023-09-29T23:59:59.999 == next bar open time: 2023-09-30T00:00:00.000 == close pos time: 2023-10-07T00:00:00.000
2024-11-20 23:07:24,485 - INFO - pnl: 2023-09-29T23:59:59.999 160128.77120153565 === -0.779%
2024-11-20 23:07:24,488 - DEBUG - cur time: 2023-09-30T23:59:59.999 == next bar open time: 2023-10-01T00:00:00.000 == close pos time: 2023-10-08T00:00:00.000
2024-11-20 23:07:24,490 - INFO - pnl: 2023-09-30T23:59:59.999 160222.80922949794 === 0.059%
2024-11-20 23:07:24,493 - DEBUG - cur time: 2023-10-01T23:59:59.999 == next bar open time: 2023-10-02T00:00:00.000 == close pos time: 2023-10-09T00:00:00.000
2024-11-20 23:07:24,495 - INFO - pnl: 2023-10-01T23:59:59.999 160682.14852290493 === 0.287%
2024-11-20 23:07:24,499 - DEBUG - cur time: 2023-10-02T23:59:59.999 == next bar open time: 2023-10-03T00:00:00.000 == close pos time: 2023-10-10T00:00:00.000
2024-11-20 23:07:24,501 - INFO - pnl: 2023-10-02T23:59:59.999 158954.0594036945 === -1.075%
2024-11-20 23:07:24,504 - DEBUG - cur time: 2023-10-03T23:59:59.999 == next bar open time: 2023-10-04T00:00:00.000 == close pos time: 2023-10-11T00:00:00.000
2024-11-20 23:07:24,506 - INFO - pnl: 2023-10-03T23:59:59.999 160693.5353050649 === 1.094%
2024-11-20 23:07:24,509 - DEBUG - cur time: 2023-10-04T23:59:59.999 == next bar open time: 2023-10-05T00:00:00.000 == close pos time: 2023-10-12T00:00:00.000
2024-11-20 23:07:24,518 - DEBUG - sorted_long_factors: shape: (177, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -1.831454    ┆ 0    ┆ 176          │
│ XVSUSDT      ┆ -1.73725     ┆ 1    ┆ 175          │
│ XMRUSDT      ┆ -1.659273    ┆ 2    ┆ 174          │
│ FLMUSDT      ┆ -1.599124    ┆ 3    ┆ 173          │
│ WAVESUSDT    ┆ -1.550858    ┆ 4    ┆ 172          │
│ TOMOUSDT     ┆ -1.523351    ┆ 5    ┆ 171          │
│ APTUSDT      ┆ -1.49522     ┆ 6    ┆ 170          │
│ SUIUSDT      ┆ -1.493305    ┆ 7    ┆ 169          │
│ DYDXUSDT     ┆ -1.489416    ┆ 8    ┆ 168          │
│ RUNEUSDT     ┆ -1.489193    ┆ 9    ┆ 167          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ZENUSDT      ┆ 0.016132     ┆ 167  ┆ 9            │
│ DENTUSDT     ┆ 0.05842      ┆ 168  ┆ 8            │
│ ASTRUSDT     ┆ 0.24921      ┆ 169  ┆ 7            │
│ CKBUSDT      ┆ 0.343464     ┆ 170  ┆ 6            │
│ SKLUSDT      ┆ 0.352583     ┆ 171  ┆ 5            │
│ CTKUSDT      ┆ 0.55053      ┆ 172  ┆ 4            │
│ DGBUSDT      ┆ 0.555526     ┆ 173  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.571149     ┆ 174  ┆ 2            │
│ DEFIUSDT     ┆ 0.958018     ┆ 175  ┆ 1            │
│ BNXUSDT      ┆ 1.198559     ┆ 176  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,525 - WARNING - 2023-10-04T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:24,525 - INFO - cur close time: 2023-10-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:24,525 - DEBUG - mean expected ret (mean factor): -0.7882489200634494
2024-11-20 23:07:24,529 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,529 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,529 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01768     ┆ 0.05889     ┆ 0.0007176   ┆ … ┆ 0.01673 ┆ null   ┆ null    ┆ 0.1829  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,537 - DEBUG - update position: 2023-10-04T23:59:59.999 === diff_trading_value: 222235.70700797252 == cash: 159444.85675708705 
2024-11-20 23:07:24,538 - INFO - pnl: 2023-10-04T23:59:59.999 159444.85675708705 === -0.777%
2024-11-20 23:07:24,542 - DEBUG - cur time: 2023-10-05T23:59:59.999 == next bar open time: 2023-10-06T00:00:00.000 == close pos time: 2023-10-13T00:00:00.000
2024-11-20 23:07:24,543 - INFO - pnl: 2023-10-05T23:59:59.999 159394.86854514558 === -0.031%
2024-11-20 23:07:24,547 - DEBUG - cur time: 2023-10-06T23:59:59.999 == next bar open time: 2023-10-07T00:00:00.000 == close pos time: 2023-10-14T00:00:00.000
2024-11-20 23:07:24,549 - INFO - pnl: 2023-10-06T23:59:59.999 162085.26329255206 === 1.688%
2024-11-20 23:07:24,551 - DEBUG - cur time: 2023-10-07T23:59:59.999 == next bar open time: 2023-10-08T00:00:00.000 == close pos time: 2023-10-15T00:00:00.000
2024-11-20 23:07:24,554 - INFO - pnl: 2023-10-07T23:59:59.999 160873.23014025146 === -0.748%
2024-11-20 23:07:24,556 - DEBUG - cur time: 2023-10-08T23:59:59.999 == next bar open time: 2023-10-09T00:00:00.000 == close pos time: 2023-10-16T00:00:00.000
2024-11-20 23:07:24,558 - INFO - pnl: 2023-10-08T23:59:59.999 162906.7213724121 === 1.264%
2024-11-20 23:07:24,561 - DEBUG - cur time: 2023-10-09T23:59:59.999 == next bar open time: 2023-10-10T00:00:00.000 == close pos time: 2023-10-17T00:00:00.000
2024-11-20 23:07:24,563 - INFO - pnl: 2023-10-09T23:59:59.999 162757.2154004365 === -0.092%
2024-11-20 23:07:24,566 - DEBUG - cur time: 2023-10-10T23:59:59.999 == next bar open time: 2023-10-11T00:00:00.000 == close pos time: 2023-10-18T00:00:00.000
2024-11-20 23:07:24,568 - INFO - pnl: 2023-10-10T23:59:59.999 163103.10094914422 === 0.213%
2024-11-20 23:07:24,571 - DEBUG - cur time: 2023-10-11T23:59:59.999 == next bar open time: 2023-10-12T00:00:00.000 == close pos time: 2023-10-19T00:00:00.000
2024-11-20 23:07:24,578 - DEBUG - sorted_long_factors: shape: (179, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -2.134093    ┆ 0    ┆ 178          │
│ TOMOUSDT     ┆ -1.694125    ┆ 1    ┆ 177          │
│ AMBUSDT      ┆ -1.644293    ┆ 2    ┆ 176          │
│ XMRUSDT      ┆ -1.637185    ┆ 3    ┆ 175          │
│ SUIUSDT      ┆ -1.588882    ┆ 4    ┆ 174          │
│ API3USDT     ┆ -1.563754    ┆ 5    ┆ 173          │
│ 1000PEPEUSDT ┆ -1.549988    ┆ 6    ┆ 172          │
│ LQTYUSDT     ┆ -1.528012    ┆ 7    ┆ 171          │
│ JOEUSDT      ┆ -1.527221    ┆ 8    ┆ 170          │
│ UNFIUSDT     ┆ -1.513363    ┆ 9    ┆ 169          │
│ …            ┆ …            ┆ …    ┆ …            │
│ MTLUSDT      ┆ 0.052278     ┆ 169  ┆ 9            │
│ SSVUSDT      ┆ 0.069115     ┆ 170  ┆ 8            │
│ ZECUSDT      ┆ 0.092941     ┆ 171  ┆ 7            │
│ RVNUSDT      ┆ 0.109219     ┆ 172  ┆ 6            │
│ DGBUSDT      ┆ 0.128541     ┆ 173  ┆ 5            │
│ ZENUSDT      ┆ 0.333557     ┆ 174  ┆ 4            │
│ CKBUSDT      ┆ 0.364381     ┆ 175  ┆ 3            │
│ DEFIUSDT     ┆ 0.58301      ┆ 176  ┆ 2            │
│ SKLUSDT      ┆ 0.602197     ┆ 177  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.23499      ┆ 178  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,585 - WARNING - 2023-10-11T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:24,585 - INFO - cur close time: 2023-10-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:24,585 - DEBUG - mean expected ret (mean factor): -0.7924695082868332
2024-11-20 23:07:24,590 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,590 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,590 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01678     ┆ 0.05651     ┆ 0.0006355   ┆ … ┆ 0.01586 ┆ null   ┆ null    ┆ 0.1931  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,598 - DEBUG - update position: 2023-10-11T23:59:59.999 === diff_trading_value: 217687.2441146911 == cash: 163622.67340339217 
2024-11-20 23:07:24,600 - INFO - pnl: 2023-10-11T23:59:59.999 163622.67340339217 === 0.319%
2024-11-20 23:07:24,604 - DEBUG - cur time: 2023-10-12T23:59:59.999 == next bar open time: 2023-10-13T00:00:00.000 == close pos time: 2023-10-20T00:00:00.000
2024-11-20 23:07:24,605 - INFO - pnl: 2023-10-12T23:59:59.999 165931.01771401835 === 1.411%
2024-11-20 23:07:24,608 - DEBUG - cur time: 2023-10-13T23:59:59.999 == next bar open time: 2023-10-14T00:00:00.000 == close pos time: 2023-10-21T00:00:00.000
2024-11-20 23:07:24,609 - INFO - pnl: 2023-10-13T23:59:59.999 166067.74399531708 === 0.082%
2024-11-20 23:07:24,613 - DEBUG - cur time: 2023-10-14T23:59:59.999 == next bar open time: 2023-10-15T00:00:00.000 == close pos time: 2023-10-22T00:00:00.000
2024-11-20 23:07:24,614 - INFO - pnl: 2023-10-14T23:59:59.999 166038.73594628373 === -0.017%
2024-11-20 23:07:24,617 - DEBUG - cur time: 2023-10-15T23:59:59.999 == next bar open time: 2023-10-16T00:00:00.000 == close pos time: 2023-10-23T00:00:00.000
2024-11-20 23:07:24,618 - INFO - pnl: 2023-10-15T23:59:59.999 165780.61298273655 === -0.155%
2024-11-20 23:07:24,621 - DEBUG - cur time: 2023-10-16T23:59:59.999 == next bar open time: 2023-10-17T00:00:00.000 == close pos time: 2023-10-24T00:00:00.000
2024-11-20 23:07:24,623 - INFO - pnl: 2023-10-16T23:59:59.999 166059.98308357707 === 0.169%
2024-11-20 23:07:24,626 - DEBUG - cur time: 2023-10-17T23:59:59.999 == next bar open time: 2023-10-18T00:00:00.000 == close pos time: 2023-10-25T00:00:00.000
2024-11-20 23:07:24,627 - INFO - pnl: 2023-10-17T23:59:59.999 165920.6397154938 === -0.084%
2024-11-20 23:07:24,630 - DEBUG - cur time: 2023-10-18T23:59:59.999 == next bar open time: 2023-10-19T00:00:00.000 == close pos time: 2023-10-26T00:00:00.000
2024-11-20 23:07:24,639 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ EGLDUSDT     ┆ -1.943567    ┆ 0    ┆ 179          │
│ DYDXUSDT     ┆ -1.889953    ┆ 1    ┆ 178          │
│ APEUSDT      ┆ -1.775057    ┆ 2    ┆ 177          │
│ API3USDT     ┆ -1.653549    ┆ 3    ┆ 176          │
│ TRBUSDT      ┆ -1.62995     ┆ 4    ┆ 175          │
│ SUIUSDT      ┆ -1.598141    ┆ 5    ┆ 174          │
│ MASKUSDT     ┆ -1.592833    ┆ 6    ┆ 173          │
│ FILUSDT      ┆ -1.592326    ┆ 7    ┆ 172          │
│ RUNEUSDT     ┆ -1.577654    ┆ 8    ┆ 171          │
│ TOMOUSDT     ┆ -1.490292    ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COMBOUSDT    ┆ -0.026256    ┆ 170  ┆ 9            │
│ FOOTBALLUSDT ┆ 0.016496     ┆ 171  ┆ 8            │
│ CTKUSDT      ┆ 0.10409      ┆ 172  ┆ 7            │
│ CVXUSDT      ┆ 0.127151     ┆ 173  ┆ 6            │
│ CKBUSDT      ┆ 0.190336     ┆ 174  ┆ 5            │
│ RVNUSDT      ┆ 0.21486      ┆ 175  ┆ 4            │
│ DGBUSDT      ┆ 0.302892     ┆ 176  ┆ 3            │
│ TLMUSDT      ┆ 0.541859     ┆ 177  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.620724     ┆ 178  ┆ 1            │
│ DEFIUSDT     ┆ 0.767625     ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,645 - WARNING - 2023-10-18T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:24,645 - INFO - cur close time: 2023-10-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:24,645 - DEBUG - mean expected ret (mean factor): -0.8065746174497297
2024-11-20 23:07:24,650 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,650 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,650 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01836     ┆ 0.05533     ┆ 0.0006306   ┆ … ┆ 0.01656 ┆ null   ┆ null    ┆ 0.2276  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,657 - DEBUG - update position: 2023-10-18T23:59:59.999 === diff_trading_value: 198543.818867901 == cash: 165828.99886700278 
2024-11-20 23:07:24,659 - INFO - pnl: 2023-10-18T23:59:59.999 165828.99886700278 === -0.055%
2024-11-20 23:07:24,662 - DEBUG - cur time: 2023-10-19T23:59:59.999 == next bar open time: 2023-10-20T00:00:00.000 == close pos time: 2023-10-27T00:00:00.000
2024-11-20 23:07:24,663 - INFO - pnl: 2023-10-19T23:59:59.999 166984.15108564845 === 0.697%
2024-11-20 23:07:24,666 - DEBUG - cur time: 2023-10-20T23:59:59.999 == next bar open time: 2023-10-21T00:00:00.000 == close pos time: 2023-10-28T00:00:00.000
2024-11-20 23:07:24,667 - INFO - pnl: 2023-10-20T23:59:59.999 164833.62380635063 === -1.288%
2024-11-20 23:07:24,670 - DEBUG - cur time: 2023-10-21T23:59:59.999 == next bar open time: 2023-10-22T00:00:00.000 == close pos time: 2023-10-29T00:00:00.000
2024-11-20 23:07:24,671 - INFO - pnl: 2023-10-21T23:59:59.999 164975.97377906207 === 0.086%
2024-11-20 23:07:24,674 - DEBUG - cur time: 2023-10-22T23:59:59.999 == next bar open time: 2023-10-23T00:00:00.000 == close pos time: 2023-10-30T00:00:00.000
2024-11-20 23:07:24,676 - INFO - pnl: 2023-10-22T23:59:59.999 164209.94320224682 === -0.464%
2024-11-20 23:07:24,679 - DEBUG - cur time: 2023-10-23T23:59:59.999 == next bar open time: 2023-10-24T00:00:00.000 == close pos time: 2023-10-31T00:00:00.000
2024-11-20 23:07:24,680 - INFO - pnl: 2023-10-23T23:59:59.999 159216.26769401852 === -3.041%
2024-11-20 23:07:24,683 - DEBUG - cur time: 2023-10-24T23:59:59.999 == next bar open time: 2023-10-25T00:00:00.000 == close pos time: 2023-11-01T00:00:00.000
2024-11-20 23:07:24,684 - INFO - pnl: 2023-10-24T23:59:59.999 159123.2132755679 === -0.058%
2024-11-20 23:07:24,687 - DEBUG - cur time: 2023-10-25T23:59:59.999 == next bar open time: 2023-10-26T00:00:00.000 == close pos time: 2023-11-02T00:00:00.000
2024-11-20 23:07:24,694 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SUIUSDT      ┆ -1.76515     ┆ 0    ┆ 179          │
│ UMAUSDT      ┆ -1.603203    ┆ 1    ┆ 178          │
│ MASKUSDT     ┆ -1.53129     ┆ 2    ┆ 177          │
│ ATOMUSDT     ┆ -1.491261    ┆ 3    ┆ 176          │
│ XMRUSDT      ┆ -1.490345    ┆ 4    ┆ 175          │
│ AXSUSDT      ┆ -1.474408    ┆ 5    ┆ 174          │
│ LPTUSDT      ┆ -1.4551      ┆ 6    ┆ 173          │
│ LDOUSDT      ┆ -1.453422    ┆ 7    ┆ 172          │
│ MATICUSDT    ┆ -1.444162    ┆ 8    ┆ 171          │
│ DYDXUSDT     ┆ -1.438301    ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ONEUSDT      ┆ 0.018654     ┆ 170  ┆ 9            │
│ IDEXUSDT     ┆ 0.043309     ┆ 171  ┆ 8            │
│ COMBOUSDT    ┆ 0.138293     ┆ 172  ┆ 7            │
│ RVNUSDT      ┆ 0.152827     ┆ 173  ┆ 6            │
│ DGBUSDT      ┆ 0.23523      ┆ 174  ┆ 5            │
│ SKLUSDT      ┆ 0.302264     ┆ 175  ┆ 4            │
│ TLMUSDT      ┆ 0.328373     ┆ 176  ┆ 3            │
│ DEFIUSDT     ┆ 0.428377     ┆ 177  ┆ 2            │
│ CKBUSDT      ┆ 0.581025     ┆ 178  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.686951     ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,700 - WARNING - 2023-10-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:24,701 - INFO - cur close time: 2023-10-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:24,701 - DEBUG - mean expected ret (mean factor): -0.7858344439907714
2024-11-20 23:07:24,705 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,705 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,706 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03033     ┆ 0.06509     ┆ 0.0012077   ┆ … ┆ 0.01872 ┆ null   ┆ null    ┆ 0.2509  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,711 - DEBUG - update position: 2023-10-25T23:59:59.999 === diff_trading_value: 237727.02223621012 == cash: 153704.19739515873 
2024-11-20 23:07:24,712 - INFO - pnl: 2023-10-25T23:59:59.999 153704.19739515873 === -3.406%
2024-11-20 23:07:24,715 - DEBUG - cur time: 2023-10-26T23:59:59.999 == next bar open time: 2023-10-27T00:00:00.000 == close pos time: 2023-11-03T00:00:00.000
2024-11-20 23:07:24,716 - INFO - pnl: 2023-10-26T23:59:59.999 153321.8569394184 === -0.249%
2024-11-20 23:07:24,718 - DEBUG - cur time: 2023-10-27T23:59:59.999 == next bar open time: 2023-10-28T00:00:00.000 == close pos time: 2023-11-04T00:00:00.000
2024-11-20 23:07:24,720 - INFO - pnl: 2023-10-27T23:59:59.999 152941.98921998512 === -0.248%
2024-11-20 23:07:24,723 - DEBUG - cur time: 2023-10-28T23:59:59.999 == next bar open time: 2023-10-29T00:00:00.000 == close pos time: 2023-11-05T00:00:00.000
2024-11-20 23:07:24,725 - INFO - pnl: 2023-10-28T23:59:59.999 152785.7758557797 === -0.102%
2024-11-20 23:07:24,728 - DEBUG - cur time: 2023-10-29T23:59:59.999 == next bar open time: 2023-10-30T00:00:00.000 == close pos time: 2023-11-06T00:00:00.000
2024-11-20 23:07:24,729 - INFO - pnl: 2023-10-29T23:59:59.999 152920.28868864148 === 0.088%
2024-11-20 23:07:24,731 - DEBUG - cur time: 2023-10-30T23:59:59.999 == next bar open time: 2023-10-31T00:00:00.000 == close pos time: 2023-11-07T00:00:00.000
2024-11-20 23:07:24,734 - INFO - pnl: 2023-10-30T23:59:59.999 152794.35190834437 === -0.082%
2024-11-20 23:07:24,736 - DEBUG - cur time: 2023-10-31T23:59:59.999 == next bar open time: 2023-11-01T00:00:00.000 == close pos time: 2023-11-08T00:00:00.000
2024-11-20 23:07:24,737 - INFO - pnl: 2023-10-31T23:59:59.999 153355.6751095086 === 0.367%
2024-11-20 23:07:24,740 - DEBUG - cur time: 2023-11-01T23:59:59.999 == next bar open time: 2023-11-02T00:00:00.000 == close pos time: 2023-11-09T00:00:00.000
2024-11-20 23:07:24,748 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RNDRUSDT     ┆ -1.78074     ┆ 0    ┆ 179          │
│ AXSUSDT      ┆ -1.725941    ┆ 1    ┆ 178          │
│ WAVESUSDT    ┆ -1.600937    ┆ 2    ┆ 177          │
│ BNBUSDT      ┆ -1.568208    ┆ 3    ┆ 176          │
│ XRPUSDT      ┆ -1.545284    ┆ 4    ┆ 175          │
│ MAVUSDT      ┆ -1.528948    ┆ 5    ┆ 174          │
│ MKRUSDT      ┆ -1.524312    ┆ 6    ┆ 173          │
│ YFIUSDT      ┆ -1.471652    ┆ 7    ┆ 172          │
│ SUIUSDT      ┆ -1.469247    ┆ 8    ┆ 171          │
│ OPUSDT       ┆ -1.45538     ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COTIUSDT     ┆ -0.025066    ┆ 170  ┆ 9            │
│ CTSIUSDT     ┆ -0.000427    ┆ 171  ┆ 8            │
│ TRUUSDT      ┆ 0.095162     ┆ 172  ┆ 7            │
│ RVNUSDT      ┆ 0.158873     ┆ 173  ┆ 6            │
│ DGBUSDT      ┆ 0.327675     ┆ 174  ┆ 5            │
│ CTKUSDT      ┆ 0.346144     ┆ 175  ┆ 4            │
│ CVXUSDT      ┆ 0.462922     ┆ 176  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.832928     ┆ 177  ┆ 2            │
│ CKBUSDT      ┆ 1.042095     ┆ 178  ┆ 1            │
│ DEFIUSDT     ┆ 1.301717     ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,756 - WARNING - 2023-11-01T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:24,756 - INFO - cur close time: 2023-11-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:24,756 - DEBUG - mean expected ret (mean factor): -0.7682830596900522
2024-11-20 23:07:24,762 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,762 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,762 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03296     ┆ 0.06492     ┆ 0.0011867   ┆ … ┆ 0.0203  ┆ null   ┆ null    ┆ 0.2748  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,770 - DEBUG - update position: 2023-11-01T23:59:59.999 === diff_trading_value: 263505.7047173289 == cash: 154427.29901916962 
2024-11-20 23:07:24,773 - INFO - pnl: 2023-11-01T23:59:59.999 154427.29901916962 === 0.699%
2024-11-20 23:07:24,777 - DEBUG - cur time: 2023-11-02T23:59:59.999 == next bar open time: 2023-11-03T00:00:00.000 == close pos time: 2023-11-10T00:00:00.000
2024-11-20 23:07:24,778 - INFO - pnl: 2023-11-02T23:59:59.999 155242.3562987059 === 0.528%
2024-11-20 23:07:24,783 - DEBUG - cur time: 2023-11-03T23:59:59.999 == next bar open time: 2023-11-04T00:00:00.000 == close pos time: 2023-11-11T00:00:00.000
2024-11-20 23:07:24,784 - INFO - pnl: 2023-11-03T23:59:59.999 157857.47608201523 === 1.685%
2024-11-20 23:07:24,788 - DEBUG - cur time: 2023-11-04T23:59:59.999 == next bar open time: 2023-11-05T00:00:00.000 == close pos time: 2023-11-12T00:00:00.000
2024-11-20 23:07:24,790 - INFO - pnl: 2023-11-04T23:59:59.999 157477.47481969625 === -0.241%
2024-11-20 23:07:24,794 - DEBUG - cur time: 2023-11-05T23:59:59.999 == next bar open time: 2023-11-06T00:00:00.000 == close pos time: 2023-11-13T00:00:00.000
2024-11-20 23:07:24,796 - INFO - pnl: 2023-11-05T23:59:59.999 155698.7234348942 === -1.130%
2024-11-20 23:07:24,800 - DEBUG - cur time: 2023-11-06T23:59:59.999 == next bar open time: 2023-11-07T00:00:00.000 == close pos time: 2023-11-14T00:00:00.000
2024-11-20 23:07:24,801 - INFO - pnl: 2023-11-06T23:59:59.999 155955.34913883705 === 0.165%
2024-11-20 23:07:24,806 - DEBUG - cur time: 2023-11-07T23:59:59.999 == next bar open time: 2023-11-08T00:00:00.000 == close pos time: 2023-11-15T00:00:00.000
2024-11-20 23:07:24,807 - INFO - pnl: 2023-11-07T23:59:59.999 155987.19436617254 === 0.020%
2024-11-20 23:07:24,811 - DEBUG - cur time: 2023-11-08T23:59:59.999 == next bar open time: 2023-11-09T00:00:00.000 == close pos time: 2023-11-16T00:00:00.000
2024-11-20 23:07:24,819 - DEBUG - sorted_long_factors: shape: (183, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT       ┆ -1.983302    ┆ 0    ┆ 182          │
│ WLDUSDT       ┆ -1.678662    ┆ 1    ┆ 181          │
│ SUIUSDT       ┆ -1.636488    ┆ 2    ┆ 180          │
│ COMPUSDT      ┆ -1.588333    ┆ 3    ┆ 179          │
│ NEOUSDT       ┆ -1.57009     ┆ 4    ┆ 178          │
│ ZECUSDT       ┆ -1.536188    ┆ 5    ┆ 177          │
│ SFPUSDT       ┆ -1.483059    ┆ 6    ┆ 176          │
│ 1000FLOKIUSDT ┆ -1.464178    ┆ 7    ┆ 175          │
│ YFIUSDT       ┆ -1.453484    ┆ 8    ┆ 174          │
│ DASHUSDT      ┆ -1.450577    ┆ 9    ┆ 173          │
│ …             ┆ …            ┆ …    ┆ …            │
│ TRUUSDT       ┆ 0.05882      ┆ 173  ┆ 9            │
│ ATAUSDT       ┆ 0.1477       ┆ 174  ┆ 8            │
│ DGBUSDT       ┆ 0.154999     ┆ 175  ┆ 7            │
│ IOTXUSDT      ┆ 0.186111     ┆ 176  ┆ 6            │
│ DENTUSDT      ┆ 0.198531     ┆ 177  ┆ 5            │
│ CTKUSDT       ┆ 0.339622     ┆ 178  ┆ 4            │
│ CKBUSDT       ┆ 0.428565     ┆ 179  ┆ 3            │
│ BTCDOMUSDT    ┆ 0.473451     ┆ 180  ┆ 2            │
│ BLUEBIRDUSDT  ┆ 1.091681     ┆ 181  ┆ 1            │
│ DEFIUSDT      ┆ 1.528506     ┆ 182  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,825 - WARNING - 2023-11-08T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:24,825 - INFO - cur close time: 2023-11-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:24,825 - DEBUG - mean expected ret (mean factor): -0.7677819039794648
2024-11-20 23:07:24,830 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,830 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,830 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03088     ┆ 0.06801     ┆ 0.0011848   ┆ … ┆ 0.02113 ┆ null   ┆ null    ┆ 0.2922  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,838 - DEBUG - update position: 2023-11-08T23:59:59.999 === diff_trading_value: 218720.17538022605 == cash: 156523.8526715624 
2024-11-20 23:07:24,839 - INFO - pnl: 2023-11-08T23:59:59.999 156523.8526715624 === 0.344%
2024-11-20 23:07:24,842 - DEBUG - cur time: 2023-11-09T23:59:59.999 == next bar open time: 2023-11-10T00:00:00.000 == close pos time: 2023-11-17T00:00:00.000
2024-11-20 23:07:24,843 - INFO - pnl: 2023-11-09T23:59:59.999 158500.4022386091 === 1.263%
2024-11-20 23:07:24,846 - DEBUG - cur time: 2023-11-10T23:59:59.999 == next bar open time: 2023-11-11T00:00:00.000 == close pos time: 2023-11-18T00:00:00.000
2024-11-20 23:07:24,848 - INFO - pnl: 2023-11-10T23:59:59.999 156236.06992487877 === -1.429%
2024-11-20 23:07:24,851 - DEBUG - cur time: 2023-11-11T23:59:59.999 == next bar open time: 2023-11-12T00:00:00.000 == close pos time: 2023-11-19T00:00:00.000
2024-11-20 23:07:24,854 - INFO - pnl: 2023-11-11T23:59:59.999 157406.05952828 === 0.749%
2024-11-20 23:07:24,858 - DEBUG - cur time: 2023-11-12T23:59:59.999 == next bar open time: 2023-11-13T00:00:00.000 == close pos time: 2023-11-20T00:00:00.000
2024-11-20 23:07:24,860 - INFO - pnl: 2023-11-12T23:59:59.999 159263.8867370122 === 1.180%
2024-11-20 23:07:24,864 - DEBUG - cur time: 2023-11-13T23:59:59.999 == next bar open time: 2023-11-14T00:00:00.000 == close pos time: 2023-11-21T00:00:00.000
2024-11-20 23:07:24,866 - INFO - pnl: 2023-11-13T23:59:59.999 151573.16231485302 === -4.829%
2024-11-20 23:07:24,869 - DEBUG - cur time: 2023-11-14T23:59:59.999 == next bar open time: 2023-11-15T00:00:00.000 == close pos time: 2023-11-22T00:00:00.000
2024-11-20 23:07:24,870 - INFO - pnl: 2023-11-14T23:59:59.999 150799.52906865638 === -0.510%
2024-11-20 23:07:24,874 - DEBUG - cur time: 2023-11-15T23:59:59.999 == next bar open time: 2023-11-16T00:00:00.000 == close pos time: 2023-11-23T00:00:00.000
2024-11-20 23:07:24,884 - DEBUG - sorted_long_factors: shape: (184, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ATOMUSDT     ┆ -1.899526    ┆ 0    ┆ 183          │
│ FILUSDT      ┆ -1.871127    ┆ 1    ┆ 182          │
│ MKRUSDT      ┆ -1.796654    ┆ 2    ┆ 181          │
│ UNFIUSDT     ┆ -1.712944    ┆ 3    ┆ 180          │
│ ARKMUSDT     ┆ -1.70675     ┆ 4    ┆ 179          │
│ WLDUSDT      ┆ -1.690991    ┆ 5    ┆ 178          │
│ LQTYUSDT     ┆ -1.658194    ┆ 6    ┆ 177          │
│ TRBUSDT      ┆ -1.637143    ┆ 7    ┆ 176          │
│ BNBUSDT      ┆ -1.609497    ┆ 8    ┆ 175          │
│ NEOUSDT      ┆ -1.588509    ┆ 9    ┆ 174          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DENTUSDT     ┆ 0.115587     ┆ 174  ┆ 9            │
│ TRUUSDT      ┆ 0.132025     ┆ 175  ┆ 8            │
│ CKBUSDT      ┆ 0.132493     ┆ 176  ┆ 7            │
│ TLMUSDT      ┆ 0.158883     ┆ 177  ┆ 6            │
│ RVNUSDT      ┆ 0.165549     ┆ 178  ┆ 5            │
│ SKLUSDT      ┆ 0.306766     ┆ 179  ┆ 4            │
│ IDEXUSDT     ┆ 0.318475     ┆ 180  ┆ 3            │
│ DGBUSDT      ┆ 0.360918     ┆ 181  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.050522     ┆ 182  ┆ 1            │
│ DEFIUSDT     ┆ 1.796478     ┆ 183  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,890 - WARNING - 2023-11-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:24,890 - INFO - cur close time: 2023-11-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:24,890 - DEBUG - mean expected ret (mean factor): -0.757890348668419
2024-11-20 23:07:24,895 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,895 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,895 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03618     ┆ 0.08212     ┆ 0.0012561   ┆ … ┆ 0.02206 ┆ null   ┆ null    ┆ 0.5257  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,903 - DEBUG - update position: 2023-11-15T23:59:59.999 === diff_trading_value: 204362.11259864987 == cash: 149252.73518614878 
2024-11-20 23:07:24,905 - INFO - pnl: 2023-11-15T23:59:59.999 149252.73518614878 === -1.026%
2024-11-20 23:07:24,911 - DEBUG - cur time: 2023-11-16T23:59:59.999 == next bar open time: 2023-11-17T00:00:00.000 == close pos time: 2023-11-24T00:00:00.000
2024-11-20 23:07:24,913 - INFO - pnl: 2023-11-16T23:59:59.999 150516.16675629633 === 0.847%
2024-11-20 23:07:24,918 - DEBUG - cur time: 2023-11-17T23:59:59.999 == next bar open time: 2023-11-18T00:00:00.000 == close pos time: 2023-11-25T00:00:00.000
2024-11-20 23:07:24,919 - INFO - pnl: 2023-11-17T23:59:59.999 152122.68434797623 === 1.067%
2024-11-20 23:07:24,925 - DEBUG - cur time: 2023-11-18T23:59:59.999 == next bar open time: 2023-11-19T00:00:00.000 == close pos time: 2023-11-26T00:00:00.000
2024-11-20 23:07:24,927 - INFO - pnl: 2023-11-18T23:59:59.999 150959.607592457 === -0.765%
2024-11-20 23:07:24,933 - DEBUG - cur time: 2023-11-19T23:59:59.999 == next bar open time: 2023-11-20T00:00:00.000 == close pos time: 2023-11-27T00:00:00.000
2024-11-20 23:07:24,934 - INFO - pnl: 2023-11-19T23:59:59.999 151434.09287821036 === 0.314%
2024-11-20 23:07:24,939 - DEBUG - cur time: 2023-11-20T23:59:59.999 == next bar open time: 2023-11-21T00:00:00.000 == close pos time: 2023-11-28T00:00:00.000
2024-11-20 23:07:24,941 - INFO - pnl: 2023-11-20T23:59:59.999 154918.2994135434 === 2.301%
2024-11-20 23:07:24,946 - DEBUG - cur time: 2023-11-21T23:59:59.999 == next bar open time: 2023-11-22T00:00:00.000 == close pos time: 2023-11-29T00:00:00.000
2024-11-20 23:07:24,948 - INFO - pnl: 2023-11-21T23:59:59.999 152284.2556132633 === -1.700%
2024-11-20 23:07:24,953 - DEBUG - cur time: 2023-11-22T23:59:59.999 == next bar open time: 2023-11-23T00:00:00.000 == close pos time: 2023-11-30T00:00:00.000
2024-11-20 23:07:24,964 - DEBUG - sorted_long_factors: shape: (187, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNTUSDT      ┆ -2.176861    ┆ 0    ┆ 186          │
│ YFIUSDT      ┆ -2.052422    ┆ 1    ┆ 185          │
│ MASKUSDT     ┆ -1.875553    ┆ 2    ┆ 184          │
│ BNBUSDT      ┆ -1.822093    ┆ 3    ┆ 183          │
│ NEARUSDT     ┆ -1.767417    ┆ 4    ┆ 182          │
│ MKRUSDT      ┆ -1.719588    ┆ 5    ┆ 181          │
│ SUSHIUSDT    ┆ -1.691342    ┆ 6    ┆ 180          │
│ FILUSDT      ┆ -1.687859    ┆ 7    ┆ 179          │
│ WLDUSDT      ┆ -1.683731    ┆ 8    ┆ 178          │
│ ARKMUSDT     ┆ -1.675665    ┆ 9    ┆ 177          │
│ …            ┆ …            ┆ …    ┆ …            │
│ XVGUSDT      ┆ 0.250832     ┆ 177  ┆ 9            │
│ REEFUSDT     ┆ 0.312352     ┆ 178  ┆ 8            │
│ BLUEBIRDUSDT ┆ 0.380044     ┆ 179  ┆ 7            │
│ DGBUSDT      ┆ 0.395553     ┆ 180  ┆ 6            │
│ DENTUSDT     ┆ 0.40136      ┆ 181  ┆ 5            │
│ SPELLUSDT    ┆ 0.464437     ┆ 182  ┆ 4            │
│ TLMUSDT      ┆ 0.516382     ┆ 183  ┆ 3            │
│ CTKUSDT      ┆ 0.64133      ┆ 184  ┆ 2            │
│ IDEXUSDT     ┆ 1.35642      ┆ 185  ┆ 1            │
│ DEFIUSDT     ┆ 1.463781     ┆ 186  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:24,971 - WARNING - 2023-11-22T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:24,971 - INFO - cur close time: 2023-11-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:24,971 - DEBUG - mean expected ret (mean factor): -0.7601119499172364
2024-11-20 23:07:24,975 - DEBUG - begin to update pos: =========
2024-11-20 23:07:24,976 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,976 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03262     ┆ 0.07446     ┆ 0.0011069   ┆ … ┆ 0.02069 ┆ null   ┆ null    ┆ 0.4045  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:24,982 - DEBUG - update position: 2023-11-22T23:59:59.999 === diff_trading_value: 164540.6635490764 == cash: 150247.60710930053 
2024-11-20 23:07:24,984 - INFO - pnl: 2023-11-22T23:59:59.999 150247.60710930053 === -1.337%
2024-11-20 23:07:24,987 - DEBUG - cur time: 2023-11-23T23:59:59.999 == next bar open time: 2023-11-24T00:00:00.000 == close pos time: 2023-12-01T00:00:00.000
2024-11-20 23:07:24,988 - INFO - pnl: 2023-11-23T23:59:59.999 151652.8926901419 === 0.935%
2024-11-20 23:07:24,992 - DEBUG - cur time: 2023-11-24T23:59:59.999 == next bar open time: 2023-11-25T00:00:00.000 == close pos time: 2023-12-02T00:00:00.000
2024-11-20 23:07:24,993 - INFO - pnl: 2023-11-24T23:59:59.999 153255.0512423303 === 1.056%
2024-11-20 23:07:24,998 - DEBUG - cur time: 2023-11-25T23:59:59.999 == next bar open time: 2023-11-26T00:00:00.000 == close pos time: 2023-12-03T00:00:00.000
2024-11-20 23:07:24,999 - INFO - pnl: 2023-11-25T23:59:59.999 152117.2623834319 === -0.742%
2024-11-20 23:07:25,003 - DEBUG - cur time: 2023-11-26T23:59:59.999 == next bar open time: 2023-11-27T00:00:00.000 == close pos time: 2023-12-04T00:00:00.000
2024-11-20 23:07:25,004 - INFO - pnl: 2023-11-26T23:59:59.999 155957.84592530597 === 2.525%
2024-11-20 23:07:25,008 - DEBUG - cur time: 2023-11-27T23:59:59.999 == next bar open time: 2023-11-28T00:00:00.000 == close pos time: 2023-12-05T00:00:00.000
2024-11-20 23:07:25,009 - INFO - pnl: 2023-11-27T23:59:59.999 155263.2141084226 === -0.445%
2024-11-20 23:07:25,011 - DEBUG - cur time: 2023-11-28T23:59:59.999 == next bar open time: 2023-11-29T00:00:00.000 == close pos time: 2023-12-06T00:00:00.000
2024-11-20 23:07:25,014 - INFO - pnl: 2023-11-28T23:59:59.999 155875.9231544294 === 0.395%
2024-11-20 23:07:25,017 - DEBUG - cur time: 2023-11-29T23:59:59.999 == next bar open time: 2023-11-30T00:00:00.000 == close pos time: 2023-12-07T00:00:00.000
2024-11-20 23:07:25,025 - DEBUG - sorted_long_factors: shape: (188, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SSVUSDT      ┆ -1.85835     ┆ 0    ┆ 187          │
│ MDTUSDT      ┆ -1.777328    ┆ 1    ┆ 186          │
│ BNBUSDT      ┆ -1.696985    ┆ 2    ┆ 185          │
│ MASKUSDT     ┆ -1.678088    ┆ 3    ┆ 184          │
│ BTCDOMUSDT   ┆ -1.585439    ┆ 4    ┆ 183          │
│ STXUSDT      ┆ -1.577348    ┆ 5    ┆ 182          │
│ SEIUSDT      ┆ -1.494205    ┆ 6    ┆ 181          │
│ YGGUSDT      ┆ -1.473268    ┆ 7    ┆ 180          │
│ MATICUSDT    ┆ -1.453577    ┆ 8    ┆ 179          │
│ NEARUSDT     ┆ -1.437166    ┆ 9    ┆ 178          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TUSDT        ┆ 0.090712     ┆ 178  ┆ 9            │
│ BLUEBIRDUSDT ┆ 0.116004     ┆ 179  ┆ 8            │
│ ANTUSDT      ┆ 0.167171     ┆ 180  ┆ 7            │
│ AAVEUSDT     ┆ 0.232989     ┆ 181  ┆ 6            │
│ GMXUSDT      ┆ 0.287674     ┆ 182  ┆ 5            │
│ DGBUSDT      ┆ 0.42761      ┆ 183  ┆ 4            │
│ BALUSDT      ┆ 0.436783     ┆ 184  ┆ 3            │
│ CKBUSDT      ┆ 0.746102     ┆ 185  ┆ 2            │
│ CVXUSDT      ┆ 1.026664     ┆ 186  ┆ 1            │
│ DEFIUSDT     ┆ 2.638733     ┆ 187  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,031 - WARNING - 2023-11-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:25,031 - INFO - cur close time: 2023-11-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:25,031 - DEBUG - mean expected ret (mean factor): -0.7700799793519479
2024-11-20 23:07:25,037 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,037 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,037 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0319      ┆ 0.11634     ┆ 0.0010571   ┆ … ┆ 0.02157 ┆ null   ┆ null    ┆ 0.3965  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,043 - DEBUG - update position: 2023-11-29T23:59:59.999 === diff_trading_value: 260193.891712811 == cash: 156538.3848500618 
2024-11-20 23:07:25,043 - INFO - pnl: 2023-11-29T23:59:59.999 156538.3848500618 === 0.425%
2024-11-20 23:07:25,046 - DEBUG - cur time: 2023-11-30T23:59:59.999 == next bar open time: 2023-12-01T00:00:00.000 == close pos time: 2023-12-08T00:00:00.000
2024-11-20 23:07:25,048 - INFO - pnl: 2023-11-30T23:59:59.999 159128.70491976052 === 1.655%
2024-11-20 23:07:25,051 - DEBUG - cur time: 2023-12-01T23:59:59.999 == next bar open time: 2023-12-02T00:00:00.000 == close pos time: 2023-12-09T00:00:00.000
2024-11-20 23:07:25,053 - INFO - pnl: 2023-12-01T23:59:59.999 158793.72287338437 === -0.211%
2024-11-20 23:07:25,056 - DEBUG - cur time: 2023-12-02T23:59:59.999 == next bar open time: 2023-12-03T00:00:00.000 == close pos time: 2023-12-10T00:00:00.000
2024-11-20 23:07:25,058 - INFO - pnl: 2023-12-02T23:59:59.999 159443.44922762556 === 0.409%
2024-11-20 23:07:25,062 - DEBUG - cur time: 2023-12-03T23:59:59.999 == next bar open time: 2023-12-04T00:00:00.000 == close pos time: 2023-12-11T00:00:00.000
2024-11-20 23:07:25,064 - INFO - pnl: 2023-12-03T23:59:59.999 157827.55996497278 === -1.013%
2024-11-20 23:07:25,068 - DEBUG - cur time: 2023-12-04T23:59:59.999 == next bar open time: 2023-12-05T00:00:00.000 == close pos time: 2023-12-12T00:00:00.000
2024-11-20 23:07:25,069 - INFO - pnl: 2023-12-04T23:59:59.999 154458.8418495162 === -2.134%
2024-11-20 23:07:25,071 - DEBUG - cur time: 2023-12-05T23:59:59.999 == next bar open time: 2023-12-06T00:00:00.000 == close pos time: 2023-12-13T00:00:00.000
2024-11-20 23:07:25,074 - INFO - pnl: 2023-12-05T23:59:59.999 153465.78300132134 === -0.643%
2024-11-20 23:07:25,078 - DEBUG - cur time: 2023-12-06T23:59:59.999 == next bar open time: 2023-12-07T00:00:00.000 == close pos time: 2023-12-14T00:00:00.000
2024-11-20 23:07:25,087 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ NEARUSDT     ┆ -1.7132      ┆ 0    ┆ 188          │
│ MDTUSDT      ┆ -1.711362    ┆ 1    ┆ 187          │
│ WLDUSDT      ┆ -1.640898    ┆ 2    ┆ 186          │
│ CYBERUSDT    ┆ -1.556278    ┆ 3    ┆ 185          │
│ ATOMUSDT     ┆ -1.515136    ┆ 4    ┆ 184          │
│ DOTUSDT      ┆ -1.509462    ┆ 5    ┆ 183          │
│ STORJUSDT    ┆ -1.497148    ┆ 6    ┆ 182          │
│ UNIUSDT      ┆ -1.441468    ┆ 7    ┆ 181          │
│ HIGHUSDT     ┆ -1.440309    ┆ 8    ┆ 180          │
│ AXSUSDT      ┆ -1.400174    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BTCDOMUSDT   ┆ -0.173957    ┆ 179  ┆ 9            │
│ 1000XECUSDT  ┆ -0.111752    ┆ 180  ┆ 8            │
│ CTKUSDT      ┆ 0.035747     ┆ 181  ┆ 7            │
│ ATAUSDT      ┆ 0.050973     ┆ 182  ┆ 6            │
│ FOOTBALLUSDT ┆ 0.137149     ┆ 183  ┆ 5            │
│ CVXUSDT      ┆ 0.151031     ┆ 184  ┆ 4            │
│ DGBUSDT      ┆ 0.248052     ┆ 185  ┆ 3            │
│ CKBUSDT      ┆ 0.590343     ┆ 186  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.213431     ┆ 187  ┆ 1            │
│ DEFIUSDT     ┆ 1.412883     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,094 - WARNING - 2023-12-06T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:25,095 - INFO - cur close time: 2023-12-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:25,095 - DEBUG - mean expected ret (mean factor): -0.7663394479216978
2024-11-20 23:07:25,099 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,100 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,100 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0391      ┆ 0.21772     ┆ 0.0014826   ┆ … ┆ 0.023   ┆ null   ┆ null    ┆ 0.4101  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,106 - DEBUG - update position: 2023-12-06T23:59:59.999 === diff_trading_value: 292427.29191534454 == cash: 156090.73163338407 
2024-11-20 23:07:25,108 - INFO - pnl: 2023-12-06T23:59:59.999 156090.73163338407 === 1.710%
2024-11-20 23:07:25,112 - DEBUG - cur time: 2023-12-07T23:59:59.999 == next bar open time: 2023-12-08T00:00:00.000 == close pos time: 2023-12-15T00:00:00.000
2024-11-20 23:07:25,114 - INFO - pnl: 2023-12-07T23:59:59.999 155998.9095107764 === -0.059%
2024-11-20 23:07:25,119 - DEBUG - cur time: 2023-12-08T23:59:59.999 == next bar open time: 2023-12-09T00:00:00.000 == close pos time: 2023-12-16T00:00:00.000
2024-11-20 23:07:25,121 - INFO - pnl: 2023-12-08T23:59:59.999 153189.81717632315 === -1.801%
2024-11-20 23:07:25,125 - DEBUG - cur time: 2023-12-09T23:59:59.999 == next bar open time: 2023-12-10T00:00:00.000 == close pos time: 2023-12-17T00:00:00.000
2024-11-20 23:07:25,128 - INFO - pnl: 2023-12-09T23:59:59.999 152443.42264691222 === -0.487%
2024-11-20 23:07:25,132 - DEBUG - cur time: 2023-12-10T23:59:59.999 == next bar open time: 2023-12-11T00:00:00.000 == close pos time: 2023-12-18T00:00:00.000
2024-11-20 23:07:25,134 - INFO - pnl: 2023-12-10T23:59:59.999 151407.54109774673 === -0.680%
2024-11-20 23:07:25,138 - DEBUG - cur time: 2023-12-11T23:59:59.999 == next bar open time: 2023-12-12T00:00:00.000 == close pos time: 2023-12-19T00:00:00.000
2024-11-20 23:07:25,139 - INFO - pnl: 2023-12-11T23:59:59.999 154443.0885864247 === 2.005%
2024-11-20 23:07:25,143 - DEBUG - cur time: 2023-12-12T23:59:59.999 == next bar open time: 2023-12-13T00:00:00.000 == close pos time: 2023-12-20T00:00:00.000
2024-11-20 23:07:25,144 - INFO - pnl: 2023-12-12T23:59:59.999 151450.1234009099 === -1.938%
2024-11-20 23:07:25,148 - DEBUG - cur time: 2023-12-13T23:59:59.999 == next bar open time: 2023-12-14T00:00:00.000 == close pos time: 2023-12-21T00:00:00.000
2024-11-20 23:07:25,157 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SNXUSDT      ┆ -1.958891    ┆ 0    ┆ 188          │
│ EGLDUSDT     ┆ -1.756522    ┆ 1    ┆ 187          │
│ UNIUSDT      ┆ -1.745406    ┆ 2    ┆ 186          │
│ SANDUSDT     ┆ -1.719226    ┆ 3    ┆ 185          │
│ WLDUSDT      ┆ -1.698357    ┆ 4    ┆ 184          │
│ CYBERUSDT    ┆ -1.694506    ┆ 5    ┆ 183          │
│ DOTUSDT      ┆ -1.682284    ┆ 6    ┆ 182          │
│ QTUMUSDT     ┆ -1.593916    ┆ 7    ┆ 181          │
│ IMXUSDT      ┆ -1.575285    ┆ 8    ┆ 180          │
│ INJUSDT      ┆ -1.552138    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ALICEUSDT    ┆ -0.037839    ┆ 179  ┆ 9            │
│ RSRUSDT      ┆ -0.036397    ┆ 180  ┆ 8            │
│ RLCUSDT      ┆ -0.001701    ┆ 181  ┆ 7            │
│ ZENUSDT      ┆ 0.011471     ┆ 182  ┆ 6            │
│ TRUUSDT      ┆ 0.098672     ┆ 183  ┆ 5            │
│ CVXUSDT      ┆ 0.363876     ┆ 184  ┆ 4            │
│ CKBUSDT      ┆ 0.460388     ┆ 185  ┆ 3            │
│ DGBUSDT      ┆ 0.480023     ┆ 186  ┆ 2            │
│ DEFIUSDT     ┆ 1.250253     ┆ 187  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.449447     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,165 - WARNING - 2023-12-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:25,165 - INFO - cur close time: 2023-12-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:25,165 - DEBUG - mean expected ret (mean factor): -0.7554551830299927
2024-11-20 23:07:25,169 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,170 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,170 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03893     ┆ 0.17959     ┆ 0.0014164   ┆ … ┆ 0.0239  ┆ null   ┆ null    ┆ 0.3822  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,177 - DEBUG - update position: 2023-12-13T23:59:59.999 === diff_trading_value: 260006.82100310846 == cash: 149514.7705405561 
2024-11-20 23:07:25,178 - INFO - pnl: 2023-12-13T23:59:59.999 149514.7705405561 === -1.278%
2024-11-20 23:07:25,181 - DEBUG - cur time: 2023-12-14T23:59:59.999 == next bar open time: 2023-12-15T00:00:00.000 == close pos time: 2023-12-22T00:00:00.000
2024-11-20 23:07:25,183 - INFO - pnl: 2023-12-14T23:59:59.999 149749.28439152666 === 0.157%
2024-11-20 23:07:25,187 - DEBUG - cur time: 2023-12-15T23:59:59.999 == next bar open time: 2023-12-16T00:00:00.000 == close pos time: 2023-12-23T00:00:00.000
2024-11-20 23:07:25,189 - INFO - pnl: 2023-12-15T23:59:59.999 150968.4845060036 === 0.814%
2024-11-20 23:07:25,193 - DEBUG - cur time: 2023-12-16T23:59:59.999 == next bar open time: 2023-12-17T00:00:00.000 == close pos time: 2023-12-24T00:00:00.000
2024-11-20 23:07:25,194 - INFO - pnl: 2023-12-16T23:59:59.999 146851.60694349802 === -2.727%
2024-11-20 23:07:25,199 - DEBUG - cur time: 2023-12-17T23:59:59.999 == next bar open time: 2023-12-18T00:00:00.000 == close pos time: 2023-12-25T00:00:00.000
2024-11-20 23:07:25,200 - INFO - pnl: 2023-12-17T23:59:59.999 146729.49491219714 === -0.083%
2024-11-20 23:07:25,203 - DEBUG - cur time: 2023-12-18T23:59:59.999 == next bar open time: 2023-12-19T00:00:00.000 == close pos time: 2023-12-26T00:00:00.000
2024-11-20 23:07:25,204 - INFO - pnl: 2023-12-18T23:59:59.999 143503.97018508395 === -2.198%
2024-11-20 23:07:25,208 - DEBUG - cur time: 2023-12-19T23:59:59.999 == next bar open time: 2023-12-20T00:00:00.000 == close pos time: 2023-12-27T00:00:00.000
2024-11-20 23:07:25,210 - INFO - pnl: 2023-12-19T23:59:59.999 144964.7293555597 === 1.018%
2024-11-20 23:07:25,215 - DEBUG - cur time: 2023-12-20T23:59:59.999 == next bar open time: 2023-12-21T00:00:00.000 == close pos time: 2023-12-28T00:00:00.000
2024-11-20 23:07:25,224 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ FILUSDT      ┆ -1.644841    ┆ 0    ┆ 188          │
│ CYBERUSDT    ┆ -1.626535    ┆ 1    ┆ 187          │
│ SEIUSDT      ┆ -1.62325     ┆ 2    ┆ 186          │
│ WAVESUSDT    ┆ -1.576024    ┆ 3    ┆ 185          │
│ XMRUSDT      ┆ -1.536561    ┆ 4    ┆ 184          │
│ YFIUSDT      ┆ -1.487464    ┆ 5    ┆ 183          │
│ MASKUSDT     ┆ -1.470233    ┆ 6    ┆ 182          │
│ STXUSDT      ┆ -1.46997     ┆ 7    ┆ 181          │
│ COMPUSDT     ┆ -1.443405    ┆ 8    ┆ 180          │
│ RUNEUSDT     ┆ -1.43181     ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IDEXUSDT     ┆ 0.187165     ┆ 179  ┆ 9            │
│ TLMUSDT      ┆ 0.249244     ┆ 180  ┆ 8            │
│ SPELLUSDT    ┆ 0.315072     ┆ 181  ┆ 7            │
│ DODOXUSDT    ┆ 0.322118     ┆ 182  ┆ 6            │
│ LEVERUSDT    ┆ 0.356729     ┆ 183  ┆ 5            │
│ XVGUSDT      ┆ 0.425963     ┆ 184  ┆ 4            │
│ TRUUSDT      ┆ 0.477118     ┆ 185  ┆ 3            │
│ DGBUSDT      ┆ 0.919934     ┆ 186  ┆ 2            │
│ CKBUSDT      ┆ 1.031219     ┆ 187  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.03429      ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,231 - WARNING - 2023-12-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:25,231 - INFO - cur close time: 2023-12-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:25,233 - DEBUG - mean expected ret (mean factor): -0.774832041988376
2024-11-20 23:07:25,238 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,238 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,239 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03453     ┆ 0.15645     ┆ 0.0012704   ┆ … ┆ 0.02327 ┆ null   ┆ null    ┆ 0.3811  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,245 - DEBUG - update position: 2023-12-20T23:59:59.999 === diff_trading_value: 299558.0263159661 == cash: 143020.0229198448 
2024-11-20 23:07:25,245 - INFO - pnl: 2023-12-20T23:59:59.999 143020.0229198448 === -1.342%
2024-11-20 23:07:25,249 - DEBUG - cur time: 2023-12-21T23:59:59.999 == next bar open time: 2023-12-22T00:00:00.000 == close pos time: 2023-12-29T00:00:00.000
2024-11-20 23:07:25,250 - INFO - pnl: 2023-12-21T23:59:59.999 144597.79765578898 === 1.103%
2024-11-20 23:07:25,255 - DEBUG - cur time: 2023-12-22T23:59:59.999 == next bar open time: 2023-12-23T00:00:00.000 == close pos time: 2023-12-30T00:00:00.000
2024-11-20 23:07:25,256 - INFO - pnl: 2023-12-22T23:59:59.999 147128.15521801982 === 1.750%
2024-11-20 23:07:25,258 - DEBUG - cur time: 2023-12-23T23:59:59.999 == next bar open time: 2023-12-24T00:00:00.000 == close pos time: 2023-12-31T00:00:00.000
2024-11-20 23:07:25,259 - INFO - pnl: 2023-12-23T23:59:59.999 146465.4361705996 === -0.450%
2024-11-20 23:07:25,262 - DEBUG - cur time: 2023-12-24T23:59:59.999 == next bar open time: 2023-12-25T00:00:00.000 == close pos time: 2024-01-01T00:00:00.000
2024-11-20 23:07:25,264 - INFO - pnl: 2023-12-24T23:59:59.999 150149.1778882114 === 2.515%
2024-11-20 23:07:25,267 - DEBUG - cur time: 2023-12-25T23:59:59.999 == next bar open time: 2023-12-26T00:00:00.000 == close pos time: 2024-01-02T00:00:00.000
2024-11-20 23:07:25,268 - INFO - pnl: 2023-12-25T23:59:59.999 149436.3213133856 === -0.475%
2024-11-20 23:07:25,271 - DEBUG - cur time: 2023-12-26T23:59:59.999 == next bar open time: 2023-12-27T00:00:00.000 == close pos time: 2024-01-03T00:00:00.000
2024-11-20 23:07:25,272 - INFO - pnl: 2023-12-26T23:59:59.999 152442.07575713363 === 2.011%
2024-11-20 23:07:25,276 - DEBUG - cur time: 2023-12-27T23:59:59.999 == next bar open time: 2023-12-28T00:00:00.000 == close pos time: 2024-01-04T00:00:00.000
2024-11-20 23:07:25,285 - DEBUG - sorted_long_factors: shape: (190, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RUNEUSDT     ┆ -1.82157     ┆ 0    ┆ 189          │
│ COMPUSDT     ┆ -1.804574    ┆ 1    ┆ 188          │
│ APEUSDT      ┆ -1.671358    ┆ 2    ┆ 187          │
│ CYBERUSDT    ┆ -1.663906    ┆ 3    ┆ 186          │
│ DYDXUSDT     ┆ -1.649637    ┆ 4    ┆ 185          │
│ ATOMUSDT     ┆ -1.643864    ┆ 5    ┆ 184          │
│ BNBUSDT      ┆ -1.562688    ┆ 6    ┆ 183          │
│ AAVEUSDT     ┆ -1.552344    ┆ 7    ┆ 182          │
│ MATICUSDT    ┆ -1.533934    ┆ 8    ┆ 181          │
│ ENSUSDT      ┆ -1.503526    ┆ 9    ┆ 180          │
│ …            ┆ …            ┆ …    ┆ …            │
│ FOOTBALLUSDT ┆ -0.164978    ┆ 180  ┆ 9            │
│ TLMUSDT      ┆ -0.11532     ┆ 181  ┆ 8            │
│ TUSDT        ┆ -0.102421    ┆ 182  ┆ 7            │
│ CKBUSDT      ┆ -0.069767    ┆ 183  ┆ 6            │
│ COMBOUSDT    ┆ -0.018346    ┆ 184  ┆ 5            │
│ DEFIUSDT     ┆ 0.196992     ┆ 185  ┆ 4            │
│ DGBUSDT      ┆ 0.248707     ┆ 186  ┆ 3            │
│ 1000XECUSDT  ┆ 0.27502      ┆ 187  ┆ 2            │
│ BTCDOMUSDT   ┆ 0.988847     ┆ 188  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.860113     ┆ 189  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,291 - WARNING - 2023-12-27T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:25,291 - INFO - cur close time: 2023-12-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:25,291 - DEBUG - mean expected ret (mean factor): -0.7800996980083481
2024-11-20 23:07:25,296 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,296 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,296 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03709     ┆ 0.14933     ┆ 0.001448    ┆ … ┆ 0.02715 ┆ null   ┆ null    ┆ 0.363   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,302 - DEBUG - update position: 2023-12-27T23:59:59.999 === diff_trading_value: 279852.9240500879 == cash: 151882.62958181367 
2024-11-20 23:07:25,303 - INFO - pnl: 2023-12-27T23:59:59.999 151882.62958181367 === -0.367%
2024-11-20 23:07:25,306 - DEBUG - cur time: 2023-12-28T23:59:59.999 == next bar open time: 2023-12-29T00:00:00.000 == close pos time: 2024-01-05T00:00:00.000
2024-11-20 23:07:25,307 - INFO - pnl: 2023-12-28T23:59:59.999 150524.33276899983 === -0.894%
2024-11-20 23:07:25,311 - DEBUG - cur time: 2023-12-29T23:59:59.999 == next bar open time: 2023-12-30T00:00:00.000 == close pos time: 2024-01-06T00:00:00.000
2024-11-20 23:07:25,312 - INFO - pnl: 2023-12-29T23:59:59.999 151942.74842393238 === 0.942%
2024-11-20 23:07:25,316 - DEBUG - cur time: 2023-12-30T23:59:59.999 == next bar open time: 2023-12-31T00:00:00.000 == close pos time: 2024-01-07T00:00:00.000
2024-11-20 23:07:25,317 - INFO - pnl: 2023-12-30T23:59:59.999 152191.94704158677 === 0.164%
2024-11-20 23:07:25,321 - DEBUG - cur time: 2023-12-31T23:59:59.999 == next bar open time: 2024-01-01T00:00:00.000 == close pos time: 2024-01-08T00:00:00.000
2024-11-20 23:07:25,323 - INFO - pnl: 2023-12-31T23:59:59.999 152877.05937305684 === 0.450%
2024-11-20 23:07:25,328 - DEBUG - cur time: 2024-01-01T23:59:59.999 == next bar open time: 2024-01-02T00:00:00.000 == close pos time: 2024-01-09T00:00:00.000
2024-11-20 23:07:25,330 - INFO - pnl: 2024-01-01T23:59:59.999 151111.59422797384 === -1.155%
2024-11-20 23:07:25,333 - DEBUG - cur time: 2024-01-02T23:59:59.999 == next bar open time: 2024-01-03T00:00:00.000 == close pos time: 2024-01-10T00:00:00.000
2024-11-20 23:07:25,334 - INFO - pnl: 2024-01-02T23:59:59.999 151618.08148913516 === 0.335%
2024-11-20 23:07:25,338 - DEBUG - cur time: 2024-01-03T23:59:59.999 == next bar open time: 2024-01-04T00:00:00.000 == close pos time: 2024-01-11T00:00:00.000
2024-11-20 23:07:25,347 - DEBUG - sorted_long_factors: shape: (191, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CYBERUSDT    ┆ -1.823812    ┆ 0    ┆ 190          │
│ BANDUSDT     ┆ -1.655785    ┆ 1    ┆ 189          │
│ FILUSDT      ┆ -1.637695    ┆ 2    ┆ 188          │
│ ARBUSDT      ┆ -1.596591    ┆ 3    ┆ 187          │
│ WLDUSDT      ┆ -1.549081    ┆ 4    ┆ 186          │
│ RUNEUSDT     ┆ -1.487339    ┆ 5    ┆ 185          │
│ MKRUSDT      ┆ -1.465091    ┆ 6    ┆ 184          │
│ YGGUSDT      ┆ -1.462554    ┆ 7    ┆ 183          │
│ OXTUSDT      ┆ -1.457836    ┆ 8    ┆ 182          │
│ TRBUSDT      ┆ -1.452898    ┆ 9    ┆ 181          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TLMUSDT      ┆ -0.011756    ┆ 181  ┆ 9            │
│ FOOTBALLUSDT ┆ 0.103963     ┆ 182  ┆ 8            │
│ IDEXUSDT     ┆ 0.113179     ┆ 183  ┆ 7            │
│ COMBOUSDT    ┆ 0.141332     ┆ 184  ┆ 6            │
│ DARUSDT      ┆ 0.172523     ┆ 185  ┆ 5            │
│ NKNUSDT      ┆ 0.177393     ┆ 186  ┆ 4            │
│ DGBUSDT      ┆ 0.185295     ┆ 187  ┆ 3            │
│ CVXUSDT      ┆ 0.413564     ┆ 188  ┆ 2            │
│ CKBUSDT      ┆ 0.452409     ┆ 189  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.927347     ┆ 190  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,353 - WARNING - 2024-01-03T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:25,353 - INFO - cur close time: 2024-01-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:25,354 - DEBUG - mean expected ret (mean factor): -0.7926552294718021
2024-11-20 23:07:25,358 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,358 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,358 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03138     ┆ 0.11627     ┆ 0.0011875   ┆ … ┆ 0.02316 ┆ null   ┆ null    ┆ 0.3316  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,364 - DEBUG - update position: 2024-01-03T23:59:59.999 === diff_trading_value: 247205.14571480057 == cash: 149314.0854340954 
2024-11-20 23:07:25,365 - INFO - pnl: 2024-01-03T23:59:59.999 149314.0854340954 === -1.520%
2024-11-20 23:07:25,369 - DEBUG - cur time: 2024-01-04T23:59:59.999 == next bar open time: 2024-01-05T00:00:00.000 == close pos time: 2024-01-12T00:00:00.000
2024-11-20 23:07:25,370 - INFO - pnl: 2024-01-04T23:59:59.999 150133.28473981287 === 0.549%
2024-11-20 23:07:25,373 - DEBUG - cur time: 2024-01-05T23:59:59.999 == next bar open time: 2024-01-06T00:00:00.000 == close pos time: 2024-01-13T00:00:00.000
2024-11-20 23:07:25,374 - INFO - pnl: 2024-01-05T23:59:59.999 151515.6420495819 === 0.921%
2024-11-20 23:07:25,378 - DEBUG - cur time: 2024-01-06T23:59:59.999 == next bar open time: 2024-01-07T00:00:00.000 == close pos time: 2024-01-14T00:00:00.000
2024-11-20 23:07:25,380 - INFO - pnl: 2024-01-06T23:59:59.999 153895.5355551577 === 1.571%
2024-11-20 23:07:25,385 - DEBUG - cur time: 2024-01-07T23:59:59.999 == next bar open time: 2024-01-08T00:00:00.000 == close pos time: 2024-01-15T00:00:00.000
2024-11-20 23:07:25,387 - INFO - pnl: 2024-01-07T23:59:59.999 152189.0220639304 === -1.109%
2024-11-20 23:07:25,391 - DEBUG - cur time: 2024-01-08T23:59:59.999 == next bar open time: 2024-01-09T00:00:00.000 == close pos time: 2024-01-16T00:00:00.000
2024-11-20 23:07:25,392 - INFO - pnl: 2024-01-08T23:59:59.999 151965.05920037365 === -0.147%
2024-11-20 23:07:25,396 - DEBUG - cur time: 2024-01-09T23:59:59.999 == next bar open time: 2024-01-10T00:00:00.000 == close pos time: 2024-01-17T00:00:00.000
2024-11-20 23:07:25,397 - INFO - pnl: 2024-01-09T23:59:59.999 151862.9417184437 === -0.067%
2024-11-20 23:07:25,401 - DEBUG - cur time: 2024-01-10T23:59:59.999 == next bar open time: 2024-01-11T00:00:00.000 == close pos time: 2024-01-18T00:00:00.000
2024-11-20 23:07:25,410 - DEBUG - sorted_long_factors: shape: (193, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT      ┆ -2.445795    ┆ 0    ┆ 192          │
│ CYBERUSDT    ┆ -2.215826    ┆ 1    ┆ 191          │
│ FILUSDT      ┆ -1.938732    ┆ 2    ┆ 190          │
│ YGGUSDT      ┆ -1.832775    ┆ 3    ┆ 189          │
│ BTCDOMUSDT   ┆ -1.711846    ┆ 4    ┆ 188          │
│ BNBUSDT      ┆ -1.711467    ┆ 5    ┆ 187          │
│ STXUSDT      ┆ -1.652814    ┆ 6    ┆ 186          │
│ GMXUSDT      ┆ -1.62413     ┆ 7    ┆ 185          │
│ LDOUSDT      ┆ -1.619532    ┆ 8    ┆ 184          │
│ OPUSDT       ┆ -1.6013      ┆ 9    ┆ 183          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DODOXUSDT    ┆ 0.316706     ┆ 183  ┆ 9            │
│ COMBOUSDT    ┆ 0.3262       ┆ 184  ┆ 8            │
│ AMBUSDT      ┆ 0.354364     ┆ 185  ┆ 7            │
│ DARUSDT      ┆ 0.491606     ┆ 186  ┆ 6            │
│ BLUEBIRDUSDT ┆ 0.497667     ┆ 187  ┆ 5            │
│ SPELLUSDT    ┆ 0.50689      ┆ 188  ┆ 4            │
│ IDEXUSDT     ┆ 0.603221     ┆ 189  ┆ 3            │
│ DGBUSDT      ┆ 0.722454     ┆ 190  ┆ 2            │
│ CKBUSDT      ┆ 0.793535     ┆ 191  ┆ 1            │
│ DEFIUSDT     ┆ 0.945853     ┆ 192  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,415 - WARNING - 2024-01-10T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:25,416 - INFO - cur close time: 2024-01-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:25,416 - DEBUG - mean expected ret (mean factor): -0.7507630754547192
2024-11-20 23:07:25,420 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,420 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,421 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03158     ┆ 0.12728     ┆ 0.001331    ┆ … ┆ 0.02245 ┆ null   ┆ null    ┆ 0.3349  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,427 - DEBUG - update position: 2024-01-10T23:59:59.999 === diff_trading_value: 202791.81698683533 == cash: 151617.6567362277 
2024-11-20 23:07:25,429 - INFO - pnl: 2024-01-10T23:59:59.999 151617.6567362277 === -0.162%
2024-11-20 23:07:25,433 - DEBUG - cur time: 2024-01-11T23:59:59.999 == next bar open time: 2024-01-12T00:00:00.000 == close pos time: 2024-01-19T00:00:00.000
2024-11-20 23:07:25,434 - INFO - pnl: 2024-01-11T23:59:59.999 152896.358672702 === 0.843%
2024-11-20 23:07:25,439 - DEBUG - cur time: 2024-01-12T23:59:59.999 == next bar open time: 2024-01-13T00:00:00.000 == close pos time: 2024-01-20T00:00:00.000
2024-11-20 23:07:25,441 - INFO - pnl: 2024-01-12T23:59:59.999 151156.47761799357 === -1.138%
2024-11-20 23:07:25,445 - DEBUG - cur time: 2024-01-13T23:59:59.999 == next bar open time: 2024-01-14T00:00:00.000 == close pos time: 2024-01-21T00:00:00.000
2024-11-20 23:07:25,447 - INFO - pnl: 2024-01-13T23:59:59.999 153105.46115387732 === 1.289%
2024-11-20 23:07:25,451 - DEBUG - cur time: 2024-01-14T23:59:59.999 == next bar open time: 2024-01-15T00:00:00.000 == close pos time: 2024-01-22T00:00:00.000
2024-11-20 23:07:25,455 - INFO - pnl: 2024-01-14T23:59:59.999 153062.54102969653 === -0.028%
2024-11-20 23:07:25,458 - DEBUG - cur time: 2024-01-15T23:59:59.999 == next bar open time: 2024-01-16T00:00:00.000 == close pos time: 2024-01-23T00:00:00.000
2024-11-20 23:07:25,460 - INFO - pnl: 2024-01-15T23:59:59.999 151446.6617015961 === -1.056%
2024-11-20 23:07:25,463 - DEBUG - cur time: 2024-01-16T23:59:59.999 == next bar open time: 2024-01-17T00:00:00.000 == close pos time: 2024-01-24T00:00:00.000
2024-11-20 23:07:25,464 - INFO - pnl: 2024-01-16T23:59:59.999 152482.8029336349 === 0.684%
2024-11-20 23:07:25,467 - DEBUG - cur time: 2024-01-17T23:59:59.999 == next bar open time: 2024-01-18T00:00:00.000 == close pos time: 2024-01-25T00:00:00.000
2024-11-20 23:07:25,475 - DEBUG - sorted_long_factors: shape: (193, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ JOEUSDT      ┆ -2.067298    ┆ 0    ┆ 192          │
│ BTCDOMUSDT   ┆ -2.04468     ┆ 1    ┆ 191          │
│ TRBUSDT      ┆ -1.861928    ┆ 2    ┆ 190          │
│ WLDUSDT      ┆ -1.750993    ┆ 3    ┆ 189          │
│ SEIUSDT      ┆ -1.739393    ┆ 4    ┆ 188          │
│ HIFIUSDT     ┆ -1.651745    ┆ 5    ┆ 187          │
│ RADUSDT      ┆ -1.632597    ┆ 6    ┆ 186          │
│ APEUSDT      ┆ -1.619381    ┆ 7    ┆ 185          │
│ RNDRUSDT     ┆ -1.560766    ┆ 8    ┆ 184          │
│ MTLUSDT      ┆ -1.541523    ┆ 9    ┆ 183          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ANTUSDT      ┆ 0.240929     ┆ 183  ┆ 9            │
│ CKBUSDT      ┆ 0.254915     ┆ 184  ┆ 8            │
│ DODOXUSDT    ┆ 0.272661     ┆ 185  ┆ 7            │
│ COTIUSDT     ┆ 0.330896     ┆ 186  ┆ 6            │
│ DEFIUSDT     ┆ 0.364488     ┆ 187  ┆ 5            │
│ CTKUSDT      ┆ 0.401397     ┆ 188  ┆ 4            │
│ DGBUSDT      ┆ 0.453992     ┆ 189  ┆ 3            │
│ IDEXUSDT     ┆ 0.512362     ┆ 190  ┆ 2            │
│ BALUSDT      ┆ 0.597994     ┆ 191  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.429114     ┆ 192  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,481 - WARNING - 2024-01-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:25,481 - INFO - cur close time: 2024-01-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:25,481 - DEBUG - mean expected ret (mean factor): -0.7370720109144275
2024-11-20 23:07:25,487 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,487 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,488 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03071     ┆ 0.12592     ┆ 0.0012074   ┆ … ┆ 0.02301 ┆ null   ┆ null    ┆ 0.3357  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,495 - DEBUG - update position: 2024-01-17T23:59:59.999 === diff_trading_value: 253965.15159186424 == cash: 151753.60084723195 
2024-11-20 23:07:25,496 - INFO - pnl: 2024-01-17T23:59:59.999 151753.60084723195 === -0.478%
2024-11-20 23:07:25,500 - DEBUG - cur time: 2024-01-18T23:59:59.999 == next bar open time: 2024-01-19T00:00:00.000 == close pos time: 2024-01-26T00:00:00.000
2024-11-20 23:07:25,501 - INFO - pnl: 2024-01-18T23:59:59.999 151723.12384237305 === -0.020%
2024-11-20 23:07:25,507 - DEBUG - cur time: 2024-01-19T23:59:59.999 == next bar open time: 2024-01-20T00:00:00.000 == close pos time: 2024-01-27T00:00:00.000
2024-11-20 23:07:25,509 - INFO - pnl: 2024-01-19T23:59:59.999 151167.3142166166 === -0.366%
2024-11-20 23:07:25,512 - DEBUG - cur time: 2024-01-20T23:59:59.999 == next bar open time: 2024-01-21T00:00:00.000 == close pos time: 2024-01-28T00:00:00.000
2024-11-20 23:07:25,514 - INFO - pnl: 2024-01-20T23:59:59.999 157708.26421769138 === 4.327%
2024-11-20 23:07:25,517 - DEBUG - cur time: 2024-01-21T23:59:59.999 == next bar open time: 2024-01-22T00:00:00.000 == close pos time: 2024-01-29T00:00:00.000
2024-11-20 23:07:25,518 - INFO - pnl: 2024-01-21T23:59:59.999 157613.84725074505 === -0.060%
2024-11-20 23:07:25,522 - DEBUG - cur time: 2024-01-22T23:59:59.999 == next bar open time: 2024-01-23T00:00:00.000 == close pos time: 2024-01-30T00:00:00.000
2024-11-20 23:07:25,523 - INFO - pnl: 2024-01-22T23:59:59.999 157641.89704318639 === 0.018%
2024-11-20 23:07:25,527 - DEBUG - cur time: 2024-01-23T23:59:59.999 == next bar open time: 2024-01-24T00:00:00.000 == close pos time: 2024-01-31T00:00:00.000
2024-11-20 23:07:25,528 - INFO - pnl: 2024-01-23T23:59:59.999 155888.0652217305 === -1.113%
2024-11-20 23:07:25,532 - DEBUG - cur time: 2024-01-24T23:59:59.999 == next bar open time: 2024-01-25T00:00:00.000 == close pos time: 2024-02-01T00:00:00.000
2024-11-20 23:07:25,540 - DEBUG - sorted_long_factors: shape: (197, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AAVEUSDT     ┆ -1.944921    ┆ 0    ┆ 196          │
│ TRBUSDT      ┆ -1.857539    ┆ 1    ┆ 195          │
│ APEUSDT      ┆ -1.851849    ┆ 2    ┆ 194          │
│ CFXUSDT      ┆ -1.828683    ┆ 3    ┆ 193          │
│ RNDRUSDT     ┆ -1.762935    ┆ 4    ┆ 192          │
│ BONDUSDT     ┆ -1.681665    ┆ 5    ┆ 191          │
│ PENDLEUSDT   ┆ -1.649226    ┆ 6    ┆ 190          │
│ DYDXUSDT     ┆ -1.615831    ┆ 7    ┆ 189          │
│ RLCUSDT      ┆ -1.586025    ┆ 8    ┆ 188          │
│ BANDUSDT     ┆ -1.575162    ┆ 9    ┆ 187          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RSRUSDT      ┆ 0.139628     ┆ 187  ┆ 9            │
│ ANTUSDT      ┆ 0.203113     ┆ 188  ┆ 8            │
│ KEYUSDT      ┆ 0.261879     ┆ 189  ┆ 7            │
│ CKBUSDT      ┆ 0.326873     ┆ 190  ┆ 6            │
│ CTKUSDT      ┆ 0.334602     ┆ 191  ┆ 5            │
│ TRUUSDT      ┆ 0.365077     ┆ 192  ┆ 4            │
│ DODOXUSDT    ┆ 0.467811     ┆ 193  ┆ 3            │
│ TLMUSDT      ┆ 0.469638     ┆ 194  ┆ 2            │
│ DGBUSDT      ┆ 0.676339     ┆ 195  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.796507     ┆ 196  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,549 - WARNING - 2024-01-24T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:25,549 - INFO - cur close time: 2024-01-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:25,549 - DEBUG - mean expected ret (mean factor): -0.765805702623534
2024-11-20 23:07:25,553 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,553 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,554 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02879     ┆ 0.09576     ┆ 0.0010432   ┆ … ┆ 0.02005 ┆ null   ┆ null    ┆ 0.3033  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,561 - DEBUG - update position: 2024-01-24T23:59:59.999 === diff_trading_value: 223048.87892776413 == cash: 155049.33753785188 
2024-11-20 23:07:25,563 - INFO - pnl: 2024-01-24T23:59:59.999 155049.33753785188 === -0.538%
2024-11-20 23:07:25,566 - DEBUG - cur time: 2024-01-25T23:59:59.999 == next bar open time: 2024-01-26T00:00:00.000 == close pos time: 2024-02-02T00:00:00.000
2024-11-20 23:07:25,568 - INFO - pnl: 2024-01-25T23:59:59.999 156538.73888884252 === 0.961%
2024-11-20 23:07:25,572 - DEBUG - cur time: 2024-01-26T23:59:59.999 == next bar open time: 2024-01-27T00:00:00.000 == close pos time: 2024-02-03T00:00:00.000
2024-11-20 23:07:25,573 - INFO - pnl: 2024-01-26T23:59:59.999 153685.2688963715 === -1.823%
2024-11-20 23:07:25,577 - DEBUG - cur time: 2024-01-27T23:59:59.999 == next bar open time: 2024-01-28T00:00:00.000 == close pos time: 2024-02-04T00:00:00.000
2024-11-20 23:07:25,579 - INFO - pnl: 2024-01-27T23:59:59.999 153796.06264000788 === 0.072%
2024-11-20 23:07:25,581 - DEBUG - cur time: 2024-01-28T23:59:59.999 == next bar open time: 2024-01-29T00:00:00.000 == close pos time: 2024-02-05T00:00:00.000
2024-11-20 23:07:25,584 - INFO - pnl: 2024-01-28T23:59:59.999 152505.9626914877 === -0.839%
2024-11-20 23:07:25,587 - DEBUG - cur time: 2024-01-29T23:59:59.999 == next bar open time: 2024-01-30T00:00:00.000 == close pos time: 2024-02-06T00:00:00.000
2024-11-20 23:07:25,588 - INFO - pnl: 2024-01-29T23:59:59.999 150536.32918034814 === -1.292%
2024-11-20 23:07:25,592 - DEBUG - cur time: 2024-01-30T23:59:59.999 == next bar open time: 2024-01-31T00:00:00.000 == close pos time: 2024-02-07T00:00:00.000
2024-11-20 23:07:25,593 - INFO - pnl: 2024-01-30T23:59:59.999 149910.98496223462 === -0.415%
2024-11-20 23:07:25,597 - DEBUG - cur time: 2024-01-31T23:59:59.999 == next bar open time: 2024-02-01T00:00:00.000 == close pos time: 2024-02-08T00:00:00.000
2024-11-20 23:07:25,605 - DEBUG - sorted_long_factors: shape: (202, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XMRUSDT      ┆ -1.955431    ┆ 0    ┆ 201          │
│ WLDUSDT      ┆ -1.942121    ┆ 1    ┆ 200          │
│ NEOUSDT      ┆ -1.620934    ┆ 2    ┆ 199          │
│ BONDUSDT     ┆ -1.568545    ┆ 3    ┆ 198          │
│ MAGICUSDT    ┆ -1.523103    ┆ 4    ┆ 197          │
│ XEMUSDT      ┆ -1.494518    ┆ 5    ┆ 196          │
│ OMGUSDT      ┆ -1.43565     ┆ 6    ┆ 195          │
│ BIGTIMEUSDT  ┆ -1.430436    ┆ 7    ┆ 194          │
│ EGLDUSDT     ┆ -1.410236    ┆ 8    ┆ 193          │
│ RNDRUSDT     ┆ -1.354096    ┆ 9    ┆ 192          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CTKUSDT      ┆ -0.082773    ┆ 192  ┆ 9            │
│ TLMUSDT      ┆ -0.061833    ┆ 193  ┆ 8            │
│ CVXUSDT      ┆ 0.014838     ┆ 194  ┆ 7            │
│ DGBUSDT      ┆ 0.083946     ┆ 195  ┆ 6            │
│ QNTUSDT      ┆ 0.123998     ┆ 196  ┆ 5            │
│ ICPUSDT      ┆ 0.145285     ┆ 197  ┆ 4            │
│ DEFIUSDT     ┆ 0.364085     ┆ 198  ┆ 3            │
│ BTCDOMUSDT   ┆ 0.52859      ┆ 199  ┆ 2            │
│ DODOXUSDT    ┆ 0.703391     ┆ 200  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.569017     ┆ 201  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,610 - WARNING - 2024-01-31T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:25,610 - INFO - cur close time: 2024-01-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:25,611 - DEBUG - mean expected ret (mean factor): -0.7841328100425712
2024-11-20 23:07:25,614 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,615 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,615 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02756     ┆ 0.09501     ┆ 0.0009131   ┆ … ┆ 0.01993 ┆ null   ┆ null    ┆ 0.3166  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,620 - DEBUG - update position: 2024-01-31T23:59:59.999 === diff_trading_value: 268287.7317745369 == cash: 151939.26131537228 
2024-11-20 23:07:25,621 - INFO - pnl: 2024-01-31T23:59:59.999 151939.26131537228 === 1.353%
2024-11-20 23:07:25,624 - DEBUG - cur time: 2024-02-01T23:59:59.999 == next bar open time: 2024-02-02T00:00:00.000 == close pos time: 2024-02-09T00:00:00.000
2024-11-20 23:07:25,626 - INFO - pnl: 2024-02-01T23:59:59.999 150701.96668198577 === -0.814%
2024-11-20 23:07:25,629 - DEBUG - cur time: 2024-02-02T23:59:59.999 == next bar open time: 2024-02-03T00:00:00.000 == close pos time: 2024-02-10T00:00:00.000
2024-11-20 23:07:25,630 - INFO - pnl: 2024-02-02T23:59:59.999 150057.39573754198 === -0.428%
2024-11-20 23:07:25,633 - DEBUG - cur time: 2024-02-03T23:59:59.999 == next bar open time: 2024-02-04T00:00:00.000 == close pos time: 2024-02-11T00:00:00.000
2024-11-20 23:07:25,635 - INFO - pnl: 2024-02-03T23:59:59.999 150150.18094748203 === 0.062%
2024-11-20 23:07:25,638 - DEBUG - cur time: 2024-02-04T23:59:59.999 == next bar open time: 2024-02-05T00:00:00.000 == close pos time: 2024-02-12T00:00:00.000
2024-11-20 23:07:25,640 - INFO - pnl: 2024-02-04T23:59:59.999 151106.771865854 === 0.637%
2024-11-20 23:07:25,642 - DEBUG - cur time: 2024-02-05T23:59:59.999 == next bar open time: 2024-02-06T00:00:00.000 == close pos time: 2024-02-13T00:00:00.000
2024-11-20 23:07:25,643 - INFO - pnl: 2024-02-05T23:59:59.999 152155.5016117528 === 0.694%
2024-11-20 23:07:25,647 - DEBUG - cur time: 2024-02-06T23:59:59.999 == next bar open time: 2024-02-07T00:00:00.000 == close pos time: 2024-02-14T00:00:00.000
2024-11-20 23:07:25,649 - INFO - pnl: 2024-02-06T23:59:59.999 157490.95285223908 === 3.507%
2024-11-20 23:07:25,653 - DEBUG - cur time: 2024-02-07T23:59:59.999 == next bar open time: 2024-02-08T00:00:00.000 == close pos time: 2024-02-15T00:00:00.000
2024-11-20 23:07:25,661 - DEBUG - sorted_long_factors: shape: (205, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ UMAUSDT      ┆ -2.377027    ┆ 0    ┆ 204          │
│ TRBUSDT      ┆ -2.04557     ┆ 1    ┆ 203          │
│ GASUSDT      ┆ -1.979858    ┆ 2    ┆ 202          │
│ OPUSDT       ┆ -1.939393    ┆ 3    ┆ 201          │
│ WLDUSDT      ┆ -1.93659     ┆ 4    ┆ 200          │
│ BSVUSDT      ┆ -1.909298    ┆ 5    ┆ 199          │
│ SEIUSDT      ┆ -1.798822    ┆ 6    ┆ 198          │
│ INJUSDT      ┆ -1.735852    ┆ 7    ┆ 197          │
│ EGLDUSDT     ┆ -1.716755    ┆ 8    ┆ 196          │
│ ARKUSDT      ┆ -1.666027    ┆ 9    ┆ 195          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ATAUSDT      ┆ 0.281248     ┆ 195  ┆ 9            │
│ REEFUSDT     ┆ 0.284811     ┆ 196  ┆ 8            │
│ RVNUSDT      ┆ 0.299391     ┆ 197  ┆ 7            │
│ TRUUSDT      ┆ 0.379023     ┆ 198  ┆ 6            │
│ KEYUSDT      ┆ 0.380229     ┆ 199  ┆ 5            │
│ XVGUSDT      ┆ 0.564601     ┆ 200  ┆ 4            │
│ DODOXUSDT    ┆ 0.682838     ┆ 201  ┆ 3            │
│ DGBUSDT      ┆ 0.731279     ┆ 202  ┆ 2            │
│ IDEXUSDT     ┆ 0.736933     ┆ 203  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.191463     ┆ 204  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,669 - INFO - cur close time: 2024-02-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:25,669 - DEBUG - mean expected ret (mean factor): -0.771985613357249
2024-11-20 23:07:25,674 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,674 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,674 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02857     ┆ 0.10866     ┆ 0.0009668   ┆ … ┆ 0.02031 ┆ null   ┆ null    ┆ 0.3199  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,682 - DEBUG - update position: 2024-02-07T23:59:59.999 === diff_trading_value: 263715.4398614729 == cash: 156823.54445975902 
2024-11-20 23:07:25,683 - INFO - pnl: 2024-02-07T23:59:59.999 156823.54445975902 === -0.424%
2024-11-20 23:07:25,687 - DEBUG - cur time: 2024-02-08T23:59:59.999 == next bar open time: 2024-02-09T00:00:00.000 == close pos time: 2024-02-16T00:00:00.000
2024-11-20 23:07:25,689 - INFO - pnl: 2024-02-08T23:59:59.999 157416.47629264323 === 0.378%
2024-11-20 23:07:25,694 - DEBUG - cur time: 2024-02-09T23:59:59.999 == next bar open time: 2024-02-10T00:00:00.000 == close pos time: 2024-02-17T00:00:00.000
2024-11-20 23:07:25,696 - INFO - pnl: 2024-02-09T23:59:59.999 157081.3291953574 === -0.213%
2024-11-20 23:07:25,700 - DEBUG - cur time: 2024-02-10T23:59:59.999 == next bar open time: 2024-02-11T00:00:00.000 == close pos time: 2024-02-18T00:00:00.000
2024-11-20 23:07:25,701 - INFO - pnl: 2024-02-10T23:59:59.999 157215.9407421297 === 0.086%
2024-11-20 23:07:25,706 - DEBUG - cur time: 2024-02-11T23:59:59.999 == next bar open time: 2024-02-12T00:00:00.000 == close pos time: 2024-02-19T00:00:00.000
2024-11-20 23:07:25,709 - INFO - pnl: 2024-02-11T23:59:59.999 155955.38559673523 === -0.802%
2024-11-20 23:07:25,713 - DEBUG - cur time: 2024-02-12T23:59:59.999 == next bar open time: 2024-02-13T00:00:00.000 == close pos time: 2024-02-20T00:00:00.000
2024-11-20 23:07:25,715 - INFO - pnl: 2024-02-12T23:59:59.999 153752.47770805014 === -1.413%
2024-11-20 23:07:25,720 - DEBUG - cur time: 2024-02-13T23:59:59.999 == next bar open time: 2024-02-14T00:00:00.000 == close pos time: 2024-02-21T00:00:00.000
2024-11-20 23:07:25,722 - INFO - pnl: 2024-02-13T23:59:59.999 156527.93837099645 === 1.805%
2024-11-20 23:07:25,726 - DEBUG - cur time: 2024-02-14T23:59:59.999 == next bar open time: 2024-02-15T00:00:00.000 == close pos time: 2024-02-22T00:00:00.000
2024-11-20 23:07:25,738 - DEBUG - sorted_long_factors: shape: (212, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT      ┆ -1.975411    ┆ 0    ┆ 211          │
│ NMRUSDT      ┆ -1.919921    ┆ 1    ┆ 210          │
│ COMPUSDT     ┆ -1.881508    ┆ 2    ┆ 209          │
│ NEARUSDT     ┆ -1.863988    ┆ 3    ┆ 208          │
│ INJUSDT      ┆ -1.858687    ┆ 4    ┆ 207          │
│ CYBERUSDT    ┆ -1.841843    ┆ 5    ┆ 206          │
│ EGLDUSDT     ┆ -1.765619    ┆ 6    ┆ 205          │
│ BSVUSDT      ┆ -1.731435    ┆ 7    ┆ 204          │
│ MASKUSDT     ┆ -1.728613    ┆ 8    ┆ 203          │
│ MKRUSDT      ┆ -1.696275    ┆ 9    ┆ 202          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ 0.177036     ┆ 202  ┆ 9            │
│ FOOTBALLUSDT ┆ 0.204722     ┆ 203  ┆ 8            │
│ CVXUSDT      ┆ 0.207032     ┆ 204  ┆ 7            │
│ TRUUSDT      ┆ 0.268923     ┆ 205  ┆ 6            │
│ ATAUSDT      ┆ 0.541475     ┆ 206  ┆ 5            │
│ COMBOUSDT    ┆ 0.616241     ┆ 207  ┆ 4            │
│ XVGUSDT      ┆ 0.754614     ┆ 208  ┆ 3            │
│ DGBUSDT      ┆ 0.839015     ┆ 209  ┆ 2            │
│ DEFIUSDT     ┆ 1.581591     ┆ 210  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.348151     ┆ 211  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,748 - WARNING - 2024-02-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:25,748 - INFO - cur close time: 2024-02-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:25,749 - DEBUG - mean expected ret (mean factor): -0.7628298956936262
2024-11-20 23:07:25,758 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,758 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,759 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03353     ┆ 0.1179      ┆ 0.0012479   ┆ … ┆ 0.02192 ┆ null   ┆ null    ┆ 0.333   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,775 - DEBUG - update position: 2024-02-14T23:59:59.999 === diff_trading_value: 228686.93088870856 == cash: 155281.0087145693 
2024-11-20 23:07:25,778 - INFO - pnl: 2024-02-14T23:59:59.999 155281.0087145693 === -0.797%
2024-11-20 23:07:25,786 - DEBUG - cur time: 2024-02-15T23:59:59.999 == next bar open time: 2024-02-16T00:00:00.000 == close pos time: 2024-02-23T00:00:00.000
2024-11-20 23:07:25,791 - INFO - pnl: 2024-02-15T23:59:59.999 157658.69702281288 === 1.531%
2024-11-20 23:07:25,799 - DEBUG - cur time: 2024-02-16T23:59:59.999 == next bar open time: 2024-02-17T00:00:00.000 == close pos time: 2024-02-24T00:00:00.000
2024-11-20 23:07:25,802 - INFO - pnl: 2024-02-16T23:59:59.999 159058.45677065972 === 0.888%
2024-11-20 23:07:25,808 - DEBUG - cur time: 2024-02-17T23:59:59.999 == next bar open time: 2024-02-18T00:00:00.000 == close pos time: 2024-02-25T00:00:00.000
2024-11-20 23:07:25,811 - INFO - pnl: 2024-02-17T23:59:59.999 157982.39854054456 === -0.677%
2024-11-20 23:07:25,818 - DEBUG - cur time: 2024-02-18T23:59:59.999 == next bar open time: 2024-02-19T00:00:00.000 == close pos time: 2024-02-26T00:00:00.000
2024-11-20 23:07:25,820 - INFO - pnl: 2024-02-18T23:59:59.999 160570.6687362816 === 1.638%
2024-11-20 23:07:25,826 - DEBUG - cur time: 2024-02-19T23:59:59.999 == next bar open time: 2024-02-20T00:00:00.000 == close pos time: 2024-02-27T00:00:00.000
2024-11-20 23:07:25,828 - INFO - pnl: 2024-02-19T23:59:59.999 160001.15864283344 === -0.355%
2024-11-20 23:07:25,838 - DEBUG - cur time: 2024-02-20T23:59:59.999 == next bar open time: 2024-02-21T00:00:00.000 == close pos time: 2024-02-28T00:00:00.000
2024-11-20 23:07:25,841 - INFO - pnl: 2024-02-20T23:59:59.999 160319.22247497682 === 0.199%
2024-11-20 23:07:25,846 - DEBUG - cur time: 2024-02-21T23:59:59.999 == next bar open time: 2024-02-22T00:00:00.000 == close pos time: 2024-02-29T00:00:00.000
2024-11-20 23:07:25,860 - DEBUG - sorted_long_factors: shape: (216, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT      ┆ -1.726539    ┆ 0    ┆ 215          │
│ GASUSDT      ┆ -1.45564     ┆ 1    ┆ 214          │
│ BSVUSDT      ┆ -1.45342     ┆ 2    ┆ 213          │
│ TRBUSDT      ┆ -1.442538    ┆ 3    ┆ 212          │
│ RNDRUSDT     ┆ -1.424381    ┆ 4    ┆ 211          │
│ ICPUSDT      ┆ -1.38034     ┆ 5    ┆ 210          │
│ CYBERUSDT    ┆ -1.376404    ┆ 6    ┆ 209          │
│ OPUSDT       ┆ -1.368586    ┆ 7    ┆ 208          │
│ APEUSDT      ┆ -1.368206    ┆ 8    ┆ 207          │
│ BONDUSDT     ┆ -1.365446    ┆ 9    ┆ 206          │
│ …            ┆ …            ┆ …    ┆ …            │
│ PENDLEUSDT   ┆ -0.162924    ┆ 206  ┆ 9            │
│ BANDUSDT     ┆ -0.141295    ┆ 207  ┆ 8            │
│ IMXUSDT      ┆ -0.140996    ┆ 208  ┆ 7            │
│ TLMUSDT      ┆ -0.040798    ┆ 209  ┆ 6            │
│ COMBOUSDT    ┆ -0.034162    ┆ 210  ┆ 5            │
│ ANTUSDT      ┆ 0.04919      ┆ 211  ┆ 4            │
│ CTKUSDT      ┆ 0.05722      ┆ 212  ┆ 3            │
│ DGBUSDT      ┆ 0.152112     ┆ 213  ┆ 2            │
│ DEFIUSDT     ┆ 1.971462     ┆ 214  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.248459     ┆ 215  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,867 - WARNING - 2024-02-21T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:25,867 - INFO - cur close time: 2024-02-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:25,867 - DEBUG - mean expected ret (mean factor): -0.7788353453923104
2024-11-20 23:07:25,873 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,873 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,873 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03324     ┆ 0.12228     ┆ 0.0011544   ┆ … ┆ 0.02292 ┆ null   ┆ null    ┆ 0.352   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,884 - DEBUG - update position: 2024-02-21T23:59:59.999 === diff_trading_value: 256163.12782658375 == cash: 162209.9748725731 
2024-11-20 23:07:25,886 - INFO - pnl: 2024-02-21T23:59:59.999 162209.9748725731 === 1.179%
2024-11-20 23:07:25,891 - DEBUG - cur time: 2024-02-22T23:59:59.999 == next bar open time: 2024-02-23T00:00:00.000 == close pos time: 2024-03-01T00:00:00.000
2024-11-20 23:07:25,895 - INFO - pnl: 2024-02-22T23:59:59.999 166926.77272735102 === 2.908%
2024-11-20 23:07:25,901 - DEBUG - cur time: 2024-02-23T23:59:59.999 == next bar open time: 2024-02-24T00:00:00.000 == close pos time: 2024-03-02T00:00:00.000
2024-11-20 23:07:25,903 - INFO - pnl: 2024-02-23T23:59:59.999 166141.81590692667 === -0.470%
2024-11-20 23:07:25,908 - DEBUG - cur time: 2024-02-24T23:59:59.999 == next bar open time: 2024-02-25T00:00:00.000 == close pos time: 2024-03-03T00:00:00.000
2024-11-20 23:07:25,910 - INFO - pnl: 2024-02-24T23:59:59.999 168998.05307987353 === 1.719%
2024-11-20 23:07:25,916 - DEBUG - cur time: 2024-02-25T23:59:59.999 == next bar open time: 2024-02-26T00:00:00.000 == close pos time: 2024-03-04T00:00:00.000
2024-11-20 23:07:25,919 - INFO - pnl: 2024-02-25T23:59:59.999 174488.09512493317 === 3.249%
2024-11-20 23:07:25,924 - DEBUG - cur time: 2024-02-26T23:59:59.999 == next bar open time: 2024-02-27T00:00:00.000 == close pos time: 2024-03-05T00:00:00.000
2024-11-20 23:07:25,927 - INFO - pnl: 2024-02-26T23:59:59.999 177091.18323419604 === 1.492%
2024-11-20 23:07:25,931 - DEBUG - cur time: 2024-02-27T23:59:59.999 == next bar open time: 2024-02-28T00:00:00.000 == close pos time: 2024-03-06T00:00:00.000
2024-11-20 23:07:25,933 - INFO - pnl: 2024-02-27T23:59:59.999 179326.8223331148 === 1.262%
2024-11-20 23:07:25,938 - DEBUG - cur time: 2024-02-28T23:59:59.999 == next bar open time: 2024-02-29T00:00:00.000 == close pos time: 2024-03-07T00:00:00.000
2024-11-20 23:07:25,950 - DEBUG - sorted_long_factors: shape: (220, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT     ┆ -1.987767    ┆ 0    ┆ 219          │
│ BSVUSDT      ┆ -1.811027    ┆ 1    ┆ 218          │
│ NEOUSDT      ┆ -1.755079    ┆ 2    ┆ 217          │
│ OPUSDT       ┆ -1.688857    ┆ 3    ┆ 216          │
│ GASUSDT      ┆ -1.677623    ┆ 4    ┆ 215          │
│ DOTUSDT      ┆ -1.66161     ┆ 5    ┆ 214          │
│ INJUSDT      ┆ -1.591068    ┆ 6    ┆ 213          │
│ EOSUSDT      ┆ -1.590979    ┆ 7    ┆ 212          │
│ AXSUSDT      ┆ -1.498661    ┆ 8    ┆ 211          │
│ ARBUSDT      ┆ -1.471349    ┆ 9    ┆ 210          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TLMUSDT      ┆ 0.007314     ┆ 210  ┆ 9            │
│ CTKUSDT      ┆ 0.013017     ┆ 211  ┆ 8            │
│ RSRUSDT      ┆ 0.045362     ┆ 212  ┆ 7            │
│ REEFUSDT     ┆ 0.046994     ┆ 213  ┆ 6            │
│ XMRUSDT      ┆ 0.117247     ┆ 214  ┆ 5            │
│ BTCDOMUSDT   ┆ 0.276609     ┆ 215  ┆ 4            │
│ DGBUSDT      ┆ 0.284031     ┆ 216  ┆ 3            │
│ FOOTBALLUSDT ┆ 0.731895     ┆ 217  ┆ 2            │
│ DEFIUSDT     ┆ 0.793003     ┆ 218  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.673605     ┆ 219  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:25,957 - WARNING - 2024-02-28T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:25,957 - INFO - cur close time: 2024-02-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:25,957 - DEBUG - mean expected ret (mean factor): -0.7745326602246579
2024-11-20 23:07:25,962 - DEBUG - begin to update pos: =========
2024-11-20 23:07:25,962 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,963 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.05641     ┆ 0.13846     ┆ 0.0031814   ┆ … ┆ 0.02736 ┆ null   ┆ null    ┆ 0.3691  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:25,968 - DEBUG - update position: 2024-02-28T23:59:59.999 === diff_trading_value: 266283.3677817162 == cash: 178862.01886035196 
2024-11-20 23:07:25,970 - INFO - pnl: 2024-02-28T23:59:59.999 178862.01886035196 === -0.259%
2024-11-20 23:07:25,972 - DEBUG - cur time: 2024-02-29T23:59:59.999 == next bar open time: 2024-03-01T00:00:00.000 == close pos time: 2024-03-08T00:00:00.000
2024-11-20 23:07:25,974 - INFO - pnl: 2024-02-29T23:59:59.999 179953.21909377494 === 0.610%
2024-11-20 23:07:25,978 - DEBUG - cur time: 2024-03-01T23:59:59.999 == next bar open time: 2024-03-02T00:00:00.000 == close pos time: 2024-03-09T00:00:00.000
2024-11-20 23:07:25,979 - INFO - pnl: 2024-03-01T23:59:59.999 180357.53301869423 === 0.225%
2024-11-20 23:07:25,983 - DEBUG - cur time: 2024-03-02T23:59:59.999 == next bar open time: 2024-03-03T00:00:00.000 == close pos time: 2024-03-10T00:00:00.000
2024-11-20 23:07:25,984 - INFO - pnl: 2024-03-02T23:59:59.999 173755.7882701153 === -3.660%
2024-11-20 23:07:25,989 - DEBUG - cur time: 2024-03-03T23:59:59.999 == next bar open time: 2024-03-04T00:00:00.000 == close pos time: 2024-03-11T00:00:00.000
2024-11-20 23:07:25,991 - INFO - pnl: 2024-03-03T23:59:59.999 177046.26698668333 === 1.894%
2024-11-20 23:07:25,995 - DEBUG - cur time: 2024-03-04T23:59:59.999 == next bar open time: 2024-03-05T00:00:00.000 == close pos time: 2024-03-12T00:00:00.000
2024-11-20 23:07:25,996 - INFO - pnl: 2024-03-04T23:59:59.999 174905.65851583958 === -1.209%
2024-11-20 23:07:26,000 - DEBUG - cur time: 2024-03-05T23:59:59.999 == next bar open time: 2024-03-06T00:00:00.000 == close pos time: 2024-03-13T00:00:00.000
2024-11-20 23:07:26,001 - INFO - pnl: 2024-03-05T23:59:59.999 173163.23090693168 === -0.996%
2024-11-20 23:07:26,004 - DEBUG - cur time: 2024-03-06T23:59:59.999 == next bar open time: 2024-03-07T00:00:00.000 == close pos time: 2024-03-14T00:00:00.000
2024-11-20 23:07:26,012 - DEBUG - sorted_long_factors: shape: (223, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT     ┆ -2.16068     ┆ 0    ┆ 222          │
│ GASUSDT      ┆ -1.95291     ┆ 1    ┆ 221          │
│ NEOUSDT      ┆ -1.727609    ┆ 2    ┆ 220          │
│ EGLDUSDT     ┆ -1.721931    ┆ 3    ┆ 219          │
│ YFIUSDT      ┆ -1.716363    ┆ 4    ┆ 218          │
│ WAVESUSDT    ┆ -1.712175    ┆ 5    ┆ 217          │
│ BSVUSDT      ┆ -1.700409    ┆ 6    ┆ 216          │
│ SSVUSDT      ┆ -1.60454     ┆ 7    ┆ 215          │
│ UNFIUSDT     ┆ -1.603765    ┆ 8    ┆ 214          │
│ ILVUSDT      ┆ -1.59183     ┆ 9    ┆ 213          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COMBOUSDT    ┆ 0.044316     ┆ 213  ┆ 9            │
│ DGBUSDT      ┆ 0.069438     ┆ 214  ┆ 8            │
│ BTCDOMUSDT   ┆ 0.081101     ┆ 215  ┆ 7            │
│ RSRUSDT      ┆ 0.112553     ┆ 216  ┆ 6            │
│ DODOXUSDT    ┆ 0.250867     ┆ 217  ┆ 5            │
│ FOOTBALLUSDT ┆ 0.322309     ┆ 218  ┆ 4            │
│ OXTUSDT      ┆ 0.626435     ┆ 219  ┆ 3            │
│ IDEXUSDT     ┆ 0.644061     ┆ 220  ┆ 2            │
│ DEFIUSDT     ┆ 1.406623     ┆ 221  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.508343     ┆ 222  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,019 - WARNING - 2024-03-06T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:26,019 - INFO - cur close time: 2024-03-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:26,019 - DEBUG - mean expected ret (mean factor): -0.7779062023449863
2024-11-20 23:07:26,023 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,024 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,024 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.029994    ┆ 0.13085     ┆ 0.19394     ┆ 0.0072111   ┆ … ┆ 0.03675 ┆ null   ┆ null    ┆ 0.5306  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,031 - DEBUG - update position: 2024-03-06T23:59:59.999 === diff_trading_value: 230561.5540908294 == cash: 177539.06279487978 
2024-11-20 23:07:26,034 - INFO - pnl: 2024-03-06T23:59:59.999 177539.06279487978 === 2.527%
2024-11-20 23:07:26,038 - DEBUG - cur time: 2024-03-07T23:59:59.999 == next bar open time: 2024-03-08T00:00:00.000 == close pos time: 2024-03-15T00:00:00.000
2024-11-20 23:07:26,040 - INFO - pnl: 2024-03-07T23:59:59.999 177835.09844047 === 0.167%
2024-11-20 23:07:26,043 - DEBUG - cur time: 2024-03-08T23:59:59.999 == next bar open time: 2024-03-09T00:00:00.000 == close pos time: 2024-03-16T00:00:00.000
2024-11-20 23:07:26,044 - INFO - pnl: 2024-03-08T23:59:59.999 178659.22030018043 === 0.463%
2024-11-20 23:07:26,048 - DEBUG - cur time: 2024-03-09T23:59:59.999 == next bar open time: 2024-03-10T00:00:00.000 == close pos time: 2024-03-17T00:00:00.000
2024-11-20 23:07:26,050 - INFO - pnl: 2024-03-09T23:59:59.999 179670.4912839999 === 0.566%
2024-11-20 23:07:26,053 - DEBUG - cur time: 2024-03-10T23:59:59.999 == next bar open time: 2024-03-11T00:00:00.000 == close pos time: 2024-03-18T00:00:00.000
2024-11-20 23:07:26,054 - INFO - pnl: 2024-03-10T23:59:59.999 181815.92122350296 === 1.194%
2024-11-20 23:07:26,058 - DEBUG - cur time: 2024-03-11T23:59:59.999 == next bar open time: 2024-03-12T00:00:00.000 == close pos time: 2024-03-19T00:00:00.000
2024-11-20 23:07:26,059 - INFO - pnl: 2024-03-11T23:59:59.999 185059.0806948757 === 1.784%
2024-11-20 23:07:26,062 - DEBUG - cur time: 2024-03-12T23:59:59.999 == next bar open time: 2024-03-13T00:00:00.000 == close pos time: 2024-03-20T00:00:00.000
2024-11-20 23:07:26,063 - INFO - pnl: 2024-03-12T23:59:59.999 185637.430019202 === 0.313%
2024-11-20 23:07:26,069 - DEBUG - cur time: 2024-03-13T23:59:59.999 == next bar open time: 2024-03-14T00:00:00.000 == close pos time: 2024-03-21T00:00:00.000
2024-11-20 23:07:26,077 - DEBUG - sorted_long_factors: shape: (225, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT     ┆ -1.982756    ┆ 0    ┆ 224          │
│ STXUSDT      ┆ -1.796814    ┆ 1    ┆ 223          │
│ GASUSDT      ┆ -1.784728    ┆ 2    ┆ 222          │
│ TRBUSDT      ┆ -1.765624    ┆ 3    ┆ 221          │
│ XMRUSDT      ┆ -1.649981    ┆ 4    ┆ 220          │
│ EGLDUSDT     ┆ -1.632119    ┆ 5    ┆ 219          │
│ APEUSDT      ┆ -1.609174    ┆ 6    ┆ 218          │
│ POWRUSDT     ┆ -1.606576    ┆ 7    ┆ 217          │
│ BADGERUSDT   ┆ -1.598624    ┆ 8    ┆ 216          │
│ MKRUSDT      ┆ -1.593418    ┆ 9    ┆ 215          │
│ …            ┆ …            ┆ …    ┆ …            │
│ FETUSDT      ┆ -0.087452    ┆ 215  ┆ 9            │
│ AGIXUSDT     ┆ -0.043576    ┆ 216  ┆ 8            │
│ GALUSDT      ┆ 0.000104     ┆ 217  ┆ 7            │
│ PENDLEUSDT   ┆ 0.009335     ┆ 218  ┆ 6            │
│ BALUSDT      ┆ 0.013511     ┆ 219  ┆ 5            │
│ DGBUSDT      ┆ 0.030676     ┆ 220  ┆ 4            │
│ ANTUSDT      ┆ 0.451844     ┆ 221  ┆ 3            │
│ IDEXUSDT     ┆ 0.864003     ┆ 222  ┆ 2            │
│ DEFIUSDT     ┆ 1.73497      ┆ 223  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.682437     ┆ 224  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,084 - WARNING - 2024-03-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:26,084 - INFO - cur close time: 2024-03-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:26,084 - DEBUG - mean expected ret (mean factor): -0.7797448406448275
2024-11-20 23:07:26,089 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,089 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,089 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.03192     ┆ 0.26886     ┆ 0.18291     ┆ 0.0090412   ┆ … ┆ 0.04054 ┆ null   ┆ null    ┆ 1.0997  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,097 - DEBUG - update position: 2024-03-13T23:59:59.999 === diff_trading_value: 310340.7789729944 == cash: 179273.57635141138 
2024-11-20 23:07:26,098 - INFO - pnl: 2024-03-13T23:59:59.999 179273.57635141138 === -3.428%
2024-11-20 23:07:26,102 - DEBUG - cur time: 2024-03-14T23:59:59.999 == next bar open time: 2024-03-15T00:00:00.000 == close pos time: 2024-03-22T00:00:00.000
2024-11-20 23:07:26,104 - INFO - pnl: 2024-03-14T23:59:59.999 180616.22508964562 === 0.749%
2024-11-20 23:07:26,107 - DEBUG - cur time: 2024-03-15T23:59:59.999 == next bar open time: 2024-03-16T00:00:00.000 == close pos time: 2024-03-23T00:00:00.000
2024-11-20 23:07:26,109 - INFO - pnl: 2024-03-15T23:59:59.999 181181.40215081797 === 0.313%
2024-11-20 23:07:26,112 - DEBUG - cur time: 2024-03-16T23:59:59.999 == next bar open time: 2024-03-17T00:00:00.000 == close pos time: 2024-03-24T00:00:00.000
2024-11-20 23:07:26,113 - INFO - pnl: 2024-03-16T23:59:59.999 179122.88279786945 === -1.136%
2024-11-20 23:07:26,118 - DEBUG - cur time: 2024-03-17T23:59:59.999 == next bar open time: 2024-03-18T00:00:00.000 == close pos time: 2024-03-25T00:00:00.000
2024-11-20 23:07:26,119 - INFO - pnl: 2024-03-17T23:59:59.999 182244.2661939774 === 1.743%
2024-11-20 23:07:26,122 - DEBUG - cur time: 2024-03-18T23:59:59.999 == next bar open time: 2024-03-19T00:00:00.000 == close pos time: 2024-03-26T00:00:00.000
2024-11-20 23:07:26,124 - INFO - pnl: 2024-03-18T23:59:59.999 180143.95625553667 === -1.152%
2024-11-20 23:07:26,128 - DEBUG - cur time: 2024-03-19T23:59:59.999 == next bar open time: 2024-03-20T00:00:00.000 == close pos time: 2024-03-27T00:00:00.000
2024-11-20 23:07:26,131 - INFO - pnl: 2024-03-19T23:59:59.999 171510.46438671136 === -4.793%
2024-11-20 23:07:26,137 - DEBUG - cur time: 2024-03-20T23:59:59.999 == next bar open time: 2024-03-21T00:00:00.000 == close pos time: 2024-03-28T00:00:00.000
2024-11-20 23:07:26,147 - DEBUG - sorted_long_factors: shape: (224, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ JTOUSDT   ┆ -2.474869    ┆ 0    ┆ 223          │
│ APTUSDT   ┆ -2.409556    ┆ 1    ┆ 222          │
│ EGLDUSDT  ┆ -1.814099    ┆ 2    ┆ 221          │
│ GASUSDT   ┆ -1.777041    ┆ 3    ┆ 220          │
│ INJUSDT   ┆ -1.749768    ┆ 4    ┆ 219          │
│ TIAUSDT   ┆ -1.686276    ┆ 5    ┆ 218          │
│ BNBUSDT   ┆ -1.670736    ┆ 6    ┆ 217          │
│ BONDUSDT  ┆ -1.654967    ┆ 7    ┆ 216          │
│ FTMUSDT   ┆ -1.614741    ┆ 8    ┆ 215          │
│ ORDIUSDT  ┆ -1.614354    ┆ 9    ┆ 214          │
│ …         ┆ …            ┆ …    ┆ …            │
│ BALUSDT   ┆ 0.104957     ┆ 214  ┆ 9            │
│ LDOUSDT   ┆ 0.124983     ┆ 215  ┆ 8            │
│ DGBUSDT   ┆ 0.125695     ┆ 216  ┆ 7            │
│ DUSKUSDT  ┆ 0.151622     ┆ 217  ┆ 6            │
│ IDEXUSDT  ┆ 0.229147     ┆ 218  ┆ 5            │
│ COMBOUSDT ┆ 0.548822     ┆ 219  ┆ 4            │
│ TRUUSDT   ┆ 0.667476     ┆ 220  ┆ 3            │
│ OXTUSDT   ┆ 0.670998     ┆ 221  ┆ 2            │
│ ANTUSDT   ┆ 1.23835      ┆ 222  ┆ 1            │
│ DEFIUSDT  ┆ 1.671498     ┆ 223  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,153 - WARNING - 2024-03-20T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:26,153 - INFO - cur close time: 2024-03-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:26,154 - DEBUG - mean expected ret (mean factor): -0.779099972752903
2024-11-20 23:07:26,157 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,158 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,158 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024479    ┆ 0.23294     ┆ 0.14092     ┆ 0.0083869   ┆ … ┆ 0.03408 ┆ null   ┆ null    ┆ 1.2056  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,164 - DEBUG - update position: 2024-03-20T23:59:59.999 === diff_trading_value: 250518.1340432927 == cash: 170115.78789293536 
2024-11-20 23:07:26,165 - INFO - pnl: 2024-03-20T23:59:59.999 170115.78789293536 === -0.813%
2024-11-20 23:07:26,169 - DEBUG - cur time: 2024-03-21T23:59:59.999 == next bar open time: 2024-03-22T00:00:00.000 == close pos time: 2024-03-29T00:00:00.000
2024-11-20 23:07:26,170 - INFO - pnl: 2024-03-21T23:59:59.999 176886.50671424865 === 3.980%
2024-11-20 23:07:26,173 - DEBUG - cur time: 2024-03-22T23:59:59.999 == next bar open time: 2024-03-23T00:00:00.000 == close pos time: 2024-03-30T00:00:00.000
2024-11-20 23:07:26,177 - INFO - pnl: 2024-03-22T23:59:59.999 176150.0948680457 === -0.416%
2024-11-20 23:07:26,180 - DEBUG - cur time: 2024-03-23T23:59:59.999 == next bar open time: 2024-03-24T00:00:00.000 == close pos time: 2024-03-31T00:00:00.000
2024-11-20 23:07:26,181 - INFO - pnl: 2024-03-23T23:59:59.999 181517.44478994314 === 3.047%
2024-11-20 23:07:26,186 - DEBUG - cur time: 2024-03-24T23:59:59.999 == next bar open time: 2024-03-25T00:00:00.000 == close pos time: 2024-04-01T00:00:00.000
2024-11-20 23:07:26,187 - INFO - pnl: 2024-03-24T23:59:59.999 184603.13765405782 === 1.700%
2024-11-20 23:07:26,191 - DEBUG - cur time: 2024-03-25T23:59:59.999 == next bar open time: 2024-03-26T00:00:00.000 == close pos time: 2024-04-02T00:00:00.000
2024-11-20 23:07:26,193 - INFO - pnl: 2024-03-25T23:59:59.999 180224.19495761336 === -2.372%
2024-11-20 23:07:26,196 - DEBUG - cur time: 2024-03-26T23:59:59.999 == next bar open time: 2024-03-27T00:00:00.000 == close pos time: 2024-04-03T00:00:00.000
2024-11-20 23:07:26,197 - INFO - pnl: 2024-03-26T23:59:59.999 185023.29073834917 === 2.663%
2024-11-20 23:07:26,201 - DEBUG - cur time: 2024-03-27T23:59:59.999 == next bar open time: 2024-03-28T00:00:00.000 == close pos time: 2024-04-04T00:00:00.000
2024-11-20 23:07:26,210 - DEBUG - sorted_long_factors: shape: (224, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ JTOUSDT    ┆ -1.938148    ┆ 0    ┆ 223          │
│ IDUSDT     ┆ -1.935076    ┆ 1    ┆ 222          │
│ TIAUSDT    ┆ -1.921932    ┆ 2    ┆ 221          │
│ BTCDOMUSDT ┆ -1.877484    ┆ 3    ┆ 220          │
│ SEIUSDT    ┆ -1.79745     ┆ 4    ┆ 219          │
│ OCEANUSDT  ┆ -1.759512    ┆ 5    ┆ 218          │
│ BONDUSDT   ┆ -1.72825     ┆ 6    ┆ 217          │
│ BSVUSDT    ┆ -1.667131    ┆ 7    ┆ 216          │
│ ZRXUSDT    ┆ -1.665377    ┆ 8    ┆ 215          │
│ SUIUSDT    ┆ -1.596585    ┆ 9    ┆ 214          │
│ …          ┆ …            ┆ …    ┆ …            │
│ COMBOUSDT  ┆ -0.059783    ┆ 214  ┆ 9            │
│ CVXUSDT    ┆ -0.014828    ┆ 215  ┆ 8            │
│ BNTUSDT    ┆ 0.001545     ┆ 216  ┆ 7            │
│ BALUSDT    ┆ 0.010423     ┆ 217  ┆ 6            │
│ SFPUSDT    ┆ 0.017163     ┆ 218  ┆ 5            │
│ XVGUSDT    ┆ 0.093316     ┆ 219  ┆ 4            │
│ ZECUSDT    ┆ 0.276774     ┆ 220  ┆ 3            │
│ DASHUSDT   ┆ 0.288261     ┆ 221  ┆ 2            │
│ OXTUSDT    ┆ 1.002669     ┆ 222  ┆ 1            │
│ DEFIUSDT   ┆ 2.624805     ┆ 223  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,216 - WARNING - 2024-03-27T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:26,216 - INFO - cur close time: 2024-03-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:26,216 - DEBUG - mean expected ret (mean factor): -0.7829781587438608
2024-11-20 23:07:26,220 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,220 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬─────────┬──────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT  │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---      │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64      │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆         ┆          │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪═════════╪══════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ -10000.0 │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴─────────┴──────────┘
2024-11-20 23:07:26,220 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025848    ┆ 0.22532     ┆ 0.15381     ┆ 0.007629    ┆ … ┆ 0.03552 ┆ null   ┆ null    ┆ 1.071   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,226 - DEBUG - update position: 2024-03-27T23:59:59.999 === diff_trading_value: 289924.9319370531 == cash: 183926.3487906889 
2024-11-20 23:07:26,227 - INFO - pnl: 2024-03-27T23:59:59.999 183926.3487906889 === -0.593%
2024-11-20 23:07:26,231 - DEBUG - cur time: 2024-03-28T23:59:59.999 == next bar open time: 2024-03-29T00:00:00.000 == close pos time: 2024-04-05T00:00:00.000
2024-11-20 23:07:26,233 - INFO - pnl: 2024-03-28T23:59:59.999 184131.06057906157 === 0.111%
2024-11-20 23:07:26,235 - DEBUG - cur time: 2024-03-29T23:59:59.999 == next bar open time: 2024-03-30T00:00:00.000 == close pos time: 2024-04-06T00:00:00.000
2024-11-20 23:07:26,236 - INFO - pnl: 2024-03-29T23:59:59.999 189798.5080540199 === 3.078%
2024-11-20 23:07:26,238 - DEBUG - cur time: 2024-03-30T23:59:59.999 == next bar open time: 2024-03-31T00:00:00.000 == close pos time: 2024-04-07T00:00:00.000
2024-11-20 23:07:26,240 - INFO - pnl: 2024-03-30T23:59:59.999 189184.10965070297 === -0.324%
2024-11-20 23:07:26,244 - DEBUG - cur time: 2024-03-31T23:59:59.999 == next bar open time: 2024-04-01T00:00:00.000 == close pos time: 2024-04-08T00:00:00.000
2024-11-20 23:07:26,245 - INFO - pnl: 2024-03-31T23:59:59.999 188809.29894524635 === -0.198%
2024-11-20 23:07:26,247 - DEBUG - cur time: 2024-04-01T23:59:59.999 == next bar open time: 2024-04-02T00:00:00.000 == close pos time: 2024-04-09T00:00:00.000
2024-11-20 23:07:26,249 - INFO - pnl: 2024-04-01T23:59:59.999 189702.67536167905 === 0.473%
2024-11-20 23:07:26,252 - DEBUG - cur time: 2024-04-02T23:59:59.999 == next bar open time: 2024-04-03T00:00:00.000 == close pos time: 2024-04-10T00:00:00.000
2024-11-20 23:07:26,253 - INFO - pnl: 2024-04-02T23:59:59.999 192493.45230078226 === 1.471%
2024-11-20 23:07:26,256 - DEBUG - cur time: 2024-04-03T23:59:59.999 == next bar open time: 2024-04-04T00:00:00.000 == close pos time: 2024-04-11T00:00:00.000
2024-11-20 23:07:26,264 - DEBUG - sorted_long_factors: shape: (225, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ AUCTIONUSDT ┆ -1.949693    ┆ 0    ┆ 224          │
│ JTOUSDT     ┆ -1.933205    ┆ 1    ┆ 223          │
│ BONDUSDT    ┆ -1.925276    ┆ 2    ┆ 222          │
│ BSVUSDT     ┆ -1.855076    ┆ 3    ┆ 221          │
│ MKRUSDT     ┆ -1.788561    ┆ 4    ┆ 220          │
│ ORDIUSDT    ┆ -1.716349    ┆ 5    ┆ 219          │
│ MASKUSDT    ┆ -1.699275    ┆ 6    ┆ 218          │
│ ENSUSDT     ┆ -1.61082     ┆ 7    ┆ 217          │
│ PYTHUSDT    ┆ -1.557417    ┆ 8    ┆ 216          │
│ NEARUSDT    ┆ -1.500611    ┆ 9    ┆ 215          │
│ …           ┆ …            ┆ …    ┆ …            │
│ ALPHAUSDT   ┆ 0.028291     ┆ 215  ┆ 9            │
│ TLMUSDT     ┆ 0.060736     ┆ 216  ┆ 8            │
│ KSMUSDT     ┆ 0.085779     ┆ 217  ┆ 7            │
│ BNTUSDT     ┆ 0.114216     ┆ 218  ┆ 6            │
│ DENTUSDT    ┆ 0.128598     ┆ 219  ┆ 5            │
│ SNTUSDT     ┆ 0.232407     ┆ 220  ┆ 4            │
│ CVXUSDT     ┆ 0.34673      ┆ 221  ┆ 3            │
│ SFPUSDT     ┆ 0.358308     ┆ 222  ┆ 2            │
│ OXTUSDT     ┆ 0.855788     ┆ 223  ┆ 1            │
│ DEFIUSDT    ┆ 3.082334     ┆ 224  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,269 - WARNING - 2024-04-03T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:26,269 - INFO - cur close time: 2024-04-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:26,269 - DEBUG - mean expected ret (mean factor): -0.7693153562511624
2024-11-20 23:07:26,274 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,275 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,275 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.02237     ┆ 0.19879     ┆ 0.13611     ┆ 0.0068101   ┆ … ┆ 0.03189 ┆ null   ┆ null    ┆ 0.645   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,280 - DEBUG - update position: 2024-04-03T23:59:59.999 === diff_trading_value: 246951.25386077605 == cash: 187154.5520099856 
2024-11-20 23:07:26,281 - INFO - pnl: 2024-04-03T23:59:59.999 187154.5520099856 === -2.774%
2024-11-20 23:07:26,284 - DEBUG - cur time: 2024-04-04T23:59:59.999 == next bar open time: 2024-04-05T00:00:00.000 == close pos time: 2024-04-12T00:00:00.000
2024-11-20 23:07:26,286 - INFO - pnl: 2024-04-04T23:59:59.999 187554.28983399327 === 0.214%
2024-11-20 23:07:26,290 - DEBUG - cur time: 2024-04-05T23:59:59.999 == next bar open time: 2024-04-06T00:00:00.000 == close pos time: 2024-04-13T00:00:00.000
2024-11-20 23:07:26,291 - INFO - pnl: 2024-04-05T23:59:59.999 188115.8815314544 === 0.299%
2024-11-20 23:07:26,295 - DEBUG - cur time: 2024-04-06T23:59:59.999 == next bar open time: 2024-04-07T00:00:00.000 == close pos time: 2024-04-14T00:00:00.000
2024-11-20 23:07:26,296 - INFO - pnl: 2024-04-06T23:59:59.999 186388.9623763773 === -0.918%
2024-11-20 23:07:26,298 - DEBUG - cur time: 2024-04-07T23:59:59.999 == next bar open time: 2024-04-08T00:00:00.000 == close pos time: 2024-04-15T00:00:00.000
2024-11-20 23:07:26,300 - INFO - pnl: 2024-04-07T23:59:59.999 188765.96325847413 === 1.275%
2024-11-20 23:07:26,304 - DEBUG - cur time: 2024-04-08T23:59:59.999 == next bar open time: 2024-04-09T00:00:00.000 == close pos time: 2024-04-16T00:00:00.000
2024-11-20 23:07:26,305 - INFO - pnl: 2024-04-08T23:59:59.999 192453.64716967737 === 1.954%
2024-11-20 23:07:26,310 - DEBUG - cur time: 2024-04-09T23:59:59.999 == next bar open time: 2024-04-10T00:00:00.000 == close pos time: 2024-04-17T00:00:00.000
2024-11-20 23:07:26,311 - INFO - pnl: 2024-04-09T23:59:59.999 194570.32573651162 === 1.100%
2024-11-20 23:07:26,315 - DEBUG - cur time: 2024-04-10T23:59:59.999 == next bar open time: 2024-04-11T00:00:00.000 == close pos time: 2024-04-18T00:00:00.000
2024-11-20 23:07:26,324 - DEBUG - sorted_long_factors: shape: (227, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ILVUSDT     ┆ -2.145603    ┆ 0    ┆ 226          │
│ AAVEUSDT    ┆ -1.933959    ┆ 1    ┆ 225          │
│ AUCTIONUSDT ┆ -1.924392    ┆ 2    ┆ 224          │
│ TIAUSDT     ┆ -1.889424    ┆ 3    ┆ 223          │
│ ORDIUSDT    ┆ -1.749219    ┆ 4    ┆ 222          │
│ WAVESUSDT   ┆ -1.733403    ┆ 5    ┆ 221          │
│ PYTHUSDT    ┆ -1.685092    ┆ 6    ┆ 220          │
│ TRBUSDT     ┆ -1.661064    ┆ 7    ┆ 219          │
│ CAKEUSDT    ┆ -1.634083    ┆ 8    ┆ 218          │
│ CFXUSDT     ┆ -1.612517    ┆ 9    ┆ 217          │
│ …           ┆ …            ┆ …    ┆ …            │
│ REEFUSDT    ┆ 0.032907     ┆ 217  ┆ 9            │
│ BTCDOMUSDT  ┆ 0.061303     ┆ 218  ┆ 8            │
│ TLMUSDT     ┆ 0.115972     ┆ 219  ┆ 7            │
│ AGLDUSDT    ┆ 0.122886     ┆ 220  ┆ 6            │
│ PHBUSDT     ┆ 0.175395     ┆ 221  ┆ 5            │
│ OXTUSDT     ┆ 0.284773     ┆ 222  ┆ 4            │
│ DODOXUSDT   ┆ 0.352337     ┆ 223  ┆ 3            │
│ CVXUSDT     ┆ 0.434379     ┆ 224  ┆ 2            │
│ XMRUSDT     ┆ 0.449232     ┆ 225  ┆ 1            │
│ DEFIUSDT    ┆ 1.585732     ┆ 226  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,330 - INFO - cur close time: 2024-04-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:26,330 - DEBUG - mean expected ret (mean factor): -0.7793094275614164
2024-11-20 23:07:26,335 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,335 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,335 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022713    ┆ 0.19772     ┆ 0.13073     ┆ 0.0071408   ┆ … ┆ 0.03299 ┆ null   ┆ null    ┆ 0.6624  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,341 - DEBUG - update position: 2024-04-10T23:59:59.999 === diff_trading_value: 279737.63310000836 == cash: 195249.81350351596 
2024-11-20 23:07:26,343 - INFO - pnl: 2024-04-10T23:59:59.999 195249.81350351596 === 0.349%
2024-11-20 23:07:26,347 - DEBUG - cur time: 2024-04-11T23:59:59.999 == next bar open time: 2024-04-12T00:00:00.000 == close pos time: 2024-04-19T00:00:00.000
2024-11-20 23:07:26,348 - INFO - pnl: 2024-04-11T23:59:59.999 196309.00824548752 === 0.542%
2024-11-20 23:07:26,351 - DEBUG - cur time: 2024-04-12T23:59:59.999 == next bar open time: 2024-04-13T00:00:00.000 == close pos time: 2024-04-20T00:00:00.000
2024-11-20 23:07:26,353 - INFO - pnl: 2024-04-12T23:59:59.999 198235.9247739963 === 0.982%
2024-11-20 23:07:26,356 - DEBUG - cur time: 2024-04-13T23:59:59.999 == next bar open time: 2024-04-14T00:00:00.000 == close pos time: 2024-04-21T00:00:00.000
2024-11-20 23:07:26,357 - INFO - pnl: 2024-04-13T23:59:59.999 198058.72325746968 === -0.089%
2024-11-20 23:07:26,361 - DEBUG - cur time: 2024-04-14T23:59:59.999 == next bar open time: 2024-04-15T00:00:00.000 == close pos time: 2024-04-22T00:00:00.000
2024-11-20 23:07:26,363 - INFO - pnl: 2024-04-14T23:59:59.999 197900.53900433585 === -0.080%
2024-11-20 23:07:26,367 - DEBUG - cur time: 2024-04-15T23:59:59.999 == next bar open time: 2024-04-16T00:00:00.000 == close pos time: 2024-04-23T00:00:00.000
2024-11-20 23:07:26,368 - INFO - pnl: 2024-04-15T23:59:59.999 198523.48228331993 === 0.315%
2024-11-20 23:07:26,372 - DEBUG - cur time: 2024-04-16T23:59:59.999 == next bar open time: 2024-04-17T00:00:00.000 == close pos time: 2024-04-24T00:00:00.000
2024-11-20 23:07:26,373 - INFO - pnl: 2024-04-16T23:59:59.999 198891.5222080799 === 0.185%
2024-11-20 23:07:26,377 - DEBUG - cur time: 2024-04-17T23:59:59.999 == next bar open time: 2024-04-18T00:00:00.000 == close pos time: 2024-04-25T00:00:00.000
2024-11-20 23:07:26,386 - DEBUG - sorted_long_factors: shape: (227, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HIGHUSDT     ┆ -2.194043    ┆ 0    ┆ 226          │
│ AUCTIONUSDT  ┆ -1.71382     ┆ 1    ┆ 225          │
│ BELUSDT      ┆ -1.692826    ┆ 2    ┆ 224          │
│ 1000SATSUSDT ┆ -1.685419    ┆ 3    ┆ 223          │
│ ONTUSDT      ┆ -1.645596    ┆ 4    ┆ 222          │
│ JTOUSDT      ┆ -1.632859    ┆ 5    ┆ 221          │
│ JASMYUSDT    ┆ -1.609548    ┆ 6    ┆ 220          │
│ ONGUSDT      ┆ -1.569273    ┆ 7    ┆ 219          │
│ GASUSDT      ┆ -1.540713    ┆ 8    ┆ 218          │
│ ORBSUSDT     ┆ -1.517893    ┆ 9    ┆ 217          │
│ …            ┆ …            ┆ …    ┆ …            │
│ QNTUSDT      ┆ 0.049671     ┆ 217  ┆ 9            │
│ LITUSDT      ┆ 0.224244     ┆ 218  ┆ 8            │
│ GTCUSDT      ┆ 0.230701     ┆ 219  ┆ 7            │
│ DODOXUSDT    ┆ 0.262425     ┆ 220  ┆ 6            │
│ RNDRUSDT     ┆ 0.284324     ┆ 221  ┆ 5            │
│ RADUSDT      ┆ 0.295504     ┆ 222  ┆ 4            │
│ COMBOUSDT    ┆ 0.332195     ┆ 223  ┆ 3            │
│ NMRUSDT      ┆ 0.367525     ┆ 224  ┆ 2            │
│ CVXUSDT      ┆ 0.50767      ┆ 225  ┆ 1            │
│ DEFIUSDT     ┆ 2.863557     ┆ 226  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,391 - WARNING - 2024-04-17T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:26,391 - INFO - cur close time: 2024-04-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:26,391 - DEBUG - mean expected ret (mean factor): -0.7842397993399217
2024-11-20 23:07:26,395 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,395 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,396 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.01393     ┆ 0.13324     ┆ 0.09816     ┆ 0.0049112   ┆ … ┆ 0.02339 ┆ null   ┆ null    ┆ 0.4871  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,403 - DEBUG - update position: 2024-04-17T23:59:59.999 === diff_trading_value: 294903.62847918784 == cash: 199245.77564059716 
2024-11-20 23:07:26,404 - INFO - pnl: 2024-04-17T23:59:59.999 199245.77564059716 === 0.178%
2024-11-20 23:07:26,408 - DEBUG - cur time: 2024-04-18T23:59:59.999 == next bar open time: 2024-04-19T00:00:00.000 == close pos time: 2024-04-26T00:00:00.000
2024-11-20 23:07:26,410 - INFO - pnl: 2024-04-18T23:59:59.999 194104.2421395131 === -2.580%
2024-11-20 23:07:26,413 - DEBUG - cur time: 2024-04-19T23:59:59.999 == next bar open time: 2024-04-20T00:00:00.000 == close pos time: 2024-04-27T00:00:00.000
2024-11-20 23:07:26,415 - INFO - pnl: 2024-04-19T23:59:59.999 189601.51442653604 === -2.320%
2024-11-20 23:07:26,418 - DEBUG - cur time: 2024-04-20T23:59:59.999 == next bar open time: 2024-04-21T00:00:00.000 == close pos time: 2024-04-28T00:00:00.000
2024-11-20 23:07:26,419 - INFO - pnl: 2024-04-20T23:59:59.999 190950.0475320925 === 0.711%
2024-11-20 23:07:26,426 - DEBUG - cur time: 2024-04-21T23:59:59.999 == next bar open time: 2024-04-22T00:00:00.000 == close pos time: 2024-04-29T00:00:00.000
2024-11-20 23:07:26,428 - INFO - pnl: 2024-04-21T23:59:59.999 187156.6831745365 === -1.987%
2024-11-20 23:07:26,431 - DEBUG - cur time: 2024-04-22T23:59:59.999 == next bar open time: 2024-04-23T00:00:00.000 == close pos time: 2024-04-30T00:00:00.000
2024-11-20 23:07:26,432 - INFO - pnl: 2024-04-22T23:59:59.999 186522.95650215703 === -0.339%
2024-11-20 23:07:26,435 - DEBUG - cur time: 2024-04-23T23:59:59.999 == next bar open time: 2024-04-24T00:00:00.000 == close pos time: 2024-05-01T00:00:00.000
2024-11-20 23:07:26,436 - INFO - pnl: 2024-04-23T23:59:59.999 190604.24261377408 === 2.188%
2024-11-20 23:07:26,439 - DEBUG - cur time: 2024-04-24T23:59:59.999 == next bar open time: 2024-04-25T00:00:00.000 == close pos time: 2024-05-02T00:00:00.000
2024-11-20 23:07:26,448 - DEBUG - sorted_long_factors: shape: (229, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ONTUSDT     ┆ -2.099917    ┆ 0    ┆ 228          │
│ ATAUSDT     ┆ -1.897669    ┆ 1    ┆ 227          │
│ BNXUSDT     ┆ -1.839391    ┆ 2    ┆ 226          │
│ MEMEUSDT    ┆ -1.681551    ┆ 3    ┆ 225          │
│ BNBUSDT     ┆ -1.671132    ┆ 4    ┆ 224          │
│ BIGTIMEUSDT ┆ -1.638244    ┆ 5    ┆ 223          │
│ JTOUSDT     ┆ -1.614059    ┆ 6    ┆ 222          │
│ ALGOUSDT    ┆ -1.580881    ┆ 7    ┆ 221          │
│ GASUSDT     ┆ -1.577478    ┆ 8    ┆ 220          │
│ MTLUSDT     ┆ -1.527837    ┆ 9    ┆ 219          │
│ …           ┆ …            ┆ …    ┆ …            │
│ PHBUSDT     ┆ 0.051307     ┆ 219  ┆ 9            │
│ DASHUSDT    ┆ 0.092241     ┆ 220  ┆ 8            │
│ LITUSDT     ┆ 0.131809     ┆ 221  ┆ 7            │
│ RADUSDT     ┆ 0.225035     ┆ 222  ┆ 6            │
│ OXTUSDT     ┆ 0.303511     ┆ 223  ┆ 5            │
│ ZENUSDT     ┆ 0.36982      ┆ 224  ┆ 4            │
│ CVXUSDT     ┆ 0.39186      ┆ 225  ┆ 3            │
│ AGLDUSDT    ┆ 0.480217     ┆ 226  ┆ 2            │
│ NMRUSDT     ┆ 0.540582     ┆ 227  ┆ 1            │
│ DEFIUSDT    ┆ 3.028529     ┆ 228  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,456 - WARNING - 2024-04-24T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:26,456 - INFO - cur close time: 2024-04-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:26,456 - DEBUG - mean expected ret (mean factor): -0.7851610872839241
2024-11-20 23:07:26,461 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,461 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,462 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024481    ┆ 0.18491     ┆ 0.10437     ┆ 0.0072463   ┆ … ┆ 0.02559 ┆ null   ┆ null    ┆ 0.5173  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,467 - DEBUG - update position: 2024-04-24T23:59:59.999 === diff_trading_value: 268411.020803079 == cash: 188183.4922401877 
2024-11-20 23:07:26,468 - INFO - pnl: 2024-04-24T23:59:59.999 188183.4922401877 === -1.270%
2024-11-20 23:07:26,471 - DEBUG - cur time: 2024-04-25T23:59:59.999 == next bar open time: 2024-04-26T00:00:00.000 == close pos time: 2024-05-03T00:00:00.000
2024-11-20 23:07:26,472 - INFO - pnl: 2024-04-25T23:59:59.999 191500.60916298768 === 1.763%
2024-11-20 23:07:26,475 - DEBUG - cur time: 2024-04-26T23:59:59.999 == next bar open time: 2024-04-27T00:00:00.000 == close pos time: 2024-05-04T00:00:00.000
2024-11-20 23:07:26,477 - INFO - pnl: 2024-04-26T23:59:59.999 189368.87893434547 === -1.113%
2024-11-20 23:07:26,480 - DEBUG - cur time: 2024-04-27T23:59:59.999 == next bar open time: 2024-04-28T00:00:00.000 == close pos time: 2024-05-05T00:00:00.000
2024-11-20 23:07:26,481 - INFO - pnl: 2024-04-27T23:59:59.999 192612.27485320994 === 1.713%
2024-11-20 23:07:26,484 - DEBUG - cur time: 2024-04-28T23:59:59.999 == next bar open time: 2024-04-29T00:00:00.000 == close pos time: 2024-05-06T00:00:00.000
2024-11-20 23:07:26,485 - INFO - pnl: 2024-04-28T23:59:59.999 190496.1666079728 === -1.099%
2024-11-20 23:07:26,488 - DEBUG - cur time: 2024-04-29T23:59:59.999 == next bar open time: 2024-04-30T00:00:00.000 == close pos time: 2024-05-07T00:00:00.000
2024-11-20 23:07:26,489 - INFO - pnl: 2024-04-29T23:59:59.999 189077.94421599616 === -0.744%
2024-11-20 23:07:26,491 - DEBUG - cur time: 2024-04-30T23:59:59.999 == next bar open time: 2024-05-01T00:00:00.000 == close pos time: 2024-05-08T00:00:00.000
2024-11-20 23:07:26,493 - INFO - pnl: 2024-04-30T23:59:59.999 188565.3021330092 === -0.271%
2024-11-20 23:07:26,495 - DEBUG - cur time: 2024-05-01T23:59:59.999 == next bar open time: 2024-05-02T00:00:00.000 == close pos time: 2024-05-09T00:00:00.000
2024-11-20 23:07:26,506 - DEBUG - sorted_long_factors: shape: (232, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ WIFUSDT   ┆ -2.308508    ┆ 0    ┆ 231          │
│ XMRUSDT   ┆ -2.240584    ┆ 1    ┆ 230          │
│ JTOUSDT   ┆ -2.161415    ┆ 2    ┆ 229          │
│ HIGHUSDT  ┆ -2.075221    ┆ 3    ┆ 228          │
│ SSVUSDT   ┆ -2.003356    ┆ 4    ┆ 227          │
│ LDOUSDT   ┆ -1.864712    ┆ 5    ┆ 226          │
│ ONDOUSDT  ┆ -1.834009    ┆ 6    ┆ 225          │
│ ONGUSDT   ┆ -1.790578    ┆ 7    ┆ 224          │
│ WAVESUSDT ┆ -1.781441    ┆ 8    ┆ 223          │
│ OPUSDT    ┆ -1.676912    ┆ 9    ┆ 222          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ZENUSDT   ┆ 0.103731     ┆ 222  ┆ 9            │
│ PERPUSDT  ┆ 0.121687     ┆ 223  ┆ 8            │
│ CVXUSDT   ┆ 0.183544     ┆ 224  ┆ 7            │
│ IDEXUSDT  ┆ 0.223985     ┆ 225  ┆ 6            │
│ NMRUSDT   ┆ 0.29531      ┆ 226  ┆ 5            │
│ AGLDUSDT  ┆ 0.462935     ┆ 227  ┆ 4            │
│ MDTUSDT   ┆ 0.465871     ┆ 228  ┆ 3            │
│ RADUSDT   ┆ 0.568151     ┆ 229  ┆ 2            │
│ OXTUSDT   ┆ 0.769143     ┆ 230  ┆ 1            │
│ DEFIUSDT  ┆ 2.792313     ┆ 231  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,511 - WARNING - 2024-05-01T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:26,512 - INFO - cur close time: 2024-05-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:26,512 - DEBUG - mean expected ret (mean factor): -0.7574805089467769
2024-11-20 23:07:26,515 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,515 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,516 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022918    ┆ 0.15859     ┆ 0.10011     ┆ 0.0069878   ┆ … ┆ 0.02303 ┆ null   ┆ null    ┆ 0.4641  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,522 - DEBUG - update position: 2024-05-01T23:59:59.999 === diff_trading_value: 289460.0442305319 == cash: 189130.3129591595 
2024-11-20 23:07:26,524 - INFO - pnl: 2024-05-01T23:59:59.999 189130.3129591595 === 0.300%
2024-11-20 23:07:26,527 - DEBUG - cur time: 2024-05-02T23:59:59.999 == next bar open time: 2024-05-03T00:00:00.000 == close pos time: 2024-05-10T00:00:00.000
2024-11-20 23:07:26,528 - INFO - pnl: 2024-05-02T23:59:59.999 187799.69313996122 === -0.704%
2024-11-20 23:07:26,530 - DEBUG - cur time: 2024-05-03T23:59:59.999 == next bar open time: 2024-05-04T00:00:00.000 == close pos time: 2024-05-11T00:00:00.000
2024-11-20 23:07:26,532 - INFO - pnl: 2024-05-03T23:59:59.999 187577.05618607727 === -0.119%
2024-11-20 23:07:26,537 - DEBUG - cur time: 2024-05-04T23:59:59.999 == next bar open time: 2024-05-05T00:00:00.000 == close pos time: 2024-05-12T00:00:00.000
2024-11-20 23:07:26,538 - INFO - pnl: 2024-05-04T23:59:59.999 186111.64748641095 === -0.781%
2024-11-20 23:07:26,542 - DEBUG - cur time: 2024-05-05T23:59:59.999 == next bar open time: 2024-05-06T00:00:00.000 == close pos time: 2024-05-13T00:00:00.000
2024-11-20 23:07:26,544 - INFO - pnl: 2024-05-05T23:59:59.999 187859.59108062513 === 0.939%
2024-11-20 23:07:26,548 - DEBUG - cur time: 2024-05-06T23:59:59.999 == next bar open time: 2024-05-07T00:00:00.000 == close pos time: 2024-05-14T00:00:00.000
2024-11-20 23:07:26,550 - INFO - pnl: 2024-05-06T23:59:59.999 187223.8288282394 === -0.338%
2024-11-20 23:07:26,554 - DEBUG - cur time: 2024-05-07T23:59:59.999 == next bar open time: 2024-05-08T00:00:00.000 == close pos time: 2024-05-15T00:00:00.000
2024-11-20 23:07:26,557 - INFO - pnl: 2024-05-07T23:59:59.999 177453.93900305778 === -5.218%
2024-11-20 23:07:26,560 - DEBUG - cur time: 2024-05-08T23:59:59.999 == next bar open time: 2024-05-09T00:00:00.000 == close pos time: 2024-05-16T00:00:00.000
2024-11-20 23:07:26,568 - DEBUG - sorted_long_factors: shape: (229, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ GASUSDT      ┆ -2.045721    ┆ 0    ┆ 228          │
│ WAVESUSDT    ┆ -1.929613    ┆ 1    ┆ 227          │
│ CELOUSDT     ┆ -1.798486    ┆ 2    ┆ 226          │
│ AUCTIONUSDT  ┆ -1.775157    ┆ 3    ┆ 225          │
│ SSVUSDT      ┆ -1.682992    ┆ 4    ┆ 224          │
│ ACEUSDT      ┆ -1.67962     ┆ 5    ┆ 223          │
│ SEIUSDT      ┆ -1.652644    ┆ 6    ┆ 222          │
│ POWRUSDT     ┆ -1.64665     ┆ 7    ┆ 221          │
│ 1000SATSUSDT ┆ -1.612683    ┆ 8    ┆ 220          │
│ ONGUSDT      ┆ -1.593459    ┆ 9    ┆ 219          │
│ …            ┆ …            ┆ …    ┆ …            │
│ C98USDT      ┆ 0.019192     ┆ 219  ┆ 9            │
│ DODOXUSDT    ┆ 0.078945     ┆ 220  ┆ 8            │
│ RIFUSDT      ┆ 0.093407     ┆ 221  ┆ 7            │
│ PERPUSDT     ┆ 0.102659     ┆ 222  ┆ 6            │
│ IOTXUSDT     ┆ 0.12364      ┆ 223  ┆ 5            │
│ QNTUSDT      ┆ 0.182458     ┆ 224  ┆ 4            │
│ XVSUSDT      ┆ 0.194793     ┆ 225  ┆ 3            │
│ AGLDUSDT     ┆ 0.364446     ┆ 226  ┆ 2            │
│ HFTUSDT      ┆ 0.416262     ┆ 227  ┆ 1            │
│ DEFIUSDT     ┆ 1.957061     ┆ 228  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,574 - WARNING - 2024-05-08T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:26,574 - INFO - cur close time: 2024-05-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:26,574 - DEBUG - mean expected ret (mean factor): -0.7865782867317584
2024-11-20 23:07:26,578 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,578 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,578 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023367    ┆ 0.17012     ┆ 0.10391     ┆ 0.0079604   ┆ … ┆ 0.02337 ┆ null   ┆ null    ┆ 0.4723  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,584 - DEBUG - update position: 2024-05-08T23:59:59.999 === diff_trading_value: 263813.0645038919 == cash: 172951.5575980294 
2024-11-20 23:07:26,585 - INFO - pnl: 2024-05-08T23:59:59.999 167951.5575980294 === -5.355%
2024-11-20 23:07:26,588 - DEBUG - cur time: 2024-05-09T23:59:59.999 == next bar open time: 2024-05-10T00:00:00.000 == close pos time: 2024-05-17T00:00:00.000
2024-11-20 23:07:26,589 - INFO - pnl: 2024-05-09T23:59:59.999 168186.04380975128 === 0.140%
2024-11-20 23:07:26,592 - DEBUG - cur time: 2024-05-10T23:59:59.999 == next bar open time: 2024-05-11T00:00:00.000 == close pos time: 2024-05-18T00:00:00.000
2024-11-20 23:07:26,594 - INFO - pnl: 2024-05-10T23:59:59.999 170107.92406110503 === 1.143%
2024-11-20 23:07:26,599 - DEBUG - cur time: 2024-05-11T23:59:59.999 == next bar open time: 2024-05-12T00:00:00.000 == close pos time: 2024-05-19T00:00:00.000
2024-11-20 23:07:26,601 - INFO - pnl: 2024-05-11T23:59:59.999 170401.0191364197 === 0.172%
2024-11-20 23:07:26,604 - DEBUG - cur time: 2024-05-12T23:59:59.999 == next bar open time: 2024-05-13T00:00:00.000 == close pos time: 2024-05-20T00:00:00.000
2024-11-20 23:07:26,605 - INFO - pnl: 2024-05-12T23:59:59.999 169600.19433950327 === -0.470%
2024-11-20 23:07:26,609 - DEBUG - cur time: 2024-05-13T23:59:59.999 == next bar open time: 2024-05-14T00:00:00.000 == close pos time: 2024-05-21T00:00:00.000
2024-11-20 23:07:26,611 - INFO - pnl: 2024-05-13T23:59:59.999 171329.9249586435 === 1.020%
2024-11-20 23:07:26,616 - DEBUG - cur time: 2024-05-14T23:59:59.999 == next bar open time: 2024-05-15T00:00:00.000 == close pos time: 2024-05-22T00:00:00.000
2024-11-20 23:07:26,617 - INFO - pnl: 2024-05-14T23:59:59.999 171137.73320301023 === -0.112%
2024-11-20 23:07:26,620 - DEBUG - cur time: 2024-05-15T23:59:59.999 == next bar open time: 2024-05-16T00:00:00.000 == close pos time: 2024-05-23T00:00:00.000
2024-11-20 23:07:26,630 - DEBUG - sorted_long_factors: shape: (227, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT  ┆ -2.116585    ┆ 0    ┆ 226          │
│ MOVRUSDT  ┆ -2.115289    ┆ 1    ┆ 225          │
│ ZETAUSDT  ┆ -2.044244    ┆ 2    ┆ 224          │
│ MKRUSDT   ┆ -2.03304     ┆ 3    ┆ 223          │
│ NEARUSDT  ┆ -1.891991    ┆ 4    ┆ 222          │
│ TIAUSDT   ┆ -1.872717    ┆ 5    ┆ 221          │
│ BNBUSDT   ┆ -1.863688    ┆ 6    ┆ 220          │
│ WIFUSDT   ┆ -1.832115    ┆ 7    ┆ 219          │
│ LSKUSDT   ┆ -1.728863    ┆ 8    ┆ 218          │
│ INJUSDT   ┆ -1.72844     ┆ 9    ┆ 217          │
│ …         ┆ …            ┆ …    ┆ …            │
│ MAVUSDT   ┆ 0.266976     ┆ 217  ┆ 9            │
│ BICOUSDT  ┆ 0.305015     ┆ 218  ┆ 8            │
│ ETHWUSDT  ┆ 0.345885     ┆ 219  ┆ 7            │
│ TLMUSDT   ┆ 0.413105     ┆ 220  ┆ 6            │
│ DARUSDT   ┆ 0.486694     ┆ 221  ┆ 5            │
│ DENTUSDT  ┆ 0.493        ┆ 222  ┆ 4            │
│ JOEUSDT   ┆ 0.580839     ┆ 223  ┆ 3            │
│ OGNUSDT   ┆ 0.814286     ┆ 224  ┆ 2            │
│ DODOXUSDT ┆ 0.873289     ┆ 225  ┆ 1            │
│ DEFIUSDT  ┆ 0.886202     ┆ 226  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,638 - INFO - cur close time: 2024-05-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:26,638 - DEBUG - mean expected ret (mean factor): -0.7797540777509625
2024-11-20 23:07:26,643 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,643 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,643 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024833    ┆ 0.21047     ┆ 0.10864     ┆ 0.0105008   ┆ … ┆ 0.02308 ┆ null   ┆ null    ┆ 0.4725  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,653 - DEBUG - update position: 2024-05-15T23:59:59.999 === diff_trading_value: 304490.2277971724 == cash: 170939.53410725272 
2024-11-20 23:07:26,655 - INFO - pnl: 2024-05-15T23:59:59.999 170939.53410725272 === -0.116%
2024-11-20 23:07:26,659 - DEBUG - cur time: 2024-05-16T23:59:59.999 == next bar open time: 2024-05-17T00:00:00.000 == close pos time: 2024-05-24T00:00:00.000
2024-11-20 23:07:26,660 - INFO - pnl: 2024-05-16T23:59:59.999 172702.65801730473 === 1.031%
2024-11-20 23:07:26,665 - DEBUG - cur time: 2024-05-17T23:59:59.999 == next bar open time: 2024-05-18T00:00:00.000 == close pos time: 2024-05-25T00:00:00.000
2024-11-20 23:07:26,666 - INFO - pnl: 2024-05-17T23:59:59.999 173243.21765991725 === 0.313%
2024-11-20 23:07:26,670 - DEBUG - cur time: 2024-05-18T23:59:59.999 == next bar open time: 2024-05-19T00:00:00.000 == close pos time: 2024-05-26T00:00:00.000
2024-11-20 23:07:26,671 - INFO - pnl: 2024-05-18T23:59:59.999 174476.47760062496 === 0.712%
2024-11-20 23:07:26,676 - DEBUG - cur time: 2024-05-19T23:59:59.999 == next bar open time: 2024-05-20T00:00:00.000 == close pos time: 2024-05-27T00:00:00.000
2024-11-20 23:07:26,678 - INFO - pnl: 2024-05-19T23:59:59.999 173246.96385593212 === -0.705%
2024-11-20 23:07:26,682 - DEBUG - cur time: 2024-05-20T23:59:59.999 == next bar open time: 2024-05-21T00:00:00.000 == close pos time: 2024-05-28T00:00:00.000
2024-11-20 23:07:26,683 - INFO - pnl: 2024-05-20T23:59:59.999 174429.4013719096 === 0.683%
2024-11-20 23:07:26,688 - DEBUG - cur time: 2024-05-21T23:59:59.999 == next bar open time: 2024-05-22T00:00:00.000 == close pos time: 2024-05-29T00:00:00.000
2024-11-20 23:07:26,690 - INFO - pnl: 2024-05-21T23:59:59.999 176024.02581370212 === 0.914%
2024-11-20 23:07:26,695 - DEBUG - cur time: 2024-05-22T23:59:59.999 == next bar open time: 2024-05-23T00:00:00.000 == close pos time: 2024-05-30T00:00:00.000
2024-11-20 23:07:26,706 - DEBUG - sorted_long_factors: shape: (229, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT   ┆ -2.168482    ┆ 0    ┆ 228          │
│ XMRUSDT   ┆ -2.129863    ┆ 1    ┆ 227          │
│ TRBUSDT   ┆ -1.997519    ┆ 2    ┆ 226          │
│ WIFUSDT   ┆ -1.983297    ┆ 3    ┆ 225          │
│ UMAUSDT   ┆ -1.950815    ┆ 4    ┆ 224          │
│ RNDRUSDT  ┆ -1.938741    ┆ 5    ┆ 223          │
│ BNBUSDT   ┆ -1.785127    ┆ 6    ┆ 222          │
│ LSKUSDT   ┆ -1.737341    ┆ 7    ┆ 221          │
│ ONDOUSDT  ┆ -1.676804    ┆ 8    ┆ 220          │
│ YGGUSDT   ┆ -1.667206    ┆ 9    ┆ 219          │
│ …         ┆ …            ┆ …    ┆ …            │
│ YFIUSDT   ┆ 0.104475     ┆ 219  ┆ 9            │
│ TLMUSDT   ┆ 0.110558     ┆ 220  ┆ 8            │
│ DASHUSDT  ┆ 0.142626     ┆ 221  ┆ 7            │
│ GMXUSDT   ┆ 0.206789     ┆ 222  ┆ 6            │
│ DARUSDT   ┆ 0.222099     ┆ 223  ┆ 5            │
│ OGNUSDT   ┆ 0.241596     ┆ 224  ┆ 4            │
│ AGLDUSDT  ┆ 0.266873     ┆ 225  ┆ 3            │
│ OXTUSDT   ┆ 0.370206     ┆ 226  ┆ 2            │
│ DODOXUSDT ┆ 1.409534     ┆ 227  ┆ 1            │
│ DEFIUSDT  ┆ 2.189268     ┆ 228  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,712 - WARNING - 2024-05-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:26,712 - INFO - cur close time: 2024-05-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:26,713 - DEBUG - mean expected ret (mean factor): -0.7684387284279256
2024-11-20 23:07:26,718 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,718 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,718 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.032401    ┆ 0.22345     ┆ 0.11615     ┆ 0.0133987   ┆ … ┆ 0.02428 ┆ null   ┆ null    ┆ 0.5592  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,723 - DEBUG - update position: 2024-05-22T23:59:59.999 === diff_trading_value: 273518.17070016917 == cash: 176068.61091326916 
2024-11-20 23:07:26,724 - INFO - pnl: 2024-05-22T23:59:59.999 176068.61091326916 === 0.025%
2024-11-20 23:07:26,728 - DEBUG - cur time: 2024-05-23T23:59:59.999 == next bar open time: 2024-05-24T00:00:00.000 == close pos time: 2024-05-31T00:00:00.000
2024-11-20 23:07:26,729 - INFO - pnl: 2024-05-23T23:59:59.999 175958.98760261206 === -0.062%
2024-11-20 23:07:26,733 - DEBUG - cur time: 2024-05-24T23:59:59.999 == next bar open time: 2024-05-25T00:00:00.000 == close pos time: 2024-06-01T00:00:00.000
2024-11-20 23:07:26,734 - INFO - pnl: 2024-05-24T23:59:59.999 177503.35838883914 === 0.878%
2024-11-20 23:07:26,738 - DEBUG - cur time: 2024-05-25T23:59:59.999 == next bar open time: 2024-05-26T00:00:00.000 == close pos time: 2024-06-02T00:00:00.000
2024-11-20 23:07:26,740 - INFO - pnl: 2024-05-25T23:59:59.999 175387.18102266872 === -1.192%
2024-11-20 23:07:26,745 - DEBUG - cur time: 2024-05-26T23:59:59.999 == next bar open time: 2024-05-27T00:00:00.000 == close pos time: 2024-06-03T00:00:00.000
2024-11-20 23:07:26,746 - INFO - pnl: 2024-05-26T23:59:59.999 176201.520476009 === 0.464%
2024-11-20 23:07:26,749 - DEBUG - cur time: 2024-05-27T23:59:59.999 == next bar open time: 2024-05-28T00:00:00.000 == close pos time: 2024-06-04T00:00:00.000
2024-11-20 23:07:26,751 - INFO - pnl: 2024-05-27T23:59:59.999 177929.49601120895 === 0.981%
2024-11-20 23:07:26,755 - DEBUG - cur time: 2024-05-28T23:59:59.999 == next bar open time: 2024-05-29T00:00:00.000 == close pos time: 2024-06-05T00:00:00.000
2024-11-20 23:07:26,757 - INFO - pnl: 2024-05-28T23:59:59.999 177069.79983911157 === -0.483%
2024-11-20 23:07:26,760 - DEBUG - cur time: 2024-05-29T23:59:59.999 == next bar open time: 2024-05-30T00:00:00.000 == close pos time: 2024-06-06T00:00:00.000
2024-11-20 23:07:26,768 - DEBUG - sorted_long_factors: shape: (230, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ ARUSDT      ┆ -2.138232    ┆ 0    ┆ 229          │
│ JTOUSDT     ┆ -1.972557    ┆ 1    ┆ 228          │
│ RNDRUSDT    ┆ -1.902375    ┆ 2    ┆ 227          │
│ TRBUSDT     ┆ -1.892213    ┆ 3    ┆ 226          │
│ AUCTIONUSDT ┆ -1.884034    ┆ 4    ┆ 225          │
│ WLDUSDT     ┆ -1.76153     ┆ 5    ┆ 224          │
│ LSKUSDT     ┆ -1.746339    ┆ 6    ┆ 223          │
│ WIFUSDT     ┆ -1.70066     ┆ 7    ┆ 222          │
│ NFPUSDT     ┆ -1.699395    ┆ 8    ┆ 221          │
│ JUPUSDT     ┆ -1.682441    ┆ 9    ┆ 220          │
│ …           ┆ …            ┆ …    ┆ …            │
│ DODOXUSDT   ┆ 0.120665     ┆ 220  ┆ 9            │
│ RVNUSDT     ┆ 0.127274     ┆ 221  ┆ 8            │
│ TUSDT       ┆ 0.134391     ┆ 222  ┆ 7            │
│ BATUSDT     ┆ 0.1398       ┆ 223  ┆ 6            │
│ FLMUSDT     ┆ 0.16362      ┆ 224  ┆ 5            │
│ NMRUSDT     ┆ 0.169356     ┆ 225  ┆ 4            │
│ BNTUSDT     ┆ 0.383081     ┆ 226  ┆ 3            │
│ KSMUSDT     ┆ 0.392972     ┆ 227  ┆ 2            │
│ BALUSDT     ┆ 0.628205     ┆ 228  ┆ 1            │
│ DEFIUSDT    ┆ 3.9024       ┆ 229  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,775 - WARNING - 2024-05-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:26,775 - INFO - cur close time: 2024-05-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:26,775 - DEBUG - mean expected ret (mean factor): -0.7789107075885597
2024-11-20 23:07:26,779 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,779 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,780 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.036383    ┆ 0.26812     ┆ 0.11352     ┆ 0.014775    ┆ … ┆ 0.02434 ┆ null   ┆ null    ┆ 0.5315  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,785 - DEBUG - update position: 2024-05-29T23:59:59.999 === diff_trading_value: 230091.90644574974 == cash: 176303.45796182702 
2024-11-20 23:07:26,787 - INFO - pnl: 2024-05-29T23:59:59.999 176303.45796182702 === -0.433%
2024-11-20 23:07:26,790 - DEBUG - cur time: 2024-05-30T23:59:59.999 == next bar open time: 2024-05-31T00:00:00.000 == close pos time: 2024-06-07T00:00:00.000
2024-11-20 23:07:26,791 - INFO - pnl: 2024-05-30T23:59:59.999 176849.58317954093 === 0.310%
2024-11-20 23:07:26,794 - DEBUG - cur time: 2024-05-31T23:59:59.999 == next bar open time: 2024-06-01T00:00:00.000 == close pos time: 2024-06-08T00:00:00.000
2024-11-20 23:07:26,796 - INFO - pnl: 2024-05-31T23:59:59.999 178665.1458874188 === 1.027%
2024-11-20 23:07:26,798 - DEBUG - cur time: 2024-06-01T23:59:59.999 == next bar open time: 2024-06-02T00:00:00.000 == close pos time: 2024-06-09T00:00:00.000
2024-11-20 23:07:26,799 - INFO - pnl: 2024-06-01T23:59:59.999 179500.89177235964 === 0.468%
2024-11-20 23:07:26,802 - DEBUG - cur time: 2024-06-02T23:59:59.999 == next bar open time: 2024-06-03T00:00:00.000 == close pos time: 2024-06-10T00:00:00.000
2024-11-20 23:07:26,803 - INFO - pnl: 2024-06-02T23:59:59.999 179808.77685543493 === 0.172%
2024-11-20 23:07:26,806 - DEBUG - cur time: 2024-06-03T23:59:59.999 == next bar open time: 2024-06-04T00:00:00.000 == close pos time: 2024-06-11T00:00:00.000
2024-11-20 23:07:26,807 - INFO - pnl: 2024-06-03T23:59:59.999 183520.34216771845 === 2.064%
2024-11-20 23:07:26,811 - DEBUG - cur time: 2024-06-04T23:59:59.999 == next bar open time: 2024-06-05T00:00:00.000 == close pos time: 2024-06-12T00:00:00.000
2024-11-20 23:07:26,813 - INFO - pnl: 2024-06-04T23:59:59.999 182030.59551681555 === -0.812%
2024-11-20 23:07:26,817 - DEBUG - cur time: 2024-06-05T23:59:59.999 == next bar open time: 2024-06-06T00:00:00.000 == close pos time: 2024-06-13T00:00:00.000
2024-11-20 23:07:26,826 - DEBUG - sorted_long_factors: shape: (233, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ JTOUSDT    ┆ -2.054799    ┆ 0    ┆ 232          │
│ ACEUSDT    ┆ -2.021139    ┆ 1    ┆ 231          │
│ MKRUSDT    ┆ -1.935059    ┆ 2    ┆ 230          │
│ STRKUSDT   ┆ -1.87472     ┆ 3    ┆ 229          │
│ PENDLEUSDT ┆ -1.84139     ┆ 4    ┆ 228          │
│ DOTUSDT    ┆ -1.820376    ┆ 5    ┆ 227          │
│ TRBUSDT    ┆ -1.7679      ┆ 6    ┆ 226          │
│ RNDRUSDT   ┆ -1.765995    ┆ 7    ┆ 225          │
│ WIFUSDT    ┆ -1.750677    ┆ 8    ┆ 224          │
│ INJUSDT    ┆ -1.735181    ┆ 9    ┆ 223          │
│ …          ┆ …            ┆ …    ┆ …            │
│ COTIUSDT   ┆ 0.216701     ┆ 223  ┆ 9            │
│ ICXUSDT    ┆ 0.258971     ┆ 224  ┆ 8            │
│ BTCDOMUSDT ┆ 0.335708     ┆ 225  ┆ 7            │
│ REEFUSDT   ┆ 0.335987     ┆ 226  ┆ 6            │
│ DODOXUSDT  ┆ 0.480852     ┆ 227  ┆ 5            │
│ OXTUSDT    ┆ 0.480868     ┆ 228  ┆ 4            │
│ SKLUSDT    ┆ 0.503013     ┆ 229  ┆ 3            │
│ NMRUSDT    ┆ 0.503793     ┆ 230  ┆ 2            │
│ BNTUSDT    ┆ 0.532811     ┆ 231  ┆ 1            │
│ DEFIUSDT   ┆ 2.460941     ┆ 232  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,836 - INFO - cur close time: 2024-06-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:26,836 - DEBUG - mean expected ret (mean factor): -0.7796019973473239
2024-11-20 23:07:26,841 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,842 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,842 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.03397     ┆ 0.30952     ┆ 0.11925     ┆ 0.0145939   ┆ … ┆ 0.02412 ┆ null   ┆ null    ┆ 0.5458  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,848 - DEBUG - update position: 2024-06-05T23:59:59.999 === diff_trading_value: 217579.68719157588 == cash: 182072.48120829358 
2024-11-20 23:07:26,849 - INFO - pnl: 2024-06-05T23:59:59.999 182072.48120829358 === 0.023%
2024-11-20 23:07:26,851 - DEBUG - cur time: 2024-06-06T23:59:59.999 == next bar open time: 2024-06-07T00:00:00.000 == close pos time: 2024-06-14T00:00:00.000
2024-11-20 23:07:26,854 - INFO - pnl: 2024-06-06T23:59:59.999 181280.30769060898 === -0.435%
2024-11-20 23:07:26,858 - DEBUG - cur time: 2024-06-07T23:59:59.999 == next bar open time: 2024-06-08T00:00:00.000 == close pos time: 2024-06-15T00:00:00.000
2024-11-20 23:07:26,859 - INFO - pnl: 2024-06-07T23:59:59.999 181948.4887034305 === 0.369%
2024-11-20 23:07:26,863 - DEBUG - cur time: 2024-06-08T23:59:59.999 == next bar open time: 2024-06-09T00:00:00.000 == close pos time: 2024-06-16T00:00:00.000
2024-11-20 23:07:26,865 - INFO - pnl: 2024-06-08T23:59:59.999 180332.71013465762 === -0.888%
2024-11-20 23:07:26,869 - DEBUG - cur time: 2024-06-09T23:59:59.999 == next bar open time: 2024-06-10T00:00:00.000 == close pos time: 2024-06-17T00:00:00.000
2024-11-20 23:07:26,870 - INFO - pnl: 2024-06-09T23:59:59.999 179696.65561979063 === -0.353%
2024-11-20 23:07:26,873 - DEBUG - cur time: 2024-06-10T23:59:59.999 == next bar open time: 2024-06-11T00:00:00.000 == close pos time: 2024-06-18T00:00:00.000
2024-11-20 23:07:26,874 - INFO - pnl: 2024-06-10T23:59:59.999 179771.4860424699 === 0.042%
2024-11-20 23:07:26,877 - DEBUG - cur time: 2024-06-11T23:59:59.999 == next bar open time: 2024-06-12T00:00:00.000 == close pos time: 2024-06-19T00:00:00.000
2024-11-20 23:07:26,878 - INFO - pnl: 2024-06-11T23:59:59.999 181026.6140919956 === 0.698%
2024-11-20 23:07:26,881 - DEBUG - cur time: 2024-06-12T23:59:59.999 == next bar open time: 2024-06-13T00:00:00.000 == close pos time: 2024-06-20T00:00:00.000
2024-11-20 23:07:26,889 - DEBUG - sorted_long_factors: shape: (236, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ MOVRUSDT    ┆ -2.23261     ┆ 0    ┆ 235          │
│ ACEUSDT     ┆ -2.045853    ┆ 1    ┆ 234          │
│ AUCTIONUSDT ┆ -1.886491    ┆ 2    ┆ 233          │
│ TONUSDT     ┆ -1.866749    ┆ 3    ┆ 232          │
│ UMAUSDT     ┆ -1.824102    ┆ 4    ┆ 231          │
│ XAIUSDT     ┆ -1.776107    ┆ 5    ┆ 230          │
│ STRKUSDT    ┆ -1.773749    ┆ 6    ┆ 229          │
│ OMUSDT      ┆ -1.68868     ┆ 7    ┆ 228          │
│ LQTYUSDT    ┆ -1.685903    ┆ 8    ┆ 227          │
│ DYDXUSDT    ┆ -1.678086    ┆ 9    ┆ 226          │
│ …           ┆ …            ┆ …    ┆ …            │
│ 1000XECUSDT ┆ 0.130226     ┆ 226  ┆ 9            │
│ BNTUSDT     ┆ 0.186726     ┆ 227  ┆ 8            │
│ NKNUSDT     ┆ 0.188703     ┆ 228  ┆ 7            │
│ DODOXUSDT   ┆ 0.223854     ┆ 229  ┆ 6            │
│ STMXUSDT    ┆ 0.249011     ┆ 230  ┆ 5            │
│ SKLUSDT     ┆ 0.306162     ┆ 231  ┆ 4            │
│ BALUSDT     ┆ 0.30825      ┆ 232  ┆ 3            │
│ OXTUSDT     ┆ 0.791357     ┆ 233  ┆ 2            │
│ NMRUSDT     ┆ 1.15313      ┆ 234  ┆ 1            │
│ DEFIUSDT    ┆ 2.189351     ┆ 235  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,896 - WARNING - 2024-06-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:26,896 - INFO - cur close time: 2024-06-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:26,897 - DEBUG - mean expected ret (mean factor): -0.7901493123872503
2024-11-20 23:07:26,901 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,901 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,902 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028962    ┆ 0.21971     ┆ 0.10624     ┆ 0.0132106   ┆ … ┆ 0.02101 ┆ null   ┆ null    ┆ 0.4494  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,909 - DEBUG - update position: 2024-06-12T23:59:59.999 === diff_trading_value: 241698.74774116284 == cash: 177296.64444972368 
2024-11-20 23:07:26,910 - INFO - pnl: 2024-06-12T23:59:59.999 177296.64444972368 === -2.060%
2024-11-20 23:07:26,914 - DEBUG - cur time: 2024-06-13T23:59:59.999 == next bar open time: 2024-06-14T00:00:00.000 == close pos time: 2024-06-21T00:00:00.000
2024-11-20 23:07:26,915 - INFO - pnl: 2024-06-13T23:59:59.999 177376.2878747654 === 0.045%
2024-11-20 23:07:26,918 - DEBUG - cur time: 2024-06-14T23:59:59.999 == next bar open time: 2024-06-15T00:00:00.000 == close pos time: 2024-06-22T00:00:00.000
2024-11-20 23:07:26,920 - INFO - pnl: 2024-06-14T23:59:59.999 178370.6786425625 === 0.561%
2024-11-20 23:07:26,924 - DEBUG - cur time: 2024-06-15T23:59:59.999 == next bar open time: 2024-06-16T00:00:00.000 == close pos time: 2024-06-23T00:00:00.000
2024-11-20 23:07:26,926 - INFO - pnl: 2024-06-15T23:59:59.999 177571.49928140032 === -0.448%
2024-11-20 23:07:26,930 - DEBUG - cur time: 2024-06-16T23:59:59.999 == next bar open time: 2024-06-17T00:00:00.000 == close pos time: 2024-06-24T00:00:00.000
2024-11-20 23:07:26,931 - INFO - pnl: 2024-06-16T23:59:59.999 176904.70317332252 === -0.376%
2024-11-20 23:07:26,936 - DEBUG - cur time: 2024-06-17T23:59:59.999 == next bar open time: 2024-06-18T00:00:00.000 == close pos time: 2024-06-25T00:00:00.000
2024-11-20 23:07:26,937 - INFO - pnl: 2024-06-17T23:59:59.999 175798.94810016867 === -0.625%
2024-11-20 23:07:26,940 - DEBUG - cur time: 2024-06-18T23:59:59.999 == next bar open time: 2024-06-19T00:00:00.000 == close pos time: 2024-06-26T00:00:00.000
2024-11-20 23:07:26,941 - INFO - pnl: 2024-06-18T23:59:59.999 176347.9545082065 === 0.312%
2024-11-20 23:07:26,947 - DEBUG - cur time: 2024-06-19T23:59:59.999 == next bar open time: 2024-06-20T00:00:00.000 == close pos time: 2024-06-27T00:00:00.000
2024-11-20 23:07:26,958 - DEBUG - sorted_long_factors: shape: (235, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT   ┆ -2.326092    ┆ 0    ┆ 234          │
│ HIGHUSDT  ┆ -2.263839    ┆ 1    ┆ 233          │
│ TRBUSDT   ┆ -2.095744    ┆ 2    ┆ 232          │
│ OMUSDT    ┆ -2.075853    ┆ 3    ┆ 231          │
│ UNIUSDT   ┆ -1.910898    ┆ 4    ┆ 230          │
│ ENSUSDT   ┆ -1.895019    ┆ 5    ┆ 229          │
│ ZETAUSDT  ┆ -1.889907    ┆ 6    ┆ 228          │
│ ONDOUSDT  ┆ -1.790363    ┆ 7    ┆ 227          │
│ MOVRUSDT  ┆ -1.75497     ┆ 8    ┆ 226          │
│ TONUSDT   ┆ -1.746446    ┆ 9    ┆ 225          │
│ …         ┆ …            ┆ …    ┆ …            │
│ NKNUSDT   ┆ 0.154286     ┆ 225  ┆ 9            │
│ DARUSDT   ┆ 0.197879     ┆ 226  ┆ 8            │
│ RLCUSDT   ┆ 0.201129     ┆ 227  ┆ 7            │
│ BANDUSDT  ┆ 0.215457     ┆ 228  ┆ 6            │
│ OXTUSDT   ┆ 0.235024     ┆ 229  ┆ 5            │
│ PHBUSDT   ┆ 0.263021     ┆ 230  ┆ 4            │
│ HFTUSDT   ┆ 0.370598     ┆ 231  ┆ 3            │
│ DODOXUSDT ┆ 0.704696     ┆ 232  ┆ 2            │
│ NMRUSDT   ┆ 0.771984     ┆ 233  ┆ 1            │
│ DEFIUSDT  ┆ 1.731726     ┆ 234  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:26,965 - WARNING - 2024-06-19T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:26,965 - INFO - cur close time: 2024-06-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:26,965 - DEBUG - mean expected ret (mean factor): -0.7964367175656841
2024-11-20 23:07:26,969 - DEBUG - begin to update pos: =========
2024-11-20 23:07:26,970 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,970 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.021063    ┆ 0.1713      ┆ 0.09128     ┆ 0.011345    ┆ … ┆ 0.01716 ┆ null   ┆ null    ┆ 0.3543  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:26,977 - DEBUG - update position: 2024-06-19T23:59:59.999 === diff_trading_value: 229163.32269961003 == cash: 175445.82792965486 
2024-11-20 23:07:26,978 - INFO - pnl: 2024-06-19T23:59:59.999 175445.82792965486 === -0.512%
2024-11-20 23:07:26,982 - DEBUG - cur time: 2024-06-20T23:59:59.999 == next bar open time: 2024-06-21T00:00:00.000 == close pos time: 2024-06-28T00:00:00.000
2024-11-20 23:07:26,984 - INFO - pnl: 2024-06-20T23:59:59.999 175802.87674266665 === 0.204%
2024-11-20 23:07:26,987 - DEBUG - cur time: 2024-06-21T23:59:59.999 == next bar open time: 2024-06-22T00:00:00.000 == close pos time: 2024-06-29T00:00:00.000
2024-11-20 23:07:26,988 - INFO - pnl: 2024-06-21T23:59:59.999 174943.2419585932 === -0.489%
2024-11-20 23:07:26,991 - DEBUG - cur time: 2024-06-22T23:59:59.999 == next bar open time: 2024-06-23T00:00:00.000 == close pos time: 2024-06-30T00:00:00.000
2024-11-20 23:07:26,993 - INFO - pnl: 2024-06-22T23:59:59.999 175160.9351889367 === 0.124%
2024-11-20 23:07:26,997 - DEBUG - cur time: 2024-06-23T23:59:59.999 == next bar open time: 2024-06-24T00:00:00.000 == close pos time: 2024-07-01T00:00:00.000
2024-11-20 23:07:27,000 - INFO - pnl: 2024-06-23T23:59:59.999 174591.6037074937 === -0.325%
2024-11-20 23:07:27,005 - DEBUG - cur time: 2024-06-24T23:59:59.999 == next bar open time: 2024-06-25T00:00:00.000 == close pos time: 2024-07-02T00:00:00.000
2024-11-20 23:07:27,006 - INFO - pnl: 2024-06-24T23:59:59.999 173754.40999938748 === -0.480%
2024-11-20 23:07:27,010 - DEBUG - cur time: 2024-06-25T23:59:59.999 == next bar open time: 2024-06-26T00:00:00.000 == close pos time: 2024-07-03T00:00:00.000
2024-11-20 23:07:27,011 - INFO - pnl: 2024-06-25T23:59:59.999 174400.1873910647 === 0.372%
2024-11-20 23:07:27,016 - DEBUG - cur time: 2024-06-26T23:59:59.999 == next bar open time: 2024-06-27T00:00:00.000 == close pos time: 2024-07-04T00:00:00.000
2024-11-20 23:07:27,027 - DEBUG - sorted_long_factors: shape: (239, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT     ┆ -2.352614    ┆ 0    ┆ 238          │
│ AUCTIONUSDT ┆ -2.01133     ┆ 1    ┆ 237          │
│ FXSUSDT     ┆ -1.96016     ┆ 2    ┆ 236          │
│ TONUSDT     ┆ -1.944165    ┆ 3    ┆ 235          │
│ STRKUSDT    ┆ -1.941595    ┆ 4    ┆ 234          │
│ NEOUSDT     ┆ -1.739881    ┆ 5    ┆ 233          │
│ GASUSDT     ┆ -1.644374    ┆ 6    ┆ 232          │
│ XAIUSDT     ┆ -1.631667    ┆ 7    ┆ 231          │
│ KNCUSDT     ┆ -1.611258    ┆ 8    ┆ 230          │
│ MANTAUSDT   ┆ -1.60378     ┆ 9    ┆ 229          │
│ …           ┆ …            ┆ …    ┆ …            │
│ XVGUSDT     ┆ 0.000064     ┆ 229  ┆ 9            │
│ AMBUSDT     ┆ 0.019842     ┆ 230  ┆ 8            │
│ TLMUSDT     ┆ 0.058561     ┆ 231  ┆ 7            │
│ NMRUSDT     ┆ 0.243956     ┆ 232  ┆ 6            │
│ DODOXUSDT   ┆ 0.245046     ┆ 233  ┆ 5            │
│ NTRNUSDT    ┆ 0.340873     ┆ 234  ┆ 4            │
│ JOEUSDT     ┆ 0.376086     ┆ 235  ┆ 3            │
│ DARUSDT     ┆ 0.509996     ┆ 236  ┆ 2            │
│ OXTUSDT     ┆ 0.59274      ┆ 237  ┆ 1            │
│ DEFIUSDT    ┆ 1.670022     ┆ 238  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,033 - WARNING - 2024-06-26T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:27,033 - INFO - cur close time: 2024-06-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:27,034 - DEBUG - mean expected ret (mean factor): -0.7889797396340579
2024-11-20 23:07:27,038 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,038 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,038 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.02188     ┆ 0.1679      ┆ 0.08229     ┆ 0.0125375   ┆ … ┆ 0.01769 ┆ null   ┆ null    ┆ 0.3615  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,045 - DEBUG - update position: 2024-06-26T23:59:59.999 === diff_trading_value: 242155.81582890556 == cash: 174195.230457725 
2024-11-20 23:07:27,046 - INFO - pnl: 2024-06-26T23:59:59.999 174195.230457725 === -0.118%
2024-11-20 23:07:27,050 - DEBUG - cur time: 2024-06-27T23:59:59.999 == next bar open time: 2024-06-28T00:00:00.000 == close pos time: 2024-07-05T00:00:00.000
2024-11-20 23:07:27,051 - INFO - pnl: 2024-06-27T23:59:59.999 174447.82662431351 === 0.145%
2024-11-20 23:07:27,054 - DEBUG - cur time: 2024-06-28T23:59:59.999 == next bar open time: 2024-06-29T00:00:00.000 == close pos time: 2024-07-06T00:00:00.000
2024-11-20 23:07:27,055 - INFO - pnl: 2024-06-28T23:59:59.999 176423.984645194 === 1.133%
2024-11-20 23:07:27,059 - DEBUG - cur time: 2024-06-29T23:59:59.999 == next bar open time: 2024-06-30T00:00:00.000 == close pos time: 2024-07-07T00:00:00.000
2024-11-20 23:07:27,062 - INFO - pnl: 2024-06-29T23:59:59.999 175869.65989858625 === -0.314%
2024-11-20 23:07:27,065 - DEBUG - cur time: 2024-06-30T23:59:59.999 == next bar open time: 2024-07-01T00:00:00.000 == close pos time: 2024-07-08T00:00:00.000
2024-11-20 23:07:27,067 - INFO - pnl: 2024-06-30T23:59:59.999 178579.90603734186 === 1.541%
2024-11-20 23:07:27,070 - DEBUG - cur time: 2024-07-01T23:59:59.999 == next bar open time: 2024-07-02T00:00:00.000 == close pos time: 2024-07-09T00:00:00.000
2024-11-20 23:07:27,072 - INFO - pnl: 2024-07-01T23:59:59.999 179527.8369321252 === 0.531%
2024-11-20 23:07:27,076 - DEBUG - cur time: 2024-07-02T23:59:59.999 == next bar open time: 2024-07-03T00:00:00.000 == close pos time: 2024-07-10T00:00:00.000
2024-11-20 23:07:27,078 - INFO - pnl: 2024-07-02T23:59:59.999 180641.98045729168 === 0.621%
2024-11-20 23:07:27,081 - DEBUG - cur time: 2024-07-03T23:59:59.999 == next bar open time: 2024-07-04T00:00:00.000 == close pos time: 2024-07-11T00:00:00.000
2024-11-20 23:07:27,090 - DEBUG - sorted_long_factors: shape: (240, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ GASUSDT    ┆ -1.963796    ┆ 0    ┆ 239          │
│ MANTAUSDT  ┆ -1.907436    ┆ 1    ┆ 238          │
│ BAKEUSDT   ┆ -1.881191    ┆ 2    ┆ 237          │
│ OMUSDT     ┆ -1.863116    ┆ 3    ┆ 236          │
│ JUPUSDT    ┆ -1.827407    ┆ 4    ┆ 235          │
│ BTCDOMUSDT ┆ -1.772634    ┆ 5    ┆ 234          │
│ TRBUSDT    ┆ -1.765715    ┆ 6    ┆ 233          │
│ TONUSDT    ┆ -1.733518    ┆ 7    ┆ 232          │
│ JTOUSDT    ┆ -1.727061    ┆ 8    ┆ 231          │
│ LSKUSDT    ┆ -1.72063     ┆ 9    ┆ 230          │
│ …          ┆ …            ┆ …    ┆ …            │
│ OMGUSDT    ┆ 0.086378     ┆ 230  ┆ 9            │
│ STEEMUSDT  ┆ 0.193891     ┆ 231  ┆ 8            │
│ DODOXUSDT  ┆ 0.197656     ┆ 232  ┆ 7            │
│ HFTUSDT    ┆ 0.235677     ┆ 233  ┆ 6            │
│ DARUSDT    ┆ 0.270822     ┆ 234  ┆ 5            │
│ NMRUSDT    ┆ 0.278301     ┆ 235  ┆ 4            │
│ BADGERUSDT ┆ 0.285438     ┆ 236  ┆ 3            │
│ PERPUSDT   ┆ 0.299724     ┆ 237  ┆ 2            │
│ OXTUSDT    ┆ 0.860643     ┆ 238  ┆ 1            │
│ DEFIUSDT   ┆ 1.677476     ┆ 239  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,097 - WARNING - 2024-07-03T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:27,097 - INFO - cur close time: 2024-07-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:27,097 - DEBUG - mean expected ret (mean factor): -0.7872898757346108
2024-11-20 23:07:27,101 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,103 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,103 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022441    ┆ 0.16232     ┆ 0.07644     ┆ 0.0102435   ┆ … ┆ 0.01689 ┆ null   ┆ null    ┆ 0.3405  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,109 - DEBUG - update position: 2024-07-03T23:59:59.999 === diff_trading_value: 230029.93006769614 == cash: 180023.45245359893 
2024-11-20 23:07:27,111 - INFO - pnl: 2024-07-03T23:59:59.999 180023.45245359893 === -0.342%
2024-11-20 23:07:27,114 - DEBUG - cur time: 2024-07-04T23:59:59.999 == next bar open time: 2024-07-05T00:00:00.000 == close pos time: 2024-07-12T00:00:00.000
2024-11-20 23:07:27,116 - INFO - pnl: 2024-07-04T23:59:59.999 178338.8849848295 === -0.936%
2024-11-20 23:07:27,119 - DEBUG - cur time: 2024-07-05T23:59:59.999 == next bar open time: 2024-07-06T00:00:00.000 == close pos time: 2024-07-13T00:00:00.000
2024-11-20 23:07:27,121 - INFO - pnl: 2024-07-05T23:59:59.999 178667.50962464453 === 0.184%
2024-11-20 23:07:27,125 - DEBUG - cur time: 2024-07-06T23:59:59.999 == next bar open time: 2024-07-07T00:00:00.000 == close pos time: 2024-07-14T00:00:00.000
2024-11-20 23:07:27,126 - INFO - pnl: 2024-07-06T23:59:59.999 177128.88063780198 === -0.861%
2024-11-20 23:07:27,129 - DEBUG - cur time: 2024-07-07T23:59:59.999 == next bar open time: 2024-07-08T00:00:00.000 == close pos time: 2024-07-15T00:00:00.000
2024-11-20 23:07:27,131 - INFO - pnl: 2024-07-07T23:59:59.999 176950.8324570211 === -0.101%
2024-11-20 23:07:27,134 - DEBUG - cur time: 2024-07-08T23:59:59.999 == next bar open time: 2024-07-09T00:00:00.000 == close pos time: 2024-07-16T00:00:00.000
2024-11-20 23:07:27,136 - INFO - pnl: 2024-07-08T23:59:59.999 176979.9887078374 === 0.016%
2024-11-20 23:07:27,138 - DEBUG - cur time: 2024-07-09T23:59:59.999 == next bar open time: 2024-07-10T00:00:00.000 == close pos time: 2024-07-17T00:00:00.000
2024-11-20 23:07:27,140 - INFO - pnl: 2024-07-09T23:59:59.999 176377.567769971 === -0.340%
2024-11-20 23:07:27,142 - DEBUG - cur time: 2024-07-10T23:59:59.999 == next bar open time: 2024-07-11T00:00:00.000 == close pos time: 2024-07-18T00:00:00.000
2024-11-20 23:07:27,151 - DEBUG - sorted_long_factors: shape: (238, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ BALUSDT    ┆ -2.214735    ┆ 0    ┆ 237          │
│ YFIUSDT    ┆ -2.104589    ┆ 1    ┆ 236          │
│ OMUSDT     ┆ -1.93436     ┆ 2    ┆ 235          │
│ BTCDOMUSDT ┆ -1.89259     ┆ 3    ┆ 234          │
│ DYMUSDT    ┆ -1.856775    ┆ 4    ┆ 233          │
│ BOMEUSDT   ┆ -1.807651    ┆ 5    ┆ 232          │
│ JUPUSDT    ┆ -1.798862    ┆ 6    ┆ 231          │
│ TONUSDT    ┆ -1.663037    ┆ 7    ┆ 230          │
│ BEAMXUSDT  ┆ -1.631065    ┆ 8    ┆ 229          │
│ MTLUSDT    ┆ -1.624477    ┆ 9    ┆ 228          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BNTUSDT    ┆ 0.00755      ┆ 228  ┆ 9            │
│ TUSDT      ┆ 0.036219     ┆ 229  ┆ 8            │
│ XVGUSDT    ┆ 0.036572     ┆ 230  ┆ 7            │
│ TLMUSDT    ┆ 0.056315     ┆ 231  ┆ 6            │
│ OXTUSDT    ┆ 0.060602     ┆ 232  ┆ 5            │
│ GMXUSDT    ┆ 0.28739      ┆ 233  ┆ 4            │
│ BADGERUSDT ┆ 0.306502     ┆ 234  ┆ 3            │
│ STEEMUSDT  ┆ 0.343909     ┆ 235  ┆ 2            │
│ DODOXUSDT  ┆ 0.946496     ┆ 236  ┆ 1            │
│ DEFIUSDT   ┆ 1.300999     ┆ 237  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,164 - WARNING - 2024-07-10T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:27,164 - INFO - cur close time: 2024-07-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:27,165 - DEBUG - mean expected ret (mean factor): -0.7928318079483427
2024-11-20 23:07:27,173 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,173 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,173 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.026444    ┆ 0.14911     ┆ 0.07127     ┆ 0.0091955   ┆ … ┆ 0.01574 ┆ null   ┆ null    ┆ 0.3274  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,183 - DEBUG - update position: 2024-07-10T23:59:59.999 === diff_trading_value: 206372.04273633187 == cash: 177000.55127790026 
2024-11-20 23:07:27,186 - INFO - pnl: 2024-07-10T23:59:59.999 177000.55127790026 === 0.353%
2024-11-20 23:07:27,189 - DEBUG - cur time: 2024-07-11T23:59:59.999 == next bar open time: 2024-07-12T00:00:00.000 == close pos time: 2024-07-19T00:00:00.000
2024-11-20 23:07:27,191 - INFO - pnl: 2024-07-11T23:59:59.999 176460.89411666163 === -0.305%
2024-11-20 23:07:27,196 - DEBUG - cur time: 2024-07-12T23:59:59.999 == next bar open time: 2024-07-13T00:00:00.000 == close pos time: 2024-07-20T00:00:00.000
2024-11-20 23:07:27,197 - INFO - pnl: 2024-07-12T23:59:59.999 177774.7564557258 === 0.745%
2024-11-20 23:07:27,200 - DEBUG - cur time: 2024-07-13T23:59:59.999 == next bar open time: 2024-07-14T00:00:00.000 == close pos time: 2024-07-21T00:00:00.000
2024-11-20 23:07:27,202 - INFO - pnl: 2024-07-13T23:59:59.999 179236.1594672956 === 0.822%
2024-11-20 23:07:27,206 - DEBUG - cur time: 2024-07-14T23:59:59.999 == next bar open time: 2024-07-15T00:00:00.000 == close pos time: 2024-07-22T00:00:00.000
2024-11-20 23:07:27,208 - INFO - pnl: 2024-07-14T23:59:59.999 179915.1178477055 === 0.379%
2024-11-20 23:07:27,212 - DEBUG - cur time: 2024-07-15T23:59:59.999 == next bar open time: 2024-07-16T00:00:00.000 == close pos time: 2024-07-23T00:00:00.000
2024-11-20 23:07:27,214 - INFO - pnl: 2024-07-15T23:59:59.999 179328.82374696457 === -0.326%
2024-11-20 23:07:27,217 - DEBUG - cur time: 2024-07-16T23:59:59.999 == next bar open time: 2024-07-17T00:00:00.000 == close pos time: 2024-07-24T00:00:00.000
2024-11-20 23:07:27,219 - INFO - pnl: 2024-07-16T23:59:59.999 178597.8751993421 === -0.408%
2024-11-20 23:07:27,222 - DEBUG - cur time: 2024-07-17T23:59:59.999 == next bar open time: 2024-07-18T00:00:00.000 == close pos time: 2024-07-25T00:00:00.000
2024-11-20 23:07:27,234 - DEBUG - sorted_long_factors: shape: (240, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ZECUSDT   ┆ -2.004322    ┆ 0    ┆ 239          │
│ ETHFIUSDT ┆ -1.954643    ┆ 1    ┆ 238          │
│ MANTAUSDT ┆ -1.867824    ┆ 2    ┆ 237          │
│ DYMUSDT   ┆ -1.785088    ┆ 3    ┆ 236          │
│ XRPUSDT   ┆ -1.761318    ┆ 4    ┆ 235          │
│ WLDUSDT   ┆ -1.719221    ┆ 5    ┆ 234          │
│ ARKMUSDT  ┆ -1.717153    ┆ 6    ┆ 233          │
│ INJUSDT   ┆ -1.688129    ┆ 7    ┆ 232          │
│ ARUSDT    ┆ -1.685142    ┆ 8    ┆ 231          │
│ FETUSDT   ┆ -1.669287    ┆ 9    ┆ 230          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ARPAUSDT  ┆ -0.019359    ┆ 230  ┆ 9            │
│ GMXUSDT   ┆ 0.011834     ┆ 231  ┆ 8            │
│ AMBUSDT   ┆ 0.029233     ┆ 232  ┆ 7            │
│ BNTUSDT   ┆ 0.062183     ┆ 233  ┆ 6            │
│ BAKEUSDT  ┆ 0.213845     ┆ 234  ┆ 5            │
│ HFTUSDT   ┆ 0.236646     ┆ 235  ┆ 4            │
│ BANDUSDT  ┆ 0.239629     ┆ 236  ┆ 3            │
│ ORBSUSDT  ┆ 0.432201     ┆ 237  ┆ 2            │
│ DODOXUSDT ┆ 0.707938     ┆ 238  ┆ 1            │
│ DEFIUSDT  ┆ 1.84504      ┆ 239  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,239 - WARNING - 2024-07-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:27,239 - INFO - cur close time: 2024-07-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:27,239 - DEBUG - mean expected ret (mean factor): -0.8058564862208129
2024-11-20 23:07:27,243 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,243 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,244 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.026676    ┆ 0.17924     ┆ 0.08991     ┆ 0.0116862   ┆ … ┆ 0.01738 ┆ null   ┆ null    ┆ 0.3576  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,250 - DEBUG - update position: 2024-07-17T23:59:59.999 === diff_trading_value: 297869.3681875861 == cash: 178479.3682566215 
2024-11-20 23:07:27,251 - INFO - pnl: 2024-07-17T23:59:59.999 178479.3682566215 === -0.066%
2024-11-20 23:07:27,255 - DEBUG - cur time: 2024-07-18T23:59:59.999 == next bar open time: 2024-07-19T00:00:00.000 == close pos time: 2024-07-26T00:00:00.000
2024-11-20 23:07:27,256 - INFO - pnl: 2024-07-18T23:59:59.999 181194.17667107793 === 1.521%
2024-11-20 23:07:27,260 - DEBUG - cur time: 2024-07-19T23:59:59.999 == next bar open time: 2024-07-20T00:00:00.000 == close pos time: 2024-07-27T00:00:00.000
2024-11-20 23:07:27,262 - INFO - pnl: 2024-07-19T23:59:59.999 182662.31075067562 === 0.810%
2024-11-20 23:07:27,265 - DEBUG - cur time: 2024-07-20T23:59:59.999 == next bar open time: 2024-07-21T00:00:00.000 == close pos time: 2024-07-28T00:00:00.000
2024-11-20 23:07:27,268 - INFO - pnl: 2024-07-20T23:59:59.999 183933.73656150955 === 0.696%
2024-11-20 23:07:27,272 - DEBUG - cur time: 2024-07-21T23:59:59.999 == next bar open time: 2024-07-22T00:00:00.000 == close pos time: 2024-07-29T00:00:00.000
2024-11-20 23:07:27,273 - INFO - pnl: 2024-07-21T23:59:59.999 184667.07102712465 === 0.399%
2024-11-20 23:07:27,276 - DEBUG - cur time: 2024-07-22T23:59:59.999 == next bar open time: 2024-07-23T00:00:00.000 == close pos time: 2024-07-30T00:00:00.000
2024-11-20 23:07:27,277 - INFO - pnl: 2024-07-22T23:59:59.999 184962.28042290165 === 0.160%
2024-11-20 23:07:27,280 - DEBUG - cur time: 2024-07-23T23:59:59.999 == next bar open time: 2024-07-24T00:00:00.000 == close pos time: 2024-07-31T00:00:00.000
2024-11-20 23:07:27,281 - INFO - pnl: 2024-07-23T23:59:59.999 185480.88658693555 === 0.280%
2024-11-20 23:07:27,285 - DEBUG - cur time: 2024-07-24T23:59:59.999 == next bar open time: 2024-07-25T00:00:00.000 == close pos time: 2024-08-01T00:00:00.000
2024-11-20 23:07:27,293 - DEBUG - sorted_long_factors: shape: (243, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ ETHFIUSDT  ┆ -1.9203      ┆ 0    ┆ 242          │
│ TONUSDT    ┆ -1.81022     ┆ 1    ┆ 241          │
│ WLDUSDT    ┆ -1.734389    ┆ 2    ┆ 240          │
│ STRKUSDT   ┆ -1.717283    ┆ 3    ┆ 239          │
│ XAIUSDT    ┆ -1.712726    ┆ 4    ┆ 238          │
│ JUPUSDT    ┆ -1.704406    ┆ 5    ┆ 237          │
│ TIAUSDT    ┆ -1.650827    ┆ 6    ┆ 236          │
│ DYMUSDT    ┆ -1.625559    ┆ 7    ┆ 235          │
│ UNIUSDT    ┆ -1.569287    ┆ 8    ┆ 234          │
│ ZECUSDT    ┆ -1.554213    ┆ 9    ┆ 233          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BICOUSDT   ┆ 0.094898     ┆ 233  ┆ 9            │
│ NMRUSDT    ┆ 0.106516     ┆ 234  ┆ 8            │
│ BNTUSDT    ┆ 0.141195     ┆ 235  ┆ 7            │
│ BSVUSDT    ┆ 0.14242      ┆ 236  ┆ 6            │
│ XVGUSDT    ┆ 0.191106     ┆ 237  ┆ 5            │
│ RLCUSDT    ┆ 0.248085     ┆ 238  ┆ 4            │
│ LQTYUSDT   ┆ 0.260884     ┆ 239  ┆ 3            │
│ BADGERUSDT ┆ 0.409944     ┆ 240  ┆ 2            │
│ DEFIUSDT   ┆ 0.604995     ┆ 241  ┆ 1            │
│ DODOXUSDT  ┆ 1.000199     ┆ 242  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,299 - WARNING - 2024-07-24T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:27,299 - INFO - cur close time: 2024-07-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:27,299 - DEBUG - mean expected ret (mean factor): -0.7984262500562045
2024-11-20 23:07:27,304 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,305 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,305 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.027464    ┆ 0.17887     ┆ 0.08432     ┆ 0.0122007   ┆ … ┆ 0.01677 ┆ null   ┆ null    ┆ 0.3615  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,312 - DEBUG - update position: 2024-07-24T23:59:59.999 === diff_trading_value: 222618.19328666362 == cash: 185583.8244739385 
2024-11-20 23:07:27,313 - INFO - pnl: 2024-07-24T23:59:59.999 185583.8244739385 === 0.055%
2024-11-20 23:07:27,317 - DEBUG - cur time: 2024-07-25T23:59:59.999 == next bar open time: 2024-07-26T00:00:00.000 == close pos time: 2024-08-02T00:00:00.000
2024-11-20 23:07:27,319 - INFO - pnl: 2024-07-25T23:59:59.999 187286.2455792251 === 0.917%
2024-11-20 23:07:27,322 - DEBUG - cur time: 2024-07-26T23:59:59.999 == next bar open time: 2024-07-27T00:00:00.000 == close pos time: 2024-08-03T00:00:00.000
2024-11-20 23:07:27,324 - INFO - pnl: 2024-07-26T23:59:59.999 187681.85905436467 === 0.211%
2024-11-20 23:07:27,328 - DEBUG - cur time: 2024-07-27T23:59:59.999 == next bar open time: 2024-07-28T00:00:00.000 == close pos time: 2024-08-04T00:00:00.000
2024-11-20 23:07:27,330 - INFO - pnl: 2024-07-27T23:59:59.999 189413.8480256229 === 0.923%
2024-11-20 23:07:27,335 - DEBUG - cur time: 2024-07-28T23:59:59.999 == next bar open time: 2024-07-29T00:00:00.000 == close pos time: 2024-08-05T00:00:00.000
2024-11-20 23:07:27,337 - INFO - pnl: 2024-07-28T23:59:59.999 189035.8360142029 === -0.200%
2024-11-20 23:07:27,340 - DEBUG - cur time: 2024-07-29T23:59:59.999 == next bar open time: 2024-07-30T00:00:00.000 == close pos time: 2024-08-06T00:00:00.000
2024-11-20 23:07:27,341 - INFO - pnl: 2024-07-29T23:59:59.999 192972.5064124299 === 2.082%
2024-11-20 23:07:27,344 - DEBUG - cur time: 2024-07-30T23:59:59.999 == next bar open time: 2024-07-31T00:00:00.000 == close pos time: 2024-08-07T00:00:00.000
2024-11-20 23:07:27,346 - INFO - pnl: 2024-07-30T23:59:59.999 194320.59396182548 === 0.699%
2024-11-20 23:07:27,349 - DEBUG - cur time: 2024-07-31T23:59:59.999 == next bar open time: 2024-08-01T00:00:00.000 == close pos time: 2024-08-08T00:00:00.000
2024-11-20 23:07:27,358 - DEBUG - sorted_long_factors: shape: (244, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ETHFIUSDT ┆ -2.136226    ┆ 0    ┆ 243          │
│ MKRUSDT   ┆ -2.134397    ┆ 1    ┆ 242          │
│ TONUSDT   ┆ -2.105205    ┆ 2    ┆ 241          │
│ ZECUSDT   ┆ -1.994168    ┆ 3    ┆ 240          │
│ OMUSDT    ┆ -1.811906    ┆ 4    ┆ 239          │
│ STRKUSDT  ┆ -1.714299    ┆ 5    ┆ 238          │
│ WIFUSDT   ┆ -1.713488    ┆ 6    ┆ 237          │
│ ENAUSDT   ┆ -1.659035    ┆ 7    ┆ 236          │
│ JUPUSDT   ┆ -1.640779    ┆ 8    ┆ 235          │
│ STXUSDT   ┆ -1.594024    ┆ 9    ┆ 234          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ONEUSDT   ┆ 0.078238     ┆ 234  ┆ 9            │
│ AXSUSDT   ┆ 0.106576     ┆ 235  ┆ 8            │
│ COMBOUSDT ┆ 0.174444     ┆ 236  ┆ 7            │
│ LRCUSDT   ┆ 0.211666     ┆ 237  ┆ 6            │
│ XVGUSDT   ┆ 0.333988     ┆ 238  ┆ 5            │
│ BICOUSDT  ┆ 0.482871     ┆ 239  ┆ 4            │
│ AGLDUSDT  ┆ 0.487567     ┆ 240  ┆ 3            │
│ ATAUSDT   ┆ 0.502244     ┆ 241  ┆ 2            │
│ BNTUSDT   ┆ 0.559631     ┆ 242  ┆ 1            │
│ DEFIUSDT  ┆ 1.084669     ┆ 243  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,364 - INFO - cur close time: 2024-07-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:27,365 - DEBUG - mean expected ret (mean factor): -0.7988349227454655
2024-11-20 23:07:27,369 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,370 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,370 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024495    ┆ 0.16124     ┆ 0.07798     ┆ 0.0110435   ┆ … ┆ 0.0163  ┆ null   ┆ null    ┆ 0.3652  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,376 - DEBUG - update position: 2024-07-31T23:59:59.999 === diff_trading_value: 226930.0249566147 == cash: 194372.2074900208 
2024-11-20 23:07:27,377 - INFO - pnl: 2024-07-31T23:59:59.999 194372.2074900208 === 0.027%
2024-11-20 23:07:27,381 - DEBUG - cur time: 2024-08-01T23:59:59.999 == next bar open time: 2024-08-02T00:00:00.000 == close pos time: 2024-08-09T00:00:00.000
2024-11-20 23:07:27,384 - INFO - pnl: 2024-08-01T23:59:59.999 194540.27489647816 === 0.086%
2024-11-20 23:07:27,387 - DEBUG - cur time: 2024-08-02T23:59:59.999 == next bar open time: 2024-08-03T00:00:00.000 == close pos time: 2024-08-10T00:00:00.000
2024-11-20 23:07:27,389 - INFO - pnl: 2024-08-02T23:59:59.999 196822.1471548166 === 1.173%
2024-11-20 23:07:27,391 - DEBUG - cur time: 2024-08-03T23:59:59.999 == next bar open time: 2024-08-04T00:00:00.000 == close pos time: 2024-08-11T00:00:00.000
2024-11-20 23:07:27,393 - INFO - pnl: 2024-08-03T23:59:59.999 197437.6461727508 === 0.313%
2024-11-20 23:07:27,396 - DEBUG - cur time: 2024-08-04T23:59:59.999 == next bar open time: 2024-08-05T00:00:00.000 == close pos time: 2024-08-12T00:00:00.000
2024-11-20 23:07:27,398 - INFO - pnl: 2024-08-04T23:59:59.999 197958.74034022944 === 0.264%
2024-11-20 23:07:27,401 - DEBUG - cur time: 2024-08-05T23:59:59.999 == next bar open time: 2024-08-06T00:00:00.000 == close pos time: 2024-08-13T00:00:00.000
2024-11-20 23:07:27,403 - INFO - pnl: 2024-08-05T23:59:59.999 198735.64031304402 === 0.392%
2024-11-20 23:07:27,406 - DEBUG - cur time: 2024-08-06T23:59:59.999 == next bar open time: 2024-08-07T00:00:00.000 == close pos time: 2024-08-14T00:00:00.000
2024-11-20 23:07:27,407 - INFO - pnl: 2024-08-06T23:59:59.999 197836.41161624665 === -0.452%
2024-11-20 23:07:27,411 - DEBUG - cur time: 2024-08-07T23:59:59.999 == next bar open time: 2024-08-08T00:00:00.000 == close pos time: 2024-08-15T00:00:00.000
2024-11-20 23:07:27,419 - DEBUG - sorted_long_factors: shape: (244, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT   ┆ -2.972938    ┆ 0    ┆ 243          │
│ BSVUSDT      ┆ -1.997629    ┆ 1    ┆ 242          │
│ BOMEUSDT     ┆ -1.994027    ┆ 2    ┆ 241          │
│ USDCUSDT     ┆ -1.993386    ┆ 3    ┆ 240          │
│ ZECUSDT      ┆ -1.900852    ┆ 4    ┆ 239          │
│ STMXUSDT     ┆ -1.87437     ┆ 5    ┆ 238          │
│ CRVUSDT      ┆ -1.873717    ┆ 6    ┆ 237          │
│ GLMUSDT      ┆ -1.870326    ┆ 7    ┆ 236          │
│ JTOUSDT      ┆ -1.818351    ┆ 8    ┆ 235          │
│ 1000SHIBUSDT ┆ -1.803381    ┆ 9    ┆ 234          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COMBOUSDT    ┆ 0.212623     ┆ 234  ┆ 9            │
│ BNTUSDT      ┆ 0.235234     ┆ 235  ┆ 8            │
│ PERPUSDT     ┆ 0.275286     ┆ 236  ┆ 7            │
│ MOVRUSDT     ┆ 0.308731     ┆ 237  ┆ 6            │
│ SUPERUSDT    ┆ 0.378377     ┆ 238  ┆ 5            │
│ ETHWUSDT     ┆ 0.381303     ┆ 239  ┆ 4            │
│ PHBUSDT      ┆ 0.382187     ┆ 240  ┆ 3            │
│ AGLDUSDT     ┆ 0.409728     ┆ 241  ┆ 2            │
│ JOEUSDT      ┆ 0.442155     ┆ 242  ┆ 1            │
│ DEFIUSDT     ┆ 1.821414     ┆ 243  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,424 - WARNING - 2024-08-07T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:27,425 - INFO - cur close time: 2024-08-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:27,425 - DEBUG - mean expected ret (mean factor): -0.8103658489403248
2024-11-20 23:07:27,429 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,429 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,429 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.019079    ┆ 0.11775     ┆ 0.06527     ┆ 0.007364    ┆ … ┆ 0.0126  ┆ null   ┆ null    ┆ 0.2774  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,436 - DEBUG - update position: 2024-08-07T23:59:59.999 === diff_trading_value: 290074.65088337846 == cash: 197570.3420451504 
2024-11-20 23:07:27,437 - INFO - pnl: 2024-08-07T23:59:59.999 197570.3420451504 === -0.134%
2024-11-20 23:07:27,440 - DEBUG - cur time: 2024-08-08T23:59:59.999 == next bar open time: 2024-08-09T00:00:00.000 == close pos time: 2024-08-16T00:00:00.000
2024-11-20 23:07:27,441 - INFO - pnl: 2024-08-08T23:59:59.999 200370.1627034687 === 1.417%
2024-11-20 23:07:27,445 - DEBUG - cur time: 2024-08-09T23:59:59.999 == next bar open time: 2024-08-10T00:00:00.000 == close pos time: 2024-08-17T00:00:00.000
2024-11-20 23:07:27,446 - INFO - pnl: 2024-08-09T23:59:59.999 198696.95945706603 === -0.835%
2024-11-20 23:07:27,449 - DEBUG - cur time: 2024-08-10T23:59:59.999 == next bar open time: 2024-08-11T00:00:00.000 == close pos time: 2024-08-18T00:00:00.000
2024-11-20 23:07:27,451 - INFO - pnl: 2024-08-10T23:59:59.999 200879.86103288428 === 1.099%
2024-11-20 23:07:27,454 - DEBUG - cur time: 2024-08-11T23:59:59.999 == next bar open time: 2024-08-12T00:00:00.000 == close pos time: 2024-08-19T00:00:00.000
2024-11-20 23:07:27,456 - INFO - pnl: 2024-08-11T23:59:59.999 198829.02481840563 === -1.021%
2024-11-20 23:07:27,459 - DEBUG - cur time: 2024-08-12T23:59:59.999 == next bar open time: 2024-08-13T00:00:00.000 == close pos time: 2024-08-20T00:00:00.000
2024-11-20 23:07:27,460 - INFO - pnl: 2024-08-12T23:59:59.999 199741.52644324105 === 0.459%
2024-11-20 23:07:27,463 - DEBUG - cur time: 2024-08-13T23:59:59.999 == next bar open time: 2024-08-14T00:00:00.000 == close pos time: 2024-08-21T00:00:00.000
2024-11-20 23:07:27,465 - INFO - pnl: 2024-08-13T23:59:59.999 200402.78681185836 === 0.331%
2024-11-20 23:07:27,468 - DEBUG - cur time: 2024-08-14T23:59:59.999 == next bar open time: 2024-08-15T00:00:00.000 == close pos time: 2024-08-22T00:00:00.000
2024-11-20 23:07:27,478 - DEBUG - sorted_long_factors: shape: (245, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ TONUSDT    ┆ -2.364063    ┆ 0    ┆ 244          │
│ BTCDOMUSDT ┆ -2.331754    ┆ 1    ┆ 243          │
│ TRXUSDT    ┆ -2.27438     ┆ 2    ┆ 242          │
│ USDCUSDT   ┆ -2.233613    ┆ 3    ┆ 241          │
│ GLMUSDT    ┆ -2.030568    ┆ 4    ┆ 240          │
│ SAGAUSDT   ┆ -1.918187    ┆ 5    ┆ 239          │
│ STMXUSDT   ┆ -1.886655    ┆ 6    ┆ 238          │
│ CRVUSDT    ┆ -1.85507     ┆ 7    ┆ 237          │
│ OMUSDT     ┆ -1.835399    ┆ 8    ┆ 236          │
│ ZETAUSDT   ┆ -1.832838    ┆ 9    ┆ 235          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BNTUSDT    ┆ 0.166937     ┆ 235  ┆ 9            │
│ NMRUSDT    ┆ 0.36223      ┆ 236  ┆ 8            │
│ PERPUSDT   ┆ 0.366282     ┆ 237  ┆ 7            │
│ ETHWUSDT   ┆ 0.369642     ┆ 238  ┆ 6            │
│ AGLDUSDT   ┆ 0.377282     ┆ 239  ┆ 5            │
│ MOVRUSDT   ┆ 0.4517       ┆ 240  ┆ 4            │
│ RLCUSDT    ┆ 0.488121     ┆ 241  ┆ 3            │
│ JOEUSDT    ┆ 0.645254     ┆ 242  ┆ 2            │
│ DODOXUSDT  ┆ 1.018458     ┆ 243  ┆ 1            │
│ DEFIUSDT   ┆ 1.591695     ┆ 244  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,486 - WARNING - 2024-08-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:27,487 - INFO - cur close time: 2024-08-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:27,487 - DEBUG - mean expected ret (mean factor): -0.811014778717139
2024-11-20 23:07:27,491 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,492 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,492 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.019197    ┆ 0.11891     ┆ 0.08123     ┆ 0.0080065   ┆ … ┆ 0.01363 ┆ null   ┆ null    ┆ 0.3115  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,500 - DEBUG - update position: 2024-08-14T23:59:59.999 === diff_trading_value: 202953.6174467073 == cash: 197486.01099924365 
2024-11-20 23:07:27,501 - INFO - pnl: 2024-08-14T23:59:59.999 197486.01099924365 === -1.455%
2024-11-20 23:07:27,503 - DEBUG - cur time: 2024-08-15T23:59:59.999 == next bar open time: 2024-08-16T00:00:00.000 == close pos time: 2024-08-23T00:00:00.000
2024-11-20 23:07:27,505 - INFO - pnl: 2024-08-15T23:59:59.999 196789.47575840654 === -0.353%
2024-11-20 23:07:27,509 - DEBUG - cur time: 2024-08-16T23:59:59.999 == next bar open time: 2024-08-17T00:00:00.000 == close pos time: 2024-08-24T00:00:00.000
2024-11-20 23:07:27,511 - INFO - pnl: 2024-08-16T23:59:59.999 197191.006168143 === 0.204%
2024-11-20 23:07:27,515 - DEBUG - cur time: 2024-08-17T23:59:59.999 == next bar open time: 2024-08-18T00:00:00.000 == close pos time: 2024-08-25T00:00:00.000
2024-11-20 23:07:27,517 - INFO - pnl: 2024-08-17T23:59:59.999 200393.39811158215 === 1.624%
2024-11-20 23:07:27,520 - DEBUG - cur time: 2024-08-18T23:59:59.999 == next bar open time: 2024-08-19T00:00:00.000 == close pos time: 2024-08-26T00:00:00.000
2024-11-20 23:07:27,521 - INFO - pnl: 2024-08-18T23:59:59.999 205061.61087658748 === 2.330%
2024-11-20 23:07:27,524 - DEBUG - cur time: 2024-08-19T23:59:59.999 == next bar open time: 2024-08-20T00:00:00.000 == close pos time: 2024-08-27T00:00:00.000
2024-11-20 23:07:27,526 - INFO - pnl: 2024-08-19T23:59:59.999 208366.80739247386 === 1.612%
2024-11-20 23:07:27,530 - DEBUG - cur time: 2024-08-20T23:59:59.999 == next bar open time: 2024-08-21T00:00:00.000 == close pos time: 2024-08-28T00:00:00.000
2024-11-20 23:07:27,533 - INFO - pnl: 2024-08-20T23:59:59.999 208422.68664515004 === 0.027%
2024-11-20 23:07:27,536 - DEBUG - cur time: 2024-08-21T23:59:59.999 == next bar open time: 2024-08-22T00:00:00.000 == close pos time: 2024-08-29T00:00:00.000
2024-11-20 23:07:27,546 - DEBUG - sorted_long_factors: shape: (245, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT   ┆ -2.026699    ┆ 0    ┆ 244          │
│ ETHFIUSDT ┆ -1.803572    ┆ 1    ┆ 243          │
│ TIAUSDT   ┆ -1.785726    ┆ 2    ┆ 242          │
│ GMXUSDT   ┆ -1.773887    ┆ 3    ┆ 241          │
│ TONUSDT   ┆ -1.736238    ┆ 4    ┆ 240          │
│ DYMUSDT   ┆ -1.701168    ┆ 5    ┆ 239          │
│ INJUSDT   ┆ -1.660668    ┆ 6    ┆ 238          │
│ TAOUSDT   ┆ -1.633405    ┆ 7    ┆ 237          │
│ XMRUSDT   ┆ -1.615792    ┆ 8    ┆ 236          │
│ SAGAUSDT  ┆ -1.589793    ┆ 9    ┆ 235          │
│ …         ┆ …            ┆ …    ┆ …            │
│ DASHUSDT  ┆ 0.097327     ┆ 235  ┆ 9            │
│ OMGUSDT   ┆ 0.099778     ┆ 236  ┆ 8            │
│ BALUSDT   ┆ 0.121663     ┆ 237  ┆ 7            │
│ STEEMUSDT ┆ 0.195662     ┆ 238  ┆ 6            │
│ BNTUSDT   ┆ 0.31307      ┆ 239  ┆ 5            │
│ ILVUSDT   ┆ 0.411598     ┆ 240  ┆ 4            │
│ OXTUSDT   ┆ 0.743191     ┆ 241  ┆ 3            │
│ HFTUSDT   ┆ 0.921216     ┆ 242  ┆ 2            │
│ ETHWUSDT  ┆ 0.949102     ┆ 243  ┆ 1            │
│ DEFIUSDT  ┆ 1.056148     ┆ 244  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,554 - INFO - cur close time: 2024-08-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:27,554 - DEBUG - mean expected ret (mean factor): -0.7978033884474958
2024-11-20 23:07:27,558 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,559 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,559 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.018556    ┆ 0.12749     ┆ 0.0834      ┆ 0.0079182   ┆ … ┆ 0.01432 ┆ null   ┆ null    ┆ 0.3219  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,565 - DEBUG - update position: 2024-08-21T23:59:59.999 === diff_trading_value: 288120.6699567351 == cash: 213655.6745679085 
2024-11-20 23:07:27,566 - INFO - pnl: 2024-08-21T23:59:59.999 213655.6745679085 === 2.511%
2024-11-20 23:07:27,569 - DEBUG - cur time: 2024-08-22T23:59:59.999 == next bar open time: 2024-08-23T00:00:00.000 == close pos time: 2024-08-30T00:00:00.000
2024-11-20 23:07:27,570 - INFO - pnl: 2024-08-22T23:59:59.999 212603.4255556063 === -0.492%
2024-11-20 23:07:27,573 - DEBUG - cur time: 2024-08-23T23:59:59.999 == next bar open time: 2024-08-24T00:00:00.000 == close pos time: 2024-08-31T00:00:00.000
2024-11-20 23:07:27,574 - INFO - pnl: 2024-08-23T23:59:59.999 207270.4152139391 === -2.508%
2024-11-20 23:07:27,577 - DEBUG - cur time: 2024-08-24T23:59:59.999 == next bar open time: 2024-08-25T00:00:00.000 == close pos time: 2024-09-01T00:00:00.000
2024-11-20 23:07:27,579 - INFO - pnl: 2024-08-24T23:59:59.999 206133.74694659546 === -0.548%
2024-11-20 23:07:27,581 - DEBUG - cur time: 2024-08-25T23:59:59.999 == next bar open time: 2024-08-26T00:00:00.000 == close pos time: 2024-09-02T00:00:00.000
2024-11-20 23:07:27,584 - INFO - pnl: 2024-08-25T23:59:59.999 205803.59003631986 === -0.160%
2024-11-20 23:07:27,587 - DEBUG - cur time: 2024-08-26T23:59:59.999 == next bar open time: 2024-08-27T00:00:00.000 == close pos time: 2024-09-03T00:00:00.000
2024-11-20 23:07:27,588 - INFO - pnl: 2024-08-26T23:59:59.999 207017.68808328593 === 0.590%
2024-11-20 23:07:27,590 - DEBUG - cur time: 2024-08-27T23:59:59.999 == next bar open time: 2024-08-28T00:00:00.000 == close pos time: 2024-09-04T00:00:00.000
2024-11-20 23:07:27,592 - INFO - pnl: 2024-08-27T23:59:59.999 207782.5762152581 === 0.369%
2024-11-20 23:07:27,594 - DEBUG - cur time: 2024-08-28T23:59:59.999 == next bar open time: 2024-08-29T00:00:00.000 == close pos time: 2024-09-05T00:00:00.000
2024-11-20 23:07:27,604 - DEBUG - sorted_long_factors: shape: (247, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AUCTIONUSDT  ┆ -2.096396    ┆ 0    ┆ 246          │
│ TAOUSDT      ┆ -1.884083    ┆ 1    ┆ 245          │
│ XMRUSDT      ┆ -1.712794    ┆ 2    ┆ 244          │
│ NOTUSDT      ┆ -1.702303    ┆ 3    ┆ 243          │
│ 1000LUNCUSDT ┆ -1.697834    ┆ 4    ┆ 242          │
│ ETHFIUSDT    ┆ -1.660417    ┆ 5    ┆ 241          │
│ YFIUSDT      ┆ -1.633636    ┆ 6    ┆ 240          │
│ ICPUSDT      ┆ -1.605796    ┆ 7    ┆ 239          │
│ ATOMUSDT     ┆ -1.58985     ┆ 8    ┆ 238          │
│ LUNA2USDT    ┆ -1.585213    ┆ 9    ┆ 237          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RLCUSDT      ┆ 0.231406     ┆ 237  ┆ 9            │
│ HFTUSDT      ┆ 0.243237     ┆ 238  ┆ 8            │
│ OMGUSDT      ┆ 0.279006     ┆ 239  ┆ 7            │
│ LSKUSDT      ┆ 0.344602     ┆ 240  ┆ 6            │
│ AGLDUSDT     ┆ 0.429054     ┆ 241  ┆ 5            │
│ PERPUSDT     ┆ 0.506216     ┆ 242  ┆ 4            │
│ XVGUSDT      ┆ 0.506322     ┆ 243  ┆ 3            │
│ STEEMUSDT    ┆ 0.796558     ┆ 244  ┆ 2            │
│ ETHWUSDT     ┆ 1.04475      ┆ 245  ┆ 1            │
│ DEFIUSDT     ┆ 1.491338     ┆ 246  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,611 - WARNING - 2024-08-28T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:27,611 - INFO - cur close time: 2024-08-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:27,611 - DEBUG - mean expected ret (mean factor): -0.7792059658779847
2024-11-20 23:07:27,615 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,615 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,617 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.018087    ┆ 0.15495     ┆ 0.08248     ┆ 0.0076822   ┆ … ┆ 0.01351 ┆ null   ┆ null    ┆ 0.2969  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,621 - DEBUG - update position: 2024-08-28T23:59:59.999 === diff_trading_value: 244279.40865449628 == cash: 209329.53397050567 
2024-11-20 23:07:27,624 - INFO - pnl: 2024-08-28T23:59:59.999 209329.53397050567 === 0.745%
2024-11-20 23:07:27,629 - DEBUG - cur time: 2024-08-29T23:59:59.999 == next bar open time: 2024-08-30T00:00:00.000 == close pos time: 2024-09-06T00:00:00.000
2024-11-20 23:07:27,631 - INFO - pnl: 2024-08-29T23:59:59.999 209359.38998561792 === 0.014%
2024-11-20 23:07:27,635 - DEBUG - cur time: 2024-08-30T23:59:59.999 == next bar open time: 2024-08-31T00:00:00.000 == close pos time: 2024-09-07T00:00:00.000
2024-11-20 23:07:27,637 - INFO - pnl: 2024-08-30T23:59:59.999 209420.68881199954 === 0.029%
2024-11-20 23:07:27,640 - DEBUG - cur time: 2024-08-31T23:59:59.999 == next bar open time: 2024-09-01T00:00:00.000 == close pos time: 2024-09-08T00:00:00.000
2024-11-20 23:07:27,641 - INFO - pnl: 2024-08-31T23:59:59.999 208940.95082025466 === -0.229%
2024-11-20 23:07:27,644 - DEBUG - cur time: 2024-09-01T23:59:59.999 == next bar open time: 2024-09-02T00:00:00.000 == close pos time: 2024-09-09T00:00:00.000
2024-11-20 23:07:27,645 - INFO - pnl: 2024-09-01T23:59:59.999 209210.551821691 === 0.129%
2024-11-20 23:07:27,649 - DEBUG - cur time: 2024-09-02T23:59:59.999 == next bar open time: 2024-09-03T00:00:00.000 == close pos time: 2024-09-10T00:00:00.000
2024-11-20 23:07:27,650 - INFO - pnl: 2024-09-02T23:59:59.999 210178.73735708662 === 0.463%
2024-11-20 23:07:27,654 - DEBUG - cur time: 2024-09-03T23:59:59.999 == next bar open time: 2024-09-04T00:00:00.000 == close pos time: 2024-09-11T00:00:00.000
2024-11-20 23:07:27,655 - INFO - pnl: 2024-09-03T23:59:59.999 211370.8050799912 === 0.567%
2024-11-20 23:07:27,658 - DEBUG - cur time: 2024-09-04T23:59:59.999 == next bar open time: 2024-09-05T00:00:00.000 == close pos time: 2024-09-12T00:00:00.000
2024-11-20 23:07:27,667 - DEBUG - sorted_long_factors: shape: (246, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ TONUSDT       ┆ -2.207856    ┆ 0    ┆ 245          │
│ BTCDOMUSDT    ┆ -2.189765    ┆ 1    ┆ 244          │
│ TAOUSDT       ┆ -2.103189    ┆ 2    ┆ 243          │
│ XMRUSDT       ┆ -1.942617    ┆ 3    ┆ 242          │
│ GMXUSDT       ┆ -1.837584    ┆ 4    ┆ 241          │
│ ZECUSDT       ┆ -1.778251    ┆ 5    ┆ 240          │
│ UNIUSDT       ┆ -1.742038    ┆ 6    ┆ 239          │
│ 1000FLOKIUSDT ┆ -1.695543    ┆ 7    ┆ 238          │
│ BONDUSDT      ┆ -1.691818    ┆ 8    ┆ 237          │
│ MKRUSDT       ┆ -1.659909    ┆ 9    ┆ 236          │
│ …             ┆ …            ┆ …    ┆ …            │
│ TLMUSDT       ┆ 0.149246     ┆ 236  ┆ 9            │
│ OMGUSDT       ┆ 0.20567      ┆ 237  ┆ 8            │
│ ILVUSDT       ┆ 0.210147     ┆ 238  ┆ 7            │
│ PERPUSDT      ┆ 0.261977     ┆ 239  ┆ 6            │
│ ONGUSDT       ┆ 0.306631     ┆ 240  ┆ 5            │
│ WAXPUSDT      ┆ 0.381781     ┆ 241  ┆ 4            │
│ XVGUSDT       ┆ 0.575137     ┆ 242  ┆ 3            │
│ STEEMUSDT     ┆ 0.986369     ┆ 243  ┆ 2            │
│ DEFIUSDT      ┆ 1.328732     ┆ 244  ┆ 1            │
│ ETHWUSDT      ┆ 1.641507     ┆ 245  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,672 - WARNING - 2024-09-04T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:27,673 - INFO - cur close time: 2024-09-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:27,673 - DEBUG - mean expected ret (mean factor): -0.7701499344026005
2024-11-20 23:07:27,677 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,677 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,677 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.016833    ┆ 0.12221     ┆ 0.07729     ┆ 0.0073526   ┆ … ┆ 0.01343 ┆ null   ┆ null    ┆ 0.2846  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,683 - DEBUG - update position: 2024-09-04T23:59:59.999 === diff_trading_value: 246643.68426071585 == cash: 212290.419355784 
2024-11-20 23:07:27,685 - INFO - pnl: 2024-09-04T23:59:59.999 212290.419355784 === 0.435%
2024-11-20 23:07:27,688 - DEBUG - cur time: 2024-09-05T23:59:59.999 == next bar open time: 2024-09-06T00:00:00.000 == close pos time: 2024-09-13T00:00:00.000
2024-11-20 23:07:27,689 - INFO - pnl: 2024-09-05T23:59:59.999 211427.79958255414 === -0.406%
2024-11-20 23:07:27,692 - DEBUG - cur time: 2024-09-06T23:59:59.999 == next bar open time: 2024-09-07T00:00:00.000 == close pos time: 2024-09-14T00:00:00.000
2024-11-20 23:07:27,693 - INFO - pnl: 2024-09-06T23:59:59.999 212192.79542852586 === 0.362%
2024-11-20 23:07:27,695 - DEBUG - cur time: 2024-09-07T23:59:59.999 == next bar open time: 2024-09-08T00:00:00.000 == close pos time: 2024-09-15T00:00:00.000
2024-11-20 23:07:27,697 - INFO - pnl: 2024-09-07T23:59:59.999 213329.95706307856 === 0.536%
2024-11-20 23:07:27,700 - DEBUG - cur time: 2024-09-08T23:59:59.999 == next bar open time: 2024-09-09T00:00:00.000 == close pos time: 2024-09-16T00:00:00.000
2024-11-20 23:07:27,701 - INFO - pnl: 2024-09-08T23:59:59.999 214481.9338015662 === 0.540%
2024-11-20 23:07:27,703 - DEBUG - cur time: 2024-09-09T23:59:59.999 == next bar open time: 2024-09-10T00:00:00.000 == close pos time: 2024-09-17T00:00:00.000
2024-11-20 23:07:27,704 - INFO - pnl: 2024-09-09T23:59:59.999 214355.30815969504 === -0.059%
2024-11-20 23:07:27,707 - DEBUG - cur time: 2024-09-10T23:59:59.999 == next bar open time: 2024-09-11T00:00:00.000 == close pos time: 2024-09-18T00:00:00.000
2024-11-20 23:07:27,708 - INFO - pnl: 2024-09-10T23:59:59.999 214330.67282832917 === -0.011%
2024-11-20 23:07:27,711 - DEBUG - cur time: 2024-09-11T23:59:59.999 == next bar open time: 2024-09-12T00:00:00.000 == close pos time: 2024-09-19T00:00:00.000
2024-11-20 23:07:27,722 - DEBUG - sorted_long_factors: shape: (247, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ XMRUSDT    ┆ -2.200079    ┆ 0    ┆ 246          │
│ BTCDOMUSDT ┆ -2.006082    ┆ 1    ┆ 245          │
│ BONDUSDT   ┆ -1.904805    ┆ 2    ┆ 244          │
│ FETUSDT    ┆ -1.824172    ┆ 3    ┆ 243          │
│ PENDLEUSDT ┆ -1.731899    ┆ 4    ┆ 242          │
│ TRBUSDT    ┆ -1.70658     ┆ 5    ┆ 241          │
│ INJUSDT    ┆ -1.698599    ┆ 6    ┆ 240          │
│ SFPUSDT    ┆ -1.678711    ┆ 7    ┆ 239          │
│ AAVEUSDT   ┆ -1.662995    ┆ 8    ┆ 238          │
│ TAOUSDT    ┆ -1.629352    ┆ 9    ┆ 237          │
│ …          ┆ …            ┆ …    ┆ …            │
│ MAVIAUSDT  ┆ 0.265706     ┆ 237  ┆ 9            │
│ FXSUSDT    ┆ 0.292846     ┆ 238  ┆ 8            │
│ BICOUSDT   ┆ 0.329208     ┆ 239  ┆ 7            │
│ STEEMUSDT  ┆ 0.359544     ┆ 240  ┆ 6            │
│ COMBOUSDT  ┆ 0.381647     ┆ 241  ┆ 5            │
│ DODOXUSDT  ┆ 0.418359     ┆ 242  ┆ 4            │
│ HFTUSDT    ┆ 0.421398     ┆ 243  ┆ 3            │
│ OMGUSDT    ┆ 0.459747     ┆ 244  ┆ 2            │
│ ETHWUSDT   ┆ 0.924214     ┆ 245  ┆ 1            │
│ DEFIUSDT   ┆ 1.269639     ┆ 246  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,727 - WARNING - 2024-09-11T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:27,727 - INFO - cur close time: 2024-09-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:27,727 - DEBUG - mean expected ret (mean factor): -0.7723318873438175
2024-11-20 23:07:27,731 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,731 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,733 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.016579    ┆ 0.12262     ┆ 0.08277     ┆ 0.0072336   ┆ … ┆ 0.01323 ┆ null   ┆ null    ┆ 0.2767  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,740 - DEBUG - update position: 2024-09-11T23:59:59.999 === diff_trading_value: 235972.24429916323 == cash: 213336.3530410148 
2024-11-20 23:07:27,741 - INFO - pnl: 2024-09-11T23:59:59.999 213336.3530410148 === -0.464%
2024-11-20 23:07:27,744 - DEBUG - cur time: 2024-09-12T23:59:59.999 == next bar open time: 2024-09-13T00:00:00.000 == close pos time: 2024-09-20T00:00:00.000
2024-11-20 23:07:27,746 - INFO - pnl: 2024-09-12T23:59:59.999 215596.76152857544 === 1.060%
2024-11-20 23:07:27,748 - DEBUG - cur time: 2024-09-13T23:59:59.999 == next bar open time: 2024-09-14T00:00:00.000 == close pos time: 2024-09-21T00:00:00.000
2024-11-20 23:07:27,750 - INFO - pnl: 2024-09-13T23:59:59.999 215826.17327117993 === 0.106%
2024-11-20 23:07:27,753 - DEBUG - cur time: 2024-09-14T23:59:59.999 == next bar open time: 2024-09-15T00:00:00.000 == close pos time: 2024-09-22T00:00:00.000
2024-11-20 23:07:27,754 - INFO - pnl: 2024-09-14T23:59:59.999 214745.58197737474 === -0.501%
2024-11-20 23:07:27,757 - DEBUG - cur time: 2024-09-15T23:59:59.999 == next bar open time: 2024-09-16T00:00:00.000 == close pos time: 2024-09-23T00:00:00.000
2024-11-20 23:07:27,759 - INFO - pnl: 2024-09-15T23:59:59.999 215183.54937167052 === 0.204%
2024-11-20 23:07:27,762 - DEBUG - cur time: 2024-09-16T23:59:59.999 == next bar open time: 2024-09-17T00:00:00.000 == close pos time: 2024-09-24T00:00:00.000
2024-11-20 23:07:27,763 - INFO - pnl: 2024-09-16T23:59:59.999 214009.05395457576 === -0.546%
2024-11-20 23:07:27,767 - DEBUG - cur time: 2024-09-17T23:59:59.999 == next bar open time: 2024-09-18T00:00:00.000 == close pos time: 2024-09-25T00:00:00.000
2024-11-20 23:07:27,769 - INFO - pnl: 2024-09-17T23:59:59.999 214861.44654889873 === 0.398%
2024-11-20 23:07:27,771 - DEBUG - cur time: 2024-09-18T23:59:59.999 == next bar open time: 2024-09-19T00:00:00.000 == close pos time: 2024-09-26T00:00:00.000
2024-11-20 23:07:27,780 - DEBUG - sorted_long_factors: shape: (247, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ SAGAUSDT    ┆ -2.158001    ┆ 0    ┆ 246          │
│ BTCDOMUSDT  ┆ -1.856274    ┆ 1    ┆ 245          │
│ BBUSDT      ┆ -1.776024    ┆ 2    ┆ 244          │
│ BNXUSDT     ┆ -1.682658    ┆ 3    ┆ 243          │
│ TIAUSDT     ┆ -1.674347    ┆ 4    ┆ 242          │
│ API3USDT    ┆ -1.654151    ┆ 5    ┆ 241          │
│ AAVEUSDT    ┆ -1.603075    ┆ 6    ┆ 240          │
│ AUCTIONUSDT ┆ -1.592029    ┆ 7    ┆ 239          │
│ YFIUSDT     ┆ -1.590717    ┆ 8    ┆ 238          │
│ WIFUSDT     ┆ -1.536713    ┆ 9    ┆ 237          │
│ …           ┆ …            ┆ …    ┆ …            │
│ BNTUSDT     ┆ 0.340603     ┆ 237  ┆ 9            │
│ FXSUSDT     ┆ 0.38916      ┆ 238  ┆ 8            │
│ STEEMUSDT   ┆ 0.443044     ┆ 239  ┆ 7            │
│ BADGERUSDT  ┆ 0.523327     ┆ 240  ┆ 6            │
│ DODOXUSDT   ┆ 0.528932     ┆ 241  ┆ 5            │
│ BICOUSDT    ┆ 0.623286     ┆ 242  ┆ 4            │
│ ETHWUSDT    ┆ 0.692813     ┆ 243  ┆ 3            │
│ HFTUSDT     ┆ 0.759001     ┆ 244  ┆ 2            │
│ COMBOUSDT   ┆ 0.915853     ┆ 245  ┆ 1            │
│ DEFIUSDT    ┆ 1.558686     ┆ 246  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,788 - WARNING - 2024-09-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:27,788 - INFO - cur close time: 2024-09-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:27,788 - DEBUG - mean expected ret (mean factor): -0.752823487558599
2024-11-20 23:07:27,793 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,793 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,794 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.016923    ┆ 0.12836     ┆ 0.08331     ┆ 0.007528    ┆ … ┆ 0.01379 ┆ null   ┆ null    ┆ 0.2965  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,799 - DEBUG - update position: 2024-09-18T23:59:59.999 === diff_trading_value: 261174.95048491767 == cash: 215797.3249123761 
2024-11-20 23:07:27,800 - INFO - pnl: 2024-09-18T23:59:59.999 215797.3249123761 === 0.436%
2024-11-20 23:07:27,803 - DEBUG - cur time: 2024-09-19T23:59:59.999 == next bar open time: 2024-09-20T00:00:00.000 == close pos time: 2024-09-27T00:00:00.000
2024-11-20 23:07:27,804 - INFO - pnl: 2024-09-19T23:59:59.999 217708.14029294375 === 0.885%
2024-11-20 23:07:27,807 - DEBUG - cur time: 2024-09-20T23:59:59.999 == next bar open time: 2024-09-21T00:00:00.000 == close pos time: 2024-09-28T00:00:00.000
2024-11-20 23:07:27,809 - INFO - pnl: 2024-09-20T23:59:59.999 222074.08825805967 === 2.005%
2024-11-20 23:07:27,812 - DEBUG - cur time: 2024-09-21T23:59:59.999 == next bar open time: 2024-09-22T00:00:00.000 == close pos time: 2024-09-29T00:00:00.000
2024-11-20 23:07:27,814 - INFO - pnl: 2024-09-21T23:59:59.999 224439.8944326293 === 1.065%
2024-11-20 23:07:27,818 - DEBUG - cur time: 2024-09-22T23:59:59.999 == next bar open time: 2024-09-23T00:00:00.000 == close pos time: 2024-09-30T00:00:00.000
2024-11-20 23:07:27,820 - INFO - pnl: 2024-09-22T23:59:59.999 223779.19337394388 === -0.294%
2024-11-20 23:07:27,824 - DEBUG - cur time: 2024-09-23T23:59:59.999 == next bar open time: 2024-09-24T00:00:00.000 == close pos time: 2024-10-01T00:00:00.000
2024-11-20 23:07:27,826 - INFO - pnl: 2024-09-23T23:59:59.999 223278.15735345896 === -0.224%
2024-11-20 23:07:27,830 - DEBUG - cur time: 2024-09-24T23:59:59.999 == next bar open time: 2024-09-25T00:00:00.000 == close pos time: 2024-10-02T00:00:00.000
2024-11-20 23:07:27,831 - INFO - pnl: 2024-09-24T23:59:59.999 224856.04338776786 === 0.707%
2024-11-20 23:07:27,836 - DEBUG - cur time: 2024-09-25T23:59:59.999 == next bar open time: 2024-09-26T00:00:00.000 == close pos time: 2024-10-03T00:00:00.000
2024-11-20 23:07:27,848 - DEBUG - sorted_long_factors: shape: (248, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TAOUSDT      ┆ -2.446103    ┆ 0    ┆ 247          │
│ BSVUSDT      ┆ -1.887904    ┆ 1    ┆ 246          │
│ ETHFIUSDT    ┆ -1.857625    ┆ 2    ┆ 245          │
│ TWTUSDT      ┆ -1.720656    ┆ 3    ┆ 244          │
│ BTCDOMUSDT   ┆ -1.703256    ┆ 4    ┆ 243          │
│ WIFUSDT      ┆ -1.628983    ┆ 5    ┆ 242          │
│ 1000LUNCUSDT ┆ -1.57249     ┆ 6    ┆ 241          │
│ PEOPLEUSDT   ┆ -1.565239    ┆ 7    ┆ 240          │
│ NOTUSDT      ┆ -1.560454    ┆ 8    ┆ 239          │
│ STRKUSDT     ┆ -1.491159    ┆ 9    ┆ 238          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DUSKUSDT     ┆ 0.098537     ┆ 238  ┆ 9            │
│ CELRUSDT     ┆ 0.122188     ┆ 239  ┆ 8            │
│ DASHUSDT     ┆ 0.190459     ┆ 240  ┆ 7            │
│ BICOUSDT     ┆ 0.206445     ┆ 241  ┆ 6            │
│ ETHWUSDT     ┆ 0.209106     ┆ 242  ┆ 5            │
│ RIFUSDT      ┆ 0.282262     ┆ 243  ┆ 4            │
│ XVGUSDT      ┆ 0.390951     ┆ 244  ┆ 3            │
│ BNTUSDT      ┆ 0.498662     ┆ 245  ┆ 2            │
│ COMBOUSDT    ┆ 0.682681     ┆ 246  ┆ 1            │
│ DEFIUSDT     ┆ 3.164206     ┆ 247  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,855 - WARNING - 2024-09-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:27,855 - INFO - cur close time: 2024-09-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:27,856 - DEBUG - mean expected ret (mean factor): -0.7571078144999724
2024-11-20 23:07:27,860 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,860 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,860 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.018543    ┆ 0.13737     ┆ 0.08648     ┆ 0.0084426  ┆ … ┆ 0.01563 ┆ 0.13121 ┆ null    ┆ 0.3472  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:27,867 - DEBUG - update position: 2024-09-25T23:59:59.999 === diff_trading_value: 266421.21951734985 == cash: 222375.8997095437 
2024-11-20 23:07:27,868 - INFO - pnl: 2024-09-25T23:59:59.999 222375.8997095437 === -1.103%
2024-11-20 23:07:27,871 - DEBUG - cur time: 2024-09-26T23:59:59.999 == next bar open time: 2024-09-27T00:00:00.000 == close pos time: 2024-10-04T00:00:00.000
2024-11-20 23:07:27,873 - INFO - pnl: 2024-09-26T23:59:59.999 220354.34251885494 === -0.909%
2024-11-20 23:07:27,877 - DEBUG - cur time: 2024-09-27T23:59:59.999 == next bar open time: 2024-09-28T00:00:00.000 == close pos time: 2024-10-05T00:00:00.000
2024-11-20 23:07:27,879 - INFO - pnl: 2024-09-27T23:59:59.999 217701.06210791934 === -1.204%
2024-11-20 23:07:27,882 - DEBUG - cur time: 2024-09-28T23:59:59.999 == next bar open time: 2024-09-29T00:00:00.000 == close pos time: 2024-10-06T00:00:00.000
2024-11-20 23:07:27,883 - INFO - pnl: 2024-09-28T23:59:59.999 219525.73503738322 === 0.838%
2024-11-20 23:07:27,888 - DEBUG - cur time: 2024-09-29T23:59:59.999 == next bar open time: 2024-09-30T00:00:00.000 == close pos time: 2024-10-07T00:00:00.000
2024-11-20 23:07:27,889 - INFO - pnl: 2024-09-29T23:59:59.999 219830.60588296724 === 0.139%
2024-11-20 23:07:27,893 - DEBUG - cur time: 2024-09-30T23:59:59.999 == next bar open time: 2024-10-01T00:00:00.000 == close pos time: 2024-10-08T00:00:00.000
2024-11-20 23:07:27,894 - INFO - pnl: 2024-09-30T23:59:59.999 217176.66623257307 === -1.207%
2024-11-20 23:07:27,899 - DEBUG - cur time: 2024-10-01T23:59:59.999 == next bar open time: 2024-10-02T00:00:00.000 == close pos time: 2024-10-09T00:00:00.000
2024-11-20 23:07:27,900 - INFO - pnl: 2024-10-01T23:59:59.999 217005.80988239523 === -0.079%
2024-11-20 23:07:27,903 - DEBUG - cur time: 2024-10-02T23:59:59.999 == next bar open time: 2024-10-03T00:00:00.000 == close pos time: 2024-10-10T00:00:00.000
2024-11-20 23:07:27,911 - DEBUG - sorted_long_factors: shape: (252, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ SAGAUSDT   ┆ -2.00305     ┆ 0    ┆ 251          │
│ WUSDT      ┆ -1.922132    ┆ 1    ┆ 250          │
│ UMAUSDT    ┆ -1.801562    ┆ 2    ┆ 249          │
│ ETHFIUSDT  ┆ -1.783789    ┆ 3    ┆ 248          │
│ UNFIUSDT   ┆ -1.744652    ┆ 4    ┆ 247          │
│ RUNEUSDT   ┆ -1.66734     ┆ 5    ┆ 246          │
│ XRPUSDT    ┆ -1.648413    ┆ 6    ┆ 245          │
│ OMNIUSDT   ┆ -1.59114     ┆ 7    ┆ 244          │
│ GASUSDT    ┆ -1.577059    ┆ 8    ┆ 243          │
│ TAOUSDT    ┆ -1.567548    ┆ 9    ┆ 242          │
│ …          ┆ …            ┆ …    ┆ …            │
│ MAVIAUSDT  ┆ 0.232645     ┆ 242  ┆ 9            │
│ XVGUSDT    ┆ 0.246007     ┆ 243  ┆ 8            │
│ JOEUSDT    ┆ 0.250217     ┆ 244  ┆ 7            │
│ BICOUSDT   ┆ 0.251628     ┆ 245  ┆ 6            │
│ QNTUSDT    ┆ 0.393631     ┆ 246  ┆ 5            │
│ BADGERUSDT ┆ 0.472609     ┆ 247  ┆ 4            │
│ PERPUSDT   ┆ 0.474309     ┆ 248  ┆ 3            │
│ HFTUSDT    ┆ 0.519511     ┆ 249  ┆ 2            │
│ LSKUSDT    ┆ 0.629794     ┆ 250  ┆ 1            │
│ DEFIUSDT   ┆ 2.280631     ┆ 251  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,918 - WARNING - 2024-10-02T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:27,918 - INFO - cur close time: 2024-10-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:27,918 - DEBUG - mean expected ret (mean factor): -0.756418112518501
2024-11-20 23:07:27,922 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,923 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:27,923 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.021999    ┆ 0.13335     ┆ 0.08547     ┆ 0.0092371  ┆ … ┆ 0.01362 ┆ 0.12362 ┆ 4.1195  ┆ 0.3026  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:27,930 - DEBUG - update position: 2024-10-02T23:59:59.999 === diff_trading_value: 297194.08805469074 == cash: 216737.6776434654 
2024-11-20 23:07:27,931 - INFO - pnl: 2024-10-02T23:59:59.999 216737.6776434654 === -0.124%
2024-11-20 23:07:27,937 - DEBUG - cur time: 2024-10-03T23:59:59.999 == next bar open time: 2024-10-04T00:00:00.000 == close pos time: 2024-10-11T00:00:00.000
2024-11-20 23:07:27,939 - INFO - pnl: 2024-10-03T23:59:59.999 219274.6671855515 === 1.171%
2024-11-20 23:07:27,942 - DEBUG - cur time: 2024-10-04T23:59:59.999 == next bar open time: 2024-10-05T00:00:00.000 == close pos time: 2024-10-12T00:00:00.000
2024-11-20 23:07:27,943 - INFO - pnl: 2024-10-04T23:59:59.999 217495.89246298315 === -0.811%
2024-11-20 23:07:27,946 - DEBUG - cur time: 2024-10-05T23:59:59.999 == next bar open time: 2024-10-06T00:00:00.000 == close pos time: 2024-10-13T00:00:00.000
2024-11-20 23:07:27,948 - INFO - pnl: 2024-10-05T23:59:59.999 216523.15383139165 === -0.447%
2024-11-20 23:07:27,951 - DEBUG - cur time: 2024-10-06T23:59:59.999 == next bar open time: 2024-10-07T00:00:00.000 == close pos time: 2024-10-14T00:00:00.000
2024-11-20 23:07:27,953 - INFO - pnl: 2024-10-06T23:59:59.999 217242.74161167085 === 0.332%
2024-11-20 23:07:27,956 - DEBUG - cur time: 2024-10-07T23:59:59.999 == next bar open time: 2024-10-08T00:00:00.000 == close pos time: 2024-10-15T00:00:00.000
2024-11-20 23:07:27,958 - INFO - pnl: 2024-10-07T23:59:59.999 215499.92006034235 === -0.802%
2024-11-20 23:07:27,961 - DEBUG - cur time: 2024-10-08T23:59:59.999 == next bar open time: 2024-10-09T00:00:00.000 == close pos time: 2024-10-16T00:00:00.000
2024-11-20 23:07:27,963 - INFO - pnl: 2024-10-08T23:59:59.999 214595.4503431995 === -0.420%
2024-11-20 23:07:27,967 - DEBUG - cur time: 2024-10-09T23:59:59.999 == next bar open time: 2024-10-10T00:00:00.000 == close pos time: 2024-10-17T00:00:00.000
2024-11-20 23:07:27,976 - DEBUG - sorted_long_factors: shape: (252, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ UNFIUSDT  ┆ -1.892492    ┆ 0    ┆ 251          │
│ UNIUSDT   ┆ -1.85286     ┆ 1    ┆ 250          │
│ DYDXUSDT  ┆ -1.775633    ┆ 2    ┆ 249          │
│ ARUSDT    ┆ -1.743634    ┆ 3    ┆ 248          │
│ LISTAUSDT ┆ -1.720709    ┆ 4    ┆ 247          │
│ ETHFIUSDT ┆ -1.694298    ┆ 5    ┆ 246          │
│ NEOUSDT   ┆ -1.65314     ┆ 6    ┆ 245          │
│ ZROUSDT   ┆ -1.631426    ┆ 7    ┆ 244          │
│ XRPUSDT   ┆ -1.618664    ┆ 8    ┆ 243          │
│ IOUSDT    ┆ -1.604261    ┆ 9    ┆ 242          │
│ …         ┆ …            ┆ …    ┆ …            │
│ SKLUSDT   ┆ 0.097042     ┆ 242  ┆ 9            │
│ AMBUSDT   ┆ 0.186789     ┆ 243  ┆ 8            │
│ LSKUSDT   ┆ 0.273485     ┆ 244  ┆ 7            │
│ XVGUSDT   ┆ 0.284602     ┆ 245  ┆ 6            │
│ PERPUSDT  ┆ 0.327778     ┆ 246  ┆ 5            │
│ WAXPUSDT  ┆ 0.421163     ┆ 247  ┆ 4            │
│ BICOUSDT  ┆ 0.448595     ┆ 248  ┆ 3            │
│ HFTUSDT   ┆ 0.488327     ┆ 249  ┆ 2            │
│ STEEMUSDT ┆ 0.857025     ┆ 250  ┆ 1            │
│ DEFIUSDT  ┆ 1.457427     ┆ 251  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:27,982 - INFO - cur close time: 2024-10-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:27,982 - DEBUG - mean expected ret (mean factor): -0.7796704237585776
2024-11-20 23:07:27,987 - DEBUG - begin to update pos: =========
2024-11-20 23:07:27,987 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬──────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT  ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---      ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ f64      ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆          ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪══════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ -10000.0 ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴──────────┴─────────┘
2024-11-20 23:07:27,987 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.01985     ┆ 0.12948     ┆ 0.0832      ┆ 0.0091089  ┆ … ┆ 0.01398 ┆ 0.12018 ┆ 3.9165  ┆ 0.3076  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:27,991 - DEBUG - update position: 2024-10-09T23:59:59.999 === diff_trading_value: 242106.98694726423 == cash: 214619.39835193253 
2024-11-20 23:07:27,994 - INFO - pnl: 2024-10-09T23:59:59.999 214619.39835193253 === 0.011%
2024-11-20 23:07:27,997 - DEBUG - cur time: 2024-10-10T23:59:59.999 == next bar open time: 2024-10-11T00:00:00.000 == close pos time: 2024-10-18T00:00:00.000
2024-11-20 23:07:27,998 - INFO - pnl: 2024-10-10T23:59:59.999 214857.82457876246 === 0.111%
2024-11-20 23:07:28,001 - DEBUG - cur time: 2024-10-11T23:59:59.999 == next bar open time: 2024-10-12T00:00:00.000 == close pos time: 2024-10-19T00:00:00.000
2024-11-20 23:07:28,003 - INFO - pnl: 2024-10-11T23:59:59.999 213069.9611163861 === -0.832%
2024-11-20 23:07:28,006 - DEBUG - cur time: 2024-10-12T23:59:59.999 == next bar open time: 2024-10-13T00:00:00.000 == close pos time: 2024-10-20T00:00:00.000
2024-11-20 23:07:28,007 - INFO - pnl: 2024-10-12T23:59:59.999 214617.27171073738 === 0.726%
2024-11-20 23:07:28,010 - DEBUG - cur time: 2024-10-13T23:59:59.999 == next bar open time: 2024-10-14T00:00:00.000 == close pos time: 2024-10-21T00:00:00.000
2024-11-20 23:07:28,011 - INFO - pnl: 2024-10-13T23:59:59.999 215688.561254537 === 0.499%
2024-11-20 23:07:28,015 - DEBUG - cur time: 2024-10-14T23:59:59.999 == next bar open time: 2024-10-15T00:00:00.000 == close pos time: 2024-10-22T00:00:00.000
2024-11-20 23:07:28,016 - INFO - pnl: 2024-10-14T23:59:59.999 213204.61344514304 === -1.152%
2024-11-20 23:07:28,019 - DEBUG - cur time: 2024-10-15T23:59:59.999 == next bar open time: 2024-10-16T00:00:00.000 == close pos time: 2024-10-23T00:00:00.000
2024-11-20 23:07:28,020 - INFO - pnl: 2024-10-15T23:59:59.999 213385.55314800006 === 0.085%
2024-11-20 23:07:28,023 - DEBUG - cur time: 2024-10-16T23:59:59.999 == next bar open time: 2024-10-17T00:00:00.000 == close pos time: 2024-10-24T00:00:00.000
2024-11-20 23:07:28,032 - DEBUG - sorted_long_factors: shape: (251, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT   ┆ -1.98021     ┆ 0    ┆ 250          │
│ WUSDT     ┆ -1.609296    ┆ 1    ┆ 249          │
│ WLDUSDT   ┆ -1.569559    ┆ 2    ┆ 248          │
│ XRPUSDT   ┆ -1.551051    ┆ 3    ┆ 247          │
│ NEARUSDT  ┆ -1.537757    ┆ 4    ┆ 246          │
│ BLURUSDT  ┆ -1.519413    ┆ 5    ┆ 245          │
│ TNSRUSDT  ┆ -1.51863     ┆ 6    ┆ 244          │
│ ARKUSDT   ┆ -1.507986    ┆ 7    ┆ 243          │
│ NOTUSDT   ┆ -1.504314    ┆ 8    ┆ 242          │
│ ENAUSDT   ┆ -1.499884    ┆ 9    ┆ 241          │
│ …         ┆ …            ┆ …    ┆ …            │
│ BANDUSDT  ┆ 0.096802     ┆ 241  ┆ 9            │
│ PERPUSDT  ┆ 0.106399     ┆ 242  ┆ 8            │
│ DODOXUSDT ┆ 0.113703     ┆ 243  ┆ 7            │
│ LSKUSDT   ┆ 0.149185     ┆ 244  ┆ 6            │
│ WAXPUSDT  ┆ 0.184188     ┆ 245  ┆ 5            │
│ RVNUSDT   ┆ 0.194783     ┆ 246  ┆ 4            │
│ COMBOUSDT ┆ 0.253741     ┆ 247  ┆ 3            │
│ NKNUSDT   ┆ 0.517758     ┆ 248  ┆ 2            │
│ STEEMUSDT ┆ 0.566829     ┆ 249  ┆ 1            │
│ DEFIUSDT  ┆ 2.107849     ┆ 250  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,039 - WARNING - 2024-10-16T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,039 - INFO - cur close time: 2024-10-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:28,039 - DEBUG - mean expected ret (mean factor): -0.7787661471481777
2024-11-20 23:07:28,044 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,044 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,045 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024396    ┆ 0.14889     ┆ 0.09088     ┆ 0.0104434   ┆ … ┆ 0.01497 ┆ 0.1298 ┆ 3.9313  ┆ 0.3279  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,050 - DEBUG - update position: 2024-10-16T23:59:59.999 === diff_trading_value: 311755.69759681646 == cash: 213933.23318476026 
2024-11-20 23:07:28,051 - INFO - pnl: 2024-10-16T23:59:59.999 213933.23318476026 === 0.257%
2024-11-20 23:07:28,054 - DEBUG - cur time: 2024-10-17T23:59:59.999 == next bar open time: 2024-10-18T00:00:00.000 == close pos time: 2024-10-25T00:00:00.000
2024-11-20 23:07:28,055 - INFO - pnl: 2024-10-17T23:59:59.999 215423.50076151855 === 0.697%
2024-11-20 23:07:28,058 - DEBUG - cur time: 2024-10-18T23:59:59.999 == next bar open time: 2024-10-19T00:00:00.000 == close pos time: 2024-10-26T00:00:00.000
2024-11-20 23:07:28,060 - INFO - pnl: 2024-10-18T23:59:59.999 215082.1514918798 === -0.158%
2024-11-20 23:07:28,063 - DEBUG - cur time: 2024-10-19T23:59:59.999 == next bar open time: 2024-10-20T00:00:00.000 == close pos time: 2024-10-27T00:00:00.000
2024-11-20 23:07:28,064 - INFO - pnl: 2024-10-19T23:59:59.999 215390.5260233625 === 0.143%
2024-11-20 23:07:28,067 - DEBUG - cur time: 2024-10-20T23:59:59.999 == next bar open time: 2024-10-21T00:00:00.000 == close pos time: 2024-10-28T00:00:00.000
2024-11-20 23:07:28,068 - INFO - pnl: 2024-10-20T23:59:59.999 217455.31639617396 === 0.959%
2024-11-20 23:07:28,071 - DEBUG - cur time: 2024-10-21T23:59:59.999 == next bar open time: 2024-10-22T00:00:00.000 == close pos time: 2024-10-29T00:00:00.000
2024-11-20 23:07:28,073 - INFO - pnl: 2024-10-21T23:59:59.999 219883.75551311087 === 1.117%
2024-11-20 23:07:28,076 - DEBUG - cur time: 2024-10-22T23:59:59.999 == next bar open time: 2024-10-23T00:00:00.000 == close pos time: 2024-10-30T00:00:00.000
2024-11-20 23:07:28,077 - INFO - pnl: 2024-10-22T23:59:59.999 219669.0990524858 === -0.098%
2024-11-20 23:07:28,080 - DEBUG - cur time: 2024-10-23T23:59:59.999 == next bar open time: 2024-10-24T00:00:00.000 == close pos time: 2024-10-31T00:00:00.000
2024-11-20 23:07:28,093 - DEBUG - sorted_long_factors: shape: (251, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ UNFIUSDT  ┆ -1.898455    ┆ 0    ┆ 250          │
│ TAOUSDT   ┆ -1.832632    ┆ 1    ┆ 249          │
│ TNSRUSDT  ┆ -1.705762    ┆ 2    ┆ 248          │
│ ZECUSDT   ┆ -1.69182     ┆ 3    ┆ 247          │
│ IOUSDT    ┆ -1.685809    ┆ 4    ┆ 246          │
│ ZETAUSDT  ┆ -1.642827    ┆ 5    ┆ 245          │
│ ZROUSDT   ┆ -1.641287    ┆ 6    ┆ 244          │
│ SAGAUSDT  ┆ -1.593142    ┆ 7    ┆ 243          │
│ LISTAUSDT ┆ -1.522044    ┆ 8    ┆ 242          │
│ ARUSDT    ┆ -1.494553    ┆ 9    ┆ 241          │
│ …         ┆ …            ┆ …    ┆ …            │
│ BALUSDT   ┆ 0.06728      ┆ 241  ┆ 9            │
│ RVNUSDT   ┆ 0.080987     ┆ 242  ┆ 8            │
│ KSMUSDT   ┆ 0.126177     ┆ 243  ┆ 7            │
│ HFTUSDT   ┆ 0.14555      ┆ 244  ┆ 6            │
│ NTRNUSDT  ┆ 0.170249     ┆ 245  ┆ 5            │
│ OXTUSDT   ┆ 0.204357     ┆ 246  ┆ 4            │
│ DASHUSDT  ┆ 0.230971     ┆ 247  ┆ 3            │
│ BNTUSDT   ┆ 0.568416     ┆ 248  ┆ 2            │
│ STEEMUSDT ┆ 0.793213     ┆ 249  ┆ 1            │
│ DEFIUSDT  ┆ 2.110562     ┆ 250  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,100 - INFO - cur close time: 2024-10-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:28,101 - DEBUG - mean expected ret (mean factor): -0.7726226153951384
2024-11-20 23:07:28,109 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,109 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬──────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT  ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---      ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ f64      ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆          ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪══════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ -10000.0 ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴──────────┴─────────┘
2024-11-20 23:07:28,109 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.021855    ┆ 0.14262     ┆ 0.08939     ┆ 0.0098061  ┆ … ┆ 0.01459 ┆ 0.13639 ┆ 3.6986  ┆ 0.3383  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:28,115 - DEBUG - update position: 2024-10-23T23:59:59.999 === diff_trading_value: 278736.17015228793 == cash: 208544.7747051139 
2024-11-20 23:07:28,116 - INFO - pnl: 2024-10-23T23:59:59.999 218544.7747051139 === -0.512%
2024-11-20 23:07:28,121 - DEBUG - cur time: 2024-10-24T23:59:59.999 == next bar open time: 2024-10-25T00:00:00.000 == close pos time: 2024-11-01T00:00:00.000
2024-11-20 23:07:28,125 - INFO - pnl: 2024-10-24T23:59:59.999 219688.5789957503 === 0.523%
2024-11-20 23:07:28,130 - DEBUG - cur time: 2024-10-25T23:59:59.999 == next bar open time: 2024-10-26T00:00:00.000 == close pos time: 2024-11-02T00:00:00.000
2024-11-20 23:07:28,131 - INFO - pnl: 2024-10-25T23:59:59.999 219243.27684236734 === -0.203%
2024-11-20 23:07:28,136 - DEBUG - cur time: 2024-10-26T23:59:59.999 == next bar open time: 2024-10-27T00:00:00.000 == close pos time: 2024-11-03T00:00:00.000
2024-11-20 23:07:28,138 - INFO - pnl: 2024-10-26T23:59:59.999 217789.02666456992 === -0.663%
2024-11-20 23:07:28,155 - INFO - start get SinglePnl: shape: (125_768, 83)
┌────────────┬───────────┬──────────┬──────────┬───┬───────────┬───────────┬───────────┬───────────┐
│ symbol     ┆ open_time ┆ open     ┆ high     ┆ … ┆ long_valu ┆ short_val ┆ long_valu ┆ short_val │
│ ---        ┆ ---       ┆ ---      ┆ ---      ┆   ┆ e_scale_9 ┆ ue_scale_ ┆ e_scale_1 ┆ ue_scale_ │
│ str        ┆ datetime[ ┆ f64      ┆ f64      ┆   ┆ day       ┆ 9day      ┆ 0day      ┆ 10day     │
│            ┆ ms]       ┆          ┆          ┆   ┆ ---       ┆ ---       ┆ ---       ┆ ---       │
│            ┆           ┆          ┆          ┆   ┆ f64       ┆ f64       ┆ f64       ┆ f64       │
╞════════════╪═══════════╪══════════╪══════════╪═══╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.024872 ┆ 0.02937  ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.024425 ┆ 0.027349 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.027227 ┆ 0.047868 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.03773  ┆ 0.042696 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.030505 ┆ 0.036907 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.029994 ┆ 0.030839 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.027063 ┆ 0.035125 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.031768 ┆ 0.034467 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-1 ┆ 0.0339   ┆ 0.033974 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-1 ┆ 0.031026 ┆ 0.03276  ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ …          ┆ …         ┆ …        ┆ …        ┆ … ┆ …         ┆ …         ┆ …         ┆ …         │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3196   ┆ 0.3373   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3355   ┆ 0.3415   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3359   ┆ 0.3565   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3553   ┆ 0.3881   ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.2       ┆ 0.8       │
│            ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3577   ┆ 0.3581   ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.0       ┆ 1.0       │
│            ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3511   ┆ 0.3547   ┆ … ┆ 0.8       ┆ 1.2       ┆ 1.0       ┆ 1.0       │
│            ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3383   ┆ 0.3548   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3417   ┆ 0.3632   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3194   ┆ 0.3243   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.316    ┆ 0.3317   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
└────────────┴───────────┴──────────┴──────────┴───┴───────────┴───────────┴───────────┴───────────┘
2024-11-20 23:07:28,228 - DEBUG - cur time: 2023-01-12T23:59:59.999 == next bar open time: 2023-01-13T00:00:00.000 == close pos time: 2023-01-20T00:00:00.000
2024-11-20 23:07:28,235 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ UNIUSDT      ┆ -1.766136    ┆ 0    ┆ 132          │
│ ENSUSDT      ┆ -1.716218    ┆ 1    ┆ 131          │
│ MATICUSDT    ┆ -1.662844    ┆ 2    ┆ 130          │
│ ICPUSDT      ┆ -1.655153    ┆ 3    ┆ 129          │
│ ATOMUSDT     ┆ -1.597876    ┆ 4    ┆ 128          │
│ 1000LUNCUSDT ┆ -1.593203    ┆ 5    ┆ 127          │
│ LUNA2USDT    ┆ -1.589785    ┆ 6    ┆ 126          │
│ WAVESUSDT    ┆ -1.573101    ┆ 7    ┆ 125          │
│ BANDUSDT     ┆ -1.566108    ┆ 8    ┆ 124          │
│ BNBUSDT      ┆ -1.544178    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ API3USDT     ┆ -0.066604    ┆ 123  ┆ 9            │
│ ZENUSDT      ┆ -0.04717     ┆ 124  ┆ 8            │
│ CTSIUSDT     ┆ -0.026081    ┆ 125  ┆ 7            │
│ FLMUSDT      ┆ 0.071222     ┆ 126  ┆ 6            │
│ DUSKUSDT     ┆ 0.078856     ┆ 127  ┆ 5            │
│ CELRUSDT     ┆ 0.166779     ┆ 128  ┆ 4            │
│ SKLUSDT      ┆ 0.282533     ┆ 129  ┆ 3            │
│ BTCDOMUSDT   ┆ 0.284586     ┆ 130  ┆ 2            │
│ ARPAUSDT     ┆ 0.460984     ┆ 131  ┆ 1            │
│ DEFIUSDT     ┆ 0.755071     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,241 - WARNING - 2023-01-12T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,242 - INFO - cur close time: 2023-01-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:28,242 - DEBUG - mean expected ret (mean factor): -0.8320476449189582
2024-11-20 23:07:28,247 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,247 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,247 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1683      ┆ null        ┆ … ┆ 0.02391 ┆ null   ┆ null    ┆ 0.1822  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,252 - DEBUG - update position: 2023-01-12T23:59:59.999 === diff_trading_value: 200000.0 == cash: 99800.0 
2024-11-20 23:07:28,256 - DEBUG - cur time: 2023-01-13T23:59:59.999 == next bar open time: 2023-01-14T00:00:00.000 == close pos time: 2023-01-21T00:00:00.000
2024-11-20 23:07:28,258 - INFO - pnl: 2023-01-13T23:59:59.999 101705.21938591608 === 1.909%
2024-11-20 23:07:28,261 - DEBUG - cur time: 2023-01-14T23:59:59.999 == next bar open time: 2023-01-15T00:00:00.000 == close pos time: 2023-01-22T00:00:00.000
2024-11-20 23:07:28,263 - INFO - pnl: 2023-01-14T23:59:59.999 99640.96923882482 === -2.030%
2024-11-20 23:07:28,265 - DEBUG - cur time: 2023-01-15T23:59:59.999 == next bar open time: 2023-01-16T00:00:00.000 == close pos time: 2023-01-23T00:00:00.000
2024-11-20 23:07:28,267 - INFO - pnl: 2023-01-15T23:59:59.999 97817.45813437195 === -1.830%
2024-11-20 23:07:28,270 - DEBUG - cur time: 2023-01-16T23:59:59.999 == next bar open time: 2023-01-17T00:00:00.000 == close pos time: 2023-01-24T00:00:00.000
2024-11-20 23:07:28,271 - INFO - pnl: 2023-01-16T23:59:59.999 97497.20864932028 === -0.327%
2024-11-20 23:07:28,276 - DEBUG - cur time: 2023-01-17T23:59:59.999 == next bar open time: 2023-01-18T00:00:00.000 == close pos time: 2023-01-25T00:00:00.000
2024-11-20 23:07:28,278 - INFO - pnl: 2023-01-17T23:59:59.999 100520.06537110942 === 3.100%
2024-11-20 23:07:28,281 - DEBUG - cur time: 2023-01-18T23:59:59.999 == next bar open time: 2023-01-19T00:00:00.000 == close pos time: 2023-01-26T00:00:00.000
2024-11-20 23:07:28,284 - INFO - pnl: 2023-01-18T23:59:59.999 100038.58162308155 === -0.479%
2024-11-20 23:07:28,288 - DEBUG - cur time: 2023-01-19T23:59:59.999 == next bar open time: 2023-01-20T00:00:00.000 == close pos time: 2023-01-27T00:00:00.000
2024-11-20 23:07:28,296 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT      ┆ -1.794603    ┆ 0    ┆ 132          │
│ ICPUSDT      ┆ -1.737921    ┆ 1    ┆ 131          │
│ ATOMUSDT     ┆ -1.731341    ┆ 2    ┆ 130          │
│ LUNA2USDT    ┆ -1.728747    ┆ 3    ┆ 129          │
│ ENSUSDT      ┆ -1.682822    ┆ 4    ┆ 128          │
│ DASHUSDT     ┆ -1.654713    ┆ 5    ┆ 127          │
│ FILUSDT      ┆ -1.608706    ┆ 6    ┆ 126          │
│ UNIUSDT      ┆ -1.606901    ┆ 7    ┆ 125          │
│ 1000LUNCUSDT ┆ -1.605453    ┆ 8    ┆ 124          │
│ DOTUSDT      ┆ -1.582821    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BALUSDT      ┆ -0.215023    ┆ 123  ┆ 9            │
│ CELRUSDT     ┆ -0.203144    ┆ 124  ┆ 8            │
│ RVNUSDT      ┆ -0.177526    ┆ 125  ┆ 7            │
│ FLMUSDT      ┆ -0.036727    ┆ 126  ┆ 6            │
│ LPTUSDT      ┆ -0.017336    ┆ 127  ┆ 5            │
│ BTCDOMUSDT   ┆ 0.037627     ┆ 128  ┆ 4            │
│ DEFIUSDT     ┆ 0.111581     ┆ 129  ┆ 3            │
│ API3USDT     ┆ 0.142752     ┆ 130  ┆ 2            │
│ TOMOUSDT     ┆ 0.154228     ┆ 131  ┆ 1            │
│ ARPAUSDT     ┆ 0.422343     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,301 - WARNING - 2023-01-19T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,303 - INFO - cur close time: 2023-01-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:28,303 - DEBUG - mean expected ret (mean factor): -0.8215503232606954
2024-11-20 23:07:28,307 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,307 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,308 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1738      ┆ null        ┆ … ┆ 0.02544 ┆ null   ┆ null    ┆ 0.2038  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,314 - DEBUG - update position: 2023-01-19T23:59:59.999 === diff_trading_value: 154691.38368963028 == cash: 97664.43788638797 
2024-11-20 23:07:28,315 - INFO - pnl: 2023-01-19T23:59:59.999 97664.43788638797 === -2.373%
2024-11-20 23:07:28,319 - DEBUG - cur time: 2023-01-20T23:59:59.999 == next bar open time: 2023-01-21T00:00:00.000 == close pos time: 2023-01-28T00:00:00.000
2024-11-20 23:07:28,320 - INFO - pnl: 2023-01-20T23:59:59.999 101643.33994706158 === 4.074%
2024-11-20 23:07:28,323 - DEBUG - cur time: 2023-01-21T23:59:59.999 == next bar open time: 2023-01-22T00:00:00.000 == close pos time: 2023-01-29T00:00:00.000
2024-11-20 23:07:28,325 - INFO - pnl: 2023-01-21T23:59:59.999 101511.86389439477 === -0.129%
2024-11-20 23:07:28,329 - DEBUG - cur time: 2023-01-22T23:59:59.999 == next bar open time: 2023-01-23T00:00:00.000 == close pos time: 2023-01-30T00:00:00.000
2024-11-20 23:07:28,331 - INFO - pnl: 2023-01-22T23:59:59.999 101240.16053343221 === -0.268%
2024-11-20 23:07:28,334 - DEBUG - cur time: 2023-01-23T23:59:59.999 == next bar open time: 2023-01-24T00:00:00.000 == close pos time: 2023-01-31T00:00:00.000
2024-11-20 23:07:28,336 - INFO - pnl: 2023-01-23T23:59:59.999 105005.64336014481 === 3.719%
2024-11-20 23:07:28,340 - DEBUG - cur time: 2023-01-24T23:59:59.999 == next bar open time: 2023-01-25T00:00:00.000 == close pos time: 2023-02-01T00:00:00.000
2024-11-20 23:07:28,341 - INFO - pnl: 2023-01-24T23:59:59.999 109205.376120547 === 4.000%
2024-11-20 23:07:28,345 - DEBUG - cur time: 2023-01-25T23:59:59.999 == next bar open time: 2023-01-26T00:00:00.000 == close pos time: 2023-02-02T00:00:00.000
2024-11-20 23:07:28,347 - INFO - pnl: 2023-01-25T23:59:59.999 107620.6692722893 === -1.451%
2024-11-20 23:07:28,353 - DEBUG - cur time: 2023-01-26T23:59:59.999 == next bar open time: 2023-01-27T00:00:00.000 == close pos time: 2023-02-03T00:00:00.000
2024-11-20 23:07:28,361 - DEBUG - sorted_long_factors: shape: (133, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ INJUSDT     ┆ -1.933849    ┆ 0    ┆ 132          │
│ LUNA2USDT   ┆ -1.804815    ┆ 1    ┆ 131          │
│ APEUSDT     ┆ -1.783811    ┆ 2    ┆ 130          │
│ DOTUSDT     ┆ -1.703589    ┆ 3    ┆ 129          │
│ AAVEUSDT    ┆ -1.64416     ┆ 4    ┆ 128          │
│ GMTUSDT     ┆ -1.590025    ┆ 5    ┆ 127          │
│ UNFIUSDT    ┆ -1.556954    ┆ 6    ┆ 126          │
│ AXSUSDT     ┆ -1.547668    ┆ 7    ┆ 125          │
│ RLCUSDT     ┆ -1.519187    ┆ 8    ┆ 124          │
│ FILUSDT     ┆ -1.518777    ┆ 9    ┆ 123          │
│ …           ┆ …            ┆ …    ┆ …            │
│ CELRUSDT    ┆ -0.178659    ┆ 123  ┆ 9            │
│ 1000XECUSDT ┆ -0.176311    ┆ 124  ┆ 8            │
│ XMRUSDT     ┆ -0.134935    ┆ 125  ┆ 7            │
│ DGBUSDT     ┆ -0.116155    ┆ 126  ┆ 6            │
│ SFPUSDT     ┆ -0.055448    ┆ 127  ┆ 5            │
│ TOMOUSDT    ┆ -0.012126    ┆ 128  ┆ 4            │
│ ANTUSDT     ┆ 0.037202     ┆ 129  ┆ 3            │
│ ARPAUSDT    ┆ 0.217627     ┆ 130  ┆ 2            │
│ SKLUSDT     ┆ 0.218421     ┆ 131  ┆ 1            │
│ DEFIUSDT    ┆ 1.125635     ┆ 132  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,373 - WARNING - 2023-01-26T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,373 - INFO - cur close time: 2023-01-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:28,373 - DEBUG - mean expected ret (mean factor): -0.8161989867455123
2024-11-20 23:07:28,378 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,378 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,378 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1717      ┆ null        ┆ … ┆ 0.02779 ┆ null   ┆ null    ┆ 0.2262  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,386 - DEBUG - update position: 2023-01-26T23:59:59.999 === diff_trading_value: 271065.06844939257 == cash: 109968.49089291481 
2024-11-20 23:07:28,387 - INFO - pnl: 2023-01-26T23:59:59.999 109968.49089291481 === 2.182%
2024-11-20 23:07:28,391 - DEBUG - cur time: 2023-01-27T23:59:59.999 == next bar open time: 2023-01-28T00:00:00.000 == close pos time: 2023-02-04T00:00:00.000
2024-11-20 23:07:28,392 - INFO - pnl: 2023-01-27T23:59:59.999 113162.10657154582 === 2.904%
2024-11-20 23:07:28,395 - DEBUG - cur time: 2023-01-28T23:59:59.999 == next bar open time: 2023-01-29T00:00:00.000 == close pos time: 2023-02-05T00:00:00.000
2024-11-20 23:07:28,396 - INFO - pnl: 2023-01-28T23:59:59.999 113537.4027564601 === 0.332%
2024-11-20 23:07:28,400 - DEBUG - cur time: 2023-01-29T23:59:59.999 == next bar open time: 2023-01-30T00:00:00.000 == close pos time: 2023-02-06T00:00:00.000
2024-11-20 23:07:28,401 - INFO - pnl: 2023-01-29T23:59:59.999 113274.41487270006 === -0.232%
2024-11-20 23:07:28,408 - DEBUG - cur time: 2023-01-30T23:59:59.999 == next bar open time: 2023-01-31T00:00:00.000 == close pos time: 2023-02-07T00:00:00.000
2024-11-20 23:07:28,410 - INFO - pnl: 2023-01-30T23:59:59.999 115810.87910564388 === 2.239%
2024-11-20 23:07:28,413 - DEBUG - cur time: 2023-01-31T23:59:59.999 == next bar open time: 2023-02-01T00:00:00.000 == close pos time: 2023-02-08T00:00:00.000
2024-11-20 23:07:28,416 - INFO - pnl: 2023-01-31T23:59:59.999 114175.65793111046 === -1.412%
2024-11-20 23:07:28,420 - DEBUG - cur time: 2023-02-01T23:59:59.999 == next bar open time: 2023-02-02T00:00:00.000 == close pos time: 2023-02-09T00:00:00.000
2024-11-20 23:07:28,423 - INFO - pnl: 2023-02-01T23:59:59.999 111198.47088367556 === -2.608%
2024-11-20 23:07:28,428 - DEBUG - cur time: 2023-02-02T23:59:59.999 == next bar open time: 2023-02-03T00:00:00.000 == close pos time: 2023-02-10T00:00:00.000
2024-11-20 23:07:28,439 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT      ┆ -1.978035    ┆ 0    ┆ 134          │
│ LDOUSDT      ┆ -1.674297    ┆ 1    ┆ 133          │
│ DOTUSDT      ┆ -1.650141    ┆ 2    ┆ 132          │
│ QNTUSDT      ┆ -1.62236     ┆ 3    ┆ 131          │
│ OPUSDT       ┆ -1.614624    ┆ 4    ┆ 130          │
│ UNIUSDT      ┆ -1.609615    ┆ 5    ┆ 129          │
│ 1000LUNCUSDT ┆ -1.377329    ┆ 6    ┆ 128          │
│ NEOUSDT      ┆ -1.372691    ┆ 7    ┆ 127          │
│ LUNA2USDT    ┆ -1.325597    ┆ 8    ┆ 126          │
│ YFIUSDT      ┆ -1.313326    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOSTUSDT     ┆ -0.147433    ┆ 125  ┆ 9            │
│ DUSKUSDT     ┆ -0.128212    ┆ 126  ┆ 8            │
│ ARPAUSDT     ┆ -0.09416     ┆ 127  ┆ 7            │
│ ONTUSDT      ┆ -0.081821    ┆ 128  ┆ 6            │
│ HNTUSDT      ┆ 0.035318     ┆ 129  ┆ 5            │
│ TOMOUSDT     ┆ 0.056851     ┆ 130  ┆ 4            │
│ API3USDT     ┆ 0.197135     ┆ 131  ┆ 3            │
│ CTSIUSDT     ┆ 0.380227     ┆ 132  ┆ 2            │
│ DGBUSDT      ┆ 0.397539     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 2.288466     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,446 - WARNING - 2023-02-02T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,447 - INFO - cur close time: 2023-02-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:28,447 - DEBUG - mean expected ret (mean factor): -0.8132212261498282
2024-11-20 23:07:28,452 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,452 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,453 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1694      ┆ null        ┆ … ┆ 0.02826 ┆ null   ┆ null    ┆ 0.2322  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,459 - DEBUG - update position: 2023-02-02T23:59:59.999 === diff_trading_value: 287001.2580767956 == cash: 112678.9981171133 
2024-11-20 23:07:28,461 - INFO - pnl: 2023-02-02T23:59:59.999 112678.9981171133 === 1.331%
2024-11-20 23:07:28,465 - DEBUG - cur time: 2023-02-03T23:59:59.999 == next bar open time: 2023-02-04T00:00:00.000 == close pos time: 2023-02-11T00:00:00.000
2024-11-20 23:07:28,467 - INFO - pnl: 2023-02-03T23:59:59.999 111507.29189647855 === -1.040%
2024-11-20 23:07:28,472 - DEBUG - cur time: 2023-02-04T23:59:59.999 == next bar open time: 2023-02-05T00:00:00.000 == close pos time: 2023-02-12T00:00:00.000
2024-11-20 23:07:28,473 - INFO - pnl: 2023-02-04T23:59:59.999 115020.44679194345 === 3.151%
2024-11-20 23:07:28,478 - DEBUG - cur time: 2023-02-05T23:59:59.999 == next bar open time: 2023-02-06T00:00:00.000 == close pos time: 2023-02-13T00:00:00.000
2024-11-20 23:07:28,481 - INFO - pnl: 2023-02-05T23:59:59.999 115789.25796280458 === 0.668%
2024-11-20 23:07:28,485 - DEBUG - cur time: 2023-02-06T23:59:59.999 == next bar open time: 2023-02-07T00:00:00.000 == close pos time: 2023-02-14T00:00:00.000
2024-11-20 23:07:28,487 - INFO - pnl: 2023-02-06T23:59:59.999 115475.94795737037 === -0.271%
2024-11-20 23:07:28,491 - DEBUG - cur time: 2023-02-07T23:59:59.999 == next bar open time: 2023-02-08T00:00:00.000 == close pos time: 2023-02-15T00:00:00.000
2024-11-20 23:07:28,493 - INFO - pnl: 2023-02-07T23:59:59.999 118442.62458287229 === 2.569%
2024-11-20 23:07:28,496 - DEBUG - cur time: 2023-02-08T23:59:59.999 == next bar open time: 2023-02-09T00:00:00.000 == close pos time: 2023-02-16T00:00:00.000
2024-11-20 23:07:28,498 - INFO - pnl: 2023-02-08T23:59:59.999 118214.31815581073 === -0.193%
2024-11-20 23:07:28,501 - DEBUG - cur time: 2023-02-09T23:59:59.999 == next bar open time: 2023-02-10T00:00:00.000 == close pos time: 2023-02-17T00:00:00.000
2024-11-20 23:07:28,512 - DEBUG - sorted_long_factors: shape: (135, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ LDOUSDT   ┆ -1.867002    ┆ 0    ┆ 134          │
│ NEARUSDT  ┆ -1.678096    ┆ 1    ┆ 133          │
│ LUNA2USDT ┆ -1.553341    ┆ 2    ┆ 132          │
│ AXSUSDT   ┆ -1.511798    ┆ 3    ┆ 131          │
│ TRXUSDT   ┆ -1.488289    ┆ 4    ┆ 130          │
│ MTLUSDT   ┆ -1.470033    ┆ 5    ┆ 129          │
│ LITUSDT   ┆ -1.464413    ┆ 6    ┆ 128          │
│ MATICUSDT ┆ -1.448521    ┆ 7    ┆ 127          │
│ CRVUSDT   ┆ -1.442101    ┆ 8    ┆ 126          │
│ WOOUSDT   ┆ -1.437986    ┆ 9    ┆ 125          │
│ …         ┆ …            ┆ …    ┆ …            │
│ CELRUSDT  ┆ -0.211254    ┆ 125  ┆ 9            │
│ DASHUSDT  ┆ -0.197313    ┆ 126  ┆ 8            │
│ CTSIUSDT  ┆ -0.179862    ┆ 127  ┆ 7            │
│ LINAUSDT  ┆ -0.133305    ┆ 128  ┆ 6            │
│ BELUSDT   ┆ -0.092914    ┆ 129  ┆ 5            │
│ SKLUSDT   ┆ -0.057416    ┆ 130  ┆ 4            │
│ TOMOUSDT  ┆ 0.066343     ┆ 131  ┆ 3            │
│ DUSKUSDT  ┆ 0.177808     ┆ 132  ┆ 2            │
│ DGBUSDT   ┆ 0.549        ┆ 133  ┆ 1            │
│ DEFIUSDT  ┆ 1.290568     ┆ 134  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,521 - WARNING - 2023-02-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,521 - INFO - cur close time: 2023-02-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:28,521 - DEBUG - mean expected ret (mean factor): -0.8114151917734077
2024-11-20 23:07:28,528 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,528 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,528 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1603      ┆ null        ┆ … ┆ 0.0271  ┆ null   ┆ null    ┆ 0.2288  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,535 - DEBUG - update position: 2023-02-09T23:59:59.999 === diff_trading_value: 269379.4635626524 == cash: 113973.96920071803 
2024-11-20 23:07:28,537 - INFO - pnl: 2023-02-09T23:59:59.999 113973.96920071803 === -3.587%
2024-11-20 23:07:28,541 - DEBUG - cur time: 2023-02-10T23:59:59.999 == next bar open time: 2023-02-11T00:00:00.000 == close pos time: 2023-02-18T00:00:00.000
2024-11-20 23:07:28,543 - INFO - pnl: 2023-02-10T23:59:59.999 120557.71161742197 === 5.777%
2024-11-20 23:07:28,547 - DEBUG - cur time: 2023-02-11T23:59:59.999 == next bar open time: 2023-02-12T00:00:00.000 == close pos time: 2023-02-19T00:00:00.000
2024-11-20 23:07:28,548 - INFO - pnl: 2023-02-11T23:59:59.999 124015.39618904347 === 2.868%
2024-11-20 23:07:28,552 - DEBUG - cur time: 2023-02-12T23:59:59.999 == next bar open time: 2023-02-13T00:00:00.000 == close pos time: 2023-02-20T00:00:00.000
2024-11-20 23:07:28,554 - INFO - pnl: 2023-02-12T23:59:59.999 125993.00905232847 === 1.595%
2024-11-20 23:07:28,558 - DEBUG - cur time: 2023-02-13T23:59:59.999 == next bar open time: 2023-02-14T00:00:00.000 == close pos time: 2023-02-21T00:00:00.000
2024-11-20 23:07:28,559 - INFO - pnl: 2023-02-13T23:59:59.999 122014.02622300189 === -3.158%
2024-11-20 23:07:28,562 - DEBUG - cur time: 2023-02-14T23:59:59.999 == next bar open time: 2023-02-15T00:00:00.000 == close pos time: 2023-02-22T00:00:00.000
2024-11-20 23:07:28,564 - INFO - pnl: 2023-02-14T23:59:59.999 123807.21734053752 === 1.470%
2024-11-20 23:07:28,567 - DEBUG - cur time: 2023-02-15T23:59:59.999 == next bar open time: 2023-02-16T00:00:00.000 == close pos time: 2023-02-23T00:00:00.000
2024-11-20 23:07:28,568 - INFO - pnl: 2023-02-15T23:59:59.999 124879.2755647796 === 0.866%
2024-11-20 23:07:28,571 - DEBUG - cur time: 2023-02-16T23:59:59.999 == next bar open time: 2023-02-17T00:00:00.000 == close pos time: 2023-02-24T00:00:00.000
2024-11-20 23:07:28,578 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ STGUSDT      ┆ -1.818234    ┆ 0    ┆ 135          │
│ LDOUSDT      ┆ -1.697748    ┆ 1    ┆ 134          │
│ FILUSDT      ┆ -1.632426    ┆ 2    ┆ 133          │
│ AXSUSDT      ┆ -1.567564    ┆ 3    ┆ 132          │
│ NEARUSDT     ┆ -1.552133    ┆ 4    ┆ 131          │
│ 1000LUNCUSDT ┆ -1.53687     ┆ 5    ┆ 130          │
│ FOOTBALLUSDT ┆ -1.520328    ┆ 6    ┆ 129          │
│ DASHUSDT     ┆ -1.511106    ┆ 7    ┆ 128          │
│ ATOMUSDT     ┆ -1.494202    ┆ 8    ┆ 127          │
│ ICPUSDT      ┆ -1.448037    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ XEMUSDT      ┆ -0.206682    ┆ 126  ┆ 9            │
│ API3USDT     ┆ -0.188579    ┆ 127  ┆ 8            │
│ IOTXUSDT     ┆ -0.050455    ┆ 128  ┆ 7            │
│ ANTUSDT      ┆ 0.031798     ┆ 129  ┆ 6            │
│ LINAUSDT     ┆ 0.099096     ┆ 130  ┆ 5            │
│ TOMOUSDT     ┆ 0.166206     ┆ 131  ┆ 4            │
│ 1000XECUSDT  ┆ 0.168992     ┆ 132  ┆ 3            │
│ DGBUSDT      ┆ 0.452217     ┆ 133  ┆ 2            │
│ DEFIUSDT     ┆ 0.954615     ┆ 134  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.310945     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,586 - WARNING - 2023-02-16T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,586 - INFO - cur close time: 2023-02-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:28,586 - DEBUG - mean expected ret (mean factor): -0.7950561150406171
2024-11-20 23:07:28,591 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,591 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,591 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1664      ┆ null        ┆ … ┆ 0.02949 ┆ null   ┆ null    ┆ 0.2408  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,598 - DEBUG - update position: 2023-02-16T23:59:59.999 === diff_trading_value: 270724.17969329376 == cash: 123910.82252393238 
2024-11-20 23:07:28,600 - INFO - pnl: 2023-02-16T23:59:59.999 123910.82252393238 === -0.776%
2024-11-20 23:07:28,604 - DEBUG - cur time: 2023-02-17T23:59:59.999 == next bar open time: 2023-02-18T00:00:00.000 == close pos time: 2023-02-25T00:00:00.000
2024-11-20 23:07:28,605 - INFO - pnl: 2023-02-17T23:59:59.999 119203.15868348029 === -3.799%
2024-11-20 23:07:28,608 - DEBUG - cur time: 2023-02-18T23:59:59.999 == next bar open time: 2023-02-19T00:00:00.000 == close pos time: 2023-02-26T00:00:00.000
2024-11-20 23:07:28,610 - INFO - pnl: 2023-02-18T23:59:59.999 118821.49196325373 === -0.320%
2024-11-20 23:07:28,612 - DEBUG - cur time: 2023-02-19T23:59:59.999 == next bar open time: 2023-02-20T00:00:00.000 == close pos time: 2023-02-27T00:00:00.000
2024-11-20 23:07:28,614 - INFO - pnl: 2023-02-19T23:59:59.999 118995.08132829065 === 0.146%
2024-11-20 23:07:28,617 - DEBUG - cur time: 2023-02-20T23:59:59.999 == next bar open time: 2023-02-21T00:00:00.000 == close pos time: 2023-02-28T00:00:00.000
2024-11-20 23:07:28,619 - INFO - pnl: 2023-02-20T23:59:59.999 127728.88703698204 === 7.340%
2024-11-20 23:07:28,621 - DEBUG - cur time: 2023-02-21T23:59:59.999 == next bar open time: 2023-02-22T00:00:00.000 == close pos time: 2023-03-01T00:00:00.000
2024-11-20 23:07:28,622 - INFO - pnl: 2023-02-21T23:59:59.999 131521.5121088132 === 2.969%
2024-11-20 23:07:28,625 - DEBUG - cur time: 2023-02-22T23:59:59.999 == next bar open time: 2023-02-23T00:00:00.000 == close pos time: 2023-03-02T00:00:00.000
2024-11-20 23:07:28,627 - INFO - pnl: 2023-02-22T23:59:59.999 130639.33419564867 === -0.671%
2024-11-20 23:07:28,630 - DEBUG - cur time: 2023-02-23T23:59:59.999 == next bar open time: 2023-02-24T00:00:00.000 == close pos time: 2023-03-03T00:00:00.000
2024-11-20 23:07:28,637 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT      ┆ -1.818091    ┆ 0    ┆ 135          │
│ ENSUSDT      ┆ -1.745834    ┆ 1    ┆ 134          │
│ ZECUSDT      ┆ -1.603349    ┆ 2    ┆ 133          │
│ GTCUSDT      ┆ -1.573144    ┆ 3    ┆ 132          │
│ APTUSDT      ┆ -1.541917    ┆ 4    ┆ 131          │
│ 1000LUNCUSDT ┆ -1.532138    ┆ 5    ┆ 130          │
│ INJUSDT      ┆ -1.523798    ┆ 6    ┆ 129          │
│ LUNA2USDT    ┆ -1.521702    ┆ 7    ┆ 128          │
│ UNIUSDT      ┆ -1.452412    ┆ 8    ┆ 127          │
│ YFIUSDT      ┆ -1.421864    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DARUSDT      ┆ -0.214666    ┆ 126  ┆ 9            │
│ COTIUSDT     ┆ -0.196034    ┆ 127  ┆ 8            │
│ DGBUSDT      ┆ -0.161732    ┆ 128  ┆ 7            │
│ 1000XECUSDT  ┆ -0.145848    ┆ 129  ┆ 6            │
│ ANTUSDT      ┆ -0.092071    ┆ 130  ┆ 5            │
│ BTCDOMUSDT   ┆ -0.045756    ┆ 131  ┆ 4            │
│ DASHUSDT     ┆ -0.017575    ┆ 132  ┆ 3            │
│ API3USDT     ┆ 0.037415     ┆ 133  ┆ 2            │
│ DEFIUSDT     ┆ 1.290544     ┆ 134  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.939517     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,644 - WARNING - 2023-02-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,644 - INFO - cur close time: 2023-02-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:28,645 - DEBUG - mean expected ret (mean factor): -0.7794638439365478
2024-11-20 23:07:28,649 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,649 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,649 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.163       ┆ null        ┆ … ┆ 0.03538 ┆ null   ┆ null    ┆ 0.2776  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,656 - DEBUG - update position: 2023-02-23T23:59:59.999 === diff_trading_value: 319867.86761715333 == cash: 129667.79084897124 
2024-11-20 23:07:28,658 - INFO - pnl: 2023-02-23T23:59:59.999 129667.79084897124 === -0.744%
2024-11-20 23:07:28,661 - DEBUG - cur time: 2023-02-24T23:59:59.999 == next bar open time: 2023-02-25T00:00:00.000 == close pos time: 2023-03-04T00:00:00.000
2024-11-20 23:07:28,661 - INFO - pnl: 2023-02-24T23:59:59.999 130057.0275078832 === 0.300%
2024-11-20 23:07:28,664 - DEBUG - cur time: 2023-02-25T23:59:59.999 == next bar open time: 2023-02-26T00:00:00.000 == close pos time: 2023-03-05T00:00:00.000
2024-11-20 23:07:28,666 - INFO - pnl: 2023-02-25T23:59:59.999 129780.76469840971 === -0.212%
2024-11-20 23:07:28,668 - DEBUG - cur time: 2023-02-26T23:59:59.999 == next bar open time: 2023-02-27T00:00:00.000 == close pos time: 2023-03-06T00:00:00.000
2024-11-20 23:07:28,670 - INFO - pnl: 2023-02-26T23:59:59.999 128692.40403865423 === -0.839%
2024-11-20 23:07:28,672 - DEBUG - cur time: 2023-02-27T23:59:59.999 == next bar open time: 2023-02-28T00:00:00.000 == close pos time: 2023-03-07T00:00:00.000
2024-11-20 23:07:28,673 - INFO - pnl: 2023-02-27T23:59:59.999 128169.73459484961 === -0.406%
2024-11-20 23:07:28,676 - DEBUG - cur time: 2023-02-28T23:59:59.999 == next bar open time: 2023-03-01T00:00:00.000 == close pos time: 2023-03-08T00:00:00.000
2024-11-20 23:07:28,677 - INFO - pnl: 2023-02-28T23:59:59.999 127135.49677528796 === -0.807%
2024-11-20 23:07:28,680 - DEBUG - cur time: 2023-03-01T23:59:59.999 == next bar open time: 2023-03-02T00:00:00.000 == close pos time: 2023-03-09T00:00:00.000
2024-11-20 23:07:28,681 - INFO - pnl: 2023-03-01T23:59:59.999 126123.9934283624 === -0.796%
2024-11-20 23:07:28,686 - DEBUG - cur time: 2023-03-02T23:59:59.999 == next bar open time: 2023-03-03T00:00:00.000 == close pos time: 2023-03-10T00:00:00.000
2024-11-20 23:07:28,694 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ LDOUSDT      ┆ -2.021409    ┆ 0    ┆ 135          │
│ LUNA2USDT    ┆ -1.611199    ┆ 1    ┆ 134          │
│ 1000LUNCUSDT ┆ -1.604993    ┆ 2    ┆ 133          │
│ XMRUSDT      ┆ -1.575266    ┆ 3    ┆ 132          │
│ OPUSDT       ┆ -1.541882    ┆ 4    ┆ 131          │
│ BTCDOMUSDT   ┆ -1.444857    ┆ 5    ┆ 130          │
│ ICPUSDT      ┆ -1.437944    ┆ 6    ┆ 129          │
│ TRXUSDT      ┆ -1.419845    ┆ 7    ┆ 128          │
│ AXSUSDT      ┆ -1.383231    ┆ 8    ┆ 127          │
│ EOSUSDT      ┆ -1.274988    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DGBUSDT      ┆ -0.255714    ┆ 126  ┆ 9            │
│ CTKUSDT      ┆ -0.182233    ┆ 127  ┆ 8            │
│ 1000XECUSDT  ┆ -0.10681     ┆ 128  ┆ 7            │
│ DENTUSDT     ┆ -0.030581    ┆ 129  ┆ 6            │
│ COTIUSDT     ┆ 0.028999     ┆ 130  ┆ 5            │
│ DARUSDT      ┆ 0.198693     ┆ 131  ┆ 4            │
│ LPTUSDT      ┆ 0.476769     ┆ 132  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.667017     ┆ 133  ┆ 2            │
│ API3USDT     ┆ 0.718955     ┆ 134  ┆ 1            │
│ DEFIUSDT     ┆ 1.432143     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,700 - WARNING - 2023-03-02T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,700 - INFO - cur close time: 2023-03-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:28,700 - DEBUG - mean expected ret (mean factor): -0.7739024269828031
2024-11-20 23:07:28,705 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,705 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,706 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1695      ┆ null        ┆ … ┆ 0.03078 ┆ null   ┆ null    ┆ 0.2762  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,711 - DEBUG - update position: 2023-03-02T23:59:59.999 === diff_trading_value: 231742.03793905274 == cash: 124990.53058076046 
2024-11-20 23:07:28,712 - INFO - pnl: 2023-03-02T23:59:59.999 124990.53058076046 === -0.899%
2024-11-20 23:07:28,715 - DEBUG - cur time: 2023-03-03T23:59:59.999 == next bar open time: 2023-03-04T00:00:00.000 == close pos time: 2023-03-11T00:00:00.000
2024-11-20 23:07:28,716 - INFO - pnl: 2023-03-03T23:59:59.999 122749.36079074784 === -1.793%
2024-11-20 23:07:28,719 - DEBUG - cur time: 2023-03-04T23:59:59.999 == next bar open time: 2023-03-05T00:00:00.000 == close pos time: 2023-03-12T00:00:00.000
2024-11-20 23:07:28,721 - INFO - pnl: 2023-03-04T23:59:59.999 122930.17274656601 === 0.147%
2024-11-20 23:07:28,724 - DEBUG - cur time: 2023-03-05T23:59:59.999 == next bar open time: 2023-03-06T00:00:00.000 == close pos time: 2023-03-13T00:00:00.000
2024-11-20 23:07:28,725 - INFO - pnl: 2023-03-05T23:59:59.999 122472.3863662501 === -0.372%
2024-11-20 23:07:28,729 - DEBUG - cur time: 2023-03-06T23:59:59.999 == next bar open time: 2023-03-07T00:00:00.000 == close pos time: 2023-03-14T00:00:00.000
2024-11-20 23:07:28,731 - INFO - pnl: 2023-03-06T23:59:59.999 122512.16680578243 === 0.032%
2024-11-20 23:07:28,733 - DEBUG - cur time: 2023-03-07T23:59:59.999 == next bar open time: 2023-03-08T00:00:00.000 == close pos time: 2023-03-15T00:00:00.000
2024-11-20 23:07:28,734 - INFO - pnl: 2023-03-07T23:59:59.999 122337.86030672136 === -0.142%
2024-11-20 23:07:28,737 - DEBUG - cur time: 2023-03-08T23:59:59.999 == next bar open time: 2023-03-09T00:00:00.000 == close pos time: 2023-03-16T00:00:00.000
2024-11-20 23:07:28,738 - INFO - pnl: 2023-03-08T23:59:59.999 122331.01128310742 === -0.006%
2024-11-20 23:07:28,741 - DEBUG - cur time: 2023-03-09T23:59:59.999 == next bar open time: 2023-03-10T00:00:00.000 == close pos time: 2023-03-17T00:00:00.000
2024-11-20 23:07:28,749 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ 1000LUNCUSDT ┆ -2.184723    ┆ 0    ┆ 135          │
│ TRXUSDT      ┆ -1.83608     ┆ 1    ┆ 134          │
│ QNTUSDT      ┆ -1.806239    ┆ 2    ┆ 133          │
│ LUNA2USDT    ┆ -1.724981    ┆ 3    ┆ 132          │
│ XRPUSDT      ┆ -1.677017    ┆ 4    ┆ 131          │
│ XLMUSDT      ┆ -1.676012    ┆ 5    ┆ 130          │
│ XMRUSDT      ┆ -1.621479    ┆ 6    ┆ 129          │
│ EOSUSDT      ┆ -1.606873    ┆ 7    ┆ 128          │
│ BALUSDT      ┆ -1.566089    ┆ 8    ┆ 127          │
│ 1000SHIBUSDT ┆ -1.549835    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ALICEUSDT    ┆ -0.028511    ┆ 126  ┆ 9            │
│ NKNUSDT      ┆ -0.002365    ┆ 127  ┆ 8            │
│ BLUEBIRDUSDT ┆ 0.045961     ┆ 128  ┆ 7            │
│ ARPAUSDT     ┆ 0.049353     ┆ 129  ┆ 6            │
│ 1000XECUSDT  ┆ 0.088055     ┆ 130  ┆ 5            │
│ DASHUSDT     ┆ 0.148824     ┆ 131  ┆ 4            │
│ ANTUSDT      ┆ 0.174385     ┆ 132  ┆ 3            │
│ CTSIUSDT     ┆ 0.292692     ┆ 133  ┆ 2            │
│ HNTUSDT      ┆ 0.838335     ┆ 134  ┆ 1            │
│ DEFIUSDT     ┆ 1.451428     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,754 - WARNING - 2023-03-09T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,754 - INFO - cur close time: 2023-03-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:28,754 - DEBUG - mean expected ret (mean factor): -0.7407283283358935
2024-11-20 23:07:28,759 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,760 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,760 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.129       ┆ null        ┆ … ┆ 0.02256 ┆ null   ┆ null    ┆ 0.1991  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,766 - DEBUG - update position: 2023-03-09T23:59:59.999 === diff_trading_value: 183414.57519360346 == cash: 120654.43988894115 
2024-11-20 23:07:28,767 - INFO - pnl: 2023-03-09T23:59:59.999 120654.43988894115 === -1.371%
2024-11-20 23:07:28,771 - DEBUG - cur time: 2023-03-10T23:59:59.999 == next bar open time: 2023-03-11T00:00:00.000 == close pos time: 2023-03-18T00:00:00.000
2024-11-20 23:07:28,772 - INFO - pnl: 2023-03-10T23:59:59.999 121621.5891261707 === 0.802%
2024-11-20 23:07:28,776 - DEBUG - cur time: 2023-03-11T23:59:59.999 == next bar open time: 2023-03-12T00:00:00.000 == close pos time: 2023-03-19T00:00:00.000
2024-11-20 23:07:28,778 - INFO - pnl: 2023-03-11T23:59:59.999 120631.54904708071 === -0.814%
2024-11-20 23:07:28,783 - DEBUG - cur time: 2023-03-12T23:59:59.999 == next bar open time: 2023-03-13T00:00:00.000 == close pos time: 2023-03-20T00:00:00.000
2024-11-20 23:07:28,784 - INFO - pnl: 2023-03-12T23:59:59.999 124272.72149953333 === 3.018%
2024-11-20 23:07:28,788 - DEBUG - cur time: 2023-03-13T23:59:59.999 == next bar open time: 2023-03-14T00:00:00.000 == close pos time: 2023-03-21T00:00:00.000
2024-11-20 23:07:28,790 - INFO - pnl: 2023-03-13T23:59:59.999 121938.622685558 === -1.878%
2024-11-20 23:07:28,793 - DEBUG - cur time: 2023-03-14T23:59:59.999 == next bar open time: 2023-03-15T00:00:00.000 == close pos time: 2023-03-22T00:00:00.000
2024-11-20 23:07:28,795 - INFO - pnl: 2023-03-14T23:59:59.999 124386.69529293527 === 2.008%
2024-11-20 23:07:28,798 - DEBUG - cur time: 2023-03-15T23:59:59.999 == next bar open time: 2023-03-16T00:00:00.000 == close pos time: 2023-03-23T00:00:00.000
2024-11-20 23:07:28,799 - INFO - pnl: 2023-03-15T23:59:59.999 121922.54043360782 === -1.981%
2024-11-20 23:07:28,802 - DEBUG - cur time: 2023-03-16T23:59:59.999 == next bar open time: 2023-03-17T00:00:00.000 == close pos time: 2023-03-24T00:00:00.000
2024-11-20 23:07:28,809 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -2.504975    ┆ 0    ┆ 134          │
│ FILUSDT      ┆ -1.934999    ┆ 1    ┆ 133          │
│ XRPUSDT      ┆ -1.775446    ┆ 2    ┆ 132          │
│ NEOUSDT      ┆ -1.752479    ┆ 3    ┆ 131          │
│ LDOUSDT      ┆ -1.694545    ┆ 4    ┆ 130          │
│ APTUSDT      ┆ -1.643758    ┆ 5    ┆ 129          │
│ BNBUSDT      ┆ -1.622275    ┆ 6    ┆ 128          │
│ FOOTBALLUSDT ┆ -1.609579    ┆ 7    ┆ 127          │
│ 1000SHIBUSDT ┆ -1.565308    ┆ 8    ┆ 126          │
│ IMXUSDT      ┆ -1.562623    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ STGUSDT      ┆ 0.034328     ┆ 125  ┆ 9            │
│ OGNUSDT      ┆ 0.048715     ┆ 126  ┆ 8            │
│ DGBUSDT      ┆ 0.094111     ┆ 127  ┆ 7            │
│ DASHUSDT     ┆ 0.095098     ┆ 128  ┆ 6            │
│ NKNUSDT      ┆ 0.107563     ┆ 129  ┆ 5            │
│ MKRUSDT      ┆ 0.115283     ┆ 130  ┆ 4            │
│ TRBUSDT      ┆ 0.130949     ┆ 131  ┆ 3            │
│ 1000XECUSDT  ┆ 0.206701     ┆ 132  ┆ 2            │
│ CTSIUSDT     ┆ 0.303622     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 0.49457      ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,816 - WARNING - 2023-03-16T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,816 - INFO - cur close time: 2023-03-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:28,817 - DEBUG - mean expected ret (mean factor): -0.7629712448442765
2024-11-20 23:07:28,822 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,822 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,822 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1255      ┆ null        ┆ … ┆ 0.02733 ┆ null   ┆ null    ┆ 0.2218  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,828 - DEBUG - update position: 2023-03-16T23:59:59.999 === diff_trading_value: 283811.45124230615 == cash: 122430.73366874672 
2024-11-20 23:07:28,829 - INFO - pnl: 2023-03-16T23:59:59.999 122430.73366874672 === 0.417%
2024-11-20 23:07:28,833 - DEBUG - cur time: 2023-03-17T23:59:59.999 == next bar open time: 2023-03-18T00:00:00.000 == close pos time: 2023-03-25T00:00:00.000
2024-11-20 23:07:28,834 - INFO - pnl: 2023-03-17T23:59:59.999 120072.89749736417 === -1.926%
2024-11-20 23:07:28,837 - DEBUG - cur time: 2023-03-18T23:59:59.999 == next bar open time: 2023-03-19T00:00:00.000 == close pos time: 2023-03-26T00:00:00.000
2024-11-20 23:07:28,838 - INFO - pnl: 2023-03-18T23:59:59.999 118013.27332313698 === -1.715%
2024-11-20 23:07:28,841 - DEBUG - cur time: 2023-03-19T23:59:59.999 == next bar open time: 2023-03-20T00:00:00.000 == close pos time: 2023-03-27T00:00:00.000
2024-11-20 23:07:28,843 - INFO - pnl: 2023-03-19T23:59:59.999 118761.65688971218 === 0.634%
2024-11-20 23:07:28,846 - DEBUG - cur time: 2023-03-20T23:59:59.999 == next bar open time: 2023-03-21T00:00:00.000 == close pos time: 2023-03-28T00:00:00.000
2024-11-20 23:07:28,847 - INFO - pnl: 2023-03-20T23:59:59.999 120952.92761209114 === 1.845%
2024-11-20 23:07:28,850 - DEBUG - cur time: 2023-03-21T23:59:59.999 == next bar open time: 2023-03-22T00:00:00.000 == close pos time: 2023-03-29T00:00:00.000
2024-11-20 23:07:28,851 - INFO - pnl: 2023-03-21T23:59:59.999 121046.94815436602 === 0.078%
2024-11-20 23:07:28,854 - DEBUG - cur time: 2023-03-22T23:59:59.999 == next bar open time: 2023-03-23T00:00:00.000 == close pos time: 2023-03-30T00:00:00.000
2024-11-20 23:07:28,856 - INFO - pnl: 2023-03-22T23:59:59.999 119881.82607957427 === -0.963%
2024-11-20 23:07:28,858 - DEBUG - cur time: 2023-03-23T23:59:59.999 == next bar open time: 2023-03-24T00:00:00.000 == close pos time: 2023-03-31T00:00:00.000
2024-11-20 23:07:28,865 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -2.075041    ┆ 0    ┆ 134          │
│ FILUSDT      ┆ -1.903032    ┆ 1    ┆ 133          │
│ EGLDUSDT     ┆ -1.872136    ┆ 2    ┆ 132          │
│ AXSUSDT      ┆ -1.782932    ┆ 3    ┆ 131          │
│ ATOMUSDT     ┆ -1.736076    ┆ 4    ┆ 130          │
│ RLCUSDT      ┆ -1.569611    ┆ 5    ┆ 129          │
│ NEOUSDT      ┆ -1.56006     ┆ 6    ┆ 128          │
│ LDOUSDT      ┆ -1.529682    ┆ 7    ┆ 127          │
│ EOSUSDT      ┆ -1.497304    ┆ 8    ┆ 126          │
│ DASHUSDT     ┆ -1.487078    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BLZUSDT      ┆ -0.000299    ┆ 125  ┆ 9            │
│ NKNUSDT      ┆ 0.000884     ┆ 126  ┆ 8            │
│ REEFUSDT     ┆ 0.053991     ┆ 127  ┆ 7            │
│ OGNUSDT      ┆ 0.239547     ┆ 128  ┆ 6            │
│ IOTXUSDT     ┆ 0.287413     ┆ 129  ┆ 5            │
│ 1000XECUSDT  ┆ 0.310844     ┆ 130  ┆ 4            │
│ DEFIUSDT     ┆ 0.316212     ┆ 131  ┆ 3            │
│ SPELLUSDT    ┆ 0.351179     ┆ 132  ┆ 2            │
│ DGBUSDT      ┆ 0.521151     ┆ 133  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.734596     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,870 - WARNING - 2023-03-23T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,870 - INFO - cur close time: 2023-03-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:28,871 - DEBUG - mean expected ret (mean factor): -0.7616605343234789
2024-11-20 23:07:28,875 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,876 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,876 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1259      ┆ null        ┆ … ┆ 0.02855 ┆ null   ┆ null    ┆ 0.2373  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,881 - DEBUG - update position: 2023-03-23T23:59:59.999 === diff_trading_value: 229379.63428106246 == cash: 120019.74972187863 
2024-11-20 23:07:28,882 - INFO - pnl: 2023-03-23T23:59:59.999 120019.74972187863 === 0.115%
2024-11-20 23:07:28,885 - DEBUG - cur time: 2023-03-24T23:59:59.999 == next bar open time: 2023-03-25T00:00:00.000 == close pos time: 2023-04-01T00:00:00.000
2024-11-20 23:07:28,887 - INFO - pnl: 2023-03-24T23:59:59.999 120294.40920777193 === 0.229%
2024-11-20 23:07:28,890 - DEBUG - cur time: 2023-03-25T23:59:59.999 == next bar open time: 2023-03-26T00:00:00.000 == close pos time: 2023-04-02T00:00:00.000
2024-11-20 23:07:28,891 - INFO - pnl: 2023-03-25T23:59:59.999 122486.25937438144 === 1.822%
2024-11-20 23:07:28,894 - DEBUG - cur time: 2023-03-26T23:59:59.999 == next bar open time: 2023-03-27T00:00:00.000 == close pos time: 2023-04-03T00:00:00.000
2024-11-20 23:07:28,895 - INFO - pnl: 2023-03-26T23:59:59.999 122211.14479966146 === -0.225%
2024-11-20 23:07:28,902 - DEBUG - cur time: 2023-03-27T23:59:59.999 == next bar open time: 2023-03-28T00:00:00.000 == close pos time: 2023-04-04T00:00:00.000
2024-11-20 23:07:28,903 - INFO - pnl: 2023-03-27T23:59:59.999 121143.4231833389 === -0.874%
2024-11-20 23:07:28,907 - DEBUG - cur time: 2023-03-28T23:59:59.999 == next bar open time: 2023-03-29T00:00:00.000 == close pos time: 2023-04-05T00:00:00.000
2024-11-20 23:07:28,908 - INFO - pnl: 2023-03-28T23:59:59.999 120685.15227138918 === -0.378%
2024-11-20 23:07:28,911 - DEBUG - cur time: 2023-03-29T23:59:59.999 == next bar open time: 2023-03-30T00:00:00.000 == close pos time: 2023-04-06T00:00:00.000
2024-11-20 23:07:28,913 - INFO - pnl: 2023-03-29T23:59:59.999 124031.77884742609 === 2.773%
2024-11-20 23:07:28,917 - DEBUG - cur time: 2023-03-30T23:59:59.999 == next bar open time: 2023-03-31T00:00:00.000 == close pos time: 2023-04-07T00:00:00.000
2024-11-20 23:07:28,925 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -1.90099     ┆ 0    ┆ 134          │
│ BNBUSDT      ┆ -1.749942    ┆ 1    ┆ 133          │
│ EOSUSDT      ┆ -1.681394    ┆ 2    ┆ 132          │
│ SUSHIUSDT    ┆ -1.603863    ┆ 3    ┆ 131          │
│ IMXUSDT      ┆ -1.542342    ┆ 4    ┆ 130          │
│ BTCDOMUSDT   ┆ -1.535043    ┆ 5    ┆ 129          │
│ EGLDUSDT     ┆ -1.495721    ┆ 6    ┆ 128          │
│ INJUSDT      ┆ -1.48594     ┆ 7    ┆ 127          │
│ UNIUSDT      ┆ -1.449398    ┆ 8    ┆ 126          │
│ AXSUSDT      ┆ -1.365079    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ -0.129506    ┆ 125  ┆ 9            │
│ SPELLUSDT    ┆ -0.067657    ┆ 126  ┆ 8            │
│ FLMUSDT      ┆ -0.066037    ┆ 127  ┆ 7            │
│ RSRUSDT      ┆ -0.054491    ┆ 128  ┆ 6            │
│ CHRUSDT      ┆ 0.062355     ┆ 129  ┆ 5            │
│ BAKEUSDT     ┆ 0.099121     ┆ 130  ┆ 4            │
│ 1000XECUSDT  ┆ 0.250738     ┆ 131  ┆ 3            │
│ DGBUSDT      ┆ 0.266307     ┆ 132  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.367777     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 0.731904     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,931 - WARNING - 2023-03-30T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,931 - INFO - cur close time: 2023-03-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:28,931 - DEBUG - mean expected ret (mean factor): -0.734206234494077
2024-11-20 23:07:28,935 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,935 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,936 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1221      ┆ null        ┆ … ┆ 0.02784 ┆ null   ┆ null    ┆ 0.2309  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,942 - DEBUG - update position: 2023-03-30T23:59:59.999 === diff_trading_value: 200440.34897605592 == cash: 125737.60072599007 
2024-11-20 23:07:28,942 - INFO - pnl: 2023-03-30T23:59:59.999 125737.60072599007 === 1.375%
2024-11-20 23:07:28,945 - DEBUG - cur time: 2023-03-31T23:59:59.999 == next bar open time: 2023-04-01T00:00:00.000 == close pos time: 2023-04-08T00:00:00.000
2024-11-20 23:07:28,947 - INFO - pnl: 2023-03-31T23:59:59.999 128969.98576840761 === 2.571%
2024-11-20 23:07:28,949 - DEBUG - cur time: 2023-04-01T23:59:59.999 == next bar open time: 2023-04-02T00:00:00.000 == close pos time: 2023-04-09T00:00:00.000
2024-11-20 23:07:28,951 - INFO - pnl: 2023-04-01T23:59:59.999 130937.94589628268 === 1.526%
2024-11-20 23:07:28,954 - DEBUG - cur time: 2023-04-02T23:59:59.999 == next bar open time: 2023-04-03T00:00:00.000 == close pos time: 2023-04-10T00:00:00.000
2024-11-20 23:07:28,955 - INFO - pnl: 2023-04-02T23:59:59.999 128179.86686627504 === -2.106%
2024-11-20 23:07:28,958 - DEBUG - cur time: 2023-04-03T23:59:59.999 == next bar open time: 2023-04-04T00:00:00.000 == close pos time: 2023-04-11T00:00:00.000
2024-11-20 23:07:28,959 - INFO - pnl: 2023-04-03T23:59:59.999 130126.67125670976 === 1.519%
2024-11-20 23:07:28,962 - DEBUG - cur time: 2023-04-04T23:59:59.999 == next bar open time: 2023-04-05T00:00:00.000 == close pos time: 2023-04-12T00:00:00.000
2024-11-20 23:07:28,963 - INFO - pnl: 2023-04-04T23:59:59.999 134899.3059608857 === 3.668%
2024-11-20 23:07:28,967 - DEBUG - cur time: 2023-04-05T23:59:59.999 == next bar open time: 2023-04-06T00:00:00.000 == close pos time: 2023-04-13T00:00:00.000
2024-11-20 23:07:28,969 - INFO - pnl: 2023-04-05T23:59:59.999 133470.86369304179 === -1.059%
2024-11-20 23:07:28,973 - DEBUG - cur time: 2023-04-06T23:59:59.999 == next bar open time: 2023-04-07T00:00:00.000 == close pos time: 2023-04-14T00:00:00.000
2024-11-20 23:07:28,980 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ APTUSDT  ┆ -1.993426    ┆ 0    ┆ 134          │
│ GTCUSDT  ┆ -1.949967    ┆ 1    ┆ 133          │
│ MKRUSDT  ┆ -1.922192    ┆ 2    ┆ 132          │
│ OMGUSDT  ┆ -1.799896    ┆ 3    ┆ 131          │
│ NEOUSDT  ┆ -1.765353    ┆ 4    ┆ 130          │
│ QTUMUSDT ┆ -1.706101    ┆ 5    ┆ 129          │
│ MTLUSDT  ┆ -1.560177    ┆ 6    ┆ 128          │
│ AAVEUSDT ┆ -1.467241    ┆ 7    ┆ 127          │
│ EOSUSDT  ┆ -1.395888    ┆ 8    ┆ 126          │
│ MASKUSDT ┆ -1.379053    ┆ 9    ┆ 125          │
│ …        ┆ …            ┆ …    ┆ …            │
│ DGBUSDT  ┆ -0.065263    ┆ 125  ┆ 9            │
│ LPTUSDT  ┆ -0.00545     ┆ 126  ┆ 8            │
│ SKLUSDT  ┆ 0.001833     ┆ 127  ┆ 7            │
│ ZENUSDT  ┆ 0.037059     ┆ 128  ┆ 6            │
│ CVXUSDT  ┆ 0.12848      ┆ 129  ┆ 5            │
│ CTKUSDT  ┆ 0.236281     ┆ 130  ┆ 4            │
│ KSMUSDT  ┆ 0.370612     ┆ 131  ┆ 3            │
│ ARUSDT   ┆ 0.417406     ┆ 132  ┆ 2            │
│ TRBUSDT  ┆ 0.990151     ┆ 133  ┆ 1            │
│ DEFIUSDT ┆ 1.428279     ┆ 134  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:28,986 - WARNING - 2023-04-06T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:28,986 - INFO - cur close time: 2023-04-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:28,986 - DEBUG - mean expected ret (mean factor): -0.7553520416544333
2024-11-20 23:07:28,990 - DEBUG - begin to update pos: =========
2024-11-20 23:07:28,990 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,990 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1247      ┆ null        ┆ … ┆ 0.02947 ┆ null   ┆ null    ┆ 0.3025  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:28,997 - DEBUG - update position: 2023-04-06T23:59:59.999 === diff_trading_value: 321567.2186096339 == cash: 131725.66809553176 
2024-11-20 23:07:28,998 - INFO - pnl: 2023-04-06T23:59:59.999 131725.66809553176 === -1.308%
2024-11-20 23:07:29,000 - DEBUG - cur time: 2023-04-07T23:59:59.999 == next bar open time: 2023-04-08T00:00:00.000 == close pos time: 2023-04-15T00:00:00.000
2024-11-20 23:07:29,002 - INFO - pnl: 2023-04-07T23:59:59.999 132879.8329449052 === 0.876%
2024-11-20 23:07:29,005 - DEBUG - cur time: 2023-04-08T23:59:59.999 == next bar open time: 2023-04-09T00:00:00.000 == close pos time: 2023-04-16T00:00:00.000
2024-11-20 23:07:29,006 - INFO - pnl: 2023-04-08T23:59:59.999 133074.78639179215 === 0.147%
2024-11-20 23:07:29,011 - DEBUG - cur time: 2023-04-09T23:59:59.999 == next bar open time: 2023-04-10T00:00:00.000 == close pos time: 2023-04-17T00:00:00.000
2024-11-20 23:07:29,013 - INFO - pnl: 2023-04-09T23:59:59.999 134812.19301089525 === 1.306%
2024-11-20 23:07:29,017 - DEBUG - cur time: 2023-04-10T23:59:59.999 == next bar open time: 2023-04-11T00:00:00.000 == close pos time: 2023-04-18T00:00:00.000
2024-11-20 23:07:29,018 - INFO - pnl: 2023-04-10T23:59:59.999 134558.98486301166 === -0.188%
2024-11-20 23:07:29,021 - DEBUG - cur time: 2023-04-11T23:59:59.999 == next bar open time: 2023-04-12T00:00:00.000 == close pos time: 2023-04-19T00:00:00.000
2024-11-20 23:07:29,023 - INFO - pnl: 2023-04-11T23:59:59.999 133309.16520422936 === -0.929%
2024-11-20 23:07:29,026 - DEBUG - cur time: 2023-04-12T23:59:59.999 == next bar open time: 2023-04-13T00:00:00.000 == close pos time: 2023-04-20T00:00:00.000
2024-11-20 23:07:29,028 - INFO - pnl: 2023-04-12T23:59:59.999 134612.7765470035 === 0.978%
2024-11-20 23:07:29,031 - DEBUG - cur time: 2023-04-13T23:59:59.999 == next bar open time: 2023-04-14T00:00:00.000 == close pos time: 2023-04-21T00:00:00.000
2024-11-20 23:07:29,037 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -2.045686    ┆ 0    ┆ 134          │
│ BNBUSDT      ┆ -1.881774    ┆ 1    ┆ 133          │
│ ICPUSDT      ┆ -1.768611    ┆ 2    ┆ 132          │
│ INJUSDT      ┆ -1.722246    ┆ 3    ┆ 131          │
│ FOOTBALLUSDT ┆ -1.617776    ┆ 4    ┆ 130          │
│ MASKUSDT     ┆ -1.608151    ┆ 5    ┆ 129          │
│ FTMUSDT      ┆ -1.567966    ┆ 6    ┆ 128          │
│ FILUSDT      ┆ -1.557635    ┆ 7    ┆ 127          │
│ NEOUSDT      ┆ -1.556151    ┆ 8    ┆ 126          │
│ ATOMUSDT     ┆ -1.538633    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DENTUSDT     ┆ -0.003613    ┆ 125  ┆ 9            │
│ CTKUSDT      ┆ 0.009414     ┆ 126  ┆ 8            │
│ 1000XECUSDT  ┆ 0.072042     ┆ 127  ┆ 7            │
│ SPELLUSDT    ┆ 0.109212     ┆ 128  ┆ 6            │
│ BLZUSDT      ┆ 0.223701     ┆ 129  ┆ 5            │
│ DGBUSDT      ┆ 0.235431     ┆ 130  ┆ 4            │
│ SKLUSDT      ┆ 0.332236     ┆ 131  ┆ 3            │
│ CVXUSDT      ┆ 0.380493     ┆ 132  ┆ 2            │
│ LPTUSDT      ┆ 0.612435     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 0.971497     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,043 - WARNING - 2023-04-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,043 - INFO - cur close time: 2023-04-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:29,044 - DEBUG - mean expected ret (mean factor): -0.7952221693421768
2024-11-20 23:07:29,047 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,048 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,048 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1268      ┆ null        ┆ … ┆ 0.02984 ┆ null   ┆ null    ┆ 0.2808  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,053 - DEBUG - update position: 2023-04-13T23:59:59.999 === diff_trading_value: 258276.62629980448 == cash: 134221.5839748771 
2024-11-20 23:07:29,053 - INFO - pnl: 2023-04-13T23:59:59.999 134221.5839748771 === -0.291%
2024-11-20 23:07:29,058 - DEBUG - cur time: 2023-04-14T23:59:59.999 == next bar open time: 2023-04-15T00:00:00.000 == close pos time: 2023-04-22T00:00:00.000
2024-11-20 23:07:29,059 - INFO - pnl: 2023-04-14T23:59:59.999 132432.42800768567 === -1.333%
2024-11-20 23:07:29,064 - DEBUG - cur time: 2023-04-15T23:59:59.999 == next bar open time: 2023-04-16T00:00:00.000 == close pos time: 2023-04-23T00:00:00.000
2024-11-20 23:07:29,065 - INFO - pnl: 2023-04-15T23:59:59.999 132043.8545357098 === -0.293%
2024-11-20 23:07:29,070 - DEBUG - cur time: 2023-04-16T23:59:59.999 == next bar open time: 2023-04-17T00:00:00.000 == close pos time: 2023-04-24T00:00:00.000
2024-11-20 23:07:29,071 - INFO - pnl: 2023-04-16T23:59:59.999 130811.24360386221 === -0.933%
2024-11-20 23:07:29,074 - DEBUG - cur time: 2023-04-17T23:59:59.999 == next bar open time: 2023-04-18T00:00:00.000 == close pos time: 2023-04-25T00:00:00.000
2024-11-20 23:07:29,075 - INFO - pnl: 2023-04-17T23:59:59.999 130233.33309214188 === -0.442%
2024-11-20 23:07:29,079 - DEBUG - cur time: 2023-04-18T23:59:59.999 == next bar open time: 2023-04-19T00:00:00.000 == close pos time: 2023-04-26T00:00:00.000
2024-11-20 23:07:29,081 - INFO - pnl: 2023-04-18T23:59:59.999 130860.8045365086 === 0.482%
2024-11-20 23:07:29,086 - DEBUG - cur time: 2023-04-19T23:59:59.999 == next bar open time: 2023-04-20T00:00:00.000 == close pos time: 2023-04-27T00:00:00.000
2024-11-20 23:07:29,087 - INFO - pnl: 2023-04-19T23:59:59.999 130880.21374462185 === 0.015%
2024-11-20 23:07:29,091 - DEBUG - cur time: 2023-04-20T23:59:59.999 == next bar open time: 2023-04-21T00:00:00.000 == close pos time: 2023-04-28T00:00:00.000
2024-11-20 23:07:29,098 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AXSUSDT      ┆ -1.572263    ┆ 0    ┆ 134          │
│ ICPUSDT      ┆ -1.476944    ┆ 1    ┆ 133          │
│ APTUSDT      ┆ -1.462787    ┆ 2    ┆ 132          │
│ FOOTBALLUSDT ┆ -1.445188    ┆ 3    ┆ 131          │
│ UNFIUSDT     ┆ -1.437022    ┆ 4    ┆ 130          │
│ NEOUSDT      ┆ -1.423356    ┆ 5    ┆ 129          │
│ SANDUSDT     ┆ -1.4036      ┆ 6    ┆ 128          │
│ DYDXUSDT     ┆ -1.360287    ┆ 7    ┆ 127          │
│ BNBUSDT      ┆ -1.331984    ┆ 8    ┆ 126          │
│ HOTUSDT      ┆ -1.324722    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOTXUSDT     ┆ -0.204913    ┆ 125  ┆ 9            │
│ TRBUSDT      ┆ -0.176644    ┆ 126  ┆ 8            │
│ LPTUSDT      ┆ -0.076464    ┆ 127  ┆ 7            │
│ GTCUSDT      ┆ -0.036096    ┆ 128  ┆ 6            │
│ API3USDT     ┆ 0.01726      ┆ 129  ┆ 5            │
│ ANTUSDT      ┆ 0.040351     ┆ 130  ┆ 4            │
│ BLUEBIRDUSDT ┆ 0.040829     ┆ 131  ┆ 3            │
│ KSMUSDT      ┆ 0.153501     ┆ 132  ┆ 2            │
│ CVXUSDT      ┆ 0.666504     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 1.787811     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,105 - WARNING - 2023-04-20T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,106 - INFO - cur close time: 2023-04-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:29,106 - DEBUG - mean expected ret (mean factor): -0.7686262910691393
2024-11-20 23:07:29,110 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,110 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,110 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1135      ┆ null        ┆ … ┆ 0.03016 ┆ null   ┆ null    ┆ 0.2656  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,117 - DEBUG - update position: 2023-04-20T23:59:59.999 === diff_trading_value: 210712.85052815915 == cash: 129587.14263897433 
2024-11-20 23:07:29,119 - INFO - pnl: 2023-04-20T23:59:59.999 129587.14263897433 === -0.988%
2024-11-20 23:07:29,123 - DEBUG - cur time: 2023-04-21T23:59:59.999 == next bar open time: 2023-04-22T00:00:00.000 == close pos time: 2023-04-29T00:00:00.000
2024-11-20 23:07:29,125 - INFO - pnl: 2023-04-21T23:59:59.999 130317.73962122126 === 0.564%
2024-11-20 23:07:29,128 - DEBUG - cur time: 2023-04-22T23:59:59.999 == next bar open time: 2023-04-23T00:00:00.000 == close pos time: 2023-04-30T00:00:00.000
2024-11-20 23:07:29,129 - INFO - pnl: 2023-04-22T23:59:59.999 130692.62625444219 === 0.288%
2024-11-20 23:07:29,132 - DEBUG - cur time: 2023-04-23T23:59:59.999 == next bar open time: 2023-04-24T00:00:00.000 == close pos time: 2023-05-01T00:00:00.000
2024-11-20 23:07:29,134 - INFO - pnl: 2023-04-23T23:59:59.999 131213.1535544764 === 0.398%
2024-11-20 23:07:29,139 - DEBUG - cur time: 2023-04-24T23:59:59.999 == next bar open time: 2023-04-25T00:00:00.000 == close pos time: 2023-05-02T00:00:00.000
2024-11-20 23:07:29,140 - INFO - pnl: 2023-04-24T23:59:59.999 130292.07237208873 === -0.702%
2024-11-20 23:07:29,145 - DEBUG - cur time: 2023-04-25T23:59:59.999 == next bar open time: 2023-04-26T00:00:00.000 == close pos time: 2023-05-03T00:00:00.000
2024-11-20 23:07:29,146 - INFO - pnl: 2023-04-25T23:59:59.999 130524.19731335728 === 0.178%
2024-11-20 23:07:29,151 - DEBUG - cur time: 2023-04-26T23:59:59.999 == next bar open time: 2023-04-27T00:00:00.000 == close pos time: 2023-05-04T00:00:00.000
2024-11-20 23:07:29,152 - INFO - pnl: 2023-04-26T23:59:59.999 131197.47820482333 === 0.516%
2024-11-20 23:07:29,157 - DEBUG - cur time: 2023-04-27T23:59:59.999 == next bar open time: 2023-04-28T00:00:00.000 == close pos time: 2023-05-05T00:00:00.000
2024-11-20 23:07:29,168 - DEBUG - sorted_long_factors: shape: (135, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ UNFIUSDT  ┆ -2.144685    ┆ 0    ┆ 134          │
│ AXSUSDT   ┆ -2.072633    ┆ 1    ┆ 133          │
│ ICPUSDT   ┆ -1.778233    ┆ 2    ┆ 132          │
│ APTUSDT   ┆ -1.685683    ┆ 3    ┆ 131          │
│ AAVEUSDT  ┆ -1.657196    ┆ 4    ┆ 130          │
│ FILUSDT   ┆ -1.607405    ┆ 5    ┆ 129          │
│ UNIUSDT   ┆ -1.586321    ┆ 6    ┆ 128          │
│ DOTUSDT   ┆ -1.582131    ┆ 7    ┆ 127          │
│ SNXUSDT   ┆ -1.540968    ┆ 8    ┆ 126          │
│ SANDUSDT  ┆ -1.479607    ┆ 9    ┆ 125          │
│ …         ┆ …            ┆ …    ┆ …            │
│ OGNUSDT   ┆ -0.109265    ┆ 125  ┆ 9            │
│ CHRUSDT   ┆ -0.107407    ┆ 126  ┆ 8            │
│ DARUSDT   ┆ -0.044254    ┆ 127  ┆ 7            │
│ FLMUSDT   ┆ -0.043736    ┆ 128  ┆ 6            │
│ SKLUSDT   ┆ 0.002941     ┆ 129  ┆ 5            │
│ DENTUSDT  ┆ 0.027683     ┆ 130  ┆ 4            │
│ BLZUSDT   ┆ 0.045044     ┆ 131  ┆ 3            │
│ SPELLUSDT ┆ 0.169134     ┆ 132  ┆ 2            │
│ DGBUSDT   ┆ 0.205182     ┆ 133  ┆ 1            │
│ DEFIUSDT  ┆ 1.025354     ┆ 134  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,175 - WARNING - 2023-04-27T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,175 - INFO - cur close time: 2023-04-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:29,175 - DEBUG - mean expected ret (mean factor): -0.7803506523102313
2024-11-20 23:07:29,179 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,179 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,179 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1091      ┆ null        ┆ … ┆ 0.02919 ┆ null   ┆ null    ┆ 0.266   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,184 - DEBUG - update position: 2023-04-27T23:59:59.999 === diff_trading_value: 211980.91489688936 == cash: 130863.20619529234 
2024-11-20 23:07:29,186 - INFO - pnl: 2023-04-27T23:59:59.999 130863.20619529234 === -0.255%
2024-11-20 23:07:29,189 - DEBUG - cur time: 2023-04-28T23:59:59.999 == next bar open time: 2023-04-29T00:00:00.000 == close pos time: 2023-05-06T00:00:00.000
2024-11-20 23:07:29,190 - INFO - pnl: 2023-04-28T23:59:59.999 128534.57299489621 === -1.779%
2024-11-20 23:07:29,193 - DEBUG - cur time: 2023-04-29T23:59:59.999 == next bar open time: 2023-04-30T00:00:00.000 == close pos time: 2023-05-07T00:00:00.000
2024-11-20 23:07:29,194 - INFO - pnl: 2023-04-29T23:59:59.999 127205.50452156774 === -1.034%
2024-11-20 23:07:29,197 - DEBUG - cur time: 2023-04-30T23:59:59.999 == next bar open time: 2023-05-01T00:00:00.000 == close pos time: 2023-05-08T00:00:00.000
2024-11-20 23:07:29,199 - INFO - pnl: 2023-04-30T23:59:59.999 127099.49272725999 === -0.083%
2024-11-20 23:07:29,202 - DEBUG - cur time: 2023-05-01T23:59:59.999 == next bar open time: 2023-05-02T00:00:00.000 == close pos time: 2023-05-09T00:00:00.000
2024-11-20 23:07:29,203 - INFO - pnl: 2023-05-01T23:59:59.999 128110.54065434972 === 0.795%
2024-11-20 23:07:29,206 - DEBUG - cur time: 2023-05-02T23:59:59.999 == next bar open time: 2023-05-03T00:00:00.000 == close pos time: 2023-05-10T00:00:00.000
2024-11-20 23:07:29,207 - INFO - pnl: 2023-05-02T23:59:59.999 128717.85744544894 === 0.474%
2024-11-20 23:07:29,210 - DEBUG - cur time: 2023-05-03T23:59:59.999 == next bar open time: 2023-05-04T00:00:00.000 == close pos time: 2023-05-11T00:00:00.000
2024-11-20 23:07:29,211 - INFO - pnl: 2023-05-03T23:59:59.999 128563.68751913156 === -0.120%
2024-11-20 23:07:29,215 - DEBUG - cur time: 2023-05-04T23:59:59.999 == next bar open time: 2023-05-05T00:00:00.000 == close pos time: 2023-05-12T00:00:00.000
2024-11-20 23:07:29,222 - DEBUG - sorted_long_factors: shape: (138, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ XMRUSDT    ┆ -2.038692    ┆ 0    ┆ 137          │
│ HOOKUSDT   ┆ -1.743306    ┆ 1    ┆ 136          │
│ ICPUSDT    ┆ -1.618128    ┆ 2    ┆ 135          │
│ APTUSDT    ┆ -1.584743    ┆ 3    ┆ 134          │
│ WOOUSDT    ┆ -1.418991    ┆ 4    ┆ 133          │
│ SXPUSDT    ┆ -1.40949     ┆ 5    ┆ 132          │
│ OPUSDT     ┆ -1.377197    ┆ 6    ┆ 131          │
│ BANDUSDT   ┆ -1.34562     ┆ 7    ┆ 130          │
│ NEARUSDT   ┆ -1.316941    ┆ 8    ┆ 129          │
│ MTLUSDT    ┆ -1.277017    ┆ 9    ┆ 128          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BTCDOMUSDT ┆ -0.184273    ┆ 128  ┆ 9            │
│ ONEUSDT    ┆ -0.164506    ┆ 129  ┆ 8            │
│ KSMUSDT    ┆ -0.082875    ┆ 130  ┆ 7            │
│ ANTUSDT    ┆ -0.025076    ┆ 131  ┆ 6            │
│ BLZUSDT    ┆ 0.072818     ┆ 132  ┆ 5            │
│ CVXUSDT    ┆ 0.076874     ┆ 133  ┆ 4            │
│ BAKEUSDT   ┆ 0.107172     ┆ 134  ┆ 3            │
│ SPELLUSDT  ┆ 0.211357     ┆ 135  ┆ 2            │
│ DGBUSDT    ┆ 0.390939     ┆ 136  ┆ 1            │
│ DEFIUSDT   ┆ 1.210894     ┆ 137  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,227 - WARNING - 2023-05-04T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,227 - INFO - cur close time: 2023-05-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:29,227 - DEBUG - mean expected ret (mean factor): -0.7825921210554482
2024-11-20 23:07:29,230 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,231 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,231 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1035      ┆ null        ┆ … ┆ 0.02702 ┆ null   ┆ null    ┆ 0.2457  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,237 - DEBUG - update position: 2023-05-04T23:59:59.999 === diff_trading_value: 259373.55589303636 == cash: 127978.16717102246 
2024-11-20 23:07:29,237 - INFO - pnl: 2023-05-04T23:59:59.999 127978.16717102246 === -0.455%
2024-11-20 23:07:29,240 - DEBUG - cur time: 2023-05-05T23:59:59.999 == next bar open time: 2023-05-06T00:00:00.000 == close pos time: 2023-05-13T00:00:00.000
2024-11-20 23:07:29,241 - INFO - pnl: 2023-05-05T23:59:59.999 127155.64071744046 === -0.643%
2024-11-20 23:07:29,244 - DEBUG - cur time: 2023-05-06T23:59:59.999 == next bar open time: 2023-05-07T00:00:00.000 == close pos time: 2023-05-14T00:00:00.000
2024-11-20 23:07:29,245 - INFO - pnl: 2023-05-06T23:59:59.999 128889.00538357726 === 1.363%
2024-11-20 23:07:29,248 - DEBUG - cur time: 2023-05-07T23:59:59.999 == next bar open time: 2023-05-08T00:00:00.000 == close pos time: 2023-05-15T00:00:00.000
2024-11-20 23:07:29,250 - INFO - pnl: 2023-05-07T23:59:59.999 129277.18315802106 === 0.301%
2024-11-20 23:07:29,254 - DEBUG - cur time: 2023-05-08T23:59:59.999 == next bar open time: 2023-05-09T00:00:00.000 == close pos time: 2023-05-16T00:00:00.000
2024-11-20 23:07:29,256 - INFO - pnl: 2023-05-08T23:59:59.999 130070.43642541785 === 0.614%
2024-11-20 23:07:29,260 - DEBUG - cur time: 2023-05-09T23:59:59.999 == next bar open time: 2023-05-10T00:00:00.000 == close pos time: 2023-05-17T00:00:00.000
2024-11-20 23:07:29,261 - INFO - pnl: 2023-05-09T23:59:59.999 131007.36667661091 === 0.720%
2024-11-20 23:07:29,264 - DEBUG - cur time: 2023-05-10T23:59:59.999 == next bar open time: 2023-05-11T00:00:00.000 == close pos time: 2023-05-18T00:00:00.000
2024-11-20 23:07:29,265 - INFO - pnl: 2023-05-10T23:59:59.999 132255.12759726393 === 0.952%
2024-11-20 23:07:29,267 - DEBUG - cur time: 2023-05-11T23:59:59.999 == next bar open time: 2023-05-12T00:00:00.000 == close pos time: 2023-05-19T00:00:00.000
2024-11-20 23:07:29,276 - DEBUG - sorted_long_factors: shape: (139, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ EGLDUSDT     ┆ -1.787507    ┆ 0    ┆ 138          │
│ ICPUSDT      ┆ -1.782713    ┆ 1    ┆ 137          │
│ STMXUSDT     ┆ -1.662344    ┆ 2    ┆ 136          │
│ MTLUSDT      ┆ -1.625733    ┆ 3    ┆ 135          │
│ BTCDOMUSDT   ┆ -1.569537    ┆ 4    ┆ 134          │
│ JASMYUSDT    ┆ -1.443383    ┆ 5    ┆ 133          │
│ CHZUSDT      ┆ -1.399873    ┆ 6    ┆ 132          │
│ 1000SHIBUSDT ┆ -1.377991    ┆ 7    ┆ 131          │
│ TRXUSDT      ┆ -1.347617    ┆ 8    ┆ 130          │
│ RLCUSDT      ┆ -1.315008    ┆ 9    ┆ 129          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BLZUSDT      ┆ -0.118998    ┆ 129  ┆ 9            │
│ KNCUSDT      ┆ -0.097664    ┆ 130  ┆ 8            │
│ DASHUSDT     ┆ -0.039956    ┆ 131  ┆ 7            │
│ LPTUSDT      ┆ 0.02761      ┆ 132  ┆ 6            │
│ TRBUSDT      ┆ 0.069705     ┆ 133  ┆ 5            │
│ BAKEUSDT     ┆ 0.098857     ┆ 134  ┆ 4            │
│ ZENUSDT      ┆ 0.107834     ┆ 135  ┆ 3            │
│ FOOTBALLUSDT ┆ 0.127086     ┆ 136  ┆ 2            │
│ CVXUSDT      ┆ 0.522914     ┆ 137  ┆ 1            │
│ DEFIUSDT     ┆ 1.093314     ┆ 138  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,282 - WARNING - 2023-05-11T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,282 - INFO - cur close time: 2023-05-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:29,282 - DEBUG - mean expected ret (mean factor): -0.7572768095930283
2024-11-20 23:07:29,285 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,286 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,286 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0857      ┆ null        ┆ … ┆ 0.02333 ┆ null   ┆ null    ┆ 0.2152  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,292 - DEBUG - update position: 2023-05-11T23:59:59.999 === diff_trading_value: 277752.1888111087 == cash: 132481.3487798801 
2024-11-20 23:07:29,294 - INFO - pnl: 2023-05-11T23:59:59.999 132481.3487798801 === 0.171%
2024-11-20 23:07:29,298 - DEBUG - cur time: 2023-05-12T23:59:59.999 == next bar open time: 2023-05-13T00:00:00.000 == close pos time: 2023-05-20T00:00:00.000
2024-11-20 23:07:29,300 - INFO - pnl: 2023-05-12T23:59:59.999 133456.18706118016 === 0.736%
2024-11-20 23:07:29,303 - DEBUG - cur time: 2023-05-13T23:59:59.999 == next bar open time: 2023-05-14T00:00:00.000 == close pos time: 2023-05-21T00:00:00.000
2024-11-20 23:07:29,304 - INFO - pnl: 2023-05-13T23:59:59.999 132456.92784826347 === -0.749%
2024-11-20 23:07:29,308 - DEBUG - cur time: 2023-05-14T23:59:59.999 == next bar open time: 2023-05-15T00:00:00.000 == close pos time: 2023-05-22T00:00:00.000
2024-11-20 23:07:29,309 - INFO - pnl: 2023-05-14T23:59:59.999 133305.5085609347 === 0.641%
2024-11-20 23:07:29,314 - DEBUG - cur time: 2023-05-15T23:59:59.999 == next bar open time: 2023-05-16T00:00:00.000 == close pos time: 2023-05-23T00:00:00.000
2024-11-20 23:07:29,315 - INFO - pnl: 2023-05-15T23:59:59.999 133750.88966294093 === 0.334%
2024-11-20 23:07:29,319 - DEBUG - cur time: 2023-05-16T23:59:59.999 == next bar open time: 2023-05-17T00:00:00.000 == close pos time: 2023-05-24T00:00:00.000
2024-11-20 23:07:29,320 - INFO - pnl: 2023-05-16T23:59:59.999 134459.05026574113 === 0.529%
2024-11-20 23:07:29,323 - DEBUG - cur time: 2023-05-17T23:59:59.999 == next bar open time: 2023-05-18T00:00:00.000 == close pos time: 2023-05-25T00:00:00.000
2024-11-20 23:07:29,323 - INFO - pnl: 2023-05-17T23:59:59.999 135578.3746490453 === 0.832%
2024-11-20 23:07:29,327 - DEBUG - cur time: 2023-05-18T23:59:59.999 == next bar open time: 2023-05-19T00:00:00.000 == close pos time: 2023-05-26T00:00:00.000
2024-11-20 23:07:29,335 - DEBUG - sorted_long_factors: shape: (141, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ RNDRUSDT    ┆ -1.771306    ┆ 0    ┆ 140          │
│ AAVEUSDT    ┆ -1.742881    ┆ 1    ┆ 139          │
│ MTLUSDT     ┆ -1.627138    ┆ 2    ┆ 138          │
│ MAGICUSDT   ┆ -1.557823    ┆ 3    ┆ 137          │
│ XRPUSDT     ┆ -1.552846    ┆ 4    ┆ 136          │
│ FETUSDT     ┆ -1.468461    ┆ 5    ┆ 135          │
│ FILUSDT     ┆ -1.465914    ┆ 6    ┆ 134          │
│ CHZUSDT     ┆ -1.463951    ┆ 7    ┆ 133          │
│ MASKUSDT    ┆ -1.41411     ┆ 8    ┆ 132          │
│ NEOUSDT     ┆ -1.410469    ┆ 9    ┆ 131          │
│ …           ┆ …            ┆ …    ┆ …            │
│ ATAUSDT     ┆ -0.077017    ┆ 131  ┆ 9            │
│ BLZUSDT     ┆ -0.064952    ┆ 132  ┆ 8            │
│ DEFIUSDT    ┆ -0.056323    ┆ 133  ┆ 7            │
│ KAVAUSDT    ┆ -0.036688    ┆ 134  ┆ 6            │
│ SKLUSDT     ┆ -0.03031     ┆ 135  ┆ 5            │
│ 1000XECUSDT ┆ 0.016981     ┆ 136  ┆ 4            │
│ BAKEUSDT    ┆ 0.220872     ┆ 137  ┆ 3            │
│ KLAYUSDT    ┆ 0.322983     ┆ 138  ┆ 2            │
│ LPTUSDT     ┆ 0.356408     ┆ 139  ┆ 1            │
│ CVXUSDT     ┆ 0.374385     ┆ 140  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,342 - WARNING - 2023-05-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,342 - INFO - cur close time: 2023-05-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:29,342 - DEBUG - mean expected ret (mean factor): -0.7867017493804704
2024-11-20 23:07:29,347 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,347 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,347 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0906      ┆ null        ┆ … ┆ 0.02396 ┆ null   ┆ null    ┆ 0.2284  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,354 - DEBUG - update position: 2023-05-18T23:59:59.999 === diff_trading_value: 246612.59332595294 == cash: 135085.71720986662 
2024-11-20 23:07:29,356 - INFO - pnl: 2023-05-18T23:59:59.999 135085.71720986662 === -0.363%
2024-11-20 23:07:29,359 - DEBUG - cur time: 2023-05-19T23:59:59.999 == next bar open time: 2023-05-20T00:00:00.000 == close pos time: 2023-05-27T00:00:00.000
2024-11-20 23:07:29,360 - INFO - pnl: 2023-05-19T23:59:59.999 135869.95266888308 === 0.581%
2024-11-20 23:07:29,364 - DEBUG - cur time: 2023-05-20T23:59:59.999 == next bar open time: 2023-05-21T00:00:00.000 == close pos time: 2023-05-28T00:00:00.000
2024-11-20 23:07:29,365 - INFO - pnl: 2023-05-20T23:59:59.999 136008.55577843537 === 0.102%
2024-11-20 23:07:29,369 - DEBUG - cur time: 2023-05-21T23:59:59.999 == next bar open time: 2023-05-22T00:00:00.000 == close pos time: 2023-05-29T00:00:00.000
2024-11-20 23:07:29,371 - INFO - pnl: 2023-05-21T23:59:59.999 135481.0124389325 === -0.388%
2024-11-20 23:07:29,376 - DEBUG - cur time: 2023-05-22T23:59:59.999 == next bar open time: 2023-05-23T00:00:00.000 == close pos time: 2023-05-30T00:00:00.000
2024-11-20 23:07:29,377 - INFO - pnl: 2023-05-22T23:59:59.999 135384.71303843253 === -0.071%
2024-11-20 23:07:29,380 - DEBUG - cur time: 2023-05-23T23:59:59.999 == next bar open time: 2023-05-24T00:00:00.000 == close pos time: 2023-05-31T00:00:00.000
2024-11-20 23:07:29,382 - INFO - pnl: 2023-05-23T23:59:59.999 134947.46449732577 === -0.323%
2024-11-20 23:07:29,385 - DEBUG - cur time: 2023-05-24T23:59:59.999 == next bar open time: 2023-05-25T00:00:00.000 == close pos time: 2023-06-01T00:00:00.000
2024-11-20 23:07:29,386 - INFO - pnl: 2023-05-24T23:59:59.999 135497.02358555084 === 0.407%
2024-11-20 23:07:29,390 - DEBUG - cur time: 2023-05-25T23:59:59.999 == next bar open time: 2023-05-26T00:00:00.000 == close pos time: 2023-06-02T00:00:00.000
2024-11-20 23:07:29,398 - DEBUG - sorted_long_factors: shape: (143, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MKRUSDT      ┆ -1.697436    ┆ 0    ┆ 142          │
│ HOOKUSDT     ┆ -1.683078    ┆ 1    ┆ 141          │
│ HIGHUSDT     ┆ -1.682185    ┆ 2    ┆ 140          │
│ ATOMUSDT     ┆ -1.599595    ┆ 3    ┆ 139          │
│ AXSUSDT      ┆ -1.586848    ┆ 4    ┆ 138          │
│ CRVUSDT      ┆ -1.584986    ┆ 5    ┆ 137          │
│ MAGICUSDT    ┆ -1.507871    ┆ 6    ┆ 136          │
│ FETUSDT      ┆ -1.497898    ┆ 7    ┆ 135          │
│ RNDRUSDT     ┆ -1.478091    ┆ 8    ┆ 134          │
│ MASKUSDT     ┆ -1.434678    ┆ 9    ┆ 133          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BALUSDT      ┆ -0.041342    ┆ 133  ┆ 9            │
│ LPTUSDT      ┆ -0.03375     ┆ 134  ┆ 8            │
│ QNTUSDT      ┆ -0.000981    ┆ 135  ┆ 7            │
│ CTKUSDT      ┆ 0.006615     ┆ 136  ┆ 6            │
│ ATAUSDT      ┆ 0.078065     ┆ 137  ┆ 5            │
│ CVXUSDT      ┆ 0.081726     ┆ 138  ┆ 4            │
│ SPELLUSDT    ┆ 0.091237     ┆ 139  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.128844     ┆ 140  ┆ 2            │
│ BLZUSDT      ┆ 0.156482     ┆ 141  ┆ 1            │
│ DEFIUSDT     ┆ 0.260685     ┆ 142  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,403 - WARNING - 2023-05-25T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,403 - INFO - cur close time: 2023-05-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:29,403 - DEBUG - mean expected ret (mean factor): -0.7790034348937056
2024-11-20 23:07:29,407 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,407 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,408 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0847      ┆ null        ┆ … ┆ 0.02264 ┆ null   ┆ null    ┆ 0.2175  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,414 - DEBUG - update position: 2023-05-25T23:59:59.999 === diff_trading_value: 195979.77142187452 == cash: 134193.93752464035 
2024-11-20 23:07:29,415 - INFO - pnl: 2023-05-25T23:59:59.999 134193.93752464035 === -0.962%
2024-11-20 23:07:29,419 - DEBUG - cur time: 2023-05-26T23:59:59.999 == next bar open time: 2023-05-27T00:00:00.000 == close pos time: 2023-06-03T00:00:00.000
2024-11-20 23:07:29,420 - INFO - pnl: 2023-05-26T23:59:59.999 132641.3516391856 === -1.157%
2024-11-20 23:07:29,424 - DEBUG - cur time: 2023-05-27T23:59:59.999 == next bar open time: 2023-05-28T00:00:00.000 == close pos time: 2023-06-04T00:00:00.000
2024-11-20 23:07:29,426 - INFO - pnl: 2023-05-27T23:59:59.999 132205.8528311992 === -0.328%
2024-11-20 23:07:29,433 - DEBUG - cur time: 2023-05-28T23:59:59.999 == next bar open time: 2023-05-29T00:00:00.000 == close pos time: 2023-06-05T00:00:00.000
2024-11-20 23:07:29,436 - INFO - pnl: 2023-05-28T23:59:59.999 130652.55477157854 === -1.175%
2024-11-20 23:07:29,441 - DEBUG - cur time: 2023-05-29T23:59:59.999 == next bar open time: 2023-05-30T00:00:00.000 == close pos time: 2023-06-06T00:00:00.000
2024-11-20 23:07:29,443 - INFO - pnl: 2023-05-29T23:59:59.999 131660.94813442553 === 0.772%
2024-11-20 23:07:29,448 - DEBUG - cur time: 2023-05-30T23:59:59.999 == next bar open time: 2023-05-31T00:00:00.000 == close pos time: 2023-06-07T00:00:00.000
2024-11-20 23:07:29,450 - INFO - pnl: 2023-05-30T23:59:59.999 131509.58124887894 === -0.115%
2024-11-20 23:07:29,454 - DEBUG - cur time: 2023-05-31T23:59:59.999 == next bar open time: 2023-06-01T00:00:00.000 == close pos time: 2023-06-08T00:00:00.000
2024-11-20 23:07:29,456 - INFO - pnl: 2023-05-31T23:59:59.999 132393.23342451625 === 0.672%
2024-11-20 23:07:29,460 - DEBUG - cur time: 2023-06-01T23:59:59.999 == next bar open time: 2023-06-02T00:00:00.000 == close pos time: 2023-06-09T00:00:00.000
2024-11-20 23:07:29,468 - DEBUG - sorted_long_factors: shape: (148, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -1.85684     ┆ 0    ┆ 147          │
│ INJUSDT      ┆ -1.792241    ┆ 1    ┆ 146          │
│ FILUSDT      ┆ -1.73903     ┆ 2    ┆ 145          │
│ LITUSDT      ┆ -1.658554    ┆ 3    ┆ 144          │
│ XMRUSDT      ┆ -1.600308    ┆ 4    ┆ 143          │
│ SXPUSDT      ┆ -1.55265     ┆ 5    ┆ 142          │
│ HOOKUSDT     ┆ -1.532383    ┆ 6    ┆ 141          │
│ KSMUSDT      ┆ -1.530551    ┆ 7    ┆ 140          │
│ RNDRUSDT     ┆ -1.448175    ┆ 8    ┆ 139          │
│ CFXUSDT      ┆ -1.383907    ┆ 9    ┆ 138          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SPELLUSDT    ┆ -0.174044    ┆ 138  ┆ 9            │
│ AAVEUSDT     ┆ -0.145863    ┆ 139  ┆ 8            │
│ ZECUSDT      ┆ -0.116507    ┆ 140  ┆ 7            │
│ DARUSDT      ┆ -0.073509    ┆ 141  ┆ 6            │
│ 1000XECUSDT  ┆ -0.033508    ┆ 142  ┆ 5            │
│ RVNUSDT      ┆ -0.021258    ┆ 143  ┆ 4            │
│ BAKEUSDT     ┆ 0.004713     ┆ 144  ┆ 3            │
│ CVXUSDT      ┆ 0.622957     ┆ 145  ┆ 2            │
│ DEFIUSDT     ┆ 0.95474      ┆ 146  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.024381     ┆ 147  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,477 - INFO - cur close time: 2023-06-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:29,478 - DEBUG - mean expected ret (mean factor): -0.7809703093145604
2024-11-20 23:07:29,484 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,484 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,484 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.0846      ┆ null        ┆ … ┆ 0.02262 ┆ null   ┆ null    ┆ 0.2187  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,492 - DEBUG - update position: 2023-06-01T23:59:59.999 === diff_trading_value: 216433.42366257752 == cash: 132007.09360280936 
2024-11-20 23:07:29,493 - INFO - pnl: 2023-06-01T23:59:59.999 132007.09360280936 === -0.292%
2024-11-20 23:07:29,497 - DEBUG - cur time: 2023-06-02T23:59:59.999 == next bar open time: 2023-06-03T00:00:00.000 == close pos time: 2023-06-10T00:00:00.000
2024-11-20 23:07:29,498 - INFO - pnl: 2023-06-02T23:59:59.999 130949.21879266953 === -0.801%
2024-11-20 23:07:29,501 - DEBUG - cur time: 2023-06-03T23:59:59.999 == next bar open time: 2023-06-04T00:00:00.000 == close pos time: 2023-06-11T00:00:00.000
2024-11-20 23:07:29,503 - INFO - pnl: 2023-06-03T23:59:59.999 129770.95075233221 === -0.900%
2024-11-20 23:07:29,505 - DEBUG - cur time: 2023-06-04T23:59:59.999 == next bar open time: 2023-06-05T00:00:00.000 == close pos time: 2023-06-12T00:00:00.000
2024-11-20 23:07:29,507 - INFO - pnl: 2023-06-04T23:59:59.999 130459.35364902893 === 0.530%
2024-11-20 23:07:29,510 - DEBUG - cur time: 2023-06-05T23:59:59.999 == next bar open time: 2023-06-06T00:00:00.000 == close pos time: 2023-06-13T00:00:00.000
2024-11-20 23:07:29,511 - INFO - pnl: 2023-06-05T23:59:59.999 132055.80745146287 === 1.224%
2024-11-20 23:07:29,514 - DEBUG - cur time: 2023-06-06T23:59:59.999 == next bar open time: 2023-06-07T00:00:00.000 == close pos time: 2023-06-14T00:00:00.000
2024-11-20 23:07:29,516 - INFO - pnl: 2023-06-06T23:59:59.999 131559.69454071557 === -0.376%
2024-11-20 23:07:29,518 - DEBUG - cur time: 2023-06-07T23:59:59.999 == next bar open time: 2023-06-08T00:00:00.000 == close pos time: 2023-06-15T00:00:00.000
2024-11-20 23:07:29,519 - INFO - pnl: 2023-06-07T23:59:59.999 131646.2310401679 === 0.066%
2024-11-20 23:07:29,522 - DEBUG - cur time: 2023-06-08T23:59:59.999 == next bar open time: 2023-06-09T00:00:00.000 == close pos time: 2023-06-16T00:00:00.000
2024-11-20 23:07:29,530 - DEBUG - sorted_long_factors: shape: (152, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MKRUSDT      ┆ -2.058725    ┆ 0    ┆ 151          │
│ PHBUSDT      ┆ -1.74316     ┆ 1    ┆ 150          │
│ AGIXUSDT     ┆ -1.69808     ┆ 2    ┆ 149          │
│ BELUSDT      ┆ -1.673165    ┆ 3    ┆ 148          │
│ RNDRUSDT     ┆ -1.665049    ┆ 4    ┆ 147          │
│ NEOUSDT      ┆ -1.655395    ┆ 5    ┆ 146          │
│ SXPUSDT      ┆ -1.554554    ┆ 6    ┆ 145          │
│ LUNA2USDT    ┆ -1.524519    ┆ 7    ┆ 144          │
│ TOMOUSDT     ┆ -1.524422    ┆ 8    ┆ 143          │
│ HIGHUSDT     ┆ -1.517992    ┆ 9    ┆ 142          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ENSUSDT      ┆ -0.135848    ┆ 142  ┆ 9            │
│ SKLUSDT      ┆ -0.117633    ┆ 143  ┆ 8            │
│ ATAUSDT      ┆ -0.112888    ┆ 144  ┆ 7            │
│ CTKUSDT      ┆ -0.06513     ┆ 145  ┆ 6            │
│ 1000XECUSDT  ┆ -0.059246    ┆ 146  ┆ 5            │
│ ZENUSDT      ┆ -0.003864    ┆ 147  ┆ 4            │
│ GTCUSDT      ┆ 0.062701     ┆ 148  ┆ 3            │
│ CVXUSDT      ┆ 0.153911     ┆ 149  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.424376     ┆ 150  ┆ 1            │
│ DEFIUSDT     ┆ 1.496989     ┆ 151  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,537 - WARNING - 2023-06-08T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,537 - INFO - cur close time: 2023-06-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:29,537 - DEBUG - mean expected ret (mean factor): -0.8179904907619546
2024-11-20 23:07:29,541 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,541 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,541 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09996     ┆ null        ┆ … ┆ 0.02122 ┆ null   ┆ null    ┆ 0.2002  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,547 - DEBUG - update position: 2023-06-08T23:59:59.999 === diff_trading_value: 235120.84089464668 == cash: 132192.05822746016 
2024-11-20 23:07:29,548 - INFO - pnl: 2023-06-08T23:59:59.999 132192.05822746016 === 0.415%
2024-11-20 23:07:29,551 - DEBUG - cur time: 2023-06-09T23:59:59.999 == next bar open time: 2023-06-10T00:00:00.000 == close pos time: 2023-06-17T00:00:00.000
2024-11-20 23:07:29,554 - INFO - pnl: 2023-06-09T23:59:59.999 132627.13491787756 === 0.329%
2024-11-20 23:07:29,559 - DEBUG - cur time: 2023-06-10T23:59:59.999 == next bar open time: 2023-06-11T00:00:00.000 == close pos time: 2023-06-18T00:00:00.000
2024-11-20 23:07:29,561 - INFO - pnl: 2023-06-10T23:59:59.999 135515.1531400769 === 2.178%
2024-11-20 23:07:29,564 - DEBUG - cur time: 2023-06-11T23:59:59.999 == next bar open time: 2023-06-12T00:00:00.000 == close pos time: 2023-06-19T00:00:00.000
2024-11-20 23:07:29,566 - INFO - pnl: 2023-06-11T23:59:59.999 134897.62744357926 === -0.456%
2024-11-20 23:07:29,570 - DEBUG - cur time: 2023-06-12T23:59:59.999 == next bar open time: 2023-06-13T00:00:00.000 == close pos time: 2023-06-20T00:00:00.000
2024-11-20 23:07:29,572 - INFO - pnl: 2023-06-12T23:59:59.999 134385.3413937041 === -0.380%
2024-11-20 23:07:29,576 - DEBUG - cur time: 2023-06-13T23:59:59.999 == next bar open time: 2023-06-14T00:00:00.000 == close pos time: 2023-06-21T00:00:00.000
2024-11-20 23:07:29,579 - INFO - pnl: 2023-06-13T23:59:59.999 134377.98630059278 === -0.005%
2024-11-20 23:07:29,584 - DEBUG - cur time: 2023-06-14T23:59:59.999 == next bar open time: 2023-06-15T00:00:00.000 == close pos time: 2023-06-22T00:00:00.000
2024-11-20 23:07:29,586 - INFO - pnl: 2023-06-14T23:59:59.999 134786.28043314992 === 0.304%
2024-11-20 23:07:29,589 - DEBUG - cur time: 2023-06-15T23:59:59.999 == next bar open time: 2023-06-16T00:00:00.000 == close pos time: 2023-06-23T00:00:00.000
2024-11-20 23:07:29,595 - DEBUG - sorted_long_factors: shape: (154, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ HIGHUSDT     ┆ -2.17831     ┆ 0    ┆ 153          │
│ MTLUSDT      ┆ -1.990467    ┆ 1    ┆ 152          │
│ RNDRUSDT     ┆ -1.861441    ┆ 2    ┆ 151          │
│ DYDXUSDT     ┆ -1.796655    ┆ 3    ┆ 150          │
│ MASKUSDT     ┆ -1.69836     ┆ 4    ┆ 149          │
│ WAVESUSDT    ┆ -1.668772    ┆ 5    ┆ 148          │
│ CFXUSDT      ┆ -1.65304     ┆ 6    ┆ 147          │
│ SSVUSDT      ┆ -1.643347    ┆ 7    ┆ 146          │
│ TOMOUSDT     ┆ -1.638978    ┆ 8    ┆ 145          │
│ LDOUSDT      ┆ -1.632304    ┆ 9    ┆ 144          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ 0.032493     ┆ 144  ┆ 9            │
│ BLZUSDT      ┆ 0.04389      ┆ 145  ┆ 8            │
│ SPELLUSDT    ┆ 0.077298     ┆ 146  ┆ 7            │
│ 1000XECUSDT  ┆ 0.107419     ┆ 147  ┆ 6            │
│ FLMUSDT      ┆ 0.144148     ┆ 148  ┆ 5            │
│ DEFIUSDT     ┆ 0.214886     ┆ 149  ┆ 4            │
│ PERPUSDT     ┆ 0.290579     ┆ 150  ┆ 3            │
│ ATAUSDT      ┆ 0.357679     ┆ 151  ┆ 2            │
│ CVXUSDT      ┆ 0.454872     ┆ 152  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.508504     ┆ 153  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,601 - WARNING - 2023-06-15T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,601 - INFO - cur close time: 2023-06-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:29,601 - DEBUG - mean expected ret (mean factor): -0.8016833922716927
2024-11-20 23:07:29,605 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,605 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,605 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09318     ┆ null        ┆ … ┆ 0.01697 ┆ null   ┆ null    ┆ 0.1728  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,611 - DEBUG - update position: 2023-06-15T23:59:59.999 === diff_trading_value: 254078.8513721981 == cash: 132817.15027055965 
2024-11-20 23:07:29,612 - INFO - pnl: 2023-06-15T23:59:59.999 132817.15027055965 === -1.461%
2024-11-20 23:07:29,615 - DEBUG - cur time: 2023-06-16T23:59:59.999 == next bar open time: 2023-06-17T00:00:00.000 == close pos time: 2023-06-24T00:00:00.000
2024-11-20 23:07:29,617 - INFO - pnl: 2023-06-16T23:59:59.999 131426.08284785054 === -1.047%
2024-11-20 23:07:29,620 - DEBUG - cur time: 2023-06-17T23:59:59.999 == next bar open time: 2023-06-18T00:00:00.000 == close pos time: 2023-06-25T00:00:00.000
2024-11-20 23:07:29,622 - INFO - pnl: 2023-06-17T23:59:59.999 131668.62945185404 === 0.185%
2024-11-20 23:07:29,624 - DEBUG - cur time: 2023-06-18T23:59:59.999 == next bar open time: 2023-06-19T00:00:00.000 == close pos time: 2023-06-26T00:00:00.000
2024-11-20 23:07:29,626 - INFO - pnl: 2023-06-18T23:59:59.999 133721.1455843665 === 1.559%
2024-11-20 23:07:29,629 - DEBUG - cur time: 2023-06-19T23:59:59.999 == next bar open time: 2023-06-20T00:00:00.000 == close pos time: 2023-06-27T00:00:00.000
2024-11-20 23:07:29,630 - INFO - pnl: 2023-06-19T23:59:59.999 133963.91726724658 === 0.182%
2024-11-20 23:07:29,634 - DEBUG - cur time: 2023-06-20T23:59:59.999 == next bar open time: 2023-06-21T00:00:00.000 == close pos time: 2023-06-28T00:00:00.000
2024-11-20 23:07:29,635 - INFO - pnl: 2023-06-20T23:59:59.999 133407.43051075868 === -0.415%
2024-11-20 23:07:29,638 - DEBUG - cur time: 2023-06-21T23:59:59.999 == next bar open time: 2023-06-22T00:00:00.000 == close pos time: 2023-06-29T00:00:00.000
2024-11-20 23:07:29,639 - INFO - pnl: 2023-06-21T23:59:59.999 135165.51038855696 === 1.318%
2024-11-20 23:07:29,642 - DEBUG - cur time: 2023-06-22T23:59:59.999 == next bar open time: 2023-06-23T00:00:00.000 == close pos time: 2023-06-30T00:00:00.000
2024-11-20 23:07:29,650 - DEBUG - sorted_long_factors: shape: (157, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XRPUSDT      ┆ -2.051969    ┆ 0    ┆ 156          │
│ AGIXUSDT     ┆ -1.962643    ┆ 1    ┆ 155          │
│ FETUSDT      ┆ -1.778407    ┆ 2    ┆ 154          │
│ MASKUSDT     ┆ -1.663258    ┆ 3    ┆ 153          │
│ CFXUSDT      ┆ -1.641311    ┆ 4    ┆ 152          │
│ BTCDOMUSDT   ┆ -1.638726    ┆ 5    ┆ 151          │
│ DOTUSDT      ┆ -1.635641    ┆ 6    ┆ 150          │
│ XMRUSDT      ┆ -1.584337    ┆ 7    ┆ 149          │
│ RNDRUSDT     ┆ -1.575649    ┆ 8    ┆ 148          │
│ HOOKUSDT     ┆ -1.500622    ┆ 9    ┆ 147          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ATAUSDT      ┆ -0.130837    ┆ 147  ┆ 9            │
│ DARUSDT      ┆ -0.121749    ┆ 148  ┆ 8            │
│ GTCUSDT      ┆ -0.096491    ┆ 149  ┆ 7            │
│ WOOUSDT      ┆ -0.079138    ┆ 150  ┆ 6            │
│ 1000XECUSDT  ┆ 0.126379     ┆ 151  ┆ 5            │
│ CTKUSDT      ┆ 0.206513     ┆ 152  ┆ 4            │
│ DGBUSDT      ┆ 0.210411     ┆ 153  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.461414     ┆ 154  ┆ 2            │
│ CVXUSDT      ┆ 0.506584     ┆ 155  ┆ 1            │
│ DEFIUSDT     ┆ 1.096762     ┆ 156  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,657 - WARNING - 2023-06-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,657 - INFO - cur close time: 2023-06-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:29,657 - DEBUG - mean expected ret (mean factor): -0.8169101530102404
2024-11-20 23:07:29,662 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,662 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,663 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.09076     ┆ null        ┆ … ┆ 0.01889 ┆ null   ┆ null    ┆ 0.1915  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,670 - DEBUG - update position: 2023-06-22T23:59:59.999 === diff_trading_value: 261859.0025770072 == cash: 132604.81336769278 
2024-11-20 23:07:29,671 - INFO - pnl: 2023-06-22T23:59:59.999 132604.81336769278 === -1.894%
2024-11-20 23:07:29,677 - DEBUG - cur time: 2023-06-23T23:59:59.999 == next bar open time: 2023-06-24T00:00:00.000 == close pos time: 2023-07-01T00:00:00.000
2024-11-20 23:07:29,679 - INFO - pnl: 2023-06-23T23:59:59.999 134761.45340420763 === 1.626%
2024-11-20 23:07:29,682 - DEBUG - cur time: 2023-06-24T23:59:59.999 == next bar open time: 2023-06-25T00:00:00.000 == close pos time: 2023-07-02T00:00:00.000
2024-11-20 23:07:29,684 - INFO - pnl: 2023-06-24T23:59:59.999 138200.98574620523 === 2.552%
2024-11-20 23:07:29,688 - DEBUG - cur time: 2023-06-25T23:59:59.999 == next bar open time: 2023-06-26T00:00:00.000 == close pos time: 2023-07-03T00:00:00.000
2024-11-20 23:07:29,690 - INFO - pnl: 2023-06-25T23:59:59.999 139390.58787988365 === 0.861%
2024-11-20 23:07:29,693 - DEBUG - cur time: 2023-06-26T23:59:59.999 == next bar open time: 2023-06-27T00:00:00.000 == close pos time: 2023-07-04T00:00:00.000
2024-11-20 23:07:29,693 - INFO - pnl: 2023-06-26T23:59:59.999 138123.08105454355 === -0.909%
2024-11-20 23:07:29,696 - DEBUG - cur time: 2023-06-27T23:59:59.999 == next bar open time: 2023-06-28T00:00:00.000 == close pos time: 2023-07-05T00:00:00.000
2024-11-20 23:07:29,697 - INFO - pnl: 2023-06-27T23:59:59.999 137951.39475908864 === -0.124%
2024-11-20 23:07:29,701 - DEBUG - cur time: 2023-06-28T23:59:59.999 == next bar open time: 2023-06-29T00:00:00.000 == close pos time: 2023-07-06T00:00:00.000
2024-11-20 23:07:29,702 - INFO - pnl: 2023-06-28T23:59:59.999 136348.62397721657 === -1.162%
2024-11-20 23:07:29,705 - DEBUG - cur time: 2023-06-29T23:59:59.999 == next bar open time: 2023-06-30T00:00:00.000 == close pos time: 2023-07-07T00:00:00.000
2024-11-20 23:07:29,714 - DEBUG - sorted_long_factors: shape: (157, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT      ┆ -1.80452     ┆ 0    ┆ 156          │
│ RNDRUSDT     ┆ -1.747424    ┆ 1    ┆ 155          │
│ HIGHUSDT     ┆ -1.714889    ┆ 2    ┆ 154          │
│ MASKUSDT     ┆ -1.659367    ┆ 3    ┆ 153          │
│ AGIXUSDT     ┆ -1.626767    ┆ 4    ┆ 152          │
│ AXSUSDT      ┆ -1.583145    ┆ 5    ┆ 151          │
│ KAVAUSDT     ┆ -1.552853    ┆ 6    ┆ 150          │
│ MAGICUSDT    ┆ -1.547892    ┆ 7    ┆ 149          │
│ FILUSDT      ┆ -1.533792    ┆ 8    ┆ 148          │
│ MINAUSDT     ┆ -1.493731    ┆ 9    ┆ 147          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CKBUSDT      ┆ -0.026626    ┆ 147  ┆ 9            │
│ CVXUSDT      ┆ 0.019927     ┆ 148  ┆ 8            │
│ ZENUSDT      ┆ 0.02925      ┆ 149  ┆ 7            │
│ DGBUSDT      ┆ 0.090714     ┆ 150  ┆ 6            │
│ BTCDOMUSDT   ┆ 0.092767     ┆ 151  ┆ 5            │
│ IOTXUSDT     ┆ 0.118211     ┆ 152  ┆ 4            │
│ DARUSDT      ┆ 0.334016     ┆ 153  ┆ 3            │
│ DEFIUSDT     ┆ 0.369388     ┆ 154  ┆ 2            │
│ CTKUSDT      ┆ 0.59698      ┆ 155  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.7773       ┆ 156  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,722 - WARNING - 2023-06-29T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,722 - INFO - cur close time: 2023-06-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:29,722 - DEBUG - mean expected ret (mean factor): -0.8173305239594063
2024-11-20 23:07:29,726 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,726 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,726 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08729     ┆ null        ┆ … ┆ 0.01959 ┆ null   ┆ null    ┆ 0.2016  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,734 - DEBUG - update position: 2023-06-29T23:59:59.999 === diff_trading_value: 243830.0833569707 == cash: 136020.5504016739 
2024-11-20 23:07:29,736 - INFO - pnl: 2023-06-29T23:59:59.999 136020.5504016739 === -0.241%
2024-11-20 23:07:29,741 - DEBUG - cur time: 2023-06-30T23:59:59.999 == next bar open time: 2023-07-01T00:00:00.000 == close pos time: 2023-07-08T00:00:00.000
2024-11-20 23:07:29,742 - INFO - pnl: 2023-06-30T23:59:59.999 139153.3664934988 === 2.303%
2024-11-20 23:07:29,745 - DEBUG - cur time: 2023-07-01T23:59:59.999 == next bar open time: 2023-07-02T00:00:00.000 == close pos time: 2023-07-09T00:00:00.000
2024-11-20 23:07:29,746 - INFO - pnl: 2023-07-01T23:59:59.999 137642.34881888443 === -1.086%
2024-11-20 23:07:29,749 - DEBUG - cur time: 2023-07-02T23:59:59.999 == next bar open time: 2023-07-03T00:00:00.000 == close pos time: 2023-07-10T00:00:00.000
2024-11-20 23:07:29,750 - INFO - pnl: 2023-07-02T23:59:59.999 139407.1915618373 === 1.282%
2024-11-20 23:07:29,752 - DEBUG - cur time: 2023-07-03T23:59:59.999 == next bar open time: 2023-07-04T00:00:00.000 == close pos time: 2023-07-11T00:00:00.000
2024-11-20 23:07:29,753 - INFO - pnl: 2023-07-03T23:59:59.999 138229.48341966642 === -0.845%
2024-11-20 23:07:29,756 - DEBUG - cur time: 2023-07-04T23:59:59.999 == next bar open time: 2023-07-05T00:00:00.000 == close pos time: 2023-07-12T00:00:00.000
2024-11-20 23:07:29,757 - INFO - pnl: 2023-07-04T23:59:59.999 139605.702222905 === 0.996%
2024-11-20 23:07:29,760 - DEBUG - cur time: 2023-07-05T23:59:59.999 == next bar open time: 2023-07-06T00:00:00.000 == close pos time: 2023-07-13T00:00:00.000
2024-11-20 23:07:29,762 - INFO - pnl: 2023-07-05T23:59:59.999 139942.69929638572 === 0.241%
2024-11-20 23:07:29,765 - DEBUG - cur time: 2023-07-06T23:59:59.999 == next bar open time: 2023-07-07T00:00:00.000 == close pos time: 2023-07-14T00:00:00.000
2024-11-20 23:07:29,772 - DEBUG - sorted_long_factors: shape: (159, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WAVESUSDT    ┆ -1.99297     ┆ 0    ┆ 158          │
│ MAGICUSDT    ┆ -1.793977    ┆ 1    ┆ 157          │
│ HOOKUSDT     ┆ -1.750389    ┆ 2    ┆ 156          │
│ ARBUSDT      ┆ -1.699673    ┆ 3    ┆ 155          │
│ CFXUSDT      ┆ -1.647059    ┆ 4    ┆ 154          │
│ MKRUSDT      ┆ -1.631988    ┆ 5    ┆ 153          │
│ APTUSDT      ┆ -1.622362    ┆ 6    ┆ 152          │
│ YFIUSDT      ┆ -1.516844    ┆ 7    ┆ 151          │
│ USDCUSDT     ┆ -1.487629    ┆ 8    ┆ 150          │
│ FXSUSDT      ┆ -1.465802    ┆ 9    ┆ 149          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DARUSDT      ┆ -0.180223    ┆ 149  ┆ 9            │
│ FOOTBALLUSDT ┆ -0.171726    ┆ 150  ┆ 8            │
│ IOTXUSDT     ┆ -0.162378    ┆ 151  ┆ 7            │
│ ATAUSDT      ┆ -0.118826    ┆ 152  ┆ 6            │
│ API3USDT     ┆ 0.112292     ┆ 153  ┆ 5            │
│ INJUSDT      ┆ 0.185227     ┆ 154  ┆ 4            │
│ PERPUSDT     ┆ 0.32679      ┆ 155  ┆ 3            │
│ CTKUSDT      ┆ 0.615195     ┆ 156  ┆ 2            │
│ DEFIUSDT     ┆ 0.723909     ┆ 157  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.810016     ┆ 158  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,778 - INFO - cur close time: 2023-07-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:29,778 - DEBUG - mean expected ret (mean factor): -0.813342030731143
2024-11-20 23:07:29,782 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,782 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,782 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08013     ┆ null        ┆ … ┆ 0.02054 ┆ null   ┆ null    ┆ 0.2046  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,788 - DEBUG - update position: 2023-07-06T23:59:59.999 === diff_trading_value: 265528.9272783661 == cash: 140100.27735369332 
2024-11-20 23:07:29,790 - INFO - pnl: 2023-07-06T23:59:59.999 140100.27735369332 === 0.113%
2024-11-20 23:07:29,793 - DEBUG - cur time: 2023-07-07T23:59:59.999 == next bar open time: 2023-07-08T00:00:00.000 == close pos time: 2023-07-15T00:00:00.000
2024-11-20 23:07:29,795 - INFO - pnl: 2023-07-07T23:59:59.999 139870.64261319675 === -0.164%
2024-11-20 23:07:29,797 - DEBUG - cur time: 2023-07-08T23:59:59.999 == next bar open time: 2023-07-09T00:00:00.000 == close pos time: 2023-07-16T00:00:00.000
2024-11-20 23:07:29,798 - INFO - pnl: 2023-07-08T23:59:59.999 137677.88220904648 === -1.568%
2024-11-20 23:07:29,800 - DEBUG - cur time: 2023-07-09T23:59:59.999 == next bar open time: 2023-07-10T00:00:00.000 == close pos time: 2023-07-17T00:00:00.000
2024-11-20 23:07:29,801 - INFO - pnl: 2023-07-09T23:59:59.999 138265.52953830193 === 0.427%
2024-11-20 23:07:29,805 - DEBUG - cur time: 2023-07-10T23:59:59.999 == next bar open time: 2023-07-11T00:00:00.000 == close pos time: 2023-07-18T00:00:00.000
2024-11-20 23:07:29,806 - INFO - pnl: 2023-07-10T23:59:59.999 139346.85001564326 === 0.782%
2024-11-20 23:07:29,809 - DEBUG - cur time: 2023-07-11T23:59:59.999 == next bar open time: 2023-07-12T00:00:00.000 == close pos time: 2023-07-19T00:00:00.000
2024-11-20 23:07:29,810 - INFO - pnl: 2023-07-11T23:59:59.999 140655.2134239628 === 0.939%
2024-11-20 23:07:29,813 - DEBUG - cur time: 2023-07-12T23:59:59.999 == next bar open time: 2023-07-13T00:00:00.000 == close pos time: 2023-07-20T00:00:00.000
2024-11-20 23:07:29,815 - INFO - pnl: 2023-07-12T23:59:59.999 140326.44990329203 === -0.234%
2024-11-20 23:07:29,818 - DEBUG - cur time: 2023-07-13T23:59:59.999 == next bar open time: 2023-07-14T00:00:00.000 == close pos time: 2023-07-21T00:00:00.000
2024-11-20 23:07:29,826 - DEBUG - sorted_long_factors: shape: (163, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AAVEUSDT     ┆ -2.132358    ┆ 0    ┆ 162          │
│ MKRUSDT      ┆ -1.780806    ┆ 1    ┆ 161          │
│ STXUSDT      ┆ -1.766216    ┆ 2    ┆ 160          │
│ SSVUSDT      ┆ -1.69382     ┆ 3    ┆ 159          │
│ RNDRUSDT     ┆ -1.666656    ┆ 4    ┆ 158          │
│ APTUSDT      ┆ -1.637521    ┆ 5    ┆ 157          │
│ FILUSDT      ┆ -1.634694    ┆ 6    ┆ 156          │
│ ZENUSDT      ┆ -1.587044    ┆ 7    ┆ 155          │
│ HIGHUSDT     ┆ -1.559241    ┆ 8    ┆ 154          │
│ XMRUSDT      ┆ -1.552665    ┆ 9    ┆ 153          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BAKEUSDT     ┆ 0.141309     ┆ 153  ┆ 9            │
│ DARUSDT      ┆ 0.17954      ┆ 154  ┆ 8            │
│ REEFUSDT     ┆ 0.233912     ┆ 155  ┆ 7            │
│ CKBUSDT      ┆ 0.311838     ┆ 156  ┆ 6            │
│ IOTXUSDT     ┆ 0.388623     ┆ 157  ┆ 5            │
│ PERPUSDT     ┆ 0.424482     ┆ 158  ┆ 4            │
│ GTCUSDT      ┆ 0.466449     ┆ 159  ┆ 3            │
│ CHRUSDT      ┆ 0.5094       ┆ 160  ┆ 2            │
│ CTKUSDT      ┆ 0.629262     ┆ 161  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.813132     ┆ 162  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,833 - WARNING - 2023-07-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,833 - INFO - cur close time: 2023-07-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:29,833 - DEBUG - mean expected ret (mean factor): -0.8145391061922419
2024-11-20 23:07:29,837 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,837 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,837 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08672     ┆ null        ┆ … ┆ 0.02219 ┆ null   ┆ null    ┆ 0.2257  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,844 - DEBUG - update position: 2023-07-13T23:59:59.999 === diff_trading_value: 256900.6392885479 == cash: 143316.93341411426 
2024-11-20 23:07:29,845 - INFO - pnl: 2023-07-13T23:59:59.999 143316.93341411426 === 2.131%
2024-11-20 23:07:29,849 - DEBUG - cur time: 2023-07-14T23:59:59.999 == next bar open time: 2023-07-15T00:00:00.000 == close pos time: 2023-07-22T00:00:00.000
2024-11-20 23:07:29,851 - INFO - pnl: 2023-07-14T23:59:59.999 144080.8709909874 === 0.533%
2024-11-20 23:07:29,853 - DEBUG - cur time: 2023-07-15T23:59:59.999 == next bar open time: 2023-07-16T00:00:00.000 == close pos time: 2023-07-23T00:00:00.000
2024-11-20 23:07:29,855 - INFO - pnl: 2023-07-15T23:59:59.999 144190.16306086045 === 0.076%
2024-11-20 23:07:29,858 - DEBUG - cur time: 2023-07-16T23:59:59.999 == next bar open time: 2023-07-17T00:00:00.000 == close pos time: 2023-07-24T00:00:00.000
2024-11-20 23:07:29,859 - INFO - pnl: 2023-07-16T23:59:59.999 141950.56602581884 === -1.553%
2024-11-20 23:07:29,863 - DEBUG - cur time: 2023-07-17T23:59:59.999 == next bar open time: 2023-07-18T00:00:00.000 == close pos time: 2023-07-25T00:00:00.000
2024-11-20 23:07:29,864 - INFO - pnl: 2023-07-17T23:59:59.999 142876.3093865741 === 0.652%
2024-11-20 23:07:29,867 - DEBUG - cur time: 2023-07-18T23:59:59.999 == next bar open time: 2023-07-19T00:00:00.000 == close pos time: 2023-07-26T00:00:00.000
2024-11-20 23:07:29,868 - INFO - pnl: 2023-07-18T23:59:59.999 141655.24455826567 === -0.855%
2024-11-20 23:07:29,871 - DEBUG - cur time: 2023-07-19T23:59:59.999 == next bar open time: 2023-07-20T00:00:00.000 == close pos time: 2023-07-27T00:00:00.000
2024-11-20 23:07:29,872 - INFO - pnl: 2023-07-19T23:59:59.999 140885.0317799617 === -0.544%
2024-11-20 23:07:29,875 - DEBUG - cur time: 2023-07-20T23:59:59.999 == next bar open time: 2023-07-21T00:00:00.000 == close pos time: 2023-07-28T00:00:00.000
2024-11-20 23:07:29,882 - DEBUG - sorted_long_factors: shape: (165, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ MKRUSDT   ┆ -2.040791    ┆ 0    ┆ 164          │
│ STXUSDT   ┆ -1.970561    ┆ 1    ┆ 163          │
│ ANTUSDT   ┆ -1.772151    ┆ 2    ┆ 162          │
│ ARBUSDT   ┆ -1.69978     ┆ 3    ┆ 161          │
│ RNDRUSDT  ┆ -1.678266    ┆ 4    ┆ 160          │
│ AAVEUSDT  ┆ -1.662115    ┆ 5    ┆ 159          │
│ BNBUSDT   ┆ -1.577789    ┆ 6    ┆ 158          │
│ DYDXUSDT  ┆ -1.552498    ┆ 7    ┆ 157          │
│ FILUSDT   ┆ -1.541076    ┆ 8    ┆ 156          │
│ LQTYUSDT  ┆ -1.533404    ┆ 9    ┆ 155          │
│ …         ┆ …            ┆ …    ┆ …            │
│ LEVERUSDT ┆ 0.164494     ┆ 155  ┆ 9            │
│ SPELLUSDT ┆ 0.171293     ┆ 156  ┆ 8            │
│ CKBUSDT   ┆ 0.230432     ┆ 157  ┆ 7            │
│ CTKUSDT   ┆ 0.242995     ┆ 158  ┆ 6            │
│ IOTXUSDT  ┆ 0.332729     ┆ 159  ┆ 5            │
│ TLMUSDT   ┆ 0.335202     ┆ 160  ┆ 4            │
│ ATAUSDT   ┆ 0.341626     ┆ 161  ┆ 3            │
│ OGNUSDT   ┆ 0.349842     ┆ 162  ┆ 2            │
│ REEFUSDT  ┆ 0.354225     ┆ 163  ┆ 1            │
│ LPTUSDT   ┆ 0.642837     ┆ 164  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,888 - WARNING - 2023-07-20T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,888 - INFO - cur close time: 2023-07-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:29,888 - DEBUG - mean expected ret (mean factor): -0.8308540615802273
2024-11-20 23:07:29,893 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,893 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,894 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08583     ┆ null        ┆ … ┆ 0.02158 ┆ null   ┆ null    ┆ 0.2063  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,900 - DEBUG - update position: 2023-07-20T23:59:59.999 === diff_trading_value: 146520.79587628978 == cash: 140662.89535845348 
2024-11-20 23:07:29,901 - INFO - pnl: 2023-07-20T23:59:59.999 140662.89535845348 === -0.158%
2024-11-20 23:07:29,903 - DEBUG - cur time: 2023-07-21T23:59:59.999 == next bar open time: 2023-07-22T00:00:00.000 == close pos time: 2023-07-29T00:00:00.000
2024-11-20 23:07:29,904 - INFO - pnl: 2023-07-21T23:59:59.999 139675.36259488252 === -0.702%
2024-11-20 23:07:29,908 - DEBUG - cur time: 2023-07-22T23:59:59.999 == next bar open time: 2023-07-23T00:00:00.000 == close pos time: 2023-07-30T00:00:00.000
2024-11-20 23:07:29,908 - INFO - pnl: 2023-07-22T23:59:59.999 139255.01462673626 === -0.301%
2024-11-20 23:07:29,911 - DEBUG - cur time: 2023-07-23T23:59:59.999 == next bar open time: 2023-07-24T00:00:00.000 == close pos time: 2023-07-31T00:00:00.000
2024-11-20 23:07:29,913 - INFO - pnl: 2023-07-23T23:59:59.999 143649.5701765817 === 3.156%
2024-11-20 23:07:29,916 - DEBUG - cur time: 2023-07-24T23:59:59.999 == next bar open time: 2023-07-25T00:00:00.000 == close pos time: 2023-08-01T00:00:00.000
2024-11-20 23:07:29,918 - INFO - pnl: 2023-07-24T23:59:59.999 139900.85184481362 === -2.610%
2024-11-20 23:07:29,921 - DEBUG - cur time: 2023-07-25T23:59:59.999 == next bar open time: 2023-07-26T00:00:00.000 == close pos time: 2023-08-02T00:00:00.000
2024-11-20 23:07:29,924 - INFO - pnl: 2023-07-25T23:59:59.999 138106.309073024 === -1.283%
2024-11-20 23:07:29,927 - DEBUG - cur time: 2023-07-26T23:59:59.999 == next bar open time: 2023-07-27T00:00:00.000 == close pos time: 2023-08-03T00:00:00.000
2024-11-20 23:07:29,929 - INFO - pnl: 2023-07-26T23:59:59.999 139468.19669741005 === 0.986%
2024-11-20 23:07:29,932 - DEBUG - cur time: 2023-07-27T23:59:59.999 == next bar open time: 2023-07-28T00:00:00.000 == close pos time: 2023-08-04T00:00:00.000
2024-11-20 23:07:29,940 - DEBUG - sorted_long_factors: shape: (166, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ WAVESUSDT ┆ -1.967765    ┆ 0    ┆ 165          │
│ UNIUSDT   ┆ -1.780915    ┆ 1    ┆ 164          │
│ ARBUSDT   ┆ -1.70793     ┆ 2    ┆ 163          │
│ ICPUSDT   ┆ -1.68297     ┆ 3    ┆ 162          │
│ ZECUSDT   ┆ -1.638395    ┆ 4    ┆ 161          │
│ RNDRUSDT  ┆ -1.631117    ┆ 5    ┆ 160          │
│ BNBUSDT   ┆ -1.574164    ┆ 6    ┆ 159          │
│ DOTUSDT   ┆ -1.57095     ┆ 7    ┆ 158          │
│ LQTYUSDT  ┆ -1.568693    ┆ 8    ┆ 157          │
│ APTUSDT   ┆ -1.550352    ┆ 9    ┆ 156          │
│ …         ┆ …            ┆ …    ┆ …            │
│ LEVERUSDT ┆ 0.189578     ┆ 156  ┆ 9            │
│ HFTUSDT   ┆ 0.199985     ┆ 157  ┆ 8            │
│ BLZUSDT   ┆ 0.211464     ┆ 158  ┆ 7            │
│ TLMUSDT   ┆ 0.227358     ┆ 159  ┆ 6            │
│ RVNUSDT   ┆ 0.23691      ┆ 160  ┆ 5            │
│ SKLUSDT   ┆ 0.273325     ┆ 161  ┆ 4            │
│ GTCUSDT   ┆ 0.286517     ┆ 162  ┆ 3            │
│ CTKUSDT   ┆ 0.404972     ┆ 163  ┆ 2            │
│ CVXUSDT   ┆ 0.407068     ┆ 164  ┆ 1            │
│ PERPUSDT  ┆ 0.583208     ┆ 165  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:29,946 - WARNING - 2023-07-27T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:29,946 - INFO - cur close time: 2023-07-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:29,946 - DEBUG - mean expected ret (mean factor): -0.8041064793461368
2024-11-20 23:07:29,950 - DEBUG - begin to update pos: =========
2024-11-20 23:07:29,951 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,951 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.08058     ┆ null        ┆ … ┆ 0.02073 ┆ null   ┆ null    ┆ 0.2081  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:29,959 - DEBUG - update position: 2023-07-27T23:59:59.999 === diff_trading_value: 195735.15245694 == cash: 139469.30475219496 
2024-11-20 23:07:29,960 - INFO - pnl: 2023-07-27T23:59:59.999 139469.30475219496 === 0.001%
2024-11-20 23:07:29,964 - DEBUG - cur time: 2023-07-28T23:59:59.999 == next bar open time: 2023-07-29T00:00:00.000 == close pos time: 2023-08-05T00:00:00.000
2024-11-20 23:07:29,965 - INFO - pnl: 2023-07-28T23:59:59.999 138471.9509811114 === -0.715%
2024-11-20 23:07:29,968 - DEBUG - cur time: 2023-07-29T23:59:59.999 == next bar open time: 2023-07-30T00:00:00.000 == close pos time: 2023-08-06T00:00:00.000
2024-11-20 23:07:29,969 - INFO - pnl: 2023-07-29T23:59:59.999 138566.9446772926 === 0.069%
2024-11-20 23:07:29,973 - DEBUG - cur time: 2023-07-30T23:59:59.999 == next bar open time: 2023-07-31T00:00:00.000 == close pos time: 2023-08-07T00:00:00.000
2024-11-20 23:07:29,974 - INFO - pnl: 2023-07-30T23:59:59.999 137279.63414752999 === -0.929%
2024-11-20 23:07:29,977 - DEBUG - cur time: 2023-07-31T23:59:59.999 == next bar open time: 2023-08-01T00:00:00.000 == close pos time: 2023-08-08T00:00:00.000
2024-11-20 23:07:29,978 - INFO - pnl: 2023-07-31T23:59:59.999 137452.1416629404 === 0.126%
2024-11-20 23:07:29,981 - DEBUG - cur time: 2023-08-01T23:59:59.999 == next bar open time: 2023-08-02T00:00:00.000 == close pos time: 2023-08-09T00:00:00.000
2024-11-20 23:07:29,982 - INFO - pnl: 2023-08-01T23:59:59.999 138709.52710280355 === 0.915%
2024-11-20 23:07:29,987 - DEBUG - cur time: 2023-08-02T23:59:59.999 == next bar open time: 2023-08-03T00:00:00.000 == close pos time: 2023-08-10T00:00:00.000
2024-11-20 23:07:29,988 - INFO - pnl: 2023-08-02T23:59:59.999 138814.81831642386 === 0.076%
2024-11-20 23:07:29,992 - DEBUG - cur time: 2023-08-03T23:59:59.999 == next bar open time: 2023-08-04T00:00:00.000 == close pos time: 2023-08-11T00:00:00.000
2024-11-20 23:07:30,002 - DEBUG - sorted_long_factors: shape: (166, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT      ┆ -1.834785    ┆ 0    ┆ 165          │
│ CFXUSDT      ┆ -1.717504    ┆ 1    ┆ 164          │
│ UNIUSDT      ┆ -1.671997    ┆ 2    ┆ 163          │
│ HOOKUSDT     ┆ -1.668409    ┆ 3    ┆ 162          │
│ STXUSDT      ┆ -1.569828    ┆ 4    ┆ 161          │
│ HIGHUSDT     ┆ -1.536336    ┆ 5    ┆ 160          │
│ IDUSDT       ┆ -1.534539    ┆ 6    ┆ 159          │
│ INJUSDT      ┆ -1.510362    ┆ 7    ┆ 158          │
│ RDNTUSDT     ┆ -1.504524    ┆ 8    ┆ 157          │
│ IMXUSDT      ┆ -1.487228    ┆ 9    ┆ 156          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CRVUSDT      ┆ -0.210782    ┆ 156  ┆ 9            │
│ LITUSDT      ┆ -0.147606    ┆ 157  ┆ 8            │
│ BNXUSDT      ┆ 0.053568     ┆ 158  ┆ 7            │
│ CVXUSDT      ┆ 0.118287     ┆ 159  ┆ 6            │
│ LPTUSDT      ┆ 0.168009     ┆ 160  ┆ 5            │
│ BLZUSDT      ┆ 0.390734     ┆ 161  ┆ 4            │
│ IOTXUSDT     ┆ 0.682782     ┆ 162  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.745252     ┆ 163  ┆ 2            │
│ CTKUSDT      ┆ 1.305665     ┆ 164  ┆ 1            │
│ DEFIUSDT     ┆ 1.476411     ┆ 165  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,008 - WARNING - 2023-08-03T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:30,009 - INFO - cur close time: 2023-08-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:30,009 - DEBUG - mean expected ret (mean factor): -0.7944584259499529
2024-11-20 23:07:30,015 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,015 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,015 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.07887     ┆ null        ┆ … ┆ 0.02033 ┆ null   ┆ null    ┆ 0.2204  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,022 - DEBUG - update position: 2023-08-03T23:59:59.999 === diff_trading_value: 269627.6412374057 == cash: 138477.27393832518 
2024-11-20 23:07:30,023 - INFO - pnl: 2023-08-03T23:59:59.999 138477.27393832518 === -0.243%
2024-11-20 23:07:30,026 - DEBUG - cur time: 2023-08-04T23:59:59.999 == next bar open time: 2023-08-05T00:00:00.000 == close pos time: 2023-08-12T00:00:00.000
2024-11-20 23:07:30,028 - INFO - pnl: 2023-08-04T23:59:59.999 139275.5947405575 === 0.576%
2024-11-20 23:07:30,032 - DEBUG - cur time: 2023-08-05T23:59:59.999 == next bar open time: 2023-08-06T00:00:00.000 == close pos time: 2023-08-13T00:00:00.000
2024-11-20 23:07:30,035 - INFO - pnl: 2023-08-05T23:59:59.999 139842.6204317364 === 0.407%
2024-11-20 23:07:30,039 - DEBUG - cur time: 2023-08-06T23:59:59.999 == next bar open time: 2023-08-07T00:00:00.000 == close pos time: 2023-08-14T00:00:00.000
2024-11-20 23:07:30,041 - INFO - pnl: 2023-08-06T23:59:59.999 140423.281186156 === 0.415%
2024-11-20 23:07:30,045 - DEBUG - cur time: 2023-08-07T23:59:59.999 == next bar open time: 2023-08-08T00:00:00.000 == close pos time: 2023-08-15T00:00:00.000
2024-11-20 23:07:30,046 - INFO - pnl: 2023-08-07T23:59:59.999 140450.34072806258 === 0.019%
2024-11-20 23:07:30,049 - DEBUG - cur time: 2023-08-08T23:59:59.999 == next bar open time: 2023-08-09T00:00:00.000 == close pos time: 2023-08-16T00:00:00.000
2024-11-20 23:07:30,050 - INFO - pnl: 2023-08-08T23:59:59.999 140478.3633775778 === 0.020%
2024-11-20 23:07:30,054 - DEBUG - cur time: 2023-08-09T23:59:59.999 == next bar open time: 2023-08-10T00:00:00.000 == close pos time: 2023-08-17T00:00:00.000
2024-11-20 23:07:30,055 - INFO - pnl: 2023-08-09T23:59:59.999 140721.3213055905 === 0.173%
2024-11-20 23:07:30,057 - DEBUG - cur time: 2023-08-10T23:59:59.999 == next bar open time: 2023-08-11T00:00:00.000 == close pos time: 2023-08-18T00:00:00.000
2024-11-20 23:07:30,065 - DEBUG - sorted_long_factors: shape: (168, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SSVUSDT      ┆ -1.809748    ┆ 0    ┆ 167          │
│ UNIUSDT      ┆ -1.713587    ┆ 1    ┆ 166          │
│ APEUSDT      ┆ -1.681662    ┆ 2    ┆ 165          │
│ HIGHUSDT     ┆ -1.651334    ┆ 3    ┆ 164          │
│ MAGICUSDT    ┆ -1.632613    ┆ 4    ┆ 163          │
│ NEOUSDT      ┆ -1.598795    ┆ 5    ┆ 162          │
│ USDCUSDT     ┆ -1.566961    ┆ 6    ┆ 161          │
│ MKRUSDT      ┆ -1.551713    ┆ 7    ┆ 160          │
│ QNTUSDT      ┆ -1.471593    ┆ 8    ┆ 159          │
│ OPUSDT       ┆ -1.465617    ┆ 9    ┆ 158          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ARUSDT       ┆ -0.136167    ┆ 158  ┆ 9            │
│ BTCDOMUSDT   ┆ -0.084385    ┆ 159  ┆ 8            │
│ XVSUSDT      ┆ -0.057748    ┆ 160  ┆ 7            │
│ DEFIUSDT     ┆ -0.034161    ┆ 161  ┆ 6            │
│ SKLUSDT      ┆ 0.097242     ┆ 162  ┆ 5            │
│ CTKUSDT      ┆ 0.111015     ┆ 163  ┆ 4            │
│ KSMUSDT      ┆ 0.131448     ┆ 164  ┆ 3            │
│ BLZUSDT      ┆ 0.345657     ┆ 165  ┆ 2            │
│ IOTXUSDT     ┆ 0.549489     ┆ 166  ┆ 1            │
│ BLUEBIRDUSDT ┆ 0.683456     ┆ 167  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,070 - INFO - cur close time: 2023-08-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:30,070 - DEBUG - mean expected ret (mean factor): -0.8336254329203137
2024-11-20 23:07:30,073 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,074 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,074 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.07751     ┆ null        ┆ … ┆ 0.02003 ┆ null   ┆ null    ┆ 0.2122  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,080 - DEBUG - update position: 2023-08-10T23:59:59.999 === diff_trading_value: 273383.19030241587 == cash: 141396.10763508023 
2024-11-20 23:07:30,081 - INFO - pnl: 2023-08-10T23:59:59.999 141396.10763508023 === 0.480%
2024-11-20 23:07:30,085 - DEBUG - cur time: 2023-08-11T23:59:59.999 == next bar open time: 2023-08-12T00:00:00.000 == close pos time: 2023-08-19T00:00:00.000
2024-11-20 23:07:30,086 - INFO - pnl: 2023-08-11T23:59:59.999 141729.6378023931 === 0.236%
2024-11-20 23:07:30,089 - DEBUG - cur time: 2023-08-12T23:59:59.999 == next bar open time: 2023-08-13T00:00:00.000 == close pos time: 2023-08-20T00:00:00.000
2024-11-20 23:07:30,090 - INFO - pnl: 2023-08-12T23:59:59.999 142461.7638405634 === 0.517%
2024-11-20 23:07:30,093 - DEBUG - cur time: 2023-08-13T23:59:59.999 == next bar open time: 2023-08-14T00:00:00.000 == close pos time: 2023-08-21T00:00:00.000
2024-11-20 23:07:30,095 - INFO - pnl: 2023-08-13T23:59:59.999 146824.50885381954 === 3.062%
2024-11-20 23:07:30,099 - DEBUG - cur time: 2023-08-14T23:59:59.999 == next bar open time: 2023-08-15T00:00:00.000 == close pos time: 2023-08-22T00:00:00.000
2024-11-20 23:07:30,100 - INFO - pnl: 2023-08-14T23:59:59.999 146631.72603407918 === -0.131%
2024-11-20 23:07:30,104 - DEBUG - cur time: 2023-08-15T23:59:59.999 == next bar open time: 2023-08-16T00:00:00.000 == close pos time: 2023-08-23T00:00:00.000
2024-11-20 23:07:30,105 - INFO - pnl: 2023-08-15T23:59:59.999 145760.7715833885 === -0.594%
2024-11-20 23:07:30,109 - DEBUG - cur time: 2023-08-16T23:59:59.999 == next bar open time: 2023-08-17T00:00:00.000 == close pos time: 2023-08-24T00:00:00.000
2024-11-20 23:07:30,110 - INFO - pnl: 2023-08-16T23:59:59.999 148280.7065149352 === 1.729%
2024-11-20 23:07:30,113 - DEBUG - cur time: 2023-08-17T23:59:59.999 == next bar open time: 2023-08-18T00:00:00.000 == close pos time: 2023-08-25T00:00:00.000
2024-11-20 23:07:30,120 - DEBUG - sorted_long_factors: shape: (172, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ LEVERUSDT     ┆ -1.852966    ┆ 0    ┆ 171          │
│ UNFIUSDT      ┆ -1.694667    ┆ 1    ┆ 170          │
│ PHBUSDT       ┆ -1.570203    ┆ 2    ┆ 169          │
│ USDCUSDT      ┆ -1.562008    ┆ 3    ┆ 168          │
│ HIGHUSDT      ┆ -1.491723    ┆ 4    ┆ 167          │
│ 1000PEPEUSDT  ┆ -1.443756    ┆ 5    ┆ 166          │
│ 1000FLOKIUSDT ┆ -1.429471    ┆ 6    ┆ 165          │
│ ASTRUSDT      ┆ -1.413661    ┆ 7    ┆ 164          │
│ RUNEUSDT      ┆ -1.399522    ┆ 8    ┆ 163          │
│ STXUSDT       ┆ -1.397014    ┆ 9    ┆ 162          │
│ …             ┆ …            ┆ …    ┆ …            │
│ XVSUSDT       ┆ -0.116642    ┆ 162  ┆ 9            │
│ ZENUSDT       ┆ -0.104637    ┆ 163  ┆ 8            │
│ IOTXUSDT      ┆ -0.094412    ┆ 164  ┆ 7            │
│ CTKUSDT       ┆ -0.091644    ┆ 165  ┆ 6            │
│ IDEXUSDT      ┆ -0.076792    ┆ 166  ┆ 5            │
│ ENSUSDT       ┆ 0.021676     ┆ 167  ┆ 4            │
│ DASHUSDT      ┆ 0.030292     ┆ 168  ┆ 3            │
│ ARUSDT        ┆ 0.098802     ┆ 169  ┆ 2            │
│ BLUEBIRDUSDT  ┆ 0.775681     ┆ 170  ┆ 1            │
│ DEFIUSDT      ┆ 1.083385     ┆ 171  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,127 - WARNING - 2023-08-17T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:30,127 - INFO - cur close time: 2023-08-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:30,127 - DEBUG - mean expected ret (mean factor): -0.8217533303927032
2024-11-20 23:07:30,132 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,132 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,132 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01807     ┆ 0.06175     ┆ 0.0010795   ┆ … ┆ 0.01627 ┆ null   ┆ null    ┆ 0.172   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,140 - DEBUG - update position: 2023-08-17T23:59:59.999 === diff_trading_value: 271490.42917869514 == cash: 145298.9737570618 
2024-11-20 23:07:30,143 - INFO - pnl: 2023-08-17T23:59:59.999 145298.9737570618 === -2.011%
2024-11-20 23:07:30,146 - DEBUG - cur time: 2023-08-18T23:59:59.999 == next bar open time: 2023-08-19T00:00:00.000 == close pos time: 2023-08-26T00:00:00.000
2024-11-20 23:07:30,148 - INFO - pnl: 2023-08-18T23:59:59.999 141079.92709335178 === -2.904%
2024-11-20 23:07:30,151 - DEBUG - cur time: 2023-08-19T23:59:59.999 == next bar open time: 2023-08-20T00:00:00.000 == close pos time: 2023-08-27T00:00:00.000
2024-11-20 23:07:30,152 - INFO - pnl: 2023-08-19T23:59:59.999 139763.13502441777 === -0.933%
2024-11-20 23:07:30,156 - DEBUG - cur time: 2023-08-20T23:59:59.999 == next bar open time: 2023-08-21T00:00:00.000 == close pos time: 2023-08-28T00:00:00.000
2024-11-20 23:07:30,157 - INFO - pnl: 2023-08-20T23:59:59.999 139924.5047169225 === 0.115%
2024-11-20 23:07:30,160 - DEBUG - cur time: 2023-08-21T23:59:59.999 == next bar open time: 2023-08-22T00:00:00.000 == close pos time: 2023-08-29T00:00:00.000
2024-11-20 23:07:30,162 - INFO - pnl: 2023-08-21T23:59:59.999 138128.52442113563 === -1.284%
2024-11-20 23:07:30,164 - DEBUG - cur time: 2023-08-22T23:59:59.999 == next bar open time: 2023-08-23T00:00:00.000 == close pos time: 2023-08-30T00:00:00.000
2024-11-20 23:07:30,166 - INFO - pnl: 2023-08-22T23:59:59.999 136853.3284351686 === -0.923%
2024-11-20 23:07:30,169 - DEBUG - cur time: 2023-08-23T23:59:59.999 == next bar open time: 2023-08-24T00:00:00.000 == close pos time: 2023-08-31T00:00:00.000
2024-11-20 23:07:30,171 - INFO - pnl: 2023-08-23T23:59:59.999 135246.2199322198 === -1.174%
2024-11-20 23:07:30,173 - DEBUG - cur time: 2023-08-24T23:59:59.999 == next bar open time: 2023-08-25T00:00:00.000 == close pos time: 2023-09-01T00:00:00.000
2024-11-20 23:07:30,180 - DEBUG - sorted_long_factors: shape: (174, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT   ┆ -1.945247    ┆ 0    ┆ 173          │
│ UNFIUSDT     ┆ -1.820607    ┆ 1    ┆ 172          │
│ GTCUSDT      ┆ -1.774876    ┆ 2    ┆ 171          │
│ USDCUSDT     ┆ -1.738247    ┆ 3    ┆ 170          │
│ HIGHUSDT     ┆ -1.715297    ┆ 4    ┆ 169          │
│ LEVERUSDT    ┆ -1.700969    ┆ 5    ┆ 168          │
│ GMXUSDT      ┆ -1.648813    ┆ 6    ┆ 167          │
│ KNCUSDT      ┆ -1.625597    ┆ 7    ┆ 166          │
│ RDNTUSDT     ┆ -1.413114    ┆ 8    ┆ 165          │
│ ARBUSDT      ┆ -1.39968     ┆ 9    ┆ 164          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DGBUSDT      ┆ -0.155629    ┆ 164  ┆ 9            │
│ IOTXUSDT     ┆ -0.137652    ┆ 165  ┆ 8            │
│ TUSDT        ┆ -0.088181    ┆ 166  ┆ 7            │
│ CKBUSDT      ┆ 0.06641      ┆ 167  ┆ 6            │
│ SPELLUSDT    ┆ 0.224279     ┆ 168  ┆ 5            │
│ BALUSDT      ┆ 0.258388     ┆ 169  ┆ 4            │
│ BLUEBIRDUSDT ┆ 0.276429     ┆ 170  ┆ 3            │
│ IDEXUSDT     ┆ 0.512837     ┆ 171  ┆ 2            │
│ DEFIUSDT     ┆ 0.671636     ┆ 172  ┆ 1            │
│ CTKUSDT      ┆ 0.736857     ┆ 173  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,186 - WARNING - 2023-08-24T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:30,186 - INFO - cur close time: 2023-08-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:30,186 - DEBUG - mean expected ret (mean factor): -0.8353243227954159
2024-11-20 23:07:30,190 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,190 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,190 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.018       ┆ 0.06363     ┆ 0.0009416   ┆ … ┆ 0.0167  ┆ null   ┆ null    ┆ 0.1735  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,195 - DEBUG - update position: 2023-08-24T23:59:59.999 === diff_trading_value: 263246.1974603223 == cash: 135096.88967814558 
2024-11-20 23:07:30,197 - INFO - pnl: 2023-08-24T23:59:59.999 135096.88967814558 === -0.110%
2024-11-20 23:07:30,200 - DEBUG - cur time: 2023-08-25T23:59:59.999 == next bar open time: 2023-08-26T00:00:00.000 == close pos time: 2023-09-02T00:00:00.000
2024-11-20 23:07:30,201 - INFO - pnl: 2023-08-25T23:59:59.999 137253.91220273296 === 1.597%
2024-11-20 23:07:30,205 - DEBUG - cur time: 2023-08-26T23:59:59.999 == next bar open time: 2023-08-27T00:00:00.000 == close pos time: 2023-09-03T00:00:00.000
2024-11-20 23:07:30,206 - INFO - pnl: 2023-08-26T23:59:59.999 135560.77566103378 === -1.234%
2024-11-20 23:07:30,209 - DEBUG - cur time: 2023-08-27T23:59:59.999 == next bar open time: 2023-08-28T00:00:00.000 == close pos time: 2023-09-04T00:00:00.000
2024-11-20 23:07:30,210 - INFO - pnl: 2023-08-27T23:59:59.999 136481.63076549923 === 0.679%
2024-11-20 23:07:30,214 - DEBUG - cur time: 2023-08-28T23:59:59.999 == next bar open time: 2023-08-29T00:00:00.000 == close pos time: 2023-09-05T00:00:00.000
2024-11-20 23:07:30,216 - INFO - pnl: 2023-08-28T23:59:59.999 135377.53556993045 === -0.809%
2024-11-20 23:07:30,219 - DEBUG - cur time: 2023-08-29T23:59:59.999 == next bar open time: 2023-08-30T00:00:00.000 == close pos time: 2023-09-06T00:00:00.000
2024-11-20 23:07:30,221 - INFO - pnl: 2023-08-29T23:59:59.999 136634.05529084706 === 0.928%
2024-11-20 23:07:30,223 - DEBUG - cur time: 2023-08-30T23:59:59.999 == next bar open time: 2023-08-31T00:00:00.000 == close pos time: 2023-09-07T00:00:00.000
2024-11-20 23:07:30,224 - INFO - pnl: 2023-08-30T23:59:59.999 133935.19320958626 === -1.975%
2024-11-20 23:07:30,227 - DEBUG - cur time: 2023-08-31T23:59:59.999 == next bar open time: 2023-09-01T00:00:00.000 == close pos time: 2023-09-08T00:00:00.000
2024-11-20 23:07:30,236 - DEBUG - sorted_long_factors: shape: (174, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ USDCUSDT     ┆ -2.004137    ┆ 0    ┆ 173          │
│ MKRUSDT      ┆ -1.923776    ┆ 1    ┆ 172          │
│ LEVERUSDT    ┆ -1.682104    ┆ 2    ┆ 171          │
│ DOTUSDT      ┆ -1.612023    ┆ 3    ┆ 170          │
│ 1000PEPEUSDT ┆ -1.58523     ┆ 4    ┆ 169          │
│ EOSUSDT      ┆ -1.519324    ┆ 5    ┆ 168          │
│ BLURUSDT     ┆ -1.512662    ┆ 6    ┆ 167          │
│ ARBUSDT      ┆ -1.500049    ┆ 7    ┆ 166          │
│ SUIUSDT      ┆ -1.499981    ┆ 8    ┆ 165          │
│ AGIXUSDT     ┆ -1.488001    ┆ 9    ┆ 164          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BALUSDT      ┆ 0.038083     ┆ 164  ┆ 9            │
│ ICXUSDT      ┆ 0.04551      ┆ 165  ┆ 8            │
│ BNXUSDT      ┆ 0.075665     ┆ 166  ┆ 7            │
│ CTKUSDT      ┆ 0.109593     ┆ 167  ┆ 6            │
│ RLCUSDT      ┆ 0.125327     ┆ 168  ┆ 5            │
│ SPELLUSDT    ┆ 0.201267     ┆ 169  ┆ 4            │
│ DEFIUSDT     ┆ 0.410583     ┆ 170  ┆ 3            │
│ CKBUSDT      ┆ 0.515417     ┆ 171  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.54763      ┆ 172  ┆ 1            │
│ TUSDT        ┆ 0.568353     ┆ 173  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,241 - WARNING - 2023-08-31T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:30,241 - INFO - cur close time: 2023-08-31T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:30,242 - DEBUG - mean expected ret (mean factor): -0.8112160516214986
2024-11-20 23:07:30,245 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,245 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,246 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01742     ┆ 0.06186     ┆ 0.0008033   ┆ … ┆ 0.01615 ┆ null   ┆ null    ┆ 0.165   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,252 - DEBUG - update position: 2023-08-31T23:59:59.999 === diff_trading_value: 216557.15432335297 == cash: 133552.7779663235 
2024-11-20 23:07:30,253 - INFO - pnl: 2023-08-31T23:59:59.999 133552.7779663235 === -0.286%
2024-11-20 23:07:30,256 - DEBUG - cur time: 2023-09-01T23:59:59.999 == next bar open time: 2023-09-02T00:00:00.000 == close pos time: 2023-09-09T00:00:00.000
2024-11-20 23:07:30,257 - INFO - pnl: 2023-09-01T23:59:59.999 134394.6367254873 === 0.630%
2024-11-20 23:07:30,260 - DEBUG - cur time: 2023-09-02T23:59:59.999 == next bar open time: 2023-09-03T00:00:00.000 == close pos time: 2023-09-10T00:00:00.000
2024-11-20 23:07:30,261 - INFO - pnl: 2023-09-02T23:59:59.999 136537.74616358758 === 1.595%
2024-11-20 23:07:30,265 - DEBUG - cur time: 2023-09-03T23:59:59.999 == next bar open time: 2023-09-04T00:00:00.000 == close pos time: 2023-09-11T00:00:00.000
2024-11-20 23:07:30,266 - INFO - pnl: 2023-09-03T23:59:59.999 135915.41003453394 === -0.456%
2024-11-20 23:07:30,268 - DEBUG - cur time: 2023-09-04T23:59:59.999 == next bar open time: 2023-09-05T00:00:00.000 == close pos time: 2023-09-12T00:00:00.000
2024-11-20 23:07:30,269 - INFO - pnl: 2023-09-04T23:59:59.999 135700.54201506724 === -0.158%
2024-11-20 23:07:30,271 - DEBUG - cur time: 2023-09-05T23:59:59.999 == next bar open time: 2023-09-06T00:00:00.000 == close pos time: 2023-09-13T00:00:00.000
2024-11-20 23:07:30,273 - INFO - pnl: 2023-09-05T23:59:59.999 136313.52864465877 === 0.452%
2024-11-20 23:07:30,276 - DEBUG - cur time: 2023-09-06T23:59:59.999 == next bar open time: 2023-09-07T00:00:00.000 == close pos time: 2023-09-14T00:00:00.000
2024-11-20 23:07:30,277 - INFO - pnl: 2023-09-06T23:59:59.999 137571.7617702857 === 0.923%
2024-11-20 23:07:30,281 - DEBUG - cur time: 2023-09-07T23:59:59.999 == next bar open time: 2023-09-08T00:00:00.000 == close pos time: 2023-09-15T00:00:00.000
2024-11-20 23:07:30,288 - DEBUG - sorted_long_factors: shape: (175, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ DOTUSDT      ┆ -1.874177    ┆ 0    ┆ 174          │
│ SUIUSDT      ┆ -1.861224    ┆ 1    ┆ 173          │
│ ARBUSDT      ┆ -1.856418    ┆ 2    ┆ 172          │
│ DYDXUSDT     ┆ -1.740248    ┆ 3    ┆ 171          │
│ AAVEUSDT     ┆ -1.688579    ┆ 4    ┆ 170          │
│ ATOMUSDT     ┆ -1.669278    ┆ 5    ┆ 169          │
│ APTUSDT      ┆ -1.653105    ┆ 6    ┆ 168          │
│ BNBUSDT      ┆ -1.640834    ┆ 7    ┆ 167          │
│ EGLDUSDT     ┆ -1.627581    ┆ 8    ┆ 166          │
│ RADUSDT      ┆ -1.626926    ┆ 9    ┆ 165          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CVXUSDT      ┆ 0.13759      ┆ 165  ┆ 9            │
│ TUSDT        ┆ 0.200799     ┆ 166  ┆ 8            │
│ DGBUSDT      ┆ 0.256982     ┆ 167  ┆ 7            │
│ CELRUSDT     ┆ 0.259765     ┆ 168  ┆ 6            │
│ ICXUSDT      ┆ 0.282432     ┆ 169  ┆ 5            │
│ DENTUSDT     ┆ 0.381991     ┆ 170  ┆ 4            │
│ SPELLUSDT    ┆ 0.426803     ┆ 171  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.600358     ┆ 172  ┆ 2            │
│ DEFIUSDT     ┆ 0.606913     ┆ 173  ┆ 1            │
│ CKBUSDT      ┆ 0.658885     ┆ 174  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,293 - WARNING - 2023-09-07T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:30,294 - INFO - cur close time: 2023-09-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:30,294 - DEBUG - mean expected ret (mean factor): -0.7997085021361863
2024-11-20 23:07:30,299 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,299 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,299 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01719     ┆ 0.06095     ┆ 0.0008083   ┆ … ┆ 0.0166  ┆ null   ┆ null    ┆ 0.1705  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,305 - DEBUG - update position: 2023-09-07T23:59:59.999 === diff_trading_value: 250370.452464207 == cash: 140371.89261563995 
2024-11-20 23:07:30,306 - INFO - pnl: 2023-09-07T23:59:59.999 140371.89261563995 === 2.035%
2024-11-20 23:07:30,310 - DEBUG - cur time: 2023-09-08T23:59:59.999 == next bar open time: 2023-09-09T00:00:00.000 == close pos time: 2023-09-16T00:00:00.000
2024-11-20 23:07:30,311 - INFO - pnl: 2023-09-08T23:59:59.999 141712.07264617173 === 0.955%
2024-11-20 23:07:30,317 - DEBUG - cur time: 2023-09-09T23:59:59.999 == next bar open time: 2023-09-10T00:00:00.000 == close pos time: 2023-09-17T00:00:00.000
2024-11-20 23:07:30,318 - INFO - pnl: 2023-09-09T23:59:59.999 142255.48671514718 === 0.383%
2024-11-20 23:07:30,322 - DEBUG - cur time: 2023-09-10T23:59:59.999 == next bar open time: 2023-09-11T00:00:00.000 == close pos time: 2023-09-18T00:00:00.000
2024-11-20 23:07:30,323 - INFO - pnl: 2023-09-10T23:59:59.999 142257.76761767795 === 0.002%
2024-11-20 23:07:30,327 - DEBUG - cur time: 2023-09-11T23:59:59.999 == next bar open time: 2023-09-12T00:00:00.000 == close pos time: 2023-09-19T00:00:00.000
2024-11-20 23:07:30,329 - INFO - pnl: 2023-09-11T23:59:59.999 142878.98081136338 === 0.437%
2024-11-20 23:07:30,333 - DEBUG - cur time: 2023-09-12T23:59:59.999 == next bar open time: 2023-09-13T00:00:00.000 == close pos time: 2023-09-20T00:00:00.000
2024-11-20 23:07:30,334 - INFO - pnl: 2023-09-12T23:59:59.999 143310.66530869843 === 0.302%
2024-11-20 23:07:30,339 - DEBUG - cur time: 2023-09-13T23:59:59.999 == next bar open time: 2023-09-14T00:00:00.000 == close pos time: 2023-09-21T00:00:00.000
2024-11-20 23:07:30,342 - INFO - pnl: 2023-09-13T23:59:59.999 144142.62672223532 === 0.581%
2024-11-20 23:07:30,346 - DEBUG - cur time: 2023-09-14T23:59:59.999 == next bar open time: 2023-09-15T00:00:00.000 == close pos time: 2023-09-22T00:00:00.000
2024-11-20 23:07:30,359 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ UNFIUSDT     ┆ -1.769728    ┆ 0    ┆ 175          │
│ WAVESUSDT    ┆ -1.74267     ┆ 1    ┆ 174          │
│ EDUUSDT      ┆ -1.714337    ┆ 2    ┆ 173          │
│ IDUSDT       ┆ -1.696407    ┆ 3    ┆ 172          │
│ UMAUSDT      ┆ -1.608657    ┆ 4    ┆ 171          │
│ 1000PEPEUSDT ┆ -1.598645    ┆ 5    ┆ 170          │
│ XVSUSDT      ┆ -1.542066    ┆ 6    ┆ 169          │
│ ARBUSDT      ┆ -1.482482    ┆ 7    ┆ 168          │
│ SUIUSDT      ┆ -1.480068    ┆ 8    ┆ 167          │
│ USDCUSDT     ┆ -1.450894    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ QNTUSDT      ┆ -0.185137    ┆ 166  ┆ 9            │
│ BALUSDT      ┆ -0.047269    ┆ 167  ┆ 8            │
│ CKBUSDT      ┆ -0.0185      ┆ 168  ┆ 7            │
│ TUSDT        ┆ 0.012089     ┆ 169  ┆ 6            │
│ ICXUSDT      ┆ 0.194453     ┆ 170  ┆ 5            │
│ CVXUSDT      ┆ 0.204125     ┆ 171  ┆ 4            │
│ RVNUSDT      ┆ 0.264558     ┆ 172  ┆ 3            │
│ DGBUSDT      ┆ 0.65264      ┆ 173  ┆ 2            │
│ DEFIUSDT     ┆ 1.077746     ┆ 174  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.548994     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,365 - WARNING - 2023-09-14T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:30,366 - INFO - cur close time: 2023-09-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:30,366 - DEBUG - mean expected ret (mean factor): -0.8011724237964774
2024-11-20 23:07:30,370 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,370 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,371 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01592     ┆ 0.05788     ┆ 0.0006829   ┆ … ┆ 0.01615 ┆ null   ┆ null    ┆ 0.1782  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,378 - DEBUG - update position: 2023-09-14T23:59:59.999 === diff_trading_value: 249981.74822844737 == cash: 144178.60945145137 
2024-11-20 23:07:30,379 - INFO - pnl: 2023-09-14T23:59:59.999 144178.60945145137 === 0.025%
2024-11-20 23:07:30,384 - DEBUG - cur time: 2023-09-15T23:59:59.999 == next bar open time: 2023-09-16T00:00:00.000 == close pos time: 2023-09-23T00:00:00.000
2024-11-20 23:07:30,385 - INFO - pnl: 2023-09-15T23:59:59.999 147052.08202500563 === 1.993%
2024-11-20 23:07:30,388 - DEBUG - cur time: 2023-09-16T23:59:59.999 == next bar open time: 2023-09-17T00:00:00.000 == close pos time: 2023-09-24T00:00:00.000
2024-11-20 23:07:30,389 - INFO - pnl: 2023-09-16T23:59:59.999 146200.34541597494 === -0.579%
2024-11-20 23:07:30,392 - DEBUG - cur time: 2023-09-17T23:59:59.999 == next bar open time: 2023-09-18T00:00:00.000 == close pos time: 2023-09-25T00:00:00.000
2024-11-20 23:07:30,392 - INFO - pnl: 2023-09-17T23:59:59.999 147313.9020599739 === 0.762%
2024-11-20 23:07:30,395 - DEBUG - cur time: 2023-09-18T23:59:59.999 == next bar open time: 2023-09-19T00:00:00.000 == close pos time: 2023-09-26T00:00:00.000
2024-11-20 23:07:30,396 - INFO - pnl: 2023-09-18T23:59:59.999 147531.28613010093 === 0.148%
2024-11-20 23:07:30,399 - DEBUG - cur time: 2023-09-19T23:59:59.999 == next bar open time: 2023-09-20T00:00:00.000 == close pos time: 2023-09-27T00:00:00.000
2024-11-20 23:07:30,400 - INFO - pnl: 2023-09-19T23:59:59.999 147197.26773069764 === -0.226%
2024-11-20 23:07:30,404 - DEBUG - cur time: 2023-09-20T23:59:59.999 == next bar open time: 2023-09-21T00:00:00.000 == close pos time: 2023-09-28T00:00:00.000
2024-11-20 23:07:30,405 - INFO - pnl: 2023-09-20T23:59:59.999 147205.83818458178 === 0.006%
2024-11-20 23:07:30,407 - DEBUG - cur time: 2023-09-21T23:59:59.999 == next bar open time: 2023-09-22T00:00:00.000 == close pos time: 2023-09-29T00:00:00.000
2024-11-20 23:07:30,417 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ RADUSDT      ┆ -1.820348    ┆ 0    ┆ 175          │
│ XVSUSDT      ┆ -1.75879     ┆ 1    ┆ 174          │
│ MASKUSDT     ┆ -1.720996    ┆ 2    ┆ 173          │
│ 1000PEPEUSDT ┆ -1.632794    ┆ 3    ┆ 172          │
│ STGUSDT      ┆ -1.60843     ┆ 4    ┆ 171          │
│ IDUSDT       ┆ -1.562594    ┆ 5    ┆ 170          │
│ BLURUSDT     ┆ -1.556952    ┆ 6    ┆ 169          │
│ FOOTBALLUSDT ┆ -1.556542    ┆ 7    ┆ 168          │
│ RDNTUSDT     ┆ -1.551491    ┆ 8    ┆ 167          │
│ LPTUSDT      ┆ -1.545472    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ SUSHIUSDT    ┆ -0.029382    ┆ 166  ┆ 9            │
│ BATUSDT      ┆ -0.013978    ┆ 167  ┆ 8            │
│ ZECUSDT      ┆ 0.0172       ┆ 168  ┆ 7            │
│ KSMUSDT      ┆ 0.028892     ┆ 169  ┆ 6            │
│ CVXUSDT      ┆ 0.028928     ┆ 170  ┆ 5            │
│ YFIUSDT      ┆ 0.037761     ┆ 171  ┆ 4            │
│ CKBUSDT      ┆ 0.251115     ┆ 172  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.638897     ┆ 173  ┆ 2            │
│ DGBUSDT      ┆ 0.644425     ┆ 174  ┆ 1            │
│ DEFIUSDT     ┆ 1.866754     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,423 - INFO - cur close time: 2023-09-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:30,424 - DEBUG - mean expected ret (mean factor): -0.789135412452897
2024-11-20 23:07:30,427 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,428 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,428 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01543     ┆ 0.05983     ┆ 0.0006114   ┆ … ┆ 0.0169  ┆ null   ┆ null    ┆ 0.1839  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,435 - DEBUG - update position: 2023-09-21T23:59:59.999 === diff_trading_value: 224224.14092895604 == cash: 146569.37994648915 
2024-11-20 23:07:30,436 - INFO - pnl: 2023-09-21T23:59:59.999 146569.37994648915 === -0.432%
2024-11-20 23:07:30,439 - DEBUG - cur time: 2023-09-22T23:59:59.999 == next bar open time: 2023-09-23T00:00:00.000 == close pos time: 2023-09-30T00:00:00.000
2024-11-20 23:07:30,440 - INFO - pnl: 2023-09-22T23:59:59.999 145157.9726879232 === -0.963%
2024-11-20 23:07:30,445 - DEBUG - cur time: 2023-09-23T23:59:59.999 == next bar open time: 2023-09-24T00:00:00.000 == close pos time: 2023-10-01T00:00:00.000
2024-11-20 23:07:30,447 - INFO - pnl: 2023-09-23T23:59:59.999 146745.62775402865 === 1.094%
2024-11-20 23:07:30,452 - DEBUG - cur time: 2023-09-24T23:59:59.999 == next bar open time: 2023-09-25T00:00:00.000 == close pos time: 2023-10-02T00:00:00.000
2024-11-20 23:07:30,453 - INFO - pnl: 2023-09-24T23:59:59.999 147502.01652393522 === 0.515%
2024-11-20 23:07:30,456 - DEBUG - cur time: 2023-09-25T23:59:59.999 == next bar open time: 2023-09-26T00:00:00.000 == close pos time: 2023-10-03T00:00:00.000
2024-11-20 23:07:30,457 - INFO - pnl: 2023-09-25T23:59:59.999 147460.4596045337 === -0.028%
2024-11-20 23:07:30,460 - DEBUG - cur time: 2023-09-26T23:59:59.999 == next bar open time: 2023-09-27T00:00:00.000 == close pos time: 2023-10-04T00:00:00.000
2024-11-20 23:07:30,461 - INFO - pnl: 2023-09-26T23:59:59.999 148164.53506255377 === 0.477%
2024-11-20 23:07:30,465 - DEBUG - cur time: 2023-09-27T23:59:59.999 == next bar open time: 2023-09-28T00:00:00.000 == close pos time: 2023-10-05T00:00:00.000
2024-11-20 23:07:30,467 - INFO - pnl: 2023-09-27T23:59:59.999 148164.90597270188 === 0.000%
2024-11-20 23:07:30,470 - DEBUG - cur time: 2023-09-28T23:59:59.999 == next bar open time: 2023-09-29T00:00:00.000 == close pos time: 2023-10-06T00:00:00.000
2024-11-20 23:07:30,481 - DEBUG - sorted_long_factors: shape: (176, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XVSUSDT      ┆ -1.91659     ┆ 0    ┆ 175          │
│ FILUSDT      ┆ -1.891929    ┆ 1    ┆ 174          │
│ MKRUSDT      ┆ -1.864868    ┆ 2    ┆ 173          │
│ SUIUSDT      ┆ -1.848981    ┆ 3    ┆ 172          │
│ AXSUSDT      ┆ -1.713532    ┆ 4    ┆ 171          │
│ ARBUSDT      ┆ -1.642817    ┆ 5    ┆ 170          │
│ APTUSDT      ┆ -1.623861    ┆ 6    ┆ 169          │
│ FLOWUSDT     ┆ -1.612375    ┆ 7    ┆ 168          │
│ TOMOUSDT     ┆ -1.587827    ┆ 8    ┆ 167          │
│ BNBUSDT      ┆ -1.580788    ┆ 9    ┆ 166          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IOTXUSDT     ┆ 0.115949     ┆ 166  ┆ 9            │
│ RSRUSDT      ┆ 0.144016     ┆ 167  ┆ 8            │
│ TLMUSDT      ┆ 0.167306     ┆ 168  ┆ 7            │
│ TUSDT        ┆ 0.182197     ┆ 169  ┆ 6            │
│ BNXUSDT      ┆ 0.201215     ┆ 170  ┆ 5            │
│ ALICEUSDT    ┆ 0.322255     ┆ 171  ┆ 4            │
│ DENTUSDT     ┆ 0.325843     ┆ 172  ┆ 3            │
│ CKBUSDT      ┆ 0.50898      ┆ 173  ┆ 2            │
│ DGBUSDT      ┆ 0.855302     ┆ 174  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.383604     ┆ 175  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,489 - WARNING - 2023-09-28T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:30,490 - INFO - cur close time: 2023-09-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:30,490 - DEBUG - mean expected ret (mean factor): -0.785445383820731
2024-11-20 23:07:30,494 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,494 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,494 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.016       ┆ 0.06487     ┆ 0.0007335   ┆ … ┆ 0.01704 ┆ null   ┆ null    ┆ 0.1945  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,501 - DEBUG - update position: 2023-09-28T23:59:59.999 === diff_trading_value: 277405.28289641044 == cash: 148047.73886124004 
2024-11-20 23:07:30,503 - INFO - pnl: 2023-09-28T23:59:59.999 148047.73886124004 === -0.079%
2024-11-20 23:07:30,506 - DEBUG - cur time: 2023-09-29T23:59:59.999 == next bar open time: 2023-09-30T00:00:00.000 == close pos time: 2023-10-07T00:00:00.000
2024-11-20 23:07:30,507 - INFO - pnl: 2023-09-29T23:59:59.999 147434.04302396838 === -0.415%
2024-11-20 23:07:30,509 - DEBUG - cur time: 2023-09-30T23:59:59.999 == next bar open time: 2023-10-01T00:00:00.000 == close pos time: 2023-10-08T00:00:00.000
2024-11-20 23:07:30,510 - INFO - pnl: 2023-09-30T23:59:59.999 147278.5887626104 === -0.105%
2024-11-20 23:07:30,513 - DEBUG - cur time: 2023-10-01T23:59:59.999 == next bar open time: 2023-10-02T00:00:00.000 == close pos time: 2023-10-09T00:00:00.000
2024-11-20 23:07:30,514 - INFO - pnl: 2023-10-01T23:59:59.999 148601.25951296187 === 0.898%
2024-11-20 23:07:30,517 - DEBUG - cur time: 2023-10-02T23:59:59.999 == next bar open time: 2023-10-03T00:00:00.000 == close pos time: 2023-10-10T00:00:00.000
2024-11-20 23:07:30,518 - INFO - pnl: 2023-10-02T23:59:59.999 146685.67349747772 === -1.289%
2024-11-20 23:07:30,521 - DEBUG - cur time: 2023-10-03T23:59:59.999 == next bar open time: 2023-10-04T00:00:00.000 == close pos time: 2023-10-11T00:00:00.000
2024-11-20 23:07:30,523 - INFO - pnl: 2023-10-03T23:59:59.999 146492.3967441551 === -0.132%
2024-11-20 23:07:30,527 - DEBUG - cur time: 2023-10-04T23:59:59.999 == next bar open time: 2023-10-05T00:00:00.000 == close pos time: 2023-10-12T00:00:00.000
2024-11-20 23:07:30,530 - INFO - pnl: 2023-10-04T23:59:59.999 145655.95118902452 === -0.571%
2024-11-20 23:07:30,535 - DEBUG - cur time: 2023-10-05T23:59:59.999 == next bar open time: 2023-10-06T00:00:00.000 == close pos time: 2023-10-13T00:00:00.000
2024-11-20 23:07:30,546 - DEBUG - sorted_long_factors: shape: (177, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TOMOUSDT     ┆ -1.99107     ┆ 0    ┆ 176          │
│ AMBUSDT      ┆ -1.673667    ┆ 1    ┆ 175          │
│ YFIUSDT      ┆ -1.644402    ┆ 2    ┆ 174          │
│ XMRUSDT      ┆ -1.602864    ┆ 3    ┆ 173          │
│ MASKUSDT     ┆ -1.546356    ┆ 4    ┆ 172          │
│ XVSUSDT      ┆ -1.534182    ┆ 5    ┆ 171          │
│ DYDXUSDT     ┆ -1.509515    ┆ 6    ┆ 170          │
│ JOEUSDT      ┆ -1.506441    ┆ 7    ┆ 169          │
│ LEVERUSDT    ┆ -1.502432    ┆ 8    ┆ 168          │
│ 1000PEPEUSDT ┆ -1.480486    ┆ 9    ┆ 167          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CKBUSDT      ┆ 0.030601     ┆ 167  ┆ 9            │
│ ASTRUSDT     ┆ 0.057602     ┆ 168  ┆ 8            │
│ DENTUSDT     ┆ 0.059928     ┆ 169  ┆ 7            │
│ FXSUSDT      ┆ 0.11567      ┆ 170  ┆ 6            │
│ CVXUSDT      ┆ 0.181242     ┆ 171  ┆ 5            │
│ DGBUSDT      ┆ 0.526296     ┆ 172  ┆ 4            │
│ CTKUSDT      ┆ 0.658751     ┆ 173  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.813879     ┆ 174  ┆ 2            │
│ DEFIUSDT     ┆ 0.974591     ┆ 175  ┆ 1            │
│ BNXUSDT      ┆ 1.297345     ┆ 176  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,554 - WARNING - 2023-10-05T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:30,554 - INFO - cur close time: 2023-10-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:30,554 - DEBUG - mean expected ret (mean factor): -0.7884862667760726
2024-11-20 23:07:30,561 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,561 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,561 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0181      ┆ 0.05762     ┆ 0.000701    ┆ … ┆ 0.01648 ┆ null   ┆ null    ┆ 0.1811  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,570 - DEBUG - update position: 2023-10-05T23:59:59.999 === diff_trading_value: 261845.27682306885 == cash: 145505.40280488462 
2024-11-20 23:07:30,572 - INFO - pnl: 2023-10-05T23:59:59.999 145505.40280488462 === -0.103%
2024-11-20 23:07:30,577 - DEBUG - cur time: 2023-10-06T23:59:59.999 == next bar open time: 2023-10-07T00:00:00.000 == close pos time: 2023-10-14T00:00:00.000
2024-11-20 23:07:30,579 - INFO - pnl: 2023-10-06T23:59:59.999 146531.53563370154 === 0.705%
2024-11-20 23:07:30,584 - DEBUG - cur time: 2023-10-07T23:59:59.999 == next bar open time: 2023-10-08T00:00:00.000 == close pos time: 2023-10-15T00:00:00.000
2024-11-20 23:07:30,586 - INFO - pnl: 2023-10-07T23:59:59.999 146126.6087857477 === -0.276%
2024-11-20 23:07:30,590 - DEBUG - cur time: 2023-10-08T23:59:59.999 == next bar open time: 2023-10-09T00:00:00.000 == close pos time: 2023-10-16T00:00:00.000
2024-11-20 23:07:30,591 - INFO - pnl: 2023-10-08T23:59:59.999 148482.72310777687 === 1.612%
2024-11-20 23:07:30,596 - DEBUG - cur time: 2023-10-09T23:59:59.999 == next bar open time: 2023-10-10T00:00:00.000 == close pos time: 2023-10-17T00:00:00.000
2024-11-20 23:07:30,597 - INFO - pnl: 2023-10-09T23:59:59.999 147601.54056317318 === -0.593%
2024-11-20 23:07:30,600 - DEBUG - cur time: 2023-10-10T23:59:59.999 == next bar open time: 2023-10-11T00:00:00.000 == close pos time: 2023-10-18T00:00:00.000
2024-11-20 23:07:30,602 - INFO - pnl: 2023-10-10T23:59:59.999 150122.24820346534 === 1.708%
2024-11-20 23:07:30,605 - DEBUG - cur time: 2023-10-11T23:59:59.999 == next bar open time: 2023-10-12T00:00:00.000 == close pos time: 2023-10-19T00:00:00.000
2024-11-20 23:07:30,606 - INFO - pnl: 2023-10-11T23:59:59.999 150057.07843379592 === -0.043%
2024-11-20 23:07:30,608 - DEBUG - cur time: 2023-10-12T23:59:59.999 == next bar open time: 2023-10-13T00:00:00.000 == close pos time: 2023-10-20T00:00:00.000
2024-11-20 23:07:30,616 - DEBUG - sorted_long_factors: shape: (179, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -2.01264     ┆ 0    ┆ 178          │
│ AMBUSDT      ┆ -1.819856    ┆ 1    ┆ 177          │
│ RUNEUSDT     ┆ -1.794156    ┆ 2    ┆ 176          │
│ FILUSDT      ┆ -1.773228    ┆ 3    ┆ 175          │
│ XVSUSDT      ┆ -1.685529    ┆ 4    ┆ 174          │
│ LEVERUSDT    ┆ -1.641322    ┆ 5    ┆ 173          │
│ 1000PEPEUSDT ┆ -1.619365    ┆ 6    ┆ 172          │
│ SUIUSDT      ┆ -1.572826    ┆ 7    ┆ 171          │
│ JOEUSDT      ┆ -1.546493    ┆ 8    ┆ 170          │
│ API3USDT     ┆ -1.450722    ┆ 9    ┆ 169          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ZENUSDT      ┆ 0.106823     ┆ 169  ┆ 9            │
│ DGBUSDT      ┆ 0.112449     ┆ 170  ┆ 8            │
│ DARUSDT      ┆ 0.11267      ┆ 171  ┆ 7            │
│ BALUSDT      ┆ 0.176515     ┆ 172  ┆ 6            │
│ CKBUSDT      ┆ 0.184422     ┆ 173  ┆ 5            │
│ SSVUSDT      ┆ 0.191851     ┆ 174  ┆ 4            │
│ SKLUSDT      ┆ 0.310443     ┆ 175  ┆ 3            │
│ ZECUSDT      ┆ 0.429622     ┆ 176  ┆ 2            │
│ DEFIUSDT     ┆ 1.106936     ┆ 177  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.362212     ┆ 178  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,622 - WARNING - 2023-10-12T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:30,622 - INFO - cur close time: 2023-10-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:30,623 - DEBUG - mean expected ret (mean factor): -0.782678285581446
2024-11-20 23:07:30,627 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,627 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ -10000.0    ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,627 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01734     ┆ 0.05691     ┆ 0.0006255   ┆ … ┆ 0.01581 ┆ null   ┆ null    ┆ 0.1879  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,634 - DEBUG - update position: 2023-10-12T23:59:59.999 === diff_trading_value: 179978.50470415736 == cash: 150609.84184192144 
2024-11-20 23:07:30,635 - INFO - pnl: 2023-10-12T23:59:59.999 150609.84184192144 === 0.368%
2024-11-20 23:07:30,639 - DEBUG - cur time: 2023-10-13T23:59:59.999 == next bar open time: 2023-10-14T00:00:00.000 == close pos time: 2023-10-21T00:00:00.000
2024-11-20 23:07:30,641 - INFO - pnl: 2023-10-13T23:59:59.999 150737.47191625962 === 0.085%
2024-11-20 23:07:30,645 - DEBUG - cur time: 2023-10-14T23:59:59.999 == next bar open time: 2023-10-15T00:00:00.000 == close pos time: 2023-10-22T00:00:00.000
2024-11-20 23:07:30,646 - INFO - pnl: 2023-10-14T23:59:59.999 150620.51867878434 === -0.078%
2024-11-20 23:07:30,650 - DEBUG - cur time: 2023-10-15T23:59:59.999 == next bar open time: 2023-10-16T00:00:00.000 == close pos time: 2023-10-23T00:00:00.000
2024-11-20 23:07:30,651 - INFO - pnl: 2023-10-15T23:59:59.999 152658.60719485692 === 1.353%
2024-11-20 23:07:30,654 - DEBUG - cur time: 2023-10-16T23:59:59.999 == next bar open time: 2023-10-17T00:00:00.000 == close pos time: 2023-10-24T00:00:00.000
2024-11-20 23:07:30,656 - INFO - pnl: 2023-10-16T23:59:59.999 153542.52294806804 === 0.579%
2024-11-20 23:07:30,660 - DEBUG - cur time: 2023-10-17T23:59:59.999 == next bar open time: 2023-10-18T00:00:00.000 == close pos time: 2023-10-25T00:00:00.000
2024-11-20 23:07:30,662 - INFO - pnl: 2023-10-17T23:59:59.999 153787.87194961892 === 0.160%
2024-11-20 23:07:30,665 - DEBUG - cur time: 2023-10-18T23:59:59.999 == next bar open time: 2023-10-19T00:00:00.000 == close pos time: 2023-10-26T00:00:00.000
2024-11-20 23:07:30,667 - INFO - pnl: 2023-10-18T23:59:59.999 155506.60482902685 === 1.118%
2024-11-20 23:07:30,671 - DEBUG - cur time: 2023-10-19T23:59:59.999 == next bar open time: 2023-10-20T00:00:00.000 == close pos time: 2023-10-27T00:00:00.000
2024-11-20 23:07:30,682 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ FILUSDT      ┆ -1.912752    ┆ 0    ┆ 179          │
│ TRBUSDT      ┆ -1.661474    ┆ 1    ┆ 178          │
│ BNBUSDT      ┆ -1.612247    ┆ 2    ┆ 177          │
│ DYDXUSDT     ┆ -1.605262    ┆ 3    ┆ 176          │
│ MASKUSDT     ┆ -1.565637    ┆ 4    ┆ 175          │
│ EGLDUSDT     ┆ -1.554982    ┆ 5    ┆ 174          │
│ ATOMUSDT     ┆ -1.54246     ┆ 6    ┆ 173          │
│ XVSUSDT      ┆ -1.53498     ┆ 7    ┆ 172          │
│ ANTUSDT      ┆ -1.506669    ┆ 8    ┆ 171          │
│ STORJUSDT    ┆ -1.498378    ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CELRUSDT     ┆ -0.009556    ┆ 170  ┆ 9            │
│ SKLUSDT      ┆ 0.064264     ┆ 171  ┆ 8            │
│ DGBUSDT      ┆ 0.192708     ┆ 172  ┆ 7            │
│ CKBUSDT      ┆ 0.20512      ┆ 173  ┆ 6            │
│ RVNUSDT      ┆ 0.217391     ┆ 174  ┆ 5            │
│ BLUEBIRDUSDT ┆ 0.374367     ┆ 175  ┆ 4            │
│ CTKUSDT      ┆ 0.439561     ┆ 176  ┆ 3            │
│ TLMUSDT      ┆ 0.545313     ┆ 177  ┆ 2            │
│ CVXUSDT      ┆ 0.555453     ┆ 178  ┆ 1            │
│ DEFIUSDT     ┆ 0.627199     ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,689 - INFO - cur close time: 2023-10-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:30,689 - DEBUG - mean expected ret (mean factor): -0.8105477817957355
2024-11-20 23:07:30,694 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,694 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,695 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.01788     ┆ 0.05537     ┆ 0.0006271   ┆ … ┆ 0.01646 ┆ null   ┆ null    ┆ 0.2065  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,702 - DEBUG - update position: 2023-10-19T23:59:59.999 === diff_trading_value: 248505.92070722615 == cash: 155218.50971951915 
2024-11-20 23:07:30,704 - INFO - pnl: 2023-10-19T23:59:59.999 155218.50971951915 === -0.185%
2024-11-20 23:07:30,708 - DEBUG - cur time: 2023-10-20T23:59:59.999 == next bar open time: 2023-10-21T00:00:00.000 == close pos time: 2023-10-28T00:00:00.000
2024-11-20 23:07:30,710 - INFO - pnl: 2023-10-20T23:59:59.999 152762.27189984306 === -1.582%
2024-11-20 23:07:30,714 - DEBUG - cur time: 2023-10-21T23:59:59.999 == next bar open time: 2023-10-22T00:00:00.000 == close pos time: 2023-10-29T00:00:00.000
2024-11-20 23:07:30,716 - INFO - pnl: 2023-10-21T23:59:59.999 154607.3923910597 === 1.208%
2024-11-20 23:07:30,720 - DEBUG - cur time: 2023-10-22T23:59:59.999 == next bar open time: 2023-10-23T00:00:00.000 == close pos time: 2023-10-30T00:00:00.000
2024-11-20 23:07:30,721 - INFO - pnl: 2023-10-22T23:59:59.999 155292.7785338473 === 0.443%
2024-11-20 23:07:30,725 - DEBUG - cur time: 2023-10-23T23:59:59.999 == next bar open time: 2023-10-24T00:00:00.000 == close pos time: 2023-10-31T00:00:00.000
2024-11-20 23:07:30,726 - INFO - pnl: 2023-10-23T23:59:59.999 152823.68544302115 === -1.590%
2024-11-20 23:07:30,730 - DEBUG - cur time: 2023-10-24T23:59:59.999 == next bar open time: 2023-10-25T00:00:00.000 == close pos time: 2023-11-01T00:00:00.000
2024-11-20 23:07:30,731 - INFO - pnl: 2023-10-24T23:59:59.999 153957.00217310985 === 0.742%
2024-11-20 23:07:30,733 - DEBUG - cur time: 2023-10-25T23:59:59.999 == next bar open time: 2023-10-26T00:00:00.000 == close pos time: 2023-11-02T00:00:00.000
2024-11-20 23:07:30,735 - INFO - pnl: 2023-10-25T23:59:59.999 150008.2212643781 === -2.565%
2024-11-20 23:07:30,738 - DEBUG - cur time: 2023-10-26T23:59:59.999 == next bar open time: 2023-10-27T00:00:00.000 == close pos time: 2023-11-03T00:00:00.000
2024-11-20 23:07:30,746 - DEBUG - sorted_long_factors: shape: (180, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ SUIUSDT      ┆ -1.83365     ┆ 0    ┆ 179          │
│ APEUSDT      ┆ -1.608852    ┆ 1    ┆ 178          │
│ BNBUSDT      ┆ -1.601413    ┆ 2    ┆ 177          │
│ OPUSDT       ┆ -1.594234    ┆ 3    ┆ 176          │
│ ARBUSDT      ┆ -1.562487    ┆ 4    ┆ 175          │
│ MASKUSDT     ┆ -1.525439    ┆ 5    ┆ 174          │
│ RNDRUSDT     ┆ -1.475538    ┆ 6    ┆ 173          │
│ AXSUSDT      ┆ -1.4541      ┆ 7    ┆ 172          │
│ LPTUSDT      ┆ -1.436562    ┆ 8    ┆ 171          │
│ RUNEUSDT     ┆ -1.43544     ┆ 9    ┆ 170          │
│ …            ┆ …            ┆ …    ┆ …            │
│ COMBOUSDT    ┆ -0.1386      ┆ 170  ┆ 9            │
│ ONEUSDT      ┆ -0.114668    ┆ 171  ┆ 8            │
│ RVNUSDT      ┆ -0.020564    ┆ 172  ┆ 7            │
│ TLMUSDT      ┆ 0.053992     ┆ 173  ┆ 6            │
│ CTKUSDT      ┆ 0.090942     ┆ 174  ┆ 5            │
│ DGBUSDT      ┆ 0.095257     ┆ 175  ┆ 4            │
│ SKLUSDT      ┆ 0.200873     ┆ 176  ┆ 3            │
│ CKBUSDT      ┆ 0.623006     ┆ 177  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.774373     ┆ 178  ┆ 1            │
│ DEFIUSDT     ┆ 0.962259     ┆ 179  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,752 - WARNING - 2023-10-26T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:30,752 - INFO - cur close time: 2023-10-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:30,753 - DEBUG - mean expected ret (mean factor): -0.7847250641601206
2024-11-20 23:07:30,756 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,757 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,757 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03851     ┆ 0.06317     ┆ 0.0012849   ┆ … ┆ 0.01863 ┆ null   ┆ null    ┆ 0.2366  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,763 - DEBUG - update position: 2023-10-26T23:59:59.999 === diff_trading_value: 282669.52023222746 == cash: 150871.14422903492 
2024-11-20 23:07:30,765 - INFO - pnl: 2023-10-26T23:59:59.999 150871.14422903492 === 0.575%
2024-11-20 23:07:30,768 - DEBUG - cur time: 2023-10-27T23:59:59.999 == next bar open time: 2023-10-28T00:00:00.000 == close pos time: 2023-11-04T00:00:00.000
2024-11-20 23:07:30,770 - INFO - pnl: 2023-10-27T23:59:59.999 149514.05782143152 === -0.900%
2024-11-20 23:07:30,773 - DEBUG - cur time: 2023-10-28T23:59:59.999 == next bar open time: 2023-10-29T00:00:00.000 == close pos time: 2023-11-05T00:00:00.000
2024-11-20 23:07:30,774 - INFO - pnl: 2023-10-28T23:59:59.999 148257.3373837222 === -0.841%
2024-11-20 23:07:30,777 - DEBUG - cur time: 2023-10-29T23:59:59.999 == next bar open time: 2023-10-30T00:00:00.000 == close pos time: 2023-11-06T00:00:00.000
2024-11-20 23:07:30,778 - INFO - pnl: 2023-10-29T23:59:59.999 148455.65732256454 === 0.134%
2024-11-20 23:07:30,781 - DEBUG - cur time: 2023-10-30T23:59:59.999 == next bar open time: 2023-10-31T00:00:00.000 == close pos time: 2023-11-07T00:00:00.000
2024-11-20 23:07:30,781 - INFO - pnl: 2023-10-30T23:59:59.999 148182.39425929505 === -0.184%
2024-11-20 23:07:30,785 - DEBUG - cur time: 2023-10-31T23:59:59.999 == next bar open time: 2023-11-01T00:00:00.000 == close pos time: 2023-11-08T00:00:00.000
2024-11-20 23:07:30,786 - INFO - pnl: 2023-10-31T23:59:59.999 147997.69515823948 === -0.125%
2024-11-20 23:07:30,789 - DEBUG - cur time: 2023-11-01T23:59:59.999 == next bar open time: 2023-11-02T00:00:00.000 == close pos time: 2023-11-09T00:00:00.000
2024-11-20 23:07:30,790 - INFO - pnl: 2023-11-01T23:59:59.999 148774.53068424587 === 0.525%
2024-11-20 23:07:30,793 - DEBUG - cur time: 2023-11-02T23:59:59.999 == next bar open time: 2023-11-03T00:00:00.000 == close pos time: 2023-11-10T00:00:00.000
2024-11-20 23:07:30,800 - DEBUG - sorted_long_factors: shape: (181, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT      ┆ -1.686951    ┆ 0    ┆ 180          │
│ AAVEUSDT     ┆ -1.636501    ┆ 1    ┆ 179          │
│ RNDRUSDT     ┆ -1.523915    ┆ 2    ┆ 178          │
│ STORJUSDT    ┆ -1.495631    ┆ 3    ┆ 177          │
│ MASKUSDT     ┆ -1.495426    ┆ 4    ┆ 176          │
│ HBARUSDT     ┆ -1.471638    ┆ 5    ┆ 175          │
│ OPUSDT       ┆ -1.466328    ┆ 6    ┆ 174          │
│ WAVESUSDT    ┆ -1.441868    ┆ 7    ┆ 173          │
│ THETAUSDT    ┆ -1.439817    ┆ 8    ┆ 172          │
│ BLURUSDT     ┆ -1.42382     ┆ 9    ┆ 171          │
│ …            ┆ …            ┆ …    ┆ …            │
│ GMXUSDT      ┆ -0.042395    ┆ 171  ┆ 9            │
│ DARUSDT      ┆ -0.00667     ┆ 172  ┆ 8            │
│ CTKUSDT      ┆ 0.06512      ┆ 173  ┆ 7            │
│ DGBUSDT      ┆ 0.072909     ┆ 174  ┆ 6            │
│ RVNUSDT      ┆ 0.107255     ┆ 175  ┆ 5            │
│ CVXUSDT      ┆ 0.298883     ┆ 176  ┆ 4            │
│ QNTUSDT      ┆ 0.355253     ┆ 177  ┆ 3            │
│ BLUEBIRDUSDT ┆ 0.528872     ┆ 178  ┆ 2            │
│ CKBUSDT      ┆ 0.938605     ┆ 179  ┆ 1            │
│ DEFIUSDT     ┆ 1.760872     ┆ 180  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,806 - WARNING - 2023-11-02T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:30,806 - INFO - cur close time: 2023-11-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:30,806 - DEBUG - mean expected ret (mean factor): -0.7722989599169557
2024-11-20 23:07:30,810 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,811 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,811 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03083     ┆ 0.06397     ┆ 0.001092    ┆ … ┆ 0.01985 ┆ null   ┆ null    ┆ 0.2598  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,817 - DEBUG - update position: 2023-11-02T23:59:59.999 === diff_trading_value: 231795.83525214248 == cash: 147673.57895936168 
2024-11-20 23:07:30,819 - INFO - pnl: 2023-11-02T23:59:59.999 147673.57895936168 === -0.740%
2024-11-20 23:07:30,822 - DEBUG - cur time: 2023-11-03T23:59:59.999 == next bar open time: 2023-11-04T00:00:00.000 == close pos time: 2023-11-11T00:00:00.000
2024-11-20 23:07:30,824 - INFO - pnl: 2023-11-03T23:59:59.999 149099.66278588242 === 0.966%
2024-11-20 23:07:30,827 - DEBUG - cur time: 2023-11-04T23:59:59.999 == next bar open time: 2023-11-05T00:00:00.000 == close pos time: 2023-11-12T00:00:00.000
2024-11-20 23:07:30,829 - INFO - pnl: 2023-11-04T23:59:59.999 148268.5739163005 === -0.557%
2024-11-20 23:07:30,832 - DEBUG - cur time: 2023-11-05T23:59:59.999 == next bar open time: 2023-11-06T00:00:00.000 == close pos time: 2023-11-13T00:00:00.000
2024-11-20 23:07:30,834 - INFO - pnl: 2023-11-05T23:59:59.999 149060.70196554228 === 0.534%
2024-11-20 23:07:30,837 - DEBUG - cur time: 2023-11-06T23:59:59.999 == next bar open time: 2023-11-07T00:00:00.000 == close pos time: 2023-11-14T00:00:00.000
2024-11-20 23:07:30,838 - INFO - pnl: 2023-11-06T23:59:59.999 145872.81951781848 === -2.139%
2024-11-20 23:07:30,841 - DEBUG - cur time: 2023-11-07T23:59:59.999 == next bar open time: 2023-11-08T00:00:00.000 == close pos time: 2023-11-15T00:00:00.000
2024-11-20 23:07:30,843 - INFO - pnl: 2023-11-07T23:59:59.999 145478.8487996632 === -0.270%
2024-11-20 23:07:30,846 - DEBUG - cur time: 2023-11-08T23:59:59.999 == next bar open time: 2023-11-09T00:00:00.000 == close pos time: 2023-11-16T00:00:00.000
2024-11-20 23:07:30,847 - INFO - pnl: 2023-11-08T23:59:59.999 142966.92106091505 === -1.727%
2024-11-20 23:07:30,852 - DEBUG - cur time: 2023-11-09T23:59:59.999 == next bar open time: 2023-11-10T00:00:00.000 == close pos time: 2023-11-17T00:00:00.000
2024-11-20 23:07:30,860 - DEBUG - sorted_long_factors: shape: (183, 4)
┌───────────────┬──────────────┬──────┬──────────────┐
│ symbol        ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---           ┆ ---          ┆ ---  ┆ ---          │
│ str           ┆ f64          ┆ u32  ┆ u32          │
╞═══════════════╪══════════════╪══════╪══════════════╡
│ MINAUSDT      ┆ -1.804169    ┆ 0    ┆ 182          │
│ WLDUSDT       ┆ -1.665943    ┆ 1    ┆ 181          │
│ BNBUSDT       ┆ -1.647754    ┆ 2    ┆ 180          │
│ TRBUSDT       ┆ -1.506771    ┆ 3    ┆ 179          │
│ SUIUSDT       ┆ -1.49417     ┆ 4    ┆ 178          │
│ COMPUSDT      ┆ -1.477555    ┆ 5    ┆ 177          │
│ DYDXUSDT      ┆ -1.453227    ┆ 6    ┆ 176          │
│ LQTYUSDT      ┆ -1.426451    ┆ 7    ┆ 175          │
│ 1000FLOKIUSDT ┆ -1.386165    ┆ 8    ┆ 174          │
│ YFIUSDT       ┆ -1.377549    ┆ 9    ┆ 173          │
│ …             ┆ …            ┆ …    ┆ …            │
│ SKLUSDT       ┆ -0.095111    ┆ 173  ┆ 9            │
│ TRUUSDT       ┆ -0.05938     ┆ 174  ┆ 8            │
│ IOTXUSDT      ┆ -0.034947    ┆ 175  ┆ 7            │
│ OMGUSDT       ┆ 0.067496     ┆ 176  ┆ 6            │
│ RVNUSDT       ┆ 0.130395     ┆ 177  ┆ 5            │
│ DGBUSDT       ┆ 0.153407     ┆ 178  ┆ 4            │
│ CKBUSDT       ┆ 0.312398     ┆ 179  ┆ 3            │
│ BTCDOMUSDT    ┆ 0.50179      ┆ 180  ┆ 2            │
│ BLUEBIRDUSDT  ┆ 1.280092     ┆ 181  ┆ 1            │
│ DEFIUSDT      ┆ 1.371313     ┆ 182  ┆ 0            │
└───────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,865 - WARNING - 2023-11-09T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:30,865 - INFO - cur close time: 2023-11-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:30,865 - DEBUG - mean expected ret (mean factor): -0.7679363791841415
2024-11-20 23:07:30,869 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,870 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ f64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ -10000.0    ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,870 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0303      ┆ 0.06755     ┆ 0.0013341   ┆ … ┆ 0.02074 ┆ null   ┆ null    ┆ 0.2821  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,878 - DEBUG - update position: 2023-11-09T23:59:59.999 === diff_trading_value: 283109.69265398604 == cash: 138453.00716672026 
2024-11-20 23:07:30,881 - INFO - pnl: 2023-11-09T23:59:59.999 138453.00716672026 === -3.157%
2024-11-20 23:07:30,884 - DEBUG - cur time: 2023-11-10T23:59:59.999 == next bar open time: 2023-11-11T00:00:00.000 == close pos time: 2023-11-18T00:00:00.000
2024-11-20 23:07:30,886 - INFO - pnl: 2023-11-10T23:59:59.999 139026.33700885097 === 0.414%
2024-11-20 23:07:30,891 - DEBUG - cur time: 2023-11-11T23:59:59.999 == next bar open time: 2023-11-12T00:00:00.000 == close pos time: 2023-11-19T00:00:00.000
2024-11-20 23:07:30,894 - INFO - pnl: 2023-11-11T23:59:59.999 138815.7945936658 === -0.151%
2024-11-20 23:07:30,898 - DEBUG - cur time: 2023-11-12T23:59:59.999 == next bar open time: 2023-11-13T00:00:00.000 == close pos time: 2023-11-20T00:00:00.000
2024-11-20 23:07:30,900 - INFO - pnl: 2023-11-12T23:59:59.999 138283.3177210971 === -0.384%
2024-11-20 23:07:30,904 - DEBUG - cur time: 2023-11-13T23:59:59.999 == next bar open time: 2023-11-14T00:00:00.000 == close pos time: 2023-11-21T00:00:00.000
2024-11-20 23:07:30,905 - INFO - pnl: 2023-11-13T23:59:59.999 132312.92113092676 === -4.318%
2024-11-20 23:07:30,909 - DEBUG - cur time: 2023-11-14T23:59:59.999 == next bar open time: 2023-11-15T00:00:00.000 == close pos time: 2023-11-22T00:00:00.000
2024-11-20 23:07:30,910 - INFO - pnl: 2023-11-14T23:59:59.999 127733.27184761623 === -3.461%
2024-11-20 23:07:30,914 - DEBUG - cur time: 2023-11-15T23:59:59.999 == next bar open time: 2023-11-16T00:00:00.000 == close pos time: 2023-11-23T00:00:00.000
2024-11-20 23:07:30,916 - INFO - pnl: 2023-11-15T23:59:59.999 125099.78663644231 === -2.062%
2024-11-20 23:07:30,919 - DEBUG - cur time: 2023-11-16T23:59:59.999 == next bar open time: 2023-11-17T00:00:00.000 == close pos time: 2023-11-24T00:00:00.000
2024-11-20 23:07:30,926 - DEBUG - sorted_long_factors: shape: (184, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ARKMUSDT     ┆ -1.783088    ┆ 0    ┆ 183          │
│ ATOMUSDT     ┆ -1.558544    ┆ 1    ┆ 182          │
│ NEARUSDT     ┆ -1.51756     ┆ 2    ┆ 181          │
│ MASKUSDT     ┆ -1.513933    ┆ 3    ┆ 180          │
│ FILUSDT      ┆ -1.51237     ┆ 4    ┆ 179          │
│ LPTUSDT      ┆ -1.497641    ┆ 5    ┆ 178          │
│ UNFIUSDT     ┆ -1.468984    ┆ 6    ┆ 177          │
│ FTMUSDT      ┆ -1.406686    ┆ 7    ┆ 176          │
│ BLZUSDT      ┆ -1.372982    ┆ 8    ┆ 175          │
│ MAVUSDT      ┆ -1.364947    ┆ 9    ┆ 174          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ANTUSDT      ┆ -0.131099    ┆ 174  ┆ 9            │
│ EGLDUSDT     ┆ -0.121383    ┆ 175  ┆ 8            │
│ ATAUSDT      ┆ -0.023714    ┆ 176  ┆ 7            │
│ CTKUSDT      ┆ -0.000559    ┆ 177  ┆ 6            │
│ TLMUSDT      ┆ 0.016998     ┆ 178  ┆ 5            │
│ DGBUSDT      ┆ 0.147558     ┆ 179  ┆ 4            │
│ CVXUSDT      ┆ 0.206212     ┆ 180  ┆ 3            │
│ IDEXUSDT     ┆ 0.225259     ┆ 181  ┆ 2            │
│ BLUEBIRDUSDT ┆ 0.534294     ┆ 182  ┆ 1            │
│ DEFIUSDT     ┆ 1.976603     ┆ 183  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:30,933 - WARNING - 2023-11-16T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:30,933 - INFO - cur close time: 2023-11-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:30,934 - DEBUG - mean expected ret (mean factor): -0.7640306316340985
2024-11-20 23:07:30,938 - DEBUG - begin to update pos: =========
2024-11-20 23:07:30,938 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,938 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03328     ┆ 0.07783     ┆ 0.001142    ┆ … ┆ 0.02128 ┆ null   ┆ null    ┆ 0.4671  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:30,947 - DEBUG - update position: 2023-11-16T23:59:59.999 === diff_trading_value: 329571.68150872196 == cash: 124133.12031735471 
2024-11-20 23:07:30,949 - INFO - pnl: 2023-11-16T23:59:59.999 124133.12031735471 === -0.773%
2024-11-20 23:07:30,954 - DEBUG - cur time: 2023-11-17T23:59:59.999 == next bar open time: 2023-11-18T00:00:00.000 == close pos time: 2023-11-25T00:00:00.000
2024-11-20 23:07:30,957 - INFO - pnl: 2023-11-17T23:59:59.999 125468.50117049285 === 1.076%
2024-11-20 23:07:30,962 - DEBUG - cur time: 2023-11-18T23:59:59.999 == next bar open time: 2023-11-19T00:00:00.000 == close pos time: 2023-11-26T00:00:00.000
2024-11-20 23:07:30,963 - INFO - pnl: 2023-11-18T23:59:59.999 126701.92028352643 === 0.983%
2024-11-20 23:07:30,968 - DEBUG - cur time: 2023-11-19T23:59:59.999 == next bar open time: 2023-11-20T00:00:00.000 == close pos time: 2023-11-27T00:00:00.000
2024-11-20 23:07:30,969 - INFO - pnl: 2023-11-19T23:59:59.999 126912.67062393509 === 0.166%
2024-11-20 23:07:30,972 - DEBUG - cur time: 2023-11-20T23:59:59.999 == next bar open time: 2023-11-21T00:00:00.000 == close pos time: 2023-11-28T00:00:00.000
2024-11-20 23:07:30,973 - INFO - pnl: 2023-11-20T23:59:59.999 130203.2209615102 === 2.593%
2024-11-20 23:07:30,977 - DEBUG - cur time: 2023-11-21T23:59:59.999 == next bar open time: 2023-11-22T00:00:00.000 == close pos time: 2023-11-29T00:00:00.000
2024-11-20 23:07:30,978 - INFO - pnl: 2023-11-21T23:59:59.999 130342.99212430113 === 0.107%
2024-11-20 23:07:30,981 - DEBUG - cur time: 2023-11-22T23:59:59.999 == next bar open time: 2023-11-23T00:00:00.000 == close pos time: 2023-11-30T00:00:00.000
2024-11-20 23:07:30,982 - INFO - pnl: 2023-11-22T23:59:59.999 129402.8021435067 === -0.721%
2024-11-20 23:07:30,984 - DEBUG - cur time: 2023-11-23T23:59:59.999 == next bar open time: 2023-11-24T00:00:00.000 == close pos time: 2023-12-01T00:00:00.000
2024-11-20 23:07:30,993 - DEBUG - sorted_long_factors: shape: (187, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ YFIUSDT      ┆ -2.110294    ┆ 0    ┆ 186          │
│ BNTUSDT      ┆ -1.960403    ┆ 1    ┆ 185          │
│ ARKMUSDT     ┆ -1.78379     ┆ 2    ┆ 184          │
│ FILUSDT      ┆ -1.669592    ┆ 3    ┆ 183          │
│ MKRUSDT      ┆ -1.642795    ┆ 4    ┆ 182          │
│ XMRUSDT      ┆ -1.640603    ┆ 5    ┆ 181          │
│ EGLDUSDT     ┆ -1.627528    ┆ 6    ┆ 180          │
│ ZRXUSDT      ┆ -1.609629    ┆ 7    ┆ 179          │
│ BNBUSDT      ┆ -1.590017    ┆ 8    ┆ 178          │
│ COMPUSDT     ┆ -1.552142    ┆ 9    ┆ 177          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CKBUSDT      ┆ 0.089461     ┆ 177  ┆ 9            │
│ XVGUSDT      ┆ 0.137864     ┆ 178  ┆ 8            │
│ DENTUSDT     ┆ 0.186135     ┆ 179  ┆ 7            │
│ DGBUSDT      ┆ 0.24487      ┆ 180  ┆ 6            │
│ TLMUSDT      ┆ 0.286303     ┆ 181  ┆ 5            │
│ BLUEBIRDUSDT ┆ 0.41639      ┆ 182  ┆ 4            │
│ CVXUSDT      ┆ 0.59387      ┆ 183  ┆ 3            │
│ CTKUSDT      ┆ 0.704111     ┆ 184  ┆ 2            │
│ IDEXUSDT     ┆ 1.153985     ┆ 185  ┆ 1            │
│ DEFIUSDT     ┆ 1.462921     ┆ 186  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,000 - INFO - cur close time: 2023-11-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:31,001 - DEBUG - mean expected ret (mean factor): -0.7539201936043491
2024-11-20 23:07:31,005 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,005 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬─────────┬──────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT  │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---      │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64      │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆         ┆          │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪═════════╪══════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ -10000.0 │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴─────────┴──────────┘
2024-11-20 23:07:31,006 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03195     ┆ 0.07364     ┆ 0.0010691   ┆ … ┆ 0.02093 ┆ null   ┆ null    ┆ 0.4257  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,011 - DEBUG - update position: 2023-11-23T23:59:59.999 === diff_trading_value: 240346.72874303538 == cash: 129769.91099691504 
2024-11-20 23:07:31,012 - INFO - pnl: 2023-11-23T23:59:59.999 129769.91099691504 === 0.284%
2024-11-20 23:07:31,016 - DEBUG - cur time: 2023-11-24T23:59:59.999 == next bar open time: 2023-11-25T00:00:00.000 == close pos time: 2023-12-02T00:00:00.000
2024-11-20 23:07:31,017 - INFO - pnl: 2023-11-24T23:59:59.999 130844.25386051521 === 0.828%
2024-11-20 23:07:31,020 - DEBUG - cur time: 2023-11-25T23:59:59.999 == next bar open time: 2023-11-26T00:00:00.000 == close pos time: 2023-12-03T00:00:00.000
2024-11-20 23:07:31,022 - INFO - pnl: 2023-11-25T23:59:59.999 131429.94239422627 === 0.448%
2024-11-20 23:07:31,024 - DEBUG - cur time: 2023-11-26T23:59:59.999 == next bar open time: 2023-11-27T00:00:00.000 == close pos time: 2023-12-04T00:00:00.000
2024-11-20 23:07:31,026 - INFO - pnl: 2023-11-26T23:59:59.999 135812.59310006697 === 3.335%
2024-11-20 23:07:31,028 - DEBUG - cur time: 2023-11-27T23:59:59.999 == next bar open time: 2023-11-28T00:00:00.000 == close pos time: 2023-12-05T00:00:00.000
2024-11-20 23:07:31,030 - INFO - pnl: 2023-11-27T23:59:59.999 135323.1842517277 === -0.360%
2024-11-20 23:07:31,035 - DEBUG - cur time: 2023-11-28T23:59:59.999 == next bar open time: 2023-11-29T00:00:00.000 == close pos time: 2023-12-06T00:00:00.000
2024-11-20 23:07:31,037 - INFO - pnl: 2023-11-28T23:59:59.999 136250.46185395768 === 0.685%
2024-11-20 23:07:31,040 - DEBUG - cur time: 2023-11-29T23:59:59.999 == next bar open time: 2023-11-30T00:00:00.000 == close pos time: 2023-12-07T00:00:00.000
2024-11-20 23:07:31,042 - INFO - pnl: 2023-11-29T23:59:59.999 136020.75814572588 === -0.169%
2024-11-20 23:07:31,045 - DEBUG - cur time: 2023-11-30T23:59:59.999 == next bar open time: 2023-12-01T00:00:00.000 == close pos time: 2023-12-08T00:00:00.000
2024-11-20 23:07:31,053 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT      ┆ -2.248758    ┆ 0    ┆ 188          │
│ XVSUSDT      ┆ -1.838157    ┆ 1    ┆ 187          │
│ ATOMUSDT     ┆ -1.807479    ┆ 2    ┆ 186          │
│ MDTUSDT      ┆ -1.728454    ┆ 3    ┆ 185          │
│ IDUSDT       ┆ -1.647578    ┆ 4    ┆ 184          │
│ NEARUSDT     ┆ -1.604871    ┆ 5    ┆ 183          │
│ MASKUSDT     ┆ -1.603963    ┆ 6    ┆ 182          │
│ MINAUSDT     ┆ -1.562052    ┆ 7    ┆ 181          │
│ DOTUSDT      ┆ -1.512188    ┆ 8    ┆ 180          │
│ YGGUSDT      ┆ -1.498727    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ IDEXUSDT     ┆ -0.102178    ┆ 179  ┆ 9            │
│ BLUEBIRDUSDT ┆ -0.071971    ┆ 180  ┆ 8            │
│ ATAUSDT      ┆ 0.050467     ┆ 181  ┆ 7            │
│ DENTUSDT     ┆ 0.085668     ┆ 182  ┆ 6            │
│ TUSDT        ┆ 0.104849     ┆ 183  ┆ 5            │
│ BALUSDT      ┆ 0.3653       ┆ 184  ┆ 4            │
│ DGBUSDT      ┆ 0.527207     ┆ 185  ┆ 3            │
│ CKBUSDT      ┆ 0.691382     ┆ 186  ┆ 2            │
│ CVXUSDT      ┆ 0.707992     ┆ 187  ┆ 1            │
│ DEFIUSDT     ┆ 2.590906     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,059 - INFO - cur close time: 2023-11-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:31,059 - DEBUG - mean expected ret (mean factor): -0.7686755064123814
2024-11-20 23:07:31,063 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,063 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,063 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03212     ┆ 0.11749     ┆ 0.0010868   ┆ … ┆ 0.02189 ┆ null   ┆ null    ┆ 0.383   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,068 - DEBUG - update position: 2023-11-30T23:59:59.999 === diff_trading_value: 276673.06666118465 == cash: 136927.5163745788 
2024-11-20 23:07:31,069 - INFO - pnl: 2023-11-30T23:59:59.999 136927.5163745788 === 0.667%
2024-11-20 23:07:31,073 - DEBUG - cur time: 2023-12-01T23:59:59.999 == next bar open time: 2023-12-02T00:00:00.000 == close pos time: 2023-12-09T00:00:00.000
2024-11-20 23:07:31,075 - INFO - pnl: 2023-12-01T23:59:59.999 137364.05710187 === 0.319%
2024-11-20 23:07:31,078 - DEBUG - cur time: 2023-12-02T23:59:59.999 == next bar open time: 2023-12-03T00:00:00.000 == close pos time: 2023-12-10T00:00:00.000
2024-11-20 23:07:31,080 - INFO - pnl: 2023-12-02T23:59:59.999 139271.8757568944 === 1.389%
2024-11-20 23:07:31,083 - DEBUG - cur time: 2023-12-03T23:59:59.999 == next bar open time: 2023-12-04T00:00:00.000 == close pos time: 2023-12-11T00:00:00.000
2024-11-20 23:07:31,084 - INFO - pnl: 2023-12-03T23:59:59.999 138300.41312042833 === -0.698%
2024-11-20 23:07:31,087 - DEBUG - cur time: 2023-12-04T23:59:59.999 == next bar open time: 2023-12-05T00:00:00.000 == close pos time: 2023-12-12T00:00:00.000
2024-11-20 23:07:31,088 - INFO - pnl: 2023-12-04T23:59:59.999 142591.89914779126 === 3.103%
2024-11-20 23:07:31,091 - DEBUG - cur time: 2023-12-05T23:59:59.999 == next bar open time: 2023-12-06T00:00:00.000 == close pos time: 2023-12-13T00:00:00.000
2024-11-20 23:07:31,093 - INFO - pnl: 2023-12-05T23:59:59.999 139326.47434030642 === -2.290%
2024-11-20 23:07:31,096 - DEBUG - cur time: 2023-12-06T23:59:59.999 == next bar open time: 2023-12-07T00:00:00.000 == close pos time: 2023-12-14T00:00:00.000
2024-11-20 23:07:31,098 - INFO - pnl: 2023-12-06T23:59:59.999 137905.69201256183 === -1.020%
2024-11-20 23:07:31,101 - DEBUG - cur time: 2023-12-07T23:59:59.999 == next bar open time: 2023-12-08T00:00:00.000 == close pos time: 2023-12-15T00:00:00.000
2024-11-20 23:07:31,109 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ATOMUSDT     ┆ -1.990944    ┆ 0    ┆ 188          │
│ QTUMUSDT     ┆ -1.88911     ┆ 1    ┆ 187          │
│ CYBERUSDT    ┆ -1.783625    ┆ 2    ┆ 186          │
│ SNXUSDT      ┆ -1.73824     ┆ 3    ┆ 185          │
│ EGLDUSDT     ┆ -1.729538    ┆ 4    ┆ 184          │
│ BNBUSDT      ┆ -1.696623    ┆ 5    ┆ 183          │
│ MDTUSDT      ┆ -1.691128    ┆ 6    ┆ 182          │
│ COMPUSDT     ┆ -1.687238    ┆ 7    ┆ 181          │
│ AXSUSDT      ┆ -1.640047    ┆ 8    ┆ 180          │
│ YFIUSDT      ┆ -1.581704    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TUSDT        ┆ 0.08685      ┆ 179  ┆ 9            │
│ CVXUSDT      ┆ 0.093714     ┆ 180  ┆ 8            │
│ CTKUSDT      ┆ 0.154655     ┆ 181  ┆ 7            │
│ RVNUSDT      ┆ 0.181597     ┆ 182  ┆ 6            │
│ ATAUSDT      ┆ 0.18386      ┆ 183  ┆ 5            │
│ BTCDOMUSDT   ┆ 0.249111     ┆ 184  ┆ 4            │
│ DGBUSDT      ┆ 0.457653     ┆ 185  ┆ 3            │
│ CKBUSDT      ┆ 0.807002     ┆ 186  ┆ 2            │
│ DEFIUSDT     ┆ 0.852524     ┆ 187  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.168854     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,117 - WARNING - 2023-12-07T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,117 - INFO - cur close time: 2023-12-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:31,117 - DEBUG - mean expected ret (mean factor): -0.7742711751313169
2024-11-20 23:07:31,121 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,121 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,121 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.04163     ┆ 0.20074     ┆ 0.001525    ┆ … ┆ 0.02363 ┆ null   ┆ null    ┆ 0.4145  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,128 - DEBUG - update position: 2023-12-07T23:59:59.999 === diff_trading_value: 255000.95876772967 == cash: 137410.9178960772 
2024-11-20 23:07:31,130 - INFO - pnl: 2023-12-07T23:59:59.999 137410.9178960772 === -0.359%
2024-11-20 23:07:31,134 - DEBUG - cur time: 2023-12-08T23:59:59.999 == next bar open time: 2023-12-09T00:00:00.000 == close pos time: 2023-12-16T00:00:00.000
2024-11-20 23:07:31,135 - INFO - pnl: 2023-12-08T23:59:59.999 136294.67327301748 === -0.812%
2024-11-20 23:07:31,138 - DEBUG - cur time: 2023-12-09T23:59:59.999 == next bar open time: 2023-12-10T00:00:00.000 == close pos time: 2023-12-17T00:00:00.000
2024-11-20 23:07:31,139 - INFO - pnl: 2023-12-09T23:59:59.999 135318.67787294075 === -0.716%
2024-11-20 23:07:31,142 - DEBUG - cur time: 2023-12-10T23:59:59.999 == next bar open time: 2023-12-11T00:00:00.000 == close pos time: 2023-12-18T00:00:00.000
2024-11-20 23:07:31,143 - INFO - pnl: 2023-12-10T23:59:59.999 133120.6162200764 === -1.624%
2024-11-20 23:07:31,146 - DEBUG - cur time: 2023-12-11T23:59:59.999 == next bar open time: 2023-12-12T00:00:00.000 == close pos time: 2023-12-19T00:00:00.000
2024-11-20 23:07:31,147 - INFO - pnl: 2023-12-11T23:59:59.999 132373.45251000795 === -0.561%
2024-11-20 23:07:31,150 - DEBUG - cur time: 2023-12-12T23:59:59.999 == next bar open time: 2023-12-13T00:00:00.000 == close pos time: 2023-12-20T00:00:00.000
2024-11-20 23:07:31,151 - INFO - pnl: 2023-12-12T23:59:59.999 130989.6786728766 === -1.045%
2024-11-20 23:07:31,155 - DEBUG - cur time: 2023-12-13T23:59:59.999 == next bar open time: 2023-12-14T00:00:00.000 == close pos time: 2023-12-21T00:00:00.000
2024-11-20 23:07:31,156 - INFO - pnl: 2023-12-13T23:59:59.999 130858.73745501188 === -0.100%
2024-11-20 23:07:31,160 - DEBUG - cur time: 2023-12-14T23:59:59.999 == next bar open time: 2023-12-15T00:00:00.000 == close pos time: 2023-12-22T00:00:00.000
2024-11-20 23:07:31,169 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT      ┆ -1.788919    ┆ 0    ┆ 188          │
│ UNIUSDT      ┆ -1.785318    ┆ 1    ┆ 187          │
│ BNBUSDT      ┆ -1.684426    ┆ 2    ┆ 186          │
│ CYBERUSDT    ┆ -1.681643    ┆ 3    ┆ 185          │
│ NEOUSDT      ┆ -1.672932    ┆ 4    ┆ 184          │
│ MASKUSDT     ┆ -1.624122    ┆ 5    ┆ 183          │
│ SANDUSDT     ┆ -1.619271    ┆ 6    ┆ 182          │
│ EOSUSDT      ┆ -1.585694    ┆ 7    ┆ 181          │
│ BLURUSDT     ┆ -1.563297    ┆ 8    ┆ 180          │
│ QTUMUSDT     ┆ -1.550737    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RSRUSDT      ┆ 0.014174     ┆ 179  ┆ 9            │
│ ALICEUSDT    ┆ 0.09076      ┆ 180  ┆ 8            │
│ DUSKUSDT     ┆ 0.124432     ┆ 181  ┆ 7            │
│ TRUUSDT      ┆ 0.214254     ┆ 182  ┆ 6            │
│ DGBUSDT      ┆ 0.361468     ┆ 183  ┆ 5            │
│ CKBUSDT      ┆ 0.504174     ┆ 184  ┆ 4            │
│ QNTUSDT      ┆ 0.507707     ┆ 185  ┆ 3            │
│ CVXUSDT      ┆ 0.526259     ┆ 186  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.075947     ┆ 187  ┆ 1            │
│ DEFIUSDT     ┆ 1.439733     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,176 - WARNING - 2023-12-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,176 - INFO - cur close time: 2023-12-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:31,177 - DEBUG - mean expected ret (mean factor): -0.7604538681993075
2024-11-20 23:07:31,181 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,181 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,183 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03986     ┆ 0.18051     ┆ 0.0014855   ┆ … ┆ 0.02454 ┆ null   ┆ null    ┆ 0.3914  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,188 - DEBUG - update position: 2023-12-14T23:59:59.999 === diff_trading_value: 249576.42544462866 == cash: 132383.35943879592 
2024-11-20 23:07:31,189 - INFO - pnl: 2023-12-14T23:59:59.999 132383.35943879592 === 1.165%
2024-11-20 23:07:31,193 - DEBUG - cur time: 2023-12-15T23:59:59.999 == next bar open time: 2023-12-16T00:00:00.000 == close pos time: 2023-12-23T00:00:00.000
2024-11-20 23:07:31,194 - INFO - pnl: 2023-12-15T23:59:59.999 133728.26168189925 === 1.016%
2024-11-20 23:07:31,198 - DEBUG - cur time: 2023-12-16T23:59:59.999 == next bar open time: 2023-12-17T00:00:00.000 == close pos time: 2023-12-24T00:00:00.000
2024-11-20 23:07:31,199 - INFO - pnl: 2023-12-16T23:59:59.999 128620.91572487718 === -3.819%
2024-11-20 23:07:31,203 - DEBUG - cur time: 2023-12-17T23:59:59.999 == next bar open time: 2023-12-18T00:00:00.000 == close pos time: 2023-12-25T00:00:00.000
2024-11-20 23:07:31,204 - INFO - pnl: 2023-12-17T23:59:59.999 126836.05683561147 === -1.388%
2024-11-20 23:07:31,208 - DEBUG - cur time: 2023-12-18T23:59:59.999 == next bar open time: 2023-12-19T00:00:00.000 == close pos time: 2023-12-26T00:00:00.000
2024-11-20 23:07:31,209 - INFO - pnl: 2023-12-18T23:59:59.999 127481.66980797645 === 0.509%
2024-11-20 23:07:31,212 - DEBUG - cur time: 2023-12-19T23:59:59.999 == next bar open time: 2023-12-20T00:00:00.000 == close pos time: 2023-12-27T00:00:00.000
2024-11-20 23:07:31,213 - INFO - pnl: 2023-12-19T23:59:59.999 126186.64202671076 === -1.016%
2024-11-20 23:07:31,216 - DEBUG - cur time: 2023-12-20T23:59:59.999 == next bar open time: 2023-12-21T00:00:00.000 == close pos time: 2023-12-28T00:00:00.000
2024-11-20 23:07:31,218 - INFO - pnl: 2023-12-20T23:59:59.999 128974.2747186991 === 2.209%
2024-11-20 23:07:31,221 - DEBUG - cur time: 2023-12-21T23:59:59.999 == next bar open time: 2023-12-22T00:00:00.000 == close pos time: 2023-12-29T00:00:00.000
2024-11-20 23:07:31,230 - DEBUG - sorted_long_factors: shape: (189, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CYBERUSDT    ┆ -1.630554    ┆ 0    ┆ 188          │
│ COMPUSDT     ┆ -1.594933    ┆ 1    ┆ 187          │
│ TRBUSDT      ┆ -1.584608    ┆ 2    ┆ 186          │
│ NMRUSDT      ┆ -1.58202     ┆ 3    ┆ 185          │
│ SNXUSDT      ┆ -1.524258    ┆ 4    ┆ 184          │
│ APTUSDT      ┆ -1.523068    ┆ 5    ┆ 183          │
│ FILUSDT      ┆ -1.48693     ┆ 6    ┆ 182          │
│ WLDUSDT      ┆ -1.481217    ┆ 7    ┆ 181          │
│ AAVEUSDT     ┆ -1.48005     ┆ 8    ┆ 180          │
│ OPUSDT       ┆ -1.476578    ┆ 9    ┆ 179          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DEFIUSDT     ┆ 0.023653     ┆ 179  ┆ 9            │
│ DUSKUSDT     ┆ 0.044612     ┆ 180  ┆ 8            │
│ IDEXUSDT     ┆ 0.106635     ┆ 181  ┆ 7            │
│ SPELLUSDT    ┆ 0.151038     ┆ 182  ┆ 6            │
│ BTCDOMUSDT   ┆ 0.20931      ┆ 183  ┆ 5            │
│ TRUUSDT      ┆ 0.293251     ┆ 184  ┆ 4            │
│ CVXUSDT      ┆ 0.318234     ┆ 185  ┆ 3            │
│ DGBUSDT      ┆ 0.674558     ┆ 186  ┆ 2            │
│ CKBUSDT      ┆ 0.68545      ┆ 187  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.882467     ┆ 188  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,240 - WARNING - 2023-12-21T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,240 - INFO - cur close time: 2023-12-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:31,240 - DEBUG - mean expected ret (mean factor): -0.7750971041124186
2024-11-20 23:07:31,245 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,245 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,245 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03604     ┆ 0.15821     ┆ 0.0013064   ┆ … ┆ 0.02433 ┆ null   ┆ null    ┆ 0.3756  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,253 - DEBUG - update position: 2023-12-21T23:59:59.999 === diff_trading_value: 250155.78911085334 == cash: 126338.83226267497 
2024-11-20 23:07:31,255 - INFO - pnl: 2023-12-21T23:59:59.999 126338.83226267497 === -2.043%
2024-11-20 23:07:31,258 - DEBUG - cur time: 2023-12-22T23:59:59.999 == next bar open time: 2023-12-23T00:00:00.000 == close pos time: 2023-12-30T00:00:00.000
2024-11-20 23:07:31,260 - INFO - pnl: 2023-12-22T23:59:59.999 121538.22485924064 === -3.800%
2024-11-20 23:07:31,264 - DEBUG - cur time: 2023-12-23T23:59:59.999 == next bar open time: 2023-12-24T00:00:00.000 == close pos time: 2023-12-31T00:00:00.000
2024-11-20 23:07:31,265 - INFO - pnl: 2023-12-23T23:59:59.999 123630.04543726039 === 1.721%
2024-11-20 23:07:31,268 - DEBUG - cur time: 2023-12-24T23:59:59.999 == next bar open time: 2023-12-25T00:00:00.000 == close pos time: 2024-01-01T00:00:00.000
2024-11-20 23:07:31,270 - INFO - pnl: 2023-12-24T23:59:59.999 124317.67761971895 === 0.556%
2024-11-20 23:07:31,273 - DEBUG - cur time: 2023-12-25T23:59:59.999 == next bar open time: 2023-12-26T00:00:00.000 == close pos time: 2024-01-02T00:00:00.000
2024-11-20 23:07:31,275 - INFO - pnl: 2023-12-25T23:59:59.999 124275.86902045216 === -0.034%
2024-11-20 23:07:31,278 - DEBUG - cur time: 2023-12-26T23:59:59.999 == next bar open time: 2023-12-27T00:00:00.000 == close pos time: 2024-01-03T00:00:00.000
2024-11-20 23:07:31,280 - INFO - pnl: 2023-12-26T23:59:59.999 128267.43748899014 === 3.212%
2024-11-20 23:07:31,283 - DEBUG - cur time: 2023-12-27T23:59:59.999 == next bar open time: 2023-12-28T00:00:00.000 == close pos time: 2024-01-04T00:00:00.000
2024-11-20 23:07:31,284 - INFO - pnl: 2023-12-27T23:59:59.999 124789.94472523077 === -2.711%
2024-11-20 23:07:31,287 - DEBUG - cur time: 2023-12-28T23:59:59.999 == next bar open time: 2023-12-29T00:00:00.000 == close pos time: 2024-01-05T00:00:00.000
2024-11-20 23:07:31,295 - DEBUG - sorted_long_factors: shape: (190, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ FILUSDT      ┆ -1.991667    ┆ 0    ┆ 189          │
│ UNFIUSDT     ┆ -1.855806    ┆ 1    ┆ 188          │
│ CELOUSDT     ┆ -1.641479    ┆ 2    ┆ 187          │
│ ICPUSDT      ┆ -1.625195    ┆ 3    ┆ 186          │
│ CYBERUSDT    ┆ -1.585121    ┆ 4    ┆ 185          │
│ UNIUSDT      ┆ -1.535924    ┆ 5    ┆ 184          │
│ AAVEUSDT     ┆ -1.500719    ┆ 6    ┆ 183          │
│ RUNEUSDT     ┆ -1.483839    ┆ 7    ┆ 182          │
│ 1000SHIBUSDT ┆ -1.469123    ┆ 8    ┆ 181          │
│ GMTUSDT      ┆ -1.461197    ┆ 9    ┆ 180          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CTKUSDT      ┆ -0.133056    ┆ 180  ┆ 9            │
│ COTIUSDT     ┆ -0.130612    ┆ 181  ┆ 8            │
│ CKBUSDT      ┆ -0.128856    ┆ 182  ┆ 7            │
│ TUSDT        ┆ -0.099821    ┆ 183  ┆ 6            │
│ CVXUSDT      ┆ -0.075162    ┆ 184  ┆ 5            │
│ NEARUSDT     ┆ -0.074242    ┆ 185  ┆ 4            │
│ DGBUSDT      ┆ 0.296501     ┆ 186  ┆ 3            │
│ DEFIUSDT     ┆ 0.459709     ┆ 187  ┆ 2            │
│ BTCDOMUSDT   ┆ 0.859748     ┆ 188  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.883804     ┆ 189  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,301 - WARNING - 2023-12-28T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,301 - INFO - cur close time: 2023-12-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:31,303 - DEBUG - mean expected ret (mean factor): -0.7811789235059121
2024-11-20 23:07:31,307 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,307 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,307 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0355      ┆ 0.14466     ┆ 0.0013436   ┆ … ┆ 0.02579 ┆ null   ┆ null    ┆ 0.3724  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,313 - DEBUG - update position: 2023-12-28T23:59:59.999 === diff_trading_value: 277558.2223720634 == cash: 121575.07254271668 
2024-11-20 23:07:31,315 - INFO - pnl: 2023-12-28T23:59:59.999 121575.07254271668 === -2.576%
2024-11-20 23:07:31,318 - DEBUG - cur time: 2023-12-29T23:59:59.999 == next bar open time: 2023-12-30T00:00:00.000 == close pos time: 2024-01-06T00:00:00.000
2024-11-20 23:07:31,319 - INFO - pnl: 2023-12-29T23:59:59.999 123327.96785953961 === 1.442%
2024-11-20 23:07:31,323 - DEBUG - cur time: 2023-12-30T23:59:59.999 == next bar open time: 2023-12-31T00:00:00.000 == close pos time: 2024-01-07T00:00:00.000
2024-11-20 23:07:31,324 - INFO - pnl: 2023-12-30T23:59:59.999 120624.53150364291 === -2.192%
2024-11-20 23:07:31,327 - DEBUG - cur time: 2023-12-31T23:59:59.999 == next bar open time: 2024-01-01T00:00:00.000 == close pos time: 2024-01-08T00:00:00.000
2024-11-20 23:07:31,328 - INFO - pnl: 2023-12-31T23:59:59.999 116691.3676186577 === -3.261%
2024-11-20 23:07:31,331 - DEBUG - cur time: 2024-01-01T23:59:59.999 == next bar open time: 2024-01-02T00:00:00.000 == close pos time: 2024-01-09T00:00:00.000
2024-11-20 23:07:31,332 - INFO - pnl: 2024-01-01T23:59:59.999 115123.17635616347 === -1.344%
2024-11-20 23:07:31,335 - DEBUG - cur time: 2024-01-02T23:59:59.999 == next bar open time: 2024-01-03T00:00:00.000 == close pos time: 2024-01-10T00:00:00.000
2024-11-20 23:07:31,336 - INFO - pnl: 2024-01-02T23:59:59.999 113075.81450806254 === -1.778%
2024-11-20 23:07:31,339 - DEBUG - cur time: 2024-01-03T23:59:59.999 == next bar open time: 2024-01-04T00:00:00.000 == close pos time: 2024-01-11T00:00:00.000
2024-11-20 23:07:31,340 - INFO - pnl: 2024-01-03T23:59:59.999 113983.71914896068 === 0.803%
2024-11-20 23:07:31,344 - DEBUG - cur time: 2024-01-04T23:59:59.999 == next bar open time: 2024-01-05T00:00:00.000 == close pos time: 2024-01-12T00:00:00.000
2024-11-20 23:07:31,351 - DEBUG - sorted_long_factors: shape: (191, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CYBERUSDT    ┆ -2.014623    ┆ 0    ┆ 190          │
│ FILUSDT      ┆ -1.922501    ┆ 1    ┆ 189          │
│ TRBUSDT      ┆ -1.903259    ┆ 2    ┆ 188          │
│ WLDUSDT      ┆ -1.79229     ┆ 3    ┆ 187          │
│ WAVESUSDT    ┆ -1.695693    ┆ 4    ┆ 186          │
│ YGGUSDT      ┆ -1.695268    ┆ 5    ┆ 185          │
│ ARBUSDT      ┆ -1.684243    ┆ 6    ┆ 184          │
│ APTUSDT      ┆ -1.6499      ┆ 7    ┆ 183          │
│ RUNEUSDT     ┆ -1.644393    ┆ 8    ┆ 182          │
│ NMRUSDT      ┆ -1.636986    ┆ 9    ┆ 181          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RVNUSDT      ┆ 0.080551     ┆ 181  ┆ 9            │
│ DENTUSDT     ┆ 0.167907     ┆ 182  ┆ 8            │
│ TLMUSDT      ┆ 0.284769     ┆ 183  ┆ 7            │
│ DARUSDT      ┆ 0.298639     ┆ 184  ┆ 6            │
│ CVXUSDT      ┆ 0.345381     ┆ 185  ┆ 5            │
│ IDEXUSDT     ┆ 0.391585     ┆ 186  ┆ 4            │
│ DGBUSDT      ┆ 0.462872     ┆ 187  ┆ 3            │
│ COMBOUSDT    ┆ 0.488202     ┆ 188  ┆ 2            │
│ CKBUSDT      ┆ 0.754557     ┆ 189  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.068694     ┆ 190  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,356 - WARNING - 2024-01-04T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,356 - INFO - cur close time: 2024-01-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:31,356 - DEBUG - mean expected ret (mean factor): -0.7897035812716314
2024-11-20 23:07:31,361 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,361 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,361 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03245     ┆ 0.13711     ┆ 0.0012558   ┆ … ┆ 0.02375 ┆ null   ┆ null    ┆ 0.3535  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,366 - DEBUG - update position: 2024-01-04T23:59:59.999 === diff_trading_value: 240682.2524490052 == cash: 116539.62462781927 
2024-11-20 23:07:31,367 - INFO - pnl: 2024-01-04T23:59:59.999 116539.62462781927 === 2.242%
2024-11-20 23:07:31,371 - DEBUG - cur time: 2024-01-05T23:59:59.999 == next bar open time: 2024-01-06T00:00:00.000 == close pos time: 2024-01-13T00:00:00.000
2024-11-20 23:07:31,373 - INFO - pnl: 2024-01-05T23:59:59.999 118712.15590424903 === 1.864%
2024-11-20 23:07:31,375 - DEBUG - cur time: 2024-01-06T23:59:59.999 == next bar open time: 2024-01-07T00:00:00.000 == close pos time: 2024-01-14T00:00:00.000
2024-11-20 23:07:31,377 - INFO - pnl: 2024-01-06T23:59:59.999 120235.97821598797 === 1.284%
2024-11-20 23:07:31,380 - DEBUG - cur time: 2024-01-07T23:59:59.999 == next bar open time: 2024-01-08T00:00:00.000 == close pos time: 2024-01-15T00:00:00.000
2024-11-20 23:07:31,381 - INFO - pnl: 2024-01-07T23:59:59.999 119197.10200891175 === -0.864%
2024-11-20 23:07:31,383 - DEBUG - cur time: 2024-01-08T23:59:59.999 == next bar open time: 2024-01-09T00:00:00.000 == close pos time: 2024-01-16T00:00:00.000
2024-11-20 23:07:31,385 - INFO - pnl: 2024-01-08T23:59:59.999 120746.5821185926 === 1.300%
2024-11-20 23:07:31,388 - DEBUG - cur time: 2024-01-09T23:59:59.999 == next bar open time: 2024-01-10T00:00:00.000 == close pos time: 2024-01-17T00:00:00.000
2024-11-20 23:07:31,389 - INFO - pnl: 2024-01-09T23:59:59.999 119975.40611041253 === -0.639%
2024-11-20 23:07:31,391 - DEBUG - cur time: 2024-01-10T23:59:59.999 == next bar open time: 2024-01-11T00:00:00.000 == close pos time: 2024-01-18T00:00:00.000
2024-11-20 23:07:31,394 - INFO - pnl: 2024-01-10T23:59:59.999 121097.5422139036 === 0.935%
2024-11-20 23:07:31,397 - DEBUG - cur time: 2024-01-11T23:59:59.999 == next bar open time: 2024-01-12T00:00:00.000 == close pos time: 2024-01-19T00:00:00.000
2024-11-20 23:07:31,405 - DEBUG - sorted_long_factors: shape: (193, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CYBERUSDT    ┆ -2.26179     ┆ 0    ┆ 192          │
│ TRBUSDT      ┆ -2.151107    ┆ 1    ┆ 191          │
│ YGGUSDT      ┆ -1.834134    ┆ 2    ┆ 190          │
│ OPUSDT       ┆ -1.810686    ┆ 3    ┆ 189          │
│ WLDUSDT      ┆ -1.757821    ┆ 4    ┆ 188          │
│ FILUSDT      ┆ -1.753992    ┆ 5    ┆ 187          │
│ GMXUSDT      ┆ -1.682813    ┆ 6    ┆ 186          │
│ BNBUSDT      ┆ -1.675827    ┆ 7    ┆ 185          │
│ APTUSDT      ┆ -1.67278     ┆ 8    ┆ 184          │
│ WAVESUSDT    ┆ -1.650606    ┆ 9    ┆ 183          │
│ …            ┆ …            ┆ …    ┆ …            │
│ BLUEBIRDUSDT ┆ 0.365221     ┆ 183  ┆ 9            │
│ AMBUSDT      ┆ 0.372958     ┆ 184  ┆ 8            │
│ DODOXUSDT    ┆ 0.38203      ┆ 185  ┆ 7            │
│ DARUSDT      ┆ 0.393896     ┆ 186  ┆ 6            │
│ KLAYUSDT     ┆ 0.429025     ┆ 187  ┆ 5            │
│ IDEXUSDT     ┆ 0.4738       ┆ 188  ┆ 4            │
│ SPELLUSDT    ┆ 0.497904     ┆ 189  ┆ 3            │
│ DGBUSDT      ┆ 0.590639     ┆ 190  ┆ 2            │
│ CKBUSDT      ┆ 0.700478     ┆ 191  ┆ 1            │
│ DEFIUSDT     ┆ 1.215105     ┆ 192  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,411 - WARNING - 2024-01-11T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,411 - INFO - cur close time: 2024-01-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:31,411 - DEBUG - mean expected ret (mean factor): -0.7592964642698388
2024-11-20 23:07:31,415 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,415 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,416 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03237     ┆ 0.12726     ┆ 0.0013641   ┆ … ┆ 0.02294 ┆ null   ┆ null    ┆ 0.3473  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,422 - DEBUG - update position: 2024-01-11T23:59:59.999 === diff_trading_value: 136272.40480398055 == cash: 119843.8144186441 
2024-11-20 23:07:31,424 - INFO - pnl: 2024-01-11T23:59:59.999 119843.8144186441 === -1.035%
2024-11-20 23:07:31,426 - DEBUG - cur time: 2024-01-12T23:59:59.999 == next bar open time: 2024-01-13T00:00:00.000 == close pos time: 2024-01-20T00:00:00.000
2024-11-20 23:07:31,428 - INFO - pnl: 2024-01-12T23:59:59.999 117296.84685884201 === -2.125%
2024-11-20 23:07:31,431 - DEBUG - cur time: 2024-01-13T23:59:59.999 == next bar open time: 2024-01-14T00:00:00.000 == close pos time: 2024-01-21T00:00:00.000
2024-11-20 23:07:31,433 - INFO - pnl: 2024-01-13T23:59:59.999 117844.884391242 === 0.467%
2024-11-20 23:07:31,436 - DEBUG - cur time: 2024-01-14T23:59:59.999 == next bar open time: 2024-01-15T00:00:00.000 == close pos time: 2024-01-22T00:00:00.000
2024-11-20 23:07:31,438 - INFO - pnl: 2024-01-14T23:59:59.999 118614.19987337524 === 0.653%
2024-11-20 23:07:31,441 - DEBUG - cur time: 2024-01-15T23:59:59.999 == next bar open time: 2024-01-16T00:00:00.000 == close pos time: 2024-01-23T00:00:00.000
2024-11-20 23:07:31,442 - INFO - pnl: 2024-01-15T23:59:59.999 117051.88263566696 === -1.317%
2024-11-20 23:07:31,446 - DEBUG - cur time: 2024-01-16T23:59:59.999 == next bar open time: 2024-01-17T00:00:00.000 == close pos time: 2024-01-24T00:00:00.000
2024-11-20 23:07:31,447 - INFO - pnl: 2024-01-16T23:59:59.999 118731.00900531633 === 1.435%
2024-11-20 23:07:31,451 - DEBUG - cur time: 2024-01-17T23:59:59.999 == next bar open time: 2024-01-18T00:00:00.000 == close pos time: 2024-01-25T00:00:00.000
2024-11-20 23:07:31,452 - INFO - pnl: 2024-01-17T23:59:59.999 117790.498370844 === -0.792%
2024-11-20 23:07:31,458 - DEBUG - cur time: 2024-01-18T23:59:59.999 == next bar open time: 2024-01-19T00:00:00.000 == close pos time: 2024-01-26T00:00:00.000
2024-11-20 23:07:31,467 - DEBUG - sorted_long_factors: shape: (193, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ MASKUSDT     ┆ -2.037069    ┆ 0    ┆ 192          │
│ BTCDOMUSDT   ┆ -1.823995    ┆ 1    ┆ 191          │
│ WLDUSDT      ┆ -1.815903    ┆ 2    ┆ 190          │
│ HIFIUSDT     ┆ -1.715086    ┆ 3    ┆ 189          │
│ RNDRUSDT     ┆ -1.680088    ┆ 4    ┆ 188          │
│ APEUSDT      ┆ -1.66066     ┆ 5    ┆ 187          │
│ BNBUSDT      ┆ -1.605973    ┆ 6    ┆ 186          │
│ CFXUSDT      ┆ -1.559479    ┆ 7    ┆ 185          │
│ JOEUSDT      ┆ -1.532516    ┆ 8    ┆ 184          │
│ LQTYUSDT     ┆ -1.441917    ┆ 9    ┆ 183          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ANTUSDT      ┆ 0.061276     ┆ 183  ┆ 9            │
│ TRUUSDT      ┆ 0.130558     ┆ 184  ┆ 8            │
│ TLMUSDT      ┆ 0.210774     ┆ 185  ┆ 7            │
│ CTKUSDT      ┆ 0.320791     ┆ 186  ┆ 6            │
│ DODOXUSDT    ┆ 0.385438     ┆ 187  ┆ 5            │
│ BALUSDT      ┆ 0.411608     ┆ 188  ┆ 4            │
│ DGBUSDT      ┆ 0.542189     ┆ 189  ┆ 3            │
│ IDEXUSDT     ┆ 0.603835     ┆ 190  ┆ 2            │
│ DEFIUSDT     ┆ 0.928189     ┆ 191  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.316387     ┆ 192  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,473 - WARNING - 2024-01-18T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,473 - INFO - cur close time: 2024-01-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:31,473 - DEBUG - mean expected ret (mean factor): -0.7327127111253998
2024-11-20 23:07:31,478 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,478 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,479 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02928     ┆ 0.11452     ┆ 0.0011444   ┆ … ┆ 0.0215  ┆ null   ┆ null    ┆ 0.3186  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,485 - DEBUG - update position: 2024-01-18T23:59:59.999 === diff_trading_value: 247215.71069184836 == cash: 118111.37775916659 
2024-11-20 23:07:31,486 - INFO - pnl: 2024-01-18T23:59:59.999 118111.37775916659 === 0.272%
2024-11-20 23:07:31,490 - DEBUG - cur time: 2024-01-19T23:59:59.999 == next bar open time: 2024-01-20T00:00:00.000 == close pos time: 2024-01-27T00:00:00.000
2024-11-20 23:07:31,491 - INFO - pnl: 2024-01-19T23:59:59.999 120007.13054322754 === 1.605%
2024-11-20 23:07:31,494 - DEBUG - cur time: 2024-01-20T23:59:59.999 == next bar open time: 2024-01-21T00:00:00.000 == close pos time: 2024-01-28T00:00:00.000
2024-11-20 23:07:31,495 - INFO - pnl: 2024-01-20T23:59:59.999 124195.33655512214 === 3.490%
2024-11-20 23:07:31,498 - DEBUG - cur time: 2024-01-21T23:59:59.999 == next bar open time: 2024-01-22T00:00:00.000 == close pos time: 2024-01-29T00:00:00.000
2024-11-20 23:07:31,500 - INFO - pnl: 2024-01-21T23:59:59.999 124051.68718701383 === -0.116%
2024-11-20 23:07:31,503 - DEBUG - cur time: 2024-01-22T23:59:59.999 == next bar open time: 2024-01-23T00:00:00.000 == close pos time: 2024-01-30T00:00:00.000
2024-11-20 23:07:31,504 - INFO - pnl: 2024-01-22T23:59:59.999 123202.87456173071 === -0.684%
2024-11-20 23:07:31,507 - DEBUG - cur time: 2024-01-23T23:59:59.999 == next bar open time: 2024-01-24T00:00:00.000 == close pos time: 2024-01-31T00:00:00.000
2024-11-20 23:07:31,509 - INFO - pnl: 2024-01-23T23:59:59.999 121846.29243889646 === -1.101%
2024-11-20 23:07:31,512 - DEBUG - cur time: 2024-01-24T23:59:59.999 == next bar open time: 2024-01-25T00:00:00.000 == close pos time: 2024-02-01T00:00:00.000
2024-11-20 23:07:31,514 - INFO - pnl: 2024-01-24T23:59:59.999 121383.5489957313 === -0.380%
2024-11-20 23:07:31,517 - DEBUG - cur time: 2024-01-25T23:59:59.999 == next bar open time: 2024-01-26T00:00:00.000 == close pos time: 2024-02-02T00:00:00.000
2024-11-20 23:07:31,525 - DEBUG - sorted_long_factors: shape: (197, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ CFXUSDT      ┆ -1.842832    ┆ 0    ┆ 196          │
│ NMRUSDT      ┆ -1.800174    ┆ 1    ┆ 195          │
│ APEUSDT      ┆ -1.665884    ┆ 2    ┆ 194          │
│ ARKMUSDT     ┆ -1.577967    ┆ 3    ┆ 193          │
│ ARKUSDT      ┆ -1.546991    ┆ 4    ┆ 192          │
│ FOOTBALLUSDT ┆ -1.507073    ┆ 5    ┆ 191          │
│ SUSHIUSDT    ┆ -1.486959    ┆ 6    ┆ 190          │
│ COMPUSDT     ┆ -1.434811    ┆ 7    ┆ 189          │
│ CYBERUSDT    ┆ -1.389238    ┆ 8    ┆ 188          │
│ NEOUSDT      ┆ -1.381171    ┆ 9    ┆ 187          │
│ …            ┆ …            ┆ …    ┆ …            │
│ KEYUSDT      ┆ -0.041495    ┆ 187  ┆ 9            │
│ TRUUSDT      ┆ -0.003848    ┆ 188  ┆ 8            │
│ DASHUSDT     ┆ 0.000828     ┆ 189  ┆ 7            │
│ ANTUSDT      ┆ 0.014864     ┆ 190  ┆ 6            │
│ CTKUSDT      ┆ 0.028779     ┆ 191  ┆ 5            │
│ TLMUSDT      ┆ 0.226809     ┆ 192  ┆ 4            │
│ DGBUSDT      ┆ 0.46063      ┆ 193  ┆ 3            │
│ DODOXUSDT    ┆ 0.539154     ┆ 194  ┆ 2            │
│ DEFIUSDT     ┆ 0.557901     ┆ 195  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.181039     ┆ 196  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,530 - WARNING - 2024-01-25T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,530 - INFO - cur close time: 2024-01-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:31,531 - DEBUG - mean expected ret (mean factor): -0.7600549648907508
2024-11-20 23:07:31,535 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,536 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,536 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0283      ┆ 0.09318     ┆ 0.0010279   ┆ … ┆ 0.01993 ┆ null   ┆ null    ┆ 0.3029  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,542 - DEBUG - update position: 2024-01-25T23:59:59.999 === diff_trading_value: 220769.28582769947 == cash: 121083.86907077048 
2024-11-20 23:07:31,543 - INFO - pnl: 2024-01-25T23:59:59.999 121083.86907077048 === -0.247%
2024-11-20 23:07:31,547 - DEBUG - cur time: 2024-01-26T23:59:59.999 == next bar open time: 2024-01-27T00:00:00.000 == close pos time: 2024-02-03T00:00:00.000
2024-11-20 23:07:31,549 - INFO - pnl: 2024-01-26T23:59:59.999 120118.62123623764 === -0.797%
2024-11-20 23:07:31,553 - DEBUG - cur time: 2024-01-27T23:59:59.999 == next bar open time: 2024-01-28T00:00:00.000 == close pos time: 2024-02-04T00:00:00.000
2024-11-20 23:07:31,554 - INFO - pnl: 2024-01-27T23:59:59.999 121560.68735887877 === 1.201%
2024-11-20 23:07:31,558 - DEBUG - cur time: 2024-01-28T23:59:59.999 == next bar open time: 2024-01-29T00:00:00.000 == close pos time: 2024-02-05T00:00:00.000
2024-11-20 23:07:31,559 - INFO - pnl: 2024-01-28T23:59:59.999 119969.68721076818 === -1.309%
2024-11-20 23:07:31,563 - DEBUG - cur time: 2024-01-29T23:59:59.999 == next bar open time: 2024-01-30T00:00:00.000 == close pos time: 2024-02-06T00:00:00.000
2024-11-20 23:07:31,564 - INFO - pnl: 2024-01-29T23:59:59.999 119522.24427426467 === -0.373%
2024-11-20 23:07:31,567 - DEBUG - cur time: 2024-01-30T23:59:59.999 == next bar open time: 2024-01-31T00:00:00.000 == close pos time: 2024-02-07T00:00:00.000
2024-11-20 23:07:31,568 - INFO - pnl: 2024-01-30T23:59:59.999 119361.23354404925 === -0.135%
2024-11-20 23:07:31,571 - DEBUG - cur time: 2024-01-31T23:59:59.999 == next bar open time: 2024-02-01T00:00:00.000 == close pos time: 2024-02-08T00:00:00.000
2024-11-20 23:07:31,573 - INFO - pnl: 2024-01-31T23:59:59.999 120694.70413618312 === 1.117%
2024-11-20 23:07:31,575 - DEBUG - cur time: 2024-02-01T23:59:59.999 == next bar open time: 2024-02-02T00:00:00.000 == close pos time: 2024-02-09T00:00:00.000
2024-11-20 23:07:31,583 - DEBUG - sorted_long_factors: shape: (202, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ XMRUSDT      ┆ -1.95265     ┆ 0    ┆ 201          │
│ NEOUSDT      ┆ -1.937414    ┆ 1    ┆ 200          │
│ WLDUSDT      ┆ -1.881179    ┆ 2    ┆ 199          │
│ RNDRUSDT     ┆ -1.859953    ┆ 3    ┆ 198          │
│ EGLDUSDT     ┆ -1.779059    ┆ 4    ┆ 197          │
│ BONDUSDT     ┆ -1.709322    ┆ 5    ┆ 196          │
│ DYDXUSDT     ┆ -1.683867    ┆ 6    ┆ 195          │
│ MAGICUSDT    ┆ -1.618439    ┆ 7    ┆ 194          │
│ MINAUSDT     ┆ -1.588296    ┆ 8    ┆ 193          │
│ BIGTIMEUSDT  ┆ -1.584796    ┆ 9    ┆ 192          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TRUUSDT      ┆ -0.004315    ┆ 192  ┆ 9            │
│ IDEXUSDT     ┆ 0.028715     ┆ 193  ┆ 8            │
│ FETUSDT      ┆ 0.053704     ┆ 194  ┆ 7            │
│ TLMUSDT      ┆ 0.124598     ┆ 195  ┆ 6            │
│ QNTUSDT      ┆ 0.18369      ┆ 196  ┆ 5            │
│ CVXUSDT      ┆ 0.263896     ┆ 197  ┆ 4            │
│ DGBUSDT      ┆ 0.323447     ┆ 198  ┆ 3            │
│ BTCDOMUSDT   ┆ 0.727702     ┆ 199  ┆ 2            │
│ DODOXUSDT    ┆ 0.964234     ┆ 200  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.473554     ┆ 201  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,590 - WARNING - 2024-02-01T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,590 - INFO - cur close time: 2024-02-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:31,591 - DEBUG - mean expected ret (mean factor): -0.783243089135326
2024-11-20 23:07:31,594 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,594 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,595 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.02819     ┆ 0.09527     ┆ 0.0009174   ┆ … ┆ 0.02024 ┆ null   ┆ null    ┆ 0.3202  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,600 - DEBUG - update position: 2024-02-01T23:59:59.999 === diff_trading_value: 288214.39822790696 == cash: 119744.06356174756 
2024-11-20 23:07:31,602 - INFO - pnl: 2024-02-01T23:59:59.999 119744.06356174756 === -0.788%
2024-11-20 23:07:31,604 - DEBUG - cur time: 2024-02-02T23:59:59.999 == next bar open time: 2024-02-03T00:00:00.000 == close pos time: 2024-02-10T00:00:00.000
2024-11-20 23:07:31,605 - INFO - pnl: 2024-02-02T23:59:59.999 117701.80189895586 === -1.706%
2024-11-20 23:07:31,608 - DEBUG - cur time: 2024-02-03T23:59:59.999 == next bar open time: 2024-02-04T00:00:00.000 == close pos time: 2024-02-11T00:00:00.000
2024-11-20 23:07:31,610 - INFO - pnl: 2024-02-03T23:59:59.999 118452.37974760933 === 0.638%
2024-11-20 23:07:31,613 - DEBUG - cur time: 2024-02-04T23:59:59.999 == next bar open time: 2024-02-05T00:00:00.000 == close pos time: 2024-02-12T00:00:00.000
2024-11-20 23:07:31,614 - INFO - pnl: 2024-02-04T23:59:59.999 119015.48578864596 === 0.475%
2024-11-20 23:07:31,617 - DEBUG - cur time: 2024-02-05T23:59:59.999 == next bar open time: 2024-02-06T00:00:00.000 == close pos time: 2024-02-13T00:00:00.000
2024-11-20 23:07:31,618 - INFO - pnl: 2024-02-05T23:59:59.999 118876.44015646804 === -0.117%
2024-11-20 23:07:31,621 - DEBUG - cur time: 2024-02-06T23:59:59.999 == next bar open time: 2024-02-07T00:00:00.000 == close pos time: 2024-02-14T00:00:00.000
2024-11-20 23:07:31,623 - INFO - pnl: 2024-02-06T23:59:59.999 124333.843015978 === 4.591%
2024-11-20 23:07:31,626 - DEBUG - cur time: 2024-02-07T23:59:59.999 == next bar open time: 2024-02-08T00:00:00.000 == close pos time: 2024-02-15T00:00:00.000
2024-11-20 23:07:31,627 - INFO - pnl: 2024-02-07T23:59:59.999 123673.99677863962 === -0.531%
2024-11-20 23:07:31,630 - DEBUG - cur time: 2024-02-08T23:59:59.999 == next bar open time: 2024-02-09T00:00:00.000 == close pos time: 2024-02-16T00:00:00.000
2024-11-20 23:07:31,638 - DEBUG - sorted_long_factors: shape: (205, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ NMRUSDT      ┆ -2.003783    ┆ 0    ┆ 204          │
│ SEIUSDT      ┆ -1.977543    ┆ 1    ┆ 203          │
│ WLDUSDT      ┆ -1.895256    ┆ 2    ┆ 202          │
│ TRBUSDT      ┆ -1.869266    ┆ 3    ┆ 201          │
│ UMAUSDT      ┆ -1.826561    ┆ 4    ┆ 200          │
│ EGLDUSDT     ┆ -1.81428     ┆ 5    ┆ 199          │
│ BSVUSDT      ┆ -1.783708    ┆ 6    ┆ 198          │
│ AXSUSDT      ┆ -1.756853    ┆ 7    ┆ 197          │
│ GASUSDT      ┆ -1.719041    ┆ 8    ┆ 196          │
│ NEARUSDT     ┆ -1.645263    ┆ 9    ┆ 195          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RVNUSDT      ┆ 0.202245     ┆ 195  ┆ 9            │
│ DASHUSDT     ┆ 0.213665     ┆ 196  ┆ 8            │
│ KEYUSDT      ┆ 0.262646     ┆ 197  ┆ 7            │
│ TRUUSDT      ┆ 0.29012      ┆ 198  ┆ 6            │
│ ATAUSDT      ┆ 0.312481     ┆ 199  ┆ 5            │
│ DODOXUSDT    ┆ 0.431197     ┆ 200  ┆ 4            │
│ IDEXUSDT     ┆ 0.532905     ┆ 201  ┆ 3            │
│ XVGUSDT      ┆ 0.561048     ┆ 202  ┆ 2            │
│ DGBUSDT      ┆ 0.71572      ┆ 203  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.005031     ┆ 204  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,646 - INFO - cur close time: 2024-02-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:31,646 - DEBUG - mean expected ret (mean factor): -0.7646525986771691
2024-11-20 23:07:31,651 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,651 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,651 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.0288      ┆ 0.10738     ┆ 0.0009554   ┆ … ┆ 0.0204  ┆ null   ┆ null    ┆ 0.3163  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,657 - DEBUG - update position: 2024-02-08T23:59:59.999 === diff_trading_value: 252131.61014942796 == cash: 124174.71221643953 
2024-11-20 23:07:31,659 - INFO - pnl: 2024-02-08T23:59:59.999 124174.71221643953 === 0.405%
2024-11-20 23:07:31,661 - DEBUG - cur time: 2024-02-09T23:59:59.999 == next bar open time: 2024-02-10T00:00:00.000 == close pos time: 2024-02-17T00:00:00.000
2024-11-20 23:07:31,664 - INFO - pnl: 2024-02-09T23:59:59.999 124951.10581816769 === 0.625%
2024-11-20 23:07:31,667 - DEBUG - cur time: 2024-02-10T23:59:59.999 == next bar open time: 2024-02-11T00:00:00.000 == close pos time: 2024-02-18T00:00:00.000
2024-11-20 23:07:31,668 - INFO - pnl: 2024-02-10T23:59:59.999 125130.66937879976 === 0.144%
2024-11-20 23:07:31,672 - DEBUG - cur time: 2024-02-11T23:59:59.999 == next bar open time: 2024-02-12T00:00:00.000 == close pos time: 2024-02-19T00:00:00.000
2024-11-20 23:07:31,673 - INFO - pnl: 2024-02-11T23:59:59.999 124480.52043672744 === -0.520%
2024-11-20 23:07:31,677 - DEBUG - cur time: 2024-02-12T23:59:59.999 == next bar open time: 2024-02-13T00:00:00.000 == close pos time: 2024-02-20T00:00:00.000
2024-11-20 23:07:31,678 - INFO - pnl: 2024-02-12T23:59:59.999 121994.7294883062 === -1.997%
2024-11-20 23:07:31,681 - DEBUG - cur time: 2024-02-13T23:59:59.999 == next bar open time: 2024-02-14T00:00:00.000 == close pos time: 2024-02-21T00:00:00.000
2024-11-20 23:07:31,683 - INFO - pnl: 2024-02-13T23:59:59.999 124666.8982431312 === 2.190%
2024-11-20 23:07:31,686 - DEBUG - cur time: 2024-02-14T23:59:59.999 == next bar open time: 2024-02-15T00:00:00.000 == close pos time: 2024-02-22T00:00:00.000
2024-11-20 23:07:31,688 - INFO - pnl: 2024-02-14T23:59:59.999 123098.01005388005 === -1.258%
2024-11-20 23:07:31,691 - DEBUG - cur time: 2024-02-15T23:59:59.999 == next bar open time: 2024-02-16T00:00:00.000 == close pos time: 2024-02-23T00:00:00.000
2024-11-20 23:07:31,699 - DEBUG - sorted_long_factors: shape: (212, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT      ┆ -1.835494    ┆ 0    ┆ 211          │
│ FXSUSDT      ┆ -1.807527    ┆ 1    ┆ 210          │
│ FILUSDT      ┆ -1.736698    ┆ 2    ┆ 209          │
│ SEIUSDT      ┆ -1.667582    ┆ 3    ┆ 208          │
│ GASUSDT      ┆ -1.661671    ┆ 4    ┆ 207          │
│ MASKUSDT     ┆ -1.642856    ┆ 5    ┆ 206          │
│ COMPUSDT     ┆ -1.64108     ┆ 6    ┆ 205          │
│ BNBUSDT      ┆ -1.628488    ┆ 7    ┆ 204          │
│ DOTUSDT      ┆ -1.610894    ┆ 8    ┆ 203          │
│ APEUSDT      ┆ -1.610411    ┆ 9    ┆ 202          │
│ …            ┆ …            ┆ …    ┆ …            │
│ REEFUSDT     ┆ 0.059015     ┆ 202  ┆ 9            │
│ GMXUSDT      ┆ 0.095259     ┆ 203  ┆ 8            │
│ NKNUSDT      ┆ 0.123412     ┆ 204  ┆ 7            │
│ TRUUSDT      ┆ 0.148995     ┆ 205  ┆ 6            │
│ ATAUSDT      ┆ 0.363632     ┆ 206  ┆ 5            │
│ COMBOUSDT    ┆ 0.489184     ┆ 207  ┆ 4            │
│ DGBUSDT      ┆ 0.740731     ┆ 208  ┆ 3            │
│ XVGUSDT      ┆ 0.837536     ┆ 209  ┆ 2            │
│ DEFIUSDT     ┆ 1.542351     ┆ 210  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.222528     ┆ 211  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,705 - WARNING - 2024-02-15T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,705 - INFO - cur close time: 2024-02-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:31,705 - DEBUG - mean expected ret (mean factor): -0.7838741279904096
2024-11-20 23:07:31,709 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,710 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,710 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03392     ┆ 0.13038     ┆ 0.0012451   ┆ … ┆ 0.02282 ┆ null   ┆ null    ┆ 0.3412  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,715 - DEBUG - update position: 2024-02-15T23:59:59.999 === diff_trading_value: 255095.15187129372 == cash: 122091.06053938456 
2024-11-20 23:07:31,717 - INFO - pnl: 2024-02-15T23:59:59.999 122091.06053938456 === -0.818%
2024-11-20 23:07:31,720 - DEBUG - cur time: 2024-02-16T23:59:59.999 == next bar open time: 2024-02-17T00:00:00.000 == close pos time: 2024-02-24T00:00:00.000
2024-11-20 23:07:31,721 - INFO - pnl: 2024-02-16T23:59:59.999 122465.95088150239 === 0.307%
2024-11-20 23:07:31,725 - DEBUG - cur time: 2024-02-17T23:59:59.999 == next bar open time: 2024-02-18T00:00:00.000 == close pos time: 2024-02-25T00:00:00.000
2024-11-20 23:07:31,726 - INFO - pnl: 2024-02-17T23:59:59.999 124068.75522122145 === 1.309%
2024-11-20 23:07:31,730 - DEBUG - cur time: 2024-02-18T23:59:59.999 == next bar open time: 2024-02-19T00:00:00.000 == close pos time: 2024-02-26T00:00:00.000
2024-11-20 23:07:31,731 - INFO - pnl: 2024-02-18T23:59:59.999 128024.1332146292 === 3.188%
2024-11-20 23:07:31,733 - DEBUG - cur time: 2024-02-19T23:59:59.999 == next bar open time: 2024-02-20T00:00:00.000 == close pos time: 2024-02-27T00:00:00.000
2024-11-20 23:07:31,735 - INFO - pnl: 2024-02-19T23:59:59.999 125751.53767559747 === -1.775%
2024-11-20 23:07:31,738 - DEBUG - cur time: 2024-02-20T23:59:59.999 == next bar open time: 2024-02-21T00:00:00.000 == close pos time: 2024-02-28T00:00:00.000
2024-11-20 23:07:31,740 - INFO - pnl: 2024-02-20T23:59:59.999 124433.51542260931 === -1.048%
2024-11-20 23:07:31,745 - DEBUG - cur time: 2024-02-21T23:59:59.999 == next bar open time: 2024-02-22T00:00:00.000 == close pos time: 2024-02-29T00:00:00.000
2024-11-20 23:07:31,746 - INFO - pnl: 2024-02-21T23:59:59.999 126662.2198100575 === 1.791%
2024-11-20 23:07:31,749 - DEBUG - cur time: 2024-02-22T23:59:59.999 == next bar open time: 2024-02-23T00:00:00.000 == close pos time: 2024-03-01T00:00:00.000
2024-11-20 23:07:31,757 - DEBUG - sorted_long_factors: shape: (216, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ KSMUSDT      ┆ -1.693601    ┆ 0    ┆ 215          │
│ BSVUSDT      ┆ -1.674589    ┆ 1    ┆ 214          │
│ EOSUSDT      ┆ -1.620774    ┆ 2    ┆ 213          │
│ MASKUSDT     ┆ -1.610975    ┆ 3    ┆ 212          │
│ DOTUSDT      ┆ -1.605906    ┆ 4    ┆ 211          │
│ GASUSDT      ┆ -1.574847    ┆ 5    ┆ 210          │
│ MATICUSDT    ┆ -1.556749    ┆ 6    ┆ 209          │
│ NEARUSDT     ┆ -1.530812    ┆ 7    ┆ 208          │
│ WLDUSDT      ┆ -1.530804    ┆ 8    ┆ 207          │
│ BNBUSDT      ┆ -1.526295    ┆ 9    ┆ 206          │
│ …            ┆ …            ┆ …    ┆ …            │
│ XVGUSDT      ┆ -0.02611     ┆ 206  ┆ 9            │
│ LEVERUSDT    ┆ -0.023868    ┆ 207  ┆ 8            │
│ TLMUSDT      ┆ 0.112637     ┆ 208  ┆ 7            │
│ SPELLUSDT    ┆ 0.1201       ┆ 209  ┆ 6            │
│ COMBOUSDT    ┆ 0.136054     ┆ 210  ┆ 5            │
│ BTCDOMUSDT   ┆ 0.234901     ┆ 211  ┆ 4            │
│ CTKUSDT      ┆ 0.272371     ┆ 212  ┆ 3            │
│ DGBUSDT      ┆ 0.480454     ┆ 213  ┆ 2            │
│ DEFIUSDT     ┆ 1.374735     ┆ 214  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.04014      ┆ 215  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,762 - WARNING - 2024-02-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,762 - INFO - cur close time: 2024-02-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:31,762 - DEBUG - mean expected ret (mean factor): -0.7804733582489563
2024-11-20 23:07:31,766 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,766 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,767 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.03365     ┆ 0.12141     ┆ 0.0012105   ┆ … ┆ 0.02339 ┆ null   ┆ null    ┆ 0.3528  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,775 - DEBUG - update position: 2024-02-22T23:59:59.999 === diff_trading_value: 235316.72990338574 == cash: 129952.23695547506 
2024-11-20 23:07:31,777 - INFO - pnl: 2024-02-22T23:59:59.999 129952.23695547506 === 2.597%
2024-11-20 23:07:31,780 - DEBUG - cur time: 2024-02-23T23:59:59.999 == next bar open time: 2024-02-24T00:00:00.000 == close pos time: 2024-03-02T00:00:00.000
2024-11-20 23:07:31,782 - INFO - pnl: 2024-02-23T23:59:59.999 128444.89887548896 === -1.160%
2024-11-20 23:07:31,784 - DEBUG - cur time: 2024-02-24T23:59:59.999 == next bar open time: 2024-02-25T00:00:00.000 == close pos time: 2024-03-03T00:00:00.000
2024-11-20 23:07:31,786 - INFO - pnl: 2024-02-24T23:59:59.999 130252.83934154498 === 1.408%
2024-11-20 23:07:31,790 - DEBUG - cur time: 2024-02-25T23:59:59.999 == next bar open time: 2024-02-26T00:00:00.000 == close pos time: 2024-03-04T00:00:00.000
2024-11-20 23:07:31,791 - INFO - pnl: 2024-02-25T23:59:59.999 136354.03433433964 === 4.684%
2024-11-20 23:07:31,796 - DEBUG - cur time: 2024-02-26T23:59:59.999 == next bar open time: 2024-02-27T00:00:00.000 == close pos time: 2024-03-05T00:00:00.000
2024-11-20 23:07:31,797 - INFO - pnl: 2024-02-26T23:59:59.999 137874.99768064517 === 1.115%
2024-11-20 23:07:31,800 - DEBUG - cur time: 2024-02-27T23:59:59.999 == next bar open time: 2024-02-28T00:00:00.000 == close pos time: 2024-03-06T00:00:00.000
2024-11-20 23:07:31,802 - INFO - pnl: 2024-02-27T23:59:59.999 138377.7924604716 === 0.365%
2024-11-20 23:07:31,806 - DEBUG - cur time: 2024-02-28T23:59:59.999 == next bar open time: 2024-02-29T00:00:00.000 == close pos time: 2024-03-07T00:00:00.000
2024-11-20 23:07:31,807 - INFO - pnl: 2024-02-28T23:59:59.999 139859.38455557957 === 1.071%
2024-11-20 23:07:31,810 - DEBUG - cur time: 2024-02-29T23:59:59.999 == next bar open time: 2024-03-01T00:00:00.000 == close pos time: 2024-03-08T00:00:00.000
2024-11-20 23:07:31,821 - DEBUG - sorted_long_factors: shape: (220, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ARBUSDT      ┆ -1.817902    ┆ 0    ┆ 219          │
│ GASUSDT      ┆ -1.801337    ┆ 1    ┆ 218          │
│ AXSUSDT      ┆ -1.791146    ┆ 2    ┆ 217          │
│ EOSUSDT      ┆ -1.728798    ┆ 3    ┆ 216          │
│ EGLDUSDT     ┆ -1.712225    ┆ 4    ┆ 215          │
│ ORDIUSDT     ┆ -1.698864    ┆ 5    ┆ 214          │
│ TRBUSDT      ┆ -1.677601    ┆ 6    ┆ 213          │
│ CYBERUSDT    ┆ -1.644232    ┆ 7    ┆ 212          │
│ BSVUSDT      ┆ -1.637542    ┆ 8    ┆ 211          │
│ APEUSDT      ┆ -1.622484    ┆ 9    ┆ 210          │
│ …            ┆ …            ┆ …    ┆ …            │
│ TLMUSDT      ┆ -0.018311    ┆ 210  ┆ 9            │
│ DODOXUSDT    ┆ 0.088744     ┆ 211  ┆ 8            │
│ CTKUSDT      ┆ 0.097621     ┆ 212  ┆ 7            │
│ REEFUSDT     ┆ 0.206065     ┆ 213  ┆ 6            │
│ RSRUSDT      ┆ 0.226884     ┆ 214  ┆ 5            │
│ FOOTBALLUSDT ┆ 0.301507     ┆ 215  ┆ 4            │
│ DGBUSDT      ┆ 0.381882     ┆ 216  ┆ 3            │
│ BTCDOMUSDT   ┆ 0.439519     ┆ 217  ┆ 2            │
│ DEFIUSDT     ┆ 0.663666     ┆ 218  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.303543     ┆ 219  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,828 - WARNING - 2024-02-29T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,829 - INFO - cur close time: 2024-02-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:31,829 - DEBUG - mean expected ret (mean factor): -0.7710443040553607
2024-11-20 23:07:31,833 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,833 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,833 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ 0.05379     ┆ 0.1397      ┆ 0.0027367   ┆ … ┆ 0.02782 ┆ null   ┆ null    ┆ 0.3811  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,838 - DEBUG - update position: 2024-02-29T23:59:59.999 === diff_trading_value: 274892.8374686842 == cash: 142957.2354576842 
2024-11-20 23:07:31,839 - INFO - pnl: 2024-02-29T23:59:59.999 142957.2354576842 === 2.215%
2024-11-20 23:07:31,841 - DEBUG - cur time: 2024-03-01T23:59:59.999 == next bar open time: 2024-03-02T00:00:00.000 == close pos time: 2024-03-09T00:00:00.000
2024-11-20 23:07:31,843 - INFO - pnl: 2024-03-01T23:59:59.999 142582.3835072553 === -0.262%
2024-11-20 23:07:31,846 - DEBUG - cur time: 2024-03-02T23:59:59.999 == next bar open time: 2024-03-03T00:00:00.000 == close pos time: 2024-03-10T00:00:00.000
2024-11-20 23:07:31,847 - INFO - pnl: 2024-03-02T23:59:59.999 136781.13577274038 === -4.069%
2024-11-20 23:07:31,850 - DEBUG - cur time: 2024-03-03T23:59:59.999 == next bar open time: 2024-03-04T00:00:00.000 == close pos time: 2024-03-11T00:00:00.000
2024-11-20 23:07:31,851 - INFO - pnl: 2024-03-03T23:59:59.999 139578.1516298412 === 2.045%
2024-11-20 23:07:31,853 - DEBUG - cur time: 2024-03-04T23:59:59.999 == next bar open time: 2024-03-05T00:00:00.000 == close pos time: 2024-03-12T00:00:00.000
2024-11-20 23:07:31,854 - INFO - pnl: 2024-03-04T23:59:59.999 140460.4237523737 === 0.632%
2024-11-20 23:07:31,859 - DEBUG - cur time: 2024-03-05T23:59:59.999 == next bar open time: 2024-03-06T00:00:00.000 == close pos time: 2024-03-13T00:00:00.000
2024-11-20 23:07:31,860 - INFO - pnl: 2024-03-05T23:59:59.999 141815.9004733729 === 0.965%
2024-11-20 23:07:31,863 - DEBUG - cur time: 2024-03-06T23:59:59.999 == next bar open time: 2024-03-07T00:00:00.000 == close pos time: 2024-03-14T00:00:00.000
2024-11-20 23:07:31,864 - INFO - pnl: 2024-03-06T23:59:59.999 146205.7521616674 === 3.095%
2024-11-20 23:07:31,866 - DEBUG - cur time: 2024-03-07T23:59:59.999 == next bar open time: 2024-03-08T00:00:00.000 == close pos time: 2024-03-15T00:00:00.000
2024-11-20 23:07:31,875 - DEBUG - sorted_long_factors: shape: (225, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT     ┆ -2.173388    ┆ 0    ┆ 224          │
│ GASUSDT      ┆ -1.812059    ┆ 1    ┆ 223          │
│ ILVUSDT      ┆ -1.762015    ┆ 2    ┆ 222          │
│ YFIUSDT      ┆ -1.722068    ┆ 3    ┆ 221          │
│ BSVUSDT      ┆ -1.655418    ┆ 4    ┆ 220          │
│ EGLDUSDT     ┆ -1.654698    ┆ 5    ┆ 219          │
│ TIAUSDT      ┆ -1.648099    ┆ 6    ┆ 218          │
│ STXUSDT      ┆ -1.625022    ┆ 7    ┆ 217          │
│ WAVESUSDT    ┆ -1.585854    ┆ 8    ┆ 216          │
│ NEOUSDT      ┆ -1.574313    ┆ 9    ┆ 215          │
│ …            ┆ …            ┆ …    ┆ …            │
│ RENUSDT      ┆ -0.118523    ┆ 215  ┆ 9            │
│ ARKMUSDT     ┆ -0.089342    ┆ 216  ┆ 8            │
│ BTCDOMUSDT   ┆ -0.07806     ┆ 217  ┆ 7            │
│ DODOXUSDT    ┆ 0.071827     ┆ 218  ┆ 6            │
│ FOOTBALLUSDT ┆ 0.121318     ┆ 219  ┆ 5            │
│ DGBUSDT      ┆ 0.2386       ┆ 220  ┆ 4            │
│ OXTUSDT      ┆ 0.325867     ┆ 221  ┆ 3            │
│ IDEXUSDT     ┆ 0.650359     ┆ 222  ┆ 2            │
│ DEFIUSDT     ┆ 1.480987     ┆ 223  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.606026     ┆ 224  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,880 - WARNING - 2024-03-07T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,880 - INFO - cur close time: 2024-03-07T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:31,880 - DEBUG - mean expected ret (mean factor): -0.7734666707683441
2024-11-20 23:07:31,883 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,883 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,884 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.027063    ┆ 0.13968     ┆ 0.19065     ┆ 0.0068157   ┆ … ┆ 0.03544 ┆ null   ┆ null    ┆ 0.5161  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,890 - DEBUG - update position: 2024-03-07T23:59:59.999 === diff_trading_value: 236529.80194553707 == cash: 144134.9533837108 
2024-11-20 23:07:31,891 - INFO - pnl: 2024-03-07T23:59:59.999 144134.9533837108 === -1.416%
2024-11-20 23:07:31,895 - DEBUG - cur time: 2024-03-08T23:59:59.999 == next bar open time: 2024-03-09T00:00:00.000 == close pos time: 2024-03-16T00:00:00.000
2024-11-20 23:07:31,896 - INFO - pnl: 2024-03-08T23:59:59.999 145506.5709746497 === 0.952%
2024-11-20 23:07:31,899 - DEBUG - cur time: 2024-03-09T23:59:59.999 == next bar open time: 2024-03-10T00:00:00.000 == close pos time: 2024-03-17T00:00:00.000
2024-11-20 23:07:31,900 - INFO - pnl: 2024-03-09T23:59:59.999 147490.85216762446 === 1.364%
2024-11-20 23:07:31,903 - DEBUG - cur time: 2024-03-10T23:59:59.999 == next bar open time: 2024-03-11T00:00:00.000 == close pos time: 2024-03-18T00:00:00.000
2024-11-20 23:07:31,905 - INFO - pnl: 2024-03-10T23:59:59.999 148649.50258076758 === 0.786%
2024-11-20 23:07:31,908 - DEBUG - cur time: 2024-03-11T23:59:59.999 == next bar open time: 2024-03-12T00:00:00.000 == close pos time: 2024-03-19T00:00:00.000
2024-11-20 23:07:31,910 - INFO - pnl: 2024-03-11T23:59:59.999 151913.57153994968 === 2.196%
2024-11-20 23:07:31,913 - DEBUG - cur time: 2024-03-12T23:59:59.999 == next bar open time: 2024-03-13T00:00:00.000 == close pos time: 2024-03-20T00:00:00.000
2024-11-20 23:07:31,915 - INFO - pnl: 2024-03-12T23:59:59.999 153399.54399114492 === 0.978%
2024-11-20 23:07:31,918 - DEBUG - cur time: 2024-03-13T23:59:59.999 == next bar open time: 2024-03-14T00:00:00.000 == close pos time: 2024-03-21T00:00:00.000
2024-11-20 23:07:31,920 - INFO - pnl: 2024-03-13T23:59:59.999 151346.08836513048 === -1.339%
2024-11-20 23:07:31,923 - DEBUG - cur time: 2024-03-14T23:59:59.999 == next bar open time: 2024-03-15T00:00:00.000 == close pos time: 2024-03-22T00:00:00.000
2024-11-20 23:07:31,931 - DEBUG - sorted_long_factors: shape: (225, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ ORDIUSDT     ┆ -2.15082     ┆ 0    ┆ 224          │
│ TRBUSDT      ┆ -2.133034    ┆ 1    ┆ 223          │
│ GASUSDT      ┆ -1.954938    ┆ 2    ┆ 222          │
│ BSVUSDT      ┆ -1.564035    ┆ 3    ┆ 221          │
│ CAKEUSDT     ┆ -1.537011    ┆ 4    ┆ 220          │
│ TIAUSDT      ┆ -1.528995    ┆ 5    ┆ 219          │
│ STXUSDT      ┆ -1.523406    ┆ 6    ┆ 218          │
│ EGLDUSDT     ┆ -1.515923    ┆ 7    ┆ 217          │
│ MEMEUSDT     ┆ -1.513553    ┆ 8    ┆ 216          │
│ MKRUSDT      ┆ -1.509342    ┆ 9    ┆ 215          │
│ …            ┆ …            ┆ …    ┆ …            │
│ GALUSDT      ┆ -0.109359    ┆ 215  ┆ 9            │
│ CVXUSDT      ┆ -0.069987    ┆ 216  ┆ 8            │
│ PENDLEUSDT   ┆ -0.065565    ┆ 217  ┆ 7            │
│ COMBOUSDT    ┆ 0.050537     ┆ 218  ┆ 6            │
│ AAVEUSDT     ┆ 0.126211     ┆ 219  ┆ 5            │
│ BALUSDT      ┆ 0.393007     ┆ 220  ┆ 4            │
│ ANTUSDT      ┆ 0.644054     ┆ 221  ┆ 3            │
│ IDEXUSDT     ┆ 0.82629      ┆ 222  ┆ 2            │
│ DEFIUSDT     ┆ 2.060196     ┆ 223  ┆ 1            │
│ BLUEBIRDUSDT ┆ 2.523513     ┆ 224  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:31,939 - WARNING - 2024-03-14T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:31,939 - INFO - cur close time: 2024-03-14T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:31,940 - DEBUG - mean expected ret (mean factor): -0.7792670605285779
2024-11-20 23:07:31,946 - DEBUG - begin to update pos: =========
2024-11-20 23:07:31,946 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,946 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.034127    ┆ 0.27812     ┆ 0.17538     ┆ 0.0099683   ┆ … ┆ 0.03943 ┆ null   ┆ null    ┆ 1.3411  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:31,951 - DEBUG - update position: 2024-03-14T23:59:59.999 === diff_trading_value: 241389.01361236465 == cash: 153899.52378634585 
2024-11-20 23:07:31,953 - INFO - pnl: 2024-03-14T23:59:59.999 153899.52378634585 === 1.687%
2024-11-20 23:07:31,956 - DEBUG - cur time: 2024-03-15T23:59:59.999 == next bar open time: 2024-03-16T00:00:00.000 == close pos time: 2024-03-23T00:00:00.000
2024-11-20 23:07:31,958 - INFO - pnl: 2024-03-15T23:59:59.999 155308.37342769094 === 0.915%
2024-11-20 23:07:31,961 - DEBUG - cur time: 2024-03-16T23:59:59.999 == next bar open time: 2024-03-17T00:00:00.000 == close pos time: 2024-03-24T00:00:00.000
2024-11-20 23:07:31,962 - INFO - pnl: 2024-03-16T23:59:59.999 155563.33912233516 === 0.164%
2024-11-20 23:07:31,966 - DEBUG - cur time: 2024-03-17T23:59:59.999 == next bar open time: 2024-03-18T00:00:00.000 == close pos time: 2024-03-25T00:00:00.000
2024-11-20 23:07:31,967 - INFO - pnl: 2024-03-17T23:59:59.999 156709.96599620327 === 0.737%
2024-11-20 23:07:31,971 - DEBUG - cur time: 2024-03-18T23:59:59.999 == next bar open time: 2024-03-19T00:00:00.000 == close pos time: 2024-03-26T00:00:00.000
2024-11-20 23:07:31,972 - INFO - pnl: 2024-03-18T23:59:59.999 156959.32468669635 === 0.159%
2024-11-20 23:07:31,975 - DEBUG - cur time: 2024-03-19T23:59:59.999 == next bar open time: 2024-03-20T00:00:00.000 == close pos time: 2024-03-27T00:00:00.000
2024-11-20 23:07:31,977 - INFO - pnl: 2024-03-19T23:59:59.999 146680.3538382277 === -6.549%
2024-11-20 23:07:31,980 - DEBUG - cur time: 2024-03-20T23:59:59.999 == next bar open time: 2024-03-21T00:00:00.000 == close pos time: 2024-03-28T00:00:00.000
2024-11-20 23:07:31,981 - INFO - pnl: 2024-03-20T23:59:59.999 144876.32529798977 === -1.230%
2024-11-20 23:07:31,984 - DEBUG - cur time: 2024-03-21T23:59:59.999 == next bar open time: 2024-03-22T00:00:00.000 == close pos time: 2024-03-29T00:00:00.000
2024-11-20 23:07:31,996 - DEBUG - sorted_long_factors: shape: (224, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ GASUSDT   ┆ -2.167345    ┆ 0    ┆ 223          │
│ JTOUSDT   ┆ -2.048752    ┆ 1    ┆ 222          │
│ APTUSDT   ┆ -1.752515    ┆ 2    ┆ 221          │
│ MASKUSDT  ┆ -1.733974    ┆ 3    ┆ 220          │
│ WAVESUSDT ┆ -1.725575    ┆ 4    ┆ 219          │
│ AAVEUSDT  ┆ -1.718952    ┆ 5    ┆ 218          │
│ ORDIUSDT  ┆ -1.713717    ┆ 6    ┆ 217          │
│ ILVUSDT   ┆ -1.705708    ┆ 7    ┆ 216          │
│ CAKEUSDT  ┆ -1.688155    ┆ 8    ┆ 215          │
│ TRBUSDT   ┆ -1.622741    ┆ 9    ┆ 214          │
│ …         ┆ …            ┆ …    ┆ …            │
│ ROSEUSDT  ┆ -0.067706    ┆ 214  ┆ 9            │
│ IDEXUSDT  ┆ -0.063822    ┆ 215  ┆ 8            │
│ ARBUSDT   ┆ -0.06079     ┆ 216  ┆ 7            │
│ DGBUSDT   ┆ -0.006909    ┆ 217  ┆ 6            │
│ TRUUSDT   ┆ 0.051109     ┆ 218  ┆ 5            │
│ BALUSDT   ┆ 0.134736     ┆ 219  ┆ 4            │
│ COMBOUSDT ┆ 0.329911     ┆ 220  ┆ 3            │
│ OXTUSDT   ┆ 0.508267     ┆ 221  ┆ 2            │
│ ANTUSDT   ┆ 1.243786     ┆ 222  ┆ 1            │
│ DEFIUSDT  ┆ 1.493802     ┆ 223  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:32,002 - WARNING - 2024-03-21T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:32,002 - INFO - cur close time: 2024-03-21T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:32,002 - DEBUG - mean expected ret (mean factor): -0.7823586218324748
2024-11-20 23:07:32,006 - DEBUG - begin to update pos: =========
2024-11-20 23:07:32,006 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,006 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.022831    ┆ 0.21423     ┆ 0.14299     ┆ 0.0078997   ┆ … ┆ 0.03369 ┆ null   ┆ null    ┆ 0.8732  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,012 - DEBUG - update position: 2024-03-21T23:59:59.999 === diff_trading_value: 241943.9355954644 == cash: 145135.96446089743 
2024-11-20 23:07:32,013 - INFO - pnl: 2024-03-21T23:59:59.999 145135.96446089743 === 0.179%
2024-11-20 23:07:32,015 - DEBUG - cur time: 2024-03-22T23:59:59.999 == next bar open time: 2024-03-23T00:00:00.000 == close pos time: 2024-03-30T00:00:00.000
2024-11-20 23:07:32,016 - INFO - pnl: 2024-03-22T23:59:59.999 144351.69357169047 === -0.540%
2024-11-20 23:07:32,020 - DEBUG - cur time: 2024-03-23T23:59:59.999 == next bar open time: 2024-03-24T00:00:00.000 == close pos time: 2024-03-31T00:00:00.000
2024-11-20 23:07:32,021 - INFO - pnl: 2024-03-23T23:59:59.999 145853.07806897516 === 1.040%
2024-11-20 23:07:32,024 - DEBUG - cur time: 2024-03-24T23:59:59.999 == next bar open time: 2024-03-25T00:00:00.000 == close pos time: 2024-04-01T00:00:00.000
2024-11-20 23:07:32,025 - INFO - pnl: 2024-03-24T23:59:59.999 149614.11352444155 === 2.579%
2024-11-20 23:07:32,028 - DEBUG - cur time: 2024-03-25T23:59:59.999 == next bar open time: 2024-03-26T00:00:00.000 == close pos time: 2024-04-02T00:00:00.000
2024-11-20 23:07:32,029 - INFO - pnl: 2024-03-25T23:59:59.999 138509.256102247 === -7.422%
2024-11-20 23:07:32,032 - DEBUG - cur time: 2024-03-26T23:59:59.999 == next bar open time: 2024-03-27T00:00:00.000 == close pos time: 2024-04-03T00:00:00.000
2024-11-20 23:07:32,033 - INFO - pnl: 2024-03-26T23:59:59.999 137409.99562072766 === -0.794%
2024-11-20 23:07:32,037 - DEBUG - cur time: 2024-03-27T23:59:59.999 == next bar open time: 2024-03-28T00:00:00.000 == close pos time: 2024-04-04T00:00:00.000
2024-11-20 23:07:32,038 - INFO - pnl: 2024-03-27T23:59:59.999 138418.5640750473 === 0.734%
2024-11-20 23:07:32,041 - DEBUG - cur time: 2024-03-28T23:59:59.999 == next bar open time: 2024-03-29T00:00:00.000 == close pos time: 2024-04-05T00:00:00.000
2024-11-20 23:07:32,048 - DEBUG - sorted_long_factors: shape: (225, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ BONDUSDT    ┆ -2.281128    ┆ 0    ┆ 224          │
│ JTOUSDT     ┆ -2.1371      ┆ 1    ┆ 223          │
│ TIAUSDT     ┆ -2.084406    ┆ 2    ┆ 222          │
│ INJUSDT     ┆ -1.873731    ┆ 3    ┆ 221          │
│ DOTUSDT     ┆ -1.752814    ┆ 4    ┆ 220          │
│ FETUSDT     ┆ -1.703188    ┆ 5    ┆ 219          │
│ BIGTIMEUSDT ┆ -1.696043    ┆ 6    ┆ 218          │
│ MASKUSDT    ┆ -1.68046     ┆ 7    ┆ 217          │
│ AGIXUSDT    ┆ -1.67451     ┆ 8    ┆ 216          │
│ CAKEUSDT    ┆ -1.635309    ┆ 9    ┆ 215          │
│ …           ┆ …            ┆ …    ┆ …            │
│ ALPHAUSDT   ┆ -0.063826    ┆ 215  ┆ 9            │
│ IMXUSDT     ┆ -0.010179    ┆ 216  ┆ 8            │
│ AGLDUSDT    ┆ -0.008218    ┆ 217  ┆ 7            │
│ DENTUSDT    ┆ 0.055118     ┆ 218  ┆ 6            │
│ SFPUSDT     ┆ 0.188516     ┆ 219  ┆ 5            │
│ ZENUSDT     ┆ 0.227868     ┆ 220  ┆ 4            │
│ XVGUSDT     ┆ 0.373627     ┆ 221  ┆ 3            │
│ ZECUSDT     ┆ 0.409217     ┆ 222  ┆ 2            │
│ OXTUSDT     ┆ 1.010507     ┆ 223  ┆ 1            │
│ DEFIUSDT    ┆ 2.37558      ┆ 224  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:32,054 - WARNING - 2024-03-28T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:32,054 - INFO - cur close time: 2024-03-28T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:32,054 - DEBUG - mean expected ret (mean factor): -0.7757983596215113
2024-11-20 23:07:32,061 - DEBUG - begin to update pos: =========
2024-11-20 23:07:32,061 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,062 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.028402    ┆ 0.25239     ┆ 0.16038     ┆ 0.0080362   ┆ … ┆ 0.03733 ┆ null   ┆ null    ┆ 1.0475  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,067 - DEBUG - update position: 2024-03-28T23:59:59.999 === diff_trading_value: 256463.76973028938 == cash: 136866.5294211078 
2024-11-20 23:07:32,068 - INFO - pnl: 2024-03-28T23:59:59.999 136866.5294211078 === -1.121%
2024-11-20 23:07:32,071 - DEBUG - cur time: 2024-03-29T23:59:59.999 == next bar open time: 2024-03-30T00:00:00.000 == close pos time: 2024-04-06T00:00:00.000
2024-11-20 23:07:32,073 - INFO - pnl: 2024-03-29T23:59:59.999 138874.33511953117 === 1.467%
2024-11-20 23:07:32,077 - DEBUG - cur time: 2024-03-30T23:59:59.999 == next bar open time: 2024-03-31T00:00:00.000 == close pos time: 2024-04-07T00:00:00.000
2024-11-20 23:07:32,078 - INFO - pnl: 2024-03-30T23:59:59.999 139000.2252242625 === 0.091%
2024-11-20 23:07:32,082 - DEBUG - cur time: 2024-03-31T23:59:59.999 == next bar open time: 2024-04-01T00:00:00.000 == close pos time: 2024-04-08T00:00:00.000
2024-11-20 23:07:32,083 - INFO - pnl: 2024-03-31T23:59:59.999 138527.3968708679 === -0.340%
2024-11-20 23:07:32,085 - DEBUG - cur time: 2024-04-01T23:59:59.999 == next bar open time: 2024-04-02T00:00:00.000 == close pos time: 2024-04-09T00:00:00.000
2024-11-20 23:07:32,087 - INFO - pnl: 2024-04-01T23:59:59.999 139853.54443108794 === 0.957%
2024-11-20 23:07:32,090 - DEBUG - cur time: 2024-04-02T23:59:59.999 == next bar open time: 2024-04-03T00:00:00.000 == close pos time: 2024-04-10T00:00:00.000
2024-11-20 23:07:32,093 - INFO - pnl: 2024-04-02T23:59:59.999 142010.47809415602 === 1.542%
2024-11-20 23:07:32,096 - DEBUG - cur time: 2024-04-03T23:59:59.999 == next bar open time: 2024-04-04T00:00:00.000 == close pos time: 2024-04-11T00:00:00.000
2024-11-20 23:07:32,098 - INFO - pnl: 2024-04-03T23:59:59.999 139136.77093722703 === -2.024%
2024-11-20 23:07:32,101 - DEBUG - cur time: 2024-04-04T23:59:59.999 == next bar open time: 2024-04-05T00:00:00.000 == close pos time: 2024-04-12T00:00:00.000
2024-11-20 23:07:32,109 - DEBUG - sorted_long_factors: shape: (225, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ BONDUSDT    ┆ -2.237933    ┆ 0    ┆ 224          │
│ MASKUSDT    ┆ -2.085311    ┆ 1    ┆ 223          │
│ TRBUSDT     ┆ -2.006698    ┆ 2    ┆ 222          │
│ ILVUSDT     ┆ -1.975953    ┆ 3    ┆ 221          │
│ ORDIUSDT    ┆ -1.875891    ┆ 4    ┆ 220          │
│ AUCTIONUSDT ┆ -1.794363    ┆ 5    ┆ 219          │
│ BADGERUSDT  ┆ -1.765935    ┆ 6    ┆ 218          │
│ TIAUSDT     ┆ -1.758996    ┆ 7    ┆ 217          │
│ FILUSDT     ┆ -1.718973    ┆ 8    ┆ 216          │
│ AAVEUSDT    ┆ -1.68956     ┆ 9    ┆ 215          │
│ …           ┆ …            ┆ …    ┆ …            │
│ AGLDUSDT    ┆ 0.158445     ┆ 215  ┆ 9            │
│ ALPHAUSDT   ┆ 0.32011      ┆ 216  ┆ 8            │
│ HFTUSDT     ┆ 0.345364     ┆ 217  ┆ 7            │
│ SNTUSDT     ┆ 0.4225       ┆ 218  ┆ 6            │
│ CVXUSDT     ┆ 0.439476     ┆ 219  ┆ 5            │
│ TLMUSDT     ┆ 0.474759     ┆ 220  ┆ 4            │
│ SFPUSDT     ┆ 0.518711     ┆ 221  ┆ 3            │
│ DENTUSDT    ┆ 0.660574     ┆ 222  ┆ 2            │
│ OXTUSDT     ┆ 0.782053     ┆ 223  ┆ 1            │
│ DEFIUSDT    ┆ 2.171264     ┆ 224  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:32,115 - WARNING - 2024-04-04T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:32,115 - INFO - cur close time: 2024-04-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:32,115 - DEBUG - mean expected ret (mean factor): -0.7709954794646695
2024-11-20 23:07:32,121 - DEBUG - begin to update pos: =========
2024-11-20 23:07:32,121 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,122 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023208    ┆ 0.20072     ┆ 0.13981     ┆ 0.006925    ┆ … ┆ 0.03298 ┆ null   ┆ null    ┆ 0.6745  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,128 - DEBUG - update position: 2024-04-04T23:59:59.999 === diff_trading_value: 267142.53831176163 == cash: 139029.76540133954 
2024-11-20 23:07:32,129 - INFO - pnl: 2024-04-04T23:59:59.999 139029.76540133954 === -0.077%
2024-11-20 23:07:32,134 - DEBUG - cur time: 2024-04-05T23:59:59.999 == next bar open time: 2024-04-06T00:00:00.000 == close pos time: 2024-04-13T00:00:00.000
2024-11-20 23:07:32,136 - INFO - pnl: 2024-04-05T23:59:59.999 137173.16026886544 === -1.335%
2024-11-20 23:07:32,140 - DEBUG - cur time: 2024-04-06T23:59:59.999 == next bar open time: 2024-04-07T00:00:00.000 == close pos time: 2024-04-14T00:00:00.000
2024-11-20 23:07:32,142 - INFO - pnl: 2024-04-06T23:59:59.999 136546.72707116688 === -0.457%
2024-11-20 23:07:32,146 - DEBUG - cur time: 2024-04-07T23:59:59.999 == next bar open time: 2024-04-08T00:00:00.000 == close pos time: 2024-04-15T00:00:00.000
2024-11-20 23:07:32,148 - INFO - pnl: 2024-04-07T23:59:59.999 138176.16885812843 === 1.193%
2024-11-20 23:07:32,152 - DEBUG - cur time: 2024-04-08T23:59:59.999 == next bar open time: 2024-04-09T00:00:00.000 == close pos time: 2024-04-16T00:00:00.000
2024-11-20 23:07:32,153 - INFO - pnl: 2024-04-08T23:59:59.999 140771.47007083092 === 1.878%
2024-11-20 23:07:32,157 - DEBUG - cur time: 2024-04-09T23:59:59.999 == next bar open time: 2024-04-10T00:00:00.000 == close pos time: 2024-04-17T00:00:00.000
2024-11-20 23:07:32,159 - INFO - pnl: 2024-04-09T23:59:59.999 142939.10168564122 === 1.540%
2024-11-20 23:07:32,163 - DEBUG - cur time: 2024-04-10T23:59:59.999 == next bar open time: 2024-04-11T00:00:00.000 == close pos time: 2024-04-18T00:00:00.000
2024-11-20 23:07:32,165 - INFO - pnl: 2024-04-10T23:59:59.999 143380.79134939983 === 0.309%
2024-11-20 23:07:32,169 - DEBUG - cur time: 2024-04-11T23:59:59.999 == next bar open time: 2024-04-12T00:00:00.000 == close pos time: 2024-04-19T00:00:00.000
2024-11-20 23:07:32,178 - DEBUG - sorted_long_factors: shape: (227, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ AUCTIONUSDT ┆ -2.00923     ┆ 0    ┆ 226          │
│ ILVUSDT     ┆ -1.798347    ┆ 1    ┆ 225          │
│ GASUSDT     ┆ -1.698672    ┆ 2    ┆ 224          │
│ YGGUSDT     ┆ -1.676738    ┆ 3    ┆ 223          │
│ WAVESUSDT   ┆ -1.674999    ┆ 4    ┆ 222          │
│ TRBUSDT     ┆ -1.648836    ┆ 5    ┆ 221          │
│ QTUMUSDT    ┆ -1.612091    ┆ 6    ┆ 220          │
│ YFIUSDT     ┆ -1.558634    ┆ 7    ┆ 219          │
│ JTOUSDT     ┆ -1.54518     ┆ 8    ┆ 218          │
│ GALUSDT     ┆ -1.526291    ┆ 9    ┆ 217          │
│ …           ┆ …            ┆ …    ┆ …            │
│ SKLUSDT     ┆ 0.057053     ┆ 217  ┆ 9            │
│ COMBOUSDT   ┆ 0.057711     ┆ 218  ┆ 8            │
│ HFTUSDT     ┆ 0.068531     ┆ 219  ┆ 7            │
│ DODOXUSDT   ┆ 0.12114      ┆ 220  ┆ 6            │
│ MDTUSDT     ┆ 0.131665     ┆ 221  ┆ 5            │
│ OXTUSDT     ┆ 0.16676      ┆ 222  ┆ 4            │
│ CVXUSDT     ┆ 0.191888     ┆ 223  ┆ 3            │
│ XMRUSDT     ┆ 0.222494     ┆ 224  ┆ 2            │
│ PHBUSDT     ┆ 0.496698     ┆ 225  ┆ 1            │
│ DEFIUSDT    ┆ 2.262397     ┆ 226  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:32,187 - INFO - cur close time: 2024-04-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:32,187 - DEBUG - mean expected ret (mean factor): -0.7861679851644159
2024-11-20 23:07:32,192 - DEBUG - begin to update pos: =========
2024-11-20 23:07:32,192 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,192 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.021672    ┆ 0.19186     ┆ 0.12957     ┆ 0.0073187   ┆ … ┆ 0.03366 ┆ null   ┆ null    ┆ 0.6396  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,201 - DEBUG - update position: 2024-04-11T23:59:59.999 === diff_trading_value: 254349.16986711984 == cash: 145301.31051145954 
2024-11-20 23:07:32,203 - INFO - pnl: 2024-04-11T23:59:59.999 145301.31051145954 === 1.339%
2024-11-20 23:07:32,207 - DEBUG - cur time: 2024-04-12T23:59:59.999 == next bar open time: 2024-04-13T00:00:00.000 == close pos time: 2024-04-20T00:00:00.000
2024-11-20 23:07:32,210 - INFO - pnl: 2024-04-12T23:59:59.999 143350.27928083338 === -1.343%
2024-11-20 23:07:32,215 - DEBUG - cur time: 2024-04-13T23:59:59.999 == next bar open time: 2024-04-14T00:00:00.000 == close pos time: 2024-04-21T00:00:00.000
2024-11-20 23:07:32,217 - INFO - pnl: 2024-04-13T23:59:59.999 143944.98053299915 === 0.415%
2024-11-20 23:07:32,223 - DEBUG - cur time: 2024-04-14T23:59:59.999 == next bar open time: 2024-04-15T00:00:00.000 == close pos time: 2024-04-22T00:00:00.000
2024-11-20 23:07:32,225 - INFO - pnl: 2024-04-14T23:59:59.999 144598.44115287616 === 0.454%
2024-11-20 23:07:32,229 - DEBUG - cur time: 2024-04-15T23:59:59.999 == next bar open time: 2024-04-16T00:00:00.000 == close pos time: 2024-04-23T00:00:00.000
2024-11-20 23:07:32,231 - INFO - pnl: 2024-04-15T23:59:59.999 144646.4592078849 === 0.033%
2024-11-20 23:07:32,236 - DEBUG - cur time: 2024-04-16T23:59:59.999 == next bar open time: 2024-04-17T00:00:00.000 == close pos time: 2024-04-24T00:00:00.000
2024-11-20 23:07:32,238 - INFO - pnl: 2024-04-16T23:59:59.999 146808.18101005626 === 1.494%
2024-11-20 23:07:32,242 - DEBUG - cur time: 2024-04-17T23:59:59.999 == next bar open time: 2024-04-18T00:00:00.000 == close pos time: 2024-04-25T00:00:00.000
2024-11-20 23:07:32,244 - INFO - pnl: 2024-04-17T23:59:59.999 147383.21475587966 === 0.392%
2024-11-20 23:07:32,248 - DEBUG - cur time: 2024-04-18T23:59:59.999 == next bar open time: 2024-04-19T00:00:00.000 == close pos time: 2024-04-26T00:00:00.000
2024-11-20 23:07:32,258 - DEBUG - sorted_long_factors: shape: (228, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT     ┆ -1.949317    ┆ 0    ┆ 227          │
│ NEOUSDT     ┆ -1.843589    ┆ 1    ┆ 226          │
│ ONTUSDT     ┆ -1.827628    ┆ 2    ┆ 225          │
│ BELUSDT     ┆ -1.81179     ┆ 3    ┆ 224          │
│ BTCDOMUSDT  ┆ -1.764393    ┆ 4    ┆ 223          │
│ ONGUSDT     ┆ -1.712551    ┆ 5    ┆ 222          │
│ GASUSDT     ┆ -1.711334    ┆ 6    ┆ 221          │
│ AUCTIONUSDT ┆ -1.659225    ┆ 7    ┆ 220          │
│ HIGHUSDT    ┆ -1.649957    ┆ 8    ┆ 219          │
│ QTUMUSDT    ┆ -1.643826    ┆ 9    ┆ 218          │
│ …           ┆ …            ┆ …    ┆ …            │
│ LITUSDT     ┆ 0.101188     ┆ 218  ┆ 9            │
│ MKRUSDT     ┆ 0.110283     ┆ 219  ┆ 8            │
│ GTCUSDT     ┆ 0.128347     ┆ 220  ┆ 7            │
│ PHBUSDT     ┆ 0.229814     ┆ 221  ┆ 6            │
│ RADUSDT     ┆ 0.283587     ┆ 222  ┆ 5            │
│ COMBOUSDT   ┆ 0.368156     ┆ 223  ┆ 4            │
│ OXTUSDT     ┆ 0.376324     ┆ 224  ┆ 3            │
│ DODOXUSDT   ┆ 0.608137     ┆ 225  ┆ 2            │
│ CVXUSDT     ┆ 0.628702     ┆ 226  ┆ 1            │
│ DEFIUSDT    ┆ 2.285064     ┆ 227  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:32,264 - WARNING - 2024-04-18T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:32,264 - INFO - cur close time: 2024-04-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:32,264 - DEBUG - mean expected ret (mean factor): -0.7780111839231485
2024-11-20 23:07:32,270 - DEBUG - begin to update pos: =========
2024-11-20 23:07:32,270 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,271 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.014715    ┆ 0.13824     ┆ 0.1006      ┆ 0.0050799   ┆ … ┆ 0.0243  ┆ null   ┆ null    ┆ 0.5052  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,278 - DEBUG - update position: 2024-04-18T23:59:59.999 === diff_trading_value: 201239.0043229667 == cash: 144940.36060014367 
2024-11-20 23:07:32,280 - INFO - pnl: 2024-04-18T23:59:59.999 144940.36060014367 === -1.657%
2024-11-20 23:07:32,284 - DEBUG - cur time: 2024-04-19T23:59:59.999 == next bar open time: 2024-04-20T00:00:00.000 == close pos time: 2024-04-27T00:00:00.000
2024-11-20 23:07:32,286 - INFO - pnl: 2024-04-19T23:59:59.999 143169.75355696154 === -1.222%
2024-11-20 23:07:32,290 - DEBUG - cur time: 2024-04-20T23:59:59.999 == next bar open time: 2024-04-21T00:00:00.000 == close pos time: 2024-04-28T00:00:00.000
2024-11-20 23:07:32,292 - INFO - pnl: 2024-04-20T23:59:59.999 148525.29728772803 === 3.741%
2024-11-20 23:07:32,296 - DEBUG - cur time: 2024-04-21T23:59:59.999 == next bar open time: 2024-04-22T00:00:00.000 == close pos time: 2024-04-29T00:00:00.000
2024-11-20 23:07:32,298 - INFO - pnl: 2024-04-21T23:59:59.999 143566.03569114913 === -3.339%
2024-11-20 23:07:32,303 - DEBUG - cur time: 2024-04-22T23:59:59.999 == next bar open time: 2024-04-23T00:00:00.000 == close pos time: 2024-04-30T00:00:00.000
2024-11-20 23:07:32,304 - INFO - pnl: 2024-04-22T23:59:59.999 142159.3472245966 === -0.980%
2024-11-20 23:07:32,308 - DEBUG - cur time: 2024-04-23T23:59:59.999 == next bar open time: 2024-04-24T00:00:00.000 == close pos time: 2024-05-01T00:00:00.000
2024-11-20 23:07:32,310 - INFO - pnl: 2024-04-23T23:59:59.999 144909.30806749672 === 1.934%
2024-11-20 23:07:32,314 - DEBUG - cur time: 2024-04-24T23:59:59.999 == next bar open time: 2024-04-25T00:00:00.000 == close pos time: 2024-05-02T00:00:00.000
2024-11-20 23:07:32,316 - INFO - pnl: 2024-04-24T23:59:59.999 140341.88294164115 === -3.152%
2024-11-20 23:07:32,320 - DEBUG - cur time: 2024-04-25T23:59:59.999 == next bar open time: 2024-04-26T00:00:00.000 == close pos time: 2024-05-03T00:00:00.000
2024-11-20 23:07:32,331 - DEBUG - sorted_long_factors: shape: (229, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT     ┆ -2.034091    ┆ 0    ┆ 228          │
│ HIGHUSDT    ┆ -1.886049    ┆ 1    ┆ 227          │
│ JTOUSDT     ┆ -1.82597     ┆ 2    ┆ 226          │
│ BIGTIMEUSDT ┆ -1.779069    ┆ 3    ┆ 225          │
│ EOSUSDT     ┆ -1.694369    ┆ 4    ┆ 224          │
│ NEARUSDT    ┆ -1.688819    ┆ 5    ┆ 223          │
│ BTCDOMUSDT  ┆ -1.67001     ┆ 6    ┆ 222          │
│ STEEMUSDT   ┆ -1.666873    ┆ 7    ┆ 221          │
│ THETAUSDT   ┆ -1.641274    ┆ 8    ┆ 220          │
│ ONTUSDT     ┆ -1.638532    ┆ 9    ┆ 219          │
│ …           ┆ …            ┆ …    ┆ …            │
│ ZENUSDT     ┆ 0.069149     ┆ 219  ┆ 9            │
│ MDTUSDT     ┆ 0.109253     ┆ 220  ┆ 8            │
│ DUSKUSDT    ┆ 0.123506     ┆ 221  ┆ 7            │
│ AGLDUSDT    ┆ 0.178926     ┆ 222  ┆ 6            │
│ NMRUSDT     ┆ 0.243751     ┆ 223  ┆ 5            │
│ FXSUSDT     ┆ 0.398836     ┆ 224  ┆ 4            │
│ RADUSDT     ┆ 0.529        ┆ 225  ┆ 3            │
│ CVXUSDT     ┆ 0.568556     ┆ 226  ┆ 2            │
│ OXTUSDT     ┆ 0.658255     ┆ 227  ┆ 1            │
│ DEFIUSDT    ┆ 2.747606     ┆ 228  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:32,341 - WARNING - 2024-04-25T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:32,341 - INFO - cur close time: 2024-04-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:32,341 - DEBUG - mean expected ret (mean factor): -0.7731568413943228
2024-11-20 23:07:32,345 - DEBUG - begin to update pos: =========
2024-11-20 23:07:32,346 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,346 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.026838    ┆ 0.1859      ┆ 0.10859     ┆ 0.0077784   ┆ … ┆ 0.02574 ┆ null   ┆ null    ┆ 0.5191  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,354 - DEBUG - update position: 2024-04-25T23:59:59.999 === diff_trading_value: 214695.15383869153 == cash: 139465.33275342232 
2024-11-20 23:07:32,355 - INFO - pnl: 2024-04-25T23:59:59.999 139465.33275342232 === -0.625%
2024-11-20 23:07:32,359 - DEBUG - cur time: 2024-04-26T23:59:59.999 == next bar open time: 2024-04-27T00:00:00.000 == close pos time: 2024-05-04T00:00:00.000
2024-11-20 23:07:32,360 - INFO - pnl: 2024-04-26T23:59:59.999 137988.70475163386 === -1.059%
2024-11-20 23:07:32,364 - DEBUG - cur time: 2024-04-27T23:59:59.999 == next bar open time: 2024-04-28T00:00:00.000 == close pos time: 2024-05-05T00:00:00.000
2024-11-20 23:07:32,366 - INFO - pnl: 2024-04-27T23:59:59.999 140569.94708349017 === 1.871%
2024-11-20 23:07:32,370 - DEBUG - cur time: 2024-04-28T23:59:59.999 == next bar open time: 2024-04-29T00:00:00.000 == close pos time: 2024-05-06T00:00:00.000
2024-11-20 23:07:32,372 - INFO - pnl: 2024-04-28T23:59:59.999 140264.16842272913 === -0.218%
2024-11-20 23:07:32,376 - DEBUG - cur time: 2024-04-29T23:59:59.999 == next bar open time: 2024-04-30T00:00:00.000 == close pos time: 2024-05-07T00:00:00.000
2024-11-20 23:07:32,378 - INFO - pnl: 2024-04-29T23:59:59.999 139433.48787177753 === -0.592%
2024-11-20 23:07:32,381 - DEBUG - cur time: 2024-04-30T23:59:59.999 == next bar open time: 2024-05-01T00:00:00.000 == close pos time: 2024-05-08T00:00:00.000
2024-11-20 23:07:32,383 - INFO - pnl: 2024-04-30T23:59:59.999 137179.20071923418 === -1.617%
2024-11-20 23:07:32,387 - DEBUG - cur time: 2024-05-01T23:59:59.999 == next bar open time: 2024-05-02T00:00:00.000 == close pos time: 2024-05-09T00:00:00.000
2024-11-20 23:07:32,389 - INFO - pnl: 2024-05-01T23:59:59.999 137736.26160729333 === 0.406%
2024-11-20 23:07:32,393 - DEBUG - cur time: 2024-05-02T23:59:59.999 == next bar open time: 2024-05-03T00:00:00.000 == close pos time: 2024-05-10T00:00:00.000
2024-11-20 23:07:32,404 - DEBUG - sorted_long_factors: shape: (232, 4)
┌──────────┬──────────────┬──────┬──────────────┐
│ symbol   ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---      ┆ ---          ┆ ---  ┆ ---          │
│ str      ┆ f64          ┆ u32  ┆ u32          │
╞══════════╪══════════════╪══════╪══════════════╡
│ WIFUSDT  ┆ -2.17773     ┆ 0    ┆ 231          │
│ JTOUSDT  ┆ -1.868457    ┆ 1    ┆ 230          │
│ GASUSDT  ┆ -1.862444    ┆ 2    ┆ 229          │
│ ONDOUSDT ┆ -1.807235    ┆ 3    ┆ 228          │
│ XMRUSDT  ┆ -1.790684    ┆ 4    ┆ 227          │
│ ACEUSDT  ┆ -1.767295    ┆ 5    ┆ 226          │
│ HIGHUSDT ┆ -1.742377    ┆ 6    ┆ 225          │
│ ORDIUSDT ┆ -1.734597    ┆ 7    ┆ 224          │
│ XAIUSDT  ┆ -1.717091    ┆ 8    ┆ 223          │
│ ENSUSDT  ┆ -1.709728    ┆ 9    ┆ 222          │
│ …        ┆ …            ┆ …    ┆ …            │
│ GLMRUSDT ┆ 0.070101     ┆ 222  ┆ 9            │
│ ZENUSDT  ┆ 0.094317     ┆ 223  ┆ 8            │
│ GMXUSDT  ┆ 0.10766      ┆ 224  ┆ 7            │
│ MDTUSDT  ┆ 0.229173     ┆ 225  ┆ 6            │
│ AGLDUSDT ┆ 0.318629     ┆ 226  ┆ 5            │
│ IDEXUSDT ┆ 0.338309     ┆ 227  ┆ 4            │
│ HFTUSDT  ┆ 0.352283     ┆ 228  ┆ 3            │
│ RADUSDT  ┆ 0.632068     ┆ 229  ┆ 2            │
│ OXTUSDT  ┆ 0.635887     ┆ 230  ┆ 1            │
│ DEFIUSDT ┆ 2.58413      ┆ 231  ┆ 0            │
└──────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:32,411 - WARNING - 2024-05-02T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:32,411 - INFO - cur close time: 2024-05-02T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:32,411 - DEBUG - mean expected ret (mean factor): -0.7583131624657092
2024-11-20 23:07:32,417 - DEBUG - begin to update pos: =========
2024-11-20 23:07:32,418 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,418 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025304    ┆ 0.16383     ┆ 0.10372     ┆ 0.0075418   ┆ … ┆ 0.0234  ┆ null   ┆ null    ┆ 0.4728  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,427 - DEBUG - update position: 2024-05-02T23:59:59.999 === diff_trading_value: 226795.70416954247 == cash: 136889.7794748316 
2024-11-20 23:07:32,429 - INFO - pnl: 2024-05-02T23:59:59.999 136889.7794748316 === -0.615%
2024-11-20 23:07:32,435 - DEBUG - cur time: 2024-05-03T23:59:59.999 == next bar open time: 2024-05-04T00:00:00.000 == close pos time: 2024-05-11T00:00:00.000
2024-11-20 23:07:32,438 - INFO - pnl: 2024-05-03T23:59:59.999 135598.4552982895 === -0.943%
2024-11-20 23:07:32,443 - DEBUG - cur time: 2024-05-04T23:59:59.999 == next bar open time: 2024-05-05T00:00:00.000 == close pos time: 2024-05-12T00:00:00.000
2024-11-20 23:07:32,445 - INFO - pnl: 2024-05-04T23:59:59.999 134625.2038262982 === -0.718%
2024-11-20 23:07:32,450 - DEBUG - cur time: 2024-05-05T23:59:59.999 == next bar open time: 2024-05-06T00:00:00.000 == close pos time: 2024-05-13T00:00:00.000
2024-11-20 23:07:32,452 - INFO - pnl: 2024-05-05T23:59:59.999 135811.551856711 === 0.881%
2024-11-20 23:07:32,458 - DEBUG - cur time: 2024-05-06T23:59:59.999 == next bar open time: 2024-05-07T00:00:00.000 == close pos time: 2024-05-14T00:00:00.000
2024-11-20 23:07:32,459 - INFO - pnl: 2024-05-06T23:59:59.999 135740.03896489006 === -0.053%
2024-11-20 23:07:32,465 - DEBUG - cur time: 2024-05-07T23:59:59.999 == next bar open time: 2024-05-08T00:00:00.000 == close pos time: 2024-05-15T00:00:00.000
2024-11-20 23:07:32,467 - INFO - pnl: 2024-05-07T23:59:59.999 131938.57580674178 === -2.801%
2024-11-20 23:07:32,472 - DEBUG - cur time: 2024-05-08T23:59:59.999 == next bar open time: 2024-05-09T00:00:00.000 == close pos time: 2024-05-16T00:00:00.000
2024-11-20 23:07:32,474 - INFO - pnl: 2024-05-08T23:59:59.999 121616.43658984365 === -7.823%
2024-11-20 23:07:32,478 - DEBUG - cur time: 2024-05-09T23:59:59.999 == next bar open time: 2024-05-10T00:00:00.000 == close pos time: 2024-05-17T00:00:00.000
2024-11-20 23:07:32,487 - DEBUG - sorted_long_factors: shape: (226, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ NEOUSDT   ┆ -2.205497    ┆ 0    ┆ 225          │
│ WLDUSDT   ┆ -1.952719    ┆ 1    ┆ 224          │
│ RNDRUSDT  ┆ -1.865465    ┆ 2    ┆ 223          │
│ TIAUSDT   ┆ -1.843824    ┆ 3    ┆ 222          │
│ POWRUSDT  ┆ -1.803657    ┆ 4    ┆ 221          │
│ ACEUSDT   ┆ -1.801968    ┆ 5    ┆ 220          │
│ GASUSDT   ┆ -1.798786    ┆ 6    ┆ 219          │
│ ONGUSDT   ┆ -1.715715    ┆ 7    ┆ 218          │
│ WAVESUSDT ┆ -1.703143    ┆ 8    ┆ 217          │
│ LDOUSDT   ┆ -1.701832    ┆ 9    ┆ 216          │
│ …         ┆ …            ┆ …    ┆ …            │
│ TLMUSDT   ┆ 0.105245     ┆ 216  ┆ 9            │
│ DENTUSDT  ┆ 0.111703     ┆ 217  ┆ 8            │
│ ZECUSDT   ┆ 0.113774     ┆ 218  ┆ 7            │
│ RIFUSDT   ┆ 0.163919     ┆ 219  ┆ 6            │
│ IOTXUSDT  ┆ 0.270574     ┆ 220  ┆ 5            │
│ DODOXUSDT ┆ 0.285467     ┆ 221  ┆ 4            │
│ XVSUSDT   ┆ 0.304819     ┆ 222  ┆ 3            │
│ AGLDUSDT  ┆ 0.321237     ┆ 223  ┆ 2            │
│ HFTUSDT   ┆ 0.574466     ┆ 224  ┆ 1            │
│ DEFIUSDT  ┆ 1.606272     ┆ 225  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:32,495 - WARNING - 2024-05-09T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:32,495 - INFO - cur close time: 2024-05-09T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:32,495 - DEBUG - mean expected ret (mean factor): -0.7861379096197441
2024-11-20 23:07:32,500 - DEBUG - begin to update pos: =========
2024-11-20 23:07:32,500 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,501 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024513    ┆ 0.17924     ┆ 0.10705     ┆ 0.0085377   ┆ … ┆ 0.02425 ┆ null   ┆ null    ┆ 0.4861  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,507 - DEBUG - update position: 2024-05-09T23:59:59.999 === diff_trading_value: 264162.32611174416 == cash: 116495.21204903141 
2024-11-20 23:07:32,509 - INFO - pnl: 2024-05-09T23:59:59.999 116495.21204903141 === -4.211%
2024-11-20 23:07:32,512 - DEBUG - cur time: 2024-05-10T23:59:59.999 == next bar open time: 2024-05-11T00:00:00.000 == close pos time: 2024-05-18T00:00:00.000
2024-11-20 23:07:32,513 - INFO - pnl: 2024-05-10T23:59:59.999 115939.24829768337 === -0.477%
2024-11-20 23:07:32,517 - DEBUG - cur time: 2024-05-11T23:59:59.999 == next bar open time: 2024-05-12T00:00:00.000 == close pos time: 2024-05-19T00:00:00.000
2024-11-20 23:07:32,519 - INFO - pnl: 2024-05-11T23:59:59.999 114394.53012586503 === -1.332%
2024-11-20 23:07:32,523 - DEBUG - cur time: 2024-05-12T23:59:59.999 == next bar open time: 2024-05-13T00:00:00.000 == close pos time: 2024-05-20T00:00:00.000
2024-11-20 23:07:32,525 - INFO - pnl: 2024-05-12T23:59:59.999 112216.14018438768 === -1.904%
2024-11-20 23:07:32,528 - DEBUG - cur time: 2024-05-13T23:59:59.999 == next bar open time: 2024-05-14T00:00:00.000 == close pos time: 2024-05-21T00:00:00.000
2024-11-20 23:07:32,530 - INFO - pnl: 2024-05-13T23:59:59.999 113553.01996690189 === 1.191%
2024-11-20 23:07:32,535 - DEBUG - cur time: 2024-05-14T23:59:59.999 == next bar open time: 2024-05-15T00:00:00.000 == close pos time: 2024-05-22T00:00:00.000
2024-11-20 23:07:32,538 - INFO - pnl: 2024-05-14T23:59:59.999 116361.57454036508 === 2.473%
2024-11-20 23:07:32,542 - DEBUG - cur time: 2024-05-15T23:59:59.999 == next bar open time: 2024-05-16T00:00:00.000 == close pos time: 2024-05-23T00:00:00.000
2024-11-20 23:07:32,543 - INFO - pnl: 2024-05-15T23:59:59.999 117310.12442749323 === 0.815%
2024-11-20 23:07:32,547 - DEBUG - cur time: 2024-05-16T23:59:59.999 == next bar open time: 2024-05-17T00:00:00.000 == close pos time: 2024-05-24T00:00:00.000
2024-11-20 23:07:32,559 - DEBUG - sorted_long_factors: shape: (227, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ TIAUSDT    ┆ -2.064928    ┆ 0    ┆ 226          │
│ LSKUSDT    ┆ -1.967022    ┆ 1    ┆ 225          │
│ USDCUSDT   ┆ -1.966876    ┆ 2    ┆ 224          │
│ BTCDOMUSDT ┆ -1.844679    ┆ 3    ┆ 223          │
│ MOVRUSDT   ┆ -1.839416    ┆ 4    ┆ 222          │
│ ARUSDT     ┆ -1.812494    ┆ 5    ┆ 221          │
│ FETUSDT    ┆ -1.777525    ┆ 6    ┆ 220          │
│ ARKUSDT    ┆ -1.736316    ┆ 7    ┆ 219          │
│ JTOUSDT    ┆ -1.712977    ┆ 8    ┆ 218          │
│ ATOMUSDT   ┆ -1.690381    ┆ 9    ┆ 217          │
│ …          ┆ …            ┆ …    ┆ …            │
│ ETHWUSDT   ┆ 0.218516     ┆ 217  ┆ 9            │
│ LITUSDT    ┆ 0.235018     ┆ 218  ┆ 8            │
│ HOOKUSDT   ┆ 0.281451     ┆ 219  ┆ 7            │
│ DENTUSDT   ┆ 0.288962     ┆ 220  ┆ 6            │
│ TLMUSDT    ┆ 0.366149     ┆ 221  ┆ 5            │
│ DARUSDT    ┆ 0.455032     ┆ 222  ┆ 4            │
│ JOEUSDT    ┆ 0.634541     ┆ 223  ┆ 3            │
│ OGNUSDT    ┆ 0.690183     ┆ 224  ┆ 2            │
│ DODOXUSDT  ┆ 0.692077     ┆ 225  ┆ 1            │
│ DEFIUSDT   ┆ 0.746664     ┆ 226  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:32,567 - WARNING - 2024-05-16T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:32,567 - INFO - cur close time: 2024-05-16T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:32,567 - DEBUG - mean expected ret (mean factor): -0.7954949814175157
2024-11-20 23:07:32,571 - DEBUG - begin to update pos: =========
2024-11-20 23:07:32,573 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,573 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023869    ┆ 0.2059      ┆ 0.10723     ┆ 0.0100336   ┆ … ┆ 0.0231  ┆ null   ┆ null    ┆ 0.4984  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,580 - DEBUG - update position: 2024-05-16T23:59:59.999 === diff_trading_value: 284484.90195131383 == cash: 117824.19054498209 
2024-11-20 23:07:32,581 - INFO - pnl: 2024-05-16T23:59:59.999 117824.19054498209 === 0.438%
2024-11-20 23:07:32,585 - DEBUG - cur time: 2024-05-17T23:59:59.999 == next bar open time: 2024-05-18T00:00:00.000 == close pos time: 2024-05-25T00:00:00.000
2024-11-20 23:07:32,587 - INFO - pnl: 2024-05-17T23:59:59.999 119606.96893280324 === 1.513%
2024-11-20 23:07:32,589 - DEBUG - cur time: 2024-05-18T23:59:59.999 == next bar open time: 2024-05-19T00:00:00.000 == close pos time: 2024-05-26T00:00:00.000
2024-11-20 23:07:32,591 - INFO - pnl: 2024-05-18T23:59:59.999 121381.70171850218 === 1.484%
2024-11-20 23:07:32,595 - DEBUG - cur time: 2024-05-19T23:59:59.999 == next bar open time: 2024-05-20T00:00:00.000 == close pos time: 2024-05-27T00:00:00.000
2024-11-20 23:07:32,596 - INFO - pnl: 2024-05-19T23:59:59.999 119611.8271608197 === -1.458%
2024-11-20 23:07:32,601 - DEBUG - cur time: 2024-05-20T23:59:59.999 == next bar open time: 2024-05-21T00:00:00.000 == close pos time: 2024-05-28T00:00:00.000
2024-11-20 23:07:32,602 - INFO - pnl: 2024-05-20T23:59:59.999 126418.47621997162 === 5.691%
2024-11-20 23:07:32,606 - DEBUG - cur time: 2024-05-21T23:59:59.999 == next bar open time: 2024-05-22T00:00:00.000 == close pos time: 2024-05-29T00:00:00.000
2024-11-20 23:07:32,608 - INFO - pnl: 2024-05-21T23:59:59.999 128423.04134193985 === 1.586%
2024-11-20 23:07:32,613 - DEBUG - cur time: 2024-05-22T23:59:59.999 == next bar open time: 2024-05-23T00:00:00.000 == close pos time: 2024-05-30T00:00:00.000
2024-11-20 23:07:32,615 - INFO - pnl: 2024-05-22T23:59:59.999 128982.54644223524 === 0.436%
2024-11-20 23:07:32,620 - DEBUG - cur time: 2024-05-23T23:59:59.999 == next bar open time: 2024-05-24T00:00:00.000 == close pos time: 2024-05-31T00:00:00.000
2024-11-20 23:07:32,630 - DEBUG - sorted_long_factors: shape: (229, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ XMRUSDT     ┆ -2.148541    ┆ 0    ┆ 228          │
│ BNBUSDT     ┆ -1.884249    ┆ 1    ┆ 227          │
│ ONDOUSDT    ┆ -1.867446    ┆ 2    ┆ 226          │
│ WLDUSDT     ┆ -1.849566    ┆ 3    ┆ 225          │
│ AUCTIONUSDT ┆ -1.818397    ┆ 4    ┆ 224          │
│ LSKUSDT     ┆ -1.786968    ┆ 5    ┆ 223          │
│ MANTAUSDT   ┆ -1.749153    ┆ 6    ┆ 222          │
│ API3USDT    ┆ -1.730332    ┆ 7    ┆ 221          │
│ ACEUSDT     ┆ -1.708468    ┆ 8    ┆ 220          │
│ SSVUSDT     ┆ -1.663624    ┆ 9    ┆ 219          │
│ …           ┆ …            ┆ …    ┆ …            │
│ KEYUSDT     ┆ 0.085266     ┆ 219  ┆ 9            │
│ JOEUSDT     ┆ 0.140746     ┆ 220  ┆ 8            │
│ AMBUSDT     ┆ 0.142102     ┆ 221  ┆ 7            │
│ COMBOUSDT   ┆ 0.164401     ┆ 222  ┆ 6            │
│ NMRUSDT     ┆ 0.188597     ┆ 223  ┆ 5            │
│ DARUSDT     ┆ 0.193114     ┆ 224  ┆ 4            │
│ AGLDUSDT    ┆ 0.254906     ┆ 225  ┆ 3            │
│ OXTUSDT     ┆ 0.309662     ┆ 226  ┆ 2            │
│ DODOXUSDT   ┆ 1.355583     ┆ 227  ┆ 1            │
│ DEFIUSDT    ┆ 2.031032     ┆ 228  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:32,639 - INFO - cur close time: 2024-05-23T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:32,639 - DEBUG - mean expected ret (mean factor): -0.7695498199487426
2024-11-20 23:07:32,645 - DEBUG - begin to update pos: =========
2024-11-20 23:07:32,645 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,646 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.035217    ┆ 0.22651     ┆ 0.11416     ┆ 0.0149396   ┆ … ┆ 0.02373 ┆ null   ┆ null    ┆ 0.571   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,659 - DEBUG - update position: 2024-05-23T23:59:59.999 === diff_trading_value: 289055.7517454924 == cash: 131385.65682837708 
2024-11-20 23:07:32,662 - INFO - pnl: 2024-05-23T23:59:59.999 131385.65682837708 === 1.863%
2024-11-20 23:07:32,670 - DEBUG - cur time: 2024-05-24T23:59:59.999 == next bar open time: 2024-05-25T00:00:00.000 == close pos time: 2024-06-01T00:00:00.000
2024-11-20 23:07:32,672 - INFO - pnl: 2024-05-24T23:59:59.999 135181.23099715705 === 2.889%
2024-11-20 23:07:32,678 - DEBUG - cur time: 2024-05-25T23:59:59.999 == next bar open time: 2024-05-26T00:00:00.000 == close pos time: 2024-06-02T00:00:00.000
2024-11-20 23:07:32,680 - INFO - pnl: 2024-05-25T23:59:59.999 133743.1668475032 === -1.064%
2024-11-20 23:07:32,685 - DEBUG - cur time: 2024-05-26T23:59:59.999 == next bar open time: 2024-05-27T00:00:00.000 == close pos time: 2024-06-03T00:00:00.000
2024-11-20 23:07:32,687 - INFO - pnl: 2024-05-26T23:59:59.999 133043.7635451938 === -0.523%
2024-11-20 23:07:32,691 - DEBUG - cur time: 2024-05-27T23:59:59.999 == next bar open time: 2024-05-28T00:00:00.000 == close pos time: 2024-06-04T00:00:00.000
2024-11-20 23:07:32,693 - INFO - pnl: 2024-05-27T23:59:59.999 135109.3218912006 === 1.553%
2024-11-20 23:07:32,698 - DEBUG - cur time: 2024-05-28T23:59:59.999 == next bar open time: 2024-05-29T00:00:00.000 == close pos time: 2024-06-05T00:00:00.000
2024-11-20 23:07:32,700 - INFO - pnl: 2024-05-28T23:59:59.999 136453.2509287136 === 0.995%
2024-11-20 23:07:32,703 - DEBUG - cur time: 2024-05-29T23:59:59.999 == next bar open time: 2024-05-30T00:00:00.000 == close pos time: 2024-06-06T00:00:00.000
2024-11-20 23:07:32,705 - INFO - pnl: 2024-05-29T23:59:59.999 131878.67224561048 === -3.352%
2024-11-20 23:07:32,709 - DEBUG - cur time: 2024-05-30T23:59:59.999 == next bar open time: 2024-05-31T00:00:00.000 == close pos time: 2024-06-07T00:00:00.000
2024-11-20 23:07:32,720 - DEBUG - sorted_long_factors: shape: (231, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ WLDUSDT     ┆ -1.970259    ┆ 0    ┆ 230          │
│ AIUSDT      ┆ -1.771369    ┆ 1    ┆ 229          │
│ LSKUSDT     ┆ -1.736705    ┆ 2    ┆ 228          │
│ WIFUSDT     ┆ -1.722033    ┆ 3    ┆ 227          │
│ NFPUSDT     ┆ -1.712232    ┆ 4    ┆ 226          │
│ AUCTIONUSDT ┆ -1.687468    ┆ 5    ┆ 225          │
│ USDCUSDT    ┆ -1.658275    ┆ 6    ┆ 224          │
│ ORDIUSDT    ┆ -1.646741    ┆ 7    ┆ 223          │
│ LPTUSDT     ┆ -1.646291    ┆ 8    ┆ 222          │
│ TRBUSDT     ┆ -1.616867    ┆ 9    ┆ 221          │
│ …           ┆ …            ┆ …    ┆ …            │
│ ALICEUSDT   ┆ 0.030838     ┆ 221  ┆ 9            │
│ NMRUSDT     ┆ 0.044066     ┆ 222  ┆ 8            │
│ ZENUSDT     ┆ 0.049835     ┆ 223  ┆ 7            │
│ BALUSDT     ┆ 0.157385     ┆ 224  ┆ 6            │
│ TUSDT       ┆ 0.1844       ┆ 225  ┆ 5            │
│ RVNUSDT     ┆ 0.24138      ┆ 226  ┆ 4            │
│ DODOXUSDT   ┆ 0.276203     ┆ 227  ┆ 3            │
│ BNTUSDT     ┆ 0.297224     ┆ 228  ┆ 2            │
│ KSMUSDT     ┆ 0.570789     ┆ 229  ┆ 1            │
│ DEFIUSDT    ┆ 4.0803       ┆ 230  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:32,728 - WARNING - 2024-05-30T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:32,728 - INFO - cur close time: 2024-05-30T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:32,728 - DEBUG - mean expected ret (mean factor): -0.7715505595654535
2024-11-20 23:07:32,733 - DEBUG - begin to update pos: =========
2024-11-20 23:07:32,734 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,734 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.033843    ┆ 0.24825     ┆ 0.1219      ┆ 0.0144262   ┆ … ┆ 0.02397 ┆ null   ┆ null    ┆ 0.515   │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,744 - DEBUG - update position: 2024-05-30T23:59:59.999 === diff_trading_value: 272569.7055416465 == cash: 131355.1575955916 
2024-11-20 23:07:32,746 - INFO - pnl: 2024-05-30T23:59:59.999 131355.1575955916 === -0.397%
2024-11-20 23:07:32,749 - DEBUG - cur time: 2024-05-31T23:59:59.999 == next bar open time: 2024-06-01T00:00:00.000 == close pos time: 2024-06-08T00:00:00.000
2024-11-20 23:07:32,752 - INFO - pnl: 2024-05-31T23:59:59.999 133193.4747339693 === 1.400%
2024-11-20 23:07:32,757 - DEBUG - cur time: 2024-06-01T23:59:59.999 == next bar open time: 2024-06-02T00:00:00.000 == close pos time: 2024-06-09T00:00:00.000
2024-11-20 23:07:32,759 - INFO - pnl: 2024-06-01T23:59:59.999 133175.74210036144 === -0.013%
2024-11-20 23:07:32,764 - DEBUG - cur time: 2024-06-02T23:59:59.999 == next bar open time: 2024-06-03T00:00:00.000 == close pos time: 2024-06-10T00:00:00.000
2024-11-20 23:07:32,767 - INFO - pnl: 2024-06-02T23:59:59.999 134672.3041765579 === 1.124%
2024-11-20 23:07:32,773 - DEBUG - cur time: 2024-06-03T23:59:59.999 == next bar open time: 2024-06-04T00:00:00.000 == close pos time: 2024-06-11T00:00:00.000
2024-11-20 23:07:32,774 - INFO - pnl: 2024-06-03T23:59:59.999 137855.2662102486 === 2.363%
2024-11-20 23:07:32,781 - DEBUG - cur time: 2024-06-04T23:59:59.999 == next bar open time: 2024-06-05T00:00:00.000 == close pos time: 2024-06-12T00:00:00.000
2024-11-20 23:07:32,784 - INFO - pnl: 2024-06-04T23:59:59.999 136560.32037844224 === -0.939%
2024-11-20 23:07:32,790 - DEBUG - cur time: 2024-06-05T23:59:59.999 == next bar open time: 2024-06-06T00:00:00.000 == close pos time: 2024-06-13T00:00:00.000
2024-11-20 23:07:32,792 - INFO - pnl: 2024-06-05T23:59:59.999 135409.8012123068 === -0.842%
2024-11-20 23:07:32,798 - DEBUG - cur time: 2024-06-06T23:59:59.999 == next bar open time: 2024-06-07T00:00:00.000 == close pos time: 2024-06-14T00:00:00.000
2024-11-20 23:07:32,815 - DEBUG - sorted_long_factors: shape: (233, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ INJUSDT     ┆ -1.980122    ┆ 0    ┆ 232          │
│ ACEUSDT     ┆ -1.925149    ┆ 1    ┆ 231          │
│ JTOUSDT     ┆ -1.809439    ┆ 2    ┆ 230          │
│ WIFUSDT     ┆ -1.702027    ┆ 3    ┆ 229          │
│ LPTUSDT     ┆ -1.661072    ┆ 4    ┆ 228          │
│ AUCTIONUSDT ┆ -1.640752    ┆ 5    ┆ 227          │
│ MOVRUSDT    ┆ -1.621731    ┆ 6    ┆ 226          │
│ PYTHUSDT    ┆ -1.602628    ┆ 7    ┆ 225          │
│ TRBUSDT     ┆ -1.596504    ┆ 8    ┆ 224          │
│ MANTAUSDT   ┆ -1.534774    ┆ 9    ┆ 223          │
│ …           ┆ …            ┆ …    ┆ …            │
│ REEFUSDT    ┆ 0.002193     ┆ 223  ┆ 9            │
│ BTCDOMUSDT  ┆ 0.055947     ┆ 224  ┆ 8            │
│ ICXUSDT     ┆ 0.159363     ┆ 225  ┆ 7            │
│ BALUSDT     ┆ 0.239293     ┆ 226  ┆ 6            │
│ DODOXUSDT   ┆ 0.276184     ┆ 227  ┆ 5            │
│ OXTUSDT     ┆ 0.276973     ┆ 228  ┆ 4            │
│ NMRUSDT     ┆ 0.294578     ┆ 229  ┆ 3            │
│ BNTUSDT     ┆ 0.332995     ┆ 230  ┆ 2            │
│ SKLUSDT     ┆ 0.645268     ┆ 231  ┆ 1            │
│ DEFIUSDT    ┆ 2.847418     ┆ 232  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:32,823 - WARNING - 2024-06-06T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:32,824 - INFO - cur close time: 2024-06-06T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:32,824 - DEBUG - mean expected ret (mean factor): -0.7862176444290797
2024-11-20 23:07:32,831 - DEBUG - begin to update pos: =========
2024-11-20 23:07:32,832 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,832 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.031822    ┆ 0.32081     ┆ 0.12119     ┆ 0.0143597   ┆ … ┆ 0.02379 ┆ null   ┆ null    ┆ 0.5273  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,845 - DEBUG - update position: 2024-06-06T23:59:59.999 === diff_trading_value: 207755.67033466097 == cash: 132655.2721624725 
2024-11-20 23:07:32,847 - INFO - pnl: 2024-06-06T23:59:59.999 132655.2721624725 === -2.034%
2024-11-20 23:07:32,853 - DEBUG - cur time: 2024-06-07T23:59:59.999 == next bar open time: 2024-06-08T00:00:00.000 == close pos time: 2024-06-15T00:00:00.000
2024-11-20 23:07:32,856 - INFO - pnl: 2024-06-07T23:59:59.999 134127.31858156354 === 1.110%
2024-11-20 23:07:32,862 - DEBUG - cur time: 2024-06-08T23:59:59.999 == next bar open time: 2024-06-09T00:00:00.000 == close pos time: 2024-06-16T00:00:00.000
2024-11-20 23:07:32,865 - INFO - pnl: 2024-06-08T23:59:59.999 131708.74021198266 === -1.803%
2024-11-20 23:07:32,870 - DEBUG - cur time: 2024-06-09T23:59:59.999 == next bar open time: 2024-06-10T00:00:00.000 == close pos time: 2024-06-17T00:00:00.000
2024-11-20 23:07:32,873 - INFO - pnl: 2024-06-09T23:59:59.999 131276.613250921 === -0.328%
2024-11-20 23:07:32,879 - DEBUG - cur time: 2024-06-10T23:59:59.999 == next bar open time: 2024-06-11T00:00:00.000 == close pos time: 2024-06-18T00:00:00.000
2024-11-20 23:07:32,881 - INFO - pnl: 2024-06-10T23:59:59.999 131460.8585322324 === 0.140%
2024-11-20 23:07:32,887 - DEBUG - cur time: 2024-06-11T23:59:59.999 == next bar open time: 2024-06-12T00:00:00.000 == close pos time: 2024-06-19T00:00:00.000
2024-11-20 23:07:32,889 - INFO - pnl: 2024-06-11T23:59:59.999 133652.36591069365 === 1.667%
2024-11-20 23:07:32,894 - DEBUG - cur time: 2024-06-12T23:59:59.999 == next bar open time: 2024-06-13T00:00:00.000 == close pos time: 2024-06-20T00:00:00.000
2024-11-20 23:07:32,897 - INFO - pnl: 2024-06-12T23:59:59.999 129556.92175691627 === -3.064%
2024-11-20 23:07:32,903 - DEBUG - cur time: 2024-06-13T23:59:59.999 == next bar open time: 2024-06-14T00:00:00.000 == close pos time: 2024-06-21T00:00:00.000
2024-11-20 23:07:32,916 - DEBUG - sorted_long_factors: shape: (236, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ TONUSDT     ┆ -2.157732    ┆ 0    ┆ 235          │
│ AUCTIONUSDT ┆ -2.040108    ┆ 1    ┆ 234          │
│ OMUSDT      ┆ -1.980876    ┆ 2    ┆ 233          │
│ MOVRUSDT    ┆ -1.893234    ┆ 3    ┆ 232          │
│ UNIUSDT     ┆ -1.836851    ┆ 4    ┆ 231          │
│ BTCDOMUSDT  ┆ -1.831339    ┆ 5    ┆ 230          │
│ ACEUSDT     ┆ -1.777379    ┆ 6    ┆ 229          │
│ OMGUSDT     ┆ -1.713665    ┆ 7    ┆ 228          │
│ UMAUSDT     ┆ -1.657277    ┆ 8    ┆ 227          │
│ XAIUSDT     ┆ -1.621908    ┆ 9    ┆ 226          │
│ …           ┆ …            ┆ …    ┆ …            │
│ NKNUSDT     ┆ -0.060264    ┆ 226  ┆ 9            │
│ BNTUSDT     ┆ -0.059205    ┆ 227  ┆ 8            │
│ STMXUSDT    ┆ -0.021027    ┆ 228  ┆ 7            │
│ JOEUSDT     ┆ -0.016434    ┆ 229  ┆ 6            │
│ DODOXUSDT   ┆ 0.059938     ┆ 230  ┆ 5            │
│ BALUSDT     ┆ 0.344798     ┆ 231  ┆ 4            │
│ RLCUSDT     ┆ 0.358675     ┆ 232  ┆ 3            │
│ OXTUSDT     ┆ 0.367597     ┆ 233  ┆ 2            │
│ NMRUSDT     ┆ 1.125755     ┆ 234  ┆ 1            │
│ DEFIUSDT    ┆ 2.142054     ┆ 235  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:32,925 - WARNING - 2024-06-13T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:32,926 - INFO - cur close time: 2024-06-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:32,926 - DEBUG - mean expected ret (mean factor): -0.7954447932888912
2024-11-20 23:07:32,931 - DEBUG - begin to update pos: =========
2024-11-20 23:07:32,931 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,931 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.025607    ┆ 0.20592     ┆ 0.09872     ┆ 0.0119076   ┆ … ┆ 0.01997 ┆ null   ┆ null    ┆ 0.4261  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:32,940 - DEBUG - update position: 2024-06-13T23:59:59.999 === diff_trading_value: 229331.6194702957 == cash: 130581.79122895023 
2024-11-20 23:07:32,942 - INFO - pnl: 2024-06-13T23:59:59.999 130581.79122895023 === 0.791%
2024-11-20 23:07:32,946 - DEBUG - cur time: 2024-06-14T23:59:59.999 == next bar open time: 2024-06-15T00:00:00.000 == close pos time: 2024-06-22T00:00:00.000
2024-11-20 23:07:32,948 - INFO - pnl: 2024-06-14T23:59:59.999 131035.48642928703 === 0.347%
2024-11-20 23:07:32,951 - DEBUG - cur time: 2024-06-15T23:59:59.999 == next bar open time: 2024-06-16T00:00:00.000 == close pos time: 2024-06-23T00:00:00.000
2024-11-20 23:07:32,954 - INFO - pnl: 2024-06-15T23:59:59.999 128446.67990800481 === -1.976%
2024-11-20 23:07:32,960 - DEBUG - cur time: 2024-06-16T23:59:59.999 == next bar open time: 2024-06-17T00:00:00.000 == close pos time: 2024-06-24T00:00:00.000
2024-11-20 23:07:32,962 - INFO - pnl: 2024-06-16T23:59:59.999 128426.87303152446 === -0.015%
2024-11-20 23:07:32,967 - DEBUG - cur time: 2024-06-17T23:59:59.999 == next bar open time: 2024-06-18T00:00:00.000 == close pos time: 2024-06-25T00:00:00.000
2024-11-20 23:07:32,968 - INFO - pnl: 2024-06-17T23:59:59.999 126663.20075916252 === -1.373%
2024-11-20 23:07:32,971 - DEBUG - cur time: 2024-06-18T23:59:59.999 == next bar open time: 2024-06-19T00:00:00.000 == close pos time: 2024-06-26T00:00:00.000
2024-11-20 23:07:32,973 - INFO - pnl: 2024-06-18T23:59:59.999 126560.96442409928 === -0.081%
2024-11-20 23:07:32,977 - DEBUG - cur time: 2024-06-19T23:59:59.999 == next bar open time: 2024-06-20T00:00:00.000 == close pos time: 2024-06-27T00:00:00.000
2024-11-20 23:07:32,978 - INFO - pnl: 2024-06-19T23:59:59.999 127114.91218813545 === 0.438%
2024-11-20 23:07:32,982 - DEBUG - cur time: 2024-06-20T23:59:59.999 == next bar open time: 2024-06-21T00:00:00.000 == close pos time: 2024-06-28T00:00:00.000
2024-11-20 23:07:32,995 - DEBUG - sorted_long_factors: shape: (235, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT     ┆ -2.039224    ┆ 0    ┆ 234          │
│ TONUSDT     ┆ -2.006142    ┆ 1    ┆ 233          │
│ BTCDOMUSDT  ┆ -1.86727     ┆ 2    ┆ 232          │
│ ONDOUSDT    ┆ -1.854215    ┆ 3    ┆ 231          │
│ HIGHUSDT    ┆ -1.790973    ┆ 4    ┆ 230          │
│ XMRUSDT     ┆ -1.786724    ┆ 5    ┆ 229          │
│ ZETAUSDT    ┆ -1.760105    ┆ 6    ┆ 228          │
│ AUCTIONUSDT ┆ -1.714662    ┆ 7    ┆ 227          │
│ OMUSDT      ┆ -1.697923    ┆ 8    ┆ 226          │
│ PEOPLEUSDT  ┆ -1.680065    ┆ 9    ┆ 225          │
│ …           ┆ …            ┆ …    ┆ …            │
│ BALUSDT     ┆ 0.174735     ┆ 225  ┆ 9            │
│ RLCUSDT     ┆ 0.176766     ┆ 226  ┆ 8            │
│ PHBUSDT     ┆ 0.197314     ┆ 227  ┆ 7            │
│ HFTUSDT     ┆ 0.217637     ┆ 228  ┆ 6            │
│ DARUSDT     ┆ 0.23552      ┆ 229  ┆ 5            │
│ DODOXUSDT   ┆ 0.345642     ┆ 230  ┆ 4            │
│ ETHWUSDT    ┆ 0.355668     ┆ 231  ┆ 3            │
│ BONDUSDT    ┆ 0.466007     ┆ 232  ┆ 2            │
│ NMRUSDT     ┆ 0.694336     ┆ 233  ┆ 1            │
│ DEFIUSDT    ┆ 1.754298     ┆ 234  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:33,000 - WARNING - 2024-06-20T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:33,000 - INFO - cur close time: 2024-06-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:33,001 - DEBUG - mean expected ret (mean factor): -0.7917144739802982
2024-11-20 23:07:33,004 - DEBUG - begin to update pos: =========
2024-11-20 23:07:33,005 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,005 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.021131    ┆ 0.17545     ┆ 0.09058     ┆ 0.0109885   ┆ … ┆ 0.01717 ┆ null   ┆ null    ┆ 0.3604  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,010 - DEBUG - update position: 2024-06-20T23:59:59.999 === diff_trading_value: 199494.3030855312 == cash: 127708.9728915163 
2024-11-20 23:07:33,011 - INFO - pnl: 2024-06-20T23:59:59.999 127708.9728915163 === 0.467%
2024-11-20 23:07:33,015 - DEBUG - cur time: 2024-06-21T23:59:59.999 == next bar open time: 2024-06-22T00:00:00.000 == close pos time: 2024-06-29T00:00:00.000
2024-11-20 23:07:33,016 - INFO - pnl: 2024-06-21T23:59:59.999 128208.15840010656 === 0.391%
2024-11-20 23:07:33,019 - DEBUG - cur time: 2024-06-22T23:59:59.999 == next bar open time: 2024-06-23T00:00:00.000 == close pos time: 2024-06-30T00:00:00.000
2024-11-20 23:07:33,020 - INFO - pnl: 2024-06-22T23:59:59.999 127546.7778288672 === -0.516%
2024-11-20 23:07:33,023 - DEBUG - cur time: 2024-06-23T23:59:59.999 == next bar open time: 2024-06-24T00:00:00.000 == close pos time: 2024-07-01T00:00:00.000
2024-11-20 23:07:33,023 - INFO - pnl: 2024-06-23T23:59:59.999 125732.33096444476 === -1.423%
2024-11-20 23:07:33,026 - DEBUG - cur time: 2024-06-24T23:59:59.999 == next bar open time: 2024-06-25T00:00:00.000 == close pos time: 2024-07-02T00:00:00.000
2024-11-20 23:07:33,028 - INFO - pnl: 2024-06-24T23:59:59.999 124474.42835660496 === -1.000%
2024-11-20 23:07:33,031 - DEBUG - cur time: 2024-06-25T23:59:59.999 == next bar open time: 2024-06-26T00:00:00.000 == close pos time: 2024-07-03T00:00:00.000
2024-11-20 23:07:33,033 - INFO - pnl: 2024-06-25T23:59:59.999 124719.0408356086 === 0.197%
2024-11-20 23:07:33,035 - DEBUG - cur time: 2024-06-26T23:59:59.999 == next bar open time: 2024-06-27T00:00:00.000 == close pos time: 2024-07-04T00:00:00.000
2024-11-20 23:07:33,037 - INFO - pnl: 2024-06-26T23:59:59.999 124950.74087111627 === 0.186%
2024-11-20 23:07:33,040 - DEBUG - cur time: 2024-06-27T23:59:59.999 == next bar open time: 2024-06-28T00:00:00.000 == close pos time: 2024-07-05T00:00:00.000
2024-11-20 23:07:33,058 - DEBUG - sorted_long_factors: shape: (240, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ TRBUSDT     ┆ -2.244518    ┆ 0    ┆ 239          │
│ HIGHUSDT    ┆ -2.103898    ┆ 1    ┆ 238          │
│ FILUSDT     ┆ -2.054068    ┆ 2    ┆ 237          │
│ APTUSDT     ┆ -1.995845    ┆ 3    ┆ 236          │
│ GASUSDT     ┆ -1.949034    ┆ 4    ┆ 235          │
│ AUCTIONUSDT ┆ -1.926548    ┆ 5    ┆ 234          │
│ MANTAUSDT   ┆ -1.924604    ┆ 6    ┆ 233          │
│ STRKUSDT    ┆ -1.899931    ┆ 7    ┆ 232          │
│ LPTUSDT     ┆ -1.861832    ┆ 8    ┆ 231          │
│ ETHFIUSDT   ┆ -1.859054    ┆ 9    ┆ 230          │
│ …           ┆ …            ┆ …    ┆ …            │
│ XVGUSDT     ┆ 0.145699     ┆ 230  ┆ 9            │
│ NMRUSDT     ┆ 0.186549     ┆ 231  ┆ 8            │
│ TLMUSDT     ┆ 0.207499     ┆ 232  ┆ 7            │
│ DODOXUSDT   ┆ 0.387868     ┆ 233  ┆ 6            │
│ JOEUSDT     ┆ 0.546358     ┆ 234  ┆ 5            │
│ DARUSDT     ┆ 0.548934     ┆ 235  ┆ 4            │
│ OXTUSDT     ┆ 0.569587     ┆ 236  ┆ 3            │
│ XEMUSDT     ┆ 0.59424      ┆ 237  ┆ 2            │
│ NTRNUSDT    ┆ 0.614448     ┆ 238  ┆ 1            │
│ DEFIUSDT    ┆ 1.173216     ┆ 239  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:33,069 - WARNING - 2024-06-27T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:33,069 - INFO - cur close time: 2024-06-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:33,069 - DEBUG - mean expected ret (mean factor): -0.7850132270085696
2024-11-20 23:07:33,074 - DEBUG - begin to update pos: =========
2024-11-20 23:07:33,075 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,075 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024654    ┆ 0.17401     ┆ 0.08225     ┆ 0.0125913   ┆ … ┆ 0.01809 ┆ null   ┆ null    ┆ 0.3736  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,086 - DEBUG - update position: 2024-06-27T23:59:59.999 === diff_trading_value: 253371.0770120322 == cash: 126982.5641739954 
2024-11-20 23:07:33,089 - INFO - pnl: 2024-06-27T23:59:59.999 126982.5641739954 === 1.626%
2024-11-20 23:07:33,093 - DEBUG - cur time: 2024-06-28T23:59:59.999 == next bar open time: 2024-06-29T00:00:00.000 == close pos time: 2024-07-06T00:00:00.000
2024-11-20 23:07:33,096 - INFO - pnl: 2024-06-28T23:59:59.999 128159.74192859848 === 0.927%
2024-11-20 23:07:33,100 - DEBUG - cur time: 2024-06-29T23:59:59.999 == next bar open time: 2024-06-30T00:00:00.000 == close pos time: 2024-07-07T00:00:00.000
2024-11-20 23:07:33,103 - INFO - pnl: 2024-06-29T23:59:59.999 128493.86326738534 === 0.261%
2024-11-20 23:07:33,107 - DEBUG - cur time: 2024-06-30T23:59:59.999 == next bar open time: 2024-07-01T00:00:00.000 == close pos time: 2024-07-08T00:00:00.000
2024-11-20 23:07:33,110 - INFO - pnl: 2024-06-30T23:59:59.999 129485.23800800864 === 0.772%
2024-11-20 23:07:33,114 - DEBUG - cur time: 2024-07-01T23:59:59.999 == next bar open time: 2024-07-02T00:00:00.000 == close pos time: 2024-07-09T00:00:00.000
2024-11-20 23:07:33,116 - INFO - pnl: 2024-07-01T23:59:59.999 129863.2559800195 === 0.292%
2024-11-20 23:07:33,124 - DEBUG - cur time: 2024-07-02T23:59:59.999 == next bar open time: 2024-07-03T00:00:00.000 == close pos time: 2024-07-10T00:00:00.000
2024-11-20 23:07:33,126 - INFO - pnl: 2024-07-02T23:59:59.999 131993.45129664667 === 1.640%
2024-11-20 23:07:33,131 - DEBUG - cur time: 2024-07-03T23:59:59.999 == next bar open time: 2024-07-04T00:00:00.000 == close pos time: 2024-07-11T00:00:00.000
2024-11-20 23:07:33,134 - INFO - pnl: 2024-07-03T23:59:59.999 132457.3396301098 === 0.351%
2024-11-20 23:07:33,139 - DEBUG - cur time: 2024-07-04T23:59:59.999 == next bar open time: 2024-07-05T00:00:00.000 == close pos time: 2024-07-12T00:00:00.000
2024-11-20 23:07:33,155 - DEBUG - sorted_long_factors: shape: (240, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ TONUSDT    ┆ -2.061547    ┆ 0    ┆ 239          │
│ GASUSDT    ┆ -2.051682    ┆ 1    ┆ 238          │
│ OMUSDT     ┆ -2.031641    ┆ 2    ┆ 237          │
│ LSKUSDT    ┆ -2.02813     ┆ 3    ┆ 236          │
│ JUPUSDT    ┆ -1.832782    ┆ 4    ┆ 235          │
│ MANTAUSDT  ┆ -1.674557    ┆ 5    ┆ 234          │
│ AEVOUSDT   ┆ -1.641806    ┆ 6    ┆ 233          │
│ ADAUSDT    ┆ -1.601933    ┆ 7    ┆ 232          │
│ FETUSDT    ┆ -1.588425    ┆ 8    ┆ 231          │
│ EGLDUSDT   ┆ -1.58751     ┆ 9    ┆ 230          │
│ …          ┆ …            ┆ …    ┆ …            │
│ SKLUSDT    ┆ -0.023948    ┆ 230  ┆ 9            │
│ BNTUSDT    ┆ 0.000977     ┆ 231  ┆ 8            │
│ PERPUSDT   ┆ 0.033939     ┆ 232  ┆ 7            │
│ NKNUSDT    ┆ 0.093624     ┆ 233  ┆ 6            │
│ DODOXUSDT  ┆ 0.14319      ┆ 234  ┆ 5            │
│ STEEMUSDT  ┆ 0.189863     ┆ 235  ┆ 4            │
│ BICOUSDT   ┆ 0.203454     ┆ 236  ┆ 3            │
│ BADGERUSDT ┆ 0.268207     ┆ 237  ┆ 2            │
│ OXTUSDT    ┆ 0.95658      ┆ 238  ┆ 1            │
│ DEFIUSDT   ┆ 1.748069     ┆ 239  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:33,164 - WARNING - 2024-07-04T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:33,164 - INFO - cur close time: 2024-07-04T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:33,164 - DEBUG - mean expected ret (mean factor): -0.7913950003605129
2024-11-20 23:07:33,168 - DEBUG - begin to update pos: =========
2024-11-20 23:07:33,168 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,169 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.020664    ┆ 0.14241     ┆ 0.06861     ┆ 0.0089251   ┆ … ┆ 0.01522 ┆ null   ┆ null    ┆ 0.3024  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,178 - DEBUG - update position: 2024-07-04T23:59:59.999 === diff_trading_value: 255307.04928291735 == cash: 132206.08020713876 
2024-11-20 23:07:33,180 - INFO - pnl: 2024-07-04T23:59:59.999 132206.08020713876 === -0.190%
2024-11-20 23:07:33,183 - DEBUG - cur time: 2024-07-05T23:59:59.999 == next bar open time: 2024-07-06T00:00:00.000 == close pos time: 2024-07-13T00:00:00.000
2024-11-20 23:07:33,184 - INFO - pnl: 2024-07-05T23:59:59.999 132742.81889121162 === 0.406%
2024-11-20 23:07:33,188 - DEBUG - cur time: 2024-07-06T23:59:59.999 == next bar open time: 2024-07-07T00:00:00.000 == close pos time: 2024-07-14T00:00:00.000
2024-11-20 23:07:33,190 - INFO - pnl: 2024-07-06T23:59:59.999 131094.04744844118 === -1.242%
2024-11-20 23:07:33,195 - DEBUG - cur time: 2024-07-07T23:59:59.999 == next bar open time: 2024-07-08T00:00:00.000 == close pos time: 2024-07-15T00:00:00.000
2024-11-20 23:07:33,196 - INFO - pnl: 2024-07-07T23:59:59.999 130584.31984792107 === -0.389%
2024-11-20 23:07:33,200 - DEBUG - cur time: 2024-07-08T23:59:59.999 == next bar open time: 2024-07-09T00:00:00.000 == close pos time: 2024-07-16T00:00:00.000
2024-11-20 23:07:33,203 - INFO - pnl: 2024-07-08T23:59:59.999 129132.7454465839 === -1.112%
2024-11-20 23:07:33,206 - DEBUG - cur time: 2024-07-09T23:59:59.999 == next bar open time: 2024-07-10T00:00:00.000 == close pos time: 2024-07-17T00:00:00.000
2024-11-20 23:07:33,208 - INFO - pnl: 2024-07-09T23:59:59.999 128287.8800443651 === -0.654%
2024-11-20 23:07:33,211 - DEBUG - cur time: 2024-07-10T23:59:59.999 == next bar open time: 2024-07-11T00:00:00.000 == close pos time: 2024-07-18T00:00:00.000
2024-11-20 23:07:33,213 - INFO - pnl: 2024-07-10T23:59:59.999 127963.43191778933 === -0.253%
2024-11-20 23:07:33,219 - DEBUG - cur time: 2024-07-11T23:59:59.999 == next bar open time: 2024-07-12T00:00:00.000 == close pos time: 2024-07-19T00:00:00.000
2024-11-20 23:07:33,230 - DEBUG - sorted_long_factors: shape: (238, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ OMUSDT     ┆ -2.167469    ┆ 0    ┆ 237          │
│ TONUSDT    ┆ -2.105563    ┆ 1    ┆ 236          │
│ BALUSDT    ┆ -1.795651    ┆ 2    ┆ 235          │
│ JUPUSDT    ┆ -1.756752    ┆ 3    ┆ 234          │
│ CYBERUSDT  ┆ -1.715953    ┆ 4    ┆ 233          │
│ BOMEUSDT   ┆ -1.695798    ┆ 5    ┆ 232          │
│ BEAMXUSDT  ┆ -1.674158    ┆ 6    ┆ 231          │
│ ASTRUSDT   ┆ -1.670283    ┆ 7    ┆ 230          │
│ WIFUSDT    ┆ -1.667469    ┆ 8    ┆ 229          │
│ DYMUSDT    ┆ -1.658219    ┆ 9    ┆ 228          │
│ …          ┆ …            ┆ …    ┆ …            │
│ XVGUSDT    ┆ -0.019718    ┆ 228  ┆ 9            │
│ STEEMUSDT  ┆ 0.019092     ┆ 229  ┆ 8            │
│ AGLDUSDT   ┆ 0.058667     ┆ 230  ┆ 7            │
│ HOOKUSDT   ┆ 0.064453     ┆ 231  ┆ 6            │
│ HIGHUSDT   ┆ 0.139116     ┆ 232  ┆ 5            │
│ SUPERUSDT  ┆ 0.156269     ┆ 233  ┆ 4            │
│ BADGERUSDT ┆ 0.157986     ┆ 234  ┆ 3            │
│ GMXUSDT    ┆ 0.209263     ┆ 235  ┆ 2            │
│ DODOXUSDT  ┆ 0.641834     ┆ 236  ┆ 1            │
│ DEFIUSDT   ┆ 1.590921     ┆ 237  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:33,237 - WARNING - 2024-07-11T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:33,237 - INFO - cur close time: 2024-07-11T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:33,238 - DEBUG - mean expected ret (mean factor): -0.7971558773270958
2024-11-20 23:07:33,242 - DEBUG - begin to update pos: =========
2024-11-20 23:07:33,242 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,243 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.023492    ┆ 0.14324     ┆ 0.0697      ┆ 0.0088944   ┆ … ┆ 0.01542 ┆ null   ┆ null    ┆ 0.3134  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,249 - DEBUG - update position: 2024-07-11T23:59:59.999 === diff_trading_value: 260311.27058063092 == cash: 127113.83141954297 
2024-11-20 23:07:33,250 - INFO - pnl: 2024-07-11T23:59:59.999 127113.83141954297 === -0.664%
2024-11-20 23:07:33,254 - DEBUG - cur time: 2024-07-12T23:59:59.999 == next bar open time: 2024-07-13T00:00:00.000 == close pos time: 2024-07-20T00:00:00.000
2024-11-20 23:07:33,255 - INFO - pnl: 2024-07-12T23:59:59.999 127575.70266338735 === 0.363%
2024-11-20 23:07:33,258 - DEBUG - cur time: 2024-07-13T23:59:59.999 == next bar open time: 2024-07-14T00:00:00.000 == close pos time: 2024-07-21T00:00:00.000
2024-11-20 23:07:33,259 - INFO - pnl: 2024-07-13T23:59:59.999 127032.98907834946 === -0.425%
2024-11-20 23:07:33,263 - DEBUG - cur time: 2024-07-14T23:59:59.999 == next bar open time: 2024-07-15T00:00:00.000 == close pos time: 2024-07-22T00:00:00.000
2024-11-20 23:07:33,264 - INFO - pnl: 2024-07-14T23:59:59.999 127787.0307551225 === 0.594%
2024-11-20 23:07:33,268 - DEBUG - cur time: 2024-07-15T23:59:59.999 == next bar open time: 2024-07-16T00:00:00.000 == close pos time: 2024-07-23T00:00:00.000
2024-11-20 23:07:33,270 - INFO - pnl: 2024-07-15T23:59:59.999 123992.4405836688 === -2.969%
2024-11-20 23:07:33,273 - DEBUG - cur time: 2024-07-16T23:59:59.999 == next bar open time: 2024-07-17T00:00:00.000 == close pos time: 2024-07-24T00:00:00.000
2024-11-20 23:07:33,274 - INFO - pnl: 2024-07-16T23:59:59.999 122022.67029828516 === -1.589%
2024-11-20 23:07:33,277 - DEBUG - cur time: 2024-07-17T23:59:59.999 == next bar open time: 2024-07-18T00:00:00.000 == close pos time: 2024-07-25T00:00:00.000
2024-11-20 23:07:33,278 - INFO - pnl: 2024-07-17T23:59:59.999 121895.22033353348 === -0.104%
2024-11-20 23:07:33,281 - DEBUG - cur time: 2024-07-18T23:59:59.999 == next bar open time: 2024-07-19T00:00:00.000 == close pos time: 2024-07-26T00:00:00.000
2024-11-20 23:07:33,290 - DEBUG - sorted_long_factors: shape: (241, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ DYMUSDT   ┆ -2.027042    ┆ 0    ┆ 240          │
│ TONUSDT   ┆ -1.982821    ┆ 1    ┆ 239          │
│ INJUSDT   ┆ -1.930623    ┆ 2    ┆ 238          │
│ WIFUSDT   ┆ -1.878223    ┆ 3    ┆ 237          │
│ JUPUSDT   ┆ -1.799384    ┆ 4    ┆ 236          │
│ AXSUSDT   ┆ -1.768175    ┆ 5    ┆ 235          │
│ ONDOUSDT  ┆ -1.735063    ┆ 6    ┆ 234          │
│ RUNEUSDT  ┆ -1.710745    ┆ 7    ┆ 233          │
│ AAVEUSDT  ┆ -1.701151    ┆ 8    ┆ 232          │
│ MANTAUSDT ┆ -1.700897    ┆ 9    ┆ 231          │
│ …         ┆ …            ┆ …    ┆ …            │
│ SPELLUSDT ┆ 0.014858     ┆ 231  ┆ 9            │
│ ARPAUSDT  ┆ 0.017271     ┆ 232  ┆ 8            │
│ RENUSDT   ┆ 0.056432     ┆ 233  ┆ 7            │
│ SKLUSDT   ┆ 0.083785     ┆ 234  ┆ 6            │
│ XVGUSDT   ┆ 0.135117     ┆ 235  ┆ 5            │
│ AMBUSDT   ┆ 0.142922     ┆ 236  ┆ 4            │
│ HFTUSDT   ┆ 0.295574     ┆ 237  ┆ 3            │
│ ORBSUSDT  ┆ 0.381242     ┆ 238  ┆ 2            │
│ DODOXUSDT ┆ 0.635377     ┆ 239  ┆ 1            │
│ DEFIUSDT  ┆ 1.62         ┆ 240  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:33,301 - WARNING - 2024-07-18T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:33,301 - INFO - cur close time: 2024-07-18T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:33,301 - DEBUG - mean expected ret (mean factor): -0.8030554698862377
2024-11-20 23:07:33,306 - DEBUG - begin to update pos: =========
2024-11-20 23:07:33,306 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,307 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.026848    ┆ 0.17379     ┆ 0.08763     ┆ 0.0116449   ┆ … ┆ 0.01722 ┆ null   ┆ null    ┆ 0.3532  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,316 - DEBUG - update position: 2024-07-18T23:59:59.999 === diff_trading_value: 301961.4313727417 == cash: 117116.49994430611 
2024-11-20 23:07:33,317 - INFO - pnl: 2024-07-18T23:59:59.999 117116.49994430611 === -3.920%
2024-11-20 23:07:33,320 - DEBUG - cur time: 2024-07-19T23:59:59.999 == next bar open time: 2024-07-20T00:00:00.000 == close pos time: 2024-07-27T00:00:00.000
2024-11-20 23:07:33,321 - INFO - pnl: 2024-07-19T23:59:59.999 119644.51138735618 === 2.159%
2024-11-20 23:07:33,325 - DEBUG - cur time: 2024-07-20T23:59:59.999 == next bar open time: 2024-07-21T00:00:00.000 == close pos time: 2024-07-28T00:00:00.000
2024-11-20 23:07:33,326 - INFO - pnl: 2024-07-20T23:59:59.999 118950.42864149573 === -0.580%
2024-11-20 23:07:33,329 - DEBUG - cur time: 2024-07-21T23:59:59.999 == next bar open time: 2024-07-22T00:00:00.000 == close pos time: 2024-07-29T00:00:00.000
2024-11-20 23:07:33,330 - INFO - pnl: 2024-07-21T23:59:59.999 120604.08446520037 === 1.390%
2024-11-20 23:07:33,334 - DEBUG - cur time: 2024-07-22T23:59:59.999 == next bar open time: 2024-07-23T00:00:00.000 == close pos time: 2024-07-30T00:00:00.000
2024-11-20 23:07:33,336 - INFO - pnl: 2024-07-22T23:59:59.999 120008.22693498904 === -0.494%
2024-11-20 23:07:33,339 - DEBUG - cur time: 2024-07-23T23:59:59.999 == next bar open time: 2024-07-24T00:00:00.000 == close pos time: 2024-07-31T00:00:00.000
2024-11-20 23:07:33,340 - INFO - pnl: 2024-07-23T23:59:59.999 120984.09761777849 === 0.813%
2024-11-20 23:07:33,345 - DEBUG - cur time: 2024-07-24T23:59:59.999 == next bar open time: 2024-07-25T00:00:00.000 == close pos time: 2024-08-01T00:00:00.000
2024-11-20 23:07:33,346 - INFO - pnl: 2024-07-24T23:59:59.999 120652.26532986468 === -0.274%
2024-11-20 23:07:33,350 - DEBUG - cur time: 2024-07-25T23:59:59.999 == next bar open time: 2024-07-26T00:00:00.000 == close pos time: 2024-08-02T00:00:00.000
2024-11-20 23:07:33,361 - DEBUG - sorted_long_factors: shape: (243, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ UNIUSDT    ┆ -1.847992    ┆ 0    ┆ 242          │
│ XAIUSDT    ┆ -1.804445    ┆ 1    ┆ 241          │
│ ETHFIUSDT  ┆ -1.790149    ┆ 2    ┆ 240          │
│ AXLUSDT    ┆ -1.695572    ┆ 3    ┆ 239          │
│ STRKUSDT   ┆ -1.691337    ┆ 4    ┆ 238          │
│ TIAUSDT    ┆ -1.685272    ┆ 5    ┆ 237          │
│ TONUSDT    ┆ -1.598315    ┆ 6    ┆ 236          │
│ TNSRUSDT   ┆ -1.58807     ┆ 7    ┆ 235          │
│ DYMUSDT    ┆ -1.572774    ┆ 8    ┆ 234          │
│ SEIUSDT    ┆ -1.569021    ┆ 9    ┆ 233          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BADGERUSDT ┆ -0.008662    ┆ 233  ┆ 9            │
│ ORBSUSDT   ┆ 0.151261     ┆ 234  ┆ 8            │
│ PERPUSDT   ┆ 0.181023     ┆ 235  ┆ 7            │
│ BICOUSDT   ┆ 0.187088     ┆ 236  ┆ 6            │
│ XVGUSDT    ┆ 0.252828     ┆ 237  ┆ 5            │
│ RLCUSDT    ┆ 0.291387     ┆ 238  ┆ 4            │
│ BNTUSDT    ┆ 0.30949      ┆ 239  ┆ 3            │
│ LQTYUSDT   ┆ 0.386485     ┆ 240  ┆ 2            │
│ DODOXUSDT  ┆ 0.820878     ┆ 241  ┆ 1            │
│ DEFIUSDT   ┆ 1.12771      ┆ 242  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:33,370 - WARNING - 2024-07-25T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:33,370 - INFO - cur close time: 2024-07-25T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:33,370 - DEBUG - mean expected ret (mean factor): -0.8002229737839275
2024-11-20 23:07:33,375 - DEBUG - begin to update pos: =========
2024-11-20 23:07:33,376 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,376 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.027009    ┆ 0.17468     ┆ 0.08141     ┆ 0.0114723   ┆ … ┆ 0.01635 ┆ null   ┆ null    ┆ 0.3516  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,381 - DEBUG - update position: 2024-07-25T23:59:59.999 === diff_trading_value: 279295.31201578287 == cash: 118842.47177247044 
2024-11-20 23:07:33,383 - INFO - pnl: 2024-07-25T23:59:59.999 118842.47177247044 === -1.500%
2024-11-20 23:07:33,385 - DEBUG - cur time: 2024-07-26T23:59:59.999 == next bar open time: 2024-07-27T00:00:00.000 == close pos time: 2024-08-03T00:00:00.000
2024-11-20 23:07:33,387 - INFO - pnl: 2024-07-26T23:59:59.999 120710.28199573152 === 1.572%
2024-11-20 23:07:33,391 - DEBUG - cur time: 2024-07-27T23:59:59.999 == next bar open time: 2024-07-28T00:00:00.000 == close pos time: 2024-08-04T00:00:00.000
2024-11-20 23:07:33,393 - INFO - pnl: 2024-07-27T23:59:59.999 122662.82084516025 === 1.618%
2024-11-20 23:07:33,398 - DEBUG - cur time: 2024-07-28T23:59:59.999 == next bar open time: 2024-07-29T00:00:00.000 == close pos time: 2024-08-05T00:00:00.000
2024-11-20 23:07:33,399 - INFO - pnl: 2024-07-28T23:59:59.999 123945.09310169984 === 1.045%
2024-11-20 23:07:33,405 - DEBUG - cur time: 2024-07-29T23:59:59.999 == next bar open time: 2024-07-30T00:00:00.000 == close pos time: 2024-08-06T00:00:00.000
2024-11-20 23:07:33,407 - INFO - pnl: 2024-07-29T23:59:59.999 127964.89701057483 === 3.243%
2024-11-20 23:07:33,414 - DEBUG - cur time: 2024-07-30T23:59:59.999 == next bar open time: 2024-07-31T00:00:00.000 == close pos time: 2024-08-07T00:00:00.000
2024-11-20 23:07:33,416 - INFO - pnl: 2024-07-30T23:59:59.999 128614.21742277217 === 0.507%
2024-11-20 23:07:33,419 - DEBUG - cur time: 2024-07-31T23:59:59.999 == next bar open time: 2024-08-01T00:00:00.000 == close pos time: 2024-08-08T00:00:00.000
2024-11-20 23:07:33,421 - INFO - pnl: 2024-07-31T23:59:59.999 129109.18099746919 === 0.385%
2024-11-20 23:07:33,428 - DEBUG - cur time: 2024-08-01T23:59:59.999 == next bar open time: 2024-08-02T00:00:00.000 == close pos time: 2024-08-09T00:00:00.000
2024-11-20 23:07:33,446 - DEBUG - sorted_long_factors: shape: (244, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ ETHFIUSDT ┆ -2.133776    ┆ 0    ┆ 243          │
│ TONUSDT   ┆ -2.071314    ┆ 1    ┆ 242          │
│ JUPUSDT   ┆ -1.973131    ┆ 2    ┆ 241          │
│ OMUSDT    ┆ -1.837967    ┆ 3    ┆ 240          │
│ ENAUSDT   ┆ -1.789363    ┆ 4    ┆ 239          │
│ STRKUSDT  ┆ -1.787469    ┆ 5    ┆ 238          │
│ OPUSDT    ┆ -1.759664    ┆ 6    ┆ 237          │
│ TRBUSDT   ┆ -1.759332    ┆ 7    ┆ 236          │
│ ARBUSDT   ┆ -1.679667    ┆ 8    ┆ 235          │
│ ALTUSDT   ┆ -1.646724    ┆ 9    ┆ 234          │
│ …         ┆ …            ┆ …    ┆ …            │
│ RLCUSDT   ┆ -0.005058    ┆ 234  ┆ 9            │
│ NMRUSDT   ┆ 0.110203     ┆ 235  ┆ 8            │
│ BICOUSDT  ┆ 0.132454     ┆ 236  ┆ 7            │
│ LRCUSDT   ┆ 0.148505     ┆ 237  ┆ 6            │
│ COMBOUSDT ┆ 0.28804      ┆ 238  ┆ 5            │
│ BNTUSDT   ┆ 0.333892     ┆ 239  ┆ 4            │
│ XVGUSDT   ┆ 0.394148     ┆ 240  ┆ 3            │
│ AGLDUSDT  ┆ 0.56033      ┆ 241  ┆ 2            │
│ DEFIUSDT  ┆ 0.564401     ┆ 242  ┆ 1            │
│ ATAUSDT   ┆ 0.687171     ┆ 243  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:33,452 - INFO - cur close time: 2024-08-01T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:33,452 - DEBUG - mean expected ret (mean factor): -0.7978665737127434
2024-11-20 23:07:33,457 - DEBUG - begin to update pos: =========
2024-11-20 23:07:33,457 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,458 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.024971    ┆ 0.15707     ┆ 0.07808     ┆ 0.0105151   ┆ … ┆ 0.01607 ┆ null   ┆ null    ┆ 0.3492  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,464 - DEBUG - update position: 2024-08-01T23:59:59.999 === diff_trading_value: 244938.30313744783 == cash: 129794.31431816125 
2024-11-20 23:07:33,465 - INFO - pnl: 2024-08-01T23:59:59.999 129794.31431816125 === 0.531%
2024-11-20 23:07:33,468 - DEBUG - cur time: 2024-08-02T23:59:59.999 == next bar open time: 2024-08-03T00:00:00.000 == close pos time: 2024-08-10T00:00:00.000
2024-11-20 23:07:33,470 - INFO - pnl: 2024-08-02T23:59:59.999 132093.60813740056 === 1.771%
2024-11-20 23:07:33,473 - DEBUG - cur time: 2024-08-03T23:59:59.999 == next bar open time: 2024-08-04T00:00:00.000 == close pos time: 2024-08-11T00:00:00.000
2024-11-20 23:07:33,474 - INFO - pnl: 2024-08-03T23:59:59.999 132171.826011695 === 0.059%
2024-11-20 23:07:33,478 - DEBUG - cur time: 2024-08-04T23:59:59.999 == next bar open time: 2024-08-05T00:00:00.000 == close pos time: 2024-08-12T00:00:00.000
2024-11-20 23:07:33,480 - INFO - pnl: 2024-08-04T23:59:59.999 132842.86852009874 === 0.508%
2024-11-20 23:07:33,484 - DEBUG - cur time: 2024-08-05T23:59:59.999 == next bar open time: 2024-08-06T00:00:00.000 == close pos time: 2024-08-13T00:00:00.000
2024-11-20 23:07:33,485 - INFO - pnl: 2024-08-05T23:59:59.999 135266.65413604188 === 1.825%
2024-11-20 23:07:33,489 - DEBUG - cur time: 2024-08-06T23:59:59.999 == next bar open time: 2024-08-07T00:00:00.000 == close pos time: 2024-08-14T00:00:00.000
2024-11-20 23:07:33,491 - INFO - pnl: 2024-08-06T23:59:59.999 133202.93034377115 === -1.526%
2024-11-20 23:07:33,494 - DEBUG - cur time: 2024-08-07T23:59:59.999 == next bar open time: 2024-08-08T00:00:00.000 == close pos time: 2024-08-15T00:00:00.000
2024-11-20 23:07:33,496 - INFO - pnl: 2024-08-07T23:59:59.999 135424.45688262567 === 1.668%
2024-11-20 23:07:33,501 - DEBUG - cur time: 2024-08-08T23:59:59.999 == next bar open time: 2024-08-09T00:00:00.000 == close pos time: 2024-08-16T00:00:00.000
2024-11-20 23:07:33,513 - DEBUG - sorted_long_factors: shape: (244, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ BTCDOMUSDT ┆ -3.096418    ┆ 0    ┆ 243          │
│ ZENUSDT    ┆ -2.500262    ┆ 1    ┆ 242          │
│ FXSUSDT    ┆ -2.194781    ┆ 2    ┆ 241          │
│ ACEUSDT    ┆ -2.139642    ┆ 3    ┆ 240          │
│ BOMEUSDT   ┆ -2.055407    ┆ 4    ┆ 239          │
│ BNXUSDT    ┆ -2.040804    ┆ 5    ┆ 238          │
│ TRBUSDT    ┆ -1.975455    ┆ 6    ┆ 237          │
│ USDCUSDT   ┆ -1.97246     ┆ 7    ┆ 236          │
│ BSVUSDT    ┆ -1.947317    ┆ 8    ┆ 235          │
│ CRVUSDT    ┆ -1.903265    ┆ 9    ┆ 234          │
│ …          ┆ …            ┆ …    ┆ …            │
│ STEEMUSDT  ┆ 0.281752     ┆ 234  ┆ 9            │
│ SUPERUSDT  ┆ 0.314516     ┆ 235  ┆ 8            │
│ HFTUSDT    ┆ 0.347772     ┆ 236  ┆ 7            │
│ NTRNUSDT   ┆ 0.369555     ┆ 237  ┆ 6            │
│ PERPUSDT   ┆ 0.432555     ┆ 238  ┆ 5            │
│ ETHWUSDT   ┆ 0.473241     ┆ 239  ┆ 4            │
│ BNTUSDT    ┆ 0.490656     ┆ 240  ┆ 3            │
│ AGLDUSDT   ┆ 0.616851     ┆ 241  ┆ 2            │
│ JOEUSDT    ┆ 0.666814     ┆ 242  ┆ 1            │
│ DEFIUSDT   ┆ 1.475035     ┆ 243  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:33,520 - WARNING - 2024-08-08T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:33,520 - INFO - cur close time: 2024-08-08T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:33,520 - DEBUG - mean expected ret (mean factor): -0.807238398376972
2024-11-20 23:07:33,525 - DEBUG - begin to update pos: =========
2024-11-20 23:07:33,525 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,525 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.021732    ┆ 0.1323      ┆ 0.07131     ┆ 0.008763    ┆ … ┆ 0.01405 ┆ null   ┆ null    ┆ 0.3077  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,531 - DEBUG - update position: 2024-08-08T23:59:59.999 === diff_trading_value: 250435.7389696072 == cash: 133531.8275679626 
2024-11-20 23:07:33,534 - INFO - pnl: 2024-08-08T23:59:59.999 133531.8275679626 === -1.398%
2024-11-20 23:07:33,537 - DEBUG - cur time: 2024-08-09T23:59:59.999 == next bar open time: 2024-08-10T00:00:00.000 == close pos time: 2024-08-17T00:00:00.000
2024-11-20 23:07:33,539 - INFO - pnl: 2024-08-09T23:59:59.999 134115.520629104 === 0.437%
2024-11-20 23:07:33,542 - DEBUG - cur time: 2024-08-10T23:59:59.999 == next bar open time: 2024-08-11T00:00:00.000 == close pos time: 2024-08-18T00:00:00.000
2024-11-20 23:07:33,544 - INFO - pnl: 2024-08-10T23:59:59.999 135874.7133979691 === 1.312%
2024-11-20 23:07:33,549 - DEBUG - cur time: 2024-08-11T23:59:59.999 == next bar open time: 2024-08-12T00:00:00.000 == close pos time: 2024-08-19T00:00:00.000
2024-11-20 23:07:33,552 - INFO - pnl: 2024-08-11T23:59:59.999 135323.56978866964 === -0.406%
2024-11-20 23:07:33,557 - DEBUG - cur time: 2024-08-12T23:59:59.999 == next bar open time: 2024-08-13T00:00:00.000 == close pos time: 2024-08-20T00:00:00.000
2024-11-20 23:07:33,559 - INFO - pnl: 2024-08-12T23:59:59.999 133436.562106017 === -1.394%
2024-11-20 23:07:33,562 - DEBUG - cur time: 2024-08-13T23:59:59.999 == next bar open time: 2024-08-14T00:00:00.000 == close pos time: 2024-08-21T00:00:00.000
2024-11-20 23:07:33,563 - INFO - pnl: 2024-08-13T23:59:59.999 134141.23766105482 === 0.528%
2024-11-20 23:07:33,567 - DEBUG - cur time: 2024-08-14T23:59:59.999 == next bar open time: 2024-08-15T00:00:00.000 == close pos time: 2024-08-22T00:00:00.000
2024-11-20 23:07:33,569 - INFO - pnl: 2024-08-14T23:59:59.999 131995.85961987326 === -1.599%
2024-11-20 23:07:33,573 - DEBUG - cur time: 2024-08-15T23:59:59.999 == next bar open time: 2024-08-16T00:00:00.000 == close pos time: 2024-08-23T00:00:00.000
2024-11-20 23:07:33,584 - DEBUG - sorted_long_factors: shape: (245, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ USDCUSDT   ┆ -2.213509    ┆ 0    ┆ 244          │
│ AAVEUSDT   ┆ -2.181111    ┆ 1    ┆ 243          │
│ TRXUSDT    ┆ -2.014937    ┆ 2    ┆ 242          │
│ GLMUSDT    ┆ -1.987098    ┆ 3    ┆ 241          │
│ TONUSDT    ┆ -1.978285    ┆ 4    ┆ 240          │
│ SAGAUSDT   ┆ -1.964775    ┆ 5    ┆ 239          │
│ HOOKUSDT   ┆ -1.826588    ┆ 6    ┆ 238          │
│ FTMUSDT    ┆ -1.779032    ┆ 7    ┆ 237          │
│ BTCDOMUSDT ┆ -1.777239    ┆ 8    ┆ 236          │
│ ZECUSDT    ┆ -1.772121    ┆ 9    ┆ 235          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BNTUSDT    ┆ 0.207882     ┆ 235  ┆ 9            │
│ ATAUSDT    ┆ 0.212243     ┆ 236  ┆ 8            │
│ AGLDUSDT   ┆ 0.224479     ┆ 237  ┆ 7            │
│ NMRUSDT    ┆ 0.238402     ┆ 238  ┆ 6            │
│ MOVRUSDT   ┆ 0.290434     ┆ 239  ┆ 5            │
│ PERPUSDT   ┆ 0.319713     ┆ 240  ┆ 4            │
│ RLCUSDT    ┆ 0.438639     ┆ 241  ┆ 3            │
│ JOEUSDT    ┆ 0.905802     ┆ 242  ┆ 2            │
│ DODOXUSDT  ┆ 0.983482     ┆ 243  ┆ 1            │
│ DEFIUSDT   ┆ 1.719498     ┆ 244  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:33,592 - WARNING - 2024-08-15T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:33,593 - INFO - cur close time: 2024-08-15T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:33,593 - DEBUG - mean expected ret (mean factor): -0.8014513051553619
2024-11-20 23:07:33,598 - DEBUG - begin to update pos: =========
2024-11-20 23:07:33,598 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,599 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.01856     ┆ 0.11578     ┆ 0.07639     ┆ 0.0074418   ┆ … ┆ 0.01327 ┆ null   ┆ null    ┆ 0.2993  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,608 - DEBUG - update position: 2024-08-15T23:59:59.999 === diff_trading_value: 239841.68976233347 == cash: 131068.56714667703 
2024-11-20 23:07:33,609 - INFO - pnl: 2024-08-15T23:59:59.999 131068.56714667703 === -0.703%
2024-11-20 23:07:33,613 - DEBUG - cur time: 2024-08-16T23:59:59.999 == next bar open time: 2024-08-17T00:00:00.000 == close pos time: 2024-08-24T00:00:00.000
2024-11-20 23:07:33,614 - INFO - pnl: 2024-08-16T23:59:59.999 131685.75305628232 === 0.471%
2024-11-20 23:07:33,618 - DEBUG - cur time: 2024-08-17T23:59:59.999 == next bar open time: 2024-08-18T00:00:00.000 == close pos time: 2024-08-25T00:00:00.000
2024-11-20 23:07:33,620 - INFO - pnl: 2024-08-17T23:59:59.999 134446.09141185135 === 2.096%
2024-11-20 23:07:33,624 - DEBUG - cur time: 2024-08-18T23:59:59.999 == next bar open time: 2024-08-19T00:00:00.000 == close pos time: 2024-08-26T00:00:00.000
2024-11-20 23:07:33,626 - INFO - pnl: 2024-08-18T23:59:59.999 138890.02695767817 === 3.305%
2024-11-20 23:07:33,630 - DEBUG - cur time: 2024-08-19T23:59:59.999 == next bar open time: 2024-08-20T00:00:00.000 == close pos time: 2024-08-27T00:00:00.000
2024-11-20 23:07:33,632 - INFO - pnl: 2024-08-19T23:59:59.999 142237.02727175236 === 2.410%
2024-11-20 23:07:33,636 - DEBUG - cur time: 2024-08-20T23:59:59.999 == next bar open time: 2024-08-21T00:00:00.000 == close pos time: 2024-08-28T00:00:00.000
2024-11-20 23:07:33,638 - INFO - pnl: 2024-08-20T23:59:59.999 141779.4761441825 === -0.322%
2024-11-20 23:07:33,642 - DEBUG - cur time: 2024-08-21T23:59:59.999 == next bar open time: 2024-08-22T00:00:00.000 == close pos time: 2024-08-29T00:00:00.000
2024-11-20 23:07:33,645 - INFO - pnl: 2024-08-21T23:59:59.999 146104.6018463867 === 3.051%
2024-11-20 23:07:33,648 - DEBUG - cur time: 2024-08-22T23:59:59.999 == next bar open time: 2024-08-23T00:00:00.000 == close pos time: 2024-08-30T00:00:00.000
2024-11-20 23:07:33,659 - DEBUG - sorted_long_factors: shape: (246, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ TONUSDT      ┆ -2.050906    ┆ 0    ┆ 245          │
│ AUCTIONUSDT  ┆ -1.858114    ┆ 1    ┆ 244          │
│ TIAUSDT      ┆ -1.753788    ┆ 2    ┆ 243          │
│ ETHFIUSDT    ┆ -1.703285    ┆ 3    ┆ 242          │
│ TRBUSDT      ┆ -1.692435    ┆ 4    ┆ 241          │
│ ZETAUSDT     ┆ -1.687928    ┆ 5    ┆ 240          │
│ SAGAUSDT     ┆ -1.660881    ┆ 6    ┆ 239          │
│ BNBUSDT      ┆ -1.586876    ┆ 7    ┆ 238          │
│ 1000LUNCUSDT ┆ -1.552077    ┆ 8    ┆ 237          │
│ MATICUSDT    ┆ -1.550876    ┆ 9    ┆ 236          │
│ …            ┆ …            ┆ …    ┆ …            │
│ OMGUSDT      ┆ 0.180008     ┆ 236  ┆ 9            │
│ LITUSDT      ┆ 0.301897     ┆ 237  ┆ 8            │
│ STEEMUSDT    ┆ 0.33588      ┆ 238  ┆ 7            │
│ BNTUSDT      ┆ 0.368099     ┆ 239  ┆ 6            │
│ ICXUSDT      ┆ 0.391194     ┆ 240  ┆ 5            │
│ OXTUSDT      ┆ 0.59443      ┆ 241  ┆ 4            │
│ DEFIUSDT     ┆ 0.629575     ┆ 242  ┆ 3            │
│ ILVUSDT      ┆ 0.75859      ┆ 243  ┆ 2            │
│ ETHWUSDT     ┆ 0.960426     ┆ 244  ┆ 1            │
│ HFTUSDT      ┆ 0.984424     ┆ 245  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:33,667 - WARNING - 2024-08-22T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:33,667 - INFO - cur close time: 2024-08-22T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:33,667 - DEBUG - mean expected ret (mean factor): -0.7908839515183659
2024-11-20 23:07:33,671 - DEBUG - begin to update pos: =========
2024-11-20 23:07:33,673 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,673 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.018933    ┆ 0.13903     ┆ 0.08505     ┆ 0.0079816   ┆ … ┆ 0.01467 ┆ null   ┆ null    ┆ 0.3293  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,680 - DEBUG - update position: 2024-08-22T23:59:59.999 === diff_trading_value: 310365.61818100326 == cash: 148378.19234789134 
2024-11-20 23:07:33,681 - INFO - pnl: 2024-08-22T23:59:59.999 148378.19234789134 === 1.556%
2024-11-20 23:07:33,686 - DEBUG - cur time: 2024-08-23T23:59:59.999 == next bar open time: 2024-08-24T00:00:00.000 == close pos time: 2024-08-31T00:00:00.000
2024-11-20 23:07:33,687 - INFO - pnl: 2024-08-23T23:59:59.999 144746.7972162747 === -2.447%
2024-11-20 23:07:33,691 - DEBUG - cur time: 2024-08-24T23:59:59.999 == next bar open time: 2024-08-25T00:00:00.000 == close pos time: 2024-09-01T00:00:00.000
2024-11-20 23:07:33,694 - INFO - pnl: 2024-08-24T23:59:59.999 144974.291763292 === 0.157%
2024-11-20 23:07:33,698 - DEBUG - cur time: 2024-08-25T23:59:59.999 == next bar open time: 2024-08-26T00:00:00.000 == close pos time: 2024-09-02T00:00:00.000
2024-11-20 23:07:33,700 - INFO - pnl: 2024-08-25T23:59:59.999 146339.9415403352 === 0.942%
2024-11-20 23:07:33,705 - DEBUG - cur time: 2024-08-26T23:59:59.999 == next bar open time: 2024-08-27T00:00:00.000 == close pos time: 2024-09-03T00:00:00.000
2024-11-20 23:07:33,707 - INFO - pnl: 2024-08-26T23:59:59.999 148952.10647445198 === 1.785%
2024-11-20 23:07:33,711 - DEBUG - cur time: 2024-08-27T23:59:59.999 == next bar open time: 2024-08-28T00:00:00.000 == close pos time: 2024-09-04T00:00:00.000
2024-11-20 23:07:33,713 - INFO - pnl: 2024-08-27T23:59:59.999 148628.21302142262 === -0.217%
2024-11-20 23:07:33,717 - DEBUG - cur time: 2024-08-28T23:59:59.999 == next bar open time: 2024-08-29T00:00:00.000 == close pos time: 2024-09-05T00:00:00.000
2024-11-20 23:07:33,720 - INFO - pnl: 2024-08-28T23:59:59.999 157576.66501980048 === 6.021%
2024-11-20 23:07:33,724 - DEBUG - cur time: 2024-08-29T23:59:59.999 == next bar open time: 2024-08-30T00:00:00.000 == close pos time: 2024-09-06T00:00:00.000
2024-11-20 23:07:33,735 - DEBUG - sorted_long_factors: shape: (246, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ AUCTIONUSDT ┆ -2.228259    ┆ 0    ┆ 245          │
│ BTCDOMUSDT  ┆ -1.911518    ┆ 1    ┆ 244          │
│ BAKEUSDT    ┆ -1.755686    ┆ 2    ┆ 243          │
│ OMNIUSDT    ┆ -1.727937    ┆ 3    ┆ 242          │
│ PENDLEUSDT  ┆ -1.703255    ┆ 4    ┆ 241          │
│ LUNA2USDT   ┆ -1.695536    ┆ 5    ┆ 240          │
│ ATOMUSDT    ┆ -1.62632     ┆ 6    ┆ 239          │
│ GMXUSDT     ┆ -1.590363    ┆ 7    ┆ 238          │
│ ETHFIUSDT   ┆ -1.58057     ┆ 8    ┆ 237          │
│ TAOUSDT     ┆ -1.577986    ┆ 9    ┆ 236          │
│ …           ┆ …            ┆ …    ┆ …            │
│ RLCUSDT     ┆ 0.289946     ┆ 236  ┆ 9            │
│ OMGUSDT     ┆ 0.33661      ┆ 237  ┆ 8            │
│ PERPUSDT    ┆ 0.357902     ┆ 238  ┆ 7            │
│ WAXPUSDT    ┆ 0.37254      ┆ 239  ┆ 6            │
│ XVGUSDT     ┆ 0.468245     ┆ 240  ┆ 5            │
│ LSKUSDT     ┆ 0.483629     ┆ 241  ┆ 4            │
│ AGLDUSDT    ┆ 0.619488     ┆ 242  ┆ 3            │
│ STEEMUSDT   ┆ 0.65519      ┆ 243  ┆ 2            │
│ ETHWUSDT    ┆ 1.403576     ┆ 244  ┆ 1            │
│ DEFIUSDT    ┆ 1.647667     ┆ 245  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:33,743 - WARNING - 2024-08-29T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:33,743 - INFO - cur close time: 2024-08-29T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:33,743 - DEBUG - mean expected ret (mean factor): -0.7744783751482605
2024-11-20 23:07:33,748 - DEBUG - begin to update pos: =========
2024-11-20 23:07:33,749 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,749 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.018       ┆ 0.13348     ┆ 0.08236     ┆ 0.0076393   ┆ … ┆ 0.01359 ┆ null   ┆ null    ┆ 0.2976  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,755 - DEBUG - update position: 2024-08-29T23:59:59.999 === diff_trading_value: 252252.48860861306 == cash: 157814.69510729052 
2024-11-20 23:07:33,757 - INFO - pnl: 2024-08-29T23:59:59.999 157814.69510729052 === 0.151%
2024-11-20 23:07:33,764 - DEBUG - cur time: 2024-08-30T23:59:59.999 == next bar open time: 2024-08-31T00:00:00.000 == close pos time: 2024-09-07T00:00:00.000
2024-11-20 23:07:33,766 - INFO - pnl: 2024-08-30T23:59:59.999 157722.0162232954 === -0.059%
2024-11-20 23:07:33,771 - DEBUG - cur time: 2024-08-31T23:59:59.999 == next bar open time: 2024-09-01T00:00:00.000 == close pos time: 2024-09-08T00:00:00.000
2024-11-20 23:07:33,771 - INFO - pnl: 2024-08-31T23:59:59.999 157961.62005895373 === 0.152%
2024-11-20 23:07:33,778 - DEBUG - cur time: 2024-09-01T23:59:59.999 == next bar open time: 2024-09-02T00:00:00.000 == close pos time: 2024-09-09T00:00:00.000
2024-11-20 23:07:33,780 - INFO - pnl: 2024-09-01T23:59:59.999 158612.0466319214 === 0.412%
2024-11-20 23:07:33,787 - DEBUG - cur time: 2024-09-02T23:59:59.999 == next bar open time: 2024-09-03T00:00:00.000 == close pos time: 2024-09-10T00:00:00.000
2024-11-20 23:07:33,790 - INFO - pnl: 2024-09-02T23:59:59.999 159650.75396713128 === 0.655%
2024-11-20 23:07:33,796 - DEBUG - cur time: 2024-09-03T23:59:59.999 == next bar open time: 2024-09-04T00:00:00.000 == close pos time: 2024-09-11T00:00:00.000
2024-11-20 23:07:33,798 - INFO - pnl: 2024-09-03T23:59:59.999 161373.54865341674 === 1.079%
2024-11-20 23:07:33,802 - DEBUG - cur time: 2024-09-04T23:59:59.999 == next bar open time: 2024-09-05T00:00:00.000 == close pos time: 2024-09-12T00:00:00.000
2024-11-20 23:07:33,804 - INFO - pnl: 2024-09-04T23:59:59.999 162524.13328986036 === 0.713%
2024-11-20 23:07:33,809 - DEBUG - cur time: 2024-09-05T23:59:59.999 == next bar open time: 2024-09-06T00:00:00.000 == close pos time: 2024-09-13T00:00:00.000
2024-11-20 23:07:33,825 - DEBUG - sorted_long_factors: shape: (246, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ XMRUSDT    ┆ -2.61259     ┆ 0    ┆ 245          │
│ TONUSDT    ┆ -2.118819    ┆ 1    ┆ 244          │
│ BTCDOMUSDT ┆ -1.943632    ┆ 2    ┆ 243          │
│ APTUSDT    ┆ -1.871856    ┆ 3    ┆ 242          │
│ TAOUSDT    ┆ -1.86092     ┆ 4    ┆ 241          │
│ MKRUSDT    ┆ -1.783591    ┆ 5    ┆ 240          │
│ NOTUSDT    ┆ -1.750779    ┆ 6    ┆ 239          │
│ TRBUSDT    ┆ -1.729185    ┆ 7    ┆ 238          │
│ OMNIUSDT   ┆ -1.692432    ┆ 8    ┆ 237          │
│ BSVUSDT    ┆ -1.678907    ┆ 9    ┆ 236          │
│ …          ┆ …            ┆ …    ┆ …            │
│ ONGUSDT    ┆ 0.155854     ┆ 236  ┆ 9            │
│ WAXPUSDT   ┆ 0.231526     ┆ 237  ┆ 8            │
│ HFTUSDT    ┆ 0.244274     ┆ 238  ┆ 7            │
│ FXSUSDT    ┆ 0.24803      ┆ 239  ┆ 6            │
│ ILVUSDT    ┆ 0.268368     ┆ 240  ┆ 5            │
│ XVGUSDT    ┆ 0.486806     ┆ 241  ┆ 4            │
│ OMGUSDT    ┆ 0.523461     ┆ 242  ┆ 3            │
│ STEEMUSDT  ┆ 0.845099     ┆ 243  ┆ 2            │
│ DEFIUSDT   ┆ 1.345856     ┆ 244  ┆ 1            │
│ ETHWUSDT   ┆ 1.439928     ┆ 245  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:33,838 - WARNING - 2024-09-05T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:33,838 - INFO - cur close time: 2024-09-05T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:33,838 - DEBUG - mean expected ret (mean factor): -0.766904463016952
2024-11-20 23:07:33,844 - DEBUG - begin to update pos: =========
2024-11-20 23:07:33,845 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,845 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.015808    ┆ 0.119       ┆ 0.07577     ┆ 0.0071017   ┆ … ┆ 0.01299 ┆ null   ┆ null    ┆ 0.2714  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,860 - DEBUG - update position: 2024-09-05T23:59:59.999 === diff_trading_value: 235919.62790912323 == cash: 161721.88910179966 
2024-11-20 23:07:33,863 - INFO - pnl: 2024-09-05T23:59:59.999 161721.88910179966 === -0.494%
2024-11-20 23:07:33,869 - DEBUG - cur time: 2024-09-06T23:59:59.999 == next bar open time: 2024-09-07T00:00:00.000 == close pos time: 2024-09-14T00:00:00.000
2024-11-20 23:07:33,873 - INFO - pnl: 2024-09-06T23:59:59.999 161750.2441506282 === 0.018%
2024-11-20 23:07:33,880 - DEBUG - cur time: 2024-09-07T23:59:59.999 == next bar open time: 2024-09-08T00:00:00.000 == close pos time: 2024-09-15T00:00:00.000
2024-11-20 23:07:33,883 - INFO - pnl: 2024-09-07T23:59:59.999 162531.04546419272 === 0.483%
2024-11-20 23:07:33,889 - DEBUG - cur time: 2024-09-08T23:59:59.999 == next bar open time: 2024-09-09T00:00:00.000 == close pos time: 2024-09-16T00:00:00.000
2024-11-20 23:07:33,891 - INFO - pnl: 2024-09-08T23:59:59.999 162693.95199007052 === 0.100%
2024-11-20 23:07:33,898 - DEBUG - cur time: 2024-09-09T23:59:59.999 == next bar open time: 2024-09-10T00:00:00.000 == close pos time: 2024-09-17T00:00:00.000
2024-11-20 23:07:33,901 - INFO - pnl: 2024-09-09T23:59:59.999 162407.13744321332 === -0.176%
2024-11-20 23:07:33,906 - DEBUG - cur time: 2024-09-10T23:59:59.999 == next bar open time: 2024-09-11T00:00:00.000 == close pos time: 2024-09-18T00:00:00.000
2024-11-20 23:07:33,909 - INFO - pnl: 2024-09-10T23:59:59.999 162747.6222103681 === 0.210%
2024-11-20 23:07:33,915 - DEBUG - cur time: 2024-09-11T23:59:59.999 == next bar open time: 2024-09-12T00:00:00.000 == close pos time: 2024-09-19T00:00:00.000
2024-11-20 23:07:33,917 - INFO - pnl: 2024-09-11T23:59:59.999 162794.60043999122 === 0.029%
2024-11-20 23:07:33,922 - DEBUG - cur time: 2024-09-12T23:59:59.999 == next bar open time: 2024-09-13T00:00:00.000 == close pos time: 2024-09-20T00:00:00.000
2024-11-20 23:07:33,936 - DEBUG - sorted_long_factors: shape: (247, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ BONDUSDT   ┆ -2.174419    ┆ 0    ┆ 246          │
│ PENDLEUSDT ┆ -1.949587    ┆ 1    ┆ 245          │
│ TAOUSDT    ┆ -1.900781    ┆ 2    ┆ 244          │
│ FETUSDT    ┆ -1.879392    ┆ 3    ┆ 243          │
│ YFIUSDT    ┆ -1.797479    ┆ 4    ┆ 242          │
│ ARKMUSDT   ┆ -1.76806     ┆ 5    ┆ 241          │
│ STXUSDT    ┆ -1.676922    ┆ 6    ┆ 240          │
│ ENSUSDT    ┆ -1.637345    ┆ 7    ┆ 239          │
│ UMAUSDT    ┆ -1.578801    ┆ 8    ┆ 238          │
│ INJUSDT    ┆ -1.556629    ┆ 9    ┆ 237          │
│ …          ┆ …            ┆ …    ┆ …            │
│ XVGUSDT    ┆ 0.336764     ┆ 237  ┆ 9            │
│ FXSUSDT    ┆ 0.341892     ┆ 238  ┆ 8            │
│ BNTUSDT    ┆ 0.403715     ┆ 239  ┆ 7            │
│ BICOUSDT   ┆ 0.43444      ┆ 240  ┆ 6            │
│ COMBOUSDT  ┆ 0.444869     ┆ 241  ┆ 5            │
│ DODOXUSDT  ┆ 0.469154     ┆ 242  ┆ 4            │
│ STEEMUSDT  ┆ 0.516656     ┆ 243  ┆ 3            │
│ HFTUSDT    ┆ 0.559743     ┆ 244  ┆ 2            │
│ ETHWUSDT   ┆ 0.732379     ┆ 245  ┆ 1            │
│ DEFIUSDT   ┆ 1.008796     ┆ 246  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:33,943 - WARNING - 2024-09-12T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:33,943 - INFO - cur close time: 2024-09-12T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:33,943 - DEBUG - mean expected ret (mean factor): -0.7696905794239723
2024-11-20 23:07:33,948 - DEBUG - begin to update pos: =========
2024-11-20 23:07:33,948 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,949 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.017078    ┆ 0.12451     ┆ 0.0846      ┆ 0.0074129   ┆ … ┆ 0.01354 ┆ null   ┆ null    ┆ 0.2861  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:33,961 - DEBUG - update position: 2024-09-12T23:59:59.999 === diff_trading_value: 297522.74584182707 == cash: 164819.09575958515 
2024-11-20 23:07:33,963 - INFO - pnl: 2024-09-12T23:59:59.999 164819.09575958515 === 1.244%
2024-11-20 23:07:33,972 - DEBUG - cur time: 2024-09-13T23:59:59.999 == next bar open time: 2024-09-14T00:00:00.000 == close pos time: 2024-09-21T00:00:00.000
2024-11-20 23:07:33,975 - INFO - pnl: 2024-09-13T23:59:59.999 165411.01913281446 === 0.359%
2024-11-20 23:07:33,981 - DEBUG - cur time: 2024-09-14T23:59:59.999 == next bar open time: 2024-09-15T00:00:00.000 == close pos time: 2024-09-22T00:00:00.000
2024-11-20 23:07:33,984 - INFO - pnl: 2024-09-14T23:59:59.999 165155.8911530761 === -0.154%
2024-11-20 23:07:33,990 - DEBUG - cur time: 2024-09-15T23:59:59.999 == next bar open time: 2024-09-16T00:00:00.000 == close pos time: 2024-09-23T00:00:00.000
2024-11-20 23:07:33,991 - INFO - pnl: 2024-09-15T23:59:59.999 166873.13270026055 === 1.040%
2024-11-20 23:07:33,997 - DEBUG - cur time: 2024-09-16T23:59:59.999 == next bar open time: 2024-09-17T00:00:00.000 == close pos time: 2024-09-24T00:00:00.000
2024-11-20 23:07:34,000 - INFO - pnl: 2024-09-16T23:59:59.999 166128.3577771574 === -0.446%
2024-11-20 23:07:34,006 - DEBUG - cur time: 2024-09-17T23:59:59.999 == next bar open time: 2024-09-18T00:00:00.000 == close pos time: 2024-09-25T00:00:00.000
2024-11-20 23:07:34,009 - INFO - pnl: 2024-09-17T23:59:59.999 166946.82961364405 === 0.493%
2024-11-20 23:07:34,013 - DEBUG - cur time: 2024-09-18T23:59:59.999 == next bar open time: 2024-09-19T00:00:00.000 == close pos time: 2024-09-26T00:00:00.000
2024-11-20 23:07:34,015 - INFO - pnl: 2024-09-18T23:59:59.999 167473.0518714114 === 0.315%
2024-11-20 23:07:34,020 - DEBUG - cur time: 2024-09-19T23:59:59.999 == next bar open time: 2024-09-20T00:00:00.000 == close pos time: 2024-09-27T00:00:00.000
2024-11-20 23:07:34,034 - DEBUG - sorted_long_factors: shape: (247, 4)
┌─────────────┬──────────────┬──────┬──────────────┐
│ symbol      ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---         ┆ ---          ┆ ---  ┆ ---          │
│ str         ┆ f64          ┆ u32  ┆ u32          │
╞═════════════╪══════════════╪══════╪══════════════╡
│ SAGAUSDT    ┆ -2.029999    ┆ 0    ┆ 246          │
│ TAOUSDT     ┆ -1.873814    ┆ 1    ┆ 245          │
│ AAVEUSDT    ┆ -1.8243      ┆ 2    ┆ 244          │
│ OMNIUSDT    ┆ -1.722961    ┆ 3    ┆ 243          │
│ YFIUSDT     ┆ -1.67993     ┆ 4    ┆ 242          │
│ TRBUSDT     ┆ -1.596352    ┆ 5    ┆ 241          │
│ WIFUSDT     ┆ -1.58806     ┆ 6    ┆ 240          │
│ ETHFIUSDT   ┆ -1.574637    ┆ 7    ┆ 239          │
│ AUCTIONUSDT ┆ -1.573463    ┆ 8    ┆ 238          │
│ TIAUSDT     ┆ -1.561599    ┆ 9    ┆ 237          │
│ …           ┆ …            ┆ …    ┆ …            │
│ CELRUSDT    ┆ 0.268974     ┆ 237  ┆ 9            │
│ XVGUSDT     ┆ 0.298264     ┆ 238  ┆ 8            │
│ BNTUSDT     ┆ 0.418621     ┆ 239  ┆ 7            │
│ FXSUSDT     ┆ 0.429994     ┆ 240  ┆ 6            │
│ OXTUSDT     ┆ 0.469153     ┆ 241  ┆ 5            │
│ BICOUSDT    ┆ 0.595456     ┆ 242  ┆ 4            │
│ ETHWUSDT    ┆ 0.604634     ┆ 243  ┆ 3            │
│ STEEMUSDT   ┆ 0.630043     ┆ 244  ┆ 2            │
│ COMBOUSDT   ┆ 0.933643     ┆ 245  ┆ 1            │
│ DEFIUSDT    ┆ 1.559961     ┆ 246  ┆ 0            │
└─────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:34,046 - WARNING - 2024-09-19T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:34,046 - INFO - cur close time: 2024-09-19T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:34,046 - DEBUG - mean expected ret (mean factor): -0.7607440972590549
2024-11-20 23:07:34,052 - DEBUG - begin to update pos: =========
2024-11-20 23:07:34,052 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:34,052 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0.017623    ┆ 0.13112     ┆ 0.08604     ┆ 0.0079502   ┆ … ┆ 0.01424 ┆ null   ┆ null    ┆ 0.3147  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:34,063 - DEBUG - update position: 2024-09-19T23:59:59.999 === diff_trading_value: 215727.18212333572 == cash: 166018.80689739907 
2024-11-20 23:07:34,064 - INFO - pnl: 2024-09-19T23:59:59.999 166018.80689739907 === -0.868%
2024-11-20 23:07:34,070 - DEBUG - cur time: 2024-09-20T23:59:59.999 == next bar open time: 2024-09-21T00:00:00.000 == close pos time: 2024-09-28T00:00:00.000
2024-11-20 23:07:34,073 - INFO - pnl: 2024-09-20T23:59:59.999 167974.7187570426 === 1.178%
2024-11-20 23:07:34,079 - DEBUG - cur time: 2024-09-21T23:59:59.999 == next bar open time: 2024-09-22T00:00:00.000 == close pos time: 2024-09-29T00:00:00.000
2024-11-20 23:07:34,081 - INFO - pnl: 2024-09-21T23:59:59.999 168069.68808979198 === 0.057%
2024-11-20 23:07:34,087 - DEBUG - cur time: 2024-09-22T23:59:59.999 == next bar open time: 2024-09-23T00:00:00.000 == close pos time: 2024-09-30T00:00:00.000
2024-11-20 23:07:34,089 - INFO - pnl: 2024-09-22T23:59:59.999 166793.4844516799 === -0.759%
2024-11-20 23:07:34,095 - DEBUG - cur time: 2024-09-23T23:59:59.999 == next bar open time: 2024-09-24T00:00:00.000 == close pos time: 2024-10-01T00:00:00.000
2024-11-20 23:07:34,099 - INFO - pnl: 2024-09-23T23:59:59.999 163044.51689111243 === -2.248%
2024-11-20 23:07:34,104 - DEBUG - cur time: 2024-09-24T23:59:59.999 == next bar open time: 2024-09-25T00:00:00.000 == close pos time: 2024-10-02T00:00:00.000
2024-11-20 23:07:34,107 - INFO - pnl: 2024-09-24T23:59:59.999 164148.44731057805 === 0.677%
2024-11-20 23:07:34,114 - DEBUG - cur time: 2024-09-25T23:59:59.999 == next bar open time: 2024-09-26T00:00:00.000 == close pos time: 2024-10-03T00:00:00.000
2024-11-20 23:07:34,118 - INFO - pnl: 2024-09-25T23:59:59.999 162789.82953203196 === -0.828%
2024-11-20 23:07:34,125 - DEBUG - cur time: 2024-09-26T23:59:59.999 == next bar open time: 2024-09-27T00:00:00.000 == close pos time: 2024-10-04T00:00:00.000
2024-11-20 23:07:34,136 - DEBUG - sorted_long_factors: shape: (250, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ TAOUSDT   ┆ -2.037382    ┆ 0    ┆ 249          │
│ BNBUSDT   ┆ -1.964143    ┆ 1    ┆ 248          │
│ ETHFIUSDT ┆ -1.839263    ┆ 2    ┆ 247          │
│ BSVUSDT   ┆ -1.762747    ┆ 3    ┆ 246          │
│ INJUSDT   ┆ -1.672303    ┆ 4    ┆ 245          │
│ ZKUSDT    ┆ -1.633024    ┆ 5    ┆ 244          │
│ ENAUSDT   ┆ -1.628568    ┆ 6    ┆ 243          │
│ AAVEUSDT  ┆ -1.620971    ┆ 7    ┆ 242          │
│ FILUSDT   ┆ -1.606382    ┆ 8    ┆ 241          │
│ TRBUSDT   ┆ -1.588995    ┆ 9    ┆ 240          │
│ …         ┆ …            ┆ …    ┆ …            │
│ OXTUSDT   ┆ 0.220227     ┆ 240  ┆ 9            │
│ RIFUSDT   ┆ 0.237204     ┆ 241  ┆ 8            │
│ HFTUSDT   ┆ 0.275186     ┆ 242  ┆ 7            │
│ AGLDUSDT  ┆ 0.291983     ┆ 243  ┆ 6            │
│ CELRUSDT  ┆ 0.308914     ┆ 244  ┆ 5            │
│ BICOUSDT  ┆ 0.320557     ┆ 245  ┆ 4            │
│ XVGUSDT   ┆ 0.516268     ┆ 246  ┆ 3            │
│ BNTUSDT   ┆ 0.611193     ┆ 247  ┆ 2            │
│ COMBOUSDT ┆ 0.634353     ┆ 248  ┆ 1            │
│ DEFIUSDT  ┆ 2.658411     ┆ 249  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:34,145 - WARNING - 2024-09-26T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:34,145 - INFO - cur close time: 2024-09-26T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:34,145 - DEBUG - mean expected ret (mean factor): -0.7639834616336397
2024-11-20 23:07:34,150 - DEBUG - begin to update pos: =========
2024-11-20 23:07:34,150 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬────────────┬────────────┬───┬─────────┬──────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUS ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT   ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ DT         ┆ DT         ┆   ┆ ---     ┆ ---      ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---        ┆ ---        ┆   ┆ i64     ┆ f64      ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64        ┆ i64        ┆   ┆         ┆          ┆         ┆         │
╞═════════════╪═════════════╪════════════╪════════════╪═══╪═════════╪══════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0          ┆ 0          ┆ … ┆ 0       ┆ -10000.0 ┆ 0       ┆ 0       │
└─────────────┴─────────────┴────────────┴────────────┴───┴─────────┴──────────┴─────────┴─────────┘
2024-11-20 23:07:34,151 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.020959    ┆ 0.15022     ┆ 0.08978     ┆ 0.0095147  ┆ … ┆ 0.01614 ┆ 0.14315 ┆ null    ┆ 0.3561  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:34,159 - DEBUG - update position: 2024-09-26T23:59:59.999 === diff_trading_value: 201526.3201156194 == cash: 162528.33693884924 
2024-11-20 23:07:34,161 - INFO - pnl: 2024-09-26T23:59:59.999 162528.33693884924 === -0.161%
2024-11-20 23:07:34,165 - DEBUG - cur time: 2024-09-27T23:59:59.999 == next bar open time: 2024-09-28T00:00:00.000 == close pos time: 2024-10-05T00:00:00.000
2024-11-20 23:07:34,167 - INFO - pnl: 2024-09-27T23:59:59.999 162016.64882618957 === -0.315%
2024-11-20 23:07:34,170 - DEBUG - cur time: 2024-09-28T23:59:59.999 == next bar open time: 2024-09-29T00:00:00.000 == close pos time: 2024-10-06T00:00:00.000
2024-11-20 23:07:34,171 - INFO - pnl: 2024-09-28T23:59:59.999 162828.40355360045 === 0.501%
2024-11-20 23:07:34,176 - DEBUG - cur time: 2024-09-29T23:59:59.999 == next bar open time: 2024-09-30T00:00:00.000 == close pos time: 2024-10-07T00:00:00.000
2024-11-20 23:07:34,178 - INFO - pnl: 2024-09-29T23:59:59.999 164843.8448772135 === 1.238%
2024-11-20 23:07:34,182 - DEBUG - cur time: 2024-09-30T23:59:59.999 == next bar open time: 2024-10-01T00:00:00.000 == close pos time: 2024-10-08T00:00:00.000
2024-11-20 23:07:34,184 - INFO - pnl: 2024-09-30T23:59:59.999 162513.34656835697 === -1.414%
2024-11-20 23:07:34,188 - DEBUG - cur time: 2024-10-01T23:59:59.999 == next bar open time: 2024-10-02T00:00:00.000 == close pos time: 2024-10-09T00:00:00.000
2024-11-20 23:07:34,190 - INFO - pnl: 2024-10-01T23:59:59.999 161797.02657054883 === -0.441%
2024-11-20 23:07:34,195 - DEBUG - cur time: 2024-10-02T23:59:59.999 == next bar open time: 2024-10-03T00:00:00.000 == close pos time: 2024-10-10T00:00:00.000
2024-11-20 23:07:34,197 - INFO - pnl: 2024-10-02T23:59:59.999 161499.75186849997 === -0.184%
2024-11-20 23:07:34,203 - DEBUG - cur time: 2024-10-03T23:59:59.999 == next bar open time: 2024-10-04T00:00:00.000 == close pos time: 2024-10-11T00:00:00.000
2024-11-20 23:07:34,216 - DEBUG - sorted_long_factors: shape: (252, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ SAGAUSDT   ┆ -1.930821    ┆ 0    ┆ 251          │
│ GASUSDT    ┆ -1.801017    ┆ 1    ┆ 250          │
│ TAOUSDT    ┆ -1.704173    ┆ 2    ┆ 249          │
│ WUSDT      ┆ -1.701498    ┆ 3    ┆ 248          │
│ TONUSDT    ┆ -1.68236     ┆ 4    ┆ 247          │
│ GLMUSDT    ┆ -1.63488     ┆ 5    ┆ 246          │
│ UNFIUSDT   ┆ -1.614625    ┆ 6    ┆ 245          │
│ SUSHIUSDT  ┆ -1.563841    ┆ 7    ┆ 244          │
│ SUIUSDT    ┆ -1.558509    ┆ 8    ┆ 243          │
│ BTCDOMUSDT ┆ -1.551256    ┆ 9    ┆ 242          │
│ …          ┆ …            ┆ …    ┆ …            │
│ GMXUSDT    ┆ 0.319176     ┆ 242  ┆ 9            │
│ MAVIAUSDT  ┆ 0.3502       ┆ 243  ┆ 8            │
│ BADGERUSDT ┆ 0.365444     ┆ 244  ┆ 7            │
│ STEEMUSDT  ┆ 0.393993     ┆ 245  ┆ 6            │
│ PERPUSDT   ┆ 0.398788     ┆ 246  ┆ 5            │
│ JOEUSDT    ┆ 0.448743     ┆ 247  ┆ 4            │
│ BICOUSDT   ┆ 0.484339     ┆ 248  ┆ 3            │
│ LSKUSDT    ┆ 0.499759     ┆ 249  ┆ 2            │
│ HFTUSDT    ┆ 0.749982     ┆ 250  ┆ 1            │
│ DEFIUSDT   ┆ 2.024083     ┆ 251  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:34,224 - WARNING - 2024-10-03T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:34,224 - INFO - cur close time: 2024-10-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:34,225 - DEBUG - mean expected ret (mean factor): -0.7585475884602599
2024-11-20 23:07:34,231 - DEBUG - begin to update pos: =========
2024-11-20 23:07:34,231 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:34,231 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.019821    ┆ 0.12811     ┆ 0.08258     ┆ 0.0086289  ┆ … ┆ 0.01363 ┆ 0.11894 ┆ 3.9391  ┆ 0.2955  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:34,240 - DEBUG - update position: 2024-10-03T23:59:59.999 === diff_trading_value: 293795.23301441944 == cash: 161841.76321922537 
2024-11-20 23:07:34,242 - INFO - pnl: 2024-10-03T23:59:59.999 161841.76321922537 === 0.212%
2024-11-20 23:07:34,248 - DEBUG - cur time: 2024-10-04T23:59:59.999 == next bar open time: 2024-10-05T00:00:00.000 == close pos time: 2024-10-12T00:00:00.000
2024-11-20 23:07:34,251 - INFO - pnl: 2024-10-04T23:59:59.999 160431.7123681835 === -0.871%
2024-11-20 23:07:34,256 - DEBUG - cur time: 2024-10-05T23:59:59.999 == next bar open time: 2024-10-06T00:00:00.000 == close pos time: 2024-10-13T00:00:00.000
2024-11-20 23:07:34,258 - INFO - pnl: 2024-10-05T23:59:59.999 160010.3282763567 === -0.263%
2024-11-20 23:07:34,264 - DEBUG - cur time: 2024-10-06T23:59:59.999 == next bar open time: 2024-10-07T00:00:00.000 == close pos time: 2024-10-14T00:00:00.000
2024-11-20 23:07:34,268 - INFO - pnl: 2024-10-06T23:59:59.999 160164.13482538232 === 0.096%
2024-11-20 23:07:34,275 - DEBUG - cur time: 2024-10-07T23:59:59.999 == next bar open time: 2024-10-08T00:00:00.000 == close pos time: 2024-10-15T00:00:00.000
2024-11-20 23:07:34,278 - INFO - pnl: 2024-10-07T23:59:59.999 158292.85877287688 === -1.168%
2024-11-20 23:07:34,285 - DEBUG - cur time: 2024-10-08T23:59:59.999 == next bar open time: 2024-10-09T00:00:00.000 == close pos time: 2024-10-16T00:00:00.000
2024-11-20 23:07:34,287 - INFO - pnl: 2024-10-08T23:59:59.999 156894.43890301752 === -0.883%
2024-11-20 23:07:34,293 - DEBUG - cur time: 2024-10-09T23:59:59.999 == next bar open time: 2024-10-10T00:00:00.000 == close pos time: 2024-10-17T00:00:00.000
2024-11-20 23:07:34,296 - INFO - pnl: 2024-10-09T23:59:59.999 155640.16645154142 === -0.799%
2024-11-20 23:07:34,303 - DEBUG - cur time: 2024-10-10T23:59:59.999 == next bar open time: 2024-10-11T00:00:00.000 == close pos time: 2024-10-18T00:00:00.000
2024-11-20 23:07:34,317 - DEBUG - sorted_long_factors: shape: (252, 4)
┌────────────┬──────────────┬──────┬──────────────┐
│ symbol     ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---        ┆ ---          ┆ ---  ┆ ---          │
│ str        ┆ f64          ┆ u32  ┆ u32          │
╞════════════╪══════════════╪══════╪══════════════╡
│ ARUSDT     ┆ -2.093763    ┆ 0    ┆ 251          │
│ XRPUSDT    ┆ -1.841916    ┆ 1    ┆ 250          │
│ ETHFIUSDT  ┆ -1.753937    ┆ 2    ┆ 249          │
│ DOTUSDT    ┆ -1.736283    ┆ 3    ┆ 248          │
│ DYDXUSDT   ┆ -1.712346    ┆ 4    ┆ 247          │
│ IOUSDT     ┆ -1.697135    ┆ 5    ┆ 246          │
│ AXSUSDT    ┆ -1.683323    ┆ 6    ┆ 245          │
│ ZROUSDT    ┆ -1.666023    ┆ 7    ┆ 244          │
│ TRBUSDT    ┆ -1.655601    ┆ 8    ┆ 243          │
│ BBUSDT     ┆ -1.639834    ┆ 9    ┆ 242          │
│ …          ┆ …            ┆ …    ┆ …            │
│ BNXUSDT    ┆ 0.108369     ┆ 242  ┆ 9            │
│ SKLUSDT    ┆ 0.170718     ┆ 243  ┆ 8            │
│ AMBUSDT    ┆ 0.186147     ┆ 244  ┆ 7            │
│ BICOUSDT   ┆ 0.396127     ┆ 245  ┆ 6            │
│ XVGUSDT    ┆ 0.396753     ┆ 246  ┆ 5            │
│ BTCDOMUSDT ┆ 0.436495     ┆ 247  ┆ 4            │
│ WAXPUSDT   ┆ 0.569589     ┆ 248  ┆ 3            │
│ HFTUSDT    ┆ 0.628138     ┆ 249  ┆ 2            │
│ STEEMUSDT  ┆ 0.904262     ┆ 250  ┆ 1            │
│ DEFIUSDT   ┆ 1.230503     ┆ 251  ┆ 0            │
└────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:34,328 - WARNING - 2024-10-10T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:34,328 - INFO - cur close time: 2024-10-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:34,329 - DEBUG - mean expected ret (mean factor): -0.7840335877135337
2024-11-20 23:07:34,334 - DEBUG - begin to update pos: =========
2024-11-20 23:07:34,334 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬────────┬──────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT  ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---    ┆ ---      ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ i64     ┆ i64    ┆ f64      ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64        ┆   ┆         ┆        ┆          ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪════════╪══════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0          ┆ … ┆ 0       ┆ 0      ┆ -10000.0 ┆ 0       │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴────────┴──────────┴─────────┘
2024-11-20 23:07:34,335 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.020269    ┆ 0.13134     ┆ 0.08475     ┆ 0.0092899  ┆ … ┆ 0.01397 ┆ 0.12579 ┆ 3.868   ┆ 0.3041  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:34,342 - DEBUG - update position: 2024-10-10T23:59:59.999 === diff_trading_value: 308076.1172695589 == cash: 156399.51110081913 
2024-11-20 23:07:34,345 - INFO - pnl: 2024-10-10T23:59:59.999 156399.51110081913 === 0.488%
2024-11-20 23:07:34,350 - DEBUG - cur time: 2024-10-11T23:59:59.999 == next bar open time: 2024-10-12T00:00:00.000 == close pos time: 2024-10-19T00:00:00.000
2024-11-20 23:07:34,352 - INFO - pnl: 2024-10-11T23:59:59.999 154707.37071883684 === -1.082%
2024-11-20 23:07:34,357 - DEBUG - cur time: 2024-10-12T23:59:59.999 == next bar open time: 2024-10-13T00:00:00.000 == close pos time: 2024-10-20T00:00:00.000
2024-11-20 23:07:34,359 - INFO - pnl: 2024-10-12T23:59:59.999 156872.5939940924 === 1.400%
2024-11-20 23:07:34,365 - DEBUG - cur time: 2024-10-13T23:59:59.999 == next bar open time: 2024-10-14T00:00:00.000 == close pos time: 2024-10-21T00:00:00.000
2024-11-20 23:07:34,368 - INFO - pnl: 2024-10-13T23:59:59.999 156715.44086408737 === -0.100%
2024-11-20 23:07:34,374 - DEBUG - cur time: 2024-10-14T23:59:59.999 == next bar open time: 2024-10-15T00:00:00.000 == close pos time: 2024-10-22T00:00:00.000
2024-11-20 23:07:34,377 - INFO - pnl: 2024-10-14T23:59:59.999 154515.12219742744 === -1.404%
2024-11-20 23:07:34,383 - DEBUG - cur time: 2024-10-15T23:59:59.999 == next bar open time: 2024-10-16T00:00:00.000 == close pos time: 2024-10-23T00:00:00.000
2024-11-20 23:07:34,385 - INFO - pnl: 2024-10-15T23:59:59.999 153501.80662741011 === -0.656%
2024-11-20 23:07:34,393 - DEBUG - cur time: 2024-10-16T23:59:59.999 == next bar open time: 2024-10-17T00:00:00.000 == close pos time: 2024-10-24T00:00:00.000
2024-11-20 23:07:34,396 - INFO - pnl: 2024-10-16T23:59:59.999 154680.7938751254 === 0.768%
2024-11-20 23:07:34,402 - DEBUG - cur time: 2024-10-17T23:59:59.999 == next bar open time: 2024-10-18T00:00:00.000 == close pos time: 2024-10-25T00:00:00.000
2024-11-20 23:07:34,414 - DEBUG - sorted_long_factors: shape: (251, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ INJUSDT   ┆ -1.912207    ┆ 0    ┆ 250          │
│ WLDUSDT   ┆ -1.809057    ┆ 1    ┆ 249          │
│ TIAUSDT   ┆ -1.786365    ┆ 2    ┆ 248          │
│ BLURUSDT  ┆ -1.765753    ┆ 3    ┆ 247          │
│ TNSRUSDT  ┆ -1.685355    ┆ 4    ┆ 246          │
│ UNFIUSDT  ┆ -1.671396    ┆ 5    ┆ 245          │
│ DYMUSDT   ┆ -1.667783    ┆ 6    ┆ 244          │
│ ORDIUSDT  ┆ -1.603998    ┆ 7    ┆ 243          │
│ MASKUSDT  ┆ -1.600518    ┆ 8    ┆ 242          │
│ NEARUSDT  ┆ -1.540278    ┆ 9    ┆ 241          │
│ …         ┆ …            ┆ …    ┆ …            │
│ BANDUSDT  ┆ 0.015629     ┆ 241  ┆ 9            │
│ ATAUSDT   ┆ 0.022667     ┆ 242  ┆ 8            │
│ RLCUSDT   ┆ 0.061242     ┆ 243  ┆ 7            │
│ ONTUSDT   ┆ 0.09916      ┆ 244  ┆ 6            │
│ LSKUSDT   ┆ 0.119899     ┆ 245  ┆ 5            │
│ NKNUSDT   ┆ 0.203429     ┆ 246  ┆ 4            │
│ RVNUSDT   ┆ 0.269331     ┆ 247  ┆ 3            │
│ WAXPUSDT  ┆ 0.310591     ┆ 248  ┆ 2            │
│ STEEMUSDT ┆ 0.615676     ┆ 249  ┆ 1            │
│ DEFIUSDT  ┆ 2.194048     ┆ 250  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:34,426 - WARNING - 2024-10-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:34,426 - INFO - cur close time: 2024-10-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:34,426 - DEBUG - mean expected ret (mean factor): -0.7764145211374619
2024-11-20 23:07:34,438 - DEBUG - begin to update pos: =========
2024-11-20 23:07:34,438 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:34,439 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.022404    ┆ 0.14236     ┆ 0.08952     ┆ 0.0098773  ┆ … ┆ 0.01466 ┆ 0.12609 ┆ 3.7627  ┆ 0.3196  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:34,450 - DEBUG - update position: 2024-10-17T23:59:59.999 === diff_trading_value: 347923.18908517854 == cash: 155180.47560092964 
2024-11-20 23:07:34,454 - INFO - pnl: 2024-10-17T23:59:59.999 155180.47560092964 === 0.323%
2024-11-20 23:07:34,460 - DEBUG - cur time: 2024-10-18T23:59:59.999 == next bar open time: 2024-10-19T00:00:00.000 == close pos time: 2024-10-26T00:00:00.000
2024-11-20 23:07:34,462 - INFO - pnl: 2024-10-18T23:59:59.999 155182.79390519945 === 0.001%
2024-11-20 23:07:34,466 - DEBUG - cur time: 2024-10-19T23:59:59.999 == next bar open time: 2024-10-20T00:00:00.000 == close pos time: 2024-10-27T00:00:00.000
2024-11-20 23:07:34,468 - INFO - pnl: 2024-10-19T23:59:59.999 156523.73693642498 === 0.864%
2024-11-20 23:07:34,472 - DEBUG - cur time: 2024-10-20T23:59:59.999 == next bar open time: 2024-10-21T00:00:00.000 == close pos time: 2024-10-28T00:00:00.000
2024-11-20 23:07:34,473 - INFO - pnl: 2024-10-20T23:59:59.999 158165.91179356526 === 1.049%
2024-11-20 23:07:34,478 - DEBUG - cur time: 2024-10-21T23:59:59.999 == next bar open time: 2024-10-22T00:00:00.000 == close pos time: 2024-10-29T00:00:00.000
2024-11-20 23:07:34,480 - INFO - pnl: 2024-10-21T23:59:59.999 162930.65780038992 === 3.012%
2024-11-20 23:07:34,485 - DEBUG - cur time: 2024-10-22T23:59:59.999 == next bar open time: 2024-10-23T00:00:00.000 == close pos time: 2024-10-30T00:00:00.000
2024-11-20 23:07:34,487 - INFO - pnl: 2024-10-22T23:59:59.999 163990.08794309734 === 0.650%
2024-11-20 23:07:34,491 - DEBUG - cur time: 2024-10-23T23:59:59.999 == next bar open time: 2024-10-24T00:00:00.000 == close pos time: 2024-10-31T00:00:00.000
2024-11-20 23:07:34,493 - INFO - pnl: 2024-10-23T23:59:59.999 170294.66807618467 === 3.844%
2024-11-20 23:07:34,499 - DEBUG - cur time: 2024-10-24T23:59:59.999 == next bar open time: 2024-10-25T00:00:00.000 == close pos time: 2024-11-01T00:00:00.000
2024-11-20 23:07:34,510 - DEBUG - sorted_long_factors: shape: (250, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ APTUSDT   ┆ -2.379597    ┆ 0    ┆ 249          │
│ TAOUSDT   ┆ -1.974396    ┆ 1    ┆ 248          │
│ IOUSDT    ┆ -1.873958    ┆ 2    ┆ 247          │
│ UNIUSDT   ┆ -1.852913    ┆ 3    ┆ 246          │
│ ATOMUSDT  ┆ -1.819519    ┆ 4    ┆ 245          │
│ TRBUSDT   ┆ -1.697404    ┆ 5    ┆ 244          │
│ ARUSDT    ┆ -1.657513    ┆ 6    ┆ 243          │
│ ARKMUSDT  ┆ -1.599744    ┆ 7    ┆ 242          │
│ JUPUSDT   ┆ -1.558604    ┆ 8    ┆ 241          │
│ OMNIUSDT  ┆ -1.535812    ┆ 9    ┆ 240          │
│ …         ┆ …            ┆ …    ┆ …            │
│ XVGUSDT   ┆ 0.189816     ┆ 240  ┆ 9            │
│ NTRNUSDT  ┆ 0.201564     ┆ 241  ┆ 8            │
│ XEMUSDT   ┆ 0.203902     ┆ 242  ┆ 7            │
│ IOSTUSDT  ┆ 0.20782      ┆ 243  ┆ 6            │
│ DENTUSDT  ┆ 0.228256     ┆ 244  ┆ 5            │
│ OXTUSDT   ┆ 0.269625     ┆ 245  ┆ 4            │
│ HFTUSDT   ┆ 0.351938     ┆ 246  ┆ 3            │
│ BNTUSDT   ┆ 0.564151     ┆ 247  ┆ 2            │
│ STEEMUSDT ┆ 0.829054     ┆ 248  ┆ 1            │
│ DEFIUSDT  ┆ 1.930481     ┆ 249  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:34,520 - WARNING - 2024-10-24T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:34,520 - INFO - cur close time: 2024-10-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:34,520 - DEBUG - mean expected ret (mean factor): -0.7738344275682704
2024-11-20 23:07:34,525 - DEBUG - begin to update pos: =========
2024-11-20 23:07:34,526 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:34,526 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬────────────┬───┬─────────┬─────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUS ┆ … ┆ ZILUSDT ┆ ZKUSDT  ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ DT         ┆   ┆ ---     ┆ ---     ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---        ┆   ┆ f64     ┆ f64     ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64        ┆   ┆         ┆         ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪════════════╪═══╪═════════╪═════════╪═════════╪═════════╡
│ 0.022932    ┆ 0.14704     ┆ 0.09085     ┆ 0.0099932  ┆ … ┆ 0.01519 ┆ 0.13687 ┆ 3.691   ┆ 0.3417  │
└─────────────┴─────────────┴─────────────┴────────────┴───┴─────────┴─────────┴─────────┴─────────┘
2024-11-20 23:07:34,535 - DEBUG - update position: 2024-10-24T23:59:59.999 === diff_trading_value: 318961.9238027503 == cash: 169752.77683250018 
2024-11-20 23:07:34,537 - INFO - pnl: 2024-10-24T23:59:59.999 169752.77683250018 === -0.318%
2024-11-20 23:07:34,542 - DEBUG - cur time: 2024-10-25T23:59:59.999 == next bar open time: 2024-10-26T00:00:00.000 == close pos time: 2024-11-02T00:00:00.000
2024-11-20 23:07:34,543 - INFO - pnl: 2024-10-25T23:59:59.999 171772.7558298527 === 1.190%
2024-11-20 23:07:34,547 - DEBUG - cur time: 2024-10-26T23:59:59.999 == next bar open time: 2024-10-27T00:00:00.000 == close pos time: 2024-11-03T00:00:00.000
2024-11-20 23:07:34,548 - INFO - pnl: 2024-10-26T23:59:59.999 170029.06202077912 === -1.015%
2024-11-20 23:07:34,569 - INFO - start get SinglePnl: shape: (125_635, 83)
┌────────────┬───────────┬──────────┬──────────┬───┬───────────┬───────────┬───────────┬───────────┐
│ symbol     ┆ open_time ┆ open     ┆ high     ┆ … ┆ long_valu ┆ short_val ┆ long_valu ┆ short_val │
│ ---        ┆ ---       ┆ ---      ┆ ---      ┆   ┆ e_scale_9 ┆ ue_scale_ ┆ e_scale_1 ┆ ue_scale_ │
│ str        ┆ datetime[ ┆ f64      ┆ f64      ┆   ┆ day       ┆ 9day      ┆ 0day      ┆ 10day     │
│            ┆ ms]       ┆          ┆          ┆   ┆ ---       ┆ ---       ┆ ---       ┆ ---       │
│            ┆           ┆          ┆          ┆   ┆ f64       ┆ f64       ┆ f64       ┆ f64       │
╞════════════╪═══════════╪══════════╪══════════╪═══╪═══════════╪═══════════╪═══════════╪═══════════╡
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.024872 ┆ 0.02937  ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.024425 ┆ 0.027349 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.027227 ┆ 0.047868 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.03773  ┆ 0.042696 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.030505 ┆ 0.036907 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.029994 ┆ 0.030839 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.027063 ┆ 0.035125 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-0 ┆ 0.031768 ┆ 0.034467 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-1 ┆ 0.0339   ┆ 0.033974 ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ 1000BONKUS ┆ 2024-03-1 ┆ 0.031026 ┆ 0.03276  ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│ DT         ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ …          ┆ …         ┆ …        ┆ …        ┆ … ┆ …         ┆ …         ┆ …         ┆ …         │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3196   ┆ 0.3373   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 8         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-1 ┆ 0.3355   ┆ 0.3415   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 9         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3359   ┆ 0.3565   ┆ … ┆ 1.2       ┆ 0.8       ┆ 1.2       ┆ 0.8       │
│            ┆ 0         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3553   ┆ 0.3881   ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.2       ┆ 0.8       │
│            ┆ 1         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3577   ┆ 0.3581   ┆ … ┆ 1.0       ┆ 1.0       ┆ 1.0       ┆ 1.0       │
│            ┆ 2         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3511   ┆ 0.3547   ┆ … ┆ 0.8       ┆ 1.2       ┆ 1.0       ┆ 1.0       │
│            ┆ 3         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3383   ┆ 0.3548   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 4         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3417   ┆ 0.3632   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 5         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.3194   ┆ 0.3243   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 6         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│ ZRXUSDT    ┆ 2024-10-2 ┆ 0.316    ┆ 0.3317   ┆ … ┆ 0.8       ┆ 1.2       ┆ 0.8       ┆ 1.2       │
│            ┆ 7         ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
│            ┆ 00:00:00  ┆          ┆          ┆   ┆           ┆           ┆           ┆           │
└────────────┴───────────┴──────────┴──────────┴───┴───────────┴───────────┴───────────┴───────────┘
2024-11-20 23:07:34,655 - DEBUG - cur time: 2023-01-13T23:59:59.999 == next bar open time: 2023-01-14T00:00:00.000 == close pos time: 2023-01-21T00:00:00.000
2024-11-20 23:07:34,662 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APEUSDT      ┆ -2.017733    ┆ 0    ┆ 132          │
│ ICPUSDT      ┆ -1.930985    ┆ 1    ┆ 131          │
│ UNIUSDT      ┆ -1.904953    ┆ 2    ┆ 130          │
│ ATOMUSDT     ┆ -1.900821    ┆ 3    ┆ 129          │
│ DASHUSDT     ┆ -1.7799      ┆ 4    ┆ 128          │
│ MATICUSDT    ┆ -1.766984    ┆ 5    ┆ 127          │
│ DOTUSDT      ┆ -1.698016    ┆ 6    ┆ 126          │
│ BNBUSDT      ┆ -1.689845    ┆ 7    ┆ 125          │
│ ENSUSDT      ┆ -1.672548    ┆ 8    ┆ 124          │
│ 1000LUNCUSDT ┆ -1.633642    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ CHRUSDT      ┆ 0.022323     ┆ 123  ┆ 9            │
│ COTIUSDT     ┆ 0.038939     ┆ 124  ┆ 8            │
│ TOMOUSDT     ┆ 0.056959     ┆ 125  ┆ 7            │
│ BTCDOMUSDT   ┆ 0.075739     ┆ 126  ┆ 6            │
│ IOSTUSDT     ┆ 0.112811     ┆ 127  ┆ 5            │
│ DUSKUSDT     ┆ 0.140062     ┆ 128  ┆ 4            │
│ SKLUSDT      ┆ 0.229633     ┆ 129  ┆ 3            │
│ CELRUSDT     ┆ 0.275468     ┆ 130  ┆ 2            │
│ ARPAUSDT     ┆ 0.336504     ┆ 131  ┆ 1            │
│ DEFIUSDT     ┆ 0.814285     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:34,669 - WARNING - 2023-01-13T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:34,669 - INFO - cur close time: 2023-01-13T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:34,669 - DEBUG - mean expected ret (mean factor): -0.8286485638966046
2024-11-20 23:07:34,673 - DEBUG - begin to update pos: =========
2024-11-20 23:07:34,674 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:34,674 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1769      ┆ null        ┆ … ┆ 0.02592 ┆ null   ┆ null    ┆ 0.1913  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:34,681 - DEBUG - update position: 2023-01-13T23:59:59.999 === diff_trading_value: 200000.0 == cash: 99800.0 
2024-11-20 23:07:34,687 - DEBUG - cur time: 2023-01-14T23:59:59.999 == next bar open time: 2023-01-15T00:00:00.000 == close pos time: 2023-01-22T00:00:00.000
2024-11-20 23:07:34,689 - INFO - pnl: 2023-01-14T23:59:59.999 98913.46280319599 === -0.888%
2024-11-20 23:07:34,693 - DEBUG - cur time: 2023-01-15T23:59:59.999 == next bar open time: 2023-01-16T00:00:00.000 == close pos time: 2023-01-23T00:00:00.000
2024-11-20 23:07:34,696 - INFO - pnl: 2023-01-15T23:59:59.999 99372.00016160644 === 0.464%
2024-11-20 23:07:34,701 - DEBUG - cur time: 2023-01-16T23:59:59.999 == next bar open time: 2023-01-17T00:00:00.000 == close pos time: 2023-01-24T00:00:00.000
2024-11-20 23:07:34,703 - INFO - pnl: 2023-01-16T23:59:59.999 101052.02520281139 === 1.691%
2024-11-20 23:07:34,708 - DEBUG - cur time: 2023-01-17T23:59:59.999 == next bar open time: 2023-01-18T00:00:00.000 == close pos time: 2023-01-25T00:00:00.000
2024-11-20 23:07:34,710 - INFO - pnl: 2023-01-17T23:59:59.999 102146.1793160857 === 1.083%
2024-11-20 23:07:34,714 - DEBUG - cur time: 2023-01-18T23:59:59.999 == next bar open time: 2023-01-19T00:00:00.000 == close pos time: 2023-01-26T00:00:00.000
2024-11-20 23:07:34,716 - INFO - pnl: 2023-01-18T23:59:59.999 101055.4111773952 === -1.068%
2024-11-20 23:07:34,720 - DEBUG - cur time: 2023-01-19T23:59:59.999 == next bar open time: 2023-01-20T00:00:00.000 == close pos time: 2023-01-27T00:00:00.000
2024-11-20 23:07:34,721 - INFO - pnl: 2023-01-19T23:59:59.999 98283.1402754248 === -2.743%
2024-11-20 23:07:34,726 - DEBUG - cur time: 2023-01-20T23:59:59.999 == next bar open time: 2023-01-21T00:00:00.000 == close pos time: 2023-01-28T00:00:00.000
2024-11-20 23:07:34,733 - DEBUG - sorted_long_factors: shape: (133, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AAVEUSDT     ┆ -2.137187    ┆ 0    ┆ 132          │
│ BNBUSDT      ┆ -1.901263    ┆ 1    ┆ 131          │
│ LUNA2USDT    ┆ -1.725774    ┆ 2    ┆ 130          │
│ ATOMUSDT     ┆ -1.696816    ┆ 3    ┆ 129          │
│ KAVAUSDT     ┆ -1.674616    ┆ 4    ┆ 128          │
│ 1000LUNCUSDT ┆ -1.652446    ┆ 5    ┆ 127          │
│ KSMUSDT      ┆ -1.616951    ┆ 6    ┆ 126          │
│ UNIUSDT      ┆ -1.560978    ┆ 7    ┆ 125          │
│ FILUSDT      ┆ -1.560044    ┆ 8    ┆ 124          │
│ ICPUSDT      ┆ -1.543866    ┆ 9    ┆ 123          │
│ …            ┆ …            ┆ …    ┆ …            │
│ DARUSDT      ┆ -0.177174    ┆ 123  ┆ 9            │
│ FLMUSDT      ┆ -0.130441    ┆ 124  ┆ 8            │
│ BALUSDT      ┆ -0.008901    ┆ 125  ┆ 7            │
│ LPTUSDT      ┆ 0.006746     ┆ 126  ┆ 6            │
│ CTSIUSDT     ┆ 0.057889     ┆ 127  ┆ 5            │
│ DEFIUSDT     ┆ 0.34512      ┆ 128  ┆ 4            │
│ SKLUSDT      ┆ 0.362443     ┆ 129  ┆ 3            │
│ ARPAUSDT     ┆ 0.393969     ┆ 130  ┆ 2            │
│ API3USDT     ┆ 0.539388     ┆ 131  ┆ 1            │
│ TOMOUSDT     ┆ 0.551222     ┆ 132  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:34,739 - WARNING - 2023-01-20T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:34,740 - INFO - cur close time: 2023-01-20T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:34,740 - DEBUG - mean expected ret (mean factor): -0.8139737041470206
2024-11-20 23:07:34,745 - DEBUG - begin to update pos: =========
2024-11-20 23:07:34,746 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:34,746 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1791      ┆ null        ┆ … ┆ 0.02761 ┆ null   ┆ null    ┆ 0.2187  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:34,754 - DEBUG - update position: 2023-01-20T23:59:59.999 === diff_trading_value: 207394.2628511653 == cash: 100748.49422451621 
2024-11-20 23:07:34,755 - INFO - pnl: 2023-01-20T23:59:59.999 100748.49422451621 === 2.508%
2024-11-20 23:07:34,759 - DEBUG - cur time: 2023-01-21T23:59:59.999 == next bar open time: 2023-01-22T00:00:00.000 == close pos time: 2023-01-29T00:00:00.000
2024-11-20 23:07:34,761 - INFO - pnl: 2023-01-21T23:59:59.999 100931.30268048891 === 0.181%
2024-11-20 23:07:34,765 - DEBUG - cur time: 2023-01-22T23:59:59.999 == next bar open time: 2023-01-23T00:00:00.000 == close pos time: 2023-01-30T00:00:00.000
2024-11-20 23:07:34,767 - INFO - pnl: 2023-01-22T23:59:59.999 102088.89087765601 === 1.147%
2024-11-20 23:07:34,770 - DEBUG - cur time: 2023-01-23T23:59:59.999 == next bar open time: 2023-01-24T00:00:00.000 == close pos time: 2023-01-31T00:00:00.000
2024-11-20 23:07:34,771 - INFO - pnl: 2023-01-23T23:59:59.999 104779.94223289333 === 2.636%
2024-11-20 23:07:34,776 - DEBUG - cur time: 2023-01-24T23:59:59.999 == next bar open time: 2023-01-25T00:00:00.000 == close pos time: 2023-02-01T00:00:00.000
2024-11-20 23:07:34,777 - INFO - pnl: 2023-01-24T23:59:59.999 108345.62118429292 === 3.403%
2024-11-20 23:07:34,781 - DEBUG - cur time: 2023-01-25T23:59:59.999 == next bar open time: 2023-01-26T00:00:00.000 == close pos time: 2023-02-02T00:00:00.000
2024-11-20 23:07:34,783 - INFO - pnl: 2023-01-25T23:59:59.999 107094.05163749306 === -1.155%
2024-11-20 23:07:34,786 - DEBUG - cur time: 2023-01-26T23:59:59.999 == next bar open time: 2023-01-27T00:00:00.000 == close pos time: 2023-02-03T00:00:00.000
2024-11-20 23:07:34,787 - INFO - pnl: 2023-01-26T23:59:59.999 109563.32753356385 === 2.306%
2024-11-20 23:07:34,790 - DEBUG - cur time: 2023-01-27T23:59:59.999 == next bar open time: 2023-01-28T00:00:00.000 == close pos time: 2023-02-04T00:00:00.000
2024-11-20 23:07:34,800 - DEBUG - sorted_long_factors: shape: (133, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ LUNA2USDT ┆ -1.832698    ┆ 0    ┆ 132          │
│ BNBUSDT   ┆ -1.78928     ┆ 1    ┆ 131          │
│ COMPUSDT  ┆ -1.779187    ┆ 2    ┆ 130          │
│ ENSUSDT   ┆ -1.737676    ┆ 3    ┆ 129          │
│ APEUSDT   ┆ -1.680623    ┆ 4    ┆ 128          │
│ DOTUSDT   ┆ -1.641074    ┆ 5    ┆ 127          │
│ YFIUSDT   ┆ -1.638268    ┆ 6    ┆ 126          │
│ LDOUSDT   ┆ -1.596252    ┆ 7    ┆ 125          │
│ UNFIUSDT  ┆ -1.57668     ┆ 8    ┆ 124          │
│ CELOUSDT  ┆ -1.558629    ┆ 9    ┆ 123          │
│ …         ┆ …            ┆ …    ┆ …            │
│ SPELLUSDT ┆ -0.146229    ┆ 123  ┆ 9            │
│ DENTUSDT  ┆ -0.12669     ┆ 124  ┆ 8            │
│ CELRUSDT  ┆ -0.121507    ┆ 125  ┆ 7            │
│ DGBUSDT   ┆ -0.014326    ┆ 126  ┆ 6            │
│ GTCUSDT   ┆ 0.013448     ┆ 127  ┆ 5            │
│ TOMOUSDT  ┆ 0.082138     ┆ 128  ┆ 4            │
│ ANTUSDT   ┆ 0.21798      ┆ 129  ┆ 3            │
│ ARPAUSDT  ┆ 0.304533     ┆ 130  ┆ 2            │
│ SKLUSDT   ┆ 0.423714     ┆ 131  ┆ 1            │
│ DEFIUSDT  ┆ 1.295544     ┆ 132  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:34,811 - WARNING - 2023-01-27T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:34,811 - INFO - cur close time: 2023-01-27T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:34,812 - DEBUG - mean expected ret (mean factor): -0.8129999087061848
2024-11-20 23:07:34,818 - DEBUG - begin to update pos: =========
2024-11-20 23:07:34,819 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:34,819 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1726      ┆ null        ┆ … ┆ 0.02925 ┆ null   ┆ null    ┆ 0.2401  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:34,827 - DEBUG - update position: 2023-01-27T23:59:59.999 === diff_trading_value: 287077.7282911449 == cash: 112257.82511561827 
2024-11-20 23:07:34,830 - INFO - pnl: 2023-01-27T23:59:59.999 112257.82511561827 === 2.459%
2024-11-20 23:07:34,833 - DEBUG - cur time: 2023-01-28T23:59:59.999 == next bar open time: 2023-01-29T00:00:00.000 == close pos time: 2023-02-05T00:00:00.000
2024-11-20 23:07:34,836 - INFO - pnl: 2023-01-28T23:59:59.999 112994.3022868266 === 0.656%
2024-11-20 23:07:34,840 - DEBUG - cur time: 2023-01-29T23:59:59.999 == next bar open time: 2023-01-30T00:00:00.000 == close pos time: 2023-02-06T00:00:00.000
2024-11-20 23:07:34,843 - INFO - pnl: 2023-01-29T23:59:59.999 113707.79553991368 === 0.631%
2024-11-20 23:07:34,849 - DEBUG - cur time: 2023-01-30T23:59:59.999 == next bar open time: 2023-01-31T00:00:00.000 == close pos time: 2023-02-07T00:00:00.000
2024-11-20 23:07:34,852 - INFO - pnl: 2023-01-30T23:59:59.999 115771.42603240265 === 1.815%
2024-11-20 23:07:34,857 - DEBUG - cur time: 2023-01-31T23:59:59.999 == next bar open time: 2023-02-01T00:00:00.000 == close pos time: 2023-02-08T00:00:00.000
2024-11-20 23:07:34,860 - INFO - pnl: 2023-01-31T23:59:59.999 115104.6917523442 === -0.576%
2024-11-20 23:07:34,866 - DEBUG - cur time: 2023-02-01T23:59:59.999 == next bar open time: 2023-02-02T00:00:00.000 == close pos time: 2023-02-09T00:00:00.000
2024-11-20 23:07:34,868 - INFO - pnl: 2023-02-01T23:59:59.999 115813.69080390072 === 0.616%
2024-11-20 23:07:34,874 - DEBUG - cur time: 2023-02-02T23:59:59.999 == next bar open time: 2023-02-03T00:00:00.000 == close pos time: 2023-02-10T00:00:00.000
2024-11-20 23:07:34,877 - INFO - pnl: 2023-02-02T23:59:59.999 117211.17685283595 === 1.207%
2024-11-20 23:07:34,882 - DEBUG - cur time: 2023-02-03T23:59:59.999 == next bar open time: 2023-02-04T00:00:00.000 == close pos time: 2023-02-11T00:00:00.000
2024-11-20 23:07:34,891 - DEBUG - sorted_long_factors: shape: (135, 4)
┌───────────┬──────────────┬──────┬──────────────┐
│ symbol    ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---       ┆ ---          ┆ ---  ┆ ---          │
│ str       ┆ f64          ┆ u32  ┆ u32          │
╞═══════════╪══════════════╪══════╪══════════════╡
│ BNBUSDT   ┆ -2.298671    ┆ 0    ┆ 134          │
│ AXSUSDT   ┆ -1.942569    ┆ 1    ┆ 133          │
│ QNTUSDT   ┆ -1.730891    ┆ 2    ┆ 132          │
│ OPUSDT    ┆ -1.709417    ┆ 3    ┆ 131          │
│ DOTUSDT   ┆ -1.696585    ┆ 4    ┆ 130          │
│ LUNA2USDT ┆ -1.673214    ┆ 5    ┆ 129          │
│ COMPUSDT  ┆ -1.658267    ┆ 6    ┆ 128          │
│ FILUSDT   ┆ -1.634361    ┆ 7    ┆ 127          │
│ LDOUSDT   ┆ -1.627451    ┆ 8    ┆ 126          │
│ AAVEUSDT  ┆ -1.527353    ┆ 9    ┆ 125          │
│ …         ┆ …            ┆ …    ┆ …            │
│ STMXUSDT  ┆ -0.073657    ┆ 125  ┆ 9            │
│ DUSKUSDT  ┆ -0.020188    ┆ 126  ┆ 8            │
│ API3USDT  ┆ 0.064702     ┆ 127  ┆ 7            │
│ ARPAUSDT  ┆ 0.074323     ┆ 128  ┆ 6            │
│ DENTUSDT  ┆ 0.142065     ┆ 129  ┆ 5            │
│ IOSTUSDT  ┆ 0.242366     ┆ 130  ┆ 4            │
│ CTSIUSDT  ┆ 0.318793     ┆ 131  ┆ 3            │
│ TOMOUSDT  ┆ 0.521997     ┆ 132  ┆ 2            │
│ DGBUSDT   ┆ 0.638049     ┆ 133  ┆ 1            │
│ DEFIUSDT  ┆ 2.036024     ┆ 134  ┆ 0            │
└───────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:34,903 - WARNING - 2023-02-03T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:34,904 - INFO - cur close time: 2023-02-03T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:34,904 - DEBUG - mean expected ret (mean factor): -0.8077884500227379
2024-11-20 23:07:34,914 - DEBUG - begin to update pos: =========
2024-11-20 23:07:34,914 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:34,915 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.2023      ┆ null        ┆ … ┆ 0.02982 ┆ null   ┆ null    ┆ 0.2561  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:34,924 - DEBUG - update position: 2023-02-03T23:59:59.999 === diff_trading_value: 187070.1382779748 == cash: 116359.6913936276 
2024-11-20 23:07:34,926 - INFO - pnl: 2023-02-03T23:59:59.999 116359.6913936276 === -0.726%
2024-11-20 23:07:34,931 - DEBUG - cur time: 2023-02-04T23:59:59.999 == next bar open time: 2023-02-05T00:00:00.000 == close pos time: 2023-02-12T00:00:00.000
2024-11-20 23:07:34,935 - INFO - pnl: 2023-02-04T23:59:59.999 120399.56796256025 === 3.472%
2024-11-20 23:07:34,941 - DEBUG - cur time: 2023-02-05T23:59:59.999 == next bar open time: 2023-02-06T00:00:00.000 == close pos time: 2023-02-13T00:00:00.000
2024-11-20 23:07:34,944 - INFO - pnl: 2023-02-05T23:59:59.999 120588.5886345242 === 0.157%
2024-11-20 23:07:34,948 - DEBUG - cur time: 2023-02-06T23:59:59.999 == next bar open time: 2023-02-07T00:00:00.000 == close pos time: 2023-02-14T00:00:00.000
2024-11-20 23:07:34,950 - INFO - pnl: 2023-02-06T23:59:59.999 120998.86786781797 === 0.340%
2024-11-20 23:07:34,956 - DEBUG - cur time: 2023-02-07T23:59:59.999 == next bar open time: 2023-02-08T00:00:00.000 == close pos time: 2023-02-15T00:00:00.000
2024-11-20 23:07:34,959 - INFO - pnl: 2023-02-07T23:59:59.999 122983.66998323333 === 1.640%
2024-11-20 23:07:34,965 - DEBUG - cur time: 2023-02-08T23:59:59.999 == next bar open time: 2023-02-09T00:00:00.000 == close pos time: 2023-02-16T00:00:00.000
2024-11-20 23:07:34,967 - INFO - pnl: 2023-02-08T23:59:59.999 122181.99259182358 === -0.652%
2024-11-20 23:07:34,973 - DEBUG - cur time: 2023-02-09T23:59:59.999 == next bar open time: 2023-02-10T00:00:00.000 == close pos time: 2023-02-17T00:00:00.000
2024-11-20 23:07:34,976 - INFO - pnl: 2023-02-09T23:59:59.999 119905.17437832826 === -1.863%
2024-11-20 23:07:34,981 - DEBUG - cur time: 2023-02-10T23:59:59.999 == next bar open time: 2023-02-11T00:00:00.000 == close pos time: 2023-02-18T00:00:00.000
2024-11-20 23:07:34,991 - DEBUG - sorted_long_factors: shape: (135, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ FOOTBALLUSDT ┆ -1.832714    ┆ 0    ┆ 134          │
│ LDOUSDT      ┆ -1.785254    ┆ 1    ┆ 133          │
│ NEOUSDT      ┆ -1.69322     ┆ 2    ┆ 132          │
│ LUNA2USDT    ┆ -1.65303     ┆ 3    ┆ 131          │
│ MTLUSDT      ┆ -1.634793    ┆ 4    ┆ 130          │
│ WOOUSDT      ┆ -1.56502     ┆ 5    ┆ 129          │
│ AXSUSDT      ┆ -1.541998    ┆ 6    ┆ 128          │
│ NEARUSDT     ┆ -1.54182     ┆ 7    ┆ 127          │
│ OCEANUSDT    ┆ -1.540971    ┆ 8    ┆ 126          │
│ QTUMUSDT     ┆ -1.495697    ┆ 9    ┆ 125          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ALPHAUSDT    ┆ -0.095485    ┆ 125  ┆ 9            │
│ BELUSDT      ┆ -0.079973    ┆ 126  ┆ 8            │
│ KSMUSDT      ┆ -0.072007    ┆ 127  ┆ 7            │
│ DENTUSDT     ┆ -0.047146    ┆ 128  ┆ 6            │
│ IOTXUSDT     ┆ -0.016424    ┆ 129  ┆ 5            │
│ SKLUSDT      ┆ 0.004357     ┆ 130  ┆ 4            │
│ LINAUSDT     ┆ 0.077221     ┆ 131  ┆ 3            │
│ TOMOUSDT     ┆ 0.381146     ┆ 132  ┆ 2            │
│ DGBUSDT      ┆ 0.869747     ┆ 133  ┆ 1            │
│ DEFIUSDT     ┆ 1.332333     ┆ 134  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:34,998 - WARNING - 2023-02-10T23:59:59.999=====cur_long_scale: 0.8 not match == long_value_ratio: 1.0
2024-11-20 23:07:34,999 - INFO - cur close time: 2023-02-10T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 0.8
2024-11-20 23:07:34,999 - DEBUG - mean expected ret (mean factor): -0.8098357203891776
2024-11-20 23:07:35,003 - DEBUG - begin to update pos: =========
2024-11-20 23:07:35,004 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:35,004 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1652      ┆ null        ┆ … ┆ 0.02778 ┆ null   ┆ null    ┆ 0.2317  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:35,013 - DEBUG - update position: 2023-02-10T23:59:59.999 === diff_trading_value: 240312.01526903472 == cash: 124641.8748609281 
2024-11-20 23:07:35,014 - INFO - pnl: 2023-02-10T23:59:59.999 124641.8748609281 === 3.950%
2024-11-20 23:07:35,019 - DEBUG - cur time: 2023-02-11T23:59:59.999 == next bar open time: 2023-02-12T00:00:00.000 == close pos time: 2023-02-19T00:00:00.000
2024-11-20 23:07:35,020 - INFO - pnl: 2023-02-11T23:59:59.999 125668.64730465392 === 0.824%
2024-11-20 23:07:35,024 - DEBUG - cur time: 2023-02-12T23:59:59.999 == next bar open time: 2023-02-13T00:00:00.000 == close pos time: 2023-02-20T00:00:00.000
2024-11-20 23:07:35,026 - INFO - pnl: 2023-02-12T23:59:59.999 128162.93676609798 === 1.985%
2024-11-20 23:07:35,030 - DEBUG - cur time: 2023-02-13T23:59:59.999 == next bar open time: 2023-02-14T00:00:00.000 == close pos time: 2023-02-21T00:00:00.000
2024-11-20 23:07:35,033 - INFO - pnl: 2023-02-13T23:59:59.999 128208.96602077945 === 0.036%
2024-11-20 23:07:35,037 - DEBUG - cur time: 2023-02-14T23:59:59.999 == next bar open time: 2023-02-15T00:00:00.000 == close pos time: 2023-02-22T00:00:00.000
2024-11-20 23:07:35,039 - INFO - pnl: 2023-02-14T23:59:59.999 127532.22506543108 === -0.528%
2024-11-20 23:07:35,044 - DEBUG - cur time: 2023-02-15T23:59:59.999 == next bar open time: 2023-02-16T00:00:00.000 == close pos time: 2023-02-23T00:00:00.000
2024-11-20 23:07:35,046 - INFO - pnl: 2023-02-15T23:59:59.999 127887.1584248331 === 0.278%
2024-11-20 23:07:35,052 - DEBUG - cur time: 2023-02-16T23:59:59.999 == next bar open time: 2023-02-17T00:00:00.000 == close pos time: 2023-02-24T00:00:00.000
2024-11-20 23:07:35,055 - INFO - pnl: 2023-02-16T23:59:59.999 129882.00706997077 === 1.560%
2024-11-20 23:07:35,060 - DEBUG - cur time: 2023-02-17T23:59:59.999 == next bar open time: 2023-02-18T00:00:00.000 == close pos time: 2023-02-25T00:00:00.000
2024-11-20 23:07:35,070 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ AXSUSDT      ┆ -1.915609    ┆ 0    ┆ 135          │
│ LDOUSDT      ┆ -1.788937    ┆ 1    ┆ 134          │
│ NEARUSDT     ┆ -1.741788    ┆ 2    ┆ 133          │
│ ATOMUSDT     ┆ -1.71858     ┆ 3    ┆ 132          │
│ FOOTBALLUSDT ┆ -1.680859    ┆ 4    ┆ 131          │
│ EGLDUSDT     ┆ -1.612317    ┆ 5    ┆ 130          │
│ STGUSDT      ┆ -1.581265    ┆ 6    ┆ 129          │
│ QNTUSDT      ┆ -1.557366    ┆ 7    ┆ 128          │
│ LITUSDT      ┆ -1.527116    ┆ 8    ┆ 127          │
│ ICPUSDT      ┆ -1.49656     ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ ARPAUSDT     ┆ -0.03859     ┆ 126  ┆ 9            │
│ HOTUSDT      ┆ -0.026177    ┆ 127  ┆ 8            │
│ XEMUSDT      ┆ 0.087319     ┆ 128  ┆ 7            │
│ IOTXUSDT     ┆ 0.166854     ┆ 129  ┆ 6            │
│ LINAUSDT     ┆ 0.220253     ┆ 130  ┆ 5            │
│ TOMOUSDT     ┆ 0.273463     ┆ 131  ┆ 4            │
│ 1000XECUSDT  ┆ 0.524138     ┆ 132  ┆ 3            │
│ DEFIUSDT     ┆ 0.624468     ┆ 133  ┆ 2            │
│ DGBUSDT      ┆ 0.692416     ┆ 134  ┆ 1            │
│ BLUEBIRDUSDT ┆ 1.222484     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:35,078 - WARNING - 2023-02-17T23:59:59.999=====cur_long_scale: 1.2 not match == long_value_ratio: 1.0
2024-11-20 23:07:35,078 - INFO - cur close time: 2023-02-17T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.2
2024-11-20 23:07:35,078 - DEBUG - mean expected ret (mean factor): -0.7857314805833853
2024-11-20 23:07:35,083 - DEBUG - begin to update pos: =========
2024-11-20 23:07:35,084 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ f64     │
│ i64         ┆ i64         ┆ i64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ 0           ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 5000.0  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:35,084 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1701      ┆ null        ┆ … ┆ 0.03193 ┆ null   ┆ null    ┆ 0.2618  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:35,092 - DEBUG - update position: 2023-02-17T23:59:59.999 === diff_trading_value: 256083.47615832754 == cash: 128029.1504571639 
2024-11-20 23:07:35,094 - INFO - pnl: 2023-02-17T23:59:59.999 128029.1504571639 === -1.427%
2024-11-20 23:07:35,100 - DEBUG - cur time: 2023-02-18T23:59:59.999 == next bar open time: 2023-02-19T00:00:00.000 == close pos time: 2023-02-26T00:00:00.000
2024-11-20 23:07:35,103 - INFO - pnl: 2023-02-18T23:59:59.999 126909.28752049145 === -0.875%
2024-11-20 23:07:35,108 - DEBUG - cur time: 2023-02-19T23:59:59.999 == next bar open time: 2023-02-20T00:00:00.000 == close pos time: 2023-02-27T00:00:00.000
2024-11-20 23:07:35,111 - INFO - pnl: 2023-02-19T23:59:59.999 128774.43269661802 === 1.470%
2024-11-20 23:07:35,117 - DEBUG - cur time: 2023-02-20T23:59:59.999 == next bar open time: 2023-02-21T00:00:00.000 == close pos time: 2023-02-28T00:00:00.000
2024-11-20 23:07:35,121 - INFO - pnl: 2023-02-20T23:59:59.999 133069.9968074257 === 3.336%
2024-11-20 23:07:35,127 - DEBUG - cur time: 2023-02-21T23:59:59.999 == next bar open time: 2023-02-22T00:00:00.000 == close pos time: 2023-03-01T00:00:00.000
2024-11-20 23:07:35,130 - INFO - pnl: 2023-02-21T23:59:59.999 138746.2576570523 === 4.266%
2024-11-20 23:07:35,135 - DEBUG - cur time: 2023-02-22T23:59:59.999 == next bar open time: 2023-02-23T00:00:00.000 == close pos time: 2023-03-02T00:00:00.000
2024-11-20 23:07:35,137 - INFO - pnl: 2023-02-22T23:59:59.999 138327.9066767521 === -0.302%
2024-11-20 23:07:35,141 - DEBUG - cur time: 2023-02-23T23:59:59.999 == next bar open time: 2023-02-24T00:00:00.000 == close pos time: 2023-03-03T00:00:00.000
2024-11-20 23:07:35,143 - INFO - pnl: 2023-02-23T23:59:59.999 137899.1187828524 === -0.310%
2024-11-20 23:07:35,148 - DEBUG - cur time: 2023-02-24T23:59:59.999 == next bar open time: 2023-02-25T00:00:00.000 == close pos time: 2023-03-04T00:00:00.000
2024-11-20 23:07:35,160 - DEBUG - sorted_long_factors: shape: (136, 4)
┌──────────────┬──────────────┬──────┬──────────────┐
│ symbol       ┆ factor_value ┆ rank ┆ reverse_rank │
│ ---          ┆ ---          ┆ ---  ┆ ---          │
│ str          ┆ f64          ┆ u32  ┆ u32          │
╞══════════════╪══════════════╪══════╪══════════════╡
│ APTUSDT      ┆ -1.940799    ┆ 0    ┆ 135          │
│ 1000LUNCUSDT ┆ -1.559257    ┆ 1    ┆ 134          │
│ OPUSDT       ┆ -1.551552    ┆ 2    ┆ 133          │
│ LUNA2USDT    ┆ -1.492337    ┆ 3    ┆ 132          │
│ ENSUSDT      ┆ -1.437862    ┆ 4    ┆ 131          │
│ QNTUSDT      ┆ -1.428159    ┆ 5    ┆ 130          │
│ COMPUSDT     ┆ -1.416847    ┆ 6    ┆ 129          │
│ GTCUSDT      ┆ -1.414405    ┆ 7    ┆ 128          │
│ INJUSDT      ┆ -1.349481    ┆ 8    ┆ 127          │
│ WAVESUSDT    ┆ -1.348383    ┆ 9    ┆ 126          │
│ …            ┆ …            ┆ …    ┆ …            │
│ 1000XECUSDT  ┆ -0.23893     ┆ 126  ┆ 9            │
│ STMXUSDT     ┆ -0.226841    ┆ 127  ┆ 8            │
│ COTIUSDT     ┆ -0.218162    ┆ 128  ┆ 7            │
│ ONEUSDT      ┆ -0.210533    ┆ 129  ┆ 6            │
│ BALUSDT      ┆ -0.047909    ┆ 130  ┆ 5            │
│ DARUSDT      ┆ 0.007573     ┆ 131  ┆ 4            │
│ API3USDT     ┆ 0.0266       ┆ 132  ┆ 3            │
│ ANTUSDT      ┆ 0.332296     ┆ 133  ┆ 2            │
│ BLUEBIRDUSDT ┆ 1.803073     ┆ 134  ┆ 1            │
│ DEFIUSDT     ┆ 2.010104     ┆ 135  ┆ 0            │
└──────────────┴──────────────┴──────┴──────────────┘
2024-11-20 23:07:35,174 - INFO - cur close time: 2023-02-24T23:59:59.999 == long_value_ratio: 1.0 == short_value_ratio: 1.0 --- 1.0
2024-11-20 23:07:35,174 - DEBUG - mean expected ret (mean factor): -0.780919640100011
2024-11-20 23:07:35,180 - DEBUG - begin to update pos: =========
2024-11-20 23:07:35,181 - DEBUG - next_step_value: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ i64     ┆ i64    ┆ i64     ┆ i64     │
│ i64         ┆ i64         ┆ f64         ┆ i64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ 0           ┆ 0           ┆ -10000.0    ┆ 0           ┆ … ┆ 0       ┆ 0      ┆ 0       ┆ 0       │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:35,181 - DEBUG - all_open_price_when_open_pos: shape: (1, 275)
┌─────────────┬─────────────┬─────────────┬─────────────┬───┬─────────┬────────┬─────────┬─────────┐
│ 1000BONKUSD ┆ 1000FLOKIUS ┆ 1000LUNCUSD ┆ 1000PEPEUSD ┆ … ┆ ZILUSDT ┆ ZKUSDT ┆ ZROUSDT ┆ ZRXUSDT │
│ T           ┆ DT          ┆ T           ┆ T           ┆   ┆ ---     ┆ ---    ┆ ---     ┆ ---     │
│ ---         ┆ ---         ┆ ---         ┆ ---         ┆   ┆ f64     ┆ f64    ┆ f64     ┆ f64     │
│ f64         ┆ f64         ┆ f64         ┆ f64         ┆   ┆         ┆        ┆         ┆         │
╞═════════════╪═════════════╪═════════════╪═════════════╪═══╪═════════╪════════╪═════════╪═════════╡
│ null        ┆ null        ┆ 0.1644      ┆ null        ┆ … ┆ 0.0335  ┆ null   ┆ null    ┆ 0.2675  │
└─────────────┴─────────────┴─────────────┴─────────────┴───┴─────────┴────────┴─────────┴─────────┘
2024-11-20 23:07:35,188 - DEBUG - update position: 2023-02-24T23:59:59.999 === diff_trading_value: 286930.72535853996 == cash: 136863.5808068378 
